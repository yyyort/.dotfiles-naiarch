"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[8611],{68611:(e,i,t)=>{t.r(i),t.d(i,{default:()=>Pe});var o=t(97464),n=t.n(o),s=t(77094),r=t.n(s),a=t(96486),d=t.n(a),l=t(67294),c=t(39249),h=t(83355),u=t(8848),f=t(3909),p=t(89101),v=t(82990),m=t(77671),g=t(54642),w=t(5978),y=t(95477),Z=t(27210),S=t(28020),I=t(45023),b=t(91203),k=t(33846),C=t(72087),R=t(19748),x=t(28121),A=t(74194),E=t(84076),M=t(63296),L=t(77137),O=t(36360);t(27369);const D=t(85).XNW,U=t(85).gGi,P=t(85).p1r,N=t(85).a3v,z=t(85).Dd5,T=t(85).cZW,B=t(85).kdC,K=t(85).Hco,j=t(85).AIq,G=t(85).DiQ,_=t(85).nm$,W=t(85).Wp_,F=t(85).Exd,Q=t(85).ChN,X=t(85).PXg,$=t(85).Jkr,H=t(85).H1U,V=t(85).nLZ,q=t(85).f7G,J=t(85).PG2,Y=t(85).X_m,ee=t(85).sI1,ie=t(85).tvI,te=t(85).G3i,oe=t(85).EMU,ne=t(85).sM5,se=t(85).NbQ,re=t(85).XHS,ae=t(85).g7N,de=t(85).xoW,le=t(85).dU4,ce=t(85).D7I,he=t(85).Zij,ue=t(85).R96,fe=t(85).BQ6,pe=t(85).iC_,ve=t(85).Kz9,me=t(85).TtP,ge=t(85).QmD,we=t(85).loK,ye=t(85).lUt,Ze=t(85).EIp,Se=t(85).UWK,Ie=t(85).Xss,be=t(85).Gnd,ke=t(85).YGn,Ce=t(85).exC,Re=t(85).iDK,xe=t(85).wgE,Ae=t(85).X16,Ee=t(85).Gbg,Me=t(85).xm3,Le=t(85).LtU,Oe=t(85).z7d,De=t(85).Dv6;class Ue extends h.Z{constructor(){super(...arguments),this.searchRef=l[De](),this.firstApiRef=l[De](),this.apiSectionRefs={find:l[De](),pricing:l[De](),recovery:l[De](),security:l[De](),rateLimits:l[De](),[Oe]:l[De](),[Le]:l[De](),utilities:l[De](),[Me]:l[De](),marketing:l[De](),[Ee]:l[De](),ai:l[De](),spaceConsolidation:l[De]()},this.storeTypes={[Ae]:k.Z,ownershipRequestStore:C.Z},this.performGetOwnershipRequest=async()=>{const e=await g.adminGetOwnership(this[xe],{});if("failed"!==e.type)return e.data},this.scrollToSection=e=>{const i=this.apiSectionRefs[e];i[Re]&&i[Re].scrollIntoView()},this[Ce]=e=>{(0,I.Z)(this[xe],e,"command+/")&&(e[ke](),this[be][Ae].reset(),this.searchRef[Re]&&this.searchRef[Re][Ie]())},this.handleLogOut=()=>{m.B(this[xe])},this[Se]=this[Ze]((()=>{const e=this[be][Ae][ge][we][ye]();if(!(e[me]<=1))try{return new RegExp(e,"i")}catch(i){return void console.error(`Can't filter with invalid regex "${e}"`,i)}}))}didMount(){window.addEventListener("keydown",this[Ce])}willUnmount(){window.removeEventListener("keydown",this[Ce])}renderComponent(){const e=(0,S.getCurrentUserStore)(this[xe]),{[Ae]:i,ownershipRequestStore:t}=this[be],o=(0,Z.v2)(),s=o?Z.Fr:Z.AA,a=this[Se][ge],d=void 0!==a?s.filter((e=>(0,Z.H2)(e,a))):s,h=new Set(b.Z.getState()||[]),m=d.filter((e=>h.has(e[ve]))).map((e=>{const i=t[ge].result?t[ge].result[e[ve]]:void 0;return r()(R.Z,{[fe]:Ue[pe],api:e,owner:i},e[ve])})),g=this[ue]({key:"favorites",[he]:"⭐ Favorites",children:m});let I=!0;const k=Z.KC.map((e=>{const i=d.filter((i=>i.sectionName===e)).map((e=>{const i=I?this.firstApiRef:void 0,o=t[ge].result?t[ge].result[e[ve]]:void 0;return I=!1,l[ce](R.Z,{[fe]:Ue[pe],ref:i,key:e[ve],api:e,owner:o})}));return this[ue]({key:e,[he]:Z._c[e][he],children:i})})),C={request:{},performRequest:this.performGetOwnershipRequest,render:()=>{}};return r()(O.Z,{[he]:"Notion Admin Mode"},void 0,r()("div",{[fe]:Ue[le]},void 0,r()("div",{[fe]:Ue[fe]},void 0,r()("div",{[fe]:Ue[pe]},void 0,r()("div",{[fe]:Ue[de]},void 0,"Notion ",!o&&"Restricted"," Admin Mode"," ","production"!==y.default.env?`(${y.default.env})`:void 0),r()("div",{[fe]:{[ae]:12}},void 0,r()(E.Z,{href:re,external:!0,inline:!0,[se]:!0},void 0,"Click here")," ","to learn more about how to use Admin Mode."),r()("div",{[fe]:{[ne]:oe}},void 0,(null==e?void 0:e[te]())&&r()("div",{[fe]:{[oe]:1}},void 0,"Currently Logged in as: ",e.getEmail()),!(null!=e&&e[te]())&&r()("div",{[fe]:Ue.warningTextStyle},void 0,r()(E.Z,{[ee]:{[ie]:"underline"},href:p._j.login},void 0,"Please log in.")),(null==e?void 0:e[te]())&&r()(M.Z,{[J]:this.handleLogOut,[fe]:{[Y]:"auto"}},void 0,"Log Out")),o&&r()(x.Z,{}),!o&&r()(M.Z,{[J]:()=>{w[q]({[xe]:this[xe],url:"/"})},[fe]:{[V]:12,[ne]:"flex",[H]:"center"}},void 0,f.Z.arrowLeft({[$]:12,[Y]:12,[X]:12}),"Navigate to user workspace")),r()("div",{[fe]:Ue[pe]},void 0,r()("div",{[fe]:{[Q]:v.Z[Q].bold,[F]:18,[ae]:6}},void 0,"Go to (cmd-/)"),r()("div",{[fe]:{[ae]:14,[ne]:oe}},void 0,l[ce](A.Z,{[B]:!0,[T]:"Filter, then press enter to jump",ref:this.searchRef,focusInitial:!0,value:this[be][Ae][ge][we],[z]:e=>{i[W]({...i[ge],[we]:e[_].value})},left:f.Z[G]({[$]:14,[Y]:14,[X]:6,flexGrow:0,[j]:0,fill:u.Vx()[K]}),onSubmit:()=>{this.firstApiRef[Re]&&this.firstApiRef[Re].focus()}})),Z.KC.map((e=>r()("div",{[fe]:{[V]:6}},e,r()(E.Z,{[J]:()=>this.scrollToSection(e),[se]:!0},void 0,Z._c[e][he]))))),g,k,d[me]<s[me]&&r()("div",{[fe]:{opacity:.7,[$]:"100%",color:u.Vx()[N],margin:8,fontStyle:"italic"}},void 0,s[me]-d[me],' hidden. To show all, press Cmd-/ or click "Clear" above.',r()("br",{}),this.randomQuip())),r()(c.Ix,{hideProgressBar:!0,autoClose:1500,[P]:c.Mi})),l[ce](L.Z,n()({},C,{requestStore:t})))}[ue](e){const{[he]:i,children:t,key:o}=e;if(t&&(!Array.isArray(t)||t[me]))return l[ce]("div",{ref:this.apiSectionRefs[o],id:o,key:o,[fe]:{...Ue[fe],[V]:12,[ae]:12,[$]:U}},r()("div",{[fe]:{...Ue[de],[$]:U,[D]:Ue[pe].margin}},void 0,i),t)}randomQuip(){return d().sample(["Hi, spam duplicate","Your hair is looking so nice today!",'"The faster we are at getting botter, the faster we get botter" - Doug EngelBot',"You're doing a great job, keep it up!!","Computing for everyone","Remember to take a stretch break every once in a while"])}}Ue.displayName="Admin",Ue[le]={[Y]:"100vh",overflow:"auto",background:u.Vx().sidebarBackground,padding:8},Ue[fe]={[ne]:oe,flexWrap:"wrap"},Ue[de]={[Q]:v.Z[Q].bold,[F]:36},Ue[pe]={[$]:500,padding:18,margin:8,border:`1px solid ${u.Vx().outlineButtonBorder}`,background:"white",position:"relative"},Ue.warningTextStyle={[Q]:v.Z[Q].bold,color:"red"};const Pe=Ue},19748:(e,i,t)=>{t.d(i,{Z:()=>Fe});var o=t(97464),n=t.n(o),s=t(77094),r=t.n(s),a=t(96486),d=t.n(a),l=t(67294),c=t(83355),h=t(480),u=t(49085),f=t(8848),p=t(4615),v=t(89101),m=t(97880),g=t(82990),w=t(5366),y=t(54642),Z=t(92625),S=t(53471),I=t(27210),b=t(34809),k=t(77907);class C extends u.default{getInitialState(){return{inputValues:{}}}}const R=C;var x=t(91203),A=t(3104),E=t(52275),M=t(12508),L=t(57770),O=t(74194),D=t(84076),U=t(68785),P=t(53953),N=t(63296),z=t(14871),T=t(64369),B=t(62069);const K=t(85).zTR,j=t(85).tFH,G=t(85).NbQ,_=t(85).tvI,W=t(85).sI1,F=t(85).OzF,Q=t(85).mFu,X=t(85).xoW,$=t(85).k9Q,H=t(85).QyM,V=t(85).w2d,q=t(85).c_6,J=t(85).oSF,Y=t(85).Kz9,ee=t(85).Kiu,ie=t(85).P0R,te=t(85).Eml,oe=t(85).TtP,ne=t(85).mEm,se=t(85).nLZ,re=t(85).mPA,ae=t(85).z$9,de=t(85).PXg,le=t(85).iDK,ce=t(85).g7N,he=t(85).HAy,ue=t(85).tX7,fe=t(85).Dd5,pe=t(85).kdC,ve=t(85).l6S,me=t(85).nm$,ge=t(85).MWD,we=t(85).Gnd,ye=t(85).cZW,Ze=t(85).wfR,Se=t(85).Dv6,Ie=t(85).W3n,be=t(85).tBn,ke=t(85).D7I,Ce=t(85).sM5,Re=t(85).PG2,xe=t(85).BQ6,Ae=t(85).XNW,Ee=t(85).QmD,Me=t(85).vnX,Le=t(85).CZ2,Oe=t(85).Wp_,De=t(85).IO3,Ue=t(85).SPm,Pe=t(85).wgE,Ne=t(85).OtN,ze=t(85).AAz,Te=t(85).MQM,Be=t(85).XtO,Ke=t(85).ueK,je={...["userId","spaceId","blockId","pageId","integrationId","spaceId","fileId","teamId","collectionId","botId"].reduce(((e,i)=>({[i]:I.b9,[`${i}s`]:I.uy,...e})),{}),...["userEmail","fromEmail","toEmail"].reduce(((e,i)=>({[i]:I.cL,[`${i}s`]:I.VX,...e})),{}),domain:I.Ic,domains:I.EJ,supportTicketLink:I.ZT};function Ge(e){window.__c={n:"ImageUploadInput"};const{[Ke]:i,acceptMultiple:t,[Be]:o}=e,[n,s]=(0,l.useState)((()=>({isUploading:!1,[Te]:void 0,[ze]:[]}))),a=(0,h.O7)();return l[ke](l[be],null,r()(N.Z,{isLarge:!0,[xe]:{width:"fit-content",[Ne]:"white"},[Re]:()=>{S.openFilePickerAndUpload({multiple:!!t,[Pe]:a,onStart:()=>{s({...n,isUploading:!0,[Te]:void 0,[ze]:[]})},bucket:"public",onError:e=>{s({isUploading:!1,[Te]:e[Ue],[ze]:[]})},[De]:e=>{s({isUploading:!1,[Te]:void 0,[ze]:e}),o[Oe]({[Le]:void 0,[Me]:{...o[Ee][Me],[i]:t?e:e[0]}})},accept:"image/*"})}},void 0,t?"Upload images":"Upload image",n.isUploading&&r()(U.Z,{[xe]:{[Ae]:4}})),n[ze]&&r()("div",{},void 0,n[ze].join(",")),n[Te]&&r()("div",{[xe]:{color:f.ZP.red,[Ce]:"inline-flex",[Ae]:8}},void 0,n[Te]))}const _e=(0,w.defineMessages)({[Ie]:{id:"adminAPIRequest.loadingMessage",defaultMessage:"Loading…"}});class We extends c.Z{constructor(){super(...arguments),this.firstInputRef=l[Se](),this.fileInputRef=l[Se](),this.storeTypes={[Be]:R,fileNameStore:u.default[Ze]("")},this.buildPlaceholder=(e,i)=>void 0!==i[ye]?i[ye]:e in je?je[e]:void 0,this.renderKey=(e,i,t)=>{const{[Be]:o}=this[we],s=o[Ee][Me][i],a=0===t?this.firstInputRef:void 0;let c;if(e[ge]===I.It.String)c=l[ke](O.Z,{ref:a,value:"string"==typeof s?s:"",[ye]:this.buildPlaceholder(i,e),[pe]:!0,[fe]:e=>{o[Oe]({[Le]:void 0,[Me]:{...o[Ee][Me],[i]:e[me].value}})},onSubmit:this[ve],onClearButtonClick:()=>{o[Oe]({[Le]:void 0,[Me]:{...o[Ee][Me],[i]:void 0}})}});else if(e[ge]===I.It.Number)c=l[ke](O.Z,{ref:a,[ge]:ue,value:"number"==typeof s?s.toString():"",[fe]:e=>{o[Oe]({[Le]:void 0,[Me]:{...o[Ee][Me],[i]:parseInt(e[me].value)}})},onSubmit:this[ve]});else if(e[ge]===I.It.Options){const t=[We.undefinedKey,...e.options],r={menuTitle:i,items:t,[he]:s,onSelect:e=>{o[Oe]({[Le]:void 0,[Me]:{...o[Ee][Me],[i]:e===We.undefinedKey?void 0:e}})},getKey:e=>e,renderItem:e=>l[ke](E.Z,n()({},e,{title:e.value===We.undefinedKey?"Empty":e.value})),renderOrigin:e=>l[ke](N.Z,n()({isLarge:!0,[xe]:{[ce]:8}},e),s||"Empty"),width:300};c=l[ke](z.Z,r)}else if(e[ge]===I.It.Boolean)c=r()(M.Z,{checked:Boolean(s),size:20,[Re]:e=>{o[Oe]({[Le]:void 0,[Me]:{...o[Ee][Me],[i]:!Boolean(s)}})}});else if(e[ge]===I.It.Csv)c=l[ke](l[be],null,r()(N.Z,{isLarge:!0,[Re]:()=>{var e,i;null===(e=this.fileInputRef)||void 0===e||null===(i=e[le])||void 0===i||i.click()},[xe]:{[de]:10}},void 0,"Upload"),this[we].fileNameStore[Ee],l[ke](re,{ref:this.fileInputRef,[xe]:{[Ce]:ae},[ge]:"file",name:e.name||"csv file",[fe]:e=>this.handleOnChangeCsvFile(i,e)}));else if(e[ge]===I.It.Image||e[ge]===I.It.Images){const t=e[ge]===I.It.Images;c=r()(Ge,{[Ke]:i,acceptMultiple:t,[Be]:o})}else e[ge]===I.It.Timezone?c=r()(B.Z,{renderOrigin:e=>l[ke](N.Z,e,s),onSelect:e=>{o[Oe]({[Le]:void 0,[Me]:{...o[Ee][Me],[i]:e}})}}):(0,m.unreachable)(e);return r()("div",{},i,r()("div",{[xe]:{[se]:12,[ce]:4}},void 0,d().startCase(i)),e[ne]&&r()(T.Z,{isSmall:!0,isMultiline:!0,[xe]:{[se]:4,[ce]:8}},void 0,e[ne]),c)},this.handleOnChangeCsvFile=async(e,i)=>{const{[Be]:t,fileNameStore:o}=this[we],n=i[me].files;if(null==n||!n[oe])return;const s=n[0],r=await s.text();o[Oe](s.name),t[Oe]({[Le]:void 0,[Me]:{...t[Ee][Me],[e]:r}})},this[ve]=()=>{this[ie].api[te]?this.handleConfirm():this.handleConfirmedSubmit()},this.handleConfirm=()=>{const{[Be]:e}=this[we],{[te]:i,[ee]:t}=this[ie].api,{[Me]:o}=e[Ee];if(!i)throw new Error("Should not have gotten here without a confirmationApiName");const n=this.normalizeInputValues(o,t),s=y[i];if(!s)throw new Error(`Missing api handler for ${i} - likely either a typo in client/helpers/adminHelpers.tsx or missing declaration in client/actions/api.ts`);Z[Ce]({[Ue]:_e[Ie]}),s(this[Pe],n).then((i=>{Z.close(),e[Oe]({...e[Ee],confirmationResponse:i})}))},this.handleConfirmedSubmit=()=>{const{[Be]:e}=this[we],{[Y]:i,[ee]:t}=this[ie].api,{[Me]:o}=e[Ee],n=this.normalizeInputValues(o,t);Z[Ce]({[Ue]:_e[Ie]});const s=y[i];if(!s)throw new Error(`Missing api handler for ${i} - likely either a typo in client/helpers/adminHelpers.tsx or missing declaration in client/actions/api.ts`);s(this[Pe],n).then((i=>{Z.close(),this.downloadAsCsv(i)||e[Oe]({...e[Ee],confirmationResponse:void 0,[Le]:i})}))},this[J]=()=>{const{[Be]:e}=this[we];e[Oe]({[Me]:e[Ee][Me]})},this[q]=()=>{const{[Be]:e}=this[we];if(!e[Ee][Le])return;"failed"===e[Ee][Le][ge]||this[ie].api[V]?e[Oe]({[Me]:e[Ee][Me]}):this.resetStoreState(this[ie])},this.handlePin=()=>{const{api:e}=this[ie],i=x.Z[H]()||[],t=i.indexOf(e[Y]);-1===t?i.push(e[Y]):i.splice(t,1),x.Z[Oe](i)}}willMount(e){this.resetStoreState(e)}didMount(){this[$]()&&this[ve]()}renderComponent(){const{api:e,owner:i,defaultParams:t,[xe]:o}=this[ie],{[Y]:n,displayName:s,[ee]:a,description:c,emoji:h,isDestructive:u}=e,f=(0,I.G0)(n),p=-1!==(x.Z[H]()||[]).indexOf(n)?"⭐":"☆",{confirmationResponse:v,[Le]:m}=this[we][Be][Ee];return r()("div",{[xe]:o},void 0,r()("div",{[xe]:We[X]},void 0,r()(L.Z,{size:24,emoji:h}),r()("span",{[xe]:{[Ae]:4}},void 0,s||d().startCase(n)),r()("span",{[xe]:{flexGrow:1}}),r()("a",{[Re]:this.handlePin,[xe]:{cursor:Q}},void 0,r()(L.Z,{size:18,emoji:p}))),c&&r()(T.Z,{isSmall:!0,isMultiline:!0},void 0,c),!this[$]()&&l[ke](l[be],null,Object.entries(a).map(((e,i)=>{let[o,n]=e;return t&&t[o]?void 0:this.renderKey(n,o,i)})),r()(N.Z,{[xe]:{[se]:8,[ce]:8},isLarge:!0,[Re]:this[ve],isRed:u},void 0,"Submit")),this[$]()&&!m&&r()("div",{},void 0,r()(U.Z,{[xe]:{width:18,height:18}}),"Loading ..."),this.renderError(v),this.renderConfirmation(v),this.renderError(m),this.renderResponse(m),(f||i)&&r()("div",{[xe]:We.footerStyle},void 0,i&&r()("span",{},void 0,"Owned by"," ",r()("a",{href:`https://notion.slack.com/app_redirect?channel=${i.slackChannel}`},void 0,i[F])),f&&i&&r()("span",{},void 0," | "),f&&r()("span",{},void 0,"Full Admin Tool")))}renderConfirmation(e){if(e&&"success"===e[ge])return r()(P.Z,{open:!0,[W]:We.modalStyle,onDismiss:this[J],disableAnimation:!0,render:()=>l[ke](l[be],null,r()(T.Z,{isSmall:!0,isMultiline:!0,[xe]:{[ce]:8}},void 0,"Does this information about the action you're about to take look good to you? Hit Confirm if it does. Cancel if not."),r()(k.LazyAdminReactJson,{data:e.data}),r()(N.Z,{[xe]:{[se]:8,[ce]:8},isLarge:!0,[Re]:this.handleConfirmedSubmit},void 0,"Confirm"),r()(N.Z,{[xe]:{[se]:8,[ce]:8,[Ae]:8},isLarge:!0,[Re]:this[J]},void 0,"Cancel"))})}renderError(e){if(!e)return;if("success"===e[ge])return;const i=(0,b.pO)(e);return 401===e.status?r()("div",{[xe]:We.responseErrorStyle},void 0,i," Likely fixed by"," ",r()(D.Z,{[W]:{[_]:G},href:v._j.login},void 0,"signing in.")):r()("div",{[xe]:We.responseErrorStyle},void 0,i)}renderResponse(e){if(!e||"success"!==e[ge])return;const i=this[ie].api[j]?r()(this[ie].api[j],{data:e.data,[Pe]:this[Pe],singleRecordMode:this[ie].singleRecordMode}):r()(A.Z,{data:e.data});return this[$]()?i:r()(P.Z,{open:Boolean(e&&"success"===e[ge]),[W]:We.modalStyle,onDismiss:this[q],disableAnimation:!0,render:()=>i})}focus(){this.firstInputRef[le]&&this.firstInputRef[le].focusInput()}downloadAsCsv(e){if(o=e,Boolean("success"===o[ge]&&Array.isArray(null===(n=o.data)||void 0===n?void 0:n.rows)&&(null===(s=o.data)||void 0===s?void 0:s.rows[oe])>0&&"string"==typeof(null===(r=o.data)||void 0===r?void 0:r.filename))){const{filename:o,rows:n}=e.data,s=Array.from(n.reduce(((e,i)=>(Object.keys(i).forEach((i=>e.add(i))),e)),new Set)),r=[s];for(const e of n){const i=new Array(s[oe]);for(let t=0;t<i[oe];t++){const o=s[t];i[t]=e[o]}r.push(i)}const a=r.map((e=>e.join(","))).join("\n");var i=new Blob([a],{[ge]:"data:text/csv"}),t=window.URL.createObjectURL(i);const d=document[ke]("a");return d.download=o,d.href=t,d.click(),!0}var o,n,s,r;return!1}[$](){const{showByDefault:e,singleRecordMode:i}=this[ie];return e&&i}resetStoreState(e){const{defaultParams:i}=e,{[Be]:t}=this[we],o={};for(const n of Object.keys(e.api[ee])){const t=e.api[ee][n];i&&i[n]?o[n]=i[n]:t&&void 0!==t[K]?o[n]=t[K]:o[n]=void 0}t[Oe]({[Me]:o})}normalizeInputValues(e,i){const t={};for(const o of Object.keys(e)){const n=e[o];i[o]&&(d().isString(n)&&p.isUUIDWithoutDashes(n.trim())?t[o]=p.withDashes(n.trim()):t[o]=n)}return t}}We.undefinedKey="__undefined",We[X]={fontWeight:g.Z.fontWeight.bold,fontSize:20,[Ce]:"flex",alignItems:"center",[ce]:6},We.footerStyle={fontSize:10,position:"absolute",bottom:7,right:20},We.responseErrorStyle={color:f.ZP.red,[Ce]:"inline-block",[Ae]:8},We.modalStyle={width:"calc(100% - 120px)",height:"calc(100% - 120px)",padding:24,fontSize:"1.2em",overflow:"scroll"};const Fe=We},91203:(e,i,t)=>{t.d(i,{Z:()=>s});var o=t(53809),n=t(53576);const s=new o.D({key:"adminFavoriteToolsSetting",namespace:n.$p,important:!1,trackingType:"preference"})},27369:()=>{}}]);