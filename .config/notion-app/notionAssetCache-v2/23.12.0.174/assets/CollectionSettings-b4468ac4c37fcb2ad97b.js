"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[4544],{64008:(e,t,o)=>{o.r(t),o.d(t,{default:()=>NL});var i={};o.r(i),o.d(i,{availableActionsForContext:()=>Yd,canCreateDatabaseAutomation:()=>ud,canCreateSlackAutomation:()=>pd,canManageAutomation:()=>md,canRemoveAutomation:()=>gd,createAutomationCreatePageActionValue:()=>jd,createAutomationSlackNotificationActionValue:()=>$d,createAutomationUpdatePagesActionValue:()=>Qd,createDefaultAutomationEventValue:()=>zd,createDefaultAutomationNotificationValue:()=>Hd,findIncompatiblePropertyInFilter:()=>Sd,getActionCheckboxPropertySingleTitleProps:()=>Td,getActionDatePropertyClearTitleProps:()=>Ad,getActionDatePropertySingleTitleProps:()=>kd,getActionPersonPropertyClearTitleProps:()=>_d,getActionPersonPropertyMultipleTitleProps:()=>xd,getActionPersonPropertySingleTitleProps:()=>Md,getActionRelationPropertyClearTitleProps:()=>Zd,getActionRelationPropertyMultipleTitleProps:()=>Dd,getActionRelationPropertySingleTitleProps:()=>Id,getActionSelectPropertyClearTitleProps:()=>Fd,getActionSelectPropertyMultipleTitleProps:()=>Bd,getActionSelectPropertySingleTitleProps:()=>Vd,getActionStatusPropertySingleTitleProps:()=>Ed,getActionTextPropertyClearTitleProps:()=>Kd,getActionTextPropertySingleTitleProps:()=>Rd,getContextStoreValueTypes:()=>Ld,getSlackActionOwnerNames:()=>Xd,getTriggerAnyPageAddedTitle:()=>Nd,getTriggerAnyPagePropertyEditTitle:()=>Od,getTriggerAnyPropertyEditTitle:()=>Wd,getTriggerSelectPropertySetTitle:()=>Ud,getTriggerStatusPropertySetTitle:()=>Gd,handleAdvancedFilterSave:()=>yd,isActionStoreComplete:()=>cd,isAutomationCollectionSettingsEditableAutomationValue:()=>od,isAutomationStoreComplete:()=>dd,referencesDeletedProperty:()=>fd,referencesIncompatibleCollectionViewFilter:()=>vd,referencesIncompatiblePropertiesInFilter:()=>hd,removeDatabaseAutomationTrigger:()=>rd,searchPropertiesIds:()=>Cd,shouldUserSeeAutomationsButton:()=>bd,shouldUserSeeSlackNotificationButton:()=>wd,triggerAndActionMessages:()=>Pd,updateDatabaseAutomationAction:()=>sd,updateDatabaseAutomationName:()=>id,updateDatabaseAutomationSource:()=>nd,updateDatabaseAutomationTrigger:()=>ad,useSlackNotificationInitialMenuState:()=>Jd,useUpdateDatabaseAutomation:()=>ld});var n=o(77094),a=o.n(n),r=o(97464),s=o.n(r),l=o(67294),d=o(83355),c=o(4615),u=o(5366),p=o(50906),m=o(5149),g=o(96802),y=o(12359),f=o(12534),v=o(28187),h=o(34859),S=o(58421),b=o(36857),w=o(27788),C=o(480),P=o(81954),T=o(24405),A=o(3909),k=o(97880),_=o(82990);const M=o(85)._fd,x=o(85).wM4,Z=o(85).P24;var I=o(78316),D=o(42937),F=o(29376),V=o(61766),B=o(13005),E=o(42917),K=o(64921);const R=o(85).wuN,N=o(85).UPJ,O=o(85).H1U,W=o(85).ChN,U=o(85).g7N,G=o(85).sM5,L=o(85).NF1,z=o(85).ewQ,H=o(85).Scd;function q(e){window.__c={n:"CollectionSettingsNotification"};const{title:t,icon:o,style:i,children:n,showCloseButton:r,onClose:s}=e,l=(0,T.Fg)();return a()("div",{style:{padding:"12px 16px",margin:"4px 12px",fontSize:12,[H]:l[z].orange[50],[L]:6,...i}},void 0,t&&a()("div",{style:{[G]:"flex",[U]:2}},void 0,o,a()("div",{style:{[W]:_.Z[W].medium,flexGrow:1}},void 0,t),r&&a()(K.Z,{onClick:s,style:{[G]:"flex",[O]:"center",[N]:"center",[H]:void 0,[L]:6,width:16,height:16}},void 0,A.Z.closeSmall({width:14,fill:l[R]}))),n)}var j=o(72495),Q=o(64369),$=o(5210);const X=o(85).pkR,Y=o(85).BQ6,J=o(85).PG2,ee=o(85).dMt,te=o(85).jkI,oe=o(85).H1U,ie=o(85).c6T,ne=o(85).XNW;function ae(e){window.__c={n:"CollectionSettingsViewSubitemsPreview"};const{propertyName:t,inversePropertyName:o,newDesign:i}=e,n=(0,T.yK)((e=>({togglePreviewParentIcon:{color:e.regularIconColor,marginRight:"4"},togglePreviewChildIcon:{color:e.mediumIconColor,[ne]:"24px",marginRight:"4"},[ie]:{padding:"4px",margin:"0px 12px",display:"flex",fontSize:14,[oe]:te,borderBottom:`1px solid ${e[ee]}`},togglePreviewRow:{padding:"4px",margin:"0px 12px",display:"flex",fontSize:14,[oe]:te},togglePreviewOutsideBorder:{margin:"0px 12px",border:`1px solid ${e[ee]}`,borderRadius:"4px",[oe]:te,...i?{fontWeight:_.Z.fontWeight.medium,backgroundColor:e.accentColors.gray[30],padding:"9px 0"}:{}}})),[i]);return l.createElement(l.Fragment,null,a()(j.Z,{disableMobileBorders:!0},void 0,a()("div",{[Y]:n.togglePreviewOutsideBorder},void 0,a()("div",{[Y]:n[ie]},void 0,a()($.Z,{isSidebar:!1,open:!0,fill:!0,[J]:()=>{},[Y]:n.togglePreviewParentIcon,[X]:!0}),a()("span",{},void 0,"üêî"),a()("div",{[Y]:{[ne]:"5px"}},void 0,o)),a()("div",{[Y]:n[ie]},void 0,a()($.Z,{isSidebar:!1,open:!1,fill:!0,[J]:()=>{},[Y]:n.togglePreviewChildIcon,[X]:!0}),a()("span",{},void 0,"üê£"),a()("div",{[Y]:{[ne]:"5px"}},void 0,t)),a()("div",{[Y]:n.togglePreviewRow},void 0,a()($.Z,{isSidebar:!1,open:!1,fill:!0,[J]:()=>{},[Y]:n.togglePreviewChildIcon,[X]:!0}),a()("span",{},void 0,"üê£"),a()("div",{[Y]:{[ne]:"5px"}},void 0,t)))))}var re=o(96486),se=o.n(re),le=o(80357),de=o(65742),ce=o(27731);const ue=o(85).f4X;function*pe(e,t){const o=new ce.Z;for(o[ue]=e,o.endValue=t,o.stiffness=35;;){const e=yield o[ue];if(o.step(e)){yield o[ue];break}}}function*me(e,t,o){let i=0;for(;i<o;){i+=(yield e+i/o*(t-e))}}function*ge(e){for(const[t,o]of se().zip(e,e.slice(1)))(0,k.isDefined)(t)&&(0,k.isDefined)(o)&&(yield*pe(t,o))}function*ye(e,t){let o=0;for(;!(0,k.isDefined)(t)||o<t;){o+=(yield e)}}function*fe(e){let t=0;for(;;){const o={};for(const[i,n]of(0,k.objectEntries)(e)){const e=n.next(t);if(e.done)return;o[i]=e.value}t=yield o}}var ve=o(28267),he=o(82994);const Se=o(85).toJ,be=o(85).Yd$,we=o(85).tlU,Ce=o(85).mUE,Pe=o(85).wwE,Te=o(85).Gpy,Ae=o(85).z45,ke=o(85).aA_,_e=o(85).W7g,Me=o(85).Ubq,xe=o(85).f1x,Ze=o(85).eiN,Ie=o(85).ewQ,De=o(85).uDf,Fe=o(85).UiR,Ve=o(85).D7I,Be=o(85).X_m,Ee=o(85).AEP,Ke="inactive-task-filter",Re="active-task-filter",Ne="mouse-cursor-filter",Oe=80,We=24;function*Ue(e){yield*fe({x:e,[Ee]:ye(1)})}function Ge(e){window.__c={n:"DateShiftingPreview"};const{mode:t}=e,o=(0,T.yK)((e=>({wrap:{margin:"0px 12px",border:`1px solid ${e.regularDividerColor}`,borderRadius:4,alignItems:"center",position:"relative",[Be]:112}})),[1]),i=(0,l.useRef)(null),n=(0,ve.X)(i),r=n?n.width-2:264;return l[Ve]("div",{style:o.wrap,ref:i},a()(Le,{mode:t,sceneWidth:r}))}function Le(e){window.__c={n:"DateShiftingPreviewAnimation"};const{mode:t,sceneWidth:o}=e,i=(0,T.yK)((e=>({[Fe]:{stroke:e[De],strokeWidth:de.lf},invalidArrow:{stroke:e.collectionInvalidDependencyArrow},svgContainer:{position:"absolute",width:"100%",[Be]:"100%",backgroundColor:e[Ie].gray[30]}})),[]),n=(0,l.useMemo)((()=>({none:function*(){for(;;)yield*Ue(ge([o/2,o/2+40+20,o/2-40-20,o/2]))},preserve_gap:function*(){for(;;)yield*Ue(ge([o/2,o/2+40,o/2-40,o/2]))},consume_gap:function*(){for(;;){yield*Ue(ge([o/2,o/2-40,o/2+40,o/2+Oe]));const e=500;yield*fe({x:ye(o/2+Oe),[Ee]:me(1,0,e)}),yield*fe({x:ye(o/2),[Ee]:me(0,1,e)})}}})),[o]),{x:r,[Ee]:d}=function(e){const t=(0,l.useMemo)((()=>e()),[e]),[o,i]=(0,l.useState)((()=>{const e=t.next(0);if(e.done)throw new Error("Generator must provide at least one result");return e.value}));return(0,l.useEffect)((()=>{const e=t.next(0);e.done||i(e.value);let o=Date.now(),n=0;return n=requestAnimationFrame((function e(){n=requestAnimationFrame(e);const a=Date.now(),r=a-o;o=a;const s=t.next(r);s.done||i(s.value)})),()=>cancelAnimationFrame(n)}),[t]),o}(n[t??"none"]),c={x:o/2-160,y:10},u={x:r-40,y:42},p={x:o/2+Oe,y:74},m={x:u.x+40,y:u.y+12};return(0,k.isDefined)(t)&&("consume_gap"===t?(c.x=Math.min(c.x,u.x-Oe),p.x=Math.max(p.x,u.x+Oe)):"preserve_gap"===t?(c.x=c.x+r-o/2,p.x=p.x+r-o/2):(0,k.unreachable)(t)),a()("svg",{style:i.svgContainer},void 0,se().range(o/2-160,o,40).map(((e,t)=>a()(He,{startPoint:{x:e,y:0},endPoint:{x:e,y:110}},t))),l[Ve](he.Z,s()({startPoint:{x:u.x+Oe,y:u.y+12},endPoint:{x:p.x-2,y:p.y+12}},(0,le.iv)(i[Fe],u.x+Oe>p.x?i.invalidArrow:void 0,{[Ee]:d}),{showArrowHead:!0})),l[Ve](he.Z,s()({startPoint:{x:c.x+Oe,y:c.y+12},endPoint:{x:u.x-2,y:u.y+12}},(0,le.iv)(i[Fe],u.x<c.x+Oe?i.invalidArrow:void 0,{[Ee]:d}),{showArrowHead:!0})),a()(ze,{point:c,[Ee]:d}),a()(ze,{point:u,active:!0,[Ee]:d}),a()(ze,{point:p,[Ee]:d}),a()(qe,{point:m,[Ee]:d}),a()(je,{}))}function ze(e){window.__c={n:"SvgTaskBox"};const{point:t,active:o,[Ee]:i}=e,n=(0,T.Fg)(),r=o?"dark"===n.mode?"#28456C":"#E7F3F8":n.buttonBackground;return a()("g",{transform:`translate(${t.x-4},${t.y-2})`,[Ee]:i},void 0,a()("rect",{[Ze]:`url(#${o?Re:Ke})`,width:Oe,[Be]:We,x:"4",y:"2",fill:r,rx:"3"}))}function He(e){window.__c={n:"SvgDashedLine"};const{startPoint:t,endPoint:o}=e,i=(0,T.Fg)(),n="dark"===i.mode?i[Ie].gray[300]:"#E3E2E0";return a()("line",{x1:t.x,y1:t.y,x2:o.x,y2:o.y,stroke:n,strokeDasharray:"3 4"})}function qe(e){const{point:t,[Ee]:o}=e;return a()("g",{[Ze]:"url(#mouse-cursor-filter)",transform:`translate(${t.x},${t.y})`,[Ee]:o},void 0,a()("path",{fill:"#32302C",d:"M14 12.25h-3.334l2.193 5.294-2.309.956-2.194-5.294L6 15.563l-.75-.75V3.94l1.06-.44L14 11.19v1.06z"}),a()("path",{stroke:"#fff",fill:"#32302C",strokeWidth:"0.5",d:"M14 12.5h.25v-1.413l-.073-.073-7.69-7.69-.12-.12-.154.065-1.059.44L5 3.775v11.142l.073.073.75.75.177.177.177-.177 2.092-2.091 2.05 4.948.096.23.23-.095 2.31-.956.231-.096-.096-.231-2.05-4.948H14z"}))}function je(){return a()("defs",{},void 0,a()(Ze,{id:Ke,width:88,[Be]:32,x:"0",y:"0",colorInterpolationFilters:"sRGB",filterUnits:xe},void 0,a()("feFlood",{floodOpacity:"0",result:Me}),a()("feColorMatrix",{in:_e,result:ke,[Te]:Ae}),a()("feMorphology",{in:_e,[Ce]:"dilate",radius:"1",result:Pe}),a()("feOffset",{}),a()("feComposite",{in2:ke,[Ce]:"out"}),a()("feColorMatrix",{[Te]:we}),a()("feBlend",{in2:Me,result:Pe}),a()("feColorMatrix",{in:_e,result:ke,[Te]:Ae}),a()("feOffset",{dy:"2"}),a()("feGaussianBlur",{stdDeviation:"2"}),a()("feComposite",{in2:ke,[Ce]:"out"}),a()("feColorMatrix",{[Te]:be}),a()("feBlend",{in2:Pe,result:"effect2_dropShadow_637_7659"}),a()("feBlend",{in:"SourceGraphic",in2:"effect2_dropShadow_637_7659",result:"shape"})),a()(Ze,{id:Re,width:88,[Be]:32,x:"0",y:"0",colorInterpolationFilters:"sRGB",filterUnits:xe},void 0,a()("feFlood",{floodOpacity:"0",result:Me}),a()("feColorMatrix",{in:_e,result:ke,[Te]:Ae}),a()("feMorphology",{in:_e,[Ce]:"dilate",radius:"1",result:Se}),a()("feOffset",{}),a()("feComposite",{in2:ke,[Ce]:"out"}),a()("feColorMatrix",{[Te]:"0 0 0 0 0.2 0 0 0 0 0.494118 0 0 0 0 0.662745 0 0 0 0.2 0"}),a()("feBlend",{in2:Me,result:Se}),a()("feColorMatrix",{in:_e,result:ke,[Te]:Ae}),a()("feOffset",{dy:"2"}),a()("feGaussianBlur",{stdDeviation:"2"}),a()("feComposite",{in2:ke,[Ce]:"out"}),a()("feColorMatrix",{[Te]:be}),a()("feBlend",{in2:Se,result:"effect2_dropShadow_637_5084"}),a()("feBlend",{in:"SourceGraphic",in2:"effect2_dropShadow_637_5084",result:"shape"})),a()(Ze,{id:Ne,width:"17.75",[Be]:"24.244",x:"0.75",y:"0.91",colorInterpolationFilters:"sRGB",filterUnits:xe},void 0,a()("feFlood",{floodOpacity:"0",result:Me}),a()("feColorMatrix",{in:_e,result:ke,[Te]:Ae}),a()("feOffset",{dy:"2"}),a()("feGaussianBlur",{stdDeviation:"2"}),a()("feComposite",{in2:ke,[Ce]:"out"}),a()("feColorMatrix",{[Te]:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.2 0"}),a()("feBlend",{in2:Me,result:"effect1_dropShadow_637_4925"}),a()("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_637_4925",result:"shape"})))}var Qe=o(99036),$e=o(52936),Xe=o(71644),Ye=o(77162),Je=o(16956),et=o(64434),tt=o(47307),ot=o(9953),it=o(42922),nt=o(86825),at=o(87279),rt=o(61053),st=o(31945),lt=o(78140),dt=o(69872);o(85).jUl;const ct=o(85).PG2,ut=o(85).N1Z,pt=o(85).Uk6,mt=o(85).AIq,gt=o(85).vK9,yt=o(85).XNW,ft=o(85).Gpy,vt=o(85).nx5,ht=o(85).apZ,St=o(85).h8z,bt=o(85).UPJ,wt=o(85).PXg,Ct=o(85).oWD,Pt=o(85).D7I,Tt=o(85).mSd,At=o(85).rQ1,kt=o(85).P24,_t=o(85).OBh,Mt=o(85).ffk;function xt(e){window.__c={n:"CollectionSettingsViewDefaultPropertyPopup"};const{menuProps:t,[Mt]:o,defaultProperty:i,checkState:n,[_t]:r,[kt]:d,handleDefaultPropertySelect:c,handlePropertySelect:u,...p}=e,m=(0,C.MO)(),g=(0,P.VK)((()=>d[At].state),[d]);return a()(st.ZP,{popupType:m?st.Z4.SlideUp:st.Z4.Popup,alignmentToOrigin:st.vR.End,placementToOrigin:st.pO.Bottom,originGap:0,renderOrigin:e=>l[Pt](dt.Z,s()({},t,e,{disabled:!g[Tt],[_t]:r,format:dt.Z.DisplayFormat.Name,right:a()(Zt,{[Mt]:o,defaultProperty:i,checkState:n,[kt]:d})})),render:e=>l[Pt](It,s()({},p,{parent:e,[Mt]:o,[kt]:d,handleDefaultPropertySelect:c,handlePropertySelect:u}))})}function Zt(e){window.__c={n:"DefaultCheck"};const{[Mt]:t,defaultProperty:o,checkState:i,[kt]:n}=e,r=(0,C.MO)(),s=(0,P.VK)((()=>{var e,t;return null===(e=n[Ct]())||void 0===e||null===(t=e.getName())||void 0===t?void 0:t.toString()}),[n]),l=(0,T.yK)((e=>({defaultText:{color:e.mediumTextColor,fontSize:12,fontWeight:500,textTransform:"uppercase",[wt]:4}})),[]);return a()("div",{style:{display:"flex",[bt]:St}},void 0,a()("div",{style:{...l.defaultText}},void 0,t===o&&a()(u.FormattedMessage,{[vt]:"Default",id:"database.viewSettings.setViewPropertyDefault.defaultProperty.tag",[ft]:{[ht]:s}})),i&&a()("div",{style:{...r?{[yt]:"auto",[wt]:20,[gt]:0,[mt]:0}:{[yt]:"auto",[wt]:12,[gt]:0,[mt]:0},width:r?16:14,[mt]:0}},void 0,A.Z.thinCheck()))}function It(e){window.__c={n:"PropertySelectPopup"};const{parent:t,[Mt]:o,[kt]:i,handleDefaultPropertySelect:n,handlePropertySelect:r,...s}=e,d=(0,C.MO)(),c=(0,P.VK)((()=>i[At].state),[i]),p=(0,P.VK)((()=>i.databaseType),[i]),m=(0,P.VK)((()=>{var e,t;return null===(e=i[Ct]())||void 0===e||null===(t=e.getName())||void 0===t?void 0:t.toString()}),[i]);let g;g=d?{menuType:at.og.ActionSheet}:{menuType:at.og.Popup,width:300};const y=c[pt];let f;return"v1"===e.version?f=a()(j.Z,{topBorder:!0},void 0,y&&a()(E.Z,{isGray:!0,title:a()(u.FormattedMessage,{[vt]:"Set on all new {databaseName} views",id:"database.viewSettings.setViewPropertyDefault.allDefaultButton.title",[ft]:{[ht]:m}}),[ct]:()=>{n(o),t[ut]()}}),a()(E.Z,{title:a()(u.FormattedMessage,{id:"database.viewSettings.setViewPropertyDefault.setProperty.title",[vt]:"Set on this view"}),isGray:!0,[ct]:()=>{r(o),t[ut]()}})):"v2"===e.version?f=l[Pt](l.Fragment,null,y&&a()(j.Z,{},void 0,a()(E.Z,{title:a()(u.FormattedMessage,{[vt]:"Set as default",id:"database.viewSettings.relationFeatures.setViewPropertyDefault.allDefaultButton.title",[ft]:{[ht]:m}}),caption:l[Pt](u.FormattedMessage,(0,D.K9)({feature:e.feature,databaseType:p})),shouldWrapCaption:!0,[ct]:()=>{n(o),t[ut]()}})),a()(j.Z,{topBorder:y},void 0,a()(E.Z,{title:a()(u.FormattedMessage,{id:"database.viewSettings.relationFeatures.setViewPropertyDefault.setProperty.title",[vt]:"Set on this view only"}),[ct]:()=>{r(o),t[ut]()}}))):(0,k.unreachable)(e),l[Pt](lt.Z,g,f)}var Dt=o(43261),Ft=o.n(Dt),Vt=o(6695),Bt=o(52821),Et=o(33929),Kt=o(29798),Rt=o(73657),Nt=o(52275),Ot=o(68894),Wt=o(32163);const Ut=o(85).P0G,Gt=o(85).D7I,Lt=o(85).Yzm,zt=o(85).dLQ,Ht=o(85).ffk,qt=o(85).wuN,jt=o(85).nR5,Qt=o(85).$Jh,$t=o(85).nx5,Xt=o(85).zwB,Yt=(0,u.defineMessages)({[Xt]:{[$t]:"Search for a property‚Ä¶",id:"database.viewSettings.propertySelect.inputPlaceholder"}});function Jt(e){window.__c={n:"CollectionSetttingsGroupedPropertySelectMenu"};const{currentProperty:t,getGroupedProperties:o,onAccept:i,[Qt]:n,[Xt]:r,schema:d,format:c,defaultShowPropertyGroupCount:p}=e,m=(0,C.Fy)(),g=(0,P.qz)(void 0,Kt.Z),y=(0,P.VK)((()=>o()),[o]),[f,v]=(0,l.useState)(!1),[h,S]=(0,l.useState)(""),b=(0,Vt.getNormalizedFormat)(c,d,void 0,Vt.FormatContext.Page)[jt]||[],w=(0,l.useCallback)((e=>{S(e.target.value),g.setState({...g.state,focus:{section:0,indexLocal:0,indexGlobal:0}}),v(!1)}),[g]),_=(0,T.yK)((e=>({dotsIcon:{width:16,fill:e[qt],marginLeft:4,marginRight:2},showMoreButton:{color:e[qt]}})),[]),M=re.sortBy(y,(e=>Math.min(...e.map((e=>b.findIndex((t=>t[Ht]===e))))))),x=[{key:"input",comp:a()(j.Z,{},void 0,a()(Ot.ZP,{focusInitial:!m[zt]||void 0,focus:!m[zt]||void 0,value:h,onChange:w,placeholder:r||Et.default[Lt](Yt[Xt])}))}];if(h){const e=M.map((e=>e.filter((e=>{const t=d[e],o=t?`${t.name} ${Bt.SO[t.type]}`:"";return Boolean(Ft().match(h,o))})))).filter((e=>e.length>0));if(0===e.length)x.push({key:"noResults",comp:a()(Rt.Z,{caption:a()(u.FormattedMessage,{[$t]:"No results",id:"database.viewSettings.propertySelect.noResultsTitle"})})});else{const o=[{key:"results",render:e=>l[Gt](j.Z,e),items:e.flat().map((e=>to({onAccept:i,[Ht]:e,schema:d,currentProperty:t,[Qt]:n}))).filter(k.isDefined)}];x.push(eo({sections:o,[Ut]:g}))}}else{const e=p||2;let o,r;if(!f&&M.length>e){o=M.slice(0,e);const t=re.sum(M.slice(e).map((e=>e.length)));r={key:"show_more",render:e=>l[Gt](Nt.Z,s()({},e,{icon:A.Z.dots(_.dotsIcon),style:_.showMoreButton,title:a()(u.FormattedMessage,{[$t]:"{moreCount} more",id:"database.viewSettings.propertySelect.showMoreTitle",values:{moreCount:t}})})),action:()=>{v(!0)}}}else o=M;const c=o.map(((e,a)=>({key:e.join("-"),render:e=>l[Gt](j.Z,s()({},e,{topBorder:0!==a})),items:e.map((e=>to({onAccept:i,[Ht]:e,schema:d,currentProperty:t,[Qt]:n}))).concat(a===o.length-1?[r]:[]).filter(k.isDefined)})));x.push(eo({sections:c,[Ut]:g}))}return l[Gt](l.Fragment,null,x.map((e=>{let{key:t,comp:o}=e;return a()(l.Fragment,{},t,o)})))}function eo(e){const{[Ut]:t,sections:o}=e;return{key:"properties",comp:a()(Wt.Z,{type:Wt.i.Vertical,initialFocus:0,sections:o,store:t})}}function to(e){const{schema:t,currentProperty:o,onAccept:i,[Qt]:n,[Ht]:a}=e,r=t[a];if(!r)return;return{key:a,render:e=>{const t=a===o;return n?n(e,a,t,r):l[Gt](dt.Z,s()({},e,{propertySchema:r,format:dt.Z.DisplayFormat.Name,checkState:t}))},action:()=>{i(a)}}}var oo=o(44532),io=o(31869),no=o(54281),ao=o(49830);const ro=o(85).wM4,so=o(85)._fd,lo=o(85).dQ2,co=o(85).gFy,uo=o(85).aKz,po=o(85).xPL,mo=o(85).ddU,go=o(85).jQT,yo=o(85).n32,fo=o(85).mYq,vo=o(85).Xl2,ho=o(85).MsU,So=o(85).nR5,bo=o(85).wgE,wo=o(85).ebo,Co=o(85).Drs,Po=o(85).JJj,To=o(85).dlB,Ao=o(85).LCr,ko=o(85).qU4,_o=o(85).HxR,Mo=o(85).xIw,xo=o(85).UGA,Zo=o(85).qq3,Io=o(85).oWD,Do=o(85).P24;function Fo(e){const{[Do]:t,feature:o}=e,i=(0,u.useIntl)();return{initialPropertyName:(0,P.VK)((()=>{const e=t[Io]();if(null!=e&&e.isDefined()){const n=t[Zo].state;return F.getSuggestedRelationName(i,{[xo]:e,isSelfRelation:!0,sourceSchema:n,createUnique:!0,from:o})}return i.formatMessage({id:Mo,defaultMessage:"Related to target"})}),[t,i,o])}}function Vo(e){const{feature:t,[Do]:o,[_o]:i,onPropertySelect:n}=e,a=(0,C.O7)(),r=(0,u.useIntl)(),{initialPropertyName:s}=Fo({[Do]:o,feature:t}),d=(0,l.useCallback)((e=>{const{[ko]:o,newProperty:i,[Ao]:n}=e;"subitem"===t?ao.dR({[ko]:o,propertyId:i,[Ao]:n}):"timeline_arrows_by"===t?no.setTimelineArrowsByRelation({[ko]:o,newProperty:i,[Ao]:n}):(0,k.unreachable)(t)}),[t]),c=(0,P.VK)((()=>o[Zo].state),[o]),p=(0,l.useCallback)((()=>F.getGroupedSelfRelationProperties(o,c)),[o,c]),g=(0,l.useCallback)((e=>{const{[To]:i,[Ao]:n}=e;"subitem"===t?ao.jA({[Do]:o,[To]:i,[Ao]:n}):"timeline_arrows_by"===t?no.setDefaultArrowsByRelation({[Do]:o,[To]:i,[Ao]:n}):(0,k.unreachable)(t)}),[o,t]),f=(0,l.useCallback)((e=>{const{featureType:t}=e,n=o[Io](),l=n,c=o[ko]();n&&l&&(y[Po]({[Co]:wo,[bo]:a,perform:i=>{const u=Je.G3({[bo]:a,[Io]:n,collectionViewArgs:c?{[ko]:c,format:c.getFormat(),formatKey:So}:void 0,propertyType:ho,[Ao]:i});return io.n7({[bo]:a,[Do]:o,[Io]:n,property:u,propertyName:s,[xo]:l,hasInverseRelation:!0,inverseName:void 0,autoRelate:{enabled:!1},propertyLimit:"no_limit",intl:r,[Ao]:i,from:t}),c&&(d({[ko]:c,newProperty:u,[Ao]:i}),g({[To]:u,[Ao]:i})),"timeline_arrows_by"===t&&Qi({[bo]:a,intl:r,[Io]:n,[Ao]:i,newConfig:e.dateShiftingConfig}),u}}),m[vo]({[_o]:i,item:{type:"main"}}),Ye.trackCreateProperty({[bo]:a,[Do]:o,from:t,[fo]:ho}))}),[o,i,a,s,r,g,d]),v=(0,l.useCallback)((e=>{const i=o[ko]();if(!i)return;let r;y[Po]({[Co]:yo,[bo]:a,perform:t=>{d({[ko]:i,newProperty:e,[Ao]:t}),g({[To]:e,[Ao]:t})}}),n(e),"subitem"===t?r="update_default_subitem":"timeline_arrows_by"===t?r="update_default_timeline_arrows_by":(0,k.unreachable)(t),Ye[go]({action:r,[mo]:void 0,[fo]:e?ho:void 0,[bo]:a,[Do]:o})}),[o,a,n,t,d,g]);return{handlePropertySelect:(0,l.useCallback)((e=>{const i=o[ko]();if(!i)return;let r;y[Po]({[Co]:po,[bo]:a,perform:t=>{d({[ko]:i,newProperty:e,[Ao]:t})}}),n(e),"subitem"===t?r="update_subitem":"timeline_arrows_by"===t?r="update_timeline_arrows_by":(0,k.unreachable)(t),Ye[go]({action:r,[mo]:void 0,[fo]:e?ho:void 0,[bo]:a,[Do]:o})}),[o,a,n,t,d]),handleDefaultPropertySelect:v,handleAddRelation:f,getProperties:p}}function Bo(e){const{feature:t,[Do]:o}=e;let i,n;var a,r;if("subitem"===t)i=null===(a=o[uo].state)||void 0===a?void 0:a.property,n=null===(r=o[Io]())||void 0===r?void 0:r[co]().getKeyStore(lo).getValue();else if("timeline_arrows_by"===t){var s;i=o[so].state,n=null===(s=o[Io]())||void 0===s?void 0:s[co]().getKeyStore(ro).getValue()}else(0,k.unreachable)(t);const l=o[Zo].state,d=F.getSelfRelationProperties(o,l);(0,k.isDefined)(i)&&!d.includes(i)&&(i=void 0),(0,k.isDefined)(n)&&!d.includes(n)&&(n=void 0);const c=i??n;if(c)return{property:c,isDefault:c===n,enabledOnView:Boolean(i),enabledOnCollection:Boolean(n),supportedInView:$i({feature:t,viewType:o.getViewType()})}}function Eo(e){const{feature:t,[Do]:o}=e;return(0,P.VK)((()=>Bo({feature:t,[Do]:o})),[o,t])}const Ko=o(85).ccq,Ro=o(85).AIq,No=o(85).Uie,Oo=o(85).nx5,Wo=o(85).E6w,Uo=o(85).qq3,Go=o(85).pkR,Lo=o(85).g4H,zo=o(85).Uk6,Ho=o(85).mSd,qo=o(85).D7I,jo=o(85).tb8,Qo=o(85).wM4,$o=o(85).dQ2,Xo=o(85).qLW,Yo=o(85).oWD,Jo=o(85).LtW,ei=o(85).HxR,ti=o(85).P24;function oi(e){window.__c={n:"RelationPropertyPicker"};const{currentPropertyId:t,feature:o,[ti]:i,[ei]:n,permissionScopes:r,onPropertySelect:s,[Jo]:d}=e,c=(0,u.useIntl)(),p=(0,P.VK)((()=>{var e,t,n,a;return"subitem"===o?null===(e=i[Yo]())||void 0===e||null===(t=e[Xo]())||void 0===t?void 0:t[$o]:"timeline_arrows_by"===o?null===(n=i[Yo]())||void 0===n||null===(a=n[Xo]())||void 0===a?void 0:a[Qo]:void(0,k.unreachable)(o)}),[o,i]),m=(0,P.VK)((()=>i.databaseType),[i]),{handleDefaultPropertySelect:g,handlePropertySelect:y,[jo]:f}=Vo({[ti]:i,[ei]:n,feature:o,onPropertySelect:s});return a()(ni,{intl:c,icon:A.Z.typesRelation,[Lo]:l[qo](u.FormattedMessage,(0,D.g3)({feature:o,databaseType:m})),[ti]:i,[Jo]:d,shouldGroupProperties:!0,getGroupedProperties:f,currentProperty:t,onAccept:r[Ho]&&r[zo]?y:()=>{},renderProperty:(e,t,n,r)=>a()(xt,{version:"v2",feature:o,menuProps:e,property:t,defaultProperty:p,checkState:n,propertySchema:r,[ti]:i,handleDefaultPropertySelect:g,handlePropertySelect:y})})}function ii(e){window.__c={n:"DatePropertyPicker"};const{currentPropertyId:t,[ti]:o,onPropertyChanged:i,[Go]:n,title:r}=e,s=(0,u.useIntl)(),d=(0,P.qz)(void 0,V.Z),c=(0,P.VK)((()=>o[Uo].state),[o]),p=(0,l.useCallback)((()=>Object.keys(c).filter((e=>{const t=c[e];return"date"===(null==t?void 0:t.type)})).filter(k.isDefined)),[c]);return a()(ni,{intl:s,[Jo]:d,title:r,[ti]:o,shouldGroupProperties:!1,[jo]:p,currentProperty:t,[Go]:n,onAccept:e=>{e&&i(e),d.setState({open:!1})}})}function ni(e){window.__c={n:"PopupPropertyPicker"};const{currentProperty:t,icon:o,[Lo]:i,[Jo]:n,[ti]:r,[Go]:d,title:c,shouldGroupProperties:p}=e,m=(0,C.Fy)(),g=(0,P.VK)((()=>{var e;return(null===(e=r[Yo]())||void 0===e?void 0:e[Xo]())??{}}),[r]),y=(0,P.VK)((()=>r[Uo].state),[r]),f=(0,T.yK)((e=>({[Lo]:{fontSize:m.isMobile?_.Z.fontSize.UISmall.mobile:_.Z.fontSize.UISmall.desktop,color:e.mediumTextColor,margin:"0 12px 28px 12px"}})),[m]),v=(0,P.VK)((()=>n.state.open),[n]),h=(0,P.VK)((()=>m[Wo]?{menuType:at.og.ActionSheet}:{menuType:at.og.Popup,width:300}),[m[Wo]]);return l[qo](l.Fragment,null,i&&a()("div",{style:f[Lo]},void 0,i),a()(st.ZP,{popupType:m[Wo]?oo.kQ.SlideUp:oo.kQ.Popup,alignmentToOrigin:st.vR.End,[Ko]:st.pO.Bottom,[Go]:d,originGap:0,renderOrigin:e=>{var i;return l[qo](E.Z,s()({title:c??a()(u.FormattedMessage,{id:"database.viewSettings.relationFeatures.propertyPicker.default.title",[Oo]:"Property"}),showChevron:!0,right:t?a()("span",{style:_.Z[No]},void 0,null===(i=y[t])||void 0===i?void 0:i.name):void 0,rightStyle:{[Ro]:1},textWrapperStyle:{[Ro]:0},rotateChevron:v,[Go]:d,icon:o},e))},render:t=>l[qo](lt.Z,h,p?l[qo](Jt,s()({},e,{getGroupedProperties:e.getGroupedProperties,format:g,schema:y})):l[qo](rt.Z,s()({},e,{[jo]:e[jo],format:g,schema:y}))),[Jo]:n}))}const ai=o(85).ZYq,ri=o(85).UAT,si=o(85).W2X,li=o(85).veG,di=o(85).LCr,ci=o(85).oWD,ui=o(85).OP1,pi=o(85).Xl2,mi=o(85).ejZ,gi=o(85).Wsu,yi=o(85).BTL,fi=o(85).Exd,vi=o(85).ChN,hi=o(85)._tz,Si=o(85).eN5,bi=o(85).hd7,wi=o(85).mSd,Ci=o(85).Uk6,Pi=o(85).rQ1,Ti=o(85).HxR,Ai=o(85).PG2,ki=o(85).nx5,_i=o(85)._yi,Mi=o(85).E_E,xi=o(85).lB1,Zi=o(85).suA,Ii=o(85).qq3,Di=o(85).tBn,Fi=o(85).f4X,Vi=o(85).D7I,Bi=o(85).wgE,Ei=o(85).jQT,Ki=o(85).oXC,Ri=o(85).ffc,Ni=o(85).P24,Oi=o(85).pkR;function Wi(e){var t;window.__c={n:"DateShiftingConfigSection"};const{currentConfig:o,onConfigChange:i,[Oi]:n,[Ni]:r}=e,s=(0,P.VK)((()=>r.databaseType),[r]),d=(0,C.O7)(),c=null===(t=o[Ri])||void 0===t?void 0:t.mode,[p,m]=(0,l.useState)(!(0,k.isDefined)(o[Ri])||Boolean(o[Ri][Ki])),g=(0,k.isDefined)(o[Ri])?Boolean(o[Ri][Ki]):p;(0,l.useEffect)((()=>{if((0,k.isDefined)(o[Ri])){const e=Boolean(o[Ri][Ki]);e!==p&&m(e)}}),[o,p]);const y=(0,l.useCallback)((e=>{(0,k.isDefined)(o[Ri])&&(i({...o,[Ri]:{...o[Ri],[Ki]:e}}),Ye[Ei]({[Bi]:d,[Ni]:r,action:"update_dependency_date_shift_avoid_weekends",new_avoid_weekends:e}))}),[r,o,d,i]),f=(0,l.useCallback)((e=>{(0,k.isDefined)(e)?i({...o,[Ri]:{...o[Ri],mode:e,[Ki]:p}}):i({...o,[Ri]:void 0}),Ye[Ei]({[Bi]:d,[Ni]:r,action:"update_dependency_date_shift_mode",new_date_shift_mode:e??"none"})}),[r,o,d,p,i]);return l[Vi](l[Di],null,a()(j.Z,{title:l[Vi](u.FormattedMessage,D.dH.dateShiftingSectionCaption),disableMobileBorders:!0},void 0,a()(Ge,{mode:c})),a()(j.Z,{disableMobileBorders:!0},void 0,a()(qi,{currentMode:c,onModeChange:f,databaseType:s,[Oi]:n})),a()(j.Z,{},void 0,a()(Hi,{[Fi]:g,databaseType:s,onChange:y,[Oi]:n||!(0,k.isDefined)(o[Ri])}),l[Vi](Ui,e)))}function Ui(e){window.__c={n:"DatePropertiesConfigSection"};const{[Ni]:t,currentConfig:o,onConfigChange:i,[Oi]:n}=e,r=(0,P.VK)((()=>{const e=t[Ii].state;return Object.keys(e).filter((t=>{const o=e[t];return o&&(0,Qe.isDateType)(o)}))}),[t]),s=r.length,d=o[Zi]?r.find((e=>e!==o[Zi])):void 0,c="string"==typeof o[Zi]&&(0,k.isDefined)(o[xi]),p=(0,l.useCallback)(((e,t)=>{const n={[e]:t};if(c&&(0,k.isDefined)(o[Zi])){const i="datePropertyId"===e?xi:Zi;o[i]===t&&(n[i]=r.find((e=>e!==t)))}i({...o,...n})}),[o,r,i,c]);return!(0,k.isDefined)(o[Ri])||s<=1?null:l[Vi](l[Di],null,a()(ii,{[Ni]:t,currentPropertyId:o[Zi],title:c?l[Vi](u.FormattedMessage,D.dH[Mi]):l[Vi](u.FormattedMessage,D.dH.datePropertyPickerTitle),onPropertyChanged:e=>p(Zi,e),[Oi]:n}),(0,k.isDefined)(d)&&"string"==typeof o[Zi]&&l[Vi](l[Di],null,(0,k.isDefined)(o[xi])&&a()(ii,{[Ni]:t,currentPropertyId:o[xi],title:l[Vi](u.FormattedMessage,D.dH[_i]),onPropertyChanged:e=>p("endDatePropertyId",e),[Oi]:n}),a()(nt.Z,{title:a()(u.FormattedMessage,{id:"database.viewSettings.relationFeatures.datePropertyPicker.separateStartEnd",[ki]:"Separate start and end dates"}),focused:!1,on:c,[Oi]:n,disabledFeedback:!0,[Ai]:()=>{i({...o,[xi]:c?void 0:d})}})))}function Gi(e){const{[Ti]:t,feature:o,[Pi]:i}=e,n=!i[Ci]&&!i[wi];return a()(E.Z,{icon:A.Z.settings,showChevron:!0,[Oi]:n,title:l[Vi](u.FormattedMessage,D.dH.advancedSettings),[Ai]:()=>{m[bi]({[Ti]:t,item:{type:Si,feature:o}})}})}function Li(e){window.__c={n:"TurnOnFeatureButton"};const{feature:t,handleAddRelation:o,databaseType:i,[Pi]:n}=e,r=(0,T.yK)((e=>({button:{width:"100%"},buttonWrap:{margin:"0px 12px"}})),[]);return n[wi]&&n[Ci]?a()(j.Z,{disableMobileBorders:!0},void 0,a()("div",{style:r.buttonWrap},void 0,a()(it.Z,{style:r.button,[Ai]:o,isLarge:!0},void 0,l[Vi](u.FormattedMessage,(0,D.Tq)({feature:t,databaseType:i}))))):null}function zi(e){window.__c={n:"TurnOffFeatureMenuItem"};const{feature:t,[Pi]:o,[hi]:i,relationPropertyId:n,inversePropertyName:r,[Ni]:d,[Ti]:c,handleDefaultPropertySelect:p,databaseType:g}=e,f=(0,C.O7)(),v=(0,T.yK)((e=>({modalTitle:{[vi]:_.Z[vi].semibold,[fi]:18},[yi]:{textAlign:"center"},modalPropertyName:{color:e[gi],[vi]:_.Z[vi].semibold}})),[]);return o[Ci]&&o[wi]&&i&&r?a()(E.Z,{icon:A.Z.trash,title:l[Vi](u.FormattedMessage,(0,D.nB)({feature:t,databaseType:g})),isRed:!0,[Ai]:()=>{tt.showDialog({description:l[Vi](u.FormattedMessage,s()({},D.dH.turnOffFeatureDeletedProperties,{values:{span:e=>a()("span",{style:v.modalPropertyName},void 0,e),[hi]:i,inversePropertyName:r}})),message:a()("div",{style:v.modalTitle},void 0,l[Vi](u.FormattedMessage,(0,D.OH)({feature:t,databaseType:g}))),innerStyle:v[yi],showCancel:!0,keepFocus:!0,items:[{label:l[Vi](u.FormattedMessage,D.dH.turnOffAndDelete),color:"red",onAccept:async()=>{n&&(await async function(e){const{[Bi]:t,[Ni]:o,[mi]:i,feature:n}=e,a=o[Ii].state,r=o[ci]();if(!r)return;await y[ai]({[Bi]:t,userAction:"CollectionSettingsViewRelationFeatures.handleTurnOffFeatureAndDeleteAccept",waitForServerCommit:!1,perform:e=>Je.yV({[Bi]:t,[ci]:r,schema:a,property:i,[di]:e})});const s=a[i];s&&Ye.trackDeleteProperty({[Bi]:t,[Ni]:o,property_type:s.type,from:n,property:i})}({[Bi]:f,[mi]:n,[Ni]:d,feature:t}),p(void 0),m[pi]({[Ti]:c,item:{type:"main"}}))}}]})}}):null}function Hi(e){const{[Fi]:t,onChange:o,[Oi]:i,databaseType:n}=e;return a()(nt.Z,{title:l[Vi](u.FormattedMessage,D.dH.avoidWeekendsSwitcherTitle),caption:l[Vi](u.FormattedMessage,(0,D.Bq)(n)),shouldWrapCaption:!0,shouldWrapTitle:!0,focused:!1,on:t,[Oi]:i,disabledFeedback:!0,[Ai]:()=>o(!t)})}function qi(e){window.__c={n:"DateShiftModeSelect"};const{currentMode:t,onModeChange:o,[Oi]:i,databaseType:n}=e,r=(0,T.yK)((e=>({wrap:{display:"flex",flexDirection:"column",rowGap:8,marginLeft:12,marginRight:12}})),[]);return a()("div",{style:r.wrap},void 0,[...$e.Bp,void 0].map((e=>a()(ji,{dateShiftingMode:e,databaseType:n,[Ai]:()=>o(e),active:e===t,[Oi]:i},e??"none"))))}function ji(e){window.__c={n:"DateShiftButton"};const{dateShiftingMode:t,[Ai]:o,active:i,[Oi]:n,databaseType:r}=e,s=(0,C.Fy)(),d=(0,T.yK)((e=>({buttonStyles:{[fi]:s.isMobile?_.Z[fi].UISmall.mobile:_.Z[fi].UISmall.desktop,[vi]:_.Z[vi].medium,borderRadius:3,width:"100%",padding:"8px 8px",boxShadow:`0 0 0 1px ${e.regularDividerColor}`,color:e[gi],fill:e.mediumTextColor,...i&&{boxShadow:`0 0 0 2px ${e[ui]}`,color:e[ui],fill:e[ui]},...n&&{opacity:.65}},icon:{width:20,height:20,marginRight:6},buttonContentWrap:{display:"flex",alignItems:"center"}})),[i,s,n]),{title:c,icon:p}=(0,D.lo)({dateShiftingMode:t,databaseType:r});return a()(K.Z,{style:d.buttonStyles,[Ai]:o,[Oi]:n},void 0,a()("div",{style:d.buttonContentWrap},void 0,a()("div",{},void 0,p(d.icon)),a()("div",{},void 0,l[Vi](u.FormattedMessage,c))))}function Qi(e){const{[Bi]:t,newConfig:o,[ci]:i,[di]:n,intl:a}=e;let r;if((0,k.isDefined)(o[Ri]))if(o[Zi])r={...o[Ri],[si]:o[Zi],[ri]:o[xi]};else{const e=(0,Xe.ZP)(),s={name:a.formatMessage(D.dH.newDateProperty),type:"date"};et[li]({[Bi]:t,[ci]:i,update:{[e]:s},[di]:n}),r={...o[Ri],[si]:e,[ri]:void 0}}ot.updateValue({store:i.getFormatStore(),data:{dependency_date_shifting_config:r??null},[di]:n})}function $i(e){const{viewType:t,feature:o}=e;return"timeline_arrows_by"===o?"timeline"===t:"subitem"===o||void(0,k.unreachable)(o)}const Xi=o(85).Uh4,Yi=o(85).Uk6,Ji=o(85).mSd,en=o(85).suA,tn=o(85).ffc,on=o(85).ZzC,nn=o(85).tBn,an=o(85).D7I,rn=o(85).Kvi,sn=o(85).dlB,ln=o(85)._tz,dn=o(85).Lhq,cn=o(85).wuN,un=o(85).L_E,pn=o(85).D0f,mn=o(85).UGA,gn=o(85).sRA,yn=o(85).rQ1,fn=o(85).ffk,vn=o(85).oWD,hn=o(85).qq3,Sn=o(85).HxR,bn=o(85).P24;function wn(e){window.__c={n:"CollectionSettingsViewRelationFeatures"};const{[bn]:t,[Sn]:o,feature:i}=e,n=(0,u.useIntl)(),r=(0,C.Fy)(),d=(0,P.VK)((()=>t[hn].state),[t]),c=(0,P.VK)((()=>t.databaseType),[t]),p=(0,P.VK)((()=>t[vn]()),[t]),m=Eo({[bn]:t,feature:i}),g=null==m?void 0:m[fn],y=(0,l.useMemo)((()=>I.findDateProperty(d)),[d]),f=(0,P.VK)((()=>t[yn].state),[t]),v=(0,P.VK)((()=>{var e;return g&&(null===(e=d[g])||void 0===e?void 0:e.name)}),[d,g]),h=(0,P.VK)((()=>{const e=g&&d[g];if(e&&"relation"===e.type){var t;const o=e[fn];return o?null===(t=d[o])||void 0===t?void 0:t.name:void 0}}),[g,d]),S=(0,P.VK)((()=>{const e=t[vn]();return null!=e&&e.isDefined()?F[gn](n,{sourceCollection:e.getModel(),isSelfRelation:!0,[mn]:e,createUnique:!0,from:i}):n.formatMessage({id:pn,defaultMessage:"Related to this database"})}),[t,n,i]),b=(0,P.VK)((()=>Boolean(p&&function(e){const{[Z]:t,collectionStore:o}=e,i=o.getFormat()[x],n=t[M].state;return!(0,k.isDefined)(n)||n===i}({[bn]:t,[vn]:p}))),[t,p]),w=(0,P.qz)(void 0,V.Z),A=(0,l.useCallback)((e=>{e&&w.setState({open:!1})}),[w]),{initialPropertyName:E}=Fo({[bn]:t,feature:i}),K=Vo({[bn]:t,[Sn]:o,onPropertySelect:A,feature:i}),{handleAddRelation:R,handleDefaultPropertySelect:N}=K,O=(0,T.yK)((e=>({[un]:{marginLeft:12,marginRight:12},captionText:{fontSize:r.isMobile?_.Z.fontSize.UISmall.mobile:_.Z.fontSize.UISmall.desktop,color:e[cn],fontWeight:_.Z.fontWeight.regular}})),[r]);if(!p)return null;let W;return"subitem"===i?W=m?a()(j.Z,{disableMobileBorders:!0},void 0,a()(Gi,{[Sn]:o,feature:i,[yn]:f}),a()(An,{feature:i,databaseType:c,featuredRelationProperty:m,[dn]:K,[yn]:f}),a()(zi,{feature:i,databaseType:c,[yn]:f,[ln]:v,[sn]:g,[bn]:t,[Sn]:o,handleDefaultPropertySelect:N,inversePropertyName:h})):l[an](l[nn],null,a()(ae,{[ln]:v||E,inversePropertyName:h||S,newDesign:!0}),a()(Li,{feature:i,[yn]:f,databaseType:c,handleAddRelation:()=>{R({featureType:rn})}})):"timeline_arrows_by"===i?W=m?l[an](l[nn],null,b?a()(Pn,{[bn]:t,firstDatePropertyId:y,[yn]:f}):a()(Cn,{[bn]:t,databaseType:c}),a()(j.Z,{topBorder:!0},void 0,a()(Gi,{[Sn]:o,feature:i,[yn]:f}),a()(An,{feature:i,databaseType:c,featuredRelationProperty:m,[dn]:K,[yn]:f}),a()(zi,{feature:i,databaseType:c,[yn]:f,[sn]:g,[ln]:v,inversePropertyName:h,[bn]:t,[Sn]:o,handleDefaultPropertySelect:N}))):a()(Tn,{databaseType:c,[bn]:t,firstDatePropertyId:y,handleAddRelation:R,[yn]:f}):(0,k.unreachable)(i),l[an](B.ZP,s()({},e,{title:l[an](u.FormattedMessage,(0,D.Gt)({feature:i,databaseType:c}))}),a()(j.Z,{disableMobileBorders:!0},void 0,a()("div",{style:{...O[un],...O.captionText}},void 0,l[an](u.FormattedMessage,(0,D.qi)({feature:i,databaseType:c})))),W)}function Cn(e){window.__c={n:"DateShiftingNotApplicableToThisViewMessage"};const{[bn]:t,databaseType:o}=e,i=(0,C.MO)(),n=(0,T.yK)((e=>({wrap:{boxShadow:e.plainButtonBoxShadow,...i?{backgroundColor:e.sidebarBackground,margin:void 0,borderRadius:void 0}:{background:"rgba(196, 196, 196, 0.13)",marginTop:14,marginBottom:20}},iconWithMessage:{display:"flex",gap:8},icon:{width:14,height:14,position:"relative",top:1,color:e[cn]}})),[i]),r=(0,P.VK)((()=>{var e;return null===(e=t[vn]())||void 0===e?void 0:e[on]()}),[t]);return l[an](l[nn],null,a()(j.Z,{title:l[an](u.FormattedMessage,D.dH.dateShiftingSectionCaption)},void 0,a()(Ge,{mode:null==r?void 0:r.mode})),a()(q,{style:n.wrap,showCloseButton:!1},void 0,a()("div",{style:n.iconWithMessage},void 0,A.Z.info(n.icon),a()(Q.Z,{isSmall:!0,isMultiline:!0},void 0,l[an](u.FormattedMessage,(0,D.uM)({currentDateShiftConfig:r,databaseType:o}))))))}function Pn(e){window.__c={n:"FeatureEnabledDependenciesSection"};const{[bn]:t,firstDatePropertyId:o,[yn]:i}=e,n=(0,C.O7)(),r=(0,u.useIntl)(),s=(0,P.VK)((()=>{var e;return null===(e=t[vn]())||void 0===e?void 0:e[on]()}),[t]),d=(0,l.useCallback)((e=>{const o=t[vn]();o&&y.createAndCommit({userAction:"FeatureEnabledDependenciesSection.handleConfigChange",environment:n,perform:t=>{Qi({[vn]:o,environment:n,intl:r,newConfig:e,transaction:t})}})}),[t,n,r]),c=(0,l.useMemo)((()=>({[tn]:s,...s?{[en]:s.date_property,endDatePropertyId:s.end_date_property}:{[en]:o}})),[s,o]);return a()(Wi,{[bn]:t,currentConfig:c,disabled:!i[Ji]||!i[Yi],onConfigChange:d})}function Tn(e){window.__c={n:"FeatureDisabledDependenciesSection"};const{[bn]:t,handleAddRelation:o,firstDatePropertyId:i,[yn]:n,databaseType:r}=e,[s,d]=(0,l.useState)({[en]:i,[tn]:{mode:"consume_gap",avoid_weekends:true}});return l[an](l[nn],null,a()(Wi,{[bn]:t,currentConfig:s,disabled:!n[Ji]||!n[Yi],onConfigChange:d}),a()(Li,{feature:Xi,[yn]:n,databaseType:r,handleAddRelation:()=>{o({featureType:Xi,dateShiftingConfig:s})}}))}function An(e){window.__c={n:"ToggleViewVisibilityMenuItem"};const{feature:t,featuredRelationProperty:o,[dn]:i,[yn]:n,databaseType:a}=e,r=(0,C.Fy)(),d=(0,T.yK)((()=>({eyeHideIcon:{width:20,height:r.isMobile?24:12,marginLeft:3}})),[r]);if(!o.supportedInView)return null;const c=o.enabledOnView,p=c?{icon:A.Z.eye}:{icon:A.Z.eyeHide,iconStyle:d.eyeHideIcon};return l[an](E.Z,s()({},p,{onClick:()=>{i.handlePropertySelect(c?void 0:o[fn])},title:l[an](u.FormattedMessage,(0,D.cn)({feature:t,isOn:c,databaseType:a})),disabled:!n[Ji]}))}var kn=o(41892),_n=o(80402),Mn=o(24006),xn=o(58032),Zn=o(60442);function In(e){const{render:t,showImage:o,caption:i,tooltipImage:n}=e,r=e.tooltipImageScale||1,[s,d]=l.useState(!1),[c,u]=l.useState({width:0,height:0});return l.useEffect((()=>{if(n){const e=new Image;e.src=n,e.onload=()=>{u({width:e.width*r,height:e.height*r}),d(!0)}}}),[n,r]),a()(xn.Z,{placement:xn.Z.Placement.Left,disableTooltip:void 0===i,style:{whiteSpace:"break-spaces"},render:t,renderTooltip:()=>n&&s&&o?a()(Zn.Z,{caption:i,imageURL:n,imageWidth:c.width,imageHeight:c.height}):a()("div",{},void 0,i)})}const Dn=o(85).Uie,Fn=o(85).q03,Vn=o(85).Yd$,Bn=o(85).tlU,En=o(85).mUE,Kn=o(85).d8n,Rn=o(85).Gpy,Nn=o(85).z45,On=o(85).aA_,Wn=o(85).W7g,Un=o(85).Ubq,Gn=o(85).f1x,Ln=o(85).Mcv,zn=o(85).MLn,Hn=o(85).TEz,qn=o(85)._Fe,jn=o(85).ChN,Qn=o(85).Exd,$n=o(85).eiN,Xn=o(85).AL1,Yn=o(85).Jkr,Jn=o(85).ewQ,ea=o(85).X_m,ta="box1-filter",oa="box2-filter";function ia(e){window.__c={n:"CollectionSettingsViewDependenciesPreview2"};const{propertyName:t,inversePropertyName:o}=e,i=(0,T.Fg)(),n=(0,T.yK)((e=>({svgWrap:{margin:"0px 12px",border:`1px solid ${e.regularDividerColor}`,borderRadius:4,alignItems:"center",position:"relative",[ea]:112,backgroundColor:e[Jn].gray[30],display:"flex",justifyContent:"center"}})),[]);return a()(j.Z,{disableMobileBorders:!0},void 0,a()("div",{style:n.svgWrap},void 0,a()("svg",{[Yn]:"266",[ea]:"116",fill:"none"},void 0,a()("path",{stroke:"#DFAF49",strokeWidth:"2",d:"M124 20h.426c7.703 0 17.307-.002 25.029 1.93 3.979.994 8.078 2.638 11.248 5.575C164.082 30.635 166 34.868 166 40c0 8.001-6.095 12.917-11.524 15.932-5.553 3.086-12.74 5.481-19.23 7.644l-.349.116c-6.919 2.307-13.074 4.381-17.546 6.866C112.655 73.166 112 75 112 76c0 1.868.582 2.885 1.453 3.692 1.08 1.001 2.981 1.982 6.002 2.737C125.59 83.963 132.773 84 141 84"}),a()("path",{stroke:"#E3E2E0",strokeWidth:"2",d:"M125 32c8.227 0 15.41.037 21.545 1.57 3.021.756 4.922 1.737 6.002 2.738.871.807 1.453 1.824 1.453 3.692 0 .999-.655 2.834-5.351 5.443-4.472 2.484-10.627 4.558-17.546 6.865l-.349.116c-6.49 2.163-13.677 4.558-19.23 7.644C106.095 63.084 100 67.998 100 76c0 5.132 1.918 9.365 5.297 12.495 3.17 2.937 7.269 4.581 11.248 5.576C124.267 96 133.871 96 141.574 96H142"}),a()("path",{fill:i[Jn].gray[30],d:"M157 27h16v18h-16zM92 70h16v18H92z"}),a()("path",{stroke:"#DFAF49",strokeWidth:"2",d:"M136 88l5-4-5-4"}),a()("path",{stroke:"#E3E2E0",strokeWidth:"2",d:"M130 36l-5-4 5-4"}),a()("g",{[$n]:"url(#box1-filter)"},void 0,a()("rect",{[Yn]:"100",[ea]:"28",x:"24",y:"12",fill:i.buttonBackground,rx:"3"}),a()(Xn,{x:"67",y:"31",fill:"#000"},void 0,"üå±")),a()("g",{[$n]:"url(#box2-filter)"},void 0,a()("rect",{[Yn]:"100",[ea]:"28",x:"142",y:"76",fill:i.buttonBackground,rx:"3"}),a()(Xn,{x:"185",y:"95",fill:"#000"},void 0,"üå≥")),a()(na,{x:"161",y:"26",[Yn]:"100",[ea]:"16",textStyles:{[Qn]:12,[jn]:590,color:i[qn]}},void 0,t),a()(na,{x:"15",y:"69",[Yn]:"90",[ea]:"16",textStyles:{color:i[Hn],[Qn]:12,[jn]:500,[zn]:Ln}},void 0,o),a()("defs",{},void 0,a()($n,{id:ta,[Yn]:"108",[ea]:"36",x:"20",y:"10",colorInterpolationFilters:"sRGB",filterUnits:Gn},void 0,a()("feFlood",{floodOpacity:"0",result:Un}),a()("feColorMatrix",{in:Wn,result:On,[Rn]:Nn}),a()("feMorphology",{in:Wn,[En]:"dilate",radius:"1",result:Kn}),a()("feOffset",{}),a()("feComposite",{in2:On,[En]:"out"}),a()("feColorMatrix",{[Rn]:Bn}),a()("feBlend",{in2:Un,result:Kn}),a()("feColorMatrix",{in:Wn,result:On,[Rn]:Nn}),a()("feOffset",{dy:"2"}),a()("feGaussianBlur",{stdDeviation:"2"}),a()("feComposite",{in2:On,[En]:"out"}),a()("feColorMatrix",{[Rn]:Vn}),a()("feBlend",{in2:Kn,result:Fn}),a()("feBlend",{in:"SourceGraphic",in2:Fn,result:"shape"})),a()($n,{id:oa,[Yn]:"108",[ea]:"36",x:"138",y:"74",colorInterpolationFilters:"sRGB",filterUnits:Gn},void 0,a()("feFlood",{floodOpacity:"0",result:Un}),a()("feColorMatrix",{in:Wn,result:On,[Rn]:Nn}),a()("feMorphology",{in:Wn,[En]:"dilate",radius:"1",result:Kn}),a()("feOffset",{}),a()("feComposite",{in2:On,[En]:"out"}),a()("feColorMatrix",{[Rn]:Bn}),a()("feBlend",{in2:Un,result:Kn}),a()("feColorMatrix",{in:Wn,result:On,[Rn]:Nn}),a()("feOffset",{dy:"2"}),a()("feGaussianBlur",{stdDeviation:"2"}),a()("feComposite",{in2:On,[En]:"out"}),a()("feColorMatrix",{[Rn]:Vn}),a()("feBlend",{in2:Kn,result:Fn}),a()("feBlend",{in:"SourceGraphic",in2:Fn,result:"shape"}))))))}function na(e){const{children:t,textStyles:o,...i}=e;return l.createElement("foreignObject",i,a()("div",{style:{..._.Z[Dn],...i[Yn]?{[Yn]:Number(i[Yn])}:{},...o}},void 0,t))}const aa=o(85).pkR,ra=(o(85).DFX,o(85).NKF),sa=o(85).XNW,la=o(85).PXg,da=o(85).Mnk,ca=o(85).qU4,ua=o(85).mSd,pa=o(85).Uww,ma=o(85).g9q,ga=o(85).LtW,ya=o(85).D7I,fa=o(85).nx5,va=o(85).D0f,ha=o(85).Yzm,Sa=o(85).UGA,ba=o(85).sRA,wa=o(85).rQ1,Ca=o(85).qq3,Pa=o(85).oWD,Ta=o(85).HxR,Aa=o(85).P24;function ka(e){var t;window.__c={n:"CollectionSettingsDependenciesAdvancedSettings"};const{[Aa]:o,[Ta]:i,feature:n}=e,r=(0,u.useIntl)(),d=(0,P.VK)((()=>o[Pa]()),[o]),c=(0,P.VK)((()=>o[Ca].state),[o]),p=(0,P.VK)((()=>o[wa].state),[o]),m=null===(t=Eo({[Aa]:o,feature:n}))||void 0===t?void 0:t.property,g=(0,P.VK)((()=>{var e;return m&&(null===(e=c[m])||void 0===e?void 0:e.name)}),[m,c]),y=(0,P.VK)((()=>{const e=m&&c[m];if(e&&"relation"===e.type){var t;const o=e.property;return o?null===(t=c[o])||void 0===t?void 0:t.name:void 0}}),[m,c]),f=(0,P.VK)((()=>{const e=o[Pa]();return null!=e&&e.isDefined()?F[ba](r,{sourceCollection:e.getModel(),isSelfRelation:!0,[Sa]:e,createUnique:!0,from:n}):r[ha]({id:va,[fa]:"Related to this database"})}),[o,r,n]),v=(0,P.qz)(void 0,V.Z),{initialPropertyName:h}=Fo({[Aa]:o,feature:n}),S=(0,l.useCallback)((e=>{e&&v.setState({open:!1})}),[v]);if(!d)return null;let b;return"subitem"===n?b=a()(ae,{propertyName:g||h,inversePropertyName:y||f,newDesign:!0}):"timeline_arrows_by"===n?b=a()(ia,{propertyName:g||h,inversePropertyName:y||f}):(0,k.unreachable)(n),l[ya](B.ZP,s()({},e,{title:l[ya](u.FormattedMessage,D.dH.advancedSettings)}),b,a()(j.Z,{disableMobileBorders:!0},void 0,a()(oi,{currentPropertyId:m,feature:n,onPropertySelect:S,[ga]:v,[Aa]:o,[Ta]:i,[wa]:p}),"subitem"===n&&a()(_a,{[Aa]:o,[wa]:p})))}function _a(e){window.__c={n:"ToggleNestingOnTitleMenuItem"};const{[Aa]:t,[wa]:o}=e,i=(0,u.useIntl)(),n=(0,C.O7)(),r=(0,P.VK)((()=>"title"===t[pa].state[ma]),[t]),d=!o[ua],c=(0,l.useCallback)((()=>{const e=t[ca]();e&&(_n.toggleTableSubitemToggleOnTitle({environment:n,[ca]:e,currentValue:t[pa].state[ma]}),Ye.trackConfigureView({environment:n,[Aa]:t,action:da}))}),[t,n]);return a()(In,{showImage:o[ua],caption:i[ha](D.dH.toggleNestingOnTitleMenuItemTooltip),tooltipImage:kn.Z.images.tooltips.collectionSettings.subitemsToggleOnTitlePng,tooltipImageScale:.3,render:e=>l[ya](E.Z,s()({},e,{icon:e=>A.Z.triangle({width:11,height:11,[la]:5,[sa]:6,transform:"rotateZ(180deg)"}),onClick:c,title:a()(u.FormattedMessage,{[fa]:"Show nesting toggle on title",id:ra}),right:a()(Mn.Z,{disallowTabbing:!0,on:r,[aa]:d,onClick:c}),[aa]:d}))})}var Ma=o(1302),xa=o(93959),Za=o(80072),Ia=o(89728);const Da=o(85).XNW,Fa=o(85).nLZ,Va=o(85).BQ6,Ba=o(85).uDf,Ea=o(85).UiR,Ka=o(85).jkI;function Ra(e){window.__c={n:"CollectionSettingsViewDependenciesPreview"};const{propertyName:t}=e,o=(0,T.Fg)(),i=(0,T.yK)((e=>({dependenciesPreviewOutsideBorder:{margin:"0px 12px",border:`1px solid ${e.regularDividerColor}`,borderRadius:4,alignItems:Ka,position:"relative",height:112,paddingLeft:19},svgContainer:{position:"absolute",width:"100%",height:"100%"},[Ea]:{stroke:e[Ba],strokeWidth:de.lf},dependencyPropertyNamePreview:{fontSize:12,position:"absolute",background:e.buttonBackground,top:48,left:96},timelineItemPreview:{padding:4,margin:"0px 12px",display:"flex",fontSize:14,alignItems:Ka,borderRadius:5,background:e.cardBackground,boxShadow:e.buttonBoxShadow,width:100,justifyContent:Ka}})),[]);return l.createElement(l.Fragment,null,a()(j.Z,{},void 0,a()("div",{[Va]:i.dependenciesPreviewOutsideBorder},void 0,a()("svg",{[Va]:i.svgContainer},void 0,a()(he.Z,{startPoint:{x:110,y:25},endPoint:{x:110,y:87},[Va]:i[Ea],showArrowHead:!0}),a()(he.Z,{startPoint:{x:210,y:87},endPoint:{x:223,y:87},[Va]:i[Ea],showArrowHead:!1}),a()("circle",{cx:223,cy:87,r:de.Wk,[Va]:i[Ea],fill:o.white})),a()("div",{[Va]:i.dependencyPropertyNamePreview},void 0,t),a()("div",{[Va]:{...i.timelineItemPreview,[Fa]:10,[Da]:10}},void 0,a()("span",{},void 0,"üå±")),a()("div",{[Va]:{...i.timelineItemPreview,[Fa]:34,[Da]:111}},void 0,a()("span",{},void 0,"üå≥")))))}const Na=o(85).LtW,Oa=(o(85).zmA,o(85).$Jh),Wa=o(85).zwB,Ua=o(85).BCA,Ga=o(85).tb8,La=o(85).Mm1,za=o(85).ccq,Ha=o(85).Ie8,qa=o(85).ceT,ja=o(85).pHx,Qa=o(85).E6w,$a=o(85).rpY,Xa=o(85).pkR,Ya=o(85).RvT,Ja=o(85).PXg,er=o(85).Dsi,tr=o(85).tBn,or=o(85).D7I,ir=o(85).PG2,nr=o(85).Jkr,ar=(o(85).FJS,o(85).cZW),rr=o(85).Uk6,sr=o(85).XNW,lr=o(85).wuN,dr=o(85).mSd,cr=o(85).Mnk,ur=o(85)._tz,pr=o(85).ebo,mr=o(85).ZG6,gr=o(85).xPL,yr=o(85).MsU,fr=o(85).mYq,vr=o(85).ddU,hr=o(85).jQT,Sr=o(85).rMr,br=o(85).wgE,wr=o(85).n32,Cr=o(85).Drs,Pr=o(85).JJj,Tr=o(85).dlB,Ar=o(85).Zij,kr=o(85).LCr,_r=o(85).qU4,Mr=o(85).TtP,xr=o(85).zIe,Zr=o(85).Yb8,Ir=o(85).jI3,Dr=o(85).Uww,Fr=o(85).g9q,Vr=o(85).D0f,Br=o(85).sRA,Er=o(85).xIw,Kr=o(85).Yzm,Rr=o(85).UGA,Nr=o(85).wM4,Or=o(85).dQ2,Wr=o(85)._fd,Ur=o(85).ffk,Gr=o(85).aKz,Lr=o(85).qLW,zr=o(85).oWD,Hr=o(85).qq3,qr=o(85).QmD,jr=o(85).nR5,Qr=o(85).HxR,$r=o(85).P24,Xr=o(85).nx5,Yr=(0,u.defineMessages)({subitemInputPlaceholder:{[Xr]:"Sub-tasks‚Ä¶",id:"database.viewSettings.relationsPropertyTab.subitemInputPlaceholder"},timelineArrowsByInputPlaceholder:{[Xr]:"Dependencies‚Ä¶",id:"database.viewSettings.relationsPropertyTab.timelineArrowsByInputPlaceholder"}});const Jr=(0,u.injectIntl)((function(e,t){window.__c={n:"CollectionSettingsViewRelationsProperty"};const{[$r]:o,[Qr]:i,formatSetting:n}=e,r=(0,C.Fy)(),d=(0,u.useIntl)(),c=(0,C.O7)(),p=jr,[f]=(0,l.useState)("no_limit"),v="subitem"===n,h="timeline_arrows_by"===n,S=(0,P.VK)((()=>o[Hr][qr]),[o]),b=(0,P.VK)((()=>o[zr]()),[o]),w=(0,P.VK)((()=>(null==b?void 0:b[Lr]())??{}),[b]),k=(0,P.VK)((()=>{var e;return v?null===(e=o[Gr][qr])||void 0===e?void 0:e[Ur]:h?o[Wr][qr]:void 0}),[o,v,h]),_=(0,P.VK)((()=>{var e,t,i,n;return v?null===(e=o[zr]())||void 0===e||null===(t=e[Lr]())||void 0===t?void 0:t[Or]:h?null===(i=o[zr]())||void 0===i||null===(n=i[Lr]())||void 0===n?void 0:n[Nr]:void 0}),[o,v,h]),M=(0,P.VK)((()=>o.permissionScopes[qr]),[o]),x=(0,P.VK)((()=>F.getSelfRelationProperties(o,S)),[o,S]),Z=(0,P.VK)((()=>o[Hr][qr]),[o]),I=(0,P.VK)((()=>{var e;const t=o[Gr][qr],i=o[Wr][qr];let n;return v?n=t?S[t[Ur]]:void 0:h&&(n=i?S[i]:void 0),null===(e=n)||void 0===e?void 0:e.name}),[o,S,v,h]),K=(0,P.VK)((()=>{const e=o[zr]();return null!=e&&e.isDefined()?F.getSuggestedRelationName(d,{[Rr]:e,isSelfRelation:!0,sourceSchema:Z,createUnique:!0,from:n}):d[Kr]({id:Er,[Xr]:"Related to target"})}),[o,Z,d,n]),[R,N]=(0,l.useState)(I||K),O=R===K,W=(0,P.VK)((()=>{const e=o[Gr][qr],t=o[Wr][qr];let i;if(v?i=e?S[e[Ur]]:void 0:h&&(i=t?S[t]:void 0),i&&"relation"===i.type){var n;const e=i[Ur];return e?null===(n=S[e])||void 0===n?void 0:n.name:void 0}}),[o,S,v,h]),U=(0,P.VK)((()=>{const e=o[zr]();return null!=e&&e.isDefined()?F[Br](d,{sourceCollection:e.getModel(),isSelfRelation:!0,[Rr]:e,createUnique:!0,from:n}):d[Kr]({id:Vr,[Xr]:"Related to this database"})}),[o,d,n]),G=(0,P.VK)((()=>"title"===o[Dr][qr][Fr]),[o]),[L,z]=(0,l.useState)({[Ir]:!0,[Zr]:W,[xr]:{enabled:!1}}),[H,q]=(0,l.useState)(0===x[Mr]),Q=(0,P.VK)((()=>(0,xa.$4)()),[]),$=(0,P.qz)(void 0,V.Z),X=(0,P.Kw)($),Y=(0,l.useCallback)((()=>F.getSelfRelationProperties(o,S)),[o,S]),J=(0,l.useCallback)((e=>{if(e){const t=S[e];if(t&&"relation"===t.type){const e=t[Ur];if(e){const t=S[e];if(t&&L){const e=t.name;z({[Ir]:null==L?void 0:L[Ir],[Zr]:e,[xr]:null==L?void 0:L[xr]})}}N(t.name)}}}),[S,L,N]),ee=(0,l.useCallback)((e=>{const{[_r]:t,newProperty:o,[kr]:i}=e;v?(ao.dR({[_r]:t,propertyId:o,[kr]:i}),(0,re.isUndefined)(t[Lr]()[Fr])&&g.updateFormat({stores:[t],update:{[Fr]:Ar},[kr]:i})):h&&no.setTimelineArrowsByRelation({[_r]:t,newProperty:o,[kr]:i})}),[v,h]),te=(0,l.useCallback)((e=>{const{[Tr]:t,[kr]:i}=e;v&&ao.jA({[$r]:o,[Tr]:t,[kr]:i}),h&&no.setDefaultArrowsByRelation({[$r]:o,[Tr]:t,[kr]:i})}),[o,v,h]),oe=(0,l.useCallback)((e=>{const t=o[_r]();t&&(y[Pr]({[Cr]:wr,[br]:c,perform:o=>{ee({[_r]:t,newProperty:e,[kr]:o}),te({[Tr]:e,[kr]:o})}}),J(e),q(!1),m[Sr]({[Qr]:i}),Ye[hr]({action:v?"update_default_subitem":"update_default_timeline_arrows_by",[vr]:void 0,[fr]:e?yr:void 0,[br]:c,[$r]:o}))}),[o,c,q,J,i,v,ee,te]),ie=(0,l.useCallback)((e=>{const t=o[_r]();t&&(y[Pr]({[Cr]:gr,[br]:c,perform:o=>{ee({[_r]:t,newProperty:e,[kr]:o})}}),J(e),q(!1),m[Sr]({[Qr]:i}),Ye[hr]({action:v?"update_subitem":"update_timeline_arrows_by",[vr]:void 0,[fr]:e?yr:void 0,[br]:c,[$r]:o}))}),[o,c,J,i,v,ee]),ne=(0,l.useCallback)((()=>{Ma.default[mr]((()=>{q(!0),z({[Ir]:!0,[Zr]:U,[xr]:{enabled:!1}}),N(K)}))}),[U,K]),se=(0,l.useCallback)((()=>{if(!L)return;const{[Ir]:e,[Zr]:t,[xr]:a}=L,r=o[zr](),s=r,l=o[_r]();r&&s&&(y[Pr]({[Cr]:pr,[br]:c,perform:i=>{const u=Je.G3({[br]:c,[zr]:r,collectionViewArgs:l&&p?{[_r]:l,format:l[Lr](),formatKey:p}:void 0,propertyType:yr,[kr]:i});return io.n7({[br]:c,[$r]:o,[zr]:r,[Ur]:u,[ur]:R,[Rr]:s,[Ir]:e,[Zr]:t,[xr]:a,propertyLimit:f,intl:d,[kr]:i,from:n}),l&&(ee({[_r]:l,newProperty:u,[kr]:i}),te({[Tr]:u,[kr]:i})),u}}),m.popSettingsItem({[Qr]:i}),m.navigateToItem({[Qr]:i,item:{type:"main"}}),Ye.trackCreateProperty({[br]:c,[$r]:o,from:n,[fr]:yr}))}),[o,c,i,p,d,f,R,L,n,ee,te]),le=(0,l.useCallback)((()=>{const e=o[_r]();e&&(_n.toggleTableSubitemToggleOnTitle({[br]:c,[_r]:e,currentValue:o[Dr][qr][Fr]}),Ye[hr]({[br]:c,[$r]:o,action:cr}))}),[o,c]),de=!M[dr],ce=(0,T.yK)((e=>({emptyStateText:{color:e[lr],fontSize:14,margin:"0px 12px"},useExistingTitle:{fontSize:12,color:e[lr],[sr]:12,marginTop:12}})),[]);if(!b)return null;const ue=v&&M[dr]&&I&&Q,pe=M[rr],me=(e,t,i,n)=>a()(xt,{version:"v1",menuProps:e,[Ur]:t,defaultProperty:_,checkState:i,propertySchema:n,[$r]:o,handleDefaultPropertySelect:oe,handlePropertySelect:ie});return l[or](B.ZP,s()({},e,{[Ar]:a()(u.FormattedMessage,v?{[Xr]:"Sub-items",id:"database.viewSettings.subItemsTab.title"}:{[Xr]:"Dependencies",id:"database.viewSettings.dependenciesTab.title"}),footer:a()(j.Z,{topBorder:x[Mr]>0&&!H},void 0,ue&&!H&&a()(In,{showImage:!de,caption:Et.default[Kr](D.dH.toggleNestingOnTitleMenuItemTooltip),tooltipImage:kn.Z.images[er].collectionSettings.subitemsToggleOnTitlePng,tooltipImageScale:.3,[$a]:e=>l[or](E.Z,s()({},e,{icon:e=>A.Z.triangle({[nr]:11,height:11,[Ja]:5,[sr]:6,[Ya]:"rotateZ(180deg)"}),[Ar]:a()(u.FormattedMessage,{[Xr]:"Show nesting toggle on title",id:"database.viewSettings.layoutTab.tableSubitemToggleOnTitle"}),right:a()(Mn.Z,{disallowTabbing:!0,on:G,[ir]:le,[Xa]:de}),[Xa]:de,isGray:!0,[ir]:le}))}),pe&&x[Mr]>0&&!H&&a()(E.Z,{icon:A.Z.plus,[Ar]:a()(u.FormattedMessage,{id:"database.viewSettings.subitemTab.newRelation",[Xr]:"Create new relation"}),isGray:!0,[ir]:ne}),!H&&l[or](l[tr],null,M[dr]&&!M[rr]?a()(E.Z,{[Ar]:a()(u.FormattedMessage,{id:"database.viewSettings.relationsPropertyTab.removeSubitemRelation.removeSubitemButton.title",[Xr]:"Turn off for this view"}),isRed:!0,[ir]:()=>ie(void 0)}):M[dr]&&a()(st.ZP,{popupType:r[Qa]?oo.kQ[ja]:oo.kQ.Popup,alignmentToOrigin:st.vR.End,[za]:st.pO.Bottom,originGap:0,renderOrigin:e=>l[or](l[tr],null,!(!M[dr]||!k)&&l[or](E.Z,s()({isGray:!0,icon:A.Z.trash,[Ar]:a()(u.FormattedMessage,v?{[Xr]:"Turn off sub-items",id:"database.viewSettings.relationsPropertyTab.removeSubItemsButton.title"}:{[Xr]:"Turn off dependencies",id:"database.viewSettings.relationsPropertyTab.removeDependenciesButton.title"}),isRed:!0},e))),[$a]:e=>{let t;return t=r[Qa]?{[qa]:at.og[Ha]}:{[qa]:at.og.Popup,[nr]:300},l[or](lt.Z,s()({},t,{footer:a()(j.Z,{topBorder:!0},void 0,M[dr]&&a()(E.Z,{[Ar]:a()(u.FormattedMessage,{id:"database.viewSettings.relationsPropertyTab.removeRelation.removeRelationButton.title",[Xr]:"Turn off for this view"}),isRed:!0,[ir]:()=>ie(void 0)}),M[rr]&&a()(E.Z,{[Ar]:a()(u.FormattedMessage,{[Xr]:"Turn off for all new views",id:"database.viewSettings.relationsPropertyTab.removeRelation.removeAllDefaultButton.title"}),isRed:!0,[ir]:()=>{oe(void 0)}}))}))}})))}),v&&a()(ae,{[ur]:R||K,inversePropertyName:(null==L?void 0:L[Zr])||U,newDesign:!1}),h&&a()(Ra,{[ur]:R||K}),!H&&a()("div",{style:ce.useExistingTitle},void 0,a()(u.FormattedMessage,{[Xr]:"Use an existing relation",id:"database.viewSettings.relationsPropertyTab.useExistingRelation.title"})),x[Mr]>0&&!H?a()("div",{style:{[La]:"6px"}},void 0,a()(j.Z,{},void 0,a()(st.ZP,{[Na]:$,[$a]:e=>{let t;return t=r[Qa]?{[qa]:at.og[Ha]}:{[qa]:at.og.Popup,[nr]:300},l[or](lt.Z,s()({},t,{footer:a()(rt.Z,{schema:S,format:w,[Ga]:Y,[Ua]:M[dr]&&!M[rr]?ie:()=>{},[Wa]:Et.default[Kr](v?Yr.subitemInputPlaceholder:Yr.timelineArrowsByInputPlaceholder),currentProperty:k,defaultShowPropertyCount:5,[Oa]:M[dr]&&!M[rr]?void 0:me})}))},renderOrigin:e=>{var t;return l[or](E.Z,s()({[Ar]:a()(u.FormattedMessage,{id:"database.viewSettings.relationsPropertyTab.existingRelation",[Xr]:"Property"}),showChevron:!0,right:k?null===(t=S[k])||void 0===t?void 0:t.name:void 0,rotateChevron:X.open,[Xa]:!1,icon:A.Z.typesRelation},e))},popupType:r[Qa]?oo.kQ[ja]:oo.kQ.Popup,alignmentToOrigin:st.vR.End,[za]:st.pO.Bottom,originGap:0}))):pe&&l[or](l[tr],null,a()(j.Z,{},void 0,a()("div",{style:ce.emptyStateText},void 0,a()(u.FormattedMessage,{[Xr]:"Rename (optional)",id:"database.viewSettings.relationsPropertyTab.emptyStateDescription"}))),a()(j.Z,{},void 0,a()(Ot.ZP,{value:R,[ar]:R,onChange:e=>N(e.target.value),onBlur:()=>{},onSubmit:()=>{},focusInitial:!0,selectAll:!1})),a()(Za.Z,{[$r]:o,[Rr]:b,[Ur]:void 0,buttonContents:a()(u.FormattedMessage,{[Xr]:"Create",id:"database.viewSettings.relationsPropertyTab.createButton.title"}),temporaryInverseState:L,setTemporaryInverseState:z,isInitialPropertyName:O,onSubmit:se,from:n}),x[Mr]>0&&a()("div",{style:{margin:"auto",textAlign:"center"}},void 0,a()(Ia.Z,{[ir]:()=>{Ma.default[mr]((()=>{q(!1)}))},isGray:!0,style:{margin:"6px 12px 6px 12px",[nr]:"auto"}},void 0,a()(u.FormattedMessage,{id:"database.viewSettings.relationsPropertyTab.newRelation",[Xr]:"Use existing relation"})))))}));var es=o(77719),ts=o(98742),os=o(30874);const is=o(85).YjJ,ns=o(85).j7K,as=o(85).J4z,rs=o(85).Joh,ss=o(85).D7I,ls=o(85).ESK,ds=o(85).rpY,cs=o(85).y79,us=o(85).wgE,ps=o(85).nx5,ms=o(85).ydX,gs=o(85).P24,ys=o(85).HxR,fs=o(85).VUQ;function vs(e){window.__c={n:"CollectionSettingsAccountPicker"};const{[fs]:t,[ys]:o,[gs]:i,onAccountSelect:n}=e,r=(0,T.yK)((()=>({settingsMenu:{display:"flex",flexGrow:1,flexDirection:"column",padding:"8px 16px 16px 8px"}})),[]),d=(0,C.O7)(),c=(0,P.VK)((()=>{var e;return null===(e=i.collectionStore())||void 0===e?void 0:e.getSpaceId()}),[i]),p=(0,P.VK)((()=>{const e=os.Z.state;return e.loaded?e[ms].filter((e=>e.integration_id===t.id)):[]}),[t]);return t&&c?l[ss](B.ZP,s()({},e,{title:a()(u.FormattedMessage,{[ps]:"Choose an account",id:"collectionSettingsAccountPicker.title"}),footer:hs({[us]:d,[fs]:t,spaceId:c})}),a()("div",{style:r.settingsMenu},void 0,a()(Wt.Z,{type:Wt.i[cs],[ns]:0,sections:[{key:ms,items:p.map((e=>({key:e.id,[ds]:o=>a()(xn.Z,{[rs]:()=>a()("span",{},void 0,e.account_name),placement:xn.Z[ls].Left,textWrap:!0,[ds]:i=>l[ss](Nt.Z,s()({},(0,ts.Z)(i||{},o),{title:e.account_name,icon:a()("img",{style:{width:18},src:t.info.icon}),focused:o.focused}))}),action:()=>{m[as]({[ys]:o}),n(e)}}))),[ds]:e=>l[ss](j.Z,e)}]}))):null}function hs(e){const t=e[us].device.isMobileBrowser;return a()(j.Z,{topBorder:!0,children:t?void 0:Ss(e)})}function Ss(e){return l[ss](E.Z,s()({},e,{icon:A.Z.plus,title:a()(u.FormattedMessage,{id:"collectionSettingsAccountPicker.addAccount",[ps]:is}),isGray:!0,onClick:async()=>{await es.hM({...e,from:"source_picker_connect_another_account"})}}))}var bs=o(66897),ws=o(63362),Cs=o(3865),Ps=o(76205),Ts=o(80951),As=o(39068),ks=o(7057),_s=o(78106),Ms=o(76218),xs=o(42875),Zs=o(606),Is=o(21202),Ds=o(70203),Fs=o(98963),Vs=o(51456),Bs=o(97428),Es=o(23290),Ks=o(1274),Rs=o(26825),Ns=o(68626),Os=o(18844),Ws=o(77420),Us=o(6287),Gs=o(13493),Ls=o(10161),zs=o(39098),Hs=o(8323);const qs=o(85).KfU,js=o(85).PLy,Qs=o(85).HXm,$s=o(85).mEk,Xs=o(85).uKy,Ys=o(85).LFy,Js=o(85).yL5,el=o(85).tl4,tl=o(85).BpB,ol=o(85).LTP,il=o(85).YsR,nl=o(85).EjX,al=o(85).cMN,rl=o(85).$Qz,sl=o(85).Yzm,ll=o(85).Io9,dl=o(85)._tz,cl=o(85).lQJ,ul=o(85).n8N,pl=o(85).eAw,ml=o(85).nx5,gl=o(85).k9$,yl=o(85).qU4,fl=o(85).FBB,vl=o(85).oZp,hl=o(85).d99,Sl=o(85).unR,bl=o(85).xw1,wl=o(85).j4K,Cl=o(85).Qjq,Pl=o(85).JmH,Tl=o(85).TLr,Al=o(85).BP7,kl=o(85).dL6,_l=o(85).UBi,Ml=o(85).oWD,xl=o(85).MjK,Zl=o(85).VXW,Il=o(85).bni,Dl=o(85).AnB,Fl=o(85).sbn,Vl=o(85).EQe,Bl=o(85).byI,El=o(85).nm$,Kl=o(85).Gpy,Rl=o(85).yn7,Nl=o(85).Ql2,Ol=o(85).FH8,Wl=o(85).jes,Ul=o(85).h$M,Gl=o(85).BJA,Ll=o(85).TtP,zl=o(85).eiN,Hl=o(85).ffk,ql=o(85).qYR,jl=o(85).gxE,Ql=o(85).lw5,$l=o(85).oNU,Xl=o(85).MWD,Yl=o(85).mFu,Jl=o(85).v1$,ed=o(85).X5t,td=o(85).UXD;function od(e){return e[td]("event")||e[td]("notification_event")}function id(e){var t;const{[ed]:o,automationValue:i}=e;return(null===(t=i[Jl])||void 0===t?void 0:t.name)!==o.name?{...i,[Jl]:{...i[Jl],name:o.name}}:i}function nd(e){const{[ed]:t,automationValue:o}=e,i=t[Yl],n=i.table===Us.v?{[Yl]:i,[Xl]:Us.v}:{[Yl]:i,[Xl]:Gs.n};return{...o,[$l]:{...o[$l],[Ql]:{...o[$l][Ql],source:n}}}}function ad(e){const{[ed]:t,automationValue:o}=e,i=t[$l];if("page_added"===i[Xl])return o[$l][Ql][jl]?o:{...o,[$l]:{...o[$l],[Ql]:{...o[$l][Ql],[jl]:!0}}};if("any_page_property_edited"===i[Xl])return"any"!==o[$l][Ql][ql][Xl]?{...o,[$l]:{...o[$l],[Ql]:{...o[$l][Ql],[ql]:{[Xl]:"any"}}}}:o;if("property_changed"===i[Xl]){const e="some"===o[$l][Ql][ql][Xl]?o[$l][Ql][ql].some:[],t=se().findIndex(e,(e=>e[Hl]===i[Hl])),n={[zl]:i[zl],[Hl]:i[Hl]},a=-1===t?[...e,n]:e.map((e=>e[Hl]===i[Hl]?n:e));return{...o,[$l]:{...o[$l],[Ql]:{...o[$l][Ql],[ql]:{some:a,[Xl]:"some"}}}}}(0,k.unreachable)(i)}function rd(e){const{[ed]:t,automationValue:o}=e,i=t[$l];if("page_added"===i[Xl])return o[$l][Ql][jl]?{...o,[$l]:{...o[$l],[Ql]:{...o[$l][Ql],[jl]:!1}}}:o;if("any_page_property_edited"===i[Xl])return"any"===o[$l][Ql][ql][Xl]?{...o,[$l]:{...o[$l],[Ql]:{...o[$l][Ql],[ql]:{[Xl]:"none"}}}}:o;if("property_changed"===i[Xl]){const e=("some"===o[$l][Ql][ql][Xl]?o[$l][Ql][ql].some:[])[zl]((e=>e[Hl]!==i[Hl]));return{...o,[$l]:{...o[$l],[Ql]:{...o[$l][Ql],[ql]:e[Ll]>0?{some:e,[Xl]:"some"}:{[Xl]:"none"}}}}}(0,k.unreachable)(i)}function sd(e){const{[ed]:t,actionValue:o,automationValue:i}=e;var n,a,r,s,l,d;if("create_page"===t[ed][Xl]){if(!o||"create_page"===o[Xl])return jd({[Gl]:t[ed].id,automationId:i.id,[Ul]:(null===(n=t[ed][Wl])||void 0===n?void 0:n[Ol])??(null==o||null===(a=o[Wl])||void 0===a?void 0:a[Ol]),[Jl]:(null===(r=t[ed][Wl])||void 0===r?void 0:r[Jl])??(null==o||null===(s=o[Wl])||void 0===s?void 0:s[Jl]),[Nl]:i[Rl],[Kl]:(null===(l=t[ed][Wl])||void 0===l?void 0:l[Kl])??(null==o||null===(d=o[Wl])||void 0===d?void 0:d[Kl])})}else if("update_pages"===t[ed][Xl]){var c,u,p,m,g,y;if(!o||"update_pages"===o[Xl])return Qd({[Gl]:t[ed].id,automationId:i.id,[Jl]:(null===(c=t[ed][Wl])||void 0===c?void 0:c[Jl])??(null==o||null===(u=o[Wl])||void 0===u?void 0:u[Jl]),[Nl]:i[Rl],[El]:(null===(p=t[ed][Wl])||void 0===p?void 0:p[El])??(null==o||null===(m=o[Wl])||void 0===m?void 0:m[El]),[Kl]:(null===(g=t[ed][Wl])||void 0===g?void 0:g[Kl])??(null==o||null===(y=o[Wl])||void 0===y?void 0:y[Kl])})}else if("slack_notification"===t[ed][Xl]){var f,v,h,S;if(!o||"slack_notification"===o[Xl])return $d({[Gl]:t[ed].id,automationId:i.id,externalBotId:(null===(f=t[ed][Wl])||void 0===f?void 0:f[Bl])??(null==o||null===(v=o[Wl])||void 0===v?void 0:v[Bl]),[Nl]:i[Rl],[El]:(null===(h=t[ed][Wl])||void 0===h?void 0:h[El])??(null==o||null===(S=o[Wl])||void 0===S?void 0:S[El])})}else{if("duplicate_blocks"===t[ed][Xl]||"modal_confirmation"===t[ed][Xl]||"open_page"===t[ed][Xl]||"query_collection"===t[ed][Xl])return;(0,k.unreachable)(t[ed])}}function ld(e){const{[Vl]:t,currentUserId:o,inMemoryRecordCache:i}=e;return(0,P.VK)((()=>{const e=null==t?void 0:t.getRole(),n=null==t?void 0:t[Fl](),a=(null==t?void 0:t[Dl]().map((e=>e[Fl]()))[zl](k.isDefined))??[],r=null==t?void 0:t[Yl];return t=>{if(o&&e&&n&&r){if(!(0,Cs.Vd)(n)&&!(0,Cs.nl)(n))return n;if("update_name"===t[Xl]){const a=id({[ed]:t,automationValue:n});n!==a&&(i[Il]({[Yl]:r,[Zl]:o},{role:e,value:a}),i.emitAll())}else if("update_source"===t[Xl]){const a=nd({[ed]:t,automationValue:n});n!==a&&(i[Il]({[Yl]:r,[Zl]:o},{role:e,value:a}),i.emitAll())}else if("update_trigger"===t[Xl]){const a=ad({[ed]:t,automationValue:n});n!==a&&(i[Il]({[Yl]:r,[Zl]:o},{role:e,value:a}),i.emitAll())}else if("update_action"===t[Xl]){var s;const l=a.find((e=>e.id===t[ed].id)),d=sd({[ed]:t,actionValue:l,automationValue:n});if(!d)return;if(i[Il]({[Yl]:{id:d.id,[Nl]:n[Rl],table:Os.Xj},[Zl]:o},{role:"editor",value:d}),null===(s=n[xl])||void 0===s||!s.includes(d.id)){const t={...n,[xl]:[...n[xl]??[],d.id]};i[Il]({[Yl]:r,[Zl]:o},{role:e,value:t})}i.emitAll()}else if("remove_action"===t[Xl]){const a=t[ed].id;i.deleteRecord({[Yl]:{id:a,[Nl]:n[Rl],table:Os.Xj},[Zl]:o});const s={...n,[xl]:(n[xl]??[])[zl]((e=>e!==a))};i[Il]({[Yl]:r,[Zl]:o},{role:e,value:s}),i.emitAll()}else if("remove_trigger"===t[Xl]){const a=rd({[ed]:t,automationValue:n});n!==a&&(i[Il]({[Yl]:r,[Zl]:o},{role:e,value:a}),i.emitAll())}else(0,k.unreachable)(t)}}}),[t,o,i])}function dd(e){const{[Vl]:t,[Ml]:o}=e,i=o[_l](),n=t[kl](Jl)[kl]("name")[Fl]();if(null==n||!n.trim())return!1;const a=t.getTrigger(),r="event"===(null==a?void 0:a[Xl]),s="notification_event"===(null==a?void 0:a[Xl]);if(!r&&!s)return!1;const{[jl]:l,[ql]:d}=a[Ql];if("some"===d[Xl]&&d.some.some((e=>fd({collectionSchema:i,[Hl]:e[Hl]}))))return!1;if(!l&&("none"===d[Xl]||"some"===d[Xl]&&0===d.some[Ll]))return!1;const c=t[Dl]();return 0!==c[Ll]&&c.every((e=>cd(e,o)))}function cd(e,t){if(e.isType("slack_notification"))return(0,k.isDefined)(e[Al]()[kl]("external_bot_id")[Fl]())&&(0,k.isDefined)(e[Al]()[kl]("target")[Fl]());if(e.isType("update_pages")){const o=e[Al]()[kl](El)[Fl](),i=e[Al]()[kl]("properties")[Fl]()??[];if(!(0,k.isDefined)(o)||0===i[Ll])return!1;if("collection"===o[Xl]){const e=zs.NW[Tl](t,o[Ol])[_l]();if(i.some((t=>fd({[Hl]:t,collectionSchema:e}))))return!1}else if("variable"===o[Xl]){const e=(0,_s.MY)(o.id);if("global"!==e.source||"button_page"!==e.global)return!1;{const e=t[_l]();if(i.some((t=>fd({[Hl]:t,collectionSchema:e}))))return!1}}else{if("page"===o[Xl])return!1;(0,k.unreachable)(o)}return!0}if(e.isType("create_page")){const o=e[Al]()[kl](Ol)[Fl]();if(!(0,k.isDefined)(o))return!1;const i=zs.NW[Tl](t,o)[_l]();return!(e[Al]()[kl]("properties")[Fl]()??[]).some((e=>fd({[Hl]:e,collectionSchema:i})))}throw new Error(`isActionStoreComplete not implemented for ${e.getType()}`)}function ud(e){const{[Ml]:t}=e;if(!t)return!1;if((t.getFormat().automation_ids??[])[Ll]>=Es.ss&&!(0,Hs.isPlusTierOrAbove)())return!1;const o=t[Yl],i=t[Pl]();return(0,Ks.IC)({targetTriggerType:Ql,targetParentPointer:o,targetSpaceId:i}).every((e=>{let{[Yl]:o,[Cl]:i}=e;const n=t[wl](o);return!!n&&(0,Rs.roleIsGreaterThanOrEqualTo)(n,i)}))}function pd(e){const{[Ml]:t}=e;if(!t)return!1;const o=t[Yl],i=t[Pl]();return(0,Ks.IC)({targetTriggerType:bl,targetParentPointer:o,targetSpaceId:i}).every((e=>{let{[Yl]:o,[Cl]:i}=e;const n=t[wl](o);return!!n&&(0,Rs.roleIsGreaterThanOrEqualTo)(n,i)}))}function md(e){const{[Vl]:t,actionStores:o}=e;if(Ls.default[Sl]("status_automations_m2")&&!(0,Hs.isPlusTierOrAbove)())return!1;const i=t.getMinimumFieldsForPermissions();if(!i)return!1;if(!o.every((e=>e.isDefined())))return!1;return(0,Ks.fz)({automationValue:i,actionValues:o.map((e=>({[Wl]:e.getConfig(),[Xl]:e.getType()})))}).every((e=>{let{[Yl]:o,[Cl]:i}=e;const n=t[wl](o);return!!n&&(0,Rs.roleIsGreaterThanOrEqualTo)(n,i)}))}function gd(e){const{[Vl]:t}=e,o=t.getMinimumFieldsForPermissions();if(!o)return!1;return(0,Ks.bM)(o).every((e=>{let{[Yl]:o,[Cl]:i}=e;const n=t[wl](o);return!!n&&(0,Rs.roleIsGreaterThanOrEqualTo)(n,i)}))}function yd(e){const{anyOptionCheckState:t,currentFilter:o,propertyId:i,updateCurrentState:n}=e;!0===t?n({[Xl]:hl,[$l]:{[Xl]:vl,[Hl]:i,[zl]:{operator:fl}}}):!1===t?n({[Xl]:"remove_trigger",[$l]:{[Xl]:vl,[Hl]:i,[zl]:{operator:fl}}}):"partial"===t?n({[Xl]:hl,[$l]:{[Xl]:vl,[Hl]:i,[zl]:o}}):(0,k.unreachable)(t)}function fd(e){const{[Hl]:t,collectionSchema:o}=e;return!!o&&!o[t]}function vd(e){const{[Vl]:t,[Ml]:o}=e,i=t.getTrigger();if(!i||"event"!==i[Xl]&&"notification_event"!==i[Xl])return!1;const n=i[Ql].source;if(n[Xl]===Us.v||"filter"===n[Xl])return!1;const a=zs.Xr[Tl](o,n[Yl]);return hd({collectionSchema:o[_l](),[yl]:a})}function hd(e){const t=Sd(e);return(0,k.isDefined)(t)}function Sd(e){var t;const{[yl]:o,collectionSchema:i}=e,n=o.getPropertyFiltersStore()[Fl]()??[],a=null===(t=o.getQuery(i))||void 0===t?void 0:t[zl],r={operator:"and",filters:(0,Ps.OH)({propertyFilters:n,combinatorFilter:a,schema:i})},s=(0,Ps.SH)(r,(e=>{if((0,Ps.aN)(e)){const t=i[e[Hl]];return!!t&&!(0,Cs.TX)(t)}return!1}));if(s)return(0,Ps.aN)(s)?s[Hl]:(0,Ps.Mm)(s)?s.timestamp:void 0}function bd(e){if(!e)return!1;if(e[gl]()&&!Ls.default[Sl]("support_synced_database_automations"))return!1;if(ud({[Ml]:e}))return!0;return e.getAutomationStores()[Ll]>0}function wd(e){if(!e)return!1;if(e[gl]()&&!Ls.default[Sl]("support_synced_database_automations"))return!1;if(pd({[Ml]:e}))return!0;return e.getAutomationStores()[zl]((e=>e[td](bl)))[Ll]>0}function Cd(e){const{collectionSchema:t,propertyIds:o,searchTerm:i}=e;if(!i)return o.slice(0);const n=new Map,a=o.map((e=>{const o=t[e],i=o?`${o.name} ${Bt.SO[o[Xl]]}`:"";return n.set(e,i),i})),r=Ft()[zl](i,a).map((e=>{let{original:t}=e;return t}));return o[zl]((e=>r.includes(n.get(e)??"")))}const Pd=(0,u.defineMessages)({actionCheckboxPropertyChecked:{[ml]:"checked",id:"automations.action.checkboxProperty.checked"},actionCheckboxPropertySetSingle:{[ml]:pl,id:"automations.action.checkboxProperty.single"},actionCheckboxPropertyUnchecked:{[ml]:"unchecked",id:"automations.action.checkboxProperty.unchecked"},actionDatePropertyClear:{[ml]:ul,id:"automations.action.dateProperty.clear"},actionDatePropertySetSingle:{[ml]:pl,id:"automations.action.dateProperty.single"},actionPersonPropertyClear:{[ml]:ul,id:"automations.action.personProperty.clear"},actionPersonPropertySetSingle:{[ml]:pl,id:"automations.action.personProperty.single"},actionPersonPropertySetMultiple:{[ml]:cl,id:"automations.action.personProperty.multiple"},actionRelationPropertyClear:{[ml]:ul,id:"automations.action.relationProperty.clear"},actionRelationPropertySetMultiple:{[ml]:cl,id:"automations.action.relationProperty.multiple"},actionRelationPropertySetSingle:{[ml]:pl,id:"automations.action.relationProperty.single"},actionSelectPropertyClear:{[ml]:ul,id:"automations.action.selectProperty.clear"},actionSelectPropertySetMultiple:{[ml]:cl,id:"automations.action.selectProperty.multiple"},actionSelectPropertySetSingle:{[ml]:pl,id:"automations.action.selectProperty.single"},actionStatusPropertySetSingle:{[ml]:pl,id:"automations.action.statusProperty.single"},actionTextPropertyClear:{[ml]:ul,id:"automations.action.textProperty.clear"},actionTextPropertySetSingle:{[ml]:pl,id:"automations.action.textProperty.single"},triggerAnyPageAdded:{[ml]:"Page added",id:"automations.trigger.pageAdded.title"},triggerAnyPagePropertyEdit:{[ml]:"Any page property edited",id:"automations.trigger.anyPagePropertyEdited.title"},triggerAnyPropertyEdit:{[ml]:"{propertyName} is edited",id:"automations.trigger.propertyChangesToAny.title"},triggerSelectPropertySet:{id:"automations.trigger.selectPropertySet.title",[ml]:"{propertyName} set to {propertyValues}"},triggerStatusPropertySet:{[ml]:"{propertyName} set to {propertyValues}",id:"automations.trigger.statusPropertySet.singleProperty"}});function Td(e){const{[dl]:t,[ll]:o}=e;return{...Pd.actionCheckboxPropertySetSingle,[Kl]:{[dl]:t,[ll]:o}}}function Ad(e){const{[dl]:t}=e;return{...Pd.actionDatePropertyClear,[Kl]:{[dl]:t}}}function kd(e){const{[dl]:t,[ll]:o}=e;return{...Pd.actionDatePropertySetSingle,[Kl]:{[dl]:t,[ll]:o}}}function _d(e){const{[dl]:t}=e;return{...Pd.actionPersonPropertyClear,[Kl]:{[dl]:t}}}function Md(e){const{[dl]:t,[ll]:o}=e;return{...Pd.actionPersonPropertySetSingle,[Kl]:{[dl]:t,[ll]:o}}}function xd(e){const{[dl]:t,[ll]:o}=e;return{...Pd.actionPersonPropertySetMultiple,[Kl]:{[dl]:t,propertyValues:o}}}function Zd(e){const{[dl]:t}=e;return{...Pd.actionRelationPropertyClear,[Kl]:{[dl]:t}}}function Id(e){const{[dl]:t,[ll]:o}=e;return{...Pd.actionRelationPropertySetSingle,[Kl]:{[dl]:t,[ll]:o}}}function Dd(e){const{[dl]:t,[ll]:o}=e;return{...Pd.actionRelationPropertySetMultiple,[Kl]:{[dl]:t,propertyValues:o}}}function Fd(e){const{[dl]:t}=e;return{...Pd.actionSelectPropertyClear,[Kl]:{[dl]:t}}}function Vd(e){const{[dl]:t,[ll]:o}=e;return{...Pd.actionSelectPropertySetSingle,[Kl]:{[dl]:t,[ll]:o}}}function Bd(e){const{[dl]:t,[ll]:o}=e;return{...Pd.actionSelectPropertySetMultiple,[Kl]:{[dl]:t,propertyValues:o}}}function Ed(e){const{[dl]:t,[ll]:o}=e;return{...Pd.actionStatusPropertySetSingle,[Kl]:{[dl]:t,[ll]:o}}}function Kd(e){const{[dl]:t}=e;return{...Pd.actionTextPropertyClear,[Kl]:{[dl]:t}}}function Rd(e){const{[dl]:t,[ll]:o}=e;return{...Pd.actionTextPropertySetSingle,[Kl]:{[dl]:t,[ll]:o}}}function Nd(e){return e[sl](Pd.triggerAnyPageAdded)}function Od(e){return e[sl](Pd.triggerAnyPagePropertyEdit)}function Wd(e,t){const{[dl]:o}=t;return e[sl](Pd.triggerAnyPropertyEdit,{[dl]:o})}function Ud(e,t){return e[sl](Pd.triggerSelectPropertySet,t)}function Gd(e,t){return e[sl](Pd.triggerStatusPropertySet,t)}function Ld(e){return Ns.x.isFail(e[rl].state)?[]:e[rl].state.value.valueTypes}function zd(e){const{automationId:t,automationName:o,[Ml]:i,[Zl]:n}=e;return function(e){const{actionIds:t,automationId:o,[Ml]:i,eventConfiguration:n,[al]:a,[Jl]:r,[Zl]:s}=e,l=Date.now();return{[xl]:t,alive:!0,[nl]:s,[il]:ol,created_time:l,id:o,[tl]:s,[el]:ol,[Js]:a??l,parent_id:i.id,[Ys]:Us.v,[Jl]:r??{},[Rl]:i[Pl](),status:"active",[$l]:{[Ql]:n,id:(0,c.default)(),[Xl]:Ql},version:1}}({actionIds:[],automationId:t,[Ml]:i,eventConfiguration:{[jl]:!1,[ql]:{[Xl]:"none"},source:{[Yl]:i[Xs](),[Xl]:Us.v}},[Jl]:{name:o},[Zl]:n})}function Hd(e){const{automationId:t,automationName:o,[Ml]:i,[Zl]:n}=e;return function(e){const{actionIds:t,automationId:o,[Ml]:i,eventConfiguration:n,[al]:a,[Jl]:r,[Zl]:s}=e,l=Date.now();return{[xl]:t,alive:!0,[nl]:s,[il]:ol,created_time:l,id:o,[tl]:s,[el]:ol,[Js]:a??l,parent_id:i.id,[Ys]:Us.v,[Jl]:r??{},[Rl]:i[Pl](),status:"active",[$l]:{[Ql]:n,id:(0,c.default)(),[Xl]:bl},version:1}}({actionIds:[],automationId:t,[Ml]:i,eventConfiguration:{[jl]:!1,[ql]:{[Xl]:"none"},source:{[Yl]:i[Xs](),[Xl]:Us.v}},[Jl]:{name:o},[Zl]:n})}function qd(e){const{[Gl]:t,[$s]:o,automationId:i,[Nl]:n}=e;return{alive:!0,id:t??(0,c.default)(),parent_id:i,[Ys]:Fs.cv,[Rl]:n,[Xl]:o,version:1}}function jd(e){const{[Gl]:t,automationId:o,[Ul]:i,[Jl]:n,[Kl]:a,[Nl]:r}=e;return{...qd({[Gl]:t,[$s]:"create_page",automationId:o,[Nl]:r}),[Wl]:{[Ol]:i,[Jl]:n,[Kl]:a}}}function Qd(e){const{[Gl]:t,automationId:o,[Jl]:i,[Nl]:n,[El]:a,[Kl]:r}=e;return{...qd({[Gl]:t,[$s]:"update_pages",automationId:o,[Nl]:n}),[Wl]:{[El]:a,[Jl]:i,[Kl]:r}}}function $d(e){const{[Gl]:t,automationId:o,externalBotId:i,[Nl]:n,[El]:a}=e;return{...qd({[Gl]:t,[$s]:Qs,automationId:o,[Nl]:n}),[Wl]:{[El]:a,[Bl]:i}}}function Xd(e){const t=e[Dl]()[zl]((0,k.makeTypeGuard)((e=>e.isType(Qs)?{true:e}:{false:e}))),o={};for(const i of t){const e=i.getConfig(),t=null==e?void 0:e[Bl];if(!t)continue;const n=zs.Qx[Tl](i,{id:t,[Nl]:i[Pl](),table:Ws.cZ}).getCreatedByStore();n&&(o[i.id]=n.getDisplayName(Et.default.getIntl()))}return o}async function Yd(e){const{automationAvailabilityContext:t}=e,o=t.automation.getTriggerType(),i=Es.Gl[o],n="default_bound"===i.max?Es.xZ:i.max;if(t.automationActions[Ll]>=n)return[];const a=(0,Bs.P)("display"),r=[];for(const s of a)await s.isAvailableForContext(t)&&r.push(s);return r}function Jd(){const e=(0,P.VK)((()=>os.Z[js].state),[]);return(0,l.useMemo)((()=>0===e[Ll]?{[Xl]:qs}:1===e[Ll]?{[Xl]:"selectChannelNew"}:{[Xl]:"selectWorkspace"}),[e[Ll]])}var ec=o(98114);const tc=o(85).UXD,oc=o(85).ffk,ic=o(85).HXm,nc=o(85).xw1,ac=o(85).v8g,rc=o(85).KCN,sc=o(85).Yzm,lc=o(85).q88,dc=o(85).vwy,cc=o(85).dL6,uc=o(85).uKy,pc=o(85).qYR,mc=o(85).lw5,gc=o(85).v1$,yc=o(85).J$i,fc=o(85).tqF,vc=o(85).AnB,hc=o(85).TLr,Sc=o(85).LCr,bc=o(85).mFu,wc=o(85).BvK,Cc=o(85).nxU,Pc=o(85).Drs,Tc=o(85).JJj,Ac=o(85).wgE,kc=o(85).oWD,_c=o(85).EQe,Mc=o(85).nx5,xc=(0,u.defineMessages)({automationDeleteConfirmationMessage:{id:"slackAutomations.remove.confirmation.message",[Mc]:"Are you sure you want to delete {automationName}?"},automationDeleteAcceptLabel:{id:"slackAutomations.remove.confirmation.acceptLabel",[Mc]:"Delete"}});function Zc(e){const{[_c]:t,[kc]:o,[Ac]:i,intl:n}=e,a=(0,Vs.getClientEventTracker)(i);y[Tc]({[Ac]:i,[Pc]:"collectionSettingsAutomationsActions.createDatabaseAutomation",[Cc]:e=>{y[wc]({store:o,operation:{[bc]:o[bc],path:["format","automation_ids"],command:"listAfter",args:{id:t.id}},[Sc]:e});const a=zs.Mz[hc](o,t[bc]),r=t[vc]();for(const t of r){const o=t.getType();o&&ec.zY({actionId:t.id,actionType:o,[_c]:a,config:t[fc](),[Ac]:i,intl:n,[Sc]:e})}const s=Ec(r);ot.createRecord({[Ac]:i,[yc]:o[yc],table:Fs.cv,[Sc]:e,value:{action_ids:t.getActionIds(),alive:!0,id:t.id,parent_id:o.id,parent_table:o.table,[gc]:{name:t.getName()},space_id:o.getSpaceId(),status:"active",trigger:{id:(0,c.default)(),[mc]:t.getEventConfiguration()??{pagesAdded:!1,[pc]:{type:"none"},source:{[bc]:o[uc](),type:"collection"}},type:s}}})}});const r=Kc({[_c]:t,[kc]:o});ws.T0(a,r)}function Ic(e){const{[_c]:t,[kc]:o,[Ac]:i}=e;y[Tc]({[Ac]:i,[Pc]:"collectionSettingsAutomationsActions.saveDatabaseAutomation",[Cc]:e=>{const i=zs.Mz[hc](o,t[bc]),n=t.getName(),a=i[cc](gc);ot[dc]({store:a,data:{name:n},[Sc]:e});const r=t[vc](),s=Ec(r),l=i[lc]();if(ot[dc]({store:l,data:{type:s},[Sc]:e}),od(i)&&od(t)){const o=i[lc]()[cc](mc);ot[dc]({store:o,data:t[lc]()[cc](mc).getValue(),[Sc]:e})}const d=[];for(const t of r){const o=t.getModel();if(!o)continue;const n=zs.zq[hc](i,t[bc]);ot.setValue({store:n,value:{alive:!0,config:o[fc](),id:o.id,parent_id:i.id,parent_table:i.table,space_id:i.getSpaceId(),type:o.type},[Sc]:e}),d.push(t.id)}ot[dc]({store:i,data:{action_ids:d},[Sc]:e})}});const n=(0,Vs.getClientEventTracker)(i),a=Kc({[_c]:t,[kc]:o});ws.r4(n,a)}async function Dc(e){const{intl:t,[Ac]:o,[kc]:i,existingAutomationStore:n,triggerType:a,onDelete:r}=e,s=n.getNameWithDefault(t);(await tt.confirmUserActionV2({message:t[sc](xc.automationDeleteConfirmationMessage,{automationName:s}),acceptLabel:t[sc](xc.automationDeleteAcceptLabel)})).accept&&(!function(e){const{[Ac]:t,triggerType:o,[kc]:i,existingAutomationStore:n}=e;y[Tc]({[Ac]:t,[Pc]:"collectionSettingsAutomationsActions.deleteAutomation",[Cc]:e=>{const t=i.getFormatStore()[cc]("automation_ids"),o=zs.Mz[hc](i,n[bc]);y[wc]({store:t,operation:{[bc]:t[bc],path:t.path,command:"listRemove",args:{id:o.id}},[Sc]:e}),ot[dc]({store:o,data:{alive:!1},[Sc]:e})}});const a=(0,Vs.getClientEventTracker)(t),r=Kc({[_c]:n,[kc]:i});ws.uO(a,r),"notification_event"===o&&p.trackSlackNotificationDelete(t,{type:"granular",source:rc,[ac]:i.id})}({[Ac]:o,triggerType:a,[kc]:i,existingAutomationStore:n}),null==r||r())}function Fc(e){const{[_c]:t,[kc]:o,[Ac]:i}=e;y[Tc]({[Ac]:i,[Pc]:"collectionSettingsAutomationsActions.disableAutomation",[Cc]:e=>{const i=zs.Mz[hc](o,t[bc]);ot[dc]({store:i,data:{status:"disabled"},[Sc]:e})}});const n=(0,Vs.getClientEventTracker)(i),a=Kc({[_c]:t,[kc]:o});ws.ai(n,a)}function Vc(e){const{[_c]:t,[kc]:o,[Ac]:i}=e;y[Tc]({[Ac]:i,[Pc]:"collectionSettingsAutomationsActions.enableAutomation",[Cc]:e=>{const i=zs.Mz[hc](o,t[bc]);ot[dc]({store:i,data:{status:"active"},[Sc]:e})}});const n=(0,Vs.getClientEventTracker)(i),a=Kc({[_c]:t,[kc]:o});ws.Rt(n,a)}function Bc(e){const{[_c]:t,[kc]:o,[Ac]:i}=e;y[Tc]({[Ac]:i,[Pc]:"collectionSettingsAutomationsActions.reactivateNotificationAutomation",[Cc]:e=>{const i=zs.Mz[hc](o,t[bc]);ot[dc]({store:i,data:{status:"active"},[Sc]:e})}}),p.trackSlackNotificationReactivate(i,{type:"granular",source:rc,[ac]:o.id})}function Ec(e){return 1===e.length&&e[0].isType("slack_notification")?nc:mc}function Kc(e){const{[_c]:t,[kc]:o}=e,i=o.getSchema(),n=t[vc]().map((e=>{return e.isType("slack_notification")?{type:ic}:e.isType("update_pages")?{property_types:((null===(t=e[fc]())||void 0===t?void 0:t[gc])??[]).map((e=>{var t;return null===(t=i[e])||void 0===t?void 0:t.type})).filter(k.isDefined),type:"update_pages"}:e.isType("create_page")?{property_types:((null===(o=e[fc]())||void 0===o?void 0:o[gc])??[]).map((e=>{var t;return null===(t=i[e])||void 0===t?void 0:t.type})).filter(k.isDefined),type:"create_page"}:void 0;var t,o})).filter(k.isDefined),a=t[lc]().getValue(),r=[];if("event"===(null==a?void 0:a.type)||"notification_event"===(null==a?void 0:a.type)){const{pagesAdded:e,[pc]:t}=a[mc];e&&r.push({type:"page"}),"any"===t.type?r.push({condition:"any",type:oc}):"none"===t.type?r.push({condition:"none",type:oc}):r.push({condition:"some",property_types:t.some.map((e=>{var t;return null===(t=i[e[oc]])||void 0===t?void 0:t.type})).filter(k.isDefined),type:oc})}let s;if(t[tc]("event")||t[tc]("notification_event")){const e=t[lc]()[cc](mc)[cc]("source").getValue();e&&"collection_view"===e.type&&(s=e[bc].id)}return{automation_actions:n,automation_id:t.id,automation_triggers:r,[ac]:o.id,collection_view_id:s}}var Rc=o(67669),Nc=o(37034),Oc=o(68910);const Wc=o(85).uKy,Uc=o(85).EQe;function Gc(e){const{[Uc]:t,collectionStore:o}=e;return(0,P.VK)((()=>{if(!o||!t)return;const e=o[Wc]();return new Oc.L({[Uc]:t,parentPointer:e,type:"event",persisted:!0,intl:Et.default.getIntl(),parentRecordStore:o})}),[o,t])}var Lc=o(24457),zc=o(29502),Hc=o(63474),qc=o(79315),jc=o(53809),Qc=o(53576);const $c=new jc.D({key:"automationCollectionFilterStorageKey",namespace:Qc.$p,important:!1,trackingType:"preference"});var Xc=o(6740);const Yc=o(85).p06,Jc=o(85).EmK;function eu(){const e=(0,l.useRef)(null),[t,o]=(0,l.useState)(!1),i=(0,l.useCallback)((()=>{const t=e.current;t&&o(function(e){try{return e.matches(":focus-within")}catch(t){return!1}}(t))}),[]),n=(0,l.useCallback)((t=>{e.current=t,i()}),[i]);return(0,l.useEffect)((()=>{const t=e.current;if(t){function e(){o(!0),i()}function n(){o(!1),i()}return t[Jc]("focusin",e),t[Jc]("focusout",n),()=>{t[Yc]("focusin",e),t[Yc]("focusout",n)}}}),[i]),(0,l.useEffect)((()=>{if(t)return document[Jc]("pointerdown",i),document[Jc]("keydown",i),()=>{document[Yc]("pointerdown",i),document[Yc]("keydown",i)}}),[t,i]),[n,t]}var tu=o(77744),ou=o(1533),iu=o(73063);const nu=o(85).Yzm,au=o(85).D7I,ru=o(85).BQ6,su=o(85).LtW,lu=o(85).bey,du=o(85).jkI,cu=o(85).$bT,uu=o(85).L_E,pu=o(85).pkR,mu=o(85).nx5,gu=(0,u.defineMessages)({moreLabel:{id:"automationBaseStepElement.moreActionsMenu.title",[mu]:"More"}});function yu(e){window.__c={n:"AutomationBaseStepElement"};const{icon:t,onClick:o,title:i,caption:n,onEdit:r,onDelete:s,[pu]:d}=e,{isMobile:c}=(0,C.Fy)(),[u,p]=(0,Xc.Z)(),[m,g]=eu(),y=(0,P.qz)(void 0,ou.Z),f=(0,P.VK)((()=>y.getState()),[y]).hovered||p||g,v=(0,tu.lq)(u,m),h=(0,P.qz)(void 0,V.Z),S=(0,T.yK)((e=>({button:{position:"relative"},moreButtonWrap:{display:f||c?"block":"none",position:"absolute",right:12,top:14},[uu]:{display:"flex",[cu]:"column",gap:8,justifyContent:du,paddingBlock:16,paddingInline:12},title:{alignItems:du,display:"flex",[cu]:"row",gap:6},iconWrap:{flexShrink:0,alignSelf:"baseline",height:"24px",display:"flex",alignItems:du},[lu]:{width:16,height:16,color:e.mediumIconColor},body:{flex:"1 1 auto",fontSize:14,lineHeight:1.3,minWidth:0,whiteSpace:"pre"}})),[f,c]);return l[au](K.Z,{onClick:()=>{null==o||o(h)},[ru]:S.button,[pu]:d,disabledFeedback:d,ref:v,focused:f,store:y},!d&&(r||s)&&a()("div",{[ru]:S.moreButtonWrap},void 0,a()(fu,{onEdit:r,onDelete:s,[pu]:d,[su]:h})),a()("div",{[ru]:S[uu]},void 0,a()("div",{[ru]:S.title},void 0,t&&a()("div",{"aria-hidden":"true",[ru]:S.iconWrap},void 0,t(S[lu])),a()("div",{[ru]:S.body},void 0,i)),n))}function fu(e){window.__c={n:"MoreActionsButton"};const{onDelete:t,onEdit:o,[pu]:i,[su]:n}=e,r=(0,C.O7)(),{device:d}=r,c=(0,u.useIntl)(),p=(0,T.yK)((e=>({iconButton:{border:`1px solid ${e.regularDividerColor}`,height:26,width:26},iconButtonIcon:{width:14,height:14}})),[]);return a()(st.ZP,{[su]:n,popupType:d.isMobile?oo.kQ.SlideUp:oo.kQ.Popup,alignmentToOrigin:st.vR.Center,placementToOrigin:st.pO.Bottom,originGap:0,renderOrigin:e=>l[au](iu.Z,s()({},e,{[pu]:i,ariaLabel:c[nu](gu.moreLabel),icon:A.Z.dots,hasBackground:!0,[lu]:p.iconButtonIcon,[ru]:p.iconButton})),render:e=>a()(vu,{onClose:()=>e.close(),onEdit:o,onDelete:t})})}function vu(e){window.__c={n:"MoreActionsMenu"};const{onClose:t,onEdit:o,onDelete:i}=e,n=(0,Lc.F)(),r=[o?{action:()=>{t(),o()},key:"edit",render:e=>l[au](Nt.Z,s()({},e,{icon:A.Z.pencil({height:16,width:16}),title:a()(u.FormattedMessage,{id:"automationBaseStepElement.moreActionsMenu.edit",[mu]:"Edit"})}))}:void 0,i?{action:()=>{t(),i()},key:"delete",render:e=>l[au](Nt.Z,s()({},e,{icon:A.Z.trash({height:16,width:16}),title:a()(u.FormattedMessage,{id:"automationBaseStepElement.moreActionsMenu.delete",[mu]:"Delete"})}))}:void 0].filter(k.isDefined);return l[au](lt.Z,n,a()(Wt.Z,{type:Wt.i.Vertical,sections:[{items:r,key:"items",render:e=>l[au](j.Z,s()({enableActionSheetTitle:!0,topBorder:!0},e))}],initialFocus:0}))}var hu=o(84619),Su=o(22084),bu=o(85567);const wu=o(85)._tz;function Cu(e){window.__c={n:"AutomationAnyEditPropertyTrigger"};const{disabled:t,onDelete:o,onClick:i,propertySchema:n,onEdit:r}=e,s=(0,u.useIntl)(),l=(0,T.Fg)(),d=(0,T.yK)((()=>({[wu]:{..._.Z.textOverflowStyle,fontWeight:_.Z.fontWeight.semibold},wrap:{display:"inline-flex",width:"100%"}})),[]),c=a()("span",{style:d[wu]},void 0,n.name),p=Wd(s,{[wu]:c});return a()(yu,{disabled:t,onClick:i,icon:e=>a()(As.ZP,{size:16,theme:l,icon:n.icon,style:e,type:n.type}),title:a()("span",{style:d.wrap},void 0,p),onEdit:r,onDelete:o})}const Pu=o(85)._tz,Tu=o(85).OBh,Au=o(85).eiN,ku=5;function _u(e){const{[Au]:t,[Tu]:o,onEdit:i,onDelete:n,disabled:r}=e;return"changes_to_any"===t.operator?a()(Cu,{disabled:r,[Tu]:o,onClick:i,onDelete:n,onEdit:i}):l.createElement(Mu,s()({},e,{[Au]:t}))}function Mu(e){window.__c={n:"ParametrizableStatusPropertyTriggerFilter"};const{[Au]:t,limit:o=ku,[Tu]:i,onEdit:n,onDelete:r,disabled:s}=e,l=(0,u.useIntl)(),d=(0,T.yK)((()=>({content:{alignItems:"baseline",display:"flex",flexWrap:"wrap",whiteSpace:"pre",lineHeight:"24px"},[Pu]:{..._.Z.textOverflowStyle,fontWeight:_.Z.fontWeight.semibold}})),[]);if(!(0,Ps.vR)(t))return null;const c=t.value,p=i.name,m=Array.isArray(c)?c:[c],g=xu({groupValues:m.map((e=>"is_group"===e.type?e.value:void 0))[Au](k.isDefined),limit:o,optionValues:m.map((e=>"is_option"===e.type?e.value:void 0))[Au](k.isDefined),[Tu]:i}),y=l.formatList(g,{style:"long",type:"disjunction"}),f={[Pu]:a()("span",{style:d[Pu]},void 0,p),propertyValues:Zu(y)};return a()(yu,{disabled:s,icon:A.Z.typesStatus,title:a()("div",{style:d.content},void 0,Gd(l,f)),onEdit:n,onDelete:r,onClick:n})}function xu(e){const{groupValues:t,isText:o,limit:i,optionValues:n,[Tu]:r}=e,s=r.groups||[],l=r.options||[],d=t.map((e=>{const t=s.find((t=>t.name===e));if(t)return o?t.name:a()("span",{},t.id,t.name)}))[Au](k.isDefined),c=n.map((e=>{const t=(0,Ts.matchSelectOption)(l,e);if(void 0===t)return;if(o)return t.value;const i=s.find((e=>{var o;return null===(o=e.optionIds)||void 0===o?void 0:o.includes(t.id)}));return a()(Su.F,{format:hu.l.Medium,isSingle:!0,value:t.value,color:t.color,groupColor:null==i?void 0:i.color,showRemoveButton:!1,showEllipsis:!0},t.id)}))[Au](k.isDefined),u=[...d,...c];let p=[];if(void 0!==i&&u.length>i){const e=c.length-i,t=o?`+${e}`:a()(bu.Z,{format:hu.l.Medium,isRound:!0,isSingle:!0,showRemoveButton:!1,value:`+${e}`},"More tokens");p=[...c.slice(0,i),t]}else p=u;return p}function Zu(e){if(!Array.isArray(e))return[e];const t=[];for(const o of e)if("string"==typeof o&&" "!==o[0]){const e=t.pop();t.push(a()("div",{},void 0,e,o))}else t.push(o);return t}const Iu=o(85)._tz,Du=o(85).pkR,Fu=o(85).OBh;function Vu(e){const{filter:t,[Fu]:o,onEdit:i,onDelete:n,[Du]:r}=e;if("changes_to_any"===t.operator)return a()(Cu,{[Du]:r,[Fu]:o,onClick:i,onEdit:i,onDelete:n});{const e={filter:t,[Fu]:o,onEdit:i,onDelete:n,[Du]:r};return l.createElement(Bu,e)}}function Bu(e){window.__c={n:"ParametrizableSelectPropertyTriggerFilter"};const{filter:t,[Fu]:o,onEdit:i,onDelete:n,[Du]:r}=e,s=(0,u.useIntl)(),l=(0,T.yK)((()=>({content:{alignItems:"baseline",display:"flex",flexWrap:"wrap",whiteSpace:"pre",lineHeight:"24px"},[Iu]:{..._.Z.textOverflowStyle,fontWeight:_.Z.fontWeight.semibold}})),[]);if(!(0,Ps.vR)(t))return null;const d=t.value,c=o.name,p=Eu({limit:5,optionValues:(Array.isArray(d)?d:[d]).map((e=>e.value)).filter(k.isDefined),[Fu]:o}),m=s.formatList(p,{style:"long",type:"disjunction"}),g={[Iu]:a()("span",{style:l[Iu]},void 0,c),propertyValues:Zu(m)};return a()(yu,{[Du]:r,icon:As.wG[o.type],title:a()("div",{style:l.content},void 0,Ud(s,g)),onClick:i,onEdit:i,onDelete:n})}function Eu(e){const{isText:t,limit:o,optionValues:i,[Fu]:n}=e,r=n.options??[],s=i.map((e=>{const t=(0,Ts.matchSelectOption)(r,e);if(t)return a()(Su.a,{value:t.value,color:t.color,format:hu.l.Medium,isSingle:!0,showRemoveButton:!1},t.id)})).filter(k.isDefined);let l;if(void 0!==o&&s.length>o){const e=s.length-o,i=t?`+${e}`:a()(bu.Z,{format:hu.l.Medium,isRound:!0,isSingle:!0,showRemoveButton:!1,value:`+${e}`},"More tokens");l=[...s.slice(0,o),i]}else l=s;return l}const Ku=o(85).D7I,Ru=o(85).Io9,Nu=o(85)._tz,Ou=o(85).OBh,Wu=5;function Uu(e){window.__c={n:"UpdateMultiSelectPropertyAction"};const{disabled:t,limit:o=Wu,onClick:i,onDelete:n,onEdit:r,[Ou]:s,value:d}=e,c=null!=d&&d.value?(0,Ms.A6)(null==d?void 0:d.value):void 0,p=c?Eu({limit:o,optionValues:c.map((e=>"string"==typeof e?e:void 0)).filter(k.isDefined),[Ou]:s}):void 0,m=(null==p?void 0:p.length)??0,g=(0,u.useIntl)(),y=(0,T.yK)((()=>({content:{alignItems:"baseline",display:"flex",flexWrap:m<=1?"nowrap":"wrap",whiteSpace:"pre"},[Nu]:{..._.Z.textOverflowStyle,fontWeight:_.Z.fontWeight.semibold}})),[m]),f=a()("span",{style:y[Nu]},void 0,s.name),v=p?Zu(g.formatList(p,{style:"long",type:"conjunction"})):p;let h;return h=void 0===v?Fd({[Nu]:f}):1===m?Vd({[Nu]:f,[Ru]:v[0]}):Bd({[Nu]:f,[Ru]:v}),a()(yu,{disabled:t,icon:A.Z.typesMultipleSelect,onClick:i,onDelete:n,onEdit:r,title:a()("div",{style:y.content},void 0,l[Ku](u.FormattedMessage,h))})}var Gu=o(69265);const Lu=o(85).fBu,zu=o(85).$wW,Hu=o(85).KuQ,qu=o(85).D7I,ju=o(85).Io9,Qu=o(85).Uie,$u=o(85)._tz,Xu=o(85).paz;function Yu(e){window.__c={n:"UpdateRelationPropertyAction"};const{collectionStore:t,disabled:o,onClick:i,onDelete:n,onEdit:r,propertySchema:s,value:d}=e,c=(0,T.yK)((()=>({[Xu]:{alignItems:"center",display:"flex",flex:"1 1 auto",minWidth:0,whiteSpace:"pre"},[$u]:{..._.Z[Qu],fontWeight:_.Z.fontWeight.semibold,minWidth:20},[ju]:{..._.Z[Qu],minWidth:40},propertyValueList:{display:"flex",flexBasis:"100%",flexDirection:"column",listStyle:"none",margin:0,marginBlockStart:10,padding:0,rowGap:10}})),[]),p=d?Ju(d,s.limit):[],m=a()("span",{style:c[$u]},void 0,s.name);let g;return g=0===p.length?a()("div",{style:c[Xu]},void 0,l[qu](u.FormattedMessage,Zd({[$u]:m}))):1===p.length?a()("div",{style:c[Xu]},void 0,l[qu](u.FormattedMessage,Id({[$u]:m,[ju]:a()("span",{style:c[ju]},void 0,a()(Gu.Z,{[Hu]:p[0],format:hu.l.Medium,[zu]:!0,noUnderline:!0,[Lu]:t,shouldShrink:!0}))}))):l[qu](l.Fragment,null,a()("div",{style:c[Xu]},void 0,l[qu](u.FormattedMessage,Dd({[$u]:m,[ju]:[]}))),a()("ul",{style:c.propertyValueList},void 0,p.map((e=>a()("li",{},e,a()(Gu.Z,{[Hu]:e,format:hu.l.Medium,[zu]:!0,noUnderline:!0,[Lu]:t,shouldShrink:!0})))))),a()(yu,{disabled:o,icon:A.Z.typesRelation,onClick:i,onDelete:n,onEdit:r,title:g})}function Ju(e,t){return(0,Ms.A6)(e.value).slice(0,t).map((e=>{if(!function(e){return"string"!=typeof e&&"boolean"!=typeof e&&(0,Ds.isPageAnnotation)(e)}(e))return;const t=(0,Ds.getPageAnnotationData)(e);return t||void 0})).filter(k.isDefined)}var ep=o(49085);class tp extends ep.default{getInitialState(){return{stack:[]}}getCurrentTab(){return se().last(this.getState().stack)}pushSettingsItem(e){this.update((t=>({...t,stack:[...t.stack,e]})))}popSettingsItem(){this.update((e=>({stack:e.stack.slice(0,e.stack.length-1)})))}replaceSettingsItem(e){this.update((t=>{const o=[...t.stack.slice(0,t.stack.length-1),e];return{...t,stack:o}}))}}class op extends tp{}class ip extends tp{}var np=o(98459),ap=o(71846),rp=o(40721);const sp=o(85).J4z,lp=o(85).Yzm,dp=o(85).D7I,cp=o(85).nx5,up=o(85).$Ji,pp=(0,u.defineMessages)({[up]:{id:"notificationRuleSettingsMenu.backButton.ariaLabel",[cp]:"Back to previous step"}});function mp(e){window.__c={n:"AutomationTriggerActionMenu"};const{type:t,automationTriggerActionMenuStore:o,headerTitle:i,onClose:n,width:a,onDone:r}=e,d=vp({automationTriggerActionMenuStore:o,onClose:n,onDone:r,title:i,width:a});return"custom"===t?l[dp](yp,s()({},e,{menuProps:d})):l[dp](gp,s()({},e,{menuProps:d}))}function gp(e){const{sections:t,menuProps:o}=e;return l[dp](lt.Z,o,a()(Wt.Z,{type:Wt.i.Vertical,initialFocus:0,sections:t}))}function yp(e){const{children:t,menuProps:o}=e;return l[dp](lt.Z,o,t)}function fp(e){window.__c={n:"BackToPreviousStepButton"};const{automationActionMenuStore:t,menuHeaderTitle:o,onDone:i}=e,n=(0,u.useIntl)(),r=(0,P.VK)((()=>t.state.stack.length>1),[t]),s=(0,T.yK)((e=>({header:{display:"flex",alignItems:"center",margin:8,color:e.mediumTextColor,fontWeight:_.Z.fontWeight.medium,fontSize:_.Z.fontSize.UISmall.desktop},iconButtonStyle:{marginRight:8,marginLeft:-2,height:22},iconButtonIconStyle:{width:16,height:16},doneButtonStyle:{marginLeft:"auto"}})),[]);return void 0!==o||r?a()("div",{style:s.header},void 0,r&&a()(iu.Z,{ariaLabel:n[lp](pp[up]),icon:A.Z.arrowLeftThick,style:s.iconButtonStyle,iconStyle:s.iconButtonIconStyle,onClick:()=>{t[sp]()}}),o,i&&a()(Ia.Z,{onClick:i,isBlue:!0,style:s.doneButtonStyle},void 0,a()(u.FormattedMessage,{id:"automationTriggerActionMenu.doneButton.title",[cp]:"Done"}))):null}function vp(e){const{automationTriggerActionMenuStore:t,leftStyle:o,onClose:i,onDone:n,rightStyle:r,title:s,titleStyle:d,width:c}=e,{isMobile:p}=(0,C.Fy)(),m=(0,u.useIntl)(),g=(0,l.useCallback)((()=>{1===t.getState().stack.length?i():t[sp]()}),[t,i]);return(0,l.useMemo)((()=>{let e;return e=p?{leftOuterStyle:o,menuType:at.og.Modal,title:s,titleOuterStyle:d,left:a()(iu.Z,{ariaLabel:m[lp](pp[up]),icon:A.Z.historyBack,onClick:g}),right:a()(rp.DoneMenuText,{}),rightOuterStyle:r,onClickRight:()=>{null==n||n(),i()}}:{width:c??266,menuType:at.og.Popup,maxHeight:"50vh",header:a()(fp,{automationActionMenuStore:t,menuHeaderTitle:s,onDone:n})},e}),[t,m,p,o,i,n,g,r,s,d,c])}const hp=o(85).jKg,Sp=o(85).v2u,bp=o(85).Gm5,wp=o(85).Hnr,Cp=o(85).kgm,Pp=o(85).oWD,Tp=o(85).EQe;function Ap(e){window.__c={n:"AutomationEventActionCreatePage"};const{automationActionMenuStore:t,[Tp]:o,[Pp]:i,onClose:n,updateCurrentState:r}=e,s=(0,c.default)(),d=(0,C.O7)(),p=vp({automationTriggerActionMenuStore:t,leftStyle:{flexGrow:0},onClose:n,rightStyle:{flexGrow:0},title:a()(u.FormattedMessage,{defaultMessage:"Add page to‚Ä¶",id:"automationEventActionCreatePage.menu.title"})}),m=(0,l.useCallback)((()=>{Ye[Cp]({environment:d,eventName:"abandoned_search",sessionId:s,source:ap.S.Automation})}),[d,s]);p.menuType===at.og.Popup&&(p.onClickOutside=m);const g=Gc({[Tp]:o,[Pp]:i}),y=(0,l.useCallback)((e=>{r({action:{id:(0,c.default)(),config:{collection:{...e.pointer,spaceId:(0,np.CG)(e.pointer.spaceId)},properties:["title"],values:{}},type:"create_page"},type:"update_action"}),n()}),[n,r]);return g?l.createElement(lt.Z,p,a()(ap.Z,{[bp]:ap.S.Automation,onAccept:y,parentStore:g[bp][wp],[Sp]:!0,[hp]:s})):null}var kp=o(93678),_p=o(5971);const Mp=o(85).gGi,xp=o(85).NF1,Zp=o(85).ewQ,Ip=o(85).WLo,Dp=o(85).Scd,Fp=o(85).ejZ,Vp=o(85).QKR,Bp=o(85).Q9F,Ep=o(85).f57,Kp=o(85).X_m,Rp=o(85).PXg,Np=o(85).auS,Op=o(85).sM5,Wp=o(85).D7I,Up=o(85).rpY,Gp=o(85).eiN,Lp=o(85).Yzm,zp=o(85).Jkr,Hp=o(85).TtP,qp=o(85).WGG,jp=o(85).oWD,Qp=o(85).EQe,$p=o(85).nx5,Xp=o(85).A4A,Yp=(0,u.defineMessages)({[Xp]:{id:"automationEventActionMenu.searchInputPlaceholder.label",[$p]:"Search for action‚Ä¶"}});function Jp(e){window.__c={n:"AutomationEventActionMenu"};const{availableActions:t,automationActionMenuStore:o,[Qp]:i,[jp]:n,updateCurrentState:r,onClose:d}=e,c=(0,T.Fg)(),p=(0,u.useIntl)(),{isMobile:m}=(0,C.Fy)(),g=(0,C.O7)(),[y,f]=l.useState(""),v=(0,P.VK)((()=>n.getSchema()),[n]),h=Jd(),S=(0,P.VK)((()=>function(e){const{[Qp]:t,[jp]:o,searchInput:i}=e,n=new Set(t.getActionStores().flatMap((e=>e.isType("update_pages")?e.getConfigStore().getKeyStore("properties").getValue()??[]:[]))),a=o.getFormat(),r=o.getSchema(),s=(0,Cs.cO)({collectionFormat:a,collectionSchema:r,[Gp]:e=>{let[t]=e;return!n.has(t)}}),l=new Map,d=s.map((e=>{const t=r[e];if(t){const o=`${t.name} ${Bt.SO[t.type]}`;return l.set(e,o),o}}))[Gp](k.isDefined),c=new Set(Ft()[Gp](i,d).map((e=>{let{original:t}=e;return t})));return s[Gp]((e=>{const t=l.get(e);return t&&c.has(t)}))}({[Qp]:i,[jp]:n,searchInput:y})),[i,n,y]),b=(0,P.VK)((()=>function(e){const{availableActions:t,searchInput:o}=e;if(0===t[Hp])return[];const i=new Map,n=t.map((e=>{const t=Et.default[Lp](e[Op].name);return i.set(e.type,t),t})),a=new Set(Ft()[Gp](o,n).map((e=>{let{original:t}=e;return t})));return t[Gp]((e=>{const t=i.get(e.type);return t&&a.has(t)}))}({availableActions:t,searchInput:y})),[t,y]),w=(0,_p.E)(qp),_=(0,P.VK)((()=>w&&!(0,Hs.isPlusTierOrAbove)()),[w]),M=(0,l.useCallback)((()=>{d(),kp.y(g,{for:"plus",from:"database_automation_action_item"})}),[g,d]),x=S[Hp]>0&&!_?function(e){const{automationActionMenuStore:t,properties:o,collectionSchema:i,theme:n,updateCurrentState:r,onClose:d}=e,c=o.map((e=>function(e){const{automationActionMenuStore:t,[Fp]:o,collectionSchema:i,theme:n}=e,r=i[o];if(!r)return;return{key:o,action:()=>{t.pushSettingsItem({[Fp]:o,actionId:void 0,type:"eventActionProperty"})},[Up]:e=>l[Wp](Nt.Z,s()({},e,{icon:a()(As.ZP,{icon:r.icon,size:16,style:{fill:n[Np],[Rp]:6},theme:n,type:r.type}),right:A.Z[Bp]({[Vp]:6,[zp]:12,[Kp]:Ep}),title:r.name}))}}({[Fp]:e,collectionSchema:i,theme:n,updateCurrentState:r,automationActionMenuStore:t,onClose:d})))[Gp](k.isDefined);if(0===c[Hp])return;return{key:"page_properties_edited_section",items:c,[Up]:e=>l[Wp](j.Z,s()({},e,{title:a()(u.FormattedMessage,{id:"automationEventActionMenu.pagePropertiesEditedSection.title",[$p]:"Edit page property"})}))}}({automationActionMenuStore:o,properties:S,collectionSchema:v,theme:c,updateCurrentState:r,onClose:d}):void 0,Z=b[Hp]>0?function(e){const{automationActionMenuStore:t,actions:o,initialSlackActionSelectMenuState:i,showTopBorder:n,theme:a}=e,r=o.map((e=>function(e){const{automationActionMenuStore:t,action:o,initialSlackActionSelectMenuState:i,theme:n}=e;if("slack_notification"===o.type)return{key:"slack_action",action:()=>{t.pushSettingsItem(i)},[Up]:e=>l[Wp](Nt.Z,s()({},e,{icon:o[Op].icon({fill:n[Np],marginLeft:2,[Rp]:8,[zp]:12,[Kp]:Ep}),right:A.Z[Bp]({[Vp]:6,[zp]:12,[Kp]:Ep}),title:l[Wp](u.FormattedMessage,o[Op].name)}))};if("create_page"===o.type)return{key:"create_page",action:()=>{t.pushSettingsItem({actionId:void 0,type:"eventActionCreatePage"})},[Up]:e=>l[Wp](Nt.Z,s()({},e,{icon:o[Op].icon({fill:n[Np],marginInline:"2px 8px",[zp]:14}),right:A.Z[Bp]({[Vp]:6,[zp]:12}),title:l[Wp](u.FormattedMessage,o[Op].name)}))};if("update_pages"===o.type)return{key:"update_pages",action:()=>{t.pushSettingsItem({actionId:void 0,automationId:"",type:"eventActionUpdatePages"})},[Up]:e=>l[Wp](Nt.Z,s()({},e,{icon:o[Op].icon({fill:n[Np],marginInline:"2px 8px",[zp]:14}),right:A.Z[Bp]({[Vp]:6,[zp]:12}),title:l[Wp](u.FormattedMessage,o[Op].name)}))}}({automationActionMenuStore:t,action:e,initialSlackActionSelectMenuState:i,theme:a})))[Gp](k.isDefined);if(0===r[Hp])return;return{key:"other_actions_section",items:r,[Up]:e=>l[Wp](j.Z,s()({},e,{topBorder:n}))}}({automationActionMenuStore:o,actions:b,initialSlackActionSelectMenuState:h,showTopBorder:(0,k.isDefined)(x),theme:c}):void 0,I=_?function(e){const{onUpsellClick:t,theme:o}=e;return{key:"upsell_section",items:[{action:()=>t(),key:"upsell_item",[Up]:e=>l[Wp](Nt.Z,s()({},e,{icon:a()("div",{style:{[Dp]:o[Zp][Ip][50],[xp]:3,[Kp]:20,padding:3,[zp]:20}},void 0,A.Z.boltFilled({fill:o.icon[Ip],[Kp]:Mp,[zp]:Mp})),right:A.Z.alias({[Kp]:Ep,marginBlockStart:2,[zp]:12}),rightStyle:{alignSelf:"start"},caption:a()(u.FormattedMessage,{[$p]:"Automatically set properties, create new pages, and more with automations.",id:"automationEventActionMenu.upsellSection.caption"}),title:a()(u.FormattedMessage,{[$p]:"Upgrade for more actions",id:"automationEventActionMenu.upsellSection.title"}),shouldWrapCaption:!0}))}],[Up]:e=>l[Wp](j.Z,s()({},e,{topBorder:!0}))}}({onUpsellClick:M,theme:c}):void 0,D=(0,Lc.F)({[zp]:266,paddingBottom:2});D.header=a()(Ot.ZP,{onChange:e=>{f(e.target.value)},placeholder:p[Lp](Yp[Xp]),style:{marginBlock:"12px 2px"},value:y}),m||(D.maxHeight="50vh");const F=[x,Z][Gp](k.isDefined),V={key:"no_results_section",items:[{key:"no_results_item",action:()=>{},[Up]:e=>l[Wp](Nt.Z,s()({},e,{disabled:!0,disabledFeedback:!0,title:a()(u.FormattedMessage,{[$p]:"No results",id:"automations.automationEventActionMenu.noResultsItem"})}))}],[Up]:e=>l[Wp](j.Z,e)},B=(0===F[Hp]?[V,I]:[...F,I])[Gp](k.isDefined);return l[Wp](lt.Z,D,a()(Wt.Z,{type:Wt.i.Vertical,sections:B,initialFocus:0}))}var em=o(10450),tm=o(30823),om=o(55950);const im=o(85).Uie,nm=o(85).Yzm,am=o(85).rOg,rm=o(85).fHe,sm=o(85).oWD,lm=o(85).EQe,dm=(0,u.defineMessages)({menuHeaderTitle:{defaultMessage:"Set {propertyName} to",id:"automations.eventActionProperty.menuHeaderTitle"}});function cm(e){var t;window.__c={n:"AutomationEventActionProperty"};const{actionId:o,automationActionMenuStore:i,[lm]:n,[sm]:r,onClose:s,propertyId:d,updateCurrentState:p}=e,m=(0,u.useIntl)(),g=Gc({[lm]:n,[sm]:r}),y=o??(0,c.default)(),f=(0,P.VK)((()=>r.getSchema()[d]),[r,d]),v=(0,l.useMemo)((()=>!!f&&("multi_select"===f.type||(0,Qe.isPropertySchemaWithLimit)(f)&&1!==f.limit)),[f]),h=Boolean(f&&"button"!==f.type&&"rollup"!==f.type&&"formula"!==f.type&&"text"===(0,tm.vc)(f.type)),S=Boolean(f&&"button"!==f.type&&"rollup"!==f.type&&"formula"!==f.type&&"number"===(0,tm.vc)(f.type)),b=Boolean(f&&"date"===f.type),w=Boolean(f&&"status"===f.type),C=(0,P.VK)((()=>{if(f)return(0,Ms.qW)({table:Us.v,id:r.id,spaceId:r.getSpaceId()},d,f)}),[r,f,d]),T=(0,P.VK)((()=>{const e=n.getActionStores();if(y&&e.length>0){const t=e.find((e=>e.id===y));if(t&&t.isType("update_pages"))return t.getConfigStore().getKeyStore("values").getKeyStore(d).getValue()}}),[n,y,d]),[A,k]=(0,l.useState)(T),M=(0,l.useRef)(null==T?void 0:T.value),x=(0,Ms.A6)(null==A||null===(t=A.value)||void 0===t?void 0:t.value),Z=(0,P.VK)((()=>{if(!g)return[];return g.context[lm].getActionIds().some((e=>e===y))?g.getContextValuesForAction(y):g.getAllContextValues()}),[g,y]),I=(0,l.useCallback)((e=>{p({action:{id:y,config:{properties:[d],target:{id:(0,em.J0)(),type:"variable"},values:{[d]:{action:rm,value:e}}},type:"update_pages"},type:"update_action"})}),[y,d,p]),D=(0,l.useCallback)((()=>{I(M.current),s()}),[I,s]),F=(0,l.useCallback)((e=>{if(M.current=e,h||S||v)k({action:rm,value:e});else if(b){const t=(0,Ms.A6)(null==e?void 0:e.value);0===t.length?D():(0,Ms.S3)(t[0])&&(0,Ds.isDateAnnotation)(t[0])&&k({action:rm,value:e})}}),[b,h,S,v,D]),V=vp({automationTriggerActionMenuStore:i,leftStyle:{flexGrow:0},onClose:D,onDone:v||h||S?D:void 0,rightStyle:{flexGrow:0},title:a()("div",{style:{display:am,minWidth:0,whiteSpace:"pre"}},void 0,m[nm](dm.menuHeaderTitle,{propertyName:a()("div",{style:{..._.Z[im]}},void 0,(null==f?void 0:f.name)??"")})),titleStyle:{minWidth:0}});if(!f||!C||!g)return null;const B={type:"collection",[sm]:r,property:d};return a()(om.a,{context:B,contextStore:g,currentSimpleFormulaValueTokens:x,disabled:!1,formulaTypecheckContextValues:Z,menuProps:V,onChange:F,onClose:D,showClearButton:!w,type:C,value:null==A?void 0:A.value})}var um=o(29758);const pm=o(85).D7I,mm=o(85).axF,gm=o(85).oWD,ym=o(85).EQe;function fm(e){window.__c={n:"AutomationEventActionUpdatePagesMenu"};const{actionId:t,automationActionMenuStore:o,[ym]:i,[gm]:n,onClose:r,updateCurrentState:s}=e,d=(0,Bs.z)(mm),p=Gc({[ym]:i,[gm]:n}),m=vp({automationTriggerActionMenuStore:o,leftStyle:{flexGrow:0},onClose:r,rightStyle:{flexGrow:0},title:l[pm](u.FormattedMessage,d.display.name)}),g=(0,l.useCallback)((e=>{s({action:{id:(0,c.default)(),config:{properties:["title"],target:e,values:{}},type:mm},type:"update_action"}),r()}),[r,s]);return p?l[pm](lt.Z,m,a()(um.H,{actionId:t,automationContextStore:p,onChange:g,onClose:r,skipPages:!0})):null}var vm=o(32161),hm=o(5500),Sm=o(18441);const bm=o(85).wuN,wm=o(85).ChN,Cm=o(85).jkI,Pm=o(85).UPJ,Tm=o(85).Vtp,Am=o(85).J4z,km=o(85).MQR,_m=o(85).nx5,Mm=o(85).dV,xm=o(85).BNo,Zm=o(85).nuv,Im=o(85).IDV,Dm=o(85).VUQ,Fm=o(85).wgE,Vm=o(85).KCN,Bm=o(85).D7I,Em=o(85).BQ6,Km=o(85).L_E,Rm=o(85).qHm,Nm=o(85).n_z,Om=o(85).KfU,Wm=o(85).qJ8;function Um(e){window.__c={n:"AutomationSlackConnectToSlackView"};const{type:t,automationActionMenuStore:o,onClose:i}=e,n=Hm(),r=(0,P.VK)((()=>{var e;return null===(e=qc.default.state[Wm])||void 0===e?void 0:e.id}),[]),d=(0,P.VK)((()=>qc.default.state.currentUserStore),[]),c=(0,P.VK)((()=>{if("connectToSlackReconnect"===t&&d)return(0,zs.Kv)(d,{table:vm.P,id:e.externalBotId,spaceId:r}).getValue()}),[r,d,e,t]);let p,m=zm({viewType:Om});if("connectToSlackReconnect"===t){if(!c)return null;const{accountName:e,[Nm]:t}=(0,Sm.jg)(c);p=(0,Sm.jc)(c),m=zm({viewType:Rm,accountName:e,[Nm]:t})}return a()(mp,{type:"custom",automationTriggerActionMenuStore:o,onClose:i},void 0,a()(j.Z,{},void 0,a()("div",{[Em]:n[Km]},void 0,a()(Lm,{}),a()("div",{[Em]:n.connectToSlackBody},void 0,a()("div",{[Em]:n.connectToSlackTitleText},void 0,function(e){if("connectToSlackDefault"===e)return a()(u.FormattedMessage,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.title",[_m]:"Connect to Slack"});if("connectToSlackReconnect"===e)return a()(u.FormattedMessage,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.reconnect.title",[_m]:"Reconnect to Slack"});(0,k.unreachable)(e)}(t)),a()("div",{[Em]:n.connectToSlackDescriptionText},void 0,m)),l[Bm](Gm,s()({},e,{slackWorkspaceId:p})))))}function Gm(e){window.__c={n:"AuthActionButtons"};const{automationActionMenuStore:t,slackWorkspaceId:o}=e,i=(0,C.O7)(),n=Hm(),r=(0,P.VK)((()=>{var e;return null===(e=qc.default.state[Wm])||void 0===e?void 0:e.id}),[]),s=(0,P.VK)((()=>os.Z.integrations.state.find((e=>e.id===hm.nO))),[]),l=Vm;return s&&r?a()("div",{[Em]:n.buttonGroup},void 0,a()(it.Z,{[Em]:n.connectToSlackButton,isLarge:!0,onClick:async()=>{const n=await es.hM({[Fm]:i,[Dm]:s,spaceId:r,from:l,options:{slackWorkspaceId:o}});Ns.x.isFail(n)?t.replaceSettingsItem({type:Im}):"connectToSlackReconnect"===e.type||("connectToSlackDefault"===e.type?n.value[Zm]?t.replaceSettingsItem({type:xm,[Mm]:n.value[Zm]}):t.replaceSettingsItem({type:Im}):(0,k.unreachable)(e))}},void 0,a()(u.FormattedMessage,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.connectButton.label",[_m]:"Connect"})),a()(Ia.Z,{[Em]:n[km],isLarge:!0,onClick:()=>{t[Am]()}},void 0,a()(u.FormattedMessage,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.cancelButton.label",[_m]:"Cancel"}))):null}function Lm(){window.__c={n:"SlackIcon"};const e=Hm();return a()("div",{},void 0,a()("img",{src:kn.Z.images[Tm].slackIconPng,[Em]:e.slackIcon}))}function zm(e){const{viewType:t}=e;return"connectToSlackDefault"===t?a()(u.FormattedMessage,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.description",[_m]:"Get notified in channels, see rich previews, and more."}):"connectToSlackReconnect"===t?a()(u.FormattedMessage,{id:"AutomationSlackConnectToSlackView.reconnect.description",[_m]:'Reconnect your Slack account ({accountName}) on {hasOrganizationName, select, true {"{organizationName}"} other {your Slack workspace}} to resume your notifications.',values:{accountName:e.accountName,hasOrganizationName:(0,k.isDefined)(e[Nm]),[Nm]:e[Nm]}}):void(0,k.unreachable)(t)}function Hm(){return(0,T.yK)((e=>({[Km]:{display:"flex",flexDirection:"column",margin:"10px 15px",[Pm]:Cm,textAlign:Cm},connectToSlackBody:{margin:"0px 25px"},connectToSlackTitleText:{marginBottom:2,[wm]:_.Z[wm].semibold},connectToSlackDescriptionText:{fontSize:13,color:e[bm]},slackIcon:{width:23,height:"auto"},buttonGroup:{margin:"10px 10px 0px 10px"},connectToSlackButton:{width:"100%"},[km]:{color:e[bm],width:"100%",[Pm]:Cm,[wm]:_.Z[wm].medium,fontSize:13,marginTop:8}})),[])}var qm=o(89074);const jm=o(85).nx5,Qm=o(85).dV,$m=o(85).HXm;function Xm(e){window.__c={n:"AutomationSlackSelectChannelView"};const{automationActionMenuStore:t,updateCurrentAutomationState:o,onClose:i}=e,n="selectChannelUpdate"===e.type?e.actionId:void 0,r=l.useCallback(((e,t)=>{o({type:"update_action",action:{id:n??(0,c.default)(),type:$m,config:{target:e,external_bot_id:t.parent_id}}}),i()}),[n,i,o]),s=(0,l.useCallback)((()=>{const e=t.getState().stack;e.length<2||("selectWorkspace"===e[e.length-2].type?t.popSettingsItem():t.replaceSettingsItem({type:"selectWorkspace"}))}),[t]);return a()(qm.ZP,{[Qm]:e[Qm],currentNotificationChannel:"selectChannelNew"===e.type?void 0:"selectChannelUpdate"===e.type?e.currentNotificationChannel:(0,k.unreachable)(e),onClose:i,onNotificationChannelSelect:r,onNewSlackAccountAdded:s,renderMenu:e=>a()(mp,{type:"default",automationTriggerActionMenuStore:t,headerTitle:a()(u.FormattedMessage,{id:"notificationRuleSettings.selectChannelView.title",[jm]:"Select Slack channel"}),sections:e,onClose:i})})}var Ym=o(93364);const Jm=o(85).nx5,eg=o(85).dV;function tg(e){const{automationActionMenuStore:t,onClose:o}=e,i=l.useCallback((e=>{t.pushSettingsItem({type:"selectChannelNew",[eg]:e})}),[t]);return a()(Ym.U,{onWorkspaceSelect:i,renderMenu:e=>a()(mp,{type:"default",automationTriggerActionMenuStore:t,headerTitle:a()(u.FormattedMessage,{id:"notificationRuleSettings.selectSlackWorkspace.title",[Jm]:"Select Slack workspace"}),sections:e,onClose:o})})}const og=o(85).BJA,ig=o(85).YGP,ng=o(85).dV,ag=o(85).BNo,rg=o(85).qHm,sg=o(85).iIv,lg=o(85).KfU,dg=o(85).oWD,cg=o(85).EQe;function ug(e){window.__c={n:"AutomationActionMenuController"};const{[cg]:t,[dg]:o,initialState:i,updateCurrentAutomationState:n,buttonPopupParent:r}=e,s=(0,P.VK)((()=>{const e=new ip;return e.setState({stack:[i]}),e}),[i]),d=(0,P.VK)((()=>s.getCurrentTab()),[s]),c=(0,l.useCallback)((()=>r.close()),[r]);if(!d)return null;if("connectToSlackDefault"===d.type)return a()(Um,{type:lg,automationActionMenuStore:s,[sg]:c});if("connectToSlackReconnect"===d.type)return a()(Um,{type:rg,externalBotId:d.externalBotId,notificationActionConfigStore:d.notificationActionConfigStore,automationActionMenuStore:s,[sg]:c});if("selectWorkspace"===d.type)return a()(tg,{automationActionMenuStore:s,[sg]:c});if("selectChannelNew"===d.type)return a()(Xm,{type:ag,updateCurrentAutomationState:n,[ng]:d[ng],automationActionMenuStore:s,[sg]:c});if("selectChannelUpdate"===d.type)return a()(Xm,{type:ig,updateCurrentAutomationState:n,[og]:d[og],[ng]:d[ng],currentNotificationChannel:d.currentNotificationChannel,automationActionMenuStore:s,[sg]:c});if("eventActions"===d.type)return a()(Jp,{availableActions:d.availableActions,automationActionMenuStore:s,[cg]:t,[dg]:o,[sg]:c,updateCurrentState:n});if("eventActionProperty"===d.type){const{propertyId:e,[og]:i}=d;return a()(cm,{[og]:i,automationActionMenuStore:s,[cg]:t,[dg]:o,[sg]:c,propertyId:e,updateCurrentState:n})}return"eventActionCreatePage"===d.type?a()(Ap,{[cg]:t,automationActionMenuStore:s,[dg]:o,[sg]:c,updateCurrentState:n}):"eventActionUpdatePages"===d.type?a()(fm,{[og]:d[og],automationActionMenuStore:s,[cg]:t,[dg]:o,[sg]:c,updateCurrentState:n}):(0,k.unreachable)(d)}const pg=o(85).ydP,mg=o(85).dLQ,gg=o(85).D7I,yg=o(85).HXm,fg=o(85).g4H,vg=o(85).PG2,hg=o(85).BQ6,Sg=(o(85).N0E,o(85).Hr2),bg=o(85).PXg,wg=o(85).ChN,Cg=o(85).L_E,Pg=o(85).dV,Tg=o(85).YGP,Ag=o(85).qHm,kg=o(85).KfU,_g=o(85).byI,Mg=o(85).PLy,xg=o(85).tqF,Zg=o(85).oWD,Ig=o(85).EQe,Dg=o(85).nx5,Fg=(0,u.defineMessages)({slackNonOwnerPrivateChannel:{id:"slackNotificationAction.slackTargetPersonalChannel.displayName",[Dg]:"Private channel"}});function Vg(e){window.__c={n:"SlackNotificationAction"};const{actionStore:t,[Ig]:o,[Zg]:i,currentUserIsOwner:n,disabled:r,updateCurrentAutomationState:d}=e,c=(0,zc.d)(),p=(0,P.VK)((()=>t[xg]()),[t]),m=(0,P.VK)((()=>os.Z[Mg].state.find((e=>(null==p?void 0:p[_g])===e.id))),[p]),g=(0,P.VK)((()=>"disabled_auth"===(null==o?void 0:o.getStatus())),[o]),y=(0,P.VK)((()=>p&&m&&p.target?o&&t&&p[_g]&&g?{type:Ag,externalBotId:p[_g],notificationActionConfigStore:t}:{type:Tg,actionId:t.id,[Pg]:m,currentNotificationChannel:p.target}:{type:kg}),[p,t,o,m,g]),f=Eg();return n?a()(st.ZP,{alignmentToOrigin:st.vR.Center,placementToOrigin:st.pO.Bottom,popupType:c,render:e=>a()(ug,{[Ig]:o,initialState:y,updateCurrentAutomationState:d,buttonPopupParent:e,[Zg]:i}),renderOrigin:e=>l[gg](yu,s()({},e,{disabled:r,[vg]:()=>{e[vg]()},title:a()(Bg,{actionStore:t,currentUserIsOwner:n}),icon:A.Z.slackLogo,[fg]:g&&a()("div",{[hg]:f[Cg]},void 0,A.Z.warning(f.warningIcon),a()("div",{[hg]:f[fg]},void 0,a()(u.FormattedMessage,{id:"SlackNotificationAction.caption.reconnectNeeded",[Dg]:"Reconnect Slack to resume"}))),onEdit:()=>{e[vg]()},onDelete:()=>{d({type:"remove_action",action:{id:t.id,type:yg}})}}))}):a()(yu,{disabled:!0,icon:A.Z.slackLogo,title:a()("div",{[hg]:f[Cg]},void 0,a()("div",{[hg]:{[wg]:500,[bg]:4}},void 0,a()(u.FormattedMessage,{id:Sg,[Dg]:"Notify"})),a()(Rg,{actionStore:t,isUserAutomationOwner:n}))})}function Bg(e){window.__c={n:"SlackActionTitle"};const{actionStore:t,currentUserIsOwner:o}=e,i=Eg(),n=(0,P.VK)((()=>t[xg]()),[t]);return n&&n[_g]&&n.target?a()("div",{[hg]:i[Cg]},void 0,a()("div",{[hg]:{[wg]:500,[bg]:4}},void 0,a()(u.FormattedMessage,{id:Sg,[Dg]:"Notify"})),a()(Rg,{actionStore:t,isUserAutomationOwner:o})):a()("div",{[hg]:i[Cg]},void 0,a()(u.FormattedMessage,{id:"slackNotificationAction.actionTitle.slackNotificationPlaceholder",[Dg]:"Send Slack notification to‚Ä¶"}))}function Eg(){return(0,T.yK)((e=>({[Cg]:{display:"flex",flexDirection:"row",alignItems:"center",padding:0,gap:4},[fg]:{fontSize:12,[wg]:400,color:e.mediumTextColor},warningIcon:{width:12,height:"auto",color:e.accentColors.orange[400]}})),[])}function Kg(e){const{[mg]:t}=e,o=t?_.Z.fontSize.UISmall.mobile:_.Z.fontSize.UISmall.desktop;return(0,T.yK)((()=>({[pg]:{..._.Z.textOverflowStyle},[Cg]:{display:"inline-flex",alignItems:"baseline",gap:2},lockIcon:{width:o,height:"auto",alignSelf:"center"}})),[o])}function Rg(e){window.__c={n:"SlackChannelWithIcon"};const{actionStore:t,isUserAutomationOwner:o}=e,i=(0,C.O7)(),n=(0,P.VK)((()=>Boolean((0,Rc.userHasPermissionViaPublicAccess)(i,t))),[t,i]),r=(0,P.VK)((()=>{var e;return null===(e=t[xg]())||void 0===e?void 0:e.target}),[t]);return!r||n?a()(Ug,{}):"public"===r.type?a()(Ng,{channelName:r.name}):"private"===r.type?a()(Og,{channelName:r.name,isUserAutomationOwner:o}):"me"===r.type?a()(Wg,{channelName:r.name,isUserAutomationOwner:o}):(0,k.unreachable)(r.type)}function Ng(e){window.__c={n:"PublicSlackChannel"};const{[mg]:t}=(0,C.Fy)(),o=Kg({[mg]:t});return a()("span",{[hg]:o[pg]},void 0,`#${e.channelName}`)}function Og(e){window.__c={n:"PrivateSlackChannel"};const{channelName:t,isUserAutomationOwner:o}=e,{[mg]:i}=(0,C.Fy)(),n=Kg({[mg]:i});return o?a()("span",{[hg]:{...n[pg],...n[Cg]}},void 0,A.Z.locked(n.lockIcon),t):a()(Ug,{})}function Wg(e){window.__c={n:"MeSlackChannel"};const{channelName:t,isUserAutomationOwner:o}=e,{[mg]:i}=(0,C.Fy)(),n=Kg({[mg]:i});return o?a()("span",{[hg]:n[pg]},void 0,`@${t}`):a()(Ug,{})}function Ug(){window.__c={n:"NonOwnerPrivateChannel"};const e=(0,u.useIntl)(),{[mg]:t}=(0,C.Fy)(),o=Kg({[mg]:t}),i=e.formatMessage(Fg.slackNonOwnerPrivateChannel);return a()("span",{[hg]:{...o[pg],...o[Cg]}},void 0,A.Z.locked(o.lockIcon),i)}var Gg=o(92864);const Lg=o(85).zaB,zg=o(85).LtW,Hg=o(85).rpY,qg=o(85).ccq,jg=o(85).D7I,Qg=o(85).Yzm,$g=o(85).X_m,Xg=o(85).nx5,Yg=(0,u.defineMessages)({automationSummaryCardMoreButtonAriaLabel:{[Xg]:"More",id:"automations.AutomationSummaryCard.MoreActionsButton.ariaLabel"},automationSummaryCardMoreMenuEditTitle:{[Xg]:"Edit",id:"automations.AutomationSummaryCard.MoreActionsMenu.Edit.title"},automationSummaryCardMoreMenuDuplicateTitle:{[Xg]:"Duplicate",id:"automations.AutomationSummaryCard.MoreActionsMenu.Duplicate.title"},automationSummaryCardMoreMenuDisableTitle:{[Xg]:"Disable",id:"automations.AutomationSummaryCard.MoreActionsMenu.Disable.title"},automationSummaryCardMoreMenuEnableTitle:{[Xg]:"Enable",id:"automations.AutomationSummaryCard.MoreActionsMenu.Enable.title"},automationSummaryCardMoreMenuDeleteTitle:{[Xg]:"Delete",id:"automations.AutomationSummaryCard.MoreActionsMenu.Delete.title"}});function Jg(e){window.__c={n:"AutomationSummaryMoreActionsButton"};const{focused:t,style:o,onEdit:i,onDelete:n,onDuplicate:r,onDisable:d,onEnable:c}=e,p=(0,u.useIntl)(),m=(0,P.qz)(void 0,V.Z),g=(0,zc.d)();(0,l.useEffect)((()=>{t||m.setState({open:!1})}),[t,m]);const y=(0,T.yK)((e=>({iconButton:{border:`1px solid ${e.regularDividerColor}`,[$g]:26,width:26,...o},iconButtonIcon:{width:16}})),[o]);return l[jg](l.Fragment,null,a()(st.ZP,{stopClickPropagation:!0,popupType:g,alignmentToOrigin:st.vR.Center,[qg]:st.pO.Bottom,originGap:0,renderOrigin:e=>l[jg](iu.Z,s()({ariaLabel:p[Qg](Yg.automationSummaryCardMoreButtonAriaLabel),icon:A.Z.dots,iconStyle:y.iconButtonIcon,style:y.iconButton,hasBackground:!0},e)),[Hg]:e=>a()(ey,{onClose:()=>e.close(),onEdit:i,onDelete:n,onDuplicate:r,onDisable:d,onEnable:c}),[zg]:m}))}function ey(e){window.__c={n:"MoreActionsMenu"};const{onClose:t,onEdit:o,onDelete:i,onDuplicate:n,onDisable:r,onEnable:d}=e,c=(0,u.useIntl)(),p=(0,Lc.F)(),m=o?{action:()=>{t(),o()},key:"edit",[Hg]:e=>l[jg](Nt.Z,s()({},e,{icon:A.Z.pencil({[$g]:16,width:16}),title:c[Qg](Yg.automationSummaryCardMoreMenuEditTitle)}))}:void 0,g=n?{action:()=>{t(),n()},key:Lg,[Hg]:e=>l[jg](Nt.Z,s()({},e,{icon:A.Z[Lg]({[$g]:16,width:16}),title:c[Qg](Yg.automationSummaryCardMoreMenuDuplicateTitle)}))}:void 0,y=r?{action:()=>{t(),r()},key:"disable",[Hg]:e=>l[jg](Nt.Z,s()({},e,{icon:A.Z.boltSlash({[$g]:16,width:16}),title:c[Qg](Yg.automationSummaryCardMoreMenuDisableTitle)}))}:void 0,f=d?{action:()=>{t(),d()},key:"enable",[Hg]:e=>l[jg](Nt.Z,s()({},e,{icon:A.Z.bolt({[$g]:16,width:16}),title:c[Qg](Yg.automationSummaryCardMoreMenuEnableTitle)}))}:void 0,v=i?{action:()=>{t(),i()},key:"delete",[Hg]:e=>l[jg](Nt.Z,s()({},e,{icon:A.Z.trash({[$g]:16,width:16}),title:c[Qg](Yg.automationSummaryCardMoreMenuDeleteTitle)}))}:void 0;return l[jg](lt.Z,p,a()(Wt.Z,{type:Wt.i.Vertical,sections:[{items:[m,g,y,f,v].filter(k.isDefined),key:"items",[Hg]:e=>l[jg](j.Z,s()({enableActionSheetTitle:!0,topBorder:!0},e))}],initialFocus:0}))}const ty=o(85).UPJ,oy=o(85).Scd,iy=o(85).zBE,ny=o(85).kUY,ay=o(85).CEC,ry=o(85).BQ6,sy=o(85).ewQ,ly=o(85).UA5,dy=o(85).fOf,cy=o(85).ChN,uy=o(85).rOg,py=o(85).jkI,my=o(85).H1U,gy=o(85).$bT,yy=o(85).sM5,fy=o(85).NF1,vy=o(85).g4H;function hy(e){window.__c={n:"AutomationSummaryCard"};const{actions:t,[vy]:o,focused:i,hasWarning:n,maxIcons:r,onClick:s,onDelete:d,onDisable:c,onDuplicate:u,onEdit:p,onEnable:m,title:g,triggers:y}=e,{isMobile:f}=(0,C.Fy)(),v=(0,l.useRef)(null),[h,S]=(0,Xc.Z)(),[b,w]=eu(),k=(0,P.qz)(void 0,ou.Z),M=(0,P.VK)((()=>k.getState()),[k]),x=f||M.hovered||S||w,Z=(0,T.yK)((e=>({wrap:{border:`1px solid ${e.regularDividerColor}`,[fy]:8,[yy]:"flex",[gy]:"column",gap:15,padding:15,position:"relative"},moreButtonWrap:{[yy]:x?"block":"none",position:"absolute",right:8,top:8},iconList:{[yy]:"flex",flexWrap:"wrap",gap:5,listStyle:"none",margin:"0 30px 0 0",padding:0},body:{[yy]:"flex",[gy]:"column",gap:f?4:2},titleWrap:{...n?{[my]:py,[yy]:uy,gap:4}:ky(2),fontSize:f?16:14,[cy]:_.Z[cy].medium,lineHeight:"130%"},title:{...n?_.Z.textOverflowStyle:{}},[dy]:{[ly]:e[sy].orange[400],height:"auto",width:f?16:14},[vy]:{...ky(2),[ly]:e.lightTextColor,fontSize:f?14:12,[cy]:_.Z[cy].regular,lineHeight:"130%",margin:0}})),[n,x,f]);(0,l.useEffect)((()=>{i&&null!==v.current&&v.current.focus()}),[i]);const I=(0,tu.lq)(v,h,b),D=function(e){const{actionIcons:t,maxIcons:o,triggerIcons:i}=e,n=i.length,a=t.length,r=n>0&&a>0,s=Math.max(o,3),l=r?s-1:s;let d=Math.max(Math.floor(l/2),1),c=Math.max(Math.ceil(l/2),1);if(n<d&&a>c){c+=d-n,d=n}else if(a<c&&n>d){d+=c-a,c=a}const u=[];if(n>0)if(n>d)if(1===d)u.push({[ly]:ny,type:iy,value:n});else{const e=n-(d-1);u.push(...i.slice(0,d-1)),u.push({[ly]:ny,type:iy,value:e})}else u.push(...i);r&&u.push({type:"arrow"});if(a>0)if(a>c)if(1===c)u.push({[ly]:ny,type:iy,value:a});else{const e=a-(c-1);u.push(...t.slice(0,c-1)),u.push({[ly]:ny,type:iy,value:e})}else u.push(...t);return u}({actionIcons:t,maxIcons:Ay(r),triggerIcons:y}),F=Boolean(d||c||m||u||p);return l.createElement(K.Z,{onClick:s,ref:I,store:k,[ry]:Z.wrap},a()("header",{},void 0,F&&a()("div",{[ry]:Z.moreButtonWrap},void 0,a()(Jg,{focused:x,onDelete:d,onDisable:c,onEnable:m,onDuplicate:u,onEdit:p})),a()("ul",{"aria-hidden":ay,[ry]:Z.iconList},void 0,D.map(((e,t)=>a()("li",{},t,a()(Sy,{icon:e})))))),a()("div",{[ry]:Z.body},void 0,a()("div",{[ry]:Z.titleWrap},void 0,a()("span",{[ry]:Z.title},void 0,g),n&&A.Z[dy](Z[dy])),o&&a()("p",{[ry]:Z[vy]},void 0,o)))}function Sy(e){const{icon:t}=e;return"property"===t.type||"page"===t.type||"misc"===t.type?a()(by,{[ly]:t[ly],icon:t.icon}):"person"===t.type?a()(Ty,{actor:t.actor}):"app"===t.type?a()(Cy,{[ly]:"default",icon:t.icon}):"arrow"===t.type?a()(wy,{}):"truncate"===t.type?a()(Py,{[ly]:t[ly],value:t.value}):void(0,k.unreachable)(t.type)}function by(e){window.__c={n:"StandardIcon"};const{[ly]:t,icon:o}=e,i=_y(t);return a()("div",{"aria-hidden":ay,[ry]:i.iconWrap},void 0,A.Z[o](i.icon))}function wy(){window.__c={n:"ArrowIcon"};const e=_y("default");return a()("div",{[ry]:{...e.iconWrap,...e.iconArrowWrap}},void 0,A.Z.arrowRight({...e.icon,...e.iconArrow}))}function Cy(e){window.__c={n:"AppIcon"};const{icon:t}=e,o=_y("default");return a()("div",{"aria-hidden":ay,[ry]:o.iconAppWrap},void 0,A.Z[t](o.iconApp))}function Py(e){window.__c={n:"TruncateIcon"};const{[ly]:t,value:o}=e,i=_y(t);return a()("div",{[ry]:{...i.iconWrap,...i.truncateWrap}},void 0,"+",o)}function Ty(e){window.__c={n:"PersonIcon"};const{actor:t}=e,o=_y("default");return a()("div",{"aria-hidden":ay,[ry]:o.iconPersonWrap},void 0,a()(Gg.ZP,{actor:t,avatarSize:26,format:Gg.ZP.Format.Inline,isSingle:!1,showRemoveButton:!1,[ry]:{margin:0}}))}function Ay(e){return void 0===e||e<0?6:e}function ky(e){return{[yy]:"-webkit-box",overflow:"hidden",WebkitBoxOrient:"vertical",WebkitLineClamp:e}}function _y(e){const t="default"===e?ny:e;return(0,T.yK)((e=>{const o="light"===e.mode?400:800,i="light"===e.mode?100:400;return{icon:{fill:e[sy][t][o],width:16},iconWrap:{[oy]:e[sy][t][i],[fy]:6,padding:6},iconApp:{width:14},iconAppWrap:{[fy]:6,borderWidth:1,borderStyle:"solid",borderColor:e[sy][ny][i],padding:6},iconPerson:{[yy]:"block",width:"100%"},iconPersonWrap:{[my]:py,[yy]:"flex",height:28,[ty]:py,width:28},iconArrow:{fill:e[sy][ny][600]},iconArrowWrap:{[oy]:void 0},truncateWrap:{[my]:py,[oy]:e[sy][ny][500],[ly]:e[sy][t][o],[yy]:uy,fontSize:12,[cy]:_.Z[cy].semibold,height:28,[ty]:py,padding:3,width:28}}}),[t])}var My=o(19889);const xy=o(85).zrY,Zy=o(85).fOf,Iy=o(85).nrD,Dy=o(85).qpZ,Fy=o(85).gdQ;function Vy(e){window.__c={n:"AutomationCompactSummaryCard"};const{icon:t,title:o,caption:i,hasWarning:n,onEdit:r,onDelete:s}=e,[d,c]=(0,Xc.Z)(),[u,p]=eu(),m=(0,P.qz)(void 0,ou.Z),g=(0,P.VK)((()=>m.getState()),[m]).hovered||c||p,y=(0,tu.lq)(d,u),f=function(e){return(0,T.yK)((t=>({CompactAutomationSummaryCard:{background:t[xy]},buttonPosition:{position:"relative",paddingTop:8,paddingBottom:8},buttonBorder:{borderWidth:1,borderStyle:"solid",borderColor:t.outlineButtonBorder,borderRadius:8},[Zy]:{width:16,height:"auto",color:t.accentColors.orange[400]},title:{display:"flex",flexDirection:"row",alignItems:"center",padding:0,gap:6},moreButtonWrap:{display:e?"block":"none",position:"absolute",right:8,top:8},[Fy]:{background:t.selectLightGray[100]},[Iy]:{[Iy]:"ellipsis",overflow:"hidden",minWidth:0,whiteSpace:"nowrap"}})),[e])}(g);return l.createElement(Nt.Z,{ref:y,focused:g,interactionStore:m,shouldWrapCaption:!0,buttonStyle:{...f.buttonPosition,...f.buttonBorder},[Fy]:f[Fy],title:a()("div",{},void 0,a()(Dy,{},void 0,a()("div",{style:f.moreButtonWrap},void 0,a()(Jg,{focused:g,onEdit:r,onDelete:s}))),a()("div",{style:f.title},void 0,t,a()("div",{style:f[Iy]},void 0,o),n&&A.Z[Zy](f[Zy]))),caption:i,onClick:r})}var By=o(62385);function Ey(e){window.__c={n:"AutomationCreatorAttribution"};const{automationCreatorPointer:t}=e,o=(0,C.O7)(),i=(0,u.useIntl)(),n=(0,P.VK)((()=>t&&new zs.U6(o,{table:My.KJ,id:t.id,spaceId:t.spaceId}).getDisplayName(i)),[t,o,i]);return a()(u.FormattedMessage,{id:"sendToSlack.automationCreatorCaption.label",defaultMessage:"Added by {automationCreatorName}",values:{automationCreatorName:n}})}const Ky=o(85).qYR,Ry=o(85).Yzm,Ny=o(85).eEu,Oy=o(85).nx5,Wy=(0,u.defineMessages)({pausedNotifications:{id:"NotificationRulesViewMain.slackChannel.notificationsPaused",[Oy]:"Paused ‚Ä¢"},pagesAddedWithViewName:{id:"configureNotificationRuleMenu.sendToSlack.existingRule.createPageEventCaptionWithView",[Oy]:"New pages{hasViewName, select, true { in {collectionViewName}} other {}}"},pagesEditedWithViewName:{id:"configureNotificationRuleMenu.sendToSlack.existingRule.updatePageEventCaptionWithView",[Oy]:"Property edits{hasViewName, select, true { in {collectionViewName}} other {}}"},pagesAddedAndEditedWithViewName:{id:"configureNotificationRuleMenu.sendToSlack.existingRule.createdAndUpdatedEventCaptionWithView",[Oy]:"New pages & edits{hasViewName, select, true { in {collectionViewName}} other {}}"},placeholder:{id:"database.viewSettings.notificationsTab.slack.placeholderCaption",[Oy]:"None"}});function Uy(e){var t;window.__c={n:"SlackAutomationCaption"};const{parentBlockStore:o,[Ny]:i,currentUserId:n}=e,r=i.createdByPointer,s=r.id===n&&r.table===My.KJ,l=null===(t=i.trigger)||void 0===t?void 0:t.event,d=(0,u.useIntl)(),c=(0,C.O7)(),p=(0,P.VK)((()=>{if("collection_view"===l.source.type){const e=zs.Xr.createChildStore(o,l.source.pointer);return(0,Nc.vU)({environment:c,intl:d,store:e})}}),[o,l,d,c]),m=d[Ry](function(e){const t=Boolean(e.pagesAdded),o="none"!==e[Ky].type;return t?o?Wy.pagesAddedAndEditedWithViewName:Wy.pagesAddedWithViewName:o?Wy.pagesEditedWithViewName:Wy.placeholder}(l),{hasViewName:Boolean(p),collectionViewName:p});return a()("div",{style:{overflow:"hidden",textOverflow:"ellipsis"}},void 0,function(e,t){if("disabled_permissions"!==e)return"";return t[Ry](Wy.pausedNotifications)}(i.automationStatus,d),s?m:a()(Ey,{automationCreatorPointer:r}))}const Gy=o(85).eEu,Ly=o(85).G80,zy=o(85).xw1,Hy=o(85).DIE,qy=o(85).jMb,jy=o(85).Sgw,Qy=o(85).D7I,$y=o(85).PG2,Xy=o(85).hd7,Yy=o(85).nx5,Jy=o(85).cMN,ef=o(85).hDW,tf=o(85).oWD,of=o(85).uzK,nf=o(85).P24,af=o(85).HxR;function rf(e){window.__c={n:"CollectionSettingsSlackAutomationsView"};const{[af]:t,[nf]:o}=e,i=(0,u.useIntl)(),n=(0,P.VK)((()=>{var e;return null===(e=qc.default.state.currentUserStore)||void 0===e?void 0:e.id}),[]),r=(0,P.VK)((()=>o[of]()),[o]),d=(0,P.VK)((()=>o[tf]()),[o]),[c,p]=l.useState(!1),g=(0,P.VK)((()=>{if(!r||!d)return[];return d.getAutomationStores().map((e=>{const t=e.getModel();if(null==t||!t.getAlive())return;if(!e.isTriggerType("notification_event"))return;const o=e.getTrigger();if(!o)return;const n=se().first(e.getActionStores());if(!n||!n.isType("slack_notification"))return;const a=n.getConfig();if(!(0,Cs.E7)(a))return;const s=lf({automationTrigger:o,[ef]:r,[tf]:d});return{name:e.getNameWithDefault(i),trigger:o,config:a,createdByPointer:t.getCreatedByPointer(),notificationAutomationStore:e,notificationActionConfigStore:n,automationStatus:t.getStatus(),hasIncompatibleCollectionViewFilters:s,[Jy]:t.getLastEditedTime()}})).filter(k.isDefined)}),[d,r,i]),y=[],f=[];for(const a of g)n&&Zs.dr.isEqual(a.createdByPointer,{id:n,table:My.KJ})?y.push(a):f.push(a);y.sort(((e,t)=>t[Jy]-e[Jy])),f.sort(((e,t)=>t[Jy]-e[Jy]));let v=[];v=c?[...y,...f]:y.length>0?y:f;const h=g.length-v.length,S=(0,P.VK)((()=>pd({[tf]:d})),[d]),b=!c&&h>0,w=sf();return a()(B.ZP,{title:a()(u.FormattedMessage,{id:"collectionSettings.slackAutomationsView.header",[Yy]:"Slack notifications"}),[af]:t,[nf]:o,fullHeight:!0,footer:S&&a()(j.Z,{topBorder:!0},void 0,a()(E.Z,{icon:A.Z.plus,isGray:!0,title:a()(u.FormattedMessage,{id:"collectionSettings.slackAutomationsView.createNew",[Yy]:"New Slack notification"}),[$y]:()=>{m[Xy]({[af]:t,item:{type:"createSlackAutomation"}})}}))},void 0,a()("div",{style:w.list},void 0,v.map((e=>l[Qy](df,s()({},e,{key:e.notificationAutomationStore.id,[ef]:r,[tf]:d,[jy]:n,[nf]:o,[af]:t})))),b&&a()(By.Z,{style:w[qy],[$y]:e=>{e[Hy](),p(!0)}},void 0,a()("div",{style:w.showMoreButtonContent},void 0,a()(u.FormattedMessage,{id:"collectionSettings.slackAutomationsView.showMore",[Yy]:"Show {number} more",values:{number:h}})))))}function sf(){return(0,T.yK)((e=>({slackIcon:{width:16,height:"auto"},list:{display:"flex",flexDirection:"column",padding:12,gap:8},showMoreButtonContent:{fontSize:12},[qy]:{marginLeft:4,marginRight:"auto"}})),[])}function lf(e){const{automationTrigger:t,[ef]:o,[tf]:i}=e,n=t.event;if(!("source"in n))return!1;if("collection_view"!==n.source.type)return!1;return hd({collectionViewStore:zs.Xr.createChildStore(o,n.source.pointer),collectionSchema:i.getSchema()})}function df(e){window.__c={n:"CardForAutomationStuff"};const{notificationAutomationStore:t,name:o,automationStatus:i,hasIncompatibleCollectionViewFilters:n,[ef]:r,[tf]:s,[jy]:d,[af]:c,[nf]:p,notificationActionConfigStore:g}=e,y=(0,C.O7)(),f=(0,u.useIntl)(),v=sf(),h=(0,P.VK)((()=>p.aliveSlackAutomationCount.state),[p]),S=(0,P.VK)((()=>gd({automationStore:t})),[t]),b=l.useCallback((()=>{s&&Dc({intl:f,environment:y,[tf]:s,existingAutomationStore:t,triggerType:zy,onDelete:()=>{1===h&&m.closeSettings({[af]:c})}})}),[f,y,s,t,h,c]);return a()(Vy,{icon:A.Z.slackLogo(v.slackIcon),title:o,caption:r&&d&&a()(Uy,{[Ly]:r,[jy]:d,[Gy]:e}),hasWarning:"active"!==i||n,onEdit:()=>{m[Xy]({[af]:c,item:{type:"editSlackAutomation",automationId:t.id,automationActionId:g.id}})},onDelete:S?b:void 0},t.id)}var cf=o(33338),uf=o(21396),pf=o(75311);const mf=o(85).pHK,gf=o(85).m3w,yf=o(85).IK4,ff=o(85).Qxx,vf=o(85).Io9,hf=o(85).KRW,Sf=o(85).SFi,bf=o(85).f43,wf=o(85)._tz,Cf=o(85).FH8,Pf=o(85).nSw,Tf=o(85).OBh,Af=o(85).kUY,kf=o(85).aW,_f=o(85).k$k,Mf=o(85).v1$,xf=o(85).tqF,Zf=o(85).y1W,If=o(85).qYR,Df=o(85).UXD,Ff=o(85).Xl2,Vf=o(85).wgE,Bf=o(85).AnB,Ef=o(85).Lfz,Kf=o(85).Uie,Rf=o(85).UA5,Nf=o(85).ChN,Of=o(85).tBn,Wf=o(85).D7I,Uf=o(85).Gpy,Gf=o(85).EQe,Lf=o(85).Kiu,zf=o(85).Zij,Hf=o(85).BQ6,qf=o(85).PG2,jf=o(85).Yzm,Qf=o(85).jkI,$f=o(85).H1U,Xf=o(85).PXg,Yf=o(85).jMb,Jf=o(85).AIq,ev=o(85).rps,tv=o(85).$bT,ov=o(85).EMU,iv=o(85).sM5,nv=o(85).v8g,av=o(85).DIE,rv=o(85).ffk,sv=o(85).ImZ,lv=o(85).hd7,dv=o(85).MWD,cv=o(85).ejZ,uv=o(85).eiN,pv=o(85).N20,mv=o(85).TtP,gv=o(85).uzK,yv=o(85).oWD,fv=o(85).Lyb,vv=o(85).HxR,hv=o(85).P24,Sv=o(85).h2O,bv=o(85).nx5,wv=(0,u.defineMessages)({automationTabTitle:{[bv]:"Automations",id:"database.viewSettings.automationTab.title"},automationTabFilterButton:{[bv]:"Filter",id:"database.viewSettings.automationTab.filterButton"},automationTabAddFilterButton:{[bv]:"Add filter",id:"database.viewSettings.automationTab.addFilterButton"},automationTabFilterMenuSearchInputPlaceholder:{[bv]:"Filter by‚Ä¶",id:"database.viewSettings.automationTab.filterMenuSearchInputPlaceholder"},automationTabFilterMenuNoResults:{[bv]:"No results",id:"database.viewSettings.automationTab.filterMenuNoResults"},automationNewAutomationTitle:{[bv]:"New automation",id:"database.viewSettings.automationTab.newAutomationTitle"},automationLearnAutomationTitle:{[bv]:"Learn about automations",id:"database.viewSettings.automationTab.learnAutomationTitle"},automationDisabledCaption:{[bv]:"Disabled",id:"database.viewSettings.automationTab.disabledCaption"},[Sv]:{[bv]:"Automatically set status, assignees, property values and more with automations.",id:"database.viewSettings.automationTab.automationEmptyViewEditorPublic"},automationEmptyViewReadOnly:{[bv]:"You're a content viewer. Content viewers cannot create automations.",id:"database.viewSettings.automationTab.automationEmptyViewReadOnly"},automationEmptyViewContentOnly:{[bv]:"You're a content editor. Content editors can edit pages, but cannot create automations.",id:"database.viewSettings.automationTab.automationEmptyViewContentOnly"}});function Cv(e){window.__c={n:"CollectionSettingsAutomationsView"};const{[hv]:t,[vv]:o,[fv]:i,tabSettings:n}=e,r=(0,u.useIntl)(),d=(0,Hc.D)(),{isMobile:c}=(0,C.Fy)(),p=(0,P.VK)((()=>t[yv]()),[t]),g=(0,P.VK)((()=>t[gv]()),[t]),y=(0,P.VK)((()=>p&&p.id),[p]),f=(0,P.VK)((()=>null==p?void 0:p.getSchema()),[p]),v=(0,P.VK)((()=>null==p?void 0:p.getFormat()),[p]),h=(0,P.VK)((()=>function(e){const{[yv]:t,[gv]:o}=e;if(!t||!o)return[];const i=t.getAutomationStores(),n=[];for(const a of i){const e=a.getModel();null!=e&&e.getAlive()&&((a[Df]("event")||a[Df]("notification_event"))&&n[_f](a))}return n}({[yv]:p,[gv]:g})),[p,g]),S=(0,P.VK)((()=>{const e=Boolean(i&&i[mv]>0),t={[pv]:void 0,[fv]:i??[],open:e},o=$c.getState();return e||!o?t:o}),[i]),[b,w]=(0,l.useReducer)(Iv,Fv(S)),k=b[fv][mv]>0,_=b.open,M=(0,P.VK)((()=>h[uv]((e=>function(e,t){if(0===t[fv][mv])return!0;const o=e.getTrigger();if(!o||"notification_event"!==o[dv]&&"event"!==o[dv])return!1;const i=e[Bf]();return t[fv].every((e=>{const t=e[cv];if("some"===o.event[If][dv]){if(o.event[If].some.some((e=>e[rv]===t)))return!0}return i.some((e=>{var o;if(!e[Zf]("update_pages"))return!1;const i=e[xf]();return!!i&&(null===(o=i[Mf])||void 0===o?void 0:o.includes(t))}))}))}(e,b)))),[b,h]),x=(0,l.useMemo)((()=>new Set(b[fv].map((e=>e[cv])))),[b]),Z=(0,P.VK)((()=>{if(!v||!f)return[];const e=Cs._X({collectionFormat:v,collectionSchema:f,[uv]:e=>{let[t]=e;return!x.has(t)}}),t=Cs.cO({collectionFormat:v,collectionSchema:f,[uv]:e=>{let[t]=e;return!x.has(t)}});return Array.from(new Set([...e,...t]))}),[v,f,x]),I=(0,P.VK)((()=>ud({[yv]:p})),[p]);(0,l.useEffect)((()=>{p&&w({[dv]:"set_collection_id",value:p.id})}),[p]),(0,l.useEffect)((()=>{S&&w({[dv]:"set_state",value:S})}),[S]);const D=(0,l.useCallback)((()=>{m[lv]({[vv]:o,item:{[dv]:sv}})}),[o]),F=(0,l.useCallback)((e=>{w({[dv]:"add_filter",value:{[cv]:e[cv],[dv]:rv}})}),[]),V=(0,l.useCallback)(((e,t)=>{e[av](),w({[dv]:"remove_filter",value:{[cv]:t,[dv]:rv}})}),[]),K=(0,l.useCallback)((()=>{d&&y&&ws.qu(d,{[nv]:y})}),[d,y]);(0,l.useEffect)((()=>{if(!d||!y)return;const e="collection_table_header"===n.source?{property_type:n.propertyType,source:n.source}:{source:n.source};ws.d(d,{...e,[nv]:y})}),[d,y,n]);const[R,N]=l.useState(!1),O=(0,P.VK)((()=>function(e){var t;const o=null===(t=qc.default.state.currentUserStore)||void 0===t?void 0:t.pointer,i=[],n=[];for(const a of e){const e=a.getCreatedByPointer();o&&e&&Zs.dr.isEqual(o,e)?i[_f](a):n[_f](a)}return i.sort(((e,t)=>t[hf]()-e[hf]())),n.sort(((e,t)=>t[hf]()-e[hf]())),{currentUserAutomations:i,otherUserAutomations:n}}(M)),[M]),W=(0,l.useMemo)((()=>{const{currentUserAutomations:e,otherUserAutomations:t}=O;return R||b[fv][mv]>0?[...e,...t]:e[mv]>0?e:t}),[O,R,b]),U=M[mv]-W[mv],G=!R&&U>0,L=W[mv]>0,z=(0,T.yK)((()=>({buttonList:{[iv]:ov,[tv]:ev,[Jf]:1,gap:12,overflow:"hidden auto",paddingBlockEnd:c?0:12,paddingInline:12},emptyViewWrap:{paddingBlockEnd:42,paddingInline:12},menuScrollerStyle:{marginBlockStart:c?12:8},wrap:{[iv]:ov,[tv]:ev},[Yf]:{marginLeft:12,marginBottom:12,[Xf]:"auto"},showMoreButtonContent:{fontSize:12}})),[c]);if(!(p&&f&&v&&g))return null;const H=a()("div",{[Hf]:{[$f]:Qf,[iv]:ov,columnGap:4}},void 0,a()("div",{},void 0,r[jf](wv.automationTabTitle)),a()("div",{},void 0,k||_?a()(Av,{isActive:k,[qf]:e=>{e[av](),w(_?{[dv]:"close_filters"}:{[dv]:"open_filters"})}}):a()(Tv,{collectionSchema:f,[qf]:F,propertyIds:Z})));return l[Wf](B.ZP,s()({},e,{footer:a()(j.Z,{topBorder:!0},void 0,I&&a()(E.Z,{icon:A.Z.plus,[qf]:D,[zf]:r[jf](wv.automationNewAutomationTitle),isGray:!0}),a()(E.Z,{icon:A.Z.help,[qf]:K,[zf]:r[jf](wv.automationLearnAutomationTitle),isGray:!0})),menuScrollerStyle:z.menuScrollerStyle,[zf]:L?H:null}),a()("div",{[Hf]:z.wrap},void 0,_&&a()(Mv,{collectionSchema:f,[fv]:b[fv],onAddItemClick:F,onFilterItemClick:V,propertyIds:Z}),L?l[Wf](l[Of],null,a()("div",{[Hf]:z.buttonList},void 0,W.map(((e,i)=>a()(Zv,{[hv]:t,[yv]:p,[vv]:o,[gv]:g,focused:0===i,[Lf]:f,[Gf]:e},e.id)))),G&&a()(By.Z,{[Hf]:z[Yf],[qf]:e=>{e[av](),N(!0)}},void 0,a()("div",{[Hf]:z.showMoreButtonContent},void 0,a()(u.FormattedMessage,{id:"collectionSettings.automationsView.showMore",[bv]:"Show {number} more",[Uf]:{number:U}})))):a()("div",{[Hf]:z.emptyViewWrap},void 0,a()(Pv,{[yv]:p}))))}function Pv(e){window.__c={n:"EmptyView"};const{[yv]:t}=e,o=(0,C.O7)(),i=(0,T.yK)((e=>({wrap:{[$f]:Qf,[iv]:ov,[tv]:ev,gap:7.5,justifyContent:Qf,minHeight:250,textAlign:Qf},icon:{fill:e.icon.yellow,height:24,width:24},[zf]:{fontSize:17,[Nf]:_.Z[Nf].medium,margin:0},copy:{[Rf]:e.text.secondary,fontSize:14,margin:0,lineHeight:1.5}})),[]),n=(0,P.VK)((()=>t.getRole()),[t]);let r;return r=(0,P.VK)((()=>Boolean((0,Rc.userHasPermissionViaPublicAccess)(o,t))),[t,o])||!n||"editor"===n?wv[Sv]:"reader"===n||"comment_only"===n?wv.automationEmptyViewReadOnly:"content_only_editor"===n||"read_and_write"===n?wv.automationEmptyViewContentOnly:wv[Sv],a()("div",{[Hf]:i.wrap},void 0,a()("div",{"aria-hidden":!0},void 0,A.Z.boltFilled(i.icon)),a()("p",{[Hf]:i[zf]},void 0,l[Wf](u.FormattedMessage,wv.automationTabTitle)),a()("p",{[Hf]:i.copy},void 0,l[Wf](u.FormattedMessage,r)))}function Tv(e){window.__c={n:"AutomationViewFilterPopup"};const{collectionSchema:t,[qf]:o,propertyIds:i}=e,n=(0,zc.d)();return a()(st.ZP,{popupType:n,render:e=>a()(kv,{collectionSchema:t,onListItemClick:t=>{o(t),e.close()},propertyIds:i}),renderOrigin:e=>l[Wf](Av,e)})}function Av(e){window.__c={n:"AutomationViewFilterButton"};const{isActive:t,[qf]:o}=e,i=(0,u.useIntl)(),n=(0,T.yK)((e=>({button:{[$f]:Qf,borderRadius:3,fontSize:14,[Nf]:_.Z[Nf].regular,height:28,padding:6,...!t&&{[Rf]:e.mediumTextColor}}})),[t]);return a()(Ia.Z,{isBlue:t,[qf]:o,[Hf]:n.button},void 0,i[jf](wv.automationTabFilterButton))}function kv(e){window.__c={n:"AutomationViewFilterMenu"};const{collectionSchema:t,onListItemClick:o,propertyIds:i}=e,n=(0,T.Fg)(),r=(0,u.useIntl)(),d=(0,Lc.F)({maxHeight:"50vh",paddingBottom:6,paddingTop:6,width:266}),[c,p]=l.useState(""),m=(0,l.useMemo)((()=>Cd({collectionSchema:t,propertyIds:i,searchTerm:c})),[t,i,c]),g=a()(Ot.ZP,{focus:!0,onChange:e=>p(e.target.value),placeholder:r[jf](wv.automationTabFilterMenuSearchInputPlaceholder),[Hf]:{paddingBlock:"6px 12px"},value:c}),y=[{key:"section-properties",items:function(e){const{collectionSchema:t,intl:o,onItemClick:i,propertyIds:n,theme:r}=e;if(0===n[mv])return[{key:"no-items",action:se().noop,render:e=>l[Wf](Nt.Z,s()({},e,{disabled:!0,disabledFeedback:!0,[zf]:o[jf](wv.automationTabFilterMenuNoResults)}))}];return n.map((e=>{const o=t[e];if(o)return{action:t=>{const o={...t,[cv]:e};i(o)},key:e,render:e=>l[Wf](Nt.Z,s()({},e,{icon:a()(As.ZP,{icon:o.icon,size:16,theme:r,[dv]:o[dv]}),[zf]:o[Ef]}))}}))[uv](k.isDefined)}({collectionSchema:t,intl:r,onItemClick:o,propertyIds:m,theme:n}),render:e=>l[Wf](j.Z,s()({},e,{[Hf]:{padding:0}}))}];return l[Wf](lt.Z,s()({},d,{header:g}),a()(Wt.Z,{initialFocus:0,sections:y,[dv]:Wt.i.Vertical}))}function _v(e){window.__c={n:"AutomationViewFilterAddItemButton"};const{collectionSchema:t,[qf]:o,propertyIds:i}=e,n=(0,u.useIntl)(),r=(0,zc.d)();return a()(st.ZP,{popupType:r,render:e=>a()(kv,{collectionSchema:t,onListItemClick:t=>{o(t),e.close()},propertyIds:i}),renderOrigin:e=>l[Wf](Ia.Z,s()({},e,{icon:A.Z.plus,isLightGray:!0,isSmall:!0}),n[jf](wv.automationTabAddFilterButton))})}function Mv(e){window.__c={n:"AutomationViewFilterBar"};const{collectionSchema:t,[fv]:o,onAddItemClick:i,onFilterItemClick:n,propertyIds:r}=e,s=(0,T.Fg)(),d=(0,T.yK)((e=>({closeIconStyle:{marginBlockStart:1,marginInlineStart:4,width:14},pillInnerStyle:{minWidth:0},pillWrapStyle:{[Jf]:1,[Xf]:0,minWidth:0},propertyIcon:{fill:e.blueColor,[Xf]:6},wrap:{[iv]:ov,[Jf]:0,flexWrap:"wrap",gap:6,paddingBlockEnd:12,paddingInline:12,width:"100%"}})),[]);return a()("header",{[Hf]:d.wrap},void 0,o.map((e=>{const o=e[cv],i=t[o];if(i)return a()(cf.Z,{hideChevron:!0,icon:a()(As.ZP,{icon:i.icon,size:16,[Hf]:d.propertyIcon,theme:s,[dv]:i[dv]}),innerStyle:d.pillInnerStyle,on:!0,[qf]:e=>n(e,o),[zf]:l[Wf](l[Of],null,a()("span",{[Hf]:_.Z[Kf]},void 0,i[Ef]),A.Z.closeSmall(d.closeIconStyle)),wrapStyle:d.pillWrapStyle},o)}))[uv](k.isDefined),a()(_v,{collectionSchema:t,[qf]:i,propertyIds:r}))}const xv={number:"typesNumber",person:"typesPerson",date:"typesDate",checkbox:"typesCheckbox",select:"typesSelect",multi_select:"typesMultipleSelect",status:"typesStatus",relation:"typesRelation",[zf]:"typesTitle",text:"typesText",url:"typesUrl",email:"typesEmail",phone_number:"typesPhoneNumber"};function Zv(e){window.__c={n:"AutomationSummaryCardWrapper"};const{[Gf]:t,[hv]:o,[yv]:i,[vv]:n,[gv]:r,focused:s,[Lf]:d}=e,c=(0,u.useIntl)(),p=(0,C.O7)(),g=Gc({[Gf]:t,[yv]:i}),y=(0,P.VK)((()=>t[Bf]()),[t]),f=(0,P.VK)((()=>t.getTriggerStore().getValue()),[t]),v=(0,P.VK)((()=>t.getNameWithDefault(c)),[c,t]),h=(0,P.VK)((()=>"active"===t.getStatus()),[t]),S=(0,P.VK)((()=>o.aliveAutomationCount.state),[o]),b=(0,P.VK)((()=>md({actionStores:y,[Gf]:t})),[y,t]),w=(0,P.VK)((()=>gd({[Gf]:t})),[t]),T=(0,l.useCallback)((async()=>{await Dc({[yv]:i,[Vf]:p,existingAutomationStore:t,intl:c,triggerType:"event",onDelete:()=>{1===S&&m[Ff]({[vv]:n,item:{[dv]:"main"}})}})}),[c,p,i,n,t,S]),A=(0,l.useCallback)((()=>{Fc({[Gf]:t,[yv]:i,[Vf]:p})}),[i,p,t]),_=(0,l.useCallback)((()=>{m[lv]({[vv]:n,item:{[dv]:"automationEditSettings",automationId:t.id}})}),[n,t]),M=(0,l.useCallback)((()=>{Vc({[Gf]:t,[yv]:i,[Vf]:p})}),[i,p,t]),x=f?function(e){const{[Lf]:t,triggerConfig:o}=e;if("notification_event"!==o[dv]&&"event"!==o[dv])return[];const i=[];o.event.pagesAdded&&i[_f]({[Rf]:"blue",icon:"plus",[dv]:"page"});const n=o.event[If];if("any"===n[dv])i[_f]({[Rf]:"blue",icon:"pencil",[dv]:"misc"});else if("some"===n[dv])for(const a of n.some){const e=t[a[rv]],o=a[uv];if(!e)continue;const n=Qe.isStatusPropertySchema(e),r=Qe[kf](e);if("changes_to_any"===o.operator)i[_f]({[Rf]:n||r?Af:"blue",icon:xv[e[dv]],[dv]:rv});else if(n&&!Ps.mv(o)&&Ps.r2(o)){const t=Ps.wB(o);if(t[mv]>1)i[_f]({[Rf]:Af,icon:xv[e[dv]],[dv]:rv});else if(1===t[mv]){const o=t[0];if("is_group"===o[dv]){const t=(e.groups??[]).find((e=>e[Ef]===o.value));t&&i[_f]({[Rf]:t[Rf]??"gray",icon:xv[e[dv]],[dv]:rv})}else{const t=(e.options??[]).find((e=>e.value===o.value));t&&i[_f]({[Rf]:t[Rf]??"gray",icon:xv[e[dv]],[dv]:rv})}}}else if(r&&!Ps.mv(o)&&(Ps.dx(o)||Ps.NU(o))){const t=Ps.dx(o)?Ps.mg(o):Ps.qC(o);if(1===t[mv]){const o=t[0],n=(e.options??[]).find((e=>e.value===o.value));n&&i[_f]({[Rf]:n[Rf]??"gray",icon:xv[e[dv]],[dv]:rv})}else t[mv]>1&&i[_f]({[Rf]:Af,icon:xv[e[dv]],[dv]:rv})}}return i}({[Lf]:d,triggerConfig:f}):[],Z=(0,P.VK)((()=>function(e){const{actionStores:t,[yv]:o,[Lf]:i}=e,n=[];for(const d of t)if(d[Zf]("slack_notification"))n[_f]({icon:"slackLogo",[dv]:"app"});else if(d[Zf]("update_pages")){const e=d[xf](),t=(null==e?void 0:e[Mf])??[];if(1===t[mv]){var a,r;const l=t[0],d=i[l],c=null==e||null===(a=e[Uf])||void 0===a?void 0:a[l];if(!d||!c)continue;const u=(0,Ms.A6)(null===(r=c.value)||void 0===r?void 0:r.value);if(Qe.isStatusPropertySchema(d)){const e=(d.options||[]).find((e=>e.value===u[0]));e&&n[_f]({[Rf]:e[Rf]??"gray",icon:xv[d[dv]],[dv]:rv})}else if(Qe[kf](d))if(1===u[mv]){const e=(d.options||[]).find((e=>e.value===u[0]));e&&n[_f]({[Rf]:e[Rf]??"gray",icon:xv[d[dv]],[dv]:rv})}else u[mv]>1&&n[_f]({[Rf]:Af,icon:xv[d[dv]],[dv]:rv});else if(Qe.isPersonPropertySchema(d)){var s;const e=(0,Ts.toPersonValue)({textValue:null===(s=c.value)||void 0===s?void 0:s.value,[Tf]:d}).map((e=>(0,bs.Hl)({pointer:e,[Pf]:o[Pf]})));1===e[mv]?n[_f]({actor:e[0],[dv]:"person"}):n[_f]({[Rf]:Af,icon:xv[d[dv]],[dv]:rv})}else n[_f]({[Rf]:Af,icon:xv[d[dv]],[dv]:rv})}else t[mv]>1&&n[_f]({[Rf]:Af,icon:"pencil",[dv]:"misc"})}else if(d[Zf]("create_page")){var l;(null===(l=d[xf]())||void 0===l?void 0:l[Cf])&&n[_f]({[Rf]:"blue",icon:"plus",[dv]:"page"})}return n}({actionStores:y,[yv]:i,[Lf]:d})),[d,i,y]),I=(0,P.VK)((()=>h?g&&function(e){const{actionStores:t,automationContextStore:o,[yv]:i,canUserManageAutomation:n,intl:r,[Lf]:s,triggerConfig:l}=e;if(!l||"event"!==l[dv]&&"notification_event"!==l[dv])return;const{event:d}=l,c=[];d.pagesAdded&&c[_f](Nd(r));if("none"===d[If][dv]);else if("any"===d[If][dv])c[_f](Od(r));else if("some"===d[If][dv])for(const a of d[If].some){const e=s[a[rv]];if(!e)continue;const{[uv]:t}=a;if("changes_to_any"===t.operator)c[_f](Wd(r,{[wf]:e[Ef]}));else if(Cs.bD(e))if("status"===e[dv]){if(!Ps.r2(t)||!Ps.vR(t))continue;const o=Array.isArray(t.value)?t.value:[t.value],i=xu({groupValues:o.map((e=>"is_group"===e[dv]?e.value:void 0))[uv](k.isDefined),isText:!0,optionValues:o.map((e=>"is_option"===e[dv]?e.value:void 0))[uv](k.isDefined),[Tf]:e}),n=r[bf](i,{[Hf]:"long",[dv]:"disjunction"});c[_f](Gd(r,{[wf]:e[Ef],propertyValues:n}))}else if("select"===e[dv]||"multi_select"===e[dv]){if(Ps.mv(t)||!Ps.dx(t)&&!Ps.NU(t))continue;const o=Eu({isText:!0,optionValues:(Array.isArray(t.value)?t.value:[t.value]).map((e=>e.value))[uv](k.isDefined),[Tf]:e}),i=r[bf](o,{[Hf]:"long",[dv]:"disjunction"});c[_f](Ud(r,{[wf]:e[Ef],propertyValues:i}))}else(0,k.unreachable)(e)}const p=r[bf](c,{[Hf]:"long",[dv]:"disjunction"}),m=[];for(const f of t)if(f[Zf]("slack_notification"))m[_f](a()(u.FormattedMessage,{[bv]:"notify {channel}",id:"CollectionSettingsAutomationsView.summaryCard.slackAction",[Uf]:{channel:a()(Rg,{actionStore:f,isUserAutomationOwner:n})}}));else if(f[Zf]("update_pages")){const e=f[xf](),t=null==e?void 0:e[Mf],n=null==e?void 0:e[Uf];if(!t||0===t[mv]||!n)continue;if(t[mv]>1)continue;const r=t[0],l=s[r],d=n[r];if(!l||!d||!Cs.SF(l))continue;if("person"===l[dv])m[_f](a()(Vv,{[yv]:i,propertyActionValue:d,[Tf]:l}));else if("status"===l[dv]){const e=a()(Bv,{propertyActionValue:d,[Tf]:l});e&&m[_f](e)}else if("select"===l[dv]||"multi_select"===l[dv])m[_f](a()(Ev,{propertyActionValue:d,[Tf]:l}));else if("checkbox"===l[dv])m[_f](a()(Kv,{propertyActionValue:d,[Tf]:l}));else if("relation"===l[dv])m[_f](a()(Rv,{[yv]:i,propertyActionValue:d,[Tf]:l}));else if("date"===l[dv]){const e=a()(Nv,{automationContextStore:o,[yv]:i,propertyActionValue:d,[cv]:r,[Tf]:l});e&&m[_f](e)}else"number"===l[dv]||"phone_number"===l[dv]||"text"===l[dv]||"title"===l[dv]||"email"===l[dv]||"url"===l[dv]?m[_f](a()(Ov,{propertyActionValue:d,[Tf]:l})):(0,k.unreachable)(l)}else if(f[Zf]("create_page")){var g;const e=null===(g=f[xf]())||void 0===g?void 0:g[Cf];if(!e)continue;e.id===i.pointer.id?m[_f](a()(u.FormattedMessage,{[bv]:"create a page in this database",id:"automation.summaryCard.createPageThisDatabase"})):m[_f](a()(u.FormattedMessage,{[bv]:"create a page in another database",id:"automation.summaryCard.createPageAnotherDatabase"}))}const y=r[bf](m,{[Hf]:"long",[dv]:Sf});return r[jf]({[bv]:"When {triggers}, {actions}.",id:"automation.summaryCard.caption"},{actions:y,triggers:p})}({actionStores:y,automationContextStore:g,canUserManageAutomation:b,[yv]:i,intl:c,[Lf]:d,triggerConfig:f}):c[jf](wv.automationDisabledCaption)),[h,g,y,i,c,d,f,b]),D=(0,P.VK)((()=>{if(!t[Df]("event")&&!t[Df]("notification_event"))return!0;const e=t.getTrigger();return!e||lf({automationTrigger:e,blockStore:r,[yv]:i})}),[t,i,r]),F=!h||D;return a()(hy,{actions:Z,caption:I,focused:s,hasWarning:F,[qf]:_,onDelete:w?T:void 0,onDisable:h&&w?A:void 0,onEdit:b?_:void 0,onEnable:!h&&w?M:void 0,[zf]:v,triggers:x},t.id)}function Iv(e,t){if("add_filter"===t[dv]){const o={[pv]:e[pv],[fv]:[...e[fv],t.value],open:!0};return Dv(o),o}if("remove_filter"===t[dv]){const o={[pv]:e[pv],[fv]:e[fv][uv]((e=>e[cv]!==t.value[cv])),open:e.open};return Dv(o),o}if("set_state"===t[dv])return se().isEqual(e,t.value)?e:Fv(t.value);if("set_collection_id"===t[dv]){if(t.value===e[pv])return e;const o={[pv]:t.value,[fv]:[],open:!1};return Dv(o),o}if("open_filters"===t[dv]){if(e.open)return e;const t={...e,open:!0};return Dv(t),t}if("close_filters"===t[dv]){if(!e.open)return e;const t={...e,open:!1};return Dv(t),t}(0,k.unreachable)(t)}function Dv(e){$c.setState(e)}function Fv(e){const t=e[fv]??[],o=t[mv]>0&&(e.open??!1);return{[pv]:e[pv],[fv]:t,open:o}}function Vv(e){var t;window.__c={n:"PersonActionTitle"};const{[yv]:o,propertyActionValue:i,[Tf]:n}=e,a=(0,u.useIntl)(),r=(0,Ts.toPersonValue)({textValue:null===(t=i.value)||void 0===t?void 0:t.value,[Tf]:n}),s=(0,P.VK)((()=>r.map((e=>(0,bs.$4)(a,(0,bs.Hl)({pointer:e,[Pf]:o[Pf]}))))[uv](k.isDefined)),[r,o,a]),d=n[Ef],c=a[bf](s,{[Hf]:"long",[dv]:Sf});let p;return p=0===s[mv]?_d({[wf]:d}):1===s[mv]?Md({[wf]:d,[vf]:c}):xd({[wf]:d,[vf]:c}),l[Wf](u.FormattedMessage,p)}function Bv(e){var t;const{propertyActionValue:o,[Tf]:i}=e,n=(0,Ms.A6)(null===(t=o.value)||void 0===t?void 0:t.value)[0];if("string"!=typeof n)return null;const a=xu({groupValues:[],isText:!0,optionValues:[n],[Tf]:i});return 0===a[mv]?null:l[Wf](u.FormattedMessage,Ed({[wf]:i[Ef],[vf]:a}))}function Ev(e){var t,o;window.__c={n:"SelectActionTitle"};const{propertyActionValue:i,[Tf]:n}=e,a=(0,u.useIntl)(),r=null!==(t=i.value)&&void 0!==t&&t.value?(0,Ms.A6)(null===(o=i.value)||void 0===o?void 0:o.value):void 0,s=n[Ef],d=r?Eu({isText:!0,limit:Wu,optionValues:r.map((e=>"string"==typeof e?e:void 0))[uv](k.isDefined),[Tf]:n}):void 0,c=(null==d?void 0:d[mv])??0;let p;return p=void 0===d?Fd({[wf]:s}):1===c?Vd({[wf]:s,[vf]:d[0]}):Bd({[wf]:s,[vf]:a[bf](d,{[Hf]:"long",[dv]:Sf})}),l[Wf](u.FormattedMessage,p)}function Kv(e){var t;const{propertyActionValue:o,[Tf]:n}=e,a=(0,Ms.A6)(null===(t=o.value)||void 0===t?void 0:t.value)[0],r=n[Ef],s=!0===a?l[Wf](u.FormattedMessage,i[ff].actionCheckboxPropertyChecked):l[Wf](u.FormattedMessage,i[ff].actionCheckboxPropertyUnchecked);return l[Wf](u.FormattedMessage,Td({[wf]:r,[vf]:s}))}function Rv(e){window.__c={n:"RelationActionTitle"};const{[yv]:t,propertyActionValue:o,[Tf]:i}=e,n=(0,u.useIntl)(),a=(0,C.O7)(),r=o.value,s=(0,l.useMemo)((()=>void 0!==r?Ju(r,i.limit):[]),[r,i.limit]),d=(0,P.VK)((()=>s.map((e=>{const o=zs.G.createChildStore(t,{table:Is.iU,id:e});return(0,Nc.vU)({[Vf]:a,intl:n,store:o})}))[uv](k.isDefined)),[t,a,n,s]),c=i[Ef];let p;return p=0===d[mv]?Zd({[wf]:c}):1===d[mv]?Id({[wf]:c,[vf]:d[0]}):Dd({[wf]:c,[vf]:n[bf](d,{[Hf]:"long",[dv]:Sf})}),l[Wf](u.FormattedMessage,p)}function Nv(e){window.__c={n:"DateActionTitle"};const{automationContextStore:t,[yv]:o,propertyActionValue:n,[cv]:a,[Tf]:r}=e,s=(0,u.useIntl)(),d=(0,l.useMemo)((()=>({[dv]:Cf,[yv]:o,[rv]:a})),[o,a]),c=(0,P.VK)((()=>(0,pf._)(d)),[d]),p=(0,P.VK)((()=>Ld(t)),[t]),m=n.value,g=(0,Ms.A6)(null==m?void 0:m.value)[0],y=r[Ef];if(void 0===g)return l[Wf](u.FormattedMessage,Ad({[wf]:y}));if("string"==typeof g||"boolean"==typeof g||Ds.isUserAnnotation(g)||Ds.isPageAnnotation(g))return null;if(Ds.isDateAnnotation(g)){const e=Ds[yf](g);if(!e)return null;const t=(0,ks.ZV)({value:e,date_format:c.dateFormat,time_format:c.timeFormat,userTimeZone:(0,xs.r)(),allowRelativeDates:!0,intl:s,shortenDateAndRange:!0,[gf]:!0});return l[Wf](u.FormattedMessage,i[mf]({[wf]:y,[vf]:t}))}if(Ds.isFormulaContextValueMentionAnnotation(g)){const e=Ds.getFormulaContextValueAnnotationData(g).id,t=(0,_s.vx)(p,e);if(!t)return null;const o=(0,uf.e)(t);return l[Wf](u.FormattedMessage,i[mf]({[wf]:y,[vf]:o}))}return null}function Ov(e){var t,o;const{propertyActionValue:i,[Tf]:n}=e,a=(0,Ms.A6)(null===(t=i.value)||void 0===t?void 0:t.value)[0],r=n[Ef],s=a??Ds.getText(null===(o=i.value)||void 0===o?void 0:o.value),d=s?Rd({[wf]:r,[vf]:s}):Kd({[wf]:r});return l[Wf](u.FormattedMessage,d)}var Wv=o(8848),Uv=o(58573),Gv=o(59054),Lv=o(20270),zv=o(64002),Hv=o(54642),qv=o(43132),jv=o(761),Qv=o(70764),$v=o(75079);const Xv=o(85).Joh,Yv=o(85).D7I,Jv=o(85).ESK,eh=o(85).nx5,th=o(85).VUQ;function oh(e){window.__c={n:"CollectionSettingsAccountSelectionIndicator"};const{onClick:t,[th]:o,accountName:i}=e,n=(0,T.yK)((e=>({accountSelection:{padding:"8px",borderTop:`1px solid ${e.regularDividerColor}`,cursor:"pointer"},accountSelectionLabel:{fontWeight:_.Z.fontWeight.medium,paddingLeft:4,paddingTop:4}})),[]);return a()("div",{style:n.accountSelection},void 0,a()("div",{onClick:t},void 0,a()(Q.Z,{isSecondaryColor:!0,isSmall:!0,style:n.accountSelectionLabel},void 0,a()(u.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.currentAccountSection.label",[eh]:"Connected to {integration}",values:{[th]:o.name}})),a()(xn.Z,{[Xv]:()=>a()("span",{},void 0,i),placement:xn.Z[Jv].Left,textWrap:!0,render:t=>l[Yv](Nt.Z,s()({showExtensionArrow:!0,focused:!1},(0,ts.Z)(t||{},e),{title:i,icon:a()("img",{style:{width:18},src:o.info.icon})}))})))}var ih=o(1634),nh=o(31278);const ah=o(85).C_1,rh=o(85).jkI,sh=o(85).$bT,lh=o(85).gdQ,dh=(o(85).NKU,o(85).yqb,o(85).VP),ch=o(85).BQ6,uh=o(85).g7N,ph=o(85).dmz,mh=o(85).Gpy,gh=o(85).nx5,yh=(o(85).$Tv,o(85).ROP),fh=o(85).Scd,vh=o(85).gk7,hh=o(85).VUQ,Sh=o(85).P24;function bh(e){window.__c={n:"CollectionSettingsExternalAuthentication"};const{[Sh]:t,[hh]:o}=e,i=(0,T.Fg)(),n=(0,P.VK)((()=>t.collectionStore()),[t]),r=(0,P.VK)((()=>null==n?void 0:n.getIcon()),[n]),d=(0,C.O7)(),c=(0,P.VK)((()=>{var e;return null===(e=qc.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),p=(0,T.yK)((e=>({settingsMenu:{display:"flex",flexGrow:1,[sh]:"column",padding:"8px 16px 16px 8px"},authenticationBody:{display:"flex",alignItems:rh,justifyContent:rh,[sh]:"column",padding:"0px 16px 16px 16px",textAlign:rh},settingsMenuSubHeading:{display:"inline",fontSize:14,margin:"4px 20px 20px 20px",color:e.mediumTextColor,textAlign:rh},settingsMenuAuthenticationButton:{fontSize:14,height:32,color:e[ah]}})),[]),{[fh]:m,hoveredBackground:g,pressedBackground:y}=(0,hm.dg)(o,i.mode);return l.createElement(B.ZP,s()({},e,{title:a()(u.FormattedMessage,{[gh]:yh,id:"collectionSettingsCreateExternalViewPicker.authenticateHeader.title",[mh]:{[hh]:o.name}})}),a()("div",{[ch]:p.settingsMenu},void 0,a()("div",{[ch]:p.authenticationBody},void 0,a()(nh.Z,{disabled:!0,bucket:ph,store:n,icon:r,size:40,isEmptyPage:!1,[ch]:{[uh]:6}}),a()("div",{[ch]:p.settingsMenuSubHeading},void 0,a()(u.FormattedMessage,{[gh]:dh,id:"collectionSettingsCreateExternalViewPicker.authenticateBody.title",[mh]:{[hh]:o.name}})),a()(Ia.Z,{onClick:()=>{c&&(es.hM({environment:d,[hh]:o,spaceId:c,from:vh}),ih.Z.reset())},[ch]:{[fh]:m,...p.settingsMenuAuthenticationButton},[lh]:{[fh]:g},pressedStyle:{[fh]:y}},void 0,a()(u.FormattedMessage,{[gh]:yh,id:"collectionSettingsCreateExternalViewPicker.authenticateButton.title",[mh]:{[hh]:o.name}})))))}var wh=o(68785),Ch=o(18647);const Ph=o(85).wuN,Th=o(85).Mm1,Ah=o(85).jkI,kh=o(85).UPJ,_h=o(85).EMU,Mh=o(85).sM5,xh=o(85).MQM,Zh=o(85).cZW,Ih=o(85).GGY,Dh=o(85).hd7,Fh=o(85).DIE,Vh=o(85).Joh,Bh=o(85).ESK,Eh=o(85).rpY,Kh=o(85).THS,Rh=o(85).Gpy,Nh=o(85).PXg,Oh=o(85).BQ6,Wh=o(85).PG2,Uh=o(85).iPt,Gh=o(85)._vc,Lh=o(85).Gm5,zh=o(85).lw5,Hh=o(85).Yzm,qh=o(85).Xl2,jh=o(85).GxH,Qh=o(85).P82,$h=(o(85).PWk,o(85).YGd),Xh=(o(85).kwg,o(85).OT),Yh=o(85).Zij,Jh=o(85).uzK,eS=o(85).ydX,tS=o(85).nx5,oS=o(85).FH8,iS=o(85).gnz,nS=o(85).tBn,aS=o(85).VUQ,rS=o(85).D7I,sS=o(85).TtP,lS=o(85).cbT,dS=o(85).oWD,cS=o(85).nuv,uS=o(85).P24,pS=o(85).HxR;function mS(e){window.__c={n:"CollectionSettingsCreateExternalViewPicker"};const{[pS]:t,[uS]:o,[cS]:i}=e,n=(0,P.VK)((()=>o[dS]()),[o]),a=(0,P.VK)((()=>{if(!n)return;const e=n.getFormat()[lS];return os.Z.integrations.state.find((t=>t.id===e))}),[n]),r=(0,P.VK)((()=>!!a&&(0,Qv.NP)(a.id)[sS]>0),[a]),d=(0,P.VK)((()=>{var e;return null===(e=qc.default.state.currentSpaceStore)||void 0===e?void 0:e.canEdit()}),[]);return n&&d&&a?l[rS](l[nS],null,r?l[rS](fS,s()({},e,{[uS]:o,[pS]:t,[aS]:a,[cS]:i})):l[rS](bh,s()({},e,{[uS]:o,[pS]:t,[aS]:a}))):null}const gS=e=>{var t,o;return null===(t=e[aS].info)||void 0===t||null===(o=t[iS])||void 0===o?void 0:o.filter((e=>{var t;return null===(t=e.additional_types)||void 0===t?void 0:t[oS]})).find((t=>{let{regex:o}=t;return new RegExp(o).test(e.url)}))},yS=(0,u.defineMessages)({all:{id:"collectionSettingsCreateExternalViewPicker.filters.all",[tS]:"All"},issues:{id:"collectionSettingsCreateExternalViewPicker.filters.issues",[tS]:"Issues"},pull_requests:{id:"collectionSettingsCreateExternalViewPicker.filters.pullRequests",[tS]:"Pull Requests"},board:{id:"collectionSettingsCreateExternalViewPicker.filters.boards",[tS]:"Boards"},project:{id:"collectionSettingsCreateExternalViewPicker.filters.projects",[tS]:"Projects"},Releases:{id:"collectionSettingsCreateExternalViewPicker.filters.releases",[tS]:"Releases"},"Pull Request":{id:"collectionSettingsCreateExternalViewPicker.filters.PullRequests",[tS]:"Pull Requests"},Issues:{id:"collectionSettingsCreateExternalViewPicker.filters.Issues",[tS]:"Issues"}});function fS(e){window.__c={n:"CollectionSettingsSourceSelection"};const{[aS]:t,[uS]:o,[pS]:i,[cS]:n}=e,[r,d]=(0,l.useState)(""),c=(0,P.VK)((()=>{const e=os.Z.state;return e.loaded?e[eS].filter((e=>e[lS]===t.id)):[]}),[t]),g=(0,P.VK)((()=>n||(c[sS]?c[0]:null)),[c,n]),[y,v]=(0,l.useState)(!1),[S,b]=(0,l.useState)(null),w=(0,T.yK)((e=>({settingsMenu:{[Mh]:_h,flexGrow:1,flexDirection:"column",padding:"8px"},settingsMenuSearchBox:{background:e.contentBackground,marginBottom:10},syncSourceButton:{width:"100%",[Mh]:_h,[kh]:Ah},noResults:{width:"100%",[Th]:10,[Mh]:_h,[kh]:Ah,fontSize:14,color:e[Ph]},suggestionBox:{[Mh]:_h,alignItems:Ah,fontSize:12,color:Wv.ZP.white,background:Wv.ZP.blue,borderRadius:6,padding:10,boxShadow:e.largeLightBoxShadow,alignSelf:Ah,maxWidth:"80%"},[xh]:{alignSelf:Ah,padding:10,fontSize:14,color:e.errorText},syncingData:{width:"100%",[Th]:10,[Mh]:_h,[kh]:Ah,fontSize:14,color:e[Ph]},filterContainer:{position:"relative",flexGrow:0,overflow:"hidden"},filterContainerScroller:{[Mh]:_h,alignItems:Ah,padding:"8px 12px"}})),[]),_=(0,P.VK)((()=>o[dS]()),[o]),M=(0,P.VK)((()=>o[Jh]()),[o]),x=(0,C.O7)(),[{value:Z,status:I}]=(0,Gv.r5)((async()=>{if(!g)return;const e=g.parent_id;return Hv.listExternalCollections(x,{bot_id:e})}),[x,g]),D="success"===(null==Z?void 0:Z.type)&&"data"in Z.data?Z.data.data:[],F="success"===(null==Z?void 0:Z.type)&&"error"in Z.data?Z.data.error:null,V=D.filter((e=>!S||e.type===S)),E=V[sS]?(0,Uv.ZP)(r,V,(e=>e[Yh])):[],K=Array.from(new Set(D.map((e=>e.type)))),R=gS({[aS]:t,url:r}),N=async e=>{if(v(!0),!_||!M)return;const n=e||r,s=gS({[aS]:t,url:n});if(!s)return v(!1),void tt.showDialog({items:[{label:a()(u.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.unsupportedUrlErrorDialog.copyDebuggingInformation",[tS]:Xh}),color:"blue",onAccept:()=>{qv.copyString({environment:x,stringValue:JSON.stringify({botId:null==g?void 0:g.parent_id,url:n},null,2),copiedMessage:qv.clipboardMessages.copiedToClipboard})}},{label:a()(u.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.unsupportedUrlErrorDialog.closeButton",[tS]:"Close"}),onAccept:()=>{}}],showCancel:!1,keepFocus:!1,message:a()(u.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.unsupportedUrlErrorDialog.title",[tS]:$h})});const l=(0,Qv.NP)(t.id);await jv.startUnfurlRequestForCollection({environment:x,url:n,botIds:l.map((e=>e.id)),[Qh]:_,[jh]:M});const{host:d}=(0,zv.parse)(n);p.trackSaveLinkPreview(x,{...(0,$v.getCollectionAnalyticsContext)(o),integrationId:t.id,type:oS,entity:s.name,domain:d||"",from:"external_picker_settings"}),m[qh]({[pS]:i,item:{type:"shareSyncedView",integrationName:t.name,integrationIcon:t.info.icon}}),v(!1)};if(!_||!M)return null;const O=K[sS]>1?a()("div",{[Oh]:w.filterContainer},void 0,a()(Ch.Z,{type:h.Z.X,[Oh]:w.filterContainerScroller,showLeftRightOverlay:!1},void 0,a()(cf.Z,{[Yh]:a()("span",{},void 0,Et.default[Hh](yS.all)),on:!(0,k.isNotNull)(S),hideChevron:!0,[Wh]:e=>{(0,f.ZP)({[zh]:e,[Lh]:f.Af[Gh],[Uh]:()=>{b(null)}})}},"all"),K.map((e=>a()(cf.Z,{[Yh]:a()("span",{},void 0,Et.default[Hh](yS[e])),on:S===e,hideChevron:!0,[Wh]:t=>{(0,f.ZP)({[zh]:t,[Lh]:f.Af[Gh],[Uh]:()=>{b((t=>t===e?null:e))}})}},e))))):null,W=R?a()("div",{[Oh]:w.syncSourceButton},void 0,a()(it.Z,{isLarge:!0,[Wh]:e=>{(0,f.ZP)({[zh]:e,[Lh]:f.Af[Gh],[Uh]:()=>{N()}})},disabled:!1},void 0,a()(u.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.syncSourceButton.label",[tS]:"Sync Source"}))):null,U=R||D[sS]&&E[sS]?null:l[rS](l[nS],null,a()("div",{[Oh]:w.noResults},void 0,a()(u.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.noResults.text",[tS]:"No results"})),a()("div",{[Oh]:w.suggestionBox},void 0,A.Z.info({[Nh]:8,width:14,height:14}),a()(u.FormattedMessage,{[tS]:"Try different search or paste any {integration} URL",id:"collectionSettingsCreateExternalViewPicker.noResults.help",[Rh]:{[aS]:t.name}}))),G=D[sS]&&E[sS]?l[rS](l[nS],null,a()(Wt.Z,{type:Wt.i.Vertical,initialFocus:0,sections:[{key:Kh,items:E.map((e=>({key:e.url,[Eh]:t=>a()(xn.Z,{[Vh]:()=>a()("span",{},void 0,e[Yh]),placement:xn.Z[Bh].Left,textWrap:!0,[Eh]:o=>l[rS](Nt.Z,s()({},(0,ts.Z)(o||{},t),{[Yh]:e[Yh],icon:a()("img",{[Oh]:{width:18},src:e.icon}),caption:e.parent[Yh]}))}),action:t=>{"stopPropagation"in t[zh]&&t[zh][Fh](),N(e.url)}}))),[Eh]:e=>l[rS](j.Z,s()({},e,{disableMobilePadding:!0}))}]})):null,L="pending"===I||"idle"===I||y;if(!g||F&&(F.status===Lv.mQ.UNAUTHORIZED||F.status===Lv.mQ.FORBIDDEN))return a()(bh,{[uS]:o,[pS]:i,[aS]:t});const z="rejected"===I||"failed"===(null==Z?void 0:Z.type)||F,H=a()(oh,{[Wh]:()=>{m[Dh]({[pS]:i,item:{type:Ih,[aS]:t,onAccountSelect:e=>{m[Dh]({[pS]:i,item:{type:"createSyncedViewSource",[cS]:e}})}}})},[aS]:t,accountName:g.account_name});return l[rS](B.ZP,s()({},e,{footer:W||y?null:H,[Yh]:a()(u.FormattedMessage,{[tS]:"Select from {integration}",id:"collectionSettingsCreateExternalViewPicker.title",[Rh]:{[aS]:t.name}}),header:!L&&"resolved"===I&&l[rS](l[nS],null,a()(Ot.ZP,{inputLeft:a()(Ot.f_,{icon:A.Z.search}),onSubmit:()=>{R&&N()},[Oh]:w.settingsMenuSearchBox,focusInitial:!0,value:r,onChange:e=>{d(e.target.value)},[Zh]:"Search source or paste a link..."}),R?null:O)}),a()("div",{[Oh]:w.settingsMenu},void 0,z&&a()("div",{[Oh]:w[xh]},void 0,a()(u.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.error.unknown",[tS]:"Something went wrong.",[Rh]:{[aS]:t.name}})),L&&(y?a()("div",{[Oh]:w.syncingData},void 0,a()("span",{},void 0,a()(u.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.settingUpSync",[tS]:"Setting up sync..."})),a()(wh.Z,{[Oh]:{alignSelf:"center"}})):a()("div",{[Oh]:w.syncingData},void 0,a()("span",{},void 0,a()(u.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.loadingData",[tS]:"Loading available sources..."})),a()(wh.Z,{[Oh]:{alignSelf:"center"}}))),!L&&"resolved"===I&&l[rS](l[nS],null,W,U,G)))}var vS=o(26263),hS=o(23482),SS=o(75081),bS=o(26122);const wS=o(85).tLG,CS=o(85).xOW,PS=o(85).fBv,TS=o(85).XNW,AS=o(85).nLZ,kS=o(85).g7N,_S=o(85).ChN,MS=o(85).OP1,xS=o(85).wuN,ZS=o(85).dMt,IS=o(85).IY7,DS=o(85).Exd,FS=o(85).BQ6,VS=o(85).jkI,BS=o(85).UPJ,ES=o(85).EMU,KS=o(85).sM5,RS=o(85).Mm1,NS=o(85)._V5,OS=o(85).GmX,WS=o(85).Scd,US=o(85).XCs,GS=o(85).YDv,LS=o(85).dLQ,zS=o(85).K0Z,HS=o(85).cZW,qS=o(85).pkR,jS=o(85).PXg,QS=o(85).X_m,$S=o(85).Jkr,XS=o(85).nx5,YS=o(85)._vc,JS=o(85).rMr,eb=o(85).HxR,tb=o(85).iTb,ob=o(85).uzK,ib=o(85).PG2,nb=o(85).BYF,ab=o(85).Rdx,rb=o(85).J$i,sb=o(85).qU4,lb=o(85).P24,db=o(85).oWD;function cb(e){window.__c={n:"CollectionSettingsCreateTypedDB"};const t=(0,T.Fg)(),o=(0,C.O7)(),i=o.device,[n,r]=(0,l.useState)("untyped"),[d,c]=(0,l.useState)(),p=(0,l.useMemo)((()=>ep.default.createValue("")),[]),g=(0,l.useMemo)((()=>new vS.Z({name:"CollectionSettingsCreateTypedDB"})),[]),v=(0,P.VK)((()=>{const t=e[lb][db]();if(t)return t.clone(g).getIcon()}),[e[lb],g]);(0,l.useEffect)((()=>{var t;void 0===d&&c(null===(t=e[lb][sb]())||void 0===t?void 0:t.getType())}),[e[lb],d]),(0,l.useEffect)((()=>{const e=o[ab][rb];return e.addCacheOverride(g),()=>{e[nb](g)}}),[o,g,e[lb]]);const h=(0,l.useCallback)((e=>{p.setState(e)}),[p]),S=(0,l.useCallback)(((t,i)=>{const{[lb]:n}=e,a=n[sb](),r=n[ob]();a&&r&&m.handleCreateCollection({environment:o,baseViewType:d,selectedDBType:i,collectionName:p.state,[lb]:n,[ob]:r,[sb]:a,[tb]:t,temporaryRecordCache:g})}),[e,d,o,p,g]);(0,l.useEffect)((()=>{S(!0,"untyped")}),[S]);const b=(0,l.useCallback)((t=>{const{[lb]:o}=e;r(t),S(!0,t),et.resetLeftScrollAfterFlush({[lb]:o})}),[e,S]);const w=(0,l.useCallback)((t=>{var i;const n=null===(i=e[lb][db]())||void 0===i?void 0:i.getIconStore().clone(g);n&&y.createAndCommit({userAction:"SpacePermissionGroup.handleIconChange",environment:o,perform:e=>{ot.setValue({store:n,value:t,transaction:e})}})}),[e[lb],o,g]),k=(0,l.useCallback)((t=>{(0,f.ZP)({event:t,context:f.Af[YS],callback:()=>{const{[eb]:t}=e;tt.showDialog({message:a()("span",{},void 0,a()(u.FormattedMessage,{[XS]:"Would you like to continue creating this database?",id:"collectionSettingsNewDatabase.confirmDialog.prompt"})),showCancel:!1,keepFocus:!1,items:[{label:a()(u.FormattedMessage,{[XS]:"Yes create {selectedType, select, untyped {an {type}} other {a {type}}} database",values:{selectedType:n,type:"untyped"===n?"empty":SS.kd[n]},id:"collectionSettingsNewDatabase.confirmDialog.affirmativeButton.label"}),color:"red",onAccept:()=>{S(!1,n),m[JS]({[eb]:t})}},{label:a()(u.FormattedMessage,{[XS]:"Cancel",id:"collectionSettingsNewDatabase.confirmDialog.cancel.label"}),color:"blue",onAccept:()=>{}}]})}})}),[e,n,S]),_=(0,l.useCallback)((()=>{o[ab][rb][nb](g);const{[lb]:t,[eb]:i}=e,n=t[ob](),a=t[sb]();void 0!==n&&void 0!==a&&(t.setContext({type:"collectionView",[ob]:n,[db]:void 0,[sb]:a}),m.navigateToItem({[eb]:i,item:{type:"createViewSource"}}))}),[o,e,g]);return l.createElement(B.ZP,s()({},e,{handleClose:k,title:a()(u.FormattedMessage,{[XS]:"New database",id:"database.viewSettings.createTypedDBTab.title"}),footer:a()(j.Z,{topBorder:!0},void 0,a()(E.Z,{icon:A.Z.contentSearch,isGray:!0,title:a()(u.FormattedMessage,{[XS]:"View an existing database",id:"database.viewSettings.createTypedDBTab.viewExistingDatabaseButton"}),[ib]:_}),a()(E.Z,{icon:A.Z.save,isGray:!0,title:a()(u.FormattedMessage,{[XS]:"Import or sync from",id:"database.viewSettings.createTypedDB.importDatabaseButton"})}))}),a()(j.Z,{},void 0,a()(bS.Z,{initialValue:"",[HS]:SS.kd[n],[zS]:p,onBlur:h,onSubmit:h,iconButton:{icon:e=>a()(nh.Z,{isEmptyPage:!0,[qS]:!0,defaultIcon:SS.by[n]({[$S]:16,[QS]:16,backfaceVisibility:void 0,[jS]:6}),icon:v,size:16}),onSubmit:w,includeEmojiTab:!0}})),a()("div",{[FS]:{...!i[LS]&&{[$S]:"100%",[GS]:8,[US]:8},...i[LS]&&{[WS]:t[OS],[$S]:"100%",[NS]:12,[RS]:12}}},void 0,a()("div",{[FS]:{[KS]:ES,flexFlow:"wrap",[BS]:VS}},void 0,hS.bY.map((function(e){return a()(ub,{dbType:e,isCurrentType:n===e,[ib]:()=>b(e)})}))),a()(it.Z,{[FS]:{[KS]:ES,margin:"14px",[QS]:32},[ib]:function(){const{[eb]:t}=e;S(!1,n),m[JS]({[eb]:t})}},void 0,a()(u.FormattedMessage,{[XS]:"Create database",id:"database.viewSettings.createTypedDB.createDatabase"}))))}function ub(e){window.__c={n:"CollectionSettingsTypedDBButton"};const{dbType:t,[ib]:o,isCurrentType:i}=e,n=(0,T.Fg)();return a()(K.Z,{[FS]:{[KS]:ES,[$S]:"95%",[QS]:45,flexGrow:0,flexShrink:0,[DS]:11,borderRadius:3,margin:6,padding:6,[IS]:`0 0 0 1px ${n[ZS]}`,color:n[xS],fill:n[xS],...i&&{[IS]:`0 0 0 2px ${n[MS]}`,color:n[MS],fill:n[MS],[_S]:500}},[qS]:i,[ib]:o},void 0,a()("div",{},void 0,SS.by[t]({...i&&{fill:n[MS],color:n[MS]},[$S]:17,[QS]:17,[kS]:4,[AS]:4,[TS]:4})),a()("div",{[FS]:{[PS]:CS,[$S]:"100%",[TS]:12}},void 0,a()("span",{[FS]:{[PS]:wS,[DS]:13,[_S]:500}},void 0,SS.kd[t]),a()("span",{[FS]:{[PS]:wS,top:15,[DS]:12,[AS]:1}},void 0,SS.dX[t])))}var pb=o(79362),mb=o(98421),gb=o(72711),yb=o(13709);const fb=o(85).EB9,vb=o(85).mSd,hb=o(85).nx5,Sb=o(85).yO8,bb=o(85).qdS,wb=o(85).J2Z,Cb=o(85).Uww,Pb=o(85).jQT,Tb=o(85).BpM,Ab=o(85).LCr,kb=o(85).pKK,_b=o(85).nXm,Mb=o(85).wgE,xb=o(85).Drs,Zb=o(85).JJj,Ib=o(85).qU4,Db=o(85).P24;class Fb extends d.Z{constructor(){super(...arguments),this.handleFirstLoadLimitChange=e=>{const{[Db]:t}=this.props,o=t[Ib]();o&&(y[Zb]({[xb]:"CollectionSettingsFirstLoadLimit.handleFirstLoadLimitChange",[Mb]:this[Mb],perform:t=>{g[_b]({stores:[o],update:{[kb]:e},[Ab]:t})}}),t[Tb].resetAllLimits(),Ye[Pb]({[Mb]:this[Mb],[Db]:t,action:"set_first_load_limit"}))}}renderComponent(){const{[Db]:e}=this.props,t=e[Cb].state,o=e.isFullScreen.state,i=this[wb]();if(!(t[bb]||!o&&"calendar"!==i))return;const n=this[Sb](),r=e.permissionScopes.state;return a()(yb.Z,{title:a()(u.FormattedMessage,{[hb]:"Load limit",id:"database.viewSettings.layoutTab.firstLoadLimitSetting"}),selectedKey:n,popupStyle:{minWidth:190},options:this.getFirstLoadLimitOptions(),onChange:this.handleFirstLoadLimitChange,disabled:!r[vb],icon:A.Z.arrowDown})}getFirstLoadLimitOptions(){return Vt.inlineCollectionFirstLoadLimitOptions.map((e=>({key:e,title:a()(u.FormattedMessage,{[hb]:"{limit} pages",values:{limit:e.limit},id:"database.viewSettings.layoutTab.limitPagesTitle"})})))}[wb](){var e;const{[Db]:t}=this.props,o=null===(e=t[Ib]())||void 0===e?void 0:e.getType();if(!o)throw new Error(fb);return o}[Sb](){const{[Db]:e}=this.props,t=e[Cb].state;return(0,Vt.getNormalizedInlineCollectionFirstLoadLimit)(t[kb],Boolean(t[bb]))}}Fb.displayName="CollectionSettingsFirstLoadLimit";const Vb=(0,u.injectIntl)(Fb);var Bb=o(35011),Eb=o(14714),Kb=o(49865),Rb=o(90833),Nb=o(33665),Ob=o(87052),Wb=o(75498),Ub=o(21269),Gb=o(79131),Lb=o(5145),zb=o(28992),Hb=o(19387);const qb=o(85).EB9,jb=o(85).PXg,Qb=o(85).xd5,$b=o(85).Mm1,Xb=o(85)._V5,Yb=o(85).Exd,Jb=o(85).OQK,ew=o(85).X_m,tw=o(85).wuN,ow=o(85).BQ6,iw=o(85).rps,nw=o(85).$bT,aw=o(85).jkI,rw=o(85).H1U,sw=o(85).EMU,lw=o(85).sM5,dw=o(85).YEw,cw=o(85).AEP,uw=o(85).TtP,pw=o(85).C_E,mw=o(85).gWL,gw=o(85).vK9,yw=o(85).pkR,fw=o(85).mSd,vw=o(85).hd7,hw=o(85).mYq,Sw=o(85).ddU,bw=o(85).HxR,ww=o(85).D7I,Cw=o(85).P3s,Pw=o(85).PG2,Tw=o(85).Zij,Aw=o(85).nx5,kw=o(85).Dg8,_w=o(85).Zf2,Mw=o(85).TNU,xw=o(85).qLW,Zw=o(85).gRm,Iw=o(85).zG9,Dw=o(85).VAS,Fw=o(85).voC,Vw=o(85).ykC,Bw=o(85).uzK,Ew=o(85).Kiu,Kw=o(85).qq3,Rw=o(85).Uww,Nw=o(85).EIp,Ow=o(85).VSr,Ww=o(85).ffk,Uw=o(85).wKP,Gw=o(85).AIR,Lw=o(85).Leq,zw=o(85).MWD,Hw=o(85).J2Z,qw=o(85).Ek1,jw=o(85).eiN,Qw=o(85).D4Z,$w=o(85).Wp_,Xw=o(85).X5t,Yw=o(85).jQT,Jw=o(85).e7B,eC=o(85).Gnd,tC=o(85).nXm,oC=o(85).LCr,iC=o(85).uLY,nC=o(85).nAm,aC=o(85).nxU,rC=o(85).wgE,sC=o(85).Drs,lC=o(85).JJj,dC=o(85).SkS,cC=o(85).qU4,uC=o(85).I2,pC=o(85).n8c,mC=o(85).QmD,gC=o(85).gPr,yC=o(85).P0R,fC=o(85).$KA,vC=o(85).P24,hC=o(85).Y0b,SC=o(85).wfR,bC=o(85).gNE;class wC extends d.Z{constructor(){super(...arguments),this.storeTypes={[bC]:ep.default[SC](void 0),[hC]:ep.default[SC](Rb.XD)},this.handleHideEmptyGroupsClick=()=>{const{groupByKey:e,[vC]:t,[fC]:o}=this[yC],i=this[gC](),n=this[pC][mC];if(!n)return;const{[uC]:a}=n,r=t[cC]();if(!i||!r)return;const s=!i[dC];y[lC]({[sC]:"CollectionSettingsViewGroup.handleHideEmptyGroupsClick",[rC]:this[rC],[aC]:n=>{if(s){const e=a.map((e=>!1===e[nC]?{...e,[nC]:void 0}:e));Kb.updateGroups({[vC]:t,[iC]:e,[fC]:o,[oC]:n})}g[tC]({[eC]:[r],[Jw]:{[e]:{...i,[dC]:s}},[oC]:n})}}),Ye[Yw]({[rC]:this[rC],[vC]:t,[Xw]:"toggle_hide_empty_groups"})},this.handleHideAllClick=()=>{const{[vC]:e,[fC]:t}=this[yC],o=this[pC][mC];if(!o)return;const{[uC]:i}=o,n=i.map((e=>({...e,[nC]:!0})));this[eC][hC][$w](Rb.XD),y[lC]({[sC]:"CollectionSettingsViewGroup.handleHideAllClick",[rC]:this[rC],[aC]:o=>{Kb.updateGroups({[vC]:e,[iC]:n,[fC]:t,[oC]:o})}}),Ye[Yw]({[rC]:this[rC],[vC]:e,[Xw]:"click_groups_hide_all"})},this.handleShowAllClick=()=>{const{[vC]:e,[fC]:t}=this[yC],o=this[pC][mC];if(!o)return;const{[uC]:i}=o,n=i.map((e=>({...e,[nC]:!1})));this[eC][hC][$w](Rb.XD),y[lC]({[sC]:"CollectionSettingsViewGroup.handleShowAllClick",[rC]:this[rC],[aC]:o=>{Kb.updateGroups({[vC]:e,[iC]:n,[fC]:t,[oC]:o})}}),Ye[Yw]({[rC]:this[rC],[vC]:e,[Xw]:"click_groups_show_all"})},this[Qw]=(e,t)=>{const{[vC]:o,[fC]:i}=this[yC],n=this[pC][mC];if(!n)return;const{[uC]:a}=n,r=a[jw]((t=>e[qw]((0,Eb.mD)(t))<0)),s=a[jw]((t=>e[qw]((0,Eb.mD)(t))>=0)),l=se().sortBy(s,(t=>{const o=e[qw]((0,Eb.mD)(t));return o>=0?o:1/0})),d=t?[...r,...l]:[...l,...r];y[lC]({[sC]:"CollectionSettingsViewGroup.handleGroupReorder",[rC]:this[rC],[aC]:e=>{Kb.updateGroups({[vC]:o,[iC]:d,[fC]:i,[oC]:e})}}),p[Yw](this[rC],{view_type:this[Hw](),[Xw]:t?"reorder_hidden_groups":"reorder_groups"})},this.handleToggleGroupVisibility=e=>{const{[vC]:t,[fC]:o}=this[yC],i=this[pC][mC];if(!i)return;const{[uC]:n}=i,a=n.map((t=>(0,Eb.ZH)(t,e)?{...e,[nC]:!(0,Eb.eF)(e)}:t));y[lC]({[sC]:"CollectionSettingsViewGroup.handleToggleGroupVisibility",[rC]:this[rC],[aC]:e=>{Kb.updateGroups({[vC]:t,[iC]:a,[fC]:o,[oC]:e})}}),Ye[Yw]({[rC]:this[rC],[vC]:t,[Xw]:"toggle_group_visibility"})},this.handleSortTypeChange=e=>{const{[vC]:t,groupByKey:o}=this[yC],i=this[gC](),n=t[cC]();if(i&&n){if("formula"===i[zw]){const t={...i,[Lw]:{...i[Lw],sort:{[zw]:e}}};y[lC]({[sC]:Gw,[rC]:this[rC],[aC]:e=>{g[tC]({[eC]:[n],[Jw]:{[o]:t},[oC]:e})}})}else y[lC]({[sC]:Gw,[rC]:this[rC],[aC]:t=>{g[tC]({[eC]:[n],[Jw]:{[o]:{...i,sort:{[zw]:e}}},[oC]:t})}});Ye[Yw]({[rC]:this[rC],[vC]:t,[Xw]:"update_group_sort"})}},this.handleTextGroupByTypeChange=e=>{const{[vC]:t,groupByKey:o,[fC]:i}=this[yC],n=this[gC](),a=t[cC]();if(!n||!a)return;const r=MC(n);if(r){if((0,Eb.aB)(n))y[lC]({[sC]:Uw,[rC]:this[rC],[aC]:t=>{g[tC]({[eC]:[a],[Jw]:{[o]:{...n,[Lw]:e},[i]:void 0},[oC]:t})}});else if("formula"===n[zw]){const t={...se().omit(r,Ww),[Lw]:e},s={...n,[Lw]:t};y[lC]({[sC]:Uw,[rC]:this[rC],[aC]:e=>{g[tC]({[eC]:[a],[Jw]:{[o]:s,[i]:void 0},[oC]:e})}})}Ye[Yw]({[rC]:this[rC],[vC]:t,[Xw]:"update_text_group_by"})}},this.handleDateGroupByTypeChange=e=>{const{[vC]:t,groupByKey:o,[fC]:i}=this[yC],n=this[gC](),a=t[cC]();if(!n||!a)return;const r=_C(n);if(r){if((0,Eb.ib)(n))y[lC]({[sC]:Ow,[rC]:this[rC],[aC]:t=>{g[tC]({[eC]:[a],[Jw]:{[o]:{...n,[Lw]:e},[i]:void 0},[oC]:t})}});else if("formula"===n[zw]){const t={...se().omit(r,Ww),[zw]:"date",[Lw]:e},s={...n,[Lw]:t};y[lC]({[sC]:Ow,[rC]:this[rC],[aC]:e=>{g[tC]({[eC]:[a],[Jw]:{[o]:s,[i]:void 0},[oC]:e})}})}Ye[Yw]({[rC]:this[rC],[vC]:t,[Xw]:"update_date_group_by"})}},this.handleStatusGroupByTypeChange=e=>{const{[vC]:t,groupByKey:o,[fC]:i}=this[yC],n=this[gC](),a=t[cC]();n&&a&&"status"===(null==n?void 0:n[zw])&&(y[lC]({[sC]:"CollectionSettingsViewGroup.handleStatusGroupByTypeChange",[rC]:this[rC],[aC]:t=>{g[tC]({[eC]:[a],[Jw]:{[o]:{...n,[Lw]:e},[i]:void 0},[oC]:t})}}),Ye[Yw]({[rC]:this[rC],[vC]:t,[Xw]:"update_status_group_by"}))},this.handleRemoveClick=()=>{const{[vC]:e,groupByKey:t,[fC]:o}=this[yC],i=e[cC]();i&&(y[lC]({[sC]:"CollectionSettingsViewGroup.handleRemoveClick",[rC]:this[rC],[aC]:e=>{g[tC]({[eC]:[i],[Jw]:{[t]:void 0,[o]:void 0},[oC]:e})}}),Ye[Yw]({[rC]:this[rC],[vC]:e,[Xw]:"click_remove_grouping"}))},this.reducerStore=this[Nw]((()=>{const{[vC]:e,[fC]:t}=this[yC],o=e[Rw][mC],i=e[Kw][mC],n=e.remoteRequestStore[mC],a=this[gC]();if(a)return(0,Rb.ej)({[Lw]:a,[Ew]:i,format:o,[jw]:null==n?void 0:n.loader[jw],[fC]:t,limit:this[eC][hC][mC]})})),this.schemaGroupsStore=this[Nw]((()=>{const{[vC]:e}=this[yC],t=e[Kw][mC],o=this[gC]();if(o)return(0,Eb.Qq)({[Ew]:t,[Lw]:o})}),!0),this[pC]=this[Nw]((()=>{var e;const{[fC]:t,[vC]:o}=this[yC],i=o[Rw][mC],n=o[Kw][mC],a=o[Bw](),r=this[gC](),s=this[eC][bC][mC];if(!r||!a||!s)return;const l=this[eC][hC][mC],d=this.schemaGroupsStore[mC],c=s.results,u=s?s.total:0,p=(0,Rb.Cz)({[Lw]:r,[Ew]:n,formatGroups:i[t]||[],schemaGroups:d,[Vw]:c,[Fw]:a[Fw],[Dw]:o[Iw][mC],viewAppConfigUri:null===(e=o[cC]())||void 0===e?void 0:e[xw]()[Zw]}),m=p[jw]((e=>!(0,Eb.eF)(e))).slice(0,l),g=p[jw]((e=>(0,Eb.eF)(e)));return{[uC]:[...m,...g],[Mw]:m,[_w]:g,total:u}}),!0)}renderComponent(){const{[vC]:e,groupByKey:t}=this[yC],o=this[gC](),i=e[Kw][mC];return l[ww](B.ZP,s()({},this[yC],{[Tw]:this[kw]()}),a()(j.Z,{},void 0,this.renderPropertyMenuButton(o),o&&AC({[Lw]:o,[Ew]:i})&&this.renderTypeMenuButton(o),o&&this.renderSortMenuButton(o),o&&this.renderAutoHideButton(o),o&&"board_columns_by"===t&&this.renderColorColumnsOption()),o&&this.renderGroupSortListReducer(),a()(j.Z,{topBorder:!0},void 0,o&&this.canRemoveGrouping()&&a()(E.Z,{isGray:!0,icon:A.Z.trash,[Tw]:a()(u.FormattedMessage,{[Aw]:"Remove grouping",id:"database.viewSettings.groupTab.removeButton.title"}),[Pw]:this.handleRemoveClick,isRed:!0}),a()(Ub.Z,{href:(0,Nb.getLocalizedUrl)("guides.databaseGroup"),[Tw]:a()(u.FormattedMessage,{[Aw]:"Learn about grouping",id:"database.viewSettings.groupTab.learnMoreButton.title"}),[Cw]:"view_settings_group"})))}[kw](){const{[bw]:e}=this[yC],t=(0,S.n)(e);if(t&&"group"===t[zw])return"collection_group_by"===t.groupByKey&&"board"===this[Hw]()?a()(u.FormattedMessage,{[Aw]:"Sub-group",id:"database.viewSettings.groupTab.subGroup.title"}):a()(u.FormattedMessage,{[Aw]:"Group",id:"database.viewSettings.groupTab.group.title"})}renderPropertyMenuButton(e){const{[vC]:t,[bw]:o,groupByKey:i,[fC]:n}=this[yC],r=t[Kw][mC],s=e?r[e[Ww]]:void 0;return a()(E.Z,{[Tw]:PC(i,this[Hw]()),showChevron:!0,right:CC(s),[Pw]:()=>{Ye[Yw]({[rC]:this[rC],[vC]:t,[Xw]:"click_group_by_property",[Sw]:void 0,[hw]:null==s?void 0:s[zw]}),m[vw]({[bw]:o,item:{[zw]:"groupByProperty",groupByKey:i,[fC]:n}})},[yw]:!this[fw]()})}renderTypeMenuButton(e){const{[vC]:t,[bw]:o,groupByKey:i,[fC]:n}=this[yC],r=t[Kw][mC],s=this[fw](),l="formula"===e[zw]?{...e[Lw],[Ww]:e[Ww]}:e;if((0,Eb.ib)(l))return a()(yb.Z,{[Tw]:kC({[Lw]:l,[Ew]:r}),popupStyle:{[gw]:190},[mw]:l[Lw],options:Eb.z8.map((e=>({key:e,[Tw]:DC(e)}))),onChange:this.handleDateGroupByTypeChange,[yw]:!s});if((0,Eb.aB)(l))return a()(yb.Z,{[Tw]:kC({[Lw]:l,[Ew]:r}),popupStyle:{[gw]:190},[mw]:l[Lw],options:Eb.Kp.map((e=>({key:e,[Tw]:FC(e)}))),onChange:this.handleTextGroupByTypeChange,[yw]:!s});if("number"===l[zw])return a()(E.Z,{[Tw]:kC({[Lw]:l,[Ew]:r}),showChevron:!0,right:ZC({[Lw]:l,[Ew]:r}),[Pw]:()=>{m[vw]({[bw]:o,item:{[zw]:"groupByNumber",groupByKey:i,[fC]:n}})},[yw]:!s});if("status"===l[zw]){const e="collectionTypedView"===t.contextType?["group"]:Eb.vu;return a()(yb.Z,{[Tw]:kC({[Lw]:l,[Ew]:r}),popupStyle:{[gw]:190},[mw]:l[Lw],options:e.map((e=>({key:e,[Tw]:IC(e)}))),onChange:this.handleStatusGroupByTypeChange,[yw]:!s})}}renderSortMenuButton(e){const t=(0,Eb.YG)(e,!Ls.default.checkGate(pw));if(t[uw]<=1)return;const o=(0,Eb.mu)(e);return a()(yb.Z,{[Tw]:a()(u.FormattedMessage,{[Aw]:"Sort",id:"database.viewSettings.groupTab.sort"}),popupStyle:{[gw]:190},[mw]:o[zw],options:t.map((t=>({key:t,[Tw]:TC(e,t)}))),onChange:this.handleSortTypeChange,[yw]:!this[fw]()})}renderAutoHideButton(e){return a()(nt.Z,{[Tw]:a()(u.FormattedMessage,{[Aw]:"Hide empty groups",id:"database.viewSettings.groupTab.hideEmptyGroups"}),on:Boolean(e[dC]),focused:!1,[Pw]:this.handleHideEmptyGroupsClick,[yw]:!this[fw](),textWrapperStyle:{[cw]:1}})}renderColorColumnsOption(){return a()(nt.Z,{[Tw]:a()(u.FormattedMessage,{[Aw]:"Color columns",id:"database.viewSettings.groupTab.colorColumns"}),on:!this.getDisableBoardColorColumns(),focused:!1,[Pw]:()=>{m.handleBoardGroupColorColumnsClick({[rC]:this[rC],[vC]:this[yC][vC]})},[yw]:!this[fw](),textWrapperStyle:{[cw]:1}})}renderGroupSortListReducer(){const{[fC]:e}=this[yC],t=this.reducerStore[mC],o=this[pC][mC];return t?a()(Wb.Z,{id:`group_menu_${e}`,reducer:t,[vC]:this[yC][vC],resultStore:this[eC][bC],render:()=>this[dw](o)}):this[dw](o)}[dw](e){const t=this[gC]();if(!t)return;if(!e)return a()(j.Z,{topBorder:!0,disableMobileBorders:!0,noTextOverflow:!0},void 0,a()("div",{[ow]:{marginTop:6,[lw]:sw,[rw]:aw,[nw]:iw}},void 0,a()(wh.Z,{})));const o="manual"===(0,Eb.mu)(t)[zw]&&!this[rC].device.isMobile&&this[fw](),i=this[eC][hC][mC],{total:n,[_w]:r,[Mw]:s}=e,d=Math.min(Rb.kW,n-r[uw]-s[uw]),c=d>0?a()(Nt.Z,{[yw]:!1,focused:!1,[ow]:{color:this.theme[tw]},icon:A.Z.dots({width:14,[ew]:14}),[Tw]:a()(u.FormattedMessage,{id:"database.groupMenu.loadMoreButton.text",[Aw]:Jb,values:{loadMoreAmount:d}}),[Pw]:()=>{this[yC][vC].loadingDetails[$w]({[zw]:"load_groups_menu"}),this[eC][hC][$w](i+Rb.kW)}}):void 0;return l[ww](l.Fragment,null,e[Mw][uw]>0&&a()(j.Z,{topBorder:!0,noTextOverflow:!0,isTitleUppercase:!1,[Tw]:a()("span",{[ow]:{alignSelf:"center"}},void 0,a()(u.FormattedMessage,{id:"database.groupMenu.visibleGroups",[Aw]:"Visible groups"})),right:a()(Ia.Z,{isSmall:!0,shouldShrink:!0,isBlue:!0,[ow]:{[Yb]:12,[ew]:void 0,[Xb]:2,[$b]:2},[Pw]:this.handleHideAllClick,[yw]:!this[fw]()},void 0,a()(u.FormattedMessage,{id:"database.groupMenu.hideAllGroups",[Aw]:"Hide all"}))},void 0,this.renderGroupSortList({displayState:e,groups:e[Mw],canReorder:o,isHidden:!1}),c),e[_w][uw]>0&&a()(j.Z,{topBorder:!1,noTextOverflow:!0,isTitleUppercase:!1,[Tw]:a()(u.FormattedMessage,{id:"database.groupMenu.hiddenGroups",[Aw]:"Hidden groups"}),right:a()(Ia.Z,{isSmall:!0,shouldShrink:!0,isBlue:!0,[ow]:{[Yb]:12,[ew]:void 0,[Xb]:2,[$b]:2},[Pw]:this.handleShowAllClick,[yw]:!this[fw]()},void 0,a()(u.FormattedMessage,{id:"database.groupMenu.showAllGroups",[Aw]:"Show all"}))},void 0,this.renderGroupSortList({displayState:e,groups:e[_w],canReorder:o,isHidden:!0})))}renderGroupSortList(e){const{displayState:t,groups:o,canReorder:i,isHidden:n}=e;return i?a()(Gb.ZP,{direction:"vertical",keys:o.map((e=>(0,Eb.mD)(e))),renderKey:(e,n)=>{const a=o[n];return this.renderGroupSortListItem({displayState:t,[Qb]:a,canReorder:i})},onDrop:e=>{this[Qw](e,n)},[yw]:!this[fw]()}):o.map((e=>a()(l.Fragment,{},(0,Eb.mD)(e),this.renderGroupSortListItem({displayState:t,[Qb]:e,canReorder:i}))))}renderGroupSortListItem(e){const{[vC]:t}=this[yC],{displayState:o,[Qb]:i,canReorder:n}=e,r=t[Kw][mC],s=(0,Eb.eF)(i),l=this[gC]();if(l)return a()(zb.Z,{[yw]:!this[fw](),[Tw]:a()("div",{[ow]:{[lw]:sw,[rw]:aw}},void 0,n&&a()(Lb.ZP,{iconSize:12,[ow]:{[jb]:3}}),a()(Ob.Z,{[Lw]:l,[Qb]:i,[uC]:o[uC],[Ew]:r,[yw]:!0,isHiddenGroup:!1,[ow]:{padding:0},[vC]:t})),right:a()(iu.Z,{icon:s?A.Z.eyeHide:A.Z.eye,iconStyle:{width:16,[ew]:16},isDarkIconColor:!s,[Pw]:()=>{this.handleToggleGroupVisibility(i)},[yw]:!this[fw]()}),textWrapperStyle:{[cw]:1}})}[Hw](){var e;const{[vC]:t}=this[yC],o=null===(e=t[cC]())||void 0===e?void 0:e.getType();if(!o)throw new Error(qb);return o}[gC](){const{[vC]:e,groupByKey:t}=this[yC];return e[Rw][mC][t]}canRemoveGrouping(){return this[fw]()&&(0,Rb._1)({viewType:this[Hw](),groupByKey:this[yC].groupByKey})}[fw](){const{[vC]:e}=this[yC];return e.permissionScopes[mC][fw]}getDisableBoardColorColumns(){return(0,Rb.h6)(this[rC],this[yC][vC])}}function CC(e){return e?a()(Hb.Z,{propertySchema:e,showIcon:!1}):a()(u.FormattedMessage,{[Aw]:"None",id:"database.viewSettings.groupTab.noGroupingSetMessage"})}function PC(e,t){return a()(u.FormattedMessage,"collection_group_by"===e&&"board"===t?{[Aw]:"Sub-group by",id:"database.viewSettings.groupTab.subGroupProperty"}:{[Aw]:"Group by",id:"database.viewSettings.groupTab.groupProperty"})}function TC(e,t){return"manual"===t?a()(u.FormattedMessage,{[Aw]:"Manual",id:"database.viewSettings.groupTab.sortType.manual"}):"ascending"===t?(0,Eb.ib)(e)||"formula"===e[zw]&&"date"===e[Lw][zw]?a()(u.FormattedMessage,{[Aw]:"Oldest first",id:"database.viewSettings.groupTab.sortType.chronological"}):(0,Eb.aB)(e)||"relation"===e[zw]||"select"===e[zw]||"multi_select"===e[zw]||"formula"===e[zw]&&"text"===e[Lw][zw]?a()(u.FormattedMessage,{[Aw]:"Alphabetical",id:"database.viewSettings.groupTab.sortType.alphabetical"}):a()(u.FormattedMessage,{[Aw]:"Ascending",id:"database.viewSettings.groupTab.sortType.ascending"}):"descending"===t?(0,Eb.ib)(e)||"formula"===e[zw]&&"date"===e[Lw][zw]?a()(u.FormattedMessage,{[Aw]:"Newest first",id:"database.viewSettings.groupTab.sortType.reverseChronological"}):(0,Eb.aB)(e)||"relation"===e[zw]||"select"===e[zw]||"multi_select"===e[zw]||"formula"===e[zw]&&"text"===e[Lw][zw]?a()(u.FormattedMessage,{[Aw]:"Reverse alphabetical",id:"database.viewSettings.groupTab.sortType.reverseAlphabetical"}):a()(u.FormattedMessage,{[Aw]:"Descending",id:"database.viewSettings.groupTab.sortType.descending"}):void(0,k.unreachable)(t)}function AC(e){const{[Lw]:t,[Ew]:o}=e,i=o[t[Ww]];if(!i||!(0,Eb.LG)(i))return;let n;if("formula"===i[zw]){const e=(0,Bb.mm)(i);if("unknown"===e||"array"===e)return;n="block"===e?"relation":e}else n=i[zw];return(0,Eb.A1)(n)||(0,Eb.HB)(n)||"number"===n||"status"===n?n:void 0}function kC(e){const t=AC(e);if(t)return(0,Eb.A1)(t)?a()(u.FormattedMessage,{[Aw]:"Date by",id:"database.viewSettings.groupByTypeTab.dateBy"}):(0,Eb.HB)(t)?a()(u.FormattedMessage,{[Aw]:"Text by",id:"database.viewSettings.groupByTypeTab.textBy"}):"number"===t?a()(u.FormattedMessage,{[Aw]:"Number by",id:"database.viewSettings.groupByTypeTab.numberBy"}):"status"===t?a()(u.FormattedMessage,{[Aw]:"Status by",id:"database.viewSettings.groupByTypeTab.statusBy"}):void 0}function _C(e){return(0,Eb.ib)(e)?e:"formula"===e[zw]&&"date"===e[Lw][zw]?e[Lw]:void 0}function MC(e){return(0,Eb.aB)(e)?e:"formula"===e[zw]&&"text"===e[Lw][zw]?e[Lw]:void 0}function xC(e){return"number"===e[zw]?e:"formula"===e[zw]&&"number"===e[Lw][zw]?{...e[Lw],[Ww]:e[Ww]}:void 0}function ZC(e){const{[Lw]:t}=e,o=AC(e);if(o)if((0,Eb.A1)(o)){const e=_C(t);if(e)return DC(e[Lw])}else if((0,Eb.HB)(o)){const e=MC(t);if(e)return FC(e[Lw])}else if("number"===o){const e=xC(t);if(e)return a()(u.FormattedMessage,{[Aw]:"{start} to {end}",id:"database.groupMenu.numberGroupBy.range",values:{start:e.start,end:e.end}})}}function IC(e){return"group"===e?a()(u.FormattedMessage,{[Aw]:"Group",id:"database.groupMenu.statusGroupBy.group"}):"option"===e?a()(u.FormattedMessage,{[Aw]:"Option",id:"database.groupMenu.statusGroupBy.option"}):void(0,k.unreachable)(e)}function DC(e){return"relative"===e?a()(u.FormattedMessage,{[Aw]:"Relative",id:"database.groupMenu.dateGroupBy.relative"}):"day"===e?a()(u.FormattedMessage,{[Aw]:"Day",id:"database.groupMenu.dateGroupBy.day"}):"week"===e?a()(u.FormattedMessage,{[Aw]:"Week",id:"database.groupMenu.dateGroupBy.week"}):"month"===e?a()(u.FormattedMessage,{[Aw]:"Month",id:"database.groupMenu.dateGroupBy.month"}):"year"===e?a()(u.FormattedMessage,{[Aw]:"Year",id:"database.groupMenu.dateGroupBy.year"}):void(0,k.unreachable)(e)}function FC(e){return"exact"===e?a()(u.FormattedMessage,{[Aw]:"Exact",id:"database.groupMenu.textGroupBy.exact"}):"alphabet_prefix"===e?a()(u.FormattedMessage,{[Aw]:"Alphabetical",id:"database.groupMenu.textGroupBy.alphabetical"}):void(0,k.unreachable)(e)}wC.displayName="CollectionSettingsViewGroup";const VC=(0,u.injectIntl)(wC);var BC=o(1136);const EC=o(85).Ls_,KC=o(85).bep,RC=o(85).XNW,NC=o(85).OtN,OC=o(85).nx5,WC=o(85).OM8,UC=o(85)._Fe;function GC(e){window.__c={n:"ContentOnlyEditorEducationPill"};const{style:t}=e,o=(0,T.Fg)(),i=(0,C.MO)(),n=a()("div",{style:{marginTop:1}},void 0,A.Z.locked({width:14,marginRight:8,height:void 0})),r=a()(Q.Z,{style:{color:o[UC],[WC]:_.Z[WC].UISmall.desktop},isSmall:!0},void 0,a()(u.FormattedMessage,{[OC]:"You're a content editor",id:"database.viewSettings.mainTab.contentOnlyEditorPill.title"}));return a()(q,{icon:n,title:r,style:i?{[NC]:o.sidebarBackground,boxShadow:o.plainButtonBoxShadow,margin:void 0,borderRadius:void 0,...t}:{background:"rgba(196, 196, 196, 0.13)",margin:"8px 14px",...t},showCloseButton:!1},void 0,a()(Q.Z,{style:{[RC]:22},isSmall:!0,isMultiline:!0},void 0,a()(u.FormattedMessage,{[OC]:KC,id:EC})))}var LC=o(74420),zC=o(76798),HC=o(32662);const qC=o(85).EB9,jC=o(85).QBU,QC=o(85).vwl,$C=o(85).EiQ,XC=o(85).v1$,YC=o(85).AIq,JC=o(85).QQK,eP=o(85).rMr,tP=o(85).jtM,oP=o(85).apZ,iP=o(85).ImZ,nP=o(85).$Zu,aP=o(85).KCN,rP=o(85).gYY,sP=o(85).SDR,lP=o(85)._fd,dP=o(85).Uh4,cP=o(85).Biv,uP=o(85).Kvi,pP=o(85).Uie,mP=(o(85).tXr,o(85).jkI),gP=o(85).H1U,yP=o(85).rOg,fP=o(85).sM5,vP=o(85).aKz,hP=o(85).gz1,SP=o(85).unR,bP=o(85).hd7,wP=o(85).Wp_,CP=o(85).mYq,PP=o(85).ffk,TP=o(85).Uww,AP=o(85).qq3,kP=o(85).H1J,_P=o(85).qdS,MP=o(85).$KA,xP=o(85).J2Z,ZP=o(85).c1l,IP=o(85).PG2,DP=o(85).Er,FP=o(85).Zvr,VP=o(85).MvG,BP=o(85).tBn,EP=o(85).rJs,KP=o(85).sG$,RP=o(85).D7I,NP=o(85).Zij,OP=o(85).pkR,WP=o(85).BQ6,UP=o(85).PXg,GP=o(85).kUY,LP=o(85).mSd,zP=o(85).Yzm,HP=o(85).dLQ,qP=o(85).lzz,jP=o(85).rQ1,QP=o(85).QmD,$P=o(85).DCw,XP=o(85).k9$,YP=o(85).oWD,JP=o(85).EIp,eT=o(85).Wo8,tT=o(85).BQW,oT=o(85).NZz,iT=o(85).HxR,nT=o(85).uzK,aT=o(85).QSf,rT=o(85).ddU,sT=o(85).X5t,lT=o(85).jQT,dT=o(85).LCr,cT=o(85).E3P,uT=o(85).nxU,pT=o(85).wgE,mT=o(85).Drs,gT=o(85).JJj,yT=o(85).G3i,fT=o(85).qU4,vT=o(85).P0R,hT=o(85).P24,ST=o(85).SNI,bT=o(85).nx5,wT=(0,u.defineMessages)({viewNamePlaceholderMessage:{[bT]:"View name",id:"database.viewSettings.mainTab.viewNamePlaceholder.title"}});class CT extends d.Z{constructor(){super(...arguments),this[ST]=e=>{const{[hT]:t}=this[vT],o=t[fT]();o&&o[yT]()&&(o.getName()!==e&&y[gT]({[mT]:"CollectionSettingsViewMain.handleViewNameSubmit",[pT]:this[pT],[uT]:t=>{et[cT]({[fT]:o,update:{name:e},[dT]:t})}}),Ye[lT]({[pT]:this[pT],[hT]:t,[sT]:"rename",[rT]:o[aT]()}))},this.handleViewIconSubmit=e=>{const{[hT]:t}=this[vT],o=t[fT]();o&&o[yT]()&&(y[gT]({[mT]:"CollectionSettingsViewMain.handleViewIconSubmit",[pT]:this[pT],[uT]:t=>{et.updateCollectionViewIcon({[nT]:o,icon:e,[dT]:t})}}),Ye[lT]({[pT]:this[pT],[hT]:t,[sT]:"change_icon",icon:e}))},this.handleDuplicateClick=()=>{const{[hT]:e,[iT]:t,intl:o}=this[vT],i=e[fT]();i&&(m.handleDuplicateCollectionView({[pT]:this[pT],[hT]:e,[fT]:i,[iT]:t,intl:o}),Ye[lT]({[pT]:this[pT],[hT]:e,[sT]:"click_duplicate",[rT]:i[aT]()}))},this.handleCopyLinkClick=()=>{const{[hT]:e}=this[vT],t=e[fT]();t&&(m.handleCopyLinkToCollectionView({[pT]:this[pT],[hT]:e,[fT]:t}),Ye[lT]({[pT]:this[pT],[hT]:e,[sT]:"click_copy_link",[rT]:t[aT]()}))},this[oT]=()=>{const{[hT]:e,[iT]:t}=this[vT],o=e[fT]();o&&(m.handleDeleteCollectionView({[pT]:this[pT],[hT]:e,[fT]:o,[iT]:t,from:tT}),Ye[lT]({[pT]:this[pT],[hT]:e,[sT]:"click_delete",[rT]:o[aT]()}))},this.handleToggleLockClick=()=>{const{[hT]:e}=this[vT],t=e[nT]();t&&(gb.bo({[pT]:this[pT],store:t,lock:!t[eT]()}),Ye[lT]({[pT]:this[pT],[hT]:e,[sT]:"click_toggle_lock"}))},this.shouldRenderDatabaseTypeStore=this[JP]((()=>{const{[hT]:e}=this[vT],t=e[YP](),o=e[nT](),i=e[fT]();if(!t||!o||!i)return!1;if(t[XP]())return!1;return void 0!==o[$P]()})),this.shouldRenderSourceStore=this[JP]((()=>{const{[hT]:e}=this[vT],t=e[YP](),o=e[nT](),i=e[fT]();if(!t||!o||!i)return!1;if(t[XP]())return!0;return void 0===o[$P]()}))}renderComponent(){const{device:e}=this[pT],{[hT]:t,selectViewNameInitial:o}=this[vT],i=t[fT](),n=t[nT]();if(!i||!n)return;if(!i[yT]())return;const r=t[jP][QP],d=(0,xa.rm)()&&this.renderType(),c=i.getFormat()[qP],p=i[aT](),m=i.getAppConfigUri(),g=!(0,k.isDefined)(m)||!(0,xa.xB)(m),y=a()(j.Z,{[NP]:e[HP]&&a()(u.FormattedMessage,{[bT]:"View name",id:"database.viewSettings.mainTab.viewNameSection.title"})},void 0,a()(bS.Z,{initialValue:i.getName()||"",placeholder:Et.default[zP](wT.viewNamePlaceholderMessage),onBlur:this[ST],onSubmit:this[ST],focusInitial:o,selectAll:o,[OP]:!r[LP]||!g,iconButton:{icon:e=>a()(BC.F,{color:GP,viewIcon:c,viewType:p,[WP]:{[UP]:6}}),iconStyle:{fill:pb.IconColorVariationsMap[this.theme.mode][GP]},enforceIconColor:GP,onSubmit:this.handleViewIconSubmit}}));return"page"===i[aT]()?l[RP](B.ZP,s()({},this[vT],{[NP]:a()(u.FormattedMessage,{[bT]:"View options",id:"database.viewSettings.mainTab.title"})}),y):l[RP](B.ZP,s()({},this[vT],{[NP]:a()(u.FormattedMessage,{[bT]:"View options",id:"database.viewSettings.mainTab.title"})}),this.renderContentOnlyEditorEducationPill(),y,e[HP]?a()(j.Z,{topBorder:!0},void 0,this[KP](),this.renderLayout(),this[EP](),this.renderFilter(),this.renderSort(),this.renderGroup(),this.renderSubGroup(),this.renderRelationFeatures(),a()(Vb,{[hT]:t}),this.renderAutomationAction()):l[RP](l[BP],null,a()(j.Z,{},void 0,d,!d&&this[KP](),!d&&this.renderLayout()),a()(j.Z,{topBorder:!0},void 0,d&&this[KP](),d&&this.renderLayout(),this[EP](),this.renderFilter(),this.renderSort(),this.renderGroup(),this.renderSubGroup(),this.renderRelationFeatures(),a()(Vb,{[hT]:t}),this.renderAutomationAction())),a()(j.Z,{topBorder:!0},void 0,this.renderNotificationAction(),this.renderLockAction(),this.renderCopyLinkAction(),this.renderDuplicateAction(),this.renderDeleteAction()),n[VP]()&&a()(j.Z,{topBorder:!0},void 0,this.renderEditSettingsAction()))}renderContentOnlyEditorEducationPill(){const{[hT]:e}=this[vT],t=e[nT]();if(t&&"content_only_editor"===t.getRole())return a()(GC,{})}renderLockAction(){const{[hT]:e}=this[vT],t=e[nT]();if(!t)return;const o=t[$P](),i=t[eT]();if(!(o?o[FP]():t[FP]()))return;const n=null==t?void 0:t[DP]();return a()(E.Z,{icon:i?A.Z.unlocked:A.Z.locked,[NP]:this.getLockUnlockTitle(o,n,i),[IP]:this.handleToggleLockClick})}getLockUnlockTitle(e,t,o){return a()(u.FormattedMessage,t?o?{[bT]:"Unlock wiki",id:"action.unlockWikiName.name"}:{[bT]:"Lock wiki",id:"action.lockWikiName.name"}:e?o?{[bT]:"Unlock database",id:"database.viewSettings.mainTab.unlockDatabase.title"}:{[bT]:"Lock database",id:"database.viewSettings.mainTab.lockDatabase.title"}:o?{[bT]:"Unlock views",id:"database.viewSettings.mainTab.unlockViews.title"}:{[bT]:"Lock views",id:"database.viewSettings.mainTab.lockViews.title"})}renderCopyLinkAction(){return a()(E.Z,{icon:A.Z.link,[NP]:a()(u.FormattedMessage,{[bT]:"Copy link to view",id:"database.viewSettings.mainTab.copyLinkButton.title"}),[IP]:this.handleCopyLinkClick})}renderDuplicateAction(){const{[hT]:e}=this[vT];if(e[jP][QP][LP]&&"collectionTypedView"!==e[ZP])return a()(E.Z,{icon:A.Z.duplicate,[NP]:a()(u.FormattedMessage,{[bT]:"Duplicate view",id:"database.viewSettings.mainTab.duplicateButton.title"}),[IP]:this.handleDuplicateClick})}renderGroup(){const{[hT]:e,[iT]:t}=this[vT],o=this[xP](),i="board"===o?{groupByKey:"board_columns_by",[MP]:"board_columns"}:{groupByKey:_P,[MP]:kP},n=e[AP][QP],r=e[TP][QP][i.groupByKey],s=e[jP][QP];return"calendar"!==o&&a()(E.Z,{icon:"board"===o?A.Z.groupByHorizontal:A.Z.groupByVertical,[NP]:a()(u.FormattedMessage,{[bT]:"Group",id:"database.viewSettings.mainTab.groupButton.title"}),showChevron:!0,right:CC(r?n[r[PP]]:void 0),[IP]:()=>{var a;Ye[lT]({[pT]:this[pT],[hT]:e,[sT]:"click_group",[rT]:o,[CP]:r?null===(a=n[r[PP]])||void 0===a?void 0:a.type:void 0}),e.loadingDetails[wP]({type:"load_groups_menu"}),m[bP]({[iT]:t,item:r?{type:"group",...i}:{type:"groupByProperty",...i}})},[OP]:!r&&!s[LP]})}renderSubGroup(){const e=this[xP](),{[hT]:t,[iT]:o}=this[vT],i=t[AP][QP],n=t[TP][QP][_P],r={groupByKey:_P,[MP]:kP},s=t[jP][QP];return"board"===e&&a()(E.Z,{icon:A.Z.groupByVertical,[NP]:a()(u.FormattedMessage,{[bT]:"Sub-group",id:"database.viewSettings.mainTab.subGroupButton.title"}),showChevron:!0,right:CC(n?i[n[PP]]:void 0),[IP]:()=>{var a;Ye[lT]({[pT]:this[pT],[hT]:t,[sT]:"click_subgroup",[rT]:e,[CP]:n?null===(a=i[n[PP]])||void 0===a?void 0:a.type:void 0}),t.loadingDetails[wP]({type:"load_groups_menu"}),m[bP]({[iT]:o,item:n?{type:"group",...r}:{type:"groupByProperty",...r}})},[OP]:!n&&!s[LP]})}renderRelationFeatures(){const{[hT]:e}=this[vT],t=e[YP]();if((null==t||!t[XP]())&&"collectionTypedView"!==e[ZP])return a()(l[BP],{},void 0,this.renderSubitem(),this.renderArrowsBy())}renderSubitem(){return Ls.default[SP](hP)?this.renderSubitemV2():this.renderSubitemV1()}renderSubitemV1(){const{[hT]:e,[iT]:t}=this[vT],o=e[AP][QP],i=e[vP][QP],n=i?o[i[PP]]:void 0,r=e[jP][QP];return a()(E.Z,{icon:A.Z.nest,[NP]:a()("div",{[WP]:{[fP]:yP,[gP]:mP}},void 0,a()(u.FormattedMessage,{[bT]:"Sub-items",id:"database.viewSettings.mainTab.subitems.title"}),a()(HC.Z,{size:2})),showChevron:!0,right:a()("span",{[WP]:{..._.Z[pP]}},void 0,(null==n?void 0:n.name)??a()(u.FormattedMessage,{[bT]:"None",id:"database.viewSettings.subitemTab.none"})),[IP]:()=>{Ye[lT]({[pT]:this[pT],[hT]:e,[sT]:"click_subitem"}),m[bP]({[iT]:t,item:{type:uP}})},[OP]:!i&&!r[LP]})}renderSubitemV2(){const{[iT]:e,[hT]:t}=this[vT],o=t[vP][QP],i=t.databaseType,n=Bo({feature:uP,[hT]:t});return a()(E.Z,{icon:A.Z.nest,[NP]:l[RP](u.FormattedMessage,(0,D.Pm)(i)),showChevron:!0,right:this[cP](n),[IP]:()=>{m[bP]({[iT]:e,item:{type:"subitemV2"}})},[OP]:!this.isRelationFeatureEnabled(o)})}[cP](e){let t;return t=e?e.supportedInView&&!e.enabledOnView?D.dH.relationFeatureHiddenMessage:D.dH.relationFeatureOnMessage:D.dH.relationFeatureOffMessage,Et.default[zP](t)}renderArrowsBy(){return Ls.default[SP]("dependency_date_shifting_by_space")?this.renderArrowsByV2():$i({feature:dP,viewType:this[xP]()})?this.renderArrowsByV1():void 0}renderArrowsByV1(){const{[hT]:e,[iT]:t}=this[vT],o=e[AP][QP],i=e[lP][QP],n=i?o[i]:void 0,r=e[jP][QP];return a()(E.Z,{icon:A.Z.arrowsDiverging,[NP]:a()("div",{[WP]:{[fP]:yP,[gP]:mP}},void 0,a()(u.FormattedMessage,{[bT]:"Dependencies",id:"database.viewSettings.mainTab.dependencies.title"}),a()(HC.Z,{size:2})),showChevron:!0,right:a()("span",{[WP]:{..._.Z[pP]}},void 0,(null==n?void 0:n.name)??a()(u.FormattedMessage,{[bT]:"None",id:"database.viewSettings.arrowsByTab.none"})),[IP]:()=>{Ye[lT]({[pT]:this[pT],[hT]:e,[sT]:"click_timeline_arrows_by"}),m[bP]({[iT]:t,item:{type:"arrowsBy"}})},[OP]:!i&&!r[LP]})}renderArrowsByV2(){const{[iT]:e,[hT]:t}=this[vT],o=t[lP][QP],i=Bo({feature:dP,[hT]:t});return a()(E.Z,{[NP]:l[RP](u.FormattedMessage,D.dH.dependenciesMenuItemLabel),showChevron:!0,icon:A.Z.collectionDependenciesArrowRight,right:this[cP](i),[IP]:()=>{m[bP]({[iT]:e,item:{type:sP}})},[OP]:!this.isRelationFeatureEnabled(o)})}isRelationFeatureEnabled(e){const{[hT]:t}=this[vT],o=t[jP][QP],i=(0,k.isDefined)(e),n=o[LP];return i||n}renderNotificationAction(){if(Ls.default[SP]("status_automations"))return;if(!(0,v.F6)())return;if(!wd(this[vT][hT][YP]()))return;const{[iT]:e}=this[vT],t=this[vT][hT].aliveSlackAutomationCount[QP];return a()(E.Z,{icon:A.Z.bell,[NP]:a()(u.FormattedMessage,{[bT]:"Slack notifications",id:"database.viewSettings.mainTab.slackNotifications.title"}),right:t>0?l[RP](l[BP],null,t.toString()):a()(u.FormattedMessage,{id:"database.viewSettings.mainTab.slackNotifications.none",[bT]:"None"}),showChevron:!0,[IP]:()=>{t>0?m[bP]({[iT]:e,item:{type:"slackAutomations"}}):m[bP]({[iT]:e,item:{type:"createSlackAutomation"}})}})}renderAutomationAction(){if(!Ls.default[SP]("status_automations"))return;const{[hT]:e,[iT]:t}=this[vT];if(!bd(e[YP]()))return;const o=this[vT][hT].aliveAutomationCount[QP];return a()(E.Z,{icon:A.Z.bolt,[IP]:()=>{o>0?m[bP]({[iT]:t,item:{[rP]:aP,type:nP}}):(m[bP]({[iT]:t,item:{[rP]:aP,type:nP}}),m[bP]({[iT]:t,item:{type:iP}}))},right:o>0?o:a()(u.FormattedMessage,{id:"database.viewSettings.mainTab.automations.none",[bT]:"None"}),showChevron:!0,[NP]:a()(u.FormattedMessage,{[bT]:"Automations",id:"database.viewSettings.mainTab.automations.title"})})}renderDeleteAction(){const{[hT]:e}=this[vT];if(!e[nT]())return;return e[jP][QP][LP]&&"collectionTypedView"!==e[ZP]?a()(E.Z,{icon:A.Z.trash,[NP]:a()(u.FormattedMessage,{[bT]:"Delete view",id:"database.viewSettings.mainTab.deleteButton.title"}),isRed:!0,[IP]:this[oT]}):void 0}renderEditSettingsAction(){const{[hT]:e}=this[vT],t=e[nT]();if(!t)return;return e[jP][QP][LP]?a()(E.Z,{icon:A.Z.options,[NP]:a()(u.FormattedMessage,{[bT]:"Edit {databaseName} settings",id:"CollectionSettingsViewMain.editSettings",values:{[oP]:a()(zC.Z,{store:t,[WP]:{[fP]:tP}})}}),[IP]:()=>{m.openCollectionViewBlockSettings({[pT]:this[pT],store:t}),m[eP]({[iT]:e[JC]})}}):void 0}[KP](){const{[hT]:e,[iT]:t}=this[vT],o=e[YP](),i=e[nT]();if(!o||!i)return;if(!this.shouldRenderSourceStore[QP])return;const n=o.getIcon();return a()(E.Z,{icon:A.Z.folder,[NP]:a()(u.FormattedMessage,{[bT]:"Source",id:"database.viewSettings.mainTab.sourceButton.title"}),showChevron:!0,right:l[RP](l[BP],null,n&&a()(nh.Z,{icon:n,isEmptyPage:!1,size:20,[OP]:!0,[WP]:{[UP]:4,opacity:.6}}),a()(zC.Z,{store:o})),rightStyle:{[YC]:1},textWrapperStyle:{[YC]:0},[IP]:()=>{Ye[lT]({[pT]:this[pT],[hT]:e,[sT]:"click_source"}),m[bP]({[iT]:t,item:{type:rP}})}})}renderLayout(){const{[hT]:e,[iT]:t}=this[vT],o=e[fT]();if(!o)return;const i=o[aT]();return i?a()(E.Z,{icon:A.Z.layoutPadded,isPadded:!0,[NP]:a()(u.FormattedMessage,{[bT]:"Layout",id:"database.viewSettings.mainTab.layoutButton.title"}),showChevron:!0,right:Bt.Bh[i],[IP]:()=>{Ye[lT]({[pT]:this[pT],[hT]:e,[sT]:"click_layout"}),m[bP]({[iT]:t,item:{type:"layout"}})}}):void 0}renderType(){const{[hT]:e,[iT]:t}=this[vT],o=e[YP]();if(!o)return;if(!this.shouldRenderDatabaseTypeStore[QP])return;const i=o.getDatabaseType(),n=i?hS.pX[i]:"untyped";return a()(E.Z,{icon:()=>A.Z.settingsIntegration({width:20}),isPadded:!0,[NP]:a()("div",{[WP]:{[fP]:yP,[gP]:mP}},void 0,a()(u.FormattedMessage,{[bT]:"Database type",id:"database.viewSettings.mainTab.databaseTypeButton.title"}),a()(LC.Z,{})),showChevron:!0,right:SS.kd[n],[IP]:()=>{Ye[lT]({[pT]:this[pT],[hT]:e,[sT]:"click_database_type"}),m[bP]({[iT]:t,item:{type:"setDatabaseType"}})}})}[EP](){const{[hT]:e,[iT]:t}=this[vT],o=(e[TP][QP][(0,Vt.getPropertyFormatKeyForView)(this[xP]())]||[]).filter((e=>Boolean(e.visible))).length;return a()(E.Z,{icon:A.Z[XC],[NP]:a()(u.FormattedMessage,{[bT]:"Properties",id:"database.viewSettings.mainTab.propertiesButton.title"}),showChevron:!0,right:a()(u.FormattedMessage,{[bT]:"{propertiesShown} shown",id:"database.viewSettings.mainTab.propertiesButton.propertiesShown.title",values:{propertiesShown:o}}),[IP]:()=>{Ye[lT]({[pT]:this[pT],[hT]:e,[sT]:"click_properties"}),m[bP]({[iT]:t,item:{type:XC,timelineViewTab:"timeline"}})}})}renderFilter(){const{[hT]:e,[iT]:t}=this[vT],o=e[jP][QP],i=e[$C][QP].length+(e[QC][QP]&&o[LP]?1:0);return a()(E.Z,{icon:A.Z.filterCircled,[NP]:a()(u.FormattedMessage,{[bT]:"Filter",id:"database.viewSettings.mainTab.filterButton.title"}),showChevron:!0,right:a()(u.FormattedMessage,i>0?{[bT]:"{numberOfFilters, plural, one {{numberOfFilters} filter} other {{numberOfFilters} filters}}",values:{numberOfFilters:i},id:"database.viewSettings.mainTab.filterButton.filters.title"}:{[bT]:"None",id:"database.viewSettings.mainTab.filterButton.noFilters.title"}),[IP]:()=>{Ye[lT]({[pT]:this[pT],[hT]:e,[sT]:"click_filters"}),0===i?m[bP]({[iT]:t,item:{type:"createFilter"}}):m[bP]({[iT]:t,item:{type:"filters"}})}})}renderSort(){const{[hT]:e,[iT]:t}=this[vT],o=e.currentSortsStore[QP].length;return a()(E.Z,{icon:A.Z.sortPadded,isPadded:!0,[NP]:a()(u.FormattedMessage,{[bT]:"Sort",id:"database.viewSettings.mainTab.sortButton.title"}),showChevron:!0,right:a()(u.FormattedMessage,o>0?{[bT]:jC,values:{numberOfSorts:o},id:"database.viewSettings.mainTab.sortButton.oneOrMoreSorts.title"}:{[bT]:"None",id:"database.viewSettings.mainTab.sortButton.noSorts.title"}),[IP]:()=>{Ye[lT]({[pT]:this[pT],[hT]:e,[sT]:"click_sort"}),0===o?m[bP]({[iT]:t,item:{type:"createSort"}}):m[bP]({[iT]:t,item:{type:"sort"}})}})}[xP](){var e;const{[hT]:t}=this[vT],o=null===(e=t[fT]())||void 0===e?void 0:e[aT]();if(!o)throw new Error(qC);return o}}CT.displayName="CollectionSettingsViewMain";const PT=(0,u.injectIntl)(CT),TT=o(85).cZW,AT=o(85).bey,kT=o(85).PXg,_T=o(85).kUY,MT=o(85).dLQ,xT=o(85).Yzm,ZT=o(85).nx5,IT=o(85).lzz,DT=o(85).uzK,FT=o(85).jQT,VT=o(85).Xl2,BT=o(85).HxR,ET=o(85).SNI,KT=o(85).LCr,RT=o(85).E3P,NT=o(85).nxU,OT=o(85).wgE,WT=o(85).Drs,UT=o(85).JJj,GT=o(85).G3i,LT=o(85).qU4,zT=o(85).P0R,HT=o(85).P24;class qT extends d.Z{constructor(){super(...arguments),this.handleViewNameBlur=e=>{const{[HT]:t}=this[zT],o=t[LT]();o&&o[GT]()&&o.getName()!==e&&y[UT]({[WT]:"CollectionSettingsCreateView.handleViewNameBlur",[OT]:this[OT],[NT]:t=>{et[RT]({[LT]:o,update:{name:e},[KT]:t})}})},this[ET]=e=>{const{[BT]:t,[HT]:o}=this[zT];this.handleViewNameBlur(e),m[VT]({[BT]:t,item:{type:"main"}}),Ye[FT]({[OT]:this[OT],[HT]:o,action:"rename"})},this.handleViewIconSubmit=e=>{const{[HT]:t}=this[zT],o=t[LT]();o&&o[GT]()&&(y[UT]({[WT]:"CollectionSettingsCreateView.handleViewIconSubmit",[OT]:this[OT],[NT]:t=>{et.updateCollectionViewIcon({[DT]:o,icon:e,[KT]:t})}}),Ye[FT]({[OT]:this[OT],[HT]:t,action:"change_icon",icon:e}))}}renderComponent(){const{[HT]:e,[BT]:t}=this[zT],{device:o}=this[OT],i=e[LT]();if(!i)return;if(!i[GT]())return;const n=i.getFormat()[IT],r=i.getType();return l.createElement(B.ZP,s()({},this[zT],{title:a()(u.FormattedMessage,{[ZT]:"New view",id:"database.viewSettings.createViewTab.title"}),desktopWidth:290}),a()(j.Z,{},void 0,a()(bS.Z,{initialValue:"",[TT]:Et.default[xT](wT.viewNamePlaceholderMessage),focusInitial:!o[MT]||void 0,onBlur:this.handleViewNameBlur,iconButton:{icon:e=>a()(BC.F,{color:_T,viewIcon:n,viewType:r,style:{[kT]:6}}),[AT]:{fill:pb.IconColorVariationsMap[this.theme.mode][_T]},enforceIconColor:_T,onSubmit:this.handleViewIconSubmit},onSubmit:this[ET]})),a()(mb.Z,{[HT]:e,[BT]:t,showDoneButton:!o[MT]}))}}qT.displayName="CollectionSettingsCreateView";const jT=(0,u.injectIntl)(qT);var QT=o(49670),$T=o(51127),XT=o(64964),YT=o(25464),JT=o(74523);const eA=o(85).DIE,tA=o(85).Joh,oA=o(85).P3s,iA=o(85).D7I,nA=o(85).XNW,aA=o(85).Exd,rA=o(85).PXg,sA=o(85).YDv,lA=o(85).jkI,dA=o(85).H1U,cA=o(85).EMU,uA=o(85).sM5,pA=o(85).Mm1,mA=o(85).Gpy,gA=o(85).nx5,yA=o(85).BQ6,fA=o(85).ChN,vA=o(85).uzK,hA=o(85).U5m,SA=o(85).oWD,bA=o(85).P24,wA=o(85).HxR;function CA(e){window.__c={n:"CollectionSettingsDBTypePropertyMapping"};const t=(0,C.O7)(),o=t.device.isMobile,{[wA]:i,[bA]:n,databaseType:r}=e,d=(0,P.VK)((()=>xa.TR(r)),[r]),c=(0,P.VK)((()=>{var e;return null===(e=n[SA]())||void 0===e?void 0:e.getSchema()}),[n]),p=(0,P.VK)((()=>{if(c&&d)return xa.Au(d,c)}),[d,c]),g=(0,P.VK)((()=>{const e={};return Object.keys(d||{}).filter((e=>void 0!==(null==d?void 0:d[e])&&e.startsWith("notion://"))).forEach((t=>{e[t]=hS.bK})),Object[hA](p||{}).forEach((t=>{let[o,i]=t;e[o]=i})),e}),[d,p]),[f,v]=(0,l.useState)(g),[h,S]=(0,l.useState)(!1),b=(0,l.useCallback)(((e,t)=>{v({...f,[e]:t})}),[f]),w=(0,P.VK)((()=>{const e=hS.GL[r],t=xa.vi(e);return t&&xa.yK(t,e)}),[r]),T=(0,l.useCallback)((()=>{const e=n[SA](),o=n[vA]();e&&o&&y.createAndCommit({userAction:"CollectionSettingsDBTypePropertyMapping.migrateDatabase",environment:t,perform:n=>{$T.migrateDatabase({environment:t,[vA]:o,[SA]:e,databaseType:r,propertyMapping:{...f,...p},typedPropertySchemas:{...d,...w},transaction:n}),m.closeSettings({[wA]:i}),XT.oV({label:a()(u.FormattedMessage,{[gA]:"<boldtext>{databaseName}</boldtext> has been changed to {databaseType} type",id:"database.viewSettings.databaseTypePropertyMappingTab.successfulTypingToastMessage",[mA]:{boldtext:e=>a()("span",{[yA]:{[fA]:_.Z[fA].semibold}},void 0,"¬†",e,"¬†"),databaseType:r,databaseName:e.getName()||"Untitled"}})})}})}),[d,w,f,p,i,n,r,t]),k=(0,l.useCallback)((e=>{const t=e.type;return(c?Object[hA](c):[]).filter((e=>{let[o,i]=e;if(i)return i.type===t})).map((e=>{let[o,i]=e;return{key:o,title:null==i?void 0:i.name,icon:As.wG[t]({width:12})}}))}),[c]),M=(0,l.useCallback)(((e,t,o)=>{const i=o||(null==d?void 0:d[e]);if(!i)return null;const n=i.name,r=k(i);return a()(yb.Z,{title:n,selectedKey:f[e]||t,popupStyle:{minWidth:190},icon:As.wG[i.type],options:[...r,{key:t,title:t,icon:A.Z.plus({width:12})}],onChange:t=>b(e,t)})}),[f,d,k,b]),x=(0,l.useMemo)((()=>{const e=Object[hA](w||{}).map((e=>{let[t,o]=e;return M(t,hS.bK,o)}));return h||e.length<=3?e:e.slice(0,3)}),[w,h,M]);return l[iA](B.ZP,s()({},e,{title:a()(u.FormattedMessage,{[gA]:"Database type",id:"database.viewSettings.databaseTypePropertyMappingTab.title"})}),a()(j.Z,{topBorder:!1,shouldShowBottomDivider:o,title:a()(u.FormattedMessage,{[gA]:"New database type",id:"database.viewSettings.databaseTypePropertyMappingTab.type"}),[yA]:{[pA]:15}},void 0,a()("div",{[yA]:{[uA]:cA,[dA]:lA,[sA]:20}},void 0,a()("div",{},void 0,SS.by[r]({width:13,height:13,[rA]:8})),a()("span",{[yA]:{[aA]:14}},void 0,SS.kd[r]))),a()(j.Z,{topBorder:!1,shouldShowBottomDivider:o,title:a()("div",{[yA]:{[uA]:cA,[dA]:lA}},void 0,a()(u.FormattedMessage,{[gA]:"Required Properties",id:"database.viewSettings.databaseTypePropertyMappingTab.requiredPropertiesTitle"}),a()(xn.Z,{placement:YT.u.Right,render:e=>l[iA](JT.Z,s()({},e,{href:(0,Nb.getLocalizedUrl)("guides.databaseType"),[oA]:"set_database_type",[yA]:{[nA]:4}})),[tA]:()=>a()(u.FormattedMessage,{id:"database.viewSettings.databaseTypePropertyMappingTab.requiredPropertiesTooltip",[gA]:"Properties required for {type}",[mA]:{type:r}})}))},void 0,Object[hA](g).map((e=>{let[t,o]=e;return M(t,hS.bK)}))),a()(j.Z,{topBorder:!1,shouldShowBottomDivider:o,title:a()(u.FormattedMessage,{[gA]:"Suggested Properties",id:"database.viewSettings.databaseTypePropertyMappingTab.suggestedPropertiesTitle"})},void 0,x),!h&&a()(By.Z,{[yA]:{[nA]:12},onClick:e=>{e[eA](),S(!0)}},void 0,a()("div",{[yA]:{}},void 0,a()(u.FormattedMessage,{[gA]:"More...",id:"database.viewSettings.databaseTypePropertyMappingTab.showMoreSuggestedProperties"}))),a()(it.Z,{[yA]:{[uA]:cA,margin:"14px",height:32},onClick:()=>{T()}},void 0,a()(u.FormattedMessage,{[gA]:"Change to {type}",id:"database.viewSettings.databaseTypePropertyMappingTab.confirmChangeType",[mA]:{type:r}})),a()(Ub.Z,{href:(0,Nb.getLocalizedUrl)("guides.databaseType"),title:a()(u.FormattedMessage,{[gA]:"Learn about {type} databases",id:"database.viewSettings.databaseTypePropertyMappingTab.learnMoreButton.title",[mA]:{type:SS.kd[r]}}),[oA]:"set_database_type"}))}var PA=o(68641);const TA=o(85).t$C,AA=o(85).wti,kA=o(85).LCr,_A=o(85).veG,MA=o(85).wgE,xA=o(85).JJj,ZA=o(85).oWD,IA=o(85).h$M,DA=o(85).HxR,FA=o(85).PG2,VA=o(85).bey,BA=o(85).PXg,EA=o(85).Uie,KA=o(85).fsm,RA=o(85).XNW,NA=o(85).auS,OA=o(85).jkI,WA=o(85).H1U,UA=o(85).OBh,GA=o(85).ejZ,LA=o(85).ug4,zA=o(85).P24,HA=o(85).D7I,qA=o(85).iy2,jA=o(85).nx5;class QA extends d.Z{renderComponent(){return l[HA](B.ZP,s()({},this.props,{title:a()(u.FormattedMessage,{[jA]:"Deleted properties",id:"database.viewSettings.propertyTab.deletedTitle"})}),this[qA]())}[qA](){const{[zA]:e}=this.props,t=e[LA].state,o=Object.entries(t).map((e=>{let[t,o]=e;if(o)return{[GA]:t,[UA]:o}})).filter(k.isDefined);if(0===o.length)return a()(j.Z,{},void 0,a()(zb.Z,{title:a()(u.FormattedMessage,{[jA]:"No results",id:"database.viewSettings.deletedPropertiesTab.noResults"})}));const{theme:i}=this;return a()(j.Z,{},void 0,o.map((e=>{let{[GA]:t,[UA]:o}=e;return a()(zb.Z,{title:a()("div",{style:{display:"flex",[WA]:OA}},void 0,a()(As.ZP,{type:o.type,icon:o.icon,size:16,theme:i,style:{fill:i[NA]}}),a()("span",{style:{[RA]:6,[KA]:200,..._.Z[EA]}},void 0,o.name)),right:l[HA](l.Fragment,null,a()(iu.Z,{icon:A.Z.undo,[VA]:{[BA]:2},[FA]:()=>{this.handleRestoreDeletedPropertyClick(t)}}),a()(iu.Z,{icon:A.Z.trash,[FA]:()=>{this.handlePermanentlyDeleteDeletedPropertyClick(t)}}))},t)})))}handleRestoreDeletedPropertyClick(e){const{[DA]:t,[zA]:o,[IA]:i,timelineViewTab:n}=this.props,r=o[ZA](),s=(0,PA.jI)({timelineViewTab:n,[zA]:o});if(r){const o=I.getRestoreDeletedPropertyUpdate({deletedSchema:r.getDeletedSchema(),property:e});if(o){var l;if("verification"===(null===(l=r.getDeletedSchema()[e])||void 0===l?void 0:l.type)){const e=r.getSchema();if(Object.keys(e).some((t=>{var o;return"verification"===(null===(o=e[t])||void 0===o?void 0:o.type)})))return void tt.showDialog({message:a()(u.FormattedMessage,{id:"database.deletedPropertiesTab.cannotRestoreDuplicateProperty.modal.verification",[jA]:"You can only have one verification property."}),showCancel:!1,keepFocus:!0,items:[{label:a()(u.FormattedMessage,{id:"database.deletedPropertiesTab.cannotRestoreDuplicateProperty.modal.dismissButton",[jA]:"Dismiss"}),onAccept:()=>{}}]})}y[xA]({userAction:"CollectionSettingsDeletedProperties.handleRestoreDeletedPropertyClick",[MA]:this[MA],perform:e=>{et[_A]({[MA]:this[MA],[ZA]:r,update:o.updateSchema,[kA]:e}),et[AA]({[ZA]:r,update:o.updateDeletedSchema,[kA]:e})}}),m.popSettingsItem({[DA]:t}),m.navigateToItem({[DA]:t,item:{type:"property",property:e,formatKey:s,[IA]:i}})}}}handlePermanentlyDeleteDeletedPropertyClick(e){tt.showDialog({message:a()(u.FormattedMessage,{id:"database.viewSettings.deletedPropertiesTab.permanentlyDeleteProperty.modal.prompt",[jA]:"Are you sure you want to delete this property?"}),showCancel:!0,keepFocus:!0,items:[{label:a()(u.FormattedMessage,{id:TA,[jA]:"Delete"}),color:"red",onAccept:()=>{const t=this.props[zA][ZA]();t&&y[xA]({userAction:"CollectionSettingsDeletedProperties.handlePermanentlyDeleteDeletedPropertyClick",[MA]:this[MA],perform:o=>{et[AA]({[ZA]:t,update:{[e]:null},[kA]:o})}})}}]})}}QA.displayName="CollectionSettingsDeletedProperties";const $A=(0,u.injectIntl)(QA);var XA=o(83319);const YA=o(85).EQe;function JA(e){const{actionStores:t,[YA]:o,loadingStatus:i,mode:n}=e;return(0,P.VK)((()=>"create"===n?"edit":"resolved"===i&&o&&t?md({[YA]:o,actionStores:t})?"edit":gd({[YA]:o})?"readonly_with_delete":"readonly":"readonly"),[n,i,o,t])}var ek=o(84398),tk=o(23223),ok=o(42402);const ik=o(85).$bT,nk=o(85).ewQ,ak=o(85).LlE,rk=o(85).gGi,sk=(o(85).OlU,o(85).cuh,o(85).UWG),lk=o(85).bvM,dk=(o(85).m$B,o(85).fOf),ck=o(85).Gpy,uk=o(85).PG2,pk=o(85).VUE,mk=o(85).psj,gk=o(85).BQ6,yk=o(85).Yns,fk=o(85).D7I,vk=o(85).WGG,hk=o(85).oWD,Sk=o(85).EQe,bk=o(85).nx5,wk=(0,u.defineMessages)({automationIncompatibleViewFilterAndOwner:{[bk]:"This automation may not work because the view has a non-supported filter.",id:"AutomationHeaderView.incompatibleCollectionViewFilter.owner"},automationPublicAccess:{[bk]:"This automation is part of a template.",id:"AutomationHeaderView.automationPublicAccess"},automationUpgrade:{[bk]:"<anchor-upsell>Upgrade</anchor-upsell> to edit this automation or create your own.",id:"AutomationHeaderView.automationUpgrade"},automationSlackNoPermissions:{[bk]:"Ask {user} to edit this automation.",id:"AutomationHeaderView.automationSlackNoPermissions"},automationSlackWithPermissions:{[bk]:"Ask {user} to edit this automation or <anchor-delete>delete</anchor-delete> it when necessary.",id:"AutomationHeaderView.automationSlackWithPermissions"},automationMissingPermissionsNoPermissions:{[bk]:"You must have full access to target databases in this automation to edit it.",id:"AutomationHeaderView.automationMissingPermissionsNoPermissions"},automationMissingPermissionsWithPermissions:{[bk]:"You must have full access to target databases in this automation to edit it or <anchor-delete>delete</anchor-delete> it when necessary.",id:"AutomationHeaderView.automationMissingPermissionsWithPermissions"},automationGenericFullAccess:{[bk]:"You must have full access to this database to edit automations.",id:"AutomationHeaderView.automationGenericFullAccess"}});function Ck(e){window.__c={n:"AutomationHeaderView"};const{[Sk]:t,automationPermissionScope:o,[hk]:i,onDelete:n,referencesIncompatibleCollectionViewFilter:r,showSlackSpecificMessages:d}=e,c=(0,C.O7)(),p=(0,_p.E)(vk),m=Gc({[Sk]:t,[hk]:i}),g=(0,P.VK)((()=>Boolean((0,Rc.userHasPermissionViaPublicAccess)(c,t))),[t,c]),y=(0,P.VK)((()=>(0,tk.$5)(null==m?void 0:m.context)),[m]),f=(0,P.VK)((()=>Xd(t)),[t]),v=(0,l.useCallback)((()=>{kp.y(c,{from:"database_automation_settings_header_message",for:"plus"})}),[c]),h=kk();if(d)return l[fk](Pk,e);if(g)return a()(Tk,{icon:a()("div",{[gk]:h[yk]},void 0,A.Z.lockedFilled(h.lockedIcon))},void 0,a()("p",{[gk]:h[mk]},void 0,l[fk](u.FormattedMessage,wk.automationPublicAccess)));if("sufficient"!==y[pk]&&"free_workspace"===y.reason&&p)return a()(Ak,{icon:a()("div",{[gk]:h.boltIconWrap},void 0,A.Z.boltFilled(h.boltIcon))},void 0,a()("p",{[gk]:h[mk]},void 0,l[fk](u.FormattedMessage,s()({},wk.automationUpgrade,{[ck]:{"anchor-upsell":e=>a()(ok.Z,{[uk]:v,[gk]:h.link},void 0,e)}}))));if("sufficient"!==y[pk]&&"missing_permissions"===y.reason&&y.actionId){const e=f[y.actionId];return a()(Tk,{icon:a()("div",{[gk]:h[yk]},void 0,A.Z.lockedFilled(h.lockedIcon))},void 0,a()("p",{[gk]:h[mk]},void 0,l[fk](u.FormattedMessage,s()({},"readonly"===o?wk.automationSlackNoPermissions:wk.automationSlackWithPermissions,{[ck]:{"anchor-delete":e=>a()(ok.Z,{[uk]:n,[gk]:h.link},void 0,e),user:e}}))))}return"insufficient"===y[pk]||"unknown"===y[pk]?a()(Tk,{icon:a()("div",{[gk]:h[yk]},void 0,A.Z.lockedFilled(h.lockedIcon))},void 0,a()("p",{[gk]:h[mk]},void 0,l[fk](u.FormattedMessage,wk.automationGenericFullAccess))):r?a()(Tk,{icon:a()("div",{[gk]:h[yk]},void 0,A.Z[dk](h.warningIcon))},void 0,l[fk](u.FormattedMessage,wk.automationIncompatibleViewFilterAndOwner)):null}function Pk(e){window.__c={n:"AutomationHeaderViewSlackMessage"};const{automationCreatorName:t,automationPermissionScope:o,automationStatus:i,onDelete:n,onResume:r,referencesIncompatibleCollectionViewFilter:s}=e,l=kk();if("edit"===o){if("disabled"===i||"disabled_permissions"===i)return a()(Tk,{icon:a()("div",{[gk]:l[yk]},void 0,A.Z[dk](l.warningIcon))},void 0,a()("p",{[gk]:l[mk]},void 0,a()(u.FormattedMessage,{[bk]:"This notification has been paused. <resumeAction>Resume notifications</resumeAction>",id:"AutomationHeaderView.header.slack.disabled.owner",[ck]:{resumeAction:e=>a()(ok.Z,{disableUnderline:!0,[uk]:r,[gk]:l.link},void 0,a()("br",{}),e)}})));if(s)return a()(Tk,{icon:a()("div",{[gk]:l[yk]},void 0,A.Z[dk](l.warningIcon))},void 0,a()("p",{[gk]:l[mk]},void 0,a()(u.FormattedMessage,{[bk]:"This rule may not work because the view has a non-supported filter.",id:"AutomationHeaderView.incompatibleCollectionViewFilter.slack.owner"})))}else{if("readonly"===o)return"active"===i?a()(Tk,{icon:a()("div",{[gk]:l[lk]},void 0,A.Z[sk](l[sk]))},void 0,a()("p",{[gk]:l[mk]},void 0,a()(u.FormattedMessage,{[bk]:"Ask {automationCreatorName} to change these settings.",id:"AutomationHeaderView.active.readonly",[ck]:{automationCreatorName:t}}))):a()(Tk,{icon:a()("div",{[gk]:l[yk]},void 0,A.Z[dk](l.warningIcon))},void 0,a()("p",{[gk]:l[mk]},void 0,a()(u.FormattedMessage,{[bk]:"This notification has been paused. Ask {automationCreatorName} to resume these notifications.",id:"AutomationHeaderView.disabled.slack.readonly",[ck]:{automationCreatorName:t}})));if("readonly_with_delete"===o)return"active"===i?a()(Tk,{icon:a()("div",{[gk]:l[lk]},void 0,A.Z[sk](l[sk]))},void 0,a()("p",{[gk]:l[mk]},void 0,a()(u.FormattedMessage,{id:"AutomationHeaderView.active.readonlyWithDelete",[bk]:"Ask {automationCreatorName} to change these settings, or <deleteAction>delete</deleteAction> when necessary.",[ck]:{deleteAction:e=>a()(ok.Z,{disableUnderline:!0,[gk]:l.link,[uk]:()=>{n()}},void 0,e),automationCreatorName:t}}))):a()(Tk,{icon:a()("div",{[gk]:l[yk]},void 0,A.Z[dk](l.warningIcon))},void 0,a()("p",{[gk]:l[mk]},void 0,a()(u.FormattedMessage,{[bk]:"This notification has been paused. Ask {automationCreatorName} to resume these notifications, or <deleteAction>delete</deleteAction> when necessary.",id:"AutomationHeaderView.disabled.slack.readonlyWithDelete",[ck]:{deleteAction:e=>a()(ok.Z,{disableUnderline:!0,[uk]:n,[gk]:l.link},void 0,e),automationCreatorName:t}})));(0,k.unreachable)(o)}return null}function Tk(e){window.__c={n:"AutomationMessage"};const{children:t,icon:o}=e,i=kk();return a()("div",{[gk]:i.wrapWrap},void 0,a()("div",{[gk]:i.wrap},void 0,o&&a()("div",{[gk]:i.iconWrap},void 0,o),a()("div",{[gk]:i.messageWrap},void 0,t)))}function Ak(e){window.__c={n:"AutomationUpsellMessage"};const{children:t,icon:o}=e,i=kk();return a()("div",{[gk]:i.wrapWrap},void 0,a()("div",{[gk]:i.upsellWrap},void 0,o&&a()("div",{[gk]:i.iconWrap},void 0,o),a()("div",{[gk]:i.messageWrap},void 0,t)))}function kk(){const{isMobile:e}=(0,C.Fy)();return(0,T.yK)((t=>({boltIcon:{fill:t.icon.yellow,height:rk,width:rk},boltIconWrap:{height:20,[ak]:2,width:20},icon:{},iconWrap:{flexGrow:0,flexShrink:0},lockedIcon:{fill:t.icon.secondary,height:rk,width:rk},[yk]:{background:t.fill.lightGray,borderRadius:3,height:20,[ak]:2,width:20},link:{color:t.text.interactive},messageWrap:{flexGrow:1},[mk]:{color:t.text.secondary,fontSize:e?14:12,margin:0},warningIcon:{color:t[nk].orange[400],height:rk,width:rk},warningIconWrap:{height:20,[ak]:2,width:20},wrap:{alignItems:"start",display:"flex",[ik]:"row",gap:10},wrapWrap:{[ak]:e?12:"0 12px 12px 12px"},upsellWrap:{alignItems:"center",background:t[nk].yellow[50],border:`1px solid ${t[nk].yellow[100]}`,borderRadius:6,display:"flex",[ik]:"row",gap:10,[ak]:8},[sk]:{fill:t.mediumIconColor,width:16,height:"auto"},[lk]:{height:20,[ak]:2,width:20}})),[e])}var _k=o(75024);const Mk=o(85).ewQ;function xk(e){window.__c={n:"AutomationEmptyStepButton"};const{icon:t,onClick:o,title:i}=e,n=(0,T.yK)((e=>({button:{alignItems:"center",border:`1px dashed ${e.regularDividerColor}`,borderRadius:6,display:"flex",color:e[Mk].gray[900],gap:6,justifyContent:"center",padding:16},iconWrap:{fill:e[Mk].gray[600]},title:{fontSize:14,lineHeight:1.3}})),[]);return a()(K.Z,{onClick:o,style:n.button},void 0,t&&a()("div",{"aria-hidden":"true",style:n.iconWrap},void 0,t),a()("div",{style:n.title},void 0,i))}const Zk=o(85).nx5,Ik=(o(85).N0E,o(85).ccq),Dk=o(85).D7I,Fk=o(85).oWD,Vk=o(85).EQe;function Bk(e){window.__c={n:"AutomationActionSelectButton"};const{[Vk]:t,availableActions:o,initialState:i,updateCurrentAutomationState:n,[Fk]:r}=e,d=(0,zc.d)(),c=o[0];return r?c&&"slack_notification"===c.type?a()(st.ZP,{alignmentToOrigin:st.vR.Center,[Ik]:st.pO.Bottom,forceInitialInbound:!0,popupType:d,render:e=>a()(Ek,{[Vk]:t,buttonPopupParent:e,updateCurrentAutomationState:n,[Fk]:r}),renderOrigin:e=>l[Dk](Kk,s()({},e,{action:o[0].type}))}):a()(st.ZP,{alignmentToOrigin:st.vR.Center,[Ik]:st.pO.Bottom,popupType:d,render:e=>a()(ug,{[Vk]:t,buttonPopupParent:e,[Fk]:r,initialState:i,updateCurrentAutomationState:n}),renderOrigin:e=>l[Dk](Rk,e)}):a()(Rk,{onClick:()=>{}})}function Ek(e){window.__c={n:"SingleActionMenu"};const{[Vk]:t,buttonPopupParent:o,updateCurrentAutomationState:i,[Fk]:n}=e,r=Jd();return a()(ug,{[Vk]:t,initialState:r,updateCurrentAutomationState:i,buttonPopupParent:o,[Fk]:n})}function Kk(e){const{action:t,...o}=e;return"slack_notification"===t?l[Dk](xk,s()({},o,{title:a()(u.FormattedMessage,{id:"AutomationActionSelectMenu.actionTitle.slackNotification",[Zk]:"Send Slack notification to‚Ä¶"}),icon:A.Z.slackLogo({height:24,width:12})})):l[Dk](Rk,o)}function Rk(e){return l[Dk](xk,s()({},e,{icon:A.Z.plus({height:24,width:12}),title:a()(u.FormattedMessage,{id:"AutomationActionSelectButton.actionSection.addAction",[Zk]:"Add action"})}))}var Nk=o(45669);const Ok=o(85).aES,Wk=o(85).z8h,Uk=o(85).O_,Gk=o(85).fOf,Lk=o(85).YDe,zk=o(85).jkI,Hk=o(85).H1U,qk=o(85).$bT,jk=o(85).lzz,Qk=o(85).qU4,$k=o(85).uKy,Xk=o(85).AIq,Yk=o(85).j7K,Jk=o(85).y79,e_=(o(85).PLx,o(85).Wsy),t_=o(85).D7I,o_=o(85).nx5,i_=o(85).Yzm,n_=o(85).hDW,a_=o(85).wgE,r_=o(85).TLr,s_=o(85).pek,l_=o(85).eiN,d_=o(85).uzK,c_=o(85).oWD,u_=o(85).pkR,p_=o(85).P24;function m_(e){window.__c={n:"AutomationCollectionSelectMenu"};const{selectedSourcePointer:t,[p_]:o,onSelect:i,[u_]:n}=e,{isMobile:r}=(0,C.Fy)(),d=(0,u.useIntl)(),c=(0,C.O7)(),[p,m]=l.useState(""),g=(0,P.VK)((()=>o[c_]()),[o]),y=(0,P.VK)((()=>o[d_]()),[o]),f=(0,P.VK)((()=>y&&g?y[s_]()[l_]((e=>{var t;const o=null===(t=e.getCollectionStore())||void 0===t?void 0:t.pointer;return(null==o?void 0:o.id)===g.id})):[]),[y,g]),v=(0,P.VK)((()=>{if(!g||!t)return[];let e;"collection_view"===t.table&&(e=zs.Xr[r_](g,t));return se().uniqBy([...f,e][l_](k.isDefined),(e=>{let{id:t}=e;return t}))[l_]((e=>(0,I.filterCollectionView)(e,p)))}),[g,f,p,t]),h=[{key:"search",items:[{key:"search_item",action:()=>{},render:()=>a()(Ot.ZP,{value:p,focus:!0,style:S.searchBar,textWrapperStyle:S.searchText,onChange:e=>m(e.target.value),placeholder:d[i_]({[o_]:"Search for a view...",id:"collectionViewSelect.viewSearch.label"})})}],render:e=>l[t_](j.Z,e)},(0,P.VK)((()=>{if(g&&t&&(0,Bt.r_)({[c_]:g,[a_]:c,intl:d,queryForFilter:p}))return function(e){const{[c_]:t,[a_]:o,selectedSourcePointer:i,onSelect:n,isMobile:r,intl:d}=e,c=t.getIcon(),p=(0,Nc.vU)({[a_]:o,intl:d,store:t}),m="collection"===i.table&&i.id===t.id,g=t[$k]();return{key:"collection",items:[{key:t.id,action:()=>{g&&n(g)},render:e=>l[t_](Nt.Z,s()({},e,{icon:c&&a()(nh.Z,{isEmptyPage:!1,size:r?18:16,[u_]:!0,icon:c}),title:p,caption:a()(u.FormattedMessage,{id:"AutomationCollectionSelectMenu.collection.caption",[o_]:"Any page in {collectionName}",values:{[Uk]:p}}),right:m&&A.Z.check({width:12,height:"auto"})}))}],render:e=>l[t_](j.Z,s()({},e,{topBorder:!0}))}}({[c_]:g,[a_]:c,selectedSourcePointer:t,onSelect:i,isMobile:r,intl:d})}),[g,c,d,r,i,p,t]),function(e){const{menuListItems:t}=e;if(0===t.length)return;return{key:"collection-views",items:t,render:e=>l[t_](j.Z,s()({},e,{topBorder:!0}))}}({menuListItems:(0,P.VK)((()=>g&&y&&f&&t?function(e){const{[n_]:t,filteredCollectionViewStores:o,[c_]:i,selectedSourcePointer:n,onSelect:r,intl:d}=e,c=i.getSchema();return[...o.map((e=>{const o=e[$k]();if(e.isDefined()&&o){const p="collection_view"===n.table&&n.id===o.id,m=Sd({[Qk]:e,collectionSchema:c}),g=(0,k.isDefined)(m),y=e.getType(),f=e.getFormat()[jk],v=e.getName(),h=(o,i)=>l[t_](Nt.Z,s()({},o,i,{icon:a()(BC.F,{color:"lightGray",viewType:y,viewIcon:f}),title:a()("div",{style:{display:"flex",[qk]:"row",[Hk]:zk,padding:0,gap:4}},void 0,a()(Nk.Z,{[Lk]:y,collectionViewName:v}),g&&p&&A.Z[Gk]({width:16,height:"auto"})),caption:a()(y_,{[n_]:t,[Qk]:e,intl:d,collectionSchema:c,referencesIncompatibleProperties:g}),right:p&&A.Z.check({width:12,height:"auto"}),[u_]:g,disabledFeedback:g}));let S;if(g&&m){var i;const e=null===(i=c[m])||void 0===i?void 0:i.type,t=e?Bt.SO[e]:void 0,o=a()(u.FormattedMessage,t?{id:"AutomationCollectionSelectMenu.tooltip.incompatibleFiltersWarning.specific",[o_]:"{propertyTypeName} properties are not supported",values:{propertyTypeName:t}}:{id:"AutomationCollectionSelectMenu.tooltip.incompatibleFiltersWarning.default",[o_]:"Some properties are not supported"});S=e=>a()(xn.Z,{placement:xn.Z.Placement.Right,renderTooltip:()=>o,render:t=>h(e,t)})}else S=h;return{key:e.id,action:()=>{r(o)},render:S}}}))][l_](k.isDefined)}({[n_]:y,[c_]:g,filteredCollectionViewStores:v,selectedSourcePointer:t,onSelect:i,intl:d}):[]),[y,g,f,v,d,i,t])})][l_](k.isDefined),S=function(e){return(0,T.yK)((t=>({button:{marginTop:8},buttonPopup:{width:e?void 0:230},searchBar:{marginTop:8,marginBottom:8},searchText:{marginLeft:8,marginRight:8},buttonRight:{color:t.selectLightGray[500]},menuItemTextWrapper:{...e?{marginLeft:12}:{},minWidth:"auto"}})),[e])}(r),b=(0,P.qz)(void 0,V.Z),w=(0,zc.d)();if(!g)return null;const _=t&&a()(g_,{pointer:t,[c_]:g,intl:d});return a()(st.ZP,{alignmentToOrigin:st.vR.End,placementToOrigin:st.pO.Bottom,popupType:w,style:S.buttonPopup,buttonPopupStore:b,render:e=>{let t;return t=r?{menuType:at.og.Modal,title:a()(u.FormattedMessage,{id:e_,[o_]:"For pages in"}),right:a()(rp.DoneMenuText,{}),onClickRight:()=>{e.close()}}:{menuType:at.og.Popup,width:230,maxHeight:"50vh"},l[t_](lt.Z,t,a()(Wt.Z,{type:Wt.i[Jk],sections:h,[Yk]:0,onAccept:()=>{e.close()}}))},renderOrigin:e=>l[t_](E.Z,s()({title:a()(u.FormattedMessage,{id:e_,[o_]:"For pages in"}),showChevron:!0,right:_,rightStyle:{[Xk]:1},rotateChevron:b.state.open,[u_]:n,textWrapperStyle:S.menuItemTextWrapper},e))})}function g_(e){window.__c={n:"AutomationSourceCaption"};const{pointer:t,[c_]:o,intl:i}=e,n=(0,C.O7)(),r=(0,T.yK)((e=>({warningIcon:{width:16,height:"auto",color:e.accentColors.orange[400]},[Wk]:{display:"flex",[qk]:"row",[Hk]:zk,padding:0,gap:4,flex:"1 1 auto",minWidth:0},title:{..._.Z.textOverflowStyle}})),[]),s=(0,P.VK)((()=>{if(t.table!==Us.v)return zs.Xr[r_](o,t)}),[o,t]),l=(0,P.VK)((()=>{const e=t.table===Gs.n&&s?s:o;return(0,Nc.vU)({[a_]:n,intl:i,store:e})}),[o,s,i,t.table,n]),d=(0,P.VK)((()=>{if(t.table===Us.v||!s)return!1;const e=o.getSchema();return(0,k.isDefined)(Sd({[Qk]:s,collectionSchema:e}))}),[o,s,t.table]);return a()("div",{style:r[Wk]},void 0,d&&A.Z[Gk](r.warningIcon),a()("span",{style:r.title},void 0,l))}function y_(e){window.__c={n:"CollectionViewCaption"};const{[n_]:t,[Qk]:o,intl:i,collectionSchema:n,referencesIncompatibleProperties:r}=e,s=(0,C.O7)(),l=(0,P.VK)((()=>!o.getAlive()),[o]),d=(0,P.VK)((()=>{const e=o.getParentBlockStore();if(e)return t.id!==e.id?(0,Nc.vU)({[a_]:s,intl:i,store:e}):void 0}),[t.id,o,i,s]),c=(0,P.VK)((()=>{const e=o.getQuery(n);return(0,Ps.OH)({propertyFilters:o.getPropertyFiltersStore().getValue()??[],combinatorFilter:null==e?void 0:e[l_],schema:n}).reduce(((e,t)=>{if((0,Ps.aN)(t))return e+1;return e+(t.filters??[]).length}),0)}),[n,o]);return a()(u.FormattedMessage,r?{id:"AutomationCollectionSelectMenu.collectionView.unsupportedView",[o_]:"Not supported"}:l?{id:"AutomationCollectionSelectMenu.collectionView.deletedView",[o_]:"<emphasis>View not found.</emphasis>",values:{emphasis:e=>a()("em",{},void 0,e)}}:d?{id:"AutomationCollectionSelectMenu.collectionView.captionDifferentParent",[o_]:"<emphasis>View configured in {externalParentBlockName}</emphasis>",values:{emphasis:e=>a()("em",{},void 0,e),externalParentBlockName:d}}:0===c?{id:"AutomationCollectionSelectMenu.collectionView.captionWithNoFilters",[o_]:"Any page in view"}:{id:"AutomationCollectionSelectMenu.collectionView.captionWithFilters",[o_]:Ok,values:{ruleCount:c}})}const f_=o(85).OtN,v_=o(85).WLo,h_=o(85).nx5,S_=o(85)._tz,b_=o(85).ewQ,w_=o(85).fOf;function C_(e){window.__c={n:"DeletedPropertyStep"};const{propertyId:t,disabled:o,collectionStore:i,onClick:n}=e,r=(0,T.Fg)(),s="light"===r.mode?50:200,l="light"===r.mode?700:900,d=(0,T.yK)((e=>{const t="light"===e.mode?400:800;return{[w_]:{color:e[b_].orange[t]}}}),[]),c=(0,P.VK)((()=>i.getDeletedSchema()[t]),[i,t]);return a()(yu,{disabled:o,icon:e=>A.Z[w_]({...e,...d[w_]}),title:a()(hu.Z,{format:hu.l.Medium,value:a()(u.FormattedMessage,{id:"deletedPropertyStep.deletedProperty.title",[h_]:"{propertyName} property deleted",values:{[S_]:null==c?void 0:c.name}}),theme:r,isSingle:!0,[f_]:r[b_][v_][s],color:r[b_][v_][l]}),onClick:n})}const P_=o(85).D7I,T_=o(85).nx5,A_=o(85).rpY,k_=o(85).paz;function __(e){window.__c={n:"AutomationDeletedPropertyMenu"};const{stepType:t,onDelete:o,onViewDeletedProperties:i}=e,n=(0,Lc.F)({width:266}),r=(0,C.Fy)().isMobile,d=(0,T.yK)((e=>({icon:{width:r?"12px":"16px",height:"auto",color:e.accentColors.gray[600]},[k_]:{fontSize:"14px",fontWeight:400}})),[r]);return l[P_](lt.Z,n,a()(Wt.Z,{type:Wt.i.Vertical,sections:[{key:"actions-section",items:[{key:"view-deleted-properties",action:()=>{i()},[A_]:e=>l[P_](Nt.Z,s()({},e,{title:a()("span",{style:d[k_]},void 0,a()(u.FormattedMessage,{id:"automationDeletedPropertyMenu.viewDeletedProperties.title",[T_]:"View deleted properties"})),icon:A.Z.undo(d.icon)}))},{key:"delete-action",action:()=>{o()},[A_]:e=>l[P_](Nt.Z,s()({},e,{title:a()("span",{style:d[k_]},void 0,a()(u.FormattedMessage,"action"===t?{id:"automationDeletedPropertyMenu.deleteAction.title",[T_]:"Delete action"}:{id:"automationDeletedPropertyMenu.deleteTrigger.title",[T_]:"Delete trigger"})),icon:A.Z.trash(d.icon)}))}],[A_]:e=>l[P_](j.Z,e)}],initialFocus:0}))}const M_=o(85).Q9F,x_=o(85).yTG,Z_=o(85).qYR,I_=o(85).d99,D_=o(85).D7I,F_=o(85).Yzm,V_=o(85).iIv,B_=o(85).nx5,E_=o(85).A4A,K_=(0,u.defineMessages)({[E_]:{id:"automationEventTriggerMenu.searchInputPlaceholder.label",[B_]:"Search for trigger‚Ä¶"},pageAddedCopy:{id:"automationEventTriggerMenu.pageAdded.title",[B_]:"Page added"},pagePropertiesEditedCopy:{id:"automationEventTriggerMenu.anyPropertyEdited.title",[B_]:"Any property"}});function R_(e){window.__c={n:"AutomationEventTriggerMenu"};const{automationStore:t,automationTriggerMenuStore:o,collectionStore:i,updateCurrentState:n,[V_]:r}=e,d=(0,T.Fg)(),c=(0,u.useIntl)(),[p,m]=l.useState(""),g=(0,P.VK)((()=>i.getSchema()),[i]),y=(0,P.VK)((()=>t.getTrigger()),[t]),f=(0,P.VK)((()=>("event"===(null==y?void 0:y.type)||"notification_event"===(null==y?void 0:y.type))&&y.event.pagesAdded),[y]),v=(0,P.VK)((()=>(0,Cs._X)({collectionFormat:i.getFormat(),collectionSchema:g})),[i,g]),h=Cd({collectionSchema:g,propertyIds:v,searchTerm:p}),S=(0,T.yK)((e=>({propertyIcon:{width:16,height:16,color:e.mediumIconColor}})),[]),b=(0,Lc.F)({maxHeight:"50vh",width:266}),w=a()(Ot.ZP,{focus:!0,style:{marginTop:12,marginBottom:6},value:p,onChange:e=>{m(e.target.value)},placeholder:c[F_](K_[E_])}),C=f?void 0:function(e){const{intl:t,searchInput:o,updateCurrentState:i,[V_]:n,styles:a}=e,r=t[F_](K_.pageAddedCopy);if(!Ft().test(o,r))return;return{key:"page_added_section",items:[{key:"page_added",action:()=>{i({type:I_,trigger:{type:"page_added"}}),n()},render:e=>l[D_](Nt.Z,s()({},e,{icon:A.Z.plus(a.propertyIcon),title:r}))}],render:e=>l[D_](j.Z,e)}}({intl:c,searchInput:p,updateCurrentState:n,[V_]:r,styles:S}),_=(0,P.VK)((()=>function(e){const{automationTriggerValue:t,automationTriggerMenuStore:o,showTopBorder:i,properties:n,collectionSchema:r,theme:d,updateCurrentState:c,[V_]:p,intl:m,searchInput:g,styles:y}=e,f=m[F_](K_.pagePropertiesEditedCopy);let v=!1,h=[];"event"!==(null==t?void 0:t.type)&&"notification_event"!==(null==t?void 0:t.type)||(v="any"===t.event[Z_].type,h="some"===t.event[Z_].type?t.event[Z_].some:[]);const S=[v||!Ft().test(g,f)?void 0:{key:"any_property_edited",action:async()=>{await async function(e){const{hasSpecificPropertyChangedFilters:t}=e;if(!t)return!0;return await tt.confirmUserAction({message:a()(u.FormattedMessage,{id:"automations.eventTriggerMenu.replaceTriggerConfirmation.message",[B_]:"Replace other triggers?"}),description:a()(u.FormattedMessage,{id:"automations.eventTriggerMenu.replaceTriggerConfirmation.description",[B_]:"Adding the 'Any property edited' trigger will replace all other property triggers."}),acceptLabel:a()(u.FormattedMessage,{id:"automations.eventTriggerMenu.replaceTriggerConfirmation.acceptLabel",[B_]:"Replace"})})}({hasSpecificPropertyChangedFilters:h.length>0})&&(c({type:I_,trigger:{type:x_}}),p())},render:e=>l[D_](Nt.Z,s()({},e,{icon:A.Z.pencil(y.propertyIcon),title:f}))},...n.map((e=>{if(!h.find((t=>t.property===e)))return function(e){const{automationTriggerMenuStore:t,propertyId:o,collectionSchema:i,theme:n,updateCurrentState:r,[V_]:d}=e,c=i[o];if(!c)return;const u=(0,Cs.bD)(c);return{key:o,action:()=>{u?t.pushSettingsItem({type:"propertyChangedFilter",property:o}):(r({type:I_,trigger:{type:"property_changed",property:o,filter:{operator:"changes_to_any"}}}),d())},render:e=>l[D_](Nt.Z,s()({},e,{icon:a()(As.ZP,{icon:c.icon,type:c.type,size:16,theme:n}),title:c.name,right:u?A.Z[M_]({marginLeft:6,width:12,height:"auto"}):void 0}))}}({propertyId:e,collectionSchema:r,theme:d,updateCurrentState:c,automationTriggerMenuStore:o,[V_]:p})})).filter(k.isDefined)].filter(k.isDefined);if(0===S.length)return;return{key:"page_properties_edited_section",items:S,render:e=>l[D_](j.Z,s()({},e,{topBorder:i,title:a()(u.FormattedMessage,{id:"automationEventTriggerMenu.pagePropertiesEditedSection.title",[B_]:"Page property edited"})}))}}({automationTriggerValue:y,automationTriggerMenuStore:o,showTopBorder:Boolean(C),properties:h,collectionSchema:g,theme:d,updateCurrentState:n,[V_]:r,searchInput:p,intl:c,styles:S})),[y,o,C,h,g,d,n,r,p,c,S]),M=l.useMemo((()=>{const e=[C,_].filter(k.isDefined);return 0===e.length?[{key:"none",items:[{key:"none-item",action:()=>{},render:e=>l[D_](Nt.Z,s()({},e,{disabled:!0,disabledFeedback:!0,title:a()(u.FormattedMessage,{id:"automations.eventTriggerMenu.noResultsItem",[B_]:"No results"})}))}],render:e=>l[D_](j.Z,e)}]:e}),[C,_]);return l[D_](lt.Z,s()({},b,{header:w}),a()(Wt.Z,{type:Wt.i.Vertical,sections:M,initialFocus:0}))}var N_=o(19777),O_=o(12508),W_=o(47082);const U_=o(85)._tz,G_=(o(85).jNN,o(85).Fs7,o(85).PG2),L_=o(85).D7I,z_=o(85).nx5,H_=o(85).Yzm,q_=o(85).KOz,j_=o(85).OBh,Q_=o(85).ejZ;function $_(e){window.__c={n:"AutomationSelectPropertyChangedFilterMenu"};const{[Q_]:t,updateCurrentState:o,automationTriggerMenuStore:i,[j_]:n,propertyChangedFilter:r,onClose:d}=e,{isMobile:c,isAndroid:p}=(0,C.Fy)(),m=(0,u.useIntl)(),g=(0,P.VK)((()=>{if("changes_to_any"===r.operator){return(n[q_]??[]).map((e=>({type:"exact",value:e.value})))}return((0,Ps.dx)(r)||(0,Ps.NU)(r))&&(0,Ps.vR)(r)?Array.isArray(r.value)?r.value:[r.value]:[]}),[n,r]),[y,f]=l.useState(g),v=(0,P.VK)((()=>function(e){const{[j_]:t,selectedOptions:o}=e;let i=!1,n=!0;const a=t[q_]??[];for(const r of a){const e=o.some((e=>e.value===r.value));i||=e,n&&=e}return!!n||!!i&&"partial"}({[j_]:n,selectedOptions:y})),[n,y]),h=l.useMemo((()=>(n[q_]??[]).map((e=>({type:"exact",value:e.value})))),[n]),S=l.useMemo((()=>"multi_select"===n.type?{operator:"enum_contains",value:y}:"select"===n.type?{operator:"enum_is",value:y}:(0,k.unreachable)(n)),[n,y]),b=!0===v?[]:y.map((e=>{if(!e.value||!n[q_])return;const t=(0,Ts.matchSelectOption)(n[q_],e.value);return t?a()(Su.a,{format:c?hu.l.Large:hu.l.Small,isSingle:!1,value:t.value,color:t.color,showRemoveButton:!0,onClickRemove:()=>{const t=se().without(y,e);f(t)}},t.id):void 0})),[w,T]=l.useState(""),A=(0,N_.I4)({query:w,[j_]:n,selectedValues:y,updateValue:e=>{T(""),f(e)},isMobile:c,styles:{}}),_=[{key:"search",items:[{key:"input",action:()=>{},render:e=>l[L_](W_.Z,s()({},e,{focusInitial:!0,[G_]:void 0,focusAfterAnimation:!0,format:W_.Z.Format.FilterValue,tokens:b,placeholder:v?m[H_]({[z_]:"Any option",id:"automations.selectPropertyChangedFilter.inputPlaceholder.anyOption"}):m[H_]({[z_]:"Select one or more options‚Ä¶",id:"automations.selectPropertyChangedFilter.inputPlaceholder.searchPlaceholder"}),onRemoveLastToken:()=>{const e=y.slice(0,y.length-1);f(e)},onClearButtonClick:()=>{f([]),d()},value:w,onChange:e=>{T(e.target.value)},dontShowBorderBottom:p,showClearButton:!0}))}],render:e=>l[L_](j.Z,e)},{key:"any",items:[{key:"any-option-item",action:()=>{!0===v?f([]):!1===v||"partial"===v?f(h):(0,k.unreachable)(v),T("")},render:e=>l[L_](Nt.Z,s()({},e,{icon:a()(O_.Z,{checked:v,size:14,[G_]:e[G_]}),title:a()(u.FormattedMessage,{id:"automations.selectPropertyChangedFilter.anyOption.title",[z_]:"Any option"})}))}],render:e=>l[L_](j.Z,s()({},e,{topBorder:!0}))},A.length>0?{key:"items",items:A,render:e=>l[L_](j.Z,s()({},e,{topBorder:!0}))}:void 0].filter(k.isDefined);return a()(mp,{type:"default",automationTriggerActionMenuStore:i,onDone:()=>{yd({anyOptionCheckState:v,[Q_]:t,updateCurrentState:o,currentFilter:S}),d()},onClose:d,sections:_,headerTitle:a()(u.FormattedMessage,{id:"automations.propertyChangedFilterHeader.select.title",[z_]:"{propertyName} set to",values:{[U_]:n.name}})})}const X_=o(85)._tz,Y_=(o(85).jNN,o(85).D7I),J_=o(85).nx5,eM=(o(85).Fs7,o(85).PG2),tM=o(85).SKl,oM=o(85).OBh,iM=o(85).ejZ;function nM(e){window.__c={n:"AutomationStatusPropertyChangedFilterMenu"};const{[iM]:t,updateCurrentState:o,automationTriggerMenuStore:i,[oM]:n,propertyChangedFilter:r,onClose:d}=e,{isMobile:c}=(0,C.Fy)(),p=(0,P.VK)((()=>{if("changes_to_any"===r.operator){return(n.groups??[]).map((e=>({type:"is_group",value:e.name})))}return(0,Ps.r2)(r)&&(0,Ps.vR)(r)?Array.isArray(r.value)?r.value:[r.value]:[]}),[n,r]),[m,g]=l.useState(p),y=(0,P.VK)((()=>function(e){const{[oM]:t,selectedStatusOptions:o}=e;let i=!1,n=!0;const a=t.groups??[],r=t.options??[];for(const s of a){const e=aM({group:s,options:r,selectedStatusOptions:o});i||=!1!==e,n&&=!0===e}return!!n||!!i&&"partial"}({[oM]:n,selectedStatusOptions:m})),[n,m]),f=l.useMemo((()=>(n.groups??[]).map((e=>({type:"is_group",value:e.name})))),[n]),v=(0,N_.Sm)({[oM]:n,statusFilterValues:m,updateValue:e=>{g(e)},isMobile:c,styles:{}});return a()(mp,{type:"default",automationTriggerActionMenuStore:i,onDone:()=>{yd({anyOptionCheckState:y,[iM]:t,updateCurrentState:o,currentFilter:{operator:tM,value:m}}),d()},onClose:()=>{d()},sections:[{key:"any",items:[{key:"any-option-item",action:()=>{!0===y?g([]):!1===y||"partial"===y?g(f):(0,k.unreachable)(y)},render:e=>l[Y_](Nt.Z,s()({},e,{icon:a()(O_.Z,{checked:y,size:14,[eM]:e[eM]}),title:a()(u.FormattedMessage,{id:"automationEventTriggerPropertyChangedFilterMenu.anyOption.title",[J_]:"Any option"})}))}],render:e=>l[Y_](j.Z,e)},{key:"items",items:v,render:e=>l[Y_](j.Z,s()({},e,{topBorder:!0}))}],headerTitle:a()(u.FormattedMessage,{id:"automations.propertyChangedFilterHeader.status.title",[J_]:"{propertyName} set to",values:{[X_]:n.name}})})}function aM(e){const{group:t,options:o,selectedStatusOptions:i}=e,n=i.some((e=>"is_group"===e.type&&e.value===t.name)),a=o.filter((e=>{var o;return null===(o=t.optionIds)||void 0===o?void 0:o.includes(e.id)}));let r=!1,s=!0;for(const l of a){const e=i.some((e=>"is_option"===e.type&&e.value===l.value));r||=e,s&&=e}return!(!n&&!s)||!!r&&"partial"}const rM=o(85).OBh,sM=o(85).qYR,lM=o(85).ejZ;function dM(e){window.__c={n:"AutomationEventTriggerPropertyChangedFilterMenu"};const{automationStore:t,[lM]:o,automationTriggerMenuStore:i,collectionStore:n,updateCurrentState:r,onClose:s}=e,l=(0,P.VK)((()=>n.getSchema()),[n])[o],d=(0,P.VK)((()=>t.getTrigger()),[t]);let c=[];"event"!==(null==d?void 0:d.type)&&"notification_event"!==(null==d?void 0:d.type)||(c="some"===d.event[sM].type?d.event[sM].some:[]);const u=c.find((e=>e.property===o))??{property:o,filter:{operator:"changes_to_any"}};if(!l)return null;return(0,Cs.bD)(l)?"multi_select"===l.type||"select"===l.type?a()($_,{[lM]:o,updateCurrentState:r,automationTriggerMenuStore:i,[rM]:l,propertyChangedFilter:u.filter,onClose:s}):"status"===l.type?a()(nM,{[lM]:o,updateCurrentState:r,automationTriggerMenuStore:i,[rM]:l,propertyChangedFilter:u.filter,onClose:s}):null:null}const cM=o(85).oWD,uM=o(85).EQe;function pM(e){window.__c={n:"AutomationTriggerMenuController"};const{[uM]:t,[cM]:o,initialState:i,updateCurrentAutomationState:n,buttonPopupParent:r}=e,s=(0,P.VK)((()=>{const e=new op;return e.setState({stack:[i]}),e}),[i]),d=(0,P.VK)((()=>s.getCurrentTab()),[s]),c=(0,l.useCallback)((()=>r.close()),[r]);return d?"eventTriggers"===d.type?a()(R_,{[uM]:t,automationTriggerMenuStore:s,[cM]:o,updateCurrentState:n,onClose:c}):"propertyChangedFilter"===d.type?a()(dM,{[uM]:t,propertyId:d.property,automationTriggerMenuStore:s,[cM]:o,updateCurrentState:n,onClose:c}):(0,k.unreachable)(d):null}const mM=o(85).OBh,gM=o(85).D7I,yM=o(85).qYR,fM=o(85).PG2,vM=o(85).Wp_,hM=o(85).dMt,SM=o(85).yTG,bM=o(85).mUE,wM=o(85).eiN,CM=o(85).ffk,PM=o(85).oZp,TM=o(85).oNU,AM=o(85).lu6,kM=o(85).pkR,_M=o(85).oWD,MM=o(85).EQe;function xM(e){window.__c={n:"AutomationTriggerList"};const{[MM]:t,[_M]:o,[kM]:i,handleNavigateToDeletedProperties:n,updateCurrentState:r}=e,d=(0,u.useIntl)(),c=(0,zc.d)(),p=(0,P.VK)((()=>o.getSchema()),[o]),m=(0,P.VK)((()=>t.getTriggerStore().getKeyStore("event").getValue()),[t]),g=(0,l.useCallback)((e=>{r({type:AM,[TM]:{type:PM,[CM]:e,[wM]:{[bM]:"changes_to_any"}}})}),[r]),y=(0,l.useCallback)((()=>{r({type:AM,[TM]:{type:"page_added"}})}),[r]),f=(0,l.useCallback)((()=>{r({type:AM,[TM]:{type:SM}})}),[r]),v=(0,T.yK)((e=>({stepList:{border:`1px solid ${e[hM]}`,borderRadius:6,listStyle:"none",margin:0,overflow:"hidden",padding:0},semiBoldTitle:{fontWeight:_.Z.fontWeight.semibold},stepItemWithBorderTop:{borderTop:`1px solid ${e[hM]}`}})),[]),h=[];return null!=m&&m.pagesAdded&&h.push(a()(yu,{[kM]:i,[fM]:e=>{e[vM]({open:!0})},icon:A.Z.plus,title:a()("div",{style:v.semiBoldTitle},void 0,Nd(d)),onDelete:y},"page_added_trigger")),"any"===(null==m?void 0:m[yM].type)&&h.push(a()(yu,{[kM]:i,[fM]:e=>{e[vM]({open:!0})},icon:A.Z.pencil,title:a()("div",{style:v.semiBoldTitle},void 0,Od(d)),onDelete:f},"any_page_property_edited_trigger")),"some"===(null==m?void 0:m[yM].type)&&h.push(...m[yM].some.map((e=>{const{[CM]:d,[wM]:u}=e,m=p[d];return m?"status"!==m.type||"changes_to_any"!==u[bM]&&!(0,Ps.r2)(u)?"select"!==m.type||"changes_to_any"!==u[bM]&&!(0,Ps.dx)(u)?"multi_select"!==m.type||"changes_to_any"!==u[bM]&&!(0,Ps.NU)(u)?"changes_to_any"===u[bM]?a()(Cu,{[kM]:i,[fM]:e=>{e[vM]({open:!0})},[mM]:m,onDelete:()=>{g(d)}},`changes_to_any_${d}_trigger`):void 0:a()(ZM,{[CM]:d,[MM]:t,[_M]:o,updateCurrentState:r,renderOrigin:e=>{let{[fM]:t}=e;return a()(Vu,{[kM]:i,[wM]:u,[mM]:m,onEdit:t,onDelete:()=>{g(d)}})}},`changes_to_any_${d}_trigger`):a()(ZM,{[CM]:d,[MM]:t,[_M]:o,updateCurrentState:r,renderOrigin:e=>{let{[fM]:t}=e;return a()(Vu,{[kM]:i,[wM]:u,[mM]:m,onEdit:t,onDelete:()=>{g(d)}})}},`changes_to_any_${d}_trigger`):a()(ZM,{[MM]:t,[CM]:d,[_M]:o,updateCurrentState:r,renderOrigin:e=>{let{[fM]:t}=e;return a()(_u,{[kM]:i,[wM]:u,[mM]:m,onEdit:t,onDelete:()=>{g(d)}})}},`changes_to_any_${d}_trigger`):a()(st.ZP,{alignmentToOrigin:st.vR.Center,placementToOrigin:st.pO.Bottom,popupType:c,render:()=>a()(__,{stepType:TM,onDelete:()=>{r({type:AM,[TM]:{[wM]:u,[CM]:d,type:PM}})},onViewDeletedProperties:n}),renderOrigin:e=>l[gM](C_,s()({},e,{[kM]:i,propertyId:d,[_M]:o}))},`deleted_property_${d}_trigger`)}))[wM](k.isDefined)),a()("ul",{style:v.stepList},void 0,h.map(((e,t)=>a()("li",{style:0===t?{}:v.stepItemWithBorderTop},t,e))))}function ZM(e){window.__c={n:"AdvancedTriggerPopup"};const{[MM]:t,renderOrigin:o,[_M]:i,[CM]:n,updateCurrentState:r}=e,s=(0,zc.d)();return a()(st.ZP,{popupType:s,renderOrigin:o,render:e=>a()(pM,{[MM]:t,[_M]:i,initialState:{type:"propertyChangedFilter",[CM]:n},updateCurrentAutomationState:r,buttonPopupParent:e})})}var IM=o(89733),DM=o(30950),FM=o(87494),VM=o(68214);const BM=o(85).ChN,EM=o(85).I8C,KM=o(85).Dd5,RM=o(85).XZb,NM=o(85).pkR,OM=o(85).oWD,WM=o(85).EQe,UM=o(85).D7I,GM=o(85).RnF,LM=o(85).U$G,zM=o(85).Gpy,HM=o(85).v1$;function qM(e){window.__c={n:"CreatePageActionDatabaseAutomation"};const{actionStore:t,updateCurrentAutomationState:o}=e,i=t.id,n=(0,P.VK)((()=>t.getConfig()),[t]),a=(0,l.useCallback)((e=>{o({action:{config:{...n,collection:e,[HM]:["title"],[zM]:{}},id:i,type:LM},type:GM})}),[i,n,o]),r=(0,l.useCallback)(((e,t)=>{o({action:{config:{...n,[HM]:e,[zM]:t},id:i,type:LM},type:GM})}),[i,n,o]),d=(0,l.useCallback)((()=>{o({action:{config:n,id:i,type:LM},type:"remove_action"})}),[n,i,o]);return l[UM](jM,s()({},e,{onConfigChange:r,onDelete:d,onTargetCollectionChange:a}))}function jM(e){window.__c={n:"CreatePageActionV2"};const{actionStore:t,[WM]:o,[OM]:i,[NM]:n,onConfigChange:r,onDelete:s,onTargetCollectionChange:d}=e,{isMobile:c}=(0,C.Fy)(),u=(0,l.useRef)(null),p=(0,ve.X)(u),m=(0,DM.a)(p),[g,y,f]=(0,P.VK)((()=>{const e=t.getConfig();return[null==e?void 0:e.collection,null==e?void 0:e[HM],null==e?void 0:e[zM]]}),[t]),v=(0,P.VK)((()=>{if(g)return zs.NW.createChildStore(i,g)}),[i,g]),h=Gc({[WM]:o,[OM]:i}),S=(0,P.qz)(void 0,ou.Z),b=(0,l.useMemo)((()=>({[zM]:f??{},[HM]:y??[]})),[f,y]),w=(0,l.useCallback)((e=>{d&&d(e)}),[d]),k=(0,l.useCallback)((e=>{const t=b[HM].concat([e]);r(t,b[zM])}),[r,b]),_=(0,l.useCallback)(((e,t)=>{const o=b[HM].indexOf(e);if(-1===o)return;const i=b[HM].slice(0);i[o]=t;const n={...b[zM],[t]:void 0};r(i,n)}),[r,b]),M=(0,l.useCallback)((e=>{const t=b[HM].filter((t=>t!==e)),o={...b[zM],[e]:void 0};r(t,o)}),[r,b]),x=(0,l.useCallback)(((e,t)=>{const o={...b[zM],[e]:t};r(b[HM],o)}),[r,b]),Z=(0,l.useCallback)((e=>{IM.handleMouseEnter({store:S,event:e,[NM]:n})}),[S,n]),I=(0,l.useCallback)((e=>{IM.handleMouseMove({store:S,event:e,[NM]:n,isMobile:c})}),[S,n,c]),D=(0,l.useCallback)((e=>{IM.handleMouseLeave({store:S,event:e,[NM]:n})}),[S,n]),F=(0,T.yK)((e=>({sectionWrap:{display:"flex",flexDirection:"column",gap:m?12:16,paddingBlock:12,paddingInline:12},[RM]:{alignItems:"center",display:"flex",flexWrap:"nowrap"}})),[m]);return h?l[UM]("section",{onMouseEnter:Z,onMouseLeave:D,onMouseMove:I,ref:u,style:F.sectionWrap},a()($M,{[NM]:n,icon:A.Z.plus({width:14}),[EM]:S,onDelete:s},void 0,a()("div",{style:F[RM]},void 0,a()(QM,{actionStore:t,automationContextStore:h,[NM]:n,[KM]:w,value:g}))),v&&a()(FM.v,{actionId:t.id,[OM]:v,config:b,contextStore:h,[NM]:n,onPropertyAdd:k,onPropertyChange:_,onPropertyRemove:M,onPropertyValueChange:x,showSetPropertyActions:!1})):null}function QM(e){const{automationContextStore:t,[NM]:o,[KM]:i,value:n}=e;return a()(u.FormattedMessage,{defaultMessage:"<span>Add <b>page</b> to </span>{collectionPicker}",id:"automations.CreatePageActionV2.header.title",[zM]:{b:e=>a()("b",{style:{[BM]:_.Z[BM].medium}},void 0,e),collectionPicker:a()(VM.a,{contextStore:t,currentValue:n,[NM]:o,[KM]:i}),span:e=>a()("span",{style:{flex:"0 0 auto"}},void 0,e)}})}function $M(e){window.__c={n:"ActionHeader"};const{children:t,[NM]:o,icon:i,[EM]:n,onDelete:r}=e,[s,d]=eu(),c=(0,P.qz)(n,ou.Z),u=(0,P.VK)((()=>c.getState()),[c]),p=!o&&(u.hovered||d),m=(0,T.yK)((()=>({wrap:{alignItems:"center",cursor:o?"default":void 0,opacity:o?.4:void 0,display:"flex",gap:6,minHeight:28},iconWrap:{flex:"0 0 auto"},titleWrap:{flex:"1 1 auto",fontSize:14,lineHeight:1.4,minWidth:0},moreButtonWrap:{flex:"0 0 26px"}})),[o]);return l[UM]("header",{ref:s,style:m.wrap},i&&a()("div",{style:m.iconWrap},void 0,i),a()("div",{style:m.titleWrap},void 0,t),a()("div",{style:m.moreButtonWrap},void 0,p&&a()(fu,{[NM]:o,onDelete:r})))}var XM=o(43690),YM=o(85740),JM=o(80117);const ex=o(85).H9Y,tx=o(85).O_,ox=(o(85).LOX,o(85).Taj),ix=o(85).nx5,nx=o(85).f4X,ax=o(85).jms,rx=o(85).rOg,sx=o(85).QKR,lx=o(85).I8C,dx=o(85).BQ6,cx=o(85).Dd5,ux=o(85).jkI,px=o(85).H1U,mx=o(85).XZb,gx=o(85).sM5,yx=o(85).eiN,fx=o(85).uKy,vx=o(85).pkR,hx=o(85).oWD,Sx=o(85).EQe,bx=o(85).D7I,wx=o(85).RnF,Cx=o(85).axF,Px=o(85).Gpy,Tx=o(85).v1$,Ax=o(85).FH8;function kx(e){window.__c={n:"UpdatePagesActionDatabaseAutomation"};const{actionStore:t,updateCurrentAutomationState:o}=e,i=t.id,n=(0,P.VK)((()=>t.getConfig()),[t]),a=(0,l.useCallback)((e=>{var t;const a="collection"===e.type&&"collection"===(null==n||null===(t=n.target)||void 0===t?void 0:t.type)&&e[Ax].id!==(null==n?void 0:n.target[Ax].id);o({action:{config:{...n,target:e,[Tx]:a?["title"]:(null==n?void 0:n[Tx])??[],[Px]:a?{}:(null==n?void 0:n[Px])??{}},id:i,type:Cx},type:wx})}),[n,i,o]),r=(0,l.useCallback)(((e,t)=>{o({action:{config:{...n,[Tx]:e,[Px]:t},id:i,type:Cx},type:wx})}),[i,n,o]),d=(0,l.useCallback)((()=>{o({action:{config:n,id:i,type:Cx},type:"remove_action"})}),[n,i,o]);return l[bx](_x,s()({},e,{onConfigChange:r,onDelete:d,onTargetChange:a}))}function _x(e){window.__c={n:"UpdatePagesActionV2"};const{actionStore:t,[Sx]:o,[hx]:i,[vx]:n,onConfigChange:r,onDelete:s,onTargetChange:d}=e,{isMobile:c}=(0,C.Fy)(),u=(0,l.useRef)(null),p=(0,ve.X)(u),m=(0,DM.a)(p),g=(0,Bs.z)(Cx),[y,f,v]=(0,P.VK)((()=>{const e=t.getConfig();return[null==e?void 0:e.target,null==e?void 0:e[Tx],null==e?void 0:e[Px]]}),[t]),h=(0,P.VK)((()=>{if("collection"===(null==y?void 0:y.type))return zs.NW.createChildStore(i,null==y?void 0:y[Ax])}),[i,y]),S=(0,P.VK)((()=>{if((0,k.isDefined)(h))return h[fx]()}),[h]),b=(0,P.VK)((()=>{if("collection"!==(null==y?void 0:y.type))return;const e=y[yx];return(0,k.isDefined)(e)?(0,XM.getNormalizedFilter)(e,(null==h?void 0:h.getSchema())??{}):void 0}),[y,h]),w=Gc({[Sx]:o,[hx]:i}),A=(0,P.qz)(void 0,ou.Z),_=(0,l.useMemo)((()=>({[Px]:v??{},[Tx]:f??[]})),[v,f]),M=(0,l.useCallback)((e=>{(0,k.isDefined)(y)&&"collection"===y.type&&y[Ax].id!==e.id&&d({[Ax]:e,type:Ax})}),[y,d]),x=(0,l.useCallback)((e=>{(0,k.isDefined)(y)&&"collection"===y.type&&(se().isEqual(y[yx],e)||d({...y,[yx]:e}))}),[y,d]),Z=(0,l.useCallback)((e=>{const t=_[Tx].concat([e]);r(t,_[Px])}),[r,_]),I=(0,l.useCallback)(((e,t)=>{const o=_[Tx].indexOf(e);if(-1===o)return;const i=_[Tx].slice(0);i[o]=t;const n={..._[Px],[t]:void 0};r(i,n)}),[r,_]),D=(0,l.useCallback)((e=>{const t=_[Tx][yx]((t=>t!==e)),o={..._[Px],[e]:void 0};r(t,o)}),[r,_]),F=(0,l.useCallback)(((e,t)=>{const o={..._[Px],[e]:t};r(_[Tx],o)}),[r,_]),V=(0,l.useCallback)((e=>{IM.handleMouseEnter({store:A,event:e,[vx]:n})}),[A,n]),B=(0,l.useCallback)((e=>{IM.handleMouseMove({store:A,event:e,[vx]:n,isMobile:c})}),[A,n,c]),E=(0,l.useCallback)((e=>{IM.handleMouseLeave({store:A,event:e,[vx]:n})}),[A,n]),K=(0,T.yK)((e=>({sectionWrap:{[gx]:"flex",flexDirection:"column",gap:m?12:16,paddingBlock:12,paddingInline:12},[mx]:{[px]:ux,[gx]:"flex",flexWrap:"wrap",minWidth:100,whiteSpace:"pre"}})),[m]);return w?l[bx]("section",{onMouseEnter:V,onMouseLeave:E,onMouseMove:B,ref:u,[dx]:K.sectionWrap},a()(Zx,{[vx]:n,icon:g[gx].icon({height:21,width:14}),[lx]:A,onDelete:s},void 0,a()("div",{[dx]:K[mx]},void 0,a()(Mx,{actionStore:t,automationContextStore:w,[vx]:n,[cx]:M,value:S})),(0,k.isDefined)(h)&&a()("div",{[dx]:K[mx]},void 0,a()(xx,{automationContextStore:w,[hx]:h,[vx]:n,[yx]:b,[cx]:x}))),h&&a()(FM.v,{actionId:t.id,[hx]:h,config:_,contextStore:w,[vx]:n,onPropertyAdd:Z,onPropertyChange:I,onPropertyRemove:D,onPropertyValueChange:F,showSetPropertyActions:!0})):null}function Mx(e){window.__c={n:"ActionTitle"};const{automationContextStore:t,[vx]:o,[cx]:i,value:n}=e,r=(0,T.yK)((()=>({b:{fontWeight:_.Z.fontWeight.medium},picker:{flex:"1 1 auto",[sx]:-5,minWidth:50},span:{[px]:ux,[gx]:rx,flex:"0 0 auto",[ax]:(0,YM.H)({})}})),[]);return a()(u.FormattedMessage,{[ix]:"<span>Update <b>pages</b> in </span>{collectionPicker}",id:"automations.UpdatePagesActionV2.header.title",[Px]:{b:e=>a()("b",{[dx]:r.b},void 0,e),collectionPicker:a()("div",{[dx]:r.picker},void 0,a()(VM.a,{contextStore:t,[nx]:n,[vx]:o,[cx]:i})),span:e=>a()("span",{[dx]:r.span},void 0,e)}})}function xx(e){window.__c={n:"CollectionFilterTitle"};const{automationContextStore:t,[hx]:o,[vx]:i,[yx]:n,[cx]:r}=e,s=(0,C.O7)(),l=(0,u.useIntl)(),d=(0,P.VK)((()=>(0,Nc.vU)({environment:s,intl:l,store:o})),[o,l,s]),c=(0,T.yK)((()=>({picker:{flex:"1 1 auto",[sx]:-5,minWidth:50},span:{[px]:ux,[gx]:rx,flex:"0 0 auto",[ax]:(0,YM.H)({})}})),[]);return a()(u.FormattedMessage,{[ix]:"<span>that match </span>{filterPicker}",id:"automations.UpdatePagesActionV2.header.filterTitle",[Px]:{filterPicker:a()("div",{[dx]:c.picker},void 0,a()(JM.W,{[hx]:o,contextStore:t,[vx]:i,[yx]:n,noFiltersMessage:(0,k.isDefined)(d)?a()(u.FormattedMessage,{[ix]:"All pages in {collectionName}",id:ox,[Px]:{[tx]:d}}):a()(u.FormattedMessage,{[ix]:"All pages in database",id:ex}),[cx]:r})),span:e=>a()("span",{[dx]:c.span},void 0,e)}})}function Zx(e){window.__c={n:"ActionHeader"};const{children:t,[vx]:o,icon:i,[lx]:n,onDelete:r}=e,{isMobile:s}=(0,C.Fy)(),[d,c]=eu(),u=(0,P.qz)(n,ou.Z),p=(0,P.VK)((()=>u.getState()),[u]),m=!o&&(s||p.hovered||c),g=(0,T.yK)((()=>({wrap:{[px]:"start",cursor:o?"default":void 0,opacity:o?.4:void 0,[gx]:"flex",gap:6,[ax]:28},iconWrap:{[px]:ux,[gx]:rx,flex:"0 0 auto",[ax]:(0,YM.H)({})},titleWrap:{[gx]:"flex",flex:"1 1 auto",flexWrap:"wrap",fontSize:14,lineHeight:1.4,minWidth:0},moreButtonWrap:{flex:"0 0 26px"}})),[o]);return l[bx]("header",{ref:d,[dx]:g.wrap},i&&a()("div",{[dx]:g.iconWrap},void 0,i),a()("div",{[dx]:g.titleWrap},void 0,t),a()("div",{[dx]:g.moreButtonWrap},void 0,m&&a()(fu,{[vx]:o,onDelete:r})))}const Ix=o(85).D7I,Dx=o(85).Qxx,Fx=o(85).rI1,Vx=o(85).sOA,Bx=o(85)._tz;function Ex(e){window.__c={n:"UpdateCheckboxPropertyAction"};const{disabled:t,onClick:o,onDelete:n,onEdit:r,propertySchema:s,value:d}=e,c=(0,T.yK)((()=>({content:{alignItems:"center",display:"flex"},[Bx]:{..._.Z.textOverflowStyle,fontWeight:_.Z.fontWeight.semibold}})),[]),p=(0,Ms.A6)(null==d?void 0:d.value)[0],m=s.name,g=!0===p?l[Ix](l.Fragment,null,A.Z.checkboxSquareChecked({display:Vx,marginInlineEnd:4,[Fx]:"middle",width:12}),l[Ix](u.FormattedMessage,i[Dx].actionCheckboxPropertyChecked)):l[Ix](l.Fragment,null,A.Z.checkboxSquare({display:Vx,marginInlineEnd:4,[Fx]:"middle",width:10}),l[Ix](u.FormattedMessage,i[Dx].actionCheckboxPropertyUnchecked)),y={[Bx]:a()("span",{style:c[Bx]},void 0,m),propertyValue:a()(bu.Z,{format:hu.l.Medium,isRound:!0,isSingle:!0,shouldShrink:!0,showRemoveButton:!1,value:g})};return a()(yu,{disabled:t,icon:A.Z.typesCheckbox,onClick:o,onDelete:n,onEdit:r,title:a()("div",{style:c.content},void 0,l[Ix](u.FormattedMessage,Td(y)))})}const Kx=o(85).ewQ,Rx=o(85).m3w,Nx=o(85).D7I,Ox=o(85).pHK,Wx=o(85)._tz,Ux=o(85).oWD,Gx=o(85).EQe;function Lx(e){window.__c={n:"UpdateDatePropertyAction"};const{[Gx]:t,[Ux]:o,disabled:n,onClick:r,onDelete:s,onEdit:d,propertySchema:c,value:p,valueContext:m}=e,g=(0,T.yK)((()=>({content:{alignItems:"baseline",display:"flex",flexWrap:"wrap",whiteSpace:"pre"},[Wx]:{..._.Z.textOverflowStyle,fontWeight:_.Z.fontWeight.semibold}})),[]),y=Gc({[Gx]:t,[Ux]:o});if(!y)return null;const f=a()("span",{style:g[Wx]},void 0,c.name),v=void 0===(null==p?void 0:p.value)?Ad({[Wx]:f}):i[Ox]({[Wx]:f,propertyValue:a()(zx,{automationContextStore:y,value:p,valueContext:m})});return a()(yu,{disabled:n,icon:A.Z.typesDate,onClick:r,onDelete:s,onEdit:d,title:a()("div",{style:g.content},void 0,l[Nx](u.FormattedMessage,v))})}function zx(e){window.__c={n:"DatesToken"};const{automationContextStore:t,value:o,valueContext:i}=e,n=(0,u.useIntl)(),r=(0,P.VK)((()=>Ld(t)),[t]),s=(0,P.VK)((()=>(0,pf._)(i)),[i]),d=(0,Ms.A6)(null==o?void 0:o.value)[0];if("string"==typeof d||"boolean"==typeof d||(0,Ds.isUserAnnotation)(d)||(0,Ds.isPageAnnotation)(d))return null;if((0,Ds.isFormulaContextValueMentionAnnotation)(d)){const e=(0,Ds.getFormulaContextValueAnnotationData)(d).id,t=(0,_s.vx)(r,e);return t?a()(uf.F,{value:t,format:hu.l.Medium,isSingle:!1,shouldShrink:!0}):null}if((0,Ds.isDateAnnotation)(d)){const e=(0,Ds.getDateAnnotationData)(d);return e?(0,ks.OB)({value:e,date_format:s.dateFormat,time_format:s.timeFormat,userTimeZone:(0,xs.r)(),allowRelativeDates:!0,intl:n,shortenDateAndRange:!0,[Rx]:!0,formatValuesFn:e=>{let{endDate:t,endTime:o,startDate:i}=e;return(0,k.isDefined)(o)?l[Nx](l.Fragment,null,a()(Hx,{value:i})," ‚Üí ",a()(Hx,{value:o})):(0,k.isDefined)(t)?l[Nx](l.Fragment,null,a()(Hx,{value:i})," ‚Üí ",a()(Hx,{value:t})):a()(Hx,{value:i})}}):null}(0,k.unreachable)(d)}function Hx(e){window.__c={n:"AutomationDateToken"};const{value:t}=e,o=(0,T.Fg)();return a()(bu.Z,{backgroundColor:o[Kx].gray[75],format:hu.l.Medium,isRound:!0,isSingle:!0,showRemoveButton:!1,style:{marginBlockEnd:4},value:t})}const qx=o(85).$wW,jx=o(85).D7I,Qx=o(85).Io9,$x=o(85).Uie,Xx=o(85)._tz,Yx=o(85).nSw,Jx=o(85).OBh;function eZ(e){window.__c={n:"UpdatePersonPropertyAction"};const{collectionStore:t,disabled:o,onClick:i,onDelete:n,onEdit:r,[Jx]:s,value:d}=e,c=(0,Ts.toPersonValue)({textValue:null==d?void 0:d.value,[Jx]:s}),p=(0,P.VK)((()=>c.map((e=>(0,bs.Hl)({pointer:e,[Yx]:t[Yx]})))),[t,c]),m=(0,T.yK)((()=>({content:{alignItems:"center",display:"flex",flexWrap:p.length>1?"wrap":"nowrap",whiteSpace:"pre"},[Xx]:{..._.Z[$x],fontWeight:_.Z.fontWeight.semibold},[Qx]:{..._.Z[$x],paddingBlockStart:4},propertyValueList:{display:"flex",flexBasis:"100%",flexDirection:"column",listStyle:"none",margin:0,marginBlockStart:10,padding:0,rowGap:4}})),[p]),g=a()("span",{style:m[Xx]},void 0,s.name),y=function(e){const{actors:t,styles:o}=e;return 1===t.length?a()("div",{style:o[Qx]},void 0,a()(Gg.ZP,{actor:t[0],showRemoveButton:!1,format:Gg.ZP.Format.Medium,[qx]:!1})):a()("ul",{style:o.propertyValueList},void 0,t.map(((e,t)=>a()("li",{},t,a()("div",{style:o[Qx]},t,a()(Gg.ZP,{actor:e,showRemoveButton:!1,format:Gg.ZP.Format.Medium,[qx]:!1}))))))}({actors:p,styles:m});let f;return f=0===p.length?_d({[Xx]:g}):1===p.length?Md({[Xx]:g,[Qx]:y}):xd({[Xx]:g,[Qx]:y}),a()(yu,{disabled:o,icon:A.Z.typesPerson,onClick:i,onDelete:n,onEdit:r,title:a()("div",{style:m.content},void 0,l[jx](u.FormattedMessage,f))})}const tZ=o(85).D7I,oZ=o(85)._tz,iZ=o(85).OBh;function nZ(e){window.__c={n:"UpdateSelectPropertyAction"};const{disabled:t,onClick:o,onDelete:i,onEdit:n,[iZ]:r,value:s}=e,d=(0,T.yK)((()=>({content:{alignItems:"baseline",display:"flex",flexWrap:"nowrap",whiteSpace:"pre"},[oZ]:{..._.Z.textOverflowStyle,fontWeight:_.Z.fontWeight.semibold}})),[]),c=null!=s&&s.value?(0,Ms.A6)(null==s?void 0:s.value)[0]:void 0;if(void 0!==c&&"string"!=typeof c)return null;const p=a()("span",{style:d[oZ]},void 0,r.name),m=void 0===c?Fd({[oZ]:p}):Vd({[oZ]:p,propertyValue:Eu({optionValues:[c],[iZ]:r})});return a()(yu,{disabled:t,icon:A.Z.typesSelect,onClick:o,onDelete:i,onEdit:n,title:a()("div",{style:d.content},void 0,l[tZ](u.FormattedMessage,m))})}const aZ=o(85).D7I,rZ=o(85).Io9,sZ=o(85)._tz,lZ=o(85).OBh;function dZ(e){window.__c={n:"UpdateStatusPropertyAction"};const{disabled:t,onClick:o,onDelete:i,onEdit:n,[lZ]:r,value:s}=e,d=(0,Ms.A6)(null==s?void 0:s.value)[0],c=(0,T.yK)((()=>({content:{alignItems:"baseline",display:"flex",flexWrap:"nowrap",whiteSpace:"pre"},[sZ]:{..._.Z.textOverflowStyle,fontWeight:_.Z.fontWeight.semibold}})),[]);if(!s||"string"!=typeof d)return null;const p=a()("span",{style:c[sZ]},void 0,r.name),m=xu({groupValues:[],optionValues:[d],[lZ]:r});return 0===m.length?null:a()(yu,{disabled:t,icon:A.Z.typesStatus,onClick:o,onDelete:i,onEdit:n,title:a()("div",{style:c.content},void 0,l[aZ](u.FormattedMessage,Ed({[sZ]:p,[rZ]:m})))})}const cZ=o(85).D7I,uZ=o(85).Uie,pZ=o(85)._tz;function mZ(e){window.__c={n:"UpdateBaseTextPropertyAction"};const{disabled:t,icon:o,onClick:i,onDelete:n,onEdit:r,propertySchema:s,value:d}=e,c=(0,Ms.A6)(null==d?void 0:d.value)[0]??(0,Ds.getText)(null==d?void 0:d.value),p=(0,T.yK)((()=>({content:{alignItems:"center",display:"flex"},[pZ]:{..._.Z[uZ],fontWeight:_.Z.fontWeight.semibold}})),[]),m=a()("span",{style:p[pZ]},void 0,s.name),g=a()(bu.Z,{format:hu.l.Medium,isRound:!0,isSingle:!0,shouldShrink:!0,showRemoveButton:!1,value:a()("span",{style:_.Z[uZ]},void 0,c)}),y=c?Rd({[pZ]:m,propertyValue:g}):Kd({[pZ]:m});return a()(yu,{disabled:t,icon:o,onClick:i,onDelete:n,onEdit:r,title:a()("div",{style:p.content},void 0,l[cZ](u.FormattedMessage,y))})}function gZ(e){return l[cZ](mZ,s()({},e,{icon:A.Z.typesTitle}))}function yZ(e){return l[cZ](mZ,s()({},e,{icon:A.Z.typesText}))}function fZ(e){return l[cZ](mZ,s()({},e,{icon:A.Z.typesEmail}))}function vZ(e){return l[cZ](mZ,s()({},e,{icon:A.Z.typesUrl}))}function hZ(e){return l[cZ](mZ,s()({},e,{icon:A.Z.typesNumber}))}function SZ(e){return l[cZ](mZ,s()({},e,{icon:A.Z.typesPhoneNumber}))}const bZ=o(85).OBh,wZ=o(85).PG2,CZ=o(85).pkR,PZ=o(85).oWD,TZ=o(85).EQe;function AZ(e){const{[TZ]:t,[PZ]:o,[CZ]:i,formulaValueContext:n,[wZ]:r,onEdit:s,[bZ]:l,setPropertyValue:d,onDelete:c}=e;return"person"===l.type?a()(eZ,{[PZ]:o,[CZ]:i,[wZ]:r,onDelete:c,onEdit:s,[bZ]:l,value:d.value}):"status"===l.type?a()(dZ,{[CZ]:i,[wZ]:r,onDelete:c,onEdit:s,[bZ]:l,value:d.value}):"select"===l.type?a()(nZ,{[CZ]:i,[wZ]:r,onDelete:c,onEdit:s,[bZ]:l,value:d.value}):"multi_select"===l.type?a()(Uu,{[CZ]:i,[wZ]:r,onDelete:c,onEdit:s,[bZ]:l,value:d.value}):"date"===l.type?a()(Lx,{[TZ]:t,[PZ]:o,[CZ]:i,[wZ]:r,onDelete:c,onEdit:s,[bZ]:l,value:d.value,valueContext:n}):"relation"===l.type?a()(Yu,{[PZ]:o,[CZ]:i,[wZ]:r,onDelete:c,onEdit:s,[bZ]:l,value:d.value}):"checkbox"===l.type?a()(Ex,{[CZ]:i,[wZ]:r,onDelete:c,onEdit:s,[bZ]:l,value:d.value}):"title"===l.type?a()(gZ,{[CZ]:i,[wZ]:r,onDelete:c,onEdit:s,[bZ]:l,value:d.value}):"text"===l.type?a()(yZ,{[CZ]:i,[wZ]:r,onDelete:c,onEdit:s,[bZ]:l,value:d.value}):"email"===l.type?a()(fZ,{[CZ]:i,[wZ]:r,onDelete:c,onEdit:s,[bZ]:l,value:d.value}):"url"===l.type?a()(vZ,{[CZ]:i,[wZ]:r,onDelete:c,onEdit:s,[bZ]:l,value:d.value}):"number"===l.type?a()(hZ,{[CZ]:i,[wZ]:r,onDelete:c,onEdit:s,[bZ]:l,value:d.value}):"phone_number"===l.type?a()(SZ,{[CZ]:i,[wZ]:r,onDelete:c,onEdit:s,[bZ]:l,value:d.value}):null}const kZ=o(85).ccq,_Z=o(85).OBh,MZ=o(85).D7I,xZ=o(85).ejZ,ZZ=o(85).X5t,IZ=o(85).dMt,DZ=o(85).pkR,FZ=o(85).oWD,VZ=o(85).EQe;function BZ(e){window.__c={n:"CollectionSettingsAutomationActionList"};const{[VZ]:t,[FZ]:o,updateCurrentAutomationState:i,handleNavigateToDeletedProperties:n,currentUserIsOwner:r,[DZ]:s}=e,l=(0,P.VK)((()=>t.getActionStores().map((e=>e.isType("update_pages")?a()(EZ,{actionStore:e,[VZ]:t,[FZ]:o,[DZ]:s,handleNavigateToDeletedProperties:n,updateCurrentAutomationState:i},e.id):e.isType("slack_notification")?a()(Vg,{actionStore:e,[VZ]:t,[FZ]:o,updateCurrentAutomationState:i,currentUserIsOwner:r,[DZ]:s},e.id):e.isType("create_page")?a()(qM,{actionStore:e,[VZ]:t,[FZ]:o,[DZ]:s,updateCurrentAutomationState:i},e.id):void 0)).filter(k.isDefined)),[t,o,r,s,n,i]),d=(0,T.yK)((e=>({stepList:{border:`1px solid ${e[IZ]}`,borderRadius:6,listStyle:"none",margin:0,overflow:"hidden",padding:0},stepItemWithBorderTop:{borderTop:`1px solid ${e[IZ]}`}})),[]);return a()("ul",{style:d.stepList},void 0,l.map(((e,t)=>{const o=0===t?void 0:d.stepItemWithBorderTop;return a()("li",{style:o},t,e)})))}function EZ(e){var t;window.__c={n:"InternalUpdatePageAction"};const{actionStore:o,[VZ]:i,[FZ]:n,[DZ]:r,handleNavigateToDeletedProperties:d,updateCurrentAutomationState:c}=e,u=(0,zc.d)(),p=(0,P.VK)((()=>o.getConfig()),[o]),m=(0,P.VK)((()=>n.getSchema()),[n]),g=(0,l.useCallback)((()=>{c({[ZZ]:{config:p,id:o.id,type:"update_pages"},type:"remove_action"})}),[p,o.id,c]);if("variable"===(null==p||null===(t=p.target)||void 0===t?void 0:t.type)){const e=(0,_s.MY)(p.target.id);if("global"===e.source&&"button_page"===e.global){var y;const e=(p.properties??[])[0],t=m[e],f=null===(y=p.values)||void 0===y?void 0:y[e];if(t&&f){const d={type:"collection",[FZ]:n,property:e};return a()(st.ZP,{alignmentToOrigin:st.vR.End,[kZ]:st.pO.Bottom,popupType:u,render:t=>a()(ug,{[VZ]:i,buttonPopupParent:t,[FZ]:n,initialState:{[xZ]:e,actionId:o.id,type:"eventActionProperty"},updateCurrentAutomationState:c}),renderOrigin:e=>l[MZ](AZ,s()({},e,{[VZ]:i,[FZ]:n,[DZ]:r,formulaValueContext:d,onDelete:g,onEdit:e.onClick,[_Z]:t,setPropertyValue:f}))})}return t?null:a()(st.ZP,{alignmentToOrigin:st.vR.Center,[kZ]:st.pO.Bottom,popupType:u,render:e=>a()(__,{stepType:ZZ,onDelete:g,onViewDeletedProperties:d}),renderOrigin:t=>l[MZ](C_,s()({},t,{[DZ]:r,[xZ]:e,[FZ]:n}))})}return null}return a()(kx,{actionStore:o,[VZ]:i,[FZ]:n,[DZ]:r,updateCurrentAutomationState:c})}var KZ=o(3386);const RZ=o(85).j_x,NZ=o(85).qYR,OZ=o(85).ffk,WZ=o(85).v8g,UZ=o(85).wbK,GZ=o(85).HXm,LZ=o(85).QKR,zZ=o(85).dMt,HZ=(o(85).p9N,o(85).zUk,o(85).Joh),qZ=o(85).$bT,jZ=o(85).sM5,QZ=o(85).lsp,$Z=o(85).ccq,XZ=o(85).nAm,YZ=o(85).NJt,JZ=o(85).j7K,eI=o(85).D7I,tI=o(85).rpY,oI=o(85).y79,iI=o(85).Yzm,nI=o(85).BQ6,aI=o(85).pkR,rI=o(85).PG2,sI=o(85).lw5,lI=o(85).dL6,dI=o(85).sbn,cI=o(85).q88,uI=o(85).oNU,pI=o(85).X5t,mI=o(85).v1$,gI=o(85).hd7,yI=o(85).Xl2,fI=o(85).TtP,vI=o(85).MWD,hI=o(85).qpZ,SI=o(85).P24,bI=o(85).HxR,wI=o(85).oWD,CI=o(85).EQe,PI=o(85).nx5,TI=(0,u.defineMessages)({addTriggerAriaLabel:{id:"collectionSettings.editAutomationView.addTrigger.iconButton",[PI]:"Add trigger"},addActionAriaLabel:{id:"collectionSettings.editAutomationView.addAction.iconButton",[PI]:"Add action"},deleteButton:{id:"collectionSettings.editAutomationView.deleteButton",[PI]:"Delete"},automationEnabledLabel:{[PI]:"Active",id:"collectionSettings.editAutomationView.automationEnabledLabel"},automationPausedLabel:{[PI]:"Paused",id:"collectionSettings.editAutomationView.automationPausedLabel"},automationEnabledHiddenAriaLabel:{[PI]:"Automation is active.",id:"collectionSettings.editAutomationView.automationEnabledHiddenAriaLabel"},automationPausedHiddenAriaLabel:{[PI]:"Automation is paused.",id:"collectionSettings.editAutomationView.automationPausedHiddenAriaLabel"},automationDisabledTooltip:{[PI]:"Ask {user} to resume this automation.",id:"collectionSettings.editAutomationView.automationDisabledTooltip"}}),AI=()=>{};function kI(e){window.__c={n:"CollectionSettingsEditAutomationView"};const{automationPermissionScope:t,automationId:o,[CI]:i,[wI]:n,[bI]:r,[SI]:d,isCreate:c,isDisabled:p,title:g,[hI]:y,updateCurrentState:f,canSave:v,onSave:h,currentUserIsOwner:S,onDelete:b,onDisable:w,onEnable:M,hasPendingChanges:x}=e,Z=(0,u.useIntl)(),I=(0,Hc.D)(),{isMobile:D}=(0,C.Fy)(),F=(0,P.VK)((()=>d.aliveAutomationCount.state),[d]),V=n.id,K=(0,P.VK)((()=>n.getSchema()),[n]),R=(0,P.VK)((()=>i.getName()??""),[i]),N=(0,P.VK)((()=>{var e;return(null===(e=i.getOwnerStore())||void 0===e?void 0:e.getDisplayName(Z))??""}),[Z,i]),O=function(e){const{contextStore:t}=e,[o,i]=(0,l.useState)([]),n=(0,P.VK)((()=>t?(0,tk.uV)(t.context[CI],t.context[vI]):void 0),[t]);return(0,P.VK)((async()=>{if(n){const e=await Yd({automationAvailabilityContext:n});return i(function(e){const t=e=>e?1:-1;return e.slice().sort(((e,o)=>t(o[jZ][RZ])-t(e[jZ][RZ])))}(e))}o[fI]>0&&i([])}),[o[fI],n]),o}({contextStore:Gc({[CI]:i,[wI]:n})}),W=(0,l.useMemo)((()=>({[vI]:"eventTriggers"})),[]),U=(0,l.useMemo)((()=>({[vI]:"eventActions",availableActions:O})),[O]),G="readonly_with_delete"===t||"edit"===t&&!c,L="edit"===t,z=function(e){const t=4,{showDeleteEnableDisableOptions:o}=e,{isMobile:i}=(0,C.Fy)();return(0,T.yK)((e=>({automationSection:{[jZ]:"flex",[qZ]:"column",gap:t},automationSectionAdd:{marginLeft:"auto",flexGrow:0,flexShrink:0},automationSectionHeader:{alignItems:"center",[jZ]:"flex",[qZ]:"row"},automationSectionHeaderAction:{background:`linear-gradient(to right, ${e[zZ]} 50%, transparent 50%), linear-gradient(to right, ${e[zZ]} 50%, transparent 50%)`,backgroundPosition:"20px 0px, 20px bottom",backgroundRepeat:"no-repeat",backgroundSize:`2px 36px, 2px ${t+2}px`,marginBlockEnd:-t,paddingBlock:`36px ${t}px`,position:"relative"},automationSectionTitle:{color:e.lightTextColor,fontSize:i?14:12,lineHeight:1.3,position:"relative",fontWeight:_.Z.fontWeight.medium},automationCreateMobile:{boxShadow:"none",paddingBlock:"0 12px",paddingInline:12},automationCreateDesktop:{paddingBlock:o?"12px 0":12,paddingInline:12},automationCreateButton:{...i?{minHeight:45}:{},width:"100%"},automationNameInput:{marginBlockEnd:i?void 0:8},automationNameText:{[LZ]:12},automationOptionIconDesktop:{[LZ]:12},menuScroller:{...i?{}:{marginBlockStart:6}},wrap:{borderTop:`1px solid ${e[zZ]}`,paddingBlockStart:15,paddingBlockEnd:12,paddingInline:12}})),[i,o])}({showDeleteEnableDisableOptions:G}),H=(0,zc.d)(),q=(0,P.VK)((()=>function(e){if(!od(e))return!1;const t=e[cI]()[lI](sI)[dI]();return(null==t?void 0:t.pagesAdded)||"none"!==(null==t?void 0:t[NZ][vI])}(i)),[i]),Q=(0,P.VK)((()=>function(e){return e.getActionIds()[fI]>0}(i)),[i]),$=0===O[fI],X=(0,P.VK)((()=>Q&&L&&!$),[L,Q,$]),Y=(0,l.useCallback)((async()=>{await MI({automationName:R,hasPendingChanges:x})&&(0===F?m[yI]({[bI]:r,item:{[vI]:"main"}}):m.popSettingsItem({[bI]:r}))}),[F,R,r,x]),J=(0,l.useCallback)((async()=>{await MI({automationName:R,hasPendingChanges:x})&&m.closeSettings({[bI]:r})}),[R,r,x]),ee=(0,l.useCallback)((async()=>{await MI({automationName:R,hasPendingChanges:x})&&(m[yI]({[bI]:r,item:{[vI]:"main"}}),m[gI]({[bI]:r,item:{[vI]:mI,timelineViewTab:"timeline"}}),m[gI]({[bI]:r,item:{[vI]:"deletedProperties",collectionPointer:n.pointer,timelineViewTab:"timeline"}}))}),[R,r,n.pointer,x]),te=(0,P.VK)((()=>e=>{if(f(e),V&&K)if("update_trigger"===e[vI]||"remove_trigger"===e[vI]){const t=function(e){const{[pI]:t,automationId:o,collectionStoreId:i,schema:n}=e;let a;if("page_added"===t[uI][vI])a={[vI]:"page"};else if("any_page_property_edited"===t[uI][vI])a={condition:"any",[vI]:OZ};else if("property_changed"===t[uI][vI]){const e=n[t[uI][OZ]];if(!e)return;a={condition:"some",property_types:[e[vI]],[vI]:OZ}}else(0,k.unreachable)(t[uI]);return{[UZ]:o,automation_trigger:a,[WZ]:i}}({[pI]:e,automationId:o,collectionStoreId:V,schema:K});if(!t)return;"remove_trigger"===e[vI]?(0,ws.Ey)(I,t):"update_trigger"===e[vI]&&function(e,t){if(!od(t))return!0;const o=t[cI]()[lI](sI);if("page_added"===e[vI]&&!0===o[lI]("pagesAdded")[dI]())return!1;if("any_page_property_edited"===e[vI]&&"any"===o[lI]("pagePropertiesEdited")[lI]("type")[dI]())return!1;if("property_changed"===e[vI]){const t=o[lI](NZ)[dI]();if("some"===(null==t?void 0:t[vI])&&t.some.some((t=>t[OZ]===e[OZ])))return!0}return!0}(e[uI],i)&&(0,ws.nK)(I,t)}else if("update_action"===e[vI]||"remove_action"===e[vI]){const t=function(e){const{[pI]:t,automationId:o,collectionStoreId:i,schema:n}=e;let a;if("slack_notification"===t[pI][vI])a={[vI]:GZ};else{if("update_pages"!==t[pI][vI])return;var r;a={property_types:((null===(r=t[pI].config)||void 0===r?void 0:r[mI])??[]).map((e=>{var t;return null===(t=n[e])||void 0===t?void 0:t[vI]})).filter(k.isDefined),[vI]:"update_pages"}}return{automation_action:a,automation_action_id:t[pI].id,[UZ]:o,[WZ]:i}}({[pI]:e,automationId:o,collectionStoreId:V,schema:K});if(!t)return;"remove_action"===e[vI]?(0,ws.OK)(I,t):"update_action"===e[vI]&&function(e,t){return!t.getActionIds().includes(e.id)}(e[pI],i)&&(0,ws.A2)(I,t)}}),[o,i,V,I,f,K]),oe=(0,l.useCallback)((e=>{const t=e.target.value;te({[vI]:"update_name",name:t})}),[te]),ie=(0,l.useCallback)((e=>{te({[vI]:"update_source",pointer:e})}),[te]);!function(e){const{[CI]:t,collectionStoreId:o,eventTracker:i,isCreate:n}=e,[a,r]=(0,l.useState)(!1),s=(0,P.VK)((()=>t.getActionIds()[fI]),[t]),d=(0,P.VK)((()=>{if(!od(t))return 0;const e=t[cI]()[lI](sI);let o=0;e[lI]("pagesAdded")[dI]()&&o++;const i=e[lI](NZ)[dI]();return"any"===(null==i?void 0:i[vI])?o++:"some"===(null==i?void 0:i[vI])&&(o+=i.some[fI]),o}),[t]);(0,l.useEffect)((()=>{i&&o&&!n&&!a&&((0,ws.nC)(i,{[UZ]:t.id,automation_total_actions:s,automation_total_triggers:d,[WZ]:o}),r(!0))}),[i,o,n,a,s,d,t.id])}({collectionStoreId:V,eventTracker:I,isCreate:c,[CI]:i});const ne=(0,P.VK)((()=>{if(od(i)){const e=i[cI]()[lI](sI)[lI]("source")[dI]();if(e&&"filter"!==e[vI])return e.pointer}}),[i]),ae=[];return L&&ae.push(a()(j.Z,{mobileStyle:z.automationCreateMobile,[nI]:z.automationCreateDesktop,topBorder:!D},void 0,a()(it.Z,{[rI]:h,[aI]:!v,[nI]:z.automationCreateButton},void 0,a()(u.FormattedMessage,c?{id:"collectionSettings.editAutomationView.createButton.label",[PI]:"Create"}:{id:"collectionSettings.editAutomationView.saveButton.label",[PI]:"Save"})))),G&&ae.push(a()(j.Z,{disableMobilePadding:!0,topBorder:D||0===ae[fI]},void 0,a()(E.Z,{desktopIconStyle:z.automationOptionIconDesktop,icon:A.Z.trash,isRed:!0,[rI]:b,title:Z[iI](TI.deleteButton)}))),a()(KZ.Z,{capture:!0,onEsc:J},void 0,a()(B.ZP,{title:g,[bI]:r,[SI]:d,handleBackArrowClick:Y,handleClose:J,footer:ae,fullHeight:!0,menuScrollerStyle:z.menuScroller},void 0,y,a()(Wt.Z,{[vI]:Wt.i[oI],[JZ]:void 0,sections:[{key:"automation_top_input",items:[{key:"automation_name",[pI]:()=>{},[tI]:e=>l[eI](Ot.ZP,s()({[nI]:z.automationNameInput},e,{value:R??"Loading...",onChange:oe,[aI]:!L,textWrapperStyle:z.automationNameText}))},{key:"automation_source",[pI]:AI,[tI]:e=>a()(m_,{menuListItemProps:e,selectedSourcePointer:ne,[SI]:d,onSelect:ie,[aI]:!L})}],[tI]:e=>l[eI](j.Z,s()({},e,{disableMobilePadding:Boolean(y)}))}]}),a()("div",{[nI]:z.wrap},void 0,G&&M&&w&&a()(_I,{automationId:i.id,automationOwner:N,[aI]:!L,isAutomationDisabled:p,onDisable:w,onEnable:M}),a()(QZ,{[nI]:z.automationSection},void 0,a()(hI,{[nI]:z.automationSectionHeader},void 0,a()("div",{[nI]:z.automationSectionTitle},void 0,a()(u.FormattedMessage,{id:"collectionSettings.editAutomationView.triggerSection.title",[PI]:"When any of these occur"})),a()("div",{[nI]:{...z.automationSectionAdd,[YZ]:q&&L?void 0:XZ}},void 0,a()(st.ZP,{popupType:H,alignmentToOrigin:st.vR.End,[$Z]:st.pO.Bottom,renderOrigin:e=>l[eI](iu.Z,s()({},e,{ariaLabel:Z[iI](TI.addTriggerAriaLabel),icon:A.Z.plus})),[tI]:e=>n&&a()(pM,{[CI]:i,[wI]:n,initialState:W,updateCurrentAutomationState:te,buttonPopupParent:e})}))),q?a()(xM,{[CI]:i,[wI]:n,updateCurrentState:te,handleNavigateToDeletedProperties:ee,[aI]:!L}):a()(st.ZP,{popupType:H,renderOrigin:e=>l[eI](xk,s()({},e,{icon:A.Z.plus({height:24,width:12}),title:a()(u.FormattedMessage,{id:"collectionSettings.editAutomationView.triggerSection.placeholder",[PI]:"Add trigger"})})),[tI]:e=>n&&a()(pM,{[CI]:i,[wI]:n,initialState:W,updateCurrentAutomationState:te,buttonPopupParent:e})})),a()(QZ,{[nI]:z.automationSection},void 0,a()(hI,{[nI]:{...z.automationSectionHeader,...z.automationSectionHeaderAction}},void 0,a()("div",{[nI]:z.automationSectionTitle},void 0,a()(u.FormattedMessage,{id:"collectionSettings.editAutomationView.actionSection.title",[PI]:"Do this"})),a()("div",{[nI]:{...z.automationSectionAdd,[YZ]:X?void 0:XZ}},void 0,a()(st.ZP,{alignmentToOrigin:st.vR.End,[$Z]:st.pO.Bottom,popupType:H,[tI]:e=>a()(ug,{[CI]:i,buttonPopupParent:e,[wI]:n,initialState:U,updateCurrentAutomationState:te}),renderOrigin:e=>l[eI](iu.Z,s()({},e,{ariaLabel:Z[iI](TI.addActionAriaLabel),icon:A.Z.plus}))}))),Q?a()(BZ,{[CI]:i,[wI]:n,handleNavigateToDeletedProperties:ee,updateCurrentAutomationState:te,currentUserIsOwner:S,[aI]:!L}):a()(Bk,{[CI]:i,availableActions:O,[wI]:n,initialState:U,updateCurrentAutomationState:te})))))}function _I(e){window.__c={n:"AutomationSectionStatus"};const{automationId:t,automationOwner:o,[aI]:i,isAutomationDisabled:n,onDisable:r,onEnable:d}=e,c=`toggle-${t}`,p=(0,l.useCallback)((()=>{n?null==d||d():null==r||r()}),[n,d,r]),m=(0,T.yK)((e=>({labelWrap:{color:i?e.text.secondary:e.text.primary,flex:"1 1 auto",fontSize:14},sectionWrap:{alignItems:"start",[jZ]:"flex",[qZ]:"row",gap:4,marginBlockEnd:12},toggleWrap:{flex:"0 0 auto",paddingBlockStart:2}})),[i]),g=n?TI.automationPausedLabel:TI.automationEnabledLabel,y=n?TI.automationPausedHiddenAriaLabel:TI.automationEnabledHiddenAriaLabel;return a()(QZ,{[nI]:m.sectionWrap},void 0,a()("div",{[nI]:m.toggleWrap},void 0,a()(xn.Z,{disableTooltip:!i||!n,[HZ]:()=>l[eI](u.FormattedMessage,s()({},TI.automationDisabledTooltip,{values:{user:o}})),[tI]:e=>l[eI]("div",e,a()(Mn.Z,{[aI]:i,inputId:c,on:!n,[rI]:p}))})),a()("div",{[nI]:m.labelWrap},void 0,a()("label",{htmlFor:c},void 0,a()("span",{"aria-hidden":!0},void 0,l[eI](u.FormattedMessage,g)),a()("span",{[nI]:_k.jy},void 0,l[eI](u.FormattedMessage,y)))))}async function MI(e){const{automationName:t,hasPendingChanges:o}=e;return!o||await tt.confirmUserAction({message:a()(u.FormattedMessage,{id:"automations.confirmDiscardChanges.message",[PI]:"{hasName, select, true {Are you sure you want to discard {automationName}?} other {Are you sure you want to discard this automation?}}",values:{automationName:t,hasName:Boolean(t)}}),acceptLabel:a()(u.FormattedMessage,{id:"automations.confirmDiscardChanges.acceptLabel",[PI]:"Discard"})})}const xI=o(85).Yzm,ZI=o(85).Xl2,II=(o(85).x8i,o(85).J4z),DI=(o(85).pdI,o(85).wgE),FI=o(85).EQe,VI=o(85).mFu,BI=o(85).P3z,EI=o(85).Rdx,KI=o(85).J$i,RI=o(85).Lbi,NI=o(85).VXW,OI=o(85).oWD,WI=o(85).P24,UI=o(85).HxR,GI=o(85).nx5,LI=(0,u.defineMessages)({createStatusAutomationViewMenuTitle:{id:"collectionSettings.createStatusAutomationView.menuTitle",[GI]:"New automation"},editStatusAutomationViewMenuTitle:{id:"collectionSettings.editStatusAutomationView.menuTitle",[GI]:"Edit automation"}});function zI(e){window.__c={n:"CollectionSettingsEditStatusAutomationView"};const{[UI]:t,[WI]:o,...i}=e,n=(0,l.useMemo)((()=>i),[]),r=(0,u.useIntl)(),s=(0,C.O7)(),d=(0,P.VK)((()=>o[OI]()),[o]),p=(0,P.VK)((()=>null==d?void 0:d.getSpaceId()),[d]),g=(0,P.VK)((()=>qc.default.state.currentUserStore),[]),y=(0,P.VK)((()=>null==g?void 0:g[NI]),[g]),f=(0,P.VK)((()=>null==g?void 0:g[RI](r)),[g,r]),v=(0,ek.$)("CollectionSettingsEditStatusAutomationView",{cacheFallback:s[EI][KI],isTemporaryData:!0}),h=(0,l.useMemo)((()=>"update"===n.type?n.automationId:(0,c.default)()),[n]),S=(0,P.VK)((()=>(0,Cs.XO)(r,f)),[f,r]),b=(0,P.VK)((()=>{if(!p||!d||!y)return;const e={id:h,table:Fs.cv,spaceId:p},t=v[BI]({[VI]:e,[NI]:y});return t?t.value.value:zd({automationId:h,automationName:S,[OI]:d,[NI]:y})}),[h,S,d,y,v,p]),w=(0,P.VK)((()=>{if(!p||!d)return;const e={id:h,table:Fs.cv,spaceId:p},t=v[BI]({[VI]:e,[NI]:y});"create"===n.type&&!(0,k.isDefined)(t)&&y&&v.setRecord({[VI]:e,[NI]:y},{role:"editor",value:b});const o=new zs.Mz(s,e,{[KI]:v});return od(o)?o:void 0}),[b,h,d,y,s,v,n.type,p]),T=(0,P.VK)((()=>(null==w?void 0:w.getActionStores())??[]),[w]),A=JA({[FI]:w,actionStores:T,loadingStatus:"resolved",mode:n.type}),_=(0,P.VK)((()=>o.aliveAutomationCount.state),[o]),M=(0,P.VK)((()=>{if(!w||!g)return!1;const e=g[VI],t=w.getCreatedByPointer();return!(!e||!t)&&Zs.dr.isEqual(e,t)}),[w,g]),x=(0,P.VK)((()=>(null==w?void 0:w.getStatus())??"disabled"),[w]),Z="active"===x,I=ld({[FI]:w,currentUserId:y,[KI]:v}),D=(0,P.VK)((()=>!(!w||!d)&&vd({[FI]:w,[OI]:d})),[w,d]),F=(0,P.VK)((()=>!(!d||!w)&&dd({[FI]:w,[OI]:d})),[w,d]),V=(0,P.VK)((()=>{var e;return null==w||null===(e=w.getOwnerStore())||void 0===e?void 0:e[RI](r)}),[r,w]),B=HI({automationStorePointer:null==w?void 0:w[VI],[EI]:s[EI][KI],[KI]:v,[NI]:y}),E=(0,l.useCallback)((()=>{d&&w&&B&&("create"===n.type?(Zc({[FI]:w,[OI]:d,[DI]:s,intl:r}),XT.oV({label:a()(u.FormattedMessage,{id:"automations.editAutomationView.createdConfirmation",[GI]:"{automationName} created",values:{automationName:w.getName()}})}),m[II]({[UI]:t})):"update"===n.type?(Ic({[FI]:w,[OI]:d,[DI]:s}),XT.oV({label:a()(u.FormattedMessage,{id:"automations.editAutomationView.updatedConfirmation",[GI]:"{automationName} updated",values:{automationName:w.getName()}})}),m[II]({[UI]:t})):(0,k.unreachable)(n))}),[w,t,d,s,B,r,n]),K=(0,l.useCallback)((()=>{w&&d&&Fc({[FI]:w,[OI]:d,[DI]:s})}),[d,s,w]),R=(0,l.useCallback)((()=>{w&&d&&Vc({[FI]:w,[OI]:d,[DI]:s})}),[d,s,w]),N=(0,l.useCallback)((()=>{w&&d&&Bc({[FI]:w,[OI]:d,[DI]:s})}),[d,s,w]),O=(0,l.useCallback)((async()=>{w&&d&&"create"!==n.type&&await Dc({intl:r,[DI]:s,existingAutomationStore:w,[OI]:d,triggerType:"event",onDelete:()=>{1===_?m[ZI]({[UI]:t,item:{type:"main"}}):m[II]({[UI]:t})}})}),[_,w,t,d,s,r,n.type]);if(!d||!w)return null;const W="create"===i.type,U=B&&F,G=W?r[xI](LI.createStatusAutomationViewMenuTitle):r[xI](LI.editStatusAutomationViewMenuTitle),L=x&&V&&a()(Ck,{[FI]:w,[OI]:d,showSlackSpecificMessages:!1,automationStatus:x,automationPermissionScope:A,automationCreatorName:V,referencesIncompatibleCollectionViewFilter:D,onDelete:O,onResume:N});return a()(kI,{automationId:w.id,[FI]:w,automationPermissionScope:A,canSave:U,[WI]:o,[UI]:t,[OI]:d,currentUserIsOwner:M,hasPendingChanges:B,header:L,isCreate:W,isDisabled:!Z,onDelete:O,onDisable:K,onEnable:R,onSave:E,title:G,triggerOperators:["any"],updateCurrentState:e=>I(e)})}function HI(e){var t,o,i;const{automationStorePointer:n,[EI]:a,[KI]:r,[NI]:s}=e;if(!n||!s)return!1;const l=null===(t=a[BI]({[VI]:n,[NI]:s}))||void 0===t?void 0:t.value.value,d=null===(o=r[BI]({[VI]:n,[NI]:s}))||void 0===o?void 0:o.value.value;return!(0,k.isDefined)(l)||!se().isEqual(l,d)||Boolean(null==d||null===(i=d.action_ids)||void 0===i?void 0:i.some((e=>{var t,o;const i={id:e,spaceId:n.spaceId,table:Os.Xj},l=null===(t=a[BI]({[VI]:i,[NI]:s}))||void 0===t?void 0:t.value.value,d=null===(o=r[BI]({[VI]:i,[NI]:s}))||void 0===o?void 0:o.value.value;return!(0,k.isDefined)(l)||!se().isEqual(l,d)})))}const qI=o(85).Xl2,jI=(o(85).x8i,o(85).J4z),QI=o(85).nx5,$I=(o(85).pdI,o(85).wgE),XI=o(85).EQe,YI=o(85).mFu,JI=o(85).Rdx,eD=o(85).J$i,tD=o(85).Lbi,oD=o(85).oWD,iD=o(85).P24,nD=o(85).HxR;function aD(e){window.__c={n:"CollectionSettingsEditSlackAutomationView"};const{[nD]:t,[iD]:o,...i}=e,n=l.useMemo((()=>i),[]),r=(0,C.O7)(),s=(0,u.useIntl)(),d=(0,P.VK)((()=>o[oD]()),[o]),p=(0,P.VK)((()=>null==d?void 0:d.getSpaceId()),[d]),g=(0,P.VK)((()=>qc.default.state.currentUserStore),[]),y=(0,P.VK)((()=>null==g?void 0:g.userId),[g]),f=(0,P.VK)((()=>null==g?void 0:g[tD](s)),[g,s]),v=(0,ek.$)("CollectionSettingsEditSlackAutomationView",{cacheFallback:r[JI][eD],isTemporaryData:!0}),h=(0,l.useMemo)((()=>"update"===n.type?n.automationId:(0,c.default)()),[n]),S=(0,P.VK)((()=>(0,Cs.gq)(s,f)),[f,s]),b=(0,P.VK)((()=>{if(!p||!d||!y)return;const e={id:h,table:Fs.cv,spaceId:p},t=v.getEntry({[YI]:e,userId:y});return t?t.value.value:Hd({automationId:h,automationName:S,[oD]:d,userId:y})}),[h,S,d,y,v,p]),w=(0,P.VK)((()=>{if(!p||!d)return;const e={id:h,table:Fs.cv,spaceId:p},t=v.getEntry({[YI]:e,userId:y});"create"===n.type&&!(0,k.isDefined)(t)&&y&&v.setRecord({[YI]:e,userId:y},{role:"editor",value:b});const o=new zs.Mz(r,e,{[eD]:v});return od(o)?o:void 0}),[b,h,d,y,r,v,n.type,p]),T=(0,P.VK)((()=>(null==w?void 0:w.getActionStores())??[]),[w]),A=JA({[XI]:w,actionStores:T,loadingStatus:"resolved",mode:n.type}),_=(0,P.VK)((()=>o.aliveAutomationCount.state),[o]),M=(0,P.VK)((()=>{if(!w||!g)return!1;const e=g[YI],t=w.getCreatedByPointer();return!(!e||!t)&&Zs.dr.isEqual(e,t)}),[w,g]),x=(0,P.VK)((()=>(null==w?void 0:w.getStatus())??"disabled"),[w]),Z="active"===x,I=ld({[XI]:w,currentUserId:y,[eD]:v}),D=(0,P.VK)((()=>!(!w||!d)&&vd({[XI]:w,[oD]:d})),[w,d]),F=(0,P.VK)((()=>!(!d||!w)&&dd({[XI]:w,[oD]:d})),[w,d]),V=(0,P.VK)((()=>{var e;return null==w||null===(e=w.getOwnerStore())||void 0===e?void 0:e[tD](s)}),[s,w]),B=HI({automationStorePointer:null==w?void 0:w[YI],[JI]:r[JI][eD],[eD]:v,userId:y}),E=(0,l.useCallback)((()=>{d&&w&&B&&("create"===n.type?(Zc({[XI]:w,[oD]:d,[$I]:r,intl:s}),XT.oV({label:a()(u.FormattedMessage,{id:"automations.editAutomationView.createdConfirmation",[QI]:"{automationName} created",values:{automationName:w.getName()}})}),m[jI]({[nD]:t})):"update"===n.type?(Ic({[XI]:w,[oD]:d,[$I]:r}),XT.oV({label:a()(u.FormattedMessage,{id:"automations.editAutomationView.updatedConfirmation",[QI]:"{automationName} updated",values:{automationName:w.getName()}})}),m[jI]({[nD]:t})):(0,k.unreachable)(n))}),[w,t,d,r,B,s,n]),K=(0,l.useCallback)((()=>{w&&d&&Bc({[XI]:w,[oD]:d,[$I]:r})}),[d,r,w]),R=(0,l.useCallback)((async()=>{w&&d&&"create"!==n.type&&await Dc({intl:s,[$I]:r,existingAutomationStore:w,[oD]:d,triggerType:"event",onDelete:()=>{1===_?m[qI]({[nD]:t,item:{type:"main"}}):m[jI]({[nD]:t})}})}),[_,w,t,d,r,s,n.type]);if(!d||!w)return null;const N="create"===i.type,O=B&&F,W=x&&V&&a()(Ck,{[XI]:w,[oD]:d,showSlackSpecificMessages:!0,automationStatus:x,automationPermissionScope:A,automationCreatorName:V,referencesIncompatibleCollectionViewFilter:D,onDelete:R,onResume:K}),U=a()(u.FormattedMessage,N?{id:"collectionSettings.createSlackAutomationView.title",[QI]:"New Slack notification"}:{id:"collectionSettings.editSlackAutomationView.title",[QI]:"Slack notification"});return a()(kI,{automationId:w.id,automationPermissionScope:A,[XI]:w,canSave:O,[iD]:o,[nD]:t,[oD]:d,currentUserIsOwner:M,hasPendingChanges:B,header:W,isCreate:N,isDisabled:!Z,onDelete:R,onSave:E,title:U,triggerOperators:["any"],updateCurrentState:e=>I(e)})}var rD=o(41837),sD=o(87205);const lD=12e3;var dD=o(3791),cD=o(79474),uD=o(4636),pD=o(55332),mD=o(28020),gD=o(77181),yD=o(99417),fD=o(96026),vD=o(78291);const hD=new V.Z;var SD=o(30905),bD=o(73420),wD=o(1743),CD=o(91839);const PD=o(85).ewQ,TD=o(85).Wmz,AD=o(85).Scd,kD=o(85).cZW,_D=o(85).zwB,MD=o(85).gdQ,xD=(o(85).O0r,o(85).U8D),ZD=(o(85).mDm,o(85).ipe),ID=o(85).Wp_,DD=o(85).aKz,FD=o(85).zG9,VD=o(85).VAS,BD=o(85).voC,ED=o(85).ykC,KD=o(85).Y6E,RD=o(85).H1J,ND=o(85).qdS,OD=o(85).$KA,WD=o(85).Uww,UD=o(85).FH8,GD=o(85).uzK,LD=o(85).Hog,zD=o(85).KOz,HD=o(85).NLk,qD=o(85).sei,jD=o(85).jx_,QD=o(85).ChN,$D=o(85).sOA,XD=o(85).Q1_,YD=o(85).Q9F,JD=o(85).TEz,eF=o(85).a3v,tF=o(85).Mm1,oF=o(85).LtW,iF=o(85).LZJ,nF=o(85).XCs,aF=o(85).YDv,rF=o(85).Exd,sF=o(85).h8z,lF=o(85).UPJ,dF=o(85).EMU,cF=o(85).nQ3,uF=o(85).j7K,pF=o(85).y79,mF=o(85).lsp,gF=o(85).MRL,yF=o(85).Jkr,fF=o(85).X_m,vF=o(85).AL1,hF=o(85).lMs,SF=o(85)._mA,bF=o(85).cRc,wF=o(85).Woq,CF=o(85).P3s,PF=o(85).tBn,TF=o(85).rpY,AF=o(85).Joh,kF=o(85).g4H,_F=o(85).Zij,MF=o(85).D7I,xF=o(85).bey,ZF=o(85).PXg,IF=o(85).XNW,DF=o(85).nLZ,FF=o(85).Yzm,VF=o(85).E0z,BF=o(85).dLQ,EF=o(85).pkR,KF=o(85).PG2,RF=o(85).sM5,NF=o(85).ELX,OF=o(85).UA5,WF=(o(85).p9N,o(85).H1U),UF=o(85).BQ6,GF=(o(85).zUk,o(85).jkI),LF=o(85).J4z,zF=o(85)._tz,HF=o(85).TUY,qF=o(85).TtP,jF=o(85).rMr,QF=o(85).OBh,$F=o(85).plP,XF=o(85).BvK,YF=o(85).v2F,JF=o(85).S3,eV=o(85).mFu,tV=o(85).v8g,oV=o(85).$mk,iV=o(85).MWD,nV=o(85).iDK,aV=o(85).LCr,rV=o(85).wgE,sV=o(85).FZz,lV=o(85).Rdx,dV=o(85).J$i,cV=o(85).fpx,uV=o(85).oWD,pV=o(85).qq3,mV=o(85).QmD,gV=o(85).HxR,yV=o(85).P24,fV=o(85).ffk,vV=o(85).nx5,hV=(0,u.defineMessages)({optionsSectionTitle:{[vV]:"Options",id:"database.viewSettings.propertyTab.aiAutofill.optionsSectionTitle"},extractPromptSectionTitle:{[vV]:"What key info to extract?",id:"database.viewSettings.propertyTab.aiAutofill.extractPromptSectionTitle"},customPromptSectionTitle:{[vV]:"What to generate?",id:"database.viewSettings.propertyTab.aiAutofill.customPromptSectionTitle"},extractPromptInputPlaceholder:{[vV]:"e.g. ‚ÄúKey topics in bullets‚Äù or ‚ÄúPeople mentioned on the page‚Äù",id:"database.viewSettings.propertyTab.aiAutofill.extractPromptInputPlaceholder"},customPromptInputPlaceholder:{[vV]:"Tell AI what to generate from page content and properties‚Ä¶",id:"database.viewSettings.propertyTab.aiAutofill.customPromptInputPlaceholder"},removeAutofillButton:{[vV]:"Turn off AI autofill",id:"database.viewSettings.propertyTab.aiAutofill.removeAutofillButton"},updateOnPageEdits:{[vV]:"Auto-update on page edits",id:"database.viewSettings.propertyTab.aiAutofill.updateOnPageEdits"},toggleFillWithAiSectionLabel:{[vV]:"Actions",id:"database.viewSettings.propertyTab.aiAutofill.actionsSectionLabel"},confirmOverwriteExistingPropertyValues:{[vV]:"Filling ‚Äú{propertyName}‚Äù with AI will overwrite any existing values of the property. Are you sure you want to continue?",id:"database.viewSettings.propertyTab.aiAutofill.confirmOverwriteModal"},autoUpdateExplanationMessage:{[vV]:"Keep values updated with the latest edits to pages",id:"database.CollectionSettingsPropertyAiAutofill.autoUpdateExplanationMessage"},onlyWithAiAddOnMessage:{[vV]:"Only with Notion AI add-on",id:"database.CollectionSettingsPropertyAiAutofill.onlyWithAiAddOnMessage"},noAiAutofillSelected:{[vV]:"Select an option",id:"database.CollectionSettingsPropertyAiAutofill.noAiAutofillSelected"},whatToTranslate:{[vV]:"What to translate?",id:"CollectionSettingsPropertyAiAutofill.translateProperty.propertySelector"},translateTo:{[vV]:"Translate to",id:"CollectionSettingsPropertyAiAutofill.translateProperty.languageSelector"}});function SV(e){window.__c={n:"CollectionSettingsPropertyAiAutofill"};const{[fV]:t,[yV]:o,[gV]:i}=e,n=(0,P.VK)((()=>o[pV][mV][t]),[t,o[pV]]),r=(0,P.VK)((()=>o[uV]()),[o]),d=(0,P.VK)((()=>o[pV].getState()),[o]),c=n&&(0,Qe.getAiInferenceFromPropertySchema)(n),g=(0,C.O7)(),f=MV(),v=(0,P.VK)((()=>{const e=o[uV]();return e&&(0,yD.mX)(g,fD.Z.getMode(g,e),e)}),[g,o]),h=ep.default.createValue({stage:cV});(0,l.useEffect)((()=>{var e,i;if("page"===o.getViewType())return;if(!1!==(null===(e=o.getPropertyFormat(t))||void 0===e?void 0:e.visible))return;const n=new vS.Z({name:"CollectionSettingsPropertyAiAutofill"});g[lV][dV].addCacheOverride(n);const a=null===(i=o.formatStore())||void 0===i?void 0:i.clone(n),r=o[sV]();return a&&r&&y.createAndCommit({userAction:"CollectionSettingsPropertyAiAutofill.open",[rV]:g,perform:e=>{Je.er({formatStore:a,formatKey:r,[fV]:t,update:{visible:!0},[aV]:e})}}),()=>{g[lV][dV].removeCacheOverride(n)}}),[o,g,t]);const S=(0,l.useRef)({}),b=(0,P.VK)((()=>(0,Bt.k4)()),[]),[w,_]=(0,l.useState)(c),[M,x]=(0,l.useState)(!1),Z=(0,l.useCallback)((()=>{const e=o[uV]();if(!e||!n)return;const i=(0,Qe.getAiInferenceFromPropertySchema)(n);i&&"prompt"in i&&(S[nV]={...S[nV],[i[iV]]:i[oV]}),w&&p.trackAiAutofillSettingsAction(g,{[iV]:"set_ai_inference",ai_inference_type:w[iV],[tV]:e.id});const a=[];a.push({[eV]:e[eV],command:"set",path:["schema",t,JF],args:w}),et[YF]({[rV]:g,[uV]:e,performTransaction:t=>{for(const o of a)y[XF]({store:(0,zs.Kv)(e,o[eV]),operation:o,[aV]:t})}})}),[o,n,w,t,g]),I=(0,P.VK)((()=>{var e,t;return(null===(e=o[uV]())||void 0===e||null===(t=e.getName())||void 0===t?void 0:t.toString())||""}),[o]),D=(0,P.VK)((()=>{const e=o[uV]();return e?(0,Vt.getUpdateAiInferencesForCollectionRunningState)(e.getFormat(),t):{isRunning:!1,numPagesFilled:void 0,[$F]:void 0}}),[o,t]),F=(0,l.useCallback)((async()=>{const e=o[uV]();e&&n&&await uD.autofillPropertyForCollection({[rV]:g,[uV]:e,[QF]:n,[fV]:t,...w&&{includedCollectionSchemaUpdateOp:{[eV]:e[eV],command:"set",path:["schema",t,"ai_inference"],args:w}}})}),[g,n,t,o,w]),V=(0,l.useCallback)((async()=>{n&&(0,Qe.isAiAutofillablePropertySchema)(n)&&se().isEqual(w,n[JF])?m[jF]({[gV]:i}):w&&(!function(e){if(!e)return!1;switch(e[iV]){case wF:case bF:return!1;case"extract":case hF:return!0;default:throw(0,k.unreachable)(e)}}(w)||w[oV]&&!(w[oV][qF]>lD)?(null==c||!c[HF])&&null!=w&&w[HF]&&b&&n?await cD.r({sourceAction:"auto_update",[zF]:n.name,collectionName:I})&&Z():Z():x(!0))}),[I,i,c,w,Z,b,n]),K=(0,l.useCallback)((()=>{const e=o[uV]();if(!e||!c)return;p.trackAiAutofillSettingsAction(g,{[iV]:"remove_ai_inference",ai_inference_type:c[iV],[tV]:e.id});const n=[];n.push({[eV]:e[eV],command:"set",path:["schema",t,JF],args:void 0}),et[YF]({[rV]:g,[uV]:e,performTransaction:t=>{for(const o of n)y[XF]({store:(0,zs.Kv)(e,o[eV]),operation:o,[aV]:t})}}),m[LF]({[gV]:i})}),[g,t,i,o,c]),R=n&&(0,Qe.isAiAutofillablePropertySchema)(n)&&se().isEqual(w,n[JF]),N=(0,l.useCallback)((async()=>new Promise((e=>{tt.showDialog({showCancel:!1,keepFocus:!1,message:a()(bD.sg,{[WF]:GF,gap:8},void 0,A.Z.magicWand(f.confirmDiscardChangesDialogIconStyle),a()("div",{[UF]:f.confirmDiscardChangesDialogMessageStyle},void 0,a()(u.FormattedMessage,{[vV]:"Do you want to discard changes for AI autofill?",id:"database.viewSettings.propertyTab.aiAutofill.confirmDiscordChangesDialog.message"}))),items:[{label:a()(u.FormattedMessage,{[vV]:"Discard",id:"database.viewSettings.propertyTab.aiAutofill.confirmDiscordChangesDialog.acceptLabel"}),[OF]:"red",onAccept:()=>e(!0)},{label:a()(u.FormattedMessage,{[vV]:"Continue editing",id:"database.viewSettings.propertyTab.aiAutofill.confirmDiscordChangesDialog.cancelLabel"}),onAccept:()=>e(!1)}]})}))),[f]),O=(0,l.useCallback)((async()=>{(R||await N())&&m[LF]({[gV]:i})}),[R,i,N]),W=(0,l.useCallback)((async()=>{(R||await N())&&m[jF]({[gV]:i})}),[R,i,N]),U=(0,P.VK)((()=>{var e;const t=(null===(e=vD.default[mV].data)||void 0===e?void 0:e.addOns)??[];return(0,dD.de)(t)}),[]),G=(0,T.Fg)(),L=(0,l.useMemo)((()=>function(e){var t;let{[rV]:o,aiInference:i,collectionSchema:n,setAiInference:r,[fV]:s,theme:l}=e;if(!i)return;switch(i[iV]){case wF:return;case bF:const e=se().compact((0,k.objectKeys)(n).map((e=>{if(e===s)return;const t=n[e];if(t&&(0,sD.K9)(t)){var o;if("text"===t[iV]&&"translate"===(null===(o=t[JF])||void 0===o?void 0:o[iV]))return;return{id:e,[XD]:t.name,icon:a()(As.ZP,{icon:t.icon,[iV]:t[iV],theme:l,size:16})}}})));return[{[zD]:e,selectedId:(null===(t=i[SF])||void 0===t?void 0:t[qF])>0?i[SF][0]:_F,onSelect:e=>{r({...i,[SF]:[e]})},selectorTitle:hV.whatToTranslate},{[zD]:sD.nI.map((e=>{let{key:t,name:o}=e;return{id:t,[XD]:Et.default[FF](o)}})),selectedId:i.toLanguage,onSelect:e=>{r({...i,toLanguage:e})},selectorTitle:hV.translateTo}];case"extract":case hF:return;default:(0,k.unreachable)(i)}}({[rV]:g,aiInference:w,collectionSchema:d,setAiInference:_,[fV]:t,theme:G})),[g,w,d,_,t,G]);return n&&(0,Qe.isAiAutofillablePropertySchema)(n)&&r?a()(KZ.Z,{capture:!0,onEsc:W},void 0,l[MF](B.ZP,s()({},e,{[_F]:a()(u.FormattedMessage,{[vV]:"Fill ‚Äú{propertyName}‚Äù with AI",id:"database.viewSettings.propertyTab.aiAutofill.title",values:{[zF]:n.name}}),handleBackArrowClick:O,handleClose:W}),!v&&a()(j.Z,{[UF]:f.menuItemStyle},void 0,a()(u.FormattedMessage,{[vV]:"You don't have permission to set up AI autofill on this database.",id:"database.viewSettings.propertyTab.aiAutofill.noSetupPermission"})),a()(bV,{[QF]:n,previousPromptByAiInferenceType:S[nV],isAutofillSetupEnabled:v,draftAiInference:w,setDraftAiInference:_,[rV]:g}),a()(PV,{[yV]:o,[QF]:n,[rV]:g,[fV]:t,setAiInference:_,aiInference:w}),w&&a()(j.Z,{topBorder:!0},void 0,a()(_V,{[rV]:g,aiInference:w,setAiInference:_,[yV]:o,isAutofillSetupEnabled:v,shouldShowUserPromptIsInvalidError:M,setShouldShowUserPromptIsInvalidError:x}),a()(TV,{[rV]:g,optionProps:L}),a()(kV,{[rV]:g,isAutofillSetupEnabled:v,[yV]:o,tryAutofillStore:h,[QF]:n,[fV]:t,aiInference:w}),a()(it.Z,{[UF]:{...f[NF],margin:"8px 12px 12px 12px",[RF]:R?"none":"flex"},[KF]:V,[EF]:!v},void 0,a()(u.FormattedMessage,R?{[vV]:"Done",id:"database.viewSettings.propertyTab.aiAutofill.saveButtonAllSaved"}:{[vV]:"Save changes",id:"database.viewSettings.propertyTab.aiAutofill.saveButtonWithChanges"}))),a()(j.Z,{topBorder:!0,[_F]:g[VF][BF]&&Et.default[FF](hV.toggleFillWithAiSectionLabel)},void 0,void 0!==c&&l[MF](l[PF],null,a()(xn.Z,{disableTooltip:U,[AF]:()=>a()(SD.qQ,{[uV]:r,[QF]:n}),[TF]:e=>l[MF](E.Z,s()({icon:e=>a()(SD.Xh,{updateAiInferencesTaskStatus:D,[xF]:e,progressIconStyle:{[DF]:4,[IF]:4,[ZF]:2}}),[_F]:a()(SD.ZP,{updateAiInferencesTaskStatus:D}),[kF]:void 0!==D.numPagesFilled&&void 0!==D[$F]&&a()(SD.Y7,{updateAiInferencesTaskStatus:D}),focused:!1,[KF]:F,[EF]:D.isRunning||!v},e))}),a()(E.Z,{icon:A.Z.trash,isRed:!0,focused:!1,[_F]:Et.default[FF](hV.removeAutofillButton),[KF]:K,[EF]:!v})),a()(Ub.Z,{href:(0,Nb.getLocalizedUrl)("guides.aiAutofill"),[_F]:a()(u.FormattedMessage,{[vV]:"Learn about AI autofill",id:"database.viewSettings.propertyTab.aiAutofill.learnMoreLink"}),[CF]:"collection_ai_autofill_menu"})))):null}function bV(e){let{[QF]:t,previousPromptByAiInferenceType:o,isAutofillSetupEnabled:i,draftAiInference:n,setDraftAiInference:r,[rV]:s}=e;window.__c={n:"AiPromptTypeSelectorSections"};const d=(0,P.VK)((()=>(0,Bt.k4)()),[]),c=(0,l.useCallback)((e=>{var i,n,a,s,l,c,u,p;if(!t||!(0,Qe.isAiAutofillablePropertySchema)(t)||!e)return;let m;switch(e){case wF:m={[iV]:e,[HF]:d};break;case bF:m={[iV]:e,[HF]:d,[SF]:(null===(i=t[JF])||void 0===i?void 0:i[iV])===e?null===(n=t[JF])||void 0===n?void 0:n[SF]:[_F],toLanguage:(null===(a=t[JF])||void 0===a?void 0:a[iV])===e?null===(s=t[JF])||void 0===s?void 0:s.toLanguage:"english"};break;case"extract":m={[iV]:e,[oV]:(null===(l=t[JF])||void 0===l?void 0:l[iV])===e?null===(c=t[JF])||void 0===c?void 0:c[oV]:o[e]??"",[HF]:d};break;case hF:m={[iV]:e,[oV]:(null===(u=t[JF])||void 0===u?void 0:u[iV])===e?null===(p=t[JF])||void 0===p?void 0:p[oV]:o[e]??"",[HF]:d};break;default:(0,k.unreachable)(e)}r(m)}),[d,o,t,r]),p=(0,T.Fg)();return t&&(0,Qe.isAiAutofillablePropertySchema)(t)?a()(st.ZP,{popupType:s[VF][BF]?st.Z4.SlideUp:st.Z4.Popup,[oF]:hD,[TF]:e=>{const o=se().compact((0,k.objectKeys)(yD.OE[t[iV]]).map((t=>{if("translate"!==t||(0,yD.hu)())return{key:t,[TF]:e=>{const o=yD.OE[vF][t];return a()(Nt.Z,{focused:!1,[KF]:e[KF],icon:o.svg({[fF]:20,[yF]:24,fill:p[gF]}),[_F]:Et.default[FF](o.name),checkState:(null==n?void 0:n[iV])===t})},action:()=>{e.close(),c(t)}}}))),i={key:mF,[TF]:e=>l[MF](j.Z,e),items:o};return a()(lt.Z,{menuType:at.og.Popup,minWidth:260,maxWidth:"100vw"},void 0,a()(Wt.Z,{[iV]:Wt.i[pF],[uF]:void 0,[cF]:[i]}))},renderOrigin:e=>{let{[KF]:t}=e;return a()("div",{[UF]:{[RF]:dF,[WF]:GF,[lF]:sF,[rF]:14,[IF]:4,[ZF]:4,[DF]:8,[aF]:12,[nF]:12,[iF]:eV,[fF]:28},[KF]:t},void 0,a()(u.FormattedMessage,{[vV]:"Fill with",id:"CollectionSettingsPropertyAiAutofill.ClosedSelector.Title"}),a()(wV,{aiActionType:null==n?void 0:n[iV]}))}}):null}function wV(e){let{aiActionType:t}=e;window.__c={n:"AiActionRenderer"};const o=(0,T.Fg)(),i=t?yD.OE[vF][t]:{name:hV.noAiAutofillSelected,svg:()=>null};return a()("div",{[UF]:{[RF]:dF,[WF]:GF,[iF]:eV,[rF]:14,[aF]:15,[tF]:0}},void 0,a()("div",{[UF]:{[OF]:o[eF]}},void 0,i.svg({[fF]:16,[yF]:16,[ZF]:2})),a()("div",{[UF]:{[OF]:o[JD],[aF]:4}},void 0,l[MF](u.FormattedMessage,i.name)),a()("div",{[UF]:{[OF]:o[eF],[aF]:4}},void 0,A.Z[YD]({[fF]:12,[yF]:12})))}function CV(e){let{id:t,[XD]:o,icon:i}=e;window.__c={n:"AiAutofillOptionRenderer"};const n=(0,T.Fg)();return a()("div",{[UF]:{[RF]:dF,[WF]:GF,[iF]:eV,[rF]:14,[aF]:15,[tF]:0}},void 0,i,a()("div",{[UF]:{[OF]:n[JD],[aF]:4}},void 0,o??t),a()("div",{[UF]:{[OF]:n[eF],[aF]:4}},void 0,A.Z[YD]({[fF]:12,[yF]:12})))}function PV(e){let{[yV]:t,[QF]:o,[rV]:i,[fV]:n,setAiInference:r,aiInference:d}=e;window.__c={n:"AutoUpdateOnPageEditsToggle"};const p=(0,l.useRef)((0,c.default)()),m=(0,P.VK)((()=>{var e;const t=(null===(e=vD.default[mV].data)||void 0===e?void 0:e.addOns)??[];return(0,dD.de)(t)}),[]),g=(0,l.useCallback)((()=>{if(!t[uV]())return;if(!d)return;if(!(m||null!=d&&d[HF]))return void uD.triggerAiAutofillUpsell({[rV]:i,from:"ai_autofill_on_page_edit"});const e={...d,[HF]:!d[HF]};r(e)}),[t,d,m,r,i]);if(!d)return null;return a()(xn.Z,{[AF]:()=>a()("div",{[UF]:{[yF]:159}},void 0,a()("div",{[UF]:{[OF]:jD,[QD]:500,wordWrap:qD,[HD]:"pre-wrap"}},void 0,l[MF](u.FormattedMessage,hV.autoUpdateExplanationMessage)),!m&&a()("div",{[UF]:{[OF]:"#ACABA9",[QD]:500}},void 0,l[MF](u.FormattedMessage,hV.onlyWithAiAddOnMessage))),[TF]:e=>(e=>l[MF]("div",s()({[UF]:{[RF]:dF,[DF]:0,marginBottom:12,[IF]:16,[ZF]:12,gap:8,[WF]:GF,[lF]:sF,[fF]:28}},e),a()("label",{htmlFor:p[nV],[UF]:{[RF]:$D,[rF]:"14px",[QD]:"400",userSelect:"none",[iF]:eV}},void 0,l[MF](u.FormattedMessage,hV.updateOnPageEdits)),a()(Mn.Z,{inputId:p[nV],on:!!d[HF],[KF]:g,[EF]:!1,noColor:!1})))(e)})}function TV(e){let{[rV]:t,optionProps:o}=e;return o&&o[qF]>0?a()(j.Z,{[_F]:Et.default[FF](hV.optionsSectionTitle),isInput:!0,[UF]:{[DF]:-4}},void 0,o.map(((e,o)=>a()(AV,{[rV]:t,[zD]:e[zD],selectedId:e.selectedId,onSelect:e.onSelect,selectorTitle:e.selectorTitle},o)))):null}function AV(e){let{[rV]:t,[zD]:o,selectedId:i,onSelect:n,selectorTitle:r}=e;const s=o.find((e=>e.id===i));return a()(st.ZP,{popupType:t[VF][BF]?st.Z4.SlideUp:st.Z4.Popup,[oF]:new V.Z,[TF]:e=>{const t=o.map((t=>{let{id:o,[XD]:r,icon:s}=t;return{key:o,[TF]:e=>a()(Nt.Z,{focused:!1,[KF]:e[KF],icon:s,[_F]:r??o,checkState:o===i}),action:()=>{e.close(),n(o)}}})),r={key:mF,[TF]:e=>l[MF](j.Z,e),items:t};return a()(lt.Z,{menuType:at.og.Popup,minWidth:260,maxWidth:"100vw"},void 0,a()(Wt.Z,{[iV]:Wt.i[pF],[uF]:void 0,[cF]:[r]}))},renderOrigin:e=>{let{[KF]:t}=e;return a()("div",{[UF]:{[RF]:dF,[WF]:GF,[lF]:sF,[rF]:14,[IF]:4,[ZF]:4,[DF]:8,[aF]:12,[nF]:12,[iF]:eV,[fF]:28},[KF]:t},void 0,Et.default[FF](r),s&&a()(CV,{id:s.id,[XD]:s[XD],icon:s.icon}))}})}function kV(e){let{[rV]:t,isAutofillSetupEnabled:o,[yV]:i,tryAutofillStore:n,[QF]:r,[fV]:d,aiInference:m}=e;window.__c={n:"TryOnThisViewActionSection"};const[g,y]=(0,l.useState)((0,c.default)()),f=(0,l.useRef)((0,c.default)()),v=(0,P.VK)((()=>n[mV].stage),[n]),h=(0,P.VK)((()=>{const e=i.contextType;if("collectionPage"===e)return{[iV]:"page",[LD]:se().compact([(0,mD.getCurrentPageStore)()])};if("collectionTypedView"===e||"collectionView"===e){var t,o;const e=i[GD](),n=i[uV]();if(!e||!n)return{[iV]:UD,[LD]:[]};const a=i[WD][mV],r="board"===i.getViewType()?{groupByKey:"board_columns_by",[OD]:"board_columns"}:{groupByKey:ND,[OD]:RD},s=i[pV][mV],l=a[r.groupByKey],d=(0,k.isDefined)(l)?(0,Eb.Qq)({schema:s,groupBy:l}):[],c=Object.values((null===(t=i[KD][mV])||void 0===t?void 0:t[ED])??{}).find((e=>"groups"===e[iV])),u=(0,Rb.Cz)({[BD]:e[BD],schema:s,groupBy:l,formatGroups:a[r[OD]]??[],schemaGroups:d,[ED]:(null==c?void 0:c.results)??[],[VD]:i[FD][mV],viewAppConfigUri:null===(o=i.collectionViewStore())||void 0===o?void 0:o.getFormat().app_config_uri});let p,m;if(0===u[qF]){const e=i[KD][mV];if(e){const t=Object.values(e[ED]).find((e=>"results"===e[iV]));p=((null==t?void 0:t.blockIds)??[]).map((e=>zs.G.createChildStore(n,{table:"block",id:e})))}else p=[]}else{p=[];for(const e of u){const t=i.groupsStore.getGroupState(e),o=null==t?void 0:t.resultsStore[mV];p.push(...o??[])}}if(p=se().uniqBy(p,(e=>e.id)),i[DD][mV]){m=[];const e=i.subitemTreeStore[mV];for(const t of p){if(m[qF]>=5)break;const o=e.children.find((e=>e.value.store.id===t.id));if(o){const e=[];(0,gD.yU)({results:e,tree:o}),m.push(...e)}}}else m=p;return{[iV]:UD,[LD]:m.slice(0,5)}}throw new Error(`Unexpected context type: ${e}`)}),[i]),S=(0,l.useCallback)((()=>{var e;p.trackAiAutofillAction(t,{ai_inference_type:m[iV],[iV]:"undo_from_collection_settings",inference_id:g,[tV]:null===(e=i[uV]())||void 0===e?void 0:e.id,session_id:f[nV]}),"not_started"!==v&&(pD.Yw(t,!1),n[ID]({stage:cV}))}),[t,m,g,i,v,n]),b=(0,k.isNonEmptyArray)(h[LD]),w=MV({[ZD]:o&&b});if(t[VF][BF])return null;if(!(0,Qe.getAiInferenceFromPropertySchema)(r))return null;let C;return C=b?"collection"===h[iV]?a()(u.FormattedMessage,{[vV]:"Updates the first {maxPages} pages. You can undo changes anytime.",id:"database.viewSettings.propertyTab.aiAutofill.tryOnCollectionDescription",values:{maxPages:5}}):a()(u.FormattedMessage,{[vV]:'Updates "{propertyName}" on this page. You can undo changes anytime.',id:"database.viewSettings.propertyTab.aiAutofill.tryOnPageDescription",values:{[zF]:r.name}}):a()(u.FormattedMessage,{[vV]:"Add more pages or remove filters to try AI on this view.",id:"database.viewSettings.propertyTab.tryAutofillDisabledDescription"}),a()(l[PF],{},void 0,a()("div",{[UF]:{margin:"8px 12px"}},void 0,a()(bD.X2,{gap:8},void 0,a()(Ia.Z,{[EF]:!o||!b,[UF]:{...w[NF],...w.undoButtonStyle,..."not_started"===v&&{[RF]:"none"}},[KF]:S},void 0,a()(u.FormattedMessage,{[vV]:"Undo",id:"database.viewSettings.propertyTab.aiAutofill.undoButton"})),a()(xn.Z,{[AF]:()=>a()("div",{},void 0,C),[TF]:e=>l[MF](Ia.Z,s()({},e,{[EF]:!o||!b,[UF]:{...w[NF],...w.tryButtonStyle},[MD]:w.tryButtonHoveredStyle,pressedStyle:w.tryButtonPressedStyle,[KF]:async()=>{if((0,k.isNonEmptyArray)(h[LD])){const e=(0,c.default)();y(e),n[ID]({stage:"in_progress"}),await uD[xD]({[rV]:t,stores:h[LD],[fV]:d,[QF]:r,aiInferenceOverride:m,userEventForAnalytics:"generate_from_try_on_view_button",sessionIdForAnalytics:f[nV],[yV]:i,from:"ai_autofill_settings"}),n[ID]({stage:"complete"})}}}),"in_progress"===v?a()(CD.Z,{}):l[MF](l[PF],null,A.Z.magicWand({[yF]:16,..."not_started"!==v&&{[RF]:"none"}}),"not_started"!==v?a()(u.FormattedMessage,{[vV]:"Try again",id:"database.viewSettings.propertyTab.aiAutofill.tryAgain"}):"collection"===h[iV]?a()(u.FormattedMessage,{[vV]:"Try on this view",id:"database.viewSettings.propertyTab.aiAutofill.tryOnCollection"}):a()(u.FormattedMessage,{[vV]:"Try on this page",id:"database.viewSettings.propertyTab.aiAutofill.tryOnPage"})))}))))}function _V(e){let{[rV]:t,aiInference:o,setAiInference:i,[yV]:n,isAutofillSetupEnabled:r,shouldShowUserPromptIsInvalidError:s,setShouldShowUserPromptIsInvalidError:d}=e;window.__c={n:"AiAutofillPromptInputMenuItem"};const c=function(e){if(e)switch(e[iV]){case wF:case bF:return;case"extract":return{aiInferenceType:e[iV],sectionTitle:hV.extractPromptSectionTitle,[_D]:hV.extractPromptInputPlaceholder,value:e[oV]};case hF:return{aiInferenceType:e[iV],sectionTitle:hV.customPromptSectionTitle,[_D]:hV.customPromptInputPlaceholder,value:e[oV]};default:(0,k.unreachable)(e)}}(o),p=(0,P.VK)((()=>(0,Bt.k4)()),[]),m=(0,l.useCallback)((e=>{n[uV]()&&c&&(e.target.value&&e.target.value[qF]<=lD?d(!1):e.target.value[qF]>lD&&d(!0),i({[iV]:c.aiInferenceType,[oV]:e.target.value,[HF]:(null==o?void 0:o[HF])??p}))}),[null==o?void 0:o[HF],n,p,c,i,d]);return c?a()(j.Z,{[_F]:Et.default[FF](c.sectionTitle),isInput:!0,[UF]:{[DF]:-4}},void 0,a()(wD.Z,{capture:!0,allowEsc:!0},void 0,a()(Ot.ZP,{inputOuterStyle:{margin:t[VF][BF]?"8px 0":0,border:s?"1px solid red":void 0},[iV]:vF,value:c.value,onChange:m,[kD]:Et.default[FF](c[_D]),textarea:!0,[EF]:!r,autosize:!0,autosizeMinHeight:100,autosizeMaxHeight:600},c.aiInferenceType)),s&&a()("div",{[UF]:{[RF]:"flex",[WF]:"center",[aF]:12,[rF]:12}},void 0,A.Z.warning({[yF]:12,[fF]:12,fill:"#D34F43"}),a()("div",{[UF]:{[OF]:"#D34F43",[aF]:4}},void 0,c.value[qF]>lD?a()(u.FormattedMessage,{[vV]:"Instruction is too long",id:"CollectionSettings.propertyTab.aiAutofill.promptInput.exceedsMaxLength"}):a()(u.FormattedMessage,{[vV]:"Required",id:"CollectionSettings.propertyTab.aiAutofill.promptInput.required"})))):null}function MV(e){const t=(0,T.Fg)();return(0,T.yK)((()=>({[NF]:{flexGrow:1,[RF]:dF,[WF]:GF,[lF]:GF,gap:8},menuItemStyle:{[rF]:13,borderRadius:6,[AD]:t[PD][TD][50],[OF]:t[PD][TD][500],margin:"8px 12px",padding:"8px 12px"},undoButtonStyle:{border:`1px solid ${t[PD].gray[100]}`,[dF]:1},tryButtonStyle:{[QD]:500,[dF]:1,[AD]:null!=e&&e[ZD]?"light"===t.mode?t[PD][TD][50]:t[PD][TD][200]:t[PD].gray[50],[OF]:null!=e&&e[ZD]?t[gF]:t[PD].gray[400]},fillAllPagesWandIconStyle:{fill:t[gF]},tryButtonHoveredStyle:{[AD]:t[PD][TD][100]},tryButtonPressedStyle:{[AD]:t[PD][TD][200]},confirmDiscardChangesDialogIconStyle:{[yF]:32,[fF]:32,fill:t[gF],paddingTop:8},confirmDiscardChangesDialogMessageStyle:{textAlign:GF,[QD]:500}})),[t,null==e?void 0:e[ZD]])}var xV=o(90468),ZV=o(29369),IV=o(16173),DV=o(29637);const FV=o(85).a67,VV=o(85).qdS,BV=o(85).lDm,EV=o(85).ilE,KV=o(85).jkj,RV=o(85).Bgy,NV=o(85).ij9,OV=o(85).IcT,WV=o(85).zkt,UV=o(85).JwD,GV=o(85).ffk,LV=o(85).eiN,zV=o(85).wlw,HV=o(85).S9S,qV=o(85).v3M,jV=o(85).Tdw,QV=o(85).LCr,$V=o(85).qU4,XV=o(85).E3P,YV=o(85).JJj,JV=o(85).XlZ,eB=o(85).irY,tB=o(85).Yzm,oB=o(85).HxR,iB=o(85).rvt,nB=(o(85).JPF,o(85).kk0),aB=o(85).wgE,rB=o(85).M9t,sB=o(85).gRm,lB=o(85).qLW,dB=o(85).uzK,cB=o(85).oWD,uB=(o(85).Uk6,o(85).nx5),pB=o(85).tuH,mB=(0,u.defineMessages)({[pB]:{id:"appTemplateUpgradeActions.upgradeConfirmationDialog.upgrade.label",[uB]:"Upgrade"},cancelUpgradeButton:{id:"appTemplateUpgradeActions.upgradeConfirmationDialog.cancelUpgrade.label",[uB]:"Don't upgrade"}});async function gB(e){const{[aB]:t,[dB]:o,[oB]:i}=e,n=null==o?void 0:o[lB]()[sB],r=null==o?void 0:o.getParentStore();if(!o||n!==hS.TZ&&n!==hS.pz)return!1;const s=n===hS.TZ?o:await $T[rB]({[aB]:t,[dB]:o,databaseUri:hS.iS}),d=n===hS.pz?o:await $T[rB]({[aB]:t,[dB]:o,databaseUri:hS.p$});return!(!(s&&d&&r)||r.table!==xV.bx&&r.table!==Is.iU&&r.table!==ZV.e0)&&(tt.showDialog({message:l.createElement(l.Fragment,null,a()("div",{},void 0,"Upgrade Existing Sprints to Latest?"),a()("div",{style:{fontSize:12,padding:8}},void 0,"This will update your Sprints Database, and change some existing views and properties.")),items:[{label:Et.default[tB](mB[pB]),color:"red",onAccept:async()=>{await async function(e){var t;const{[aB]:o,appParentStore:i,[dB]:n}=e,a=null===(t=n[lB]())||void 0===t?void 0:t[JV],r=n[nB]();if(!a||!r)return;const s=await yB(n,i),l=(0,Qe.getNormalizedSchema)({format:r[lB](),space_id:r.getSpaceId(),schema:r.getSchema()});y[YV]({userAction:"appTemplateActions.upgradeSprintsDatabaseFromV1ToV2",[aB]:o,perform:e=>{et.updateCollection({[aB]:o,[cB]:r,update:fB[hS.p$](l,r[lB]()),[QV]:e}),s.forEach((t=>{const o=t.id,i=t[lB](),n=t.getQuery(l);a["notion://sprints/sprints_timeline_view"]===o?et[XV]({[$V]:t,update:fB[jV](i,n),[QV]:e}):a["notion://sprints/sprints_view"]===o&&et[XV]({[$V]:t,update:fB[qV](i,n),[QV]:e})}))}})}({[aB]:t,appParentStore:r,[dB]:d}),await async function(e){var t;const{[aB]:o,appParentStore:i,[dB]:n}=e,a=null===(t=n[lB]())||void 0===t?void 0:t[JV];if(!a)return;const r=await yB(n,i);y[YV]({userAction:"appTemplateActions.upgradeTasksDatabaseSprintsFeatureFromV1ToV2",[aB]:o,perform:e=>{r.forEach((t=>{const o=t.id,i=t[lB]();if(a[hS.g3]===o){const o=fB[hS.g3](i);et[XV]({[$V]:t,update:o,[QV]:e})}else a[hS.y$]===o&&et[XV]({[$V]:t,update:fB[hS.y$](i),[QV]:e})}))}})}({[aB]:t,appParentStore:r,[dB]:s}),i.setState({open:!1,stack:[]})}},{label:Et.default[tB](mB.cancelUpgradeButton),onAccept:()=>{}}],showCancel:!1,keepFocus:!0}),!0)}async function yB(e,t){return await Promise.all(e[eB]().map((async e=>{const o=zs.Xr.createChildStore(t,e);return await o.load(),o})))}const fB={[hS.g3]:e=>({name:Et.default[tB](DV.sY[HV]),format:{...e,[zV]:[...(e[zV]??[])[LV]((e=>e[LV][GV]!==hS.Es[UV])),DV.Aq]}}),[hS.y$]:e=>({format:{...e,[zV]:[...(e[zV]??[])[LV]((e=>e[LV][GV]!==hS.Es[WV]))],[OV]:[...(e[OV]??[])[LV]((e=>e[GV]!==hS.Es[UV])),{[GV]:hS.Es[UV],[NV]:!1}]}}),[hS.p$]:(e,t)=>({schema:{...e,[hS.b0.UniqueId]:IV.eK(Et.default.getIntl())[hS.b0.UniqueId],[hS.b0[RV]]:DV.X$,[hS.b0[KV]]:DV.sU,[hS.b0[iB]]:IV.eK(Et.default.getIntl())[hS.b0[iB]]},format:{...t,[JV]:{...(null==t?void 0:t[JV])||{},[hS.b0.UniqueId]:hS.b0.UniqueId,[hS.b0[RV]]:hS.b0[RV],[hS.b0[KV]]:hS.b0[KV],[hS.b0[iB]]:hS.b0[iB]}}}),[jV]:(e,t)=>({format:{...e,[OV]:[...(e[OV]??[])[LV]((e=>e[GV]!==hS.b0[EV])),{width:147,[NV]:!1,[GV]:hS.b0[EV]},{width:147,[NV]:!0,[GV]:hS.b0[iB]}],[BV]:[...(e[BV]??[])[LV]((e=>e[GV]!==hS.b0[EV])),{width:132,[NV]:!1,[GV]:hS.b0[EV]},{width:132,[NV]:!0,[GV]:hS.b0[iB]}],[VV]:{sort:{type:FV},type:"status",groupBy:"group",[GV]:hS.b0[iB]}},query2:{...t??{},sort:[...(null==t?void 0:t.sort)??[],{[GV]:hS.b0[iB],direction:FV}]}}),[qV]:(e,t)=>({format:{...e,[OV]:[...(e[OV]??[])[LV]((e=>e[GV]!==hS.b0[EV])),{width:137,[NV]:!1,[GV]:hS.b0[EV]},{width:137,[NV]:!0,[GV]:hS.b0[iB]},{width:75,[NV]:!0,[GV]:hS.b0[RV]}],[VV]:{sort:{type:FV},type:"status",groupBy:"group",[GV]:hS.b0[iB]}},query2:{...t??{},sort:[...(null==t?void 0:t.sort)??[],{[GV]:hS.b0[iB],direction:FV}]}})};var vB=o(90559),hB=o(10070),SB=o(87085);const bB=o(85).Hyq;function wB(e){var t,o;const{render:i,showDisabledTooltip:n,property:r,overrideCaption:s}=e;let l=r.description;if(s)l=s;else if(n){var d;l=null===(d=r.canOnlyAdminAuth)||void 0===d?void 0:d[bB]}return a()(In,{render:i,showImage:!n,caption:l,tooltipImage:null===(t=r.tooltipImage)||void 0===t?void 0:t.img,tooltipImageScale:null===(o=r.tooltipImage)||void 0===o?void 0:o.scale})}var CB=o(54119),PB=o(15560),TB=o(14871),AB=o(95477);var kB=o(69834),_B=o(32363);const MB=o(85).NN6,xB=o(85).r5K,ZB=o(85).gnz,IB=o(85).Hyq,DB=o(85).VUQ,FB=o(85).unR;var VB=o(33954),BB=o(85644),EB=o(12205);const KB=o(85).oEb,RB=o(85).A89,NB=o(85).Yzm,OB=o(85).VUQ,WB=o(85).k9$,UB=o(85).$Lj,GB=o(85).MRL,LB=o(85).Er,zB=o(85).uzK,HB=o(85).wgE,qB=o(85).$9_,jB=o(85).GGR,QB=o(85).Lfz,$B=o(85).D7I,XB=o(85).auS,YB=o(85).jkI,JB=o(85).H1U,eE=o(85).rOg,tE=o(85).sM5,oE=o(85).SDR,iE=o(85).cbT,nE=o(85).xts,aE=o(85).UBi,rE=o(85).gRm,sE=o(85).qLW,lE=o(85).oWD,dE=o(85).OBh,cE=o(85).P24,uE=o(85).nx5,pE=(0,u.defineMessages)({duplicateGithubPropertyTooltip:{[uE]:"A database can only have one GitHub Pull Requests property",id:"database.viewSettings.propertyTab.duplicateGithubProperty.tooltip"},wikiGithubPropertyTooltip:{[uE]:"A wiki cannot have a GitHub Pull Requests property",id:"database.viewSettings.propertyTab.wikiGithubProperty.tooltip"},syncedDatabaseGithubPropertyTooltip:{[uE]:"A synced database cannot have a GitHub Pull Requests property",id:"database.viewSettings.propertyTab.syncedDatabaseGithubProperty.tooltip"},newPill:{[uE]:"New",id:"database.viewSettings.newHighlightedFeature"}});function mE(e){let{[cE]:t,propertyTypes:o,onAccept:i,[dE]:n}=e;const r=(0,T.Fg)(),d=(0,P.VK)((()=>{var e;return null===(e=t[lE]())||void 0===e?void 0:e[aE]()}),[t]),c=(0,P.VK)((()=>t[zB]()),[t]),u=l[nE]((()=>{if(!(0,BB.iL)()||null==c||!c[LB]()||n&&"verification"!==n.type)return!1;for(const e in d){const t=d[e];if("verification"===(null==t?void 0:t.type))return!1;if((0,Ts.isGithubPrRelationProperty)(t))return!1}return!0}),[n,d,c]),p=l[nE]((()=>{for(const t in d){var e;const o=d[t];if("text"===(null==o?void 0:o.type)&&"summarize"===(null===(e=o.ai_inference)||void 0===e?void 0:e.type))return!1}return!0}),[d]);return{standardAndDerivedPropertyTypes:(0,P.VK)((()=>o.filter((e=>"button"===e?(0,tk.PN)():"auto_increment_id"===e?"local"===AB.default.env||Ls.default.checkGate("unique_id"):"verification"===e?u():"ai_summary"===e?p():"ai_translate"!==e||(0,yD.hu)()))),[o,u,p]),renderStandardOrDerivedProperty:l[nE](((e,o)=>({key:e,render:i=>{const d=(null==n?void 0:n.type)===e,c=function(e,t,o){if("auto_increment_id"===t){var i;const t=e[lE](),n=null==t?void 0:t[UB](),a=Boolean(null==t?void 0:t[WB]());if(n)return Et.default[NB](VB.zU[RB]);if(a)return Et.default[NB](VB.zU[KB]);if(null!=o&&o.type)return Et.default[NB](VB.zU.convert_to_auto_increment_id_property);const r=t&&t[sE](),s=t&&(null===(i=t.getSpaceStore())||void 0===i?void 0:i.id),l=t&&t[aE](),d=t&&t.getDeletedSchema();if(!(r&&s&&l&&d))return;if(t&&(0,vB.cj)({format:r,space_id:s,schema:l,deleted_schema:d}))return Et.default[NB](VB.zU.duplicate_auto_increment_id_property)}}(t,e,n),u=void 0!==c,p=l[$B](Nt.Z,s()({},i,{checkState:d,title:a()("div",{style:{[tE]:eE,[JB]:YB}},void 0,o??Bt.SO[e],!1),icon:a()(As.ZP,{type:e,icon:void 0,size:16,theme:r,style:{fill:(0,Qe.isDerivedPropertyType)(e)?r[GB]:r[XB]}}),disabled:u,disabledFeedback:u}));return c?a()(xn.Z,{placement:xn.Z.Placement.Left,render:e=>l[$B]("div",e,p),renderTooltip:()=>c,style:{whiteSpace:"break-spaces"}}):p},action:()=>{i(e,o)}})),[n,t,r,i])}}const gE=new Set([hm.Nw]);function yE(e,t){const o=(0,C.O7)(),i=(0,u.useIntl)(),n=(0,P.VK)((()=>os.Z.bots.state),[]),r=(0,P.VK)((()=>e[lE]()),[e]),d=(0,P.VK)((()=>null==r?void 0:r[aE]()),[r]),c=(0,P.VK)((()=>null==r?void 0:r[UB]()),[r]),p=(0,P.VK)((()=>{if(void 0===t)return function(e){if(!e)return[];const t=Ls.default[FB]("google_drive_connected_relation"),o=Ls.default[FB]("figma_connected_relation"),i=Ls.default[FB]("zendesk_connected_relation"),n=Ls.default[FB]("connected_relation"),a=e.getFormat().app_config_uri===hS.iS,r=os.Z.state;if(!r.loaded)return[];const s=r.integrations,l={};if(!a){const e=s.find((e=>e.id===hm.U9)),t=(0,DV.GT)();var d;e&&(l[t.name]={name:t.name,pattern:kB.x,[DB]:e,tooltipImage:{img:kn.Z.images.tooltips.properties.githubSyncPullStatusPng,scale:.5},description:t.description,canOnlyAdminAuth:{[IB]:null===(d=t.canOnlyAdminAuth)||void 0===d?void 0:d[IB]}})}const c=[];if(t&&c.push(hm.f3),o&&c.push(hm.mQ),i&&c.push(hm.Nw),c.forEach((e=>{const t=s.find((t=>t.id===e));if(null!=t&&t.info[ZB])for(const i of t.info[ZB]){var o;null!==(o=i[xB])&&void 0!==o&&o[MB]&&(l[i.name]||(l[i.name]={name:(0,_B.ni)({pattern:i,[DB]:t}),pattern:i,[DB]:t}))}})),!n)return Object.values(l);for(const p of s)if(p.info[ZB]&&![hm.U9,hm.f3,hm.mQ].includes(p.id))for(const e of p.info[ZB]){var u;null!==(u=e[xB])&&void 0!==u&&u[MB]&&(l[e.name]||(l[e.name]={name:(0,_B.ni)({pattern:e,[DB]:p}),pattern:e,[DB]:p}))}return Object.values(l)}(r)}),[r,t]),m=(0,P.VK)((()=>Boolean(null==r?void 0:r[WB]())),[r]),g=(0,EB.J)();return{connectedRelationProperties:p,renderConnectedRelationProperty:l[nE]((t=>{const r=t[OB].id,u=Boolean(n.find((e=>e[iE]===r))),p=Boolean(t.canOnlyAdminAuth),y=Boolean(d&&(0,k.objectEntries)(d).find((e=>{let[t,o]=e;return o&&(0,Ts.isGithubPrRelationProperty)(o)}))),f=t[OB].id===hm.U9&&y||c||m;let v;f&&(y?v=i[NB](pE.duplicateGithubPropertyTooltip):c?v=i[NB](pE.wikiGithubPropertyTooltip):m&&(v=i[NB](pE.syncedDatabaseGithubPropertyTooltip)));const h=(0,Ts.shouldDisableConnectedProperty)(u,g,p,o.device.isMobile)||f;return{key:t[QB],render:e=>a()(wB,{showDisabledTooltip:h,property:t,overrideCaption:v,render:o=>l[$B](Nt.Z,s()({},e,o,{checkState:!1,title:a()("div",{style:{[tE]:eE,[JB]:YB}},void 0,t[QB],gE.has(t[OB].id)?a()(LC.Z,{}):null),icon:a()("img",{src:t[OB].info.icon,alt:t[QB],style:{width:16,height:16}}),disabled:h,disabledFeedback:h}))}),action:async()=>{await SB.Jw({[HB]:o,connectedRelationProperty:t,[cE]:e,intl:i})}}}),[n,d,c,m,g,o,i,e])}}const fE=o(85).Exd,vE=o(85).NF1,hE=o(85).dLQ,SE=o(85).Mm1,bE=o(85).D7I,wE=o(85).Yzm,CE=o(85).TtP,PE=o(85).HxR,TE=o(85).uzK,AE=o(85).OBh,kE=o(85).P24,_E=o(85).Zxt,ME=o(85).jb8,xE=o(85).nx5,ZE=o(85).N6T,IE=(0,u.defineMessages)({[ZE]:{[xE]:"Search or add new property",id:"database.viewSettings.propertyTypeSelect.searchPlaceholder"},[ME]:{[xE]:"Suggested",id:"database.viewSettings.propertyTypeSection.suggested"},[_E]:{[xE]:"Connections",id:"database.viewSettings.propertyTypeSection.connected"},typesSectionTitle:{[xE]:"Type",id:"database.viewSettings.propertyTab.propertyType"},newProperty:{[xE]:"New property",id:"database.viewSettings.newProperty"},newPropertyWithDatabaseName:{[xE]:"New property on {databaseName}",id:"database.viewSettings.newPropertyOnDatabase"},selectToAddNewProperty:{[xE]:"Select to add",id:"database.viewSettings.selectToAdd"}});function DE(e){window.__c={n:"CollectionSettingsPropertyType"};const t=(0,C.Fy)(),[o,i]=l.useState(""),{[kE]:n,propertyTypes:r,onAccept:d,[AE]:c}=e,u=(0,C.O7)(),p=(0,P.VK)((()=>{var e,t;return null==n||null===(e=n.collectionStore())||void 0===e||null===(t=e.getName())||void 0===t?void 0:t.toString()}),[n]),{connectedRelationProperties:m,renderConnectedRelationProperty:g}=yE(e[kE],e[AE]),{standardAndDerivedPropertyTypes:y,renderStandardOrDerivedProperty:f}=mE({[kE]:n,propertyTypes:r,onAccept:d,[AE]:c}),{suggestedProperties:v,renderSuggestedProperty:h}=function(e){let{[cE]:t,[dE]:o}=e;const i=(0,C.O7)(),n=(0,T.Fg)(),r=(0,P.VK)((()=>t[lE]()),[t]),d=(0,P.VK)((()=>{if(r)return r.getParentBlockStore()}),[r]),c=(0,P.VK)((()=>os.Z.bots.state),[]),u=(0,P.VK)((()=>{var e;if(!r)return;const t=null===(e=r[sE]())||void 0===e?void 0:e[rE];return t?(0,xa.vi)(t):void 0}),[r]),p=(0,P.VK)((()=>{if(r&&d&&u&&void 0===o)return r.isDefined()?(0,xa.K5)(i,u,{format:r[sE](),space_id:r.getSpaceId(),schema:r[aE]()}):void 0}),[r,d,u,o,i]),m=(0,EB.J)();return{suggestedProperties:p,renderSuggestedProperty:l[nE]((e=>{const o=e.integrationId,d=Boolean(c.find((e=>e[iE]===o))),p=Boolean(e.canOnlyAdminAuth),g=(0,Ts.shouldDisableConnectedProperty)(d,m,p,i.device.isMobile),y=(e,t,o,i)=>{const d=hB.aQ.deriveTypeUris((null==r?void 0:r[aE]())??{},null==r?void 0:r.getPropertyMapping()),c=o[oE].find((e=>{var t;return"property"===e.type&&e.collectionUri===(null==r||null===(t=r[sE]())||void 0===t?void 0:t[rE])&&(0,hS.jP)(e.uri)&&!d.has(e.uri)})),u=o[oE].find((e=>"property"===e.type&&(0,Qe.getAiInferenceFromPropertySchema)(e[dE])));if(c)return l[$B](Nt.Z,s()({},e,{disabled:g,disabledFeedback:g,title:a()("div",{style:{[tE]:eE,[JB]:YB}},void 0,t,u?a()(CB.Z,{}):null,o.isNew?"notion://projects/tasks_with_sprints_feature"===o.uri&&(0,xa.wY)()?a()(PB.Z,{}):a()(LC.Z,{}):null),icon:a()(As.ZP,{type:c[dE].type,theme:n,icon:i,size:16,style:{fill:n[XB]}})}))};return{key:e[QB],render:o=>a()(wB,{showDisabledTooltip:g,property:e,render:n=>{if((0,xa.oX)(e))return y({...o,...n,[jB]:e=>{var t,i;null===(t=n[jB])||void 0===t||t.call(n,e),null===(i=o[jB])||void 0===i||i.call(o,e)}},e[QB],e,e.icon);{const r=se().compact(e.variants.map((e=>{const t=null==u?void 0:u[qB].find((t=>t.uri===e));if(t&&(0,xa.oX)(t))return t})));return a()(TB.Z,{items:r,getKey:e=>e[QB],onSelect:async e=>{await SB.G0({[HB]:i,feature:e,[cE]:t})},selectedItem:void 0,renderOrigin:t=>y({...o,...n,...t,[jB]:e=>{var t,i;null===(t=n[jB])||void 0===t||t.call(n,e),null===(i=o[jB])||void 0===i||i.call(o,e)}},e[QB],r[0],e.icon),renderItem:e=>l[$B](Nt.Z,s()({},e,{title:e.value[QB],shouldWrapCaption:!0,shouldWrapTitle:!0}))})}}}),action:async()=>{await SB.G0({[HB]:i,feature:e,[cE]:t})}}}),[c,m,i,r,n,null==u?void 0:u[qB],t])}}({[kE]:e[kE],[AE]:e[AE]}),{derivedPropertyTypesInSuggestedSection:S}=(0,l.useMemo)((()=>{const e=new Set;for(const t of y)(0,Qe.isDerivedPropertyType)(t)&&"suggested"===(0,Bt.to)(t)&&e.add(t);return{derivedPropertyTypesInSuggestedSection:e}}),[y]);l.useEffect((()=>{!async function(){const e=await $T.shouldShowUpgradeV1SprintsButton(u,n);w(e)}()}),[n,u]);const[b,w]=(0,l.useState)(!1),A=l.useCallback((async()=>{await gB({environment:u,[TE]:n[TE](),[PE]:e[PE]})}),[n,u,e[PE]]),_=(0,l.useMemo)((()=>new Map(y.map((e=>[Bt.SO[e],e])))),[y]);let M=[];if(""!==o){const e=(null==v?void 0:v.reduce(((e,t)=>(e[t.name]=h(t),e)),{}))||{};for(const o of S)e[Bt.SO[o]]=f(o);const t=(null==m?void 0:m.reduce(((e,t)=>(g&&(e[t.name]=g(t)),e)),{}))||{},i=Ft().filter(o,Object.keys(e)).flatMap((t=>e[t.original])),n=Ft().filter(o,Array.from(_.keys())).flatMap((e=>{const t=_.get(e.original);return!t||S.has(t)?[]:f(t)})),a=Ft().filter(o,Object.keys(t)).flatMap((e=>t[e.original]));i[CE]&&M.push({key:"suggested",render:e=>l[bE](j.Z,s()({},e,{title:Et.default[wE](IE[ME])})),items:i}),n[CE]&&M.push({key:"search",render:e=>l[bE](j.Z,s()({title:Et.default[wE](IE.typesSectionTitle)},e)),items:n}),a[CE]&&M.push({key:"connected",render:e=>l[bE](j.Z,s()({},e,{title:Et.default[wE](IE[_E])})),items:a}),0===i[CE]&&0===n[CE]&&M.push({key:"custom",render:e=>l[bE](j.Z,s()({},e,{title:Et.default[wE](IE.selectToAddNewProperty)})),items:[f("text",o)]})}else{const e=(null==v?void 0:v.map((e=>h(e))))??[];for(const i of S)e.push(f(i));const t=y.map((e=>S.has(e)?void 0:f(e))).filter(k.isDefined),o=(null==m?void 0:m.map((e=>g&&g(e))).filter(k.isDefined))??[];M=se().compact([e[CE]&&{key:"suggested",render:e=>l[bE](j.Z,s()({},e,{title:Et.default[wE](IE[ME])})),items:e},t[CE]&&{key:"properties",render:e=>l[bE](j.Z,s()({},e,{title:Et.default[wE](IE.typesSectionTitle)})),items:t},o[CE]&&{key:"connected",render:e=>l[bE](j.Z,s()({},e,{title:Et.default[wE](IE[_E])})),items:o}])}const x=a()(j.Z,{desktopStyle:{paddingTop:12,[SE]:4}},void 0,a()(Ot.ZP,{focusInitial:!t[hE]||void 0,focus:!t[hE]||void 0,value:o,onChange:e=>{i(e.target.value)},placeholder:Et.default[wE](IE[ZE])}));return l[bE](B.ZP,s()({},e,{title:t.isDesktop&&p?Et.default[wE](IE.newPropertyWithDatabaseName,{databaseName:p}):Et.default[wE](IE.newProperty)}),x,b&&a()(K.Z,{style:{border:"1px solid #b3d4fc",[vE]:5,margin:"3px 11px",padding:7,[fE]:14,color:"rgba(35, 131, 226, 1)",boxShadow:"2px 2px 3px 0px #b3d4fc",cursor:"pointer",marginTop:10},onClick:A},void 0,"üèÉ New Sprints üí®",a()("div",{style:{[fE]:11}},void 0,"Upgrade V1 to V2!!!")),a()(Wt.Z,{disableInitialScroll:!0,type:Wt.i.Vertical,initialFocus:0,sections:M}))}var FE=o(34296);const VE=o(85).rMr,BE=o(85).kgm,EE=o(85).nx5,KE=o(85).uzK,RE=o(85).J4z,NE=o(85).wgE,OE=o(85).jQT,WE=o(85).oWD,UE=o(85).h$M,GE=o(85).ffk,LE=o(85).HxR,zE=o(85).P24,HE=o(85).U7y,qE=o(85).jKg;class jE extends d.Z{constructor(){super(...arguments),this[qE]="",this[HE]=e=>{const{[zE]:t,[LE]:o,[GE]:i,formatKey:n,[UE]:a}=this.props;if(!t[WE]())return;Ye[OE]({[NE]:this[NE],[zE]:t,action:"select_relation_source"});const{stack:r}=o.state,s=r[r.length-2];s&&"setupRelation"===s.type&&m[RE]({[LE]:o}),m.replaceCurrentItem({[LE]:o,item:{type:"setupRelation",[GE]:i,formatKey:n,[UE]:a,targetCollectionPointer:e.pointer}})}}renderComponent(){const{[zE]:e,[LE]:t}=this.props,o=e[KE]();if(!o)return;const i=ep.default.createValue("");return l.createElement(B.ZP,s()({},this.props,{title:a()(u.FormattedMessage,{[EE]:"Related to",id:"database.viewSettings.selectNewRelationSourceTab.title"}),handleClose:()=>{Ye[BE]({[NE]:this[NE],eventName:"abandoned_search",queryLength:i.state.length,sessionId:this[qE],source:FE.S.Relation}),m[VE]({[LE]:t})}}),a()(ap.Z,{[zE]:e,onAccept:this[HE],parentStore:o,context:FE.S.Relation,[qE]:this[qE],inputStore:i}))}willMount(){this[qE]=(0,c.default)()}}jE.displayName="CollectionSettingsSelectRelationSource";const QE=(0,u.injectIntl)(jE),$E=o(85).P3s,XE=o(85).hd7,YE=o(85).UPJ,JE=o(85).D7I,eK=o(85).PG2,tK=o(85).SPm,oK=o(85).XNW,iK=o(85).BQ6,nK=o(85).PXg,aK=o(85).nx5,rK=o(85).XCs,sK=o(85).YDv,lK=o(85).Mm1,dK=o(85).nLZ,cK=o(85).OP1,uK=o(85).wuN,pK=o(85).Exd,mK=o(85).jkI,gK=o(85).H1U,yK=o(85).EMU,fK=o(85).sM5,vK=o(85).HxR,hK=o(85).P24;function SK(e){window.__c={n:"CollectionSettingsSetDBType"};const t=(0,C.O7)().device.isMobile,{[hK]:o,[vK]:i}=e,n=(0,P.VK)((()=>o.collectionStore()),[o]),r=(0,P.VK)((()=>{const e=null==n?void 0:n.getDatabaseType();return e?hS.pX[e]:"untyped"}),[n]),[d,c]=(0,l.useState)(r),p=(0,P.VK)((()=>o.permissionScopes.state),[o]),g=(0,T.yK)((e=>({databaseTypeButton:{[fK]:yK,flexDirection:"column",[gK]:mK,width:"calc(33% - 12px)",flexGrow:0,flexShrink:0,[pK]:11,borderRadius:3,margin:6,padding:6,boxShadow:`0 0 0 1px ${e.regularDividerColor}`,color:e[uK],fill:e[uK]},selectedType:{boxShadow:`0 0 0 2px ${e[cK]}`,color:e[cK],fill:e[cK],fontWeight:500},databaseTypeIcon:{width:void 0,height:20,marginBottom:4,[dK]:4},continueButton:{[fK]:yK,margin:"14px",height:32},typeBenefits:{[pK]:12,color:e[uK]},databaseTypesContainer:{background:t?e.contentBackground:void 0,width:"100%",paddingTop:t?12:void 0,[lK]:t?12:void 0,[sK]:t?void 0:8,[rK]:t?void 0:8}})),[t]),y=()=>{const e=SS.JX[d];return 0===e.length?null:l[JE](l.Fragment,null,a()(j.Z,{topBorder:!1,shouldShowBottomDivider:t,title:a()(u.FormattedMessage,{[aK]:"What you get...",id:"database.viewSettings.databaseTypeSelectionTab.benefitsTitle"})},void 0,a()("div",{[iK]:{[oK]:14,[dK]:15}},void 0,e.map(((e,t)=>a()("div",{[iK]:{[fK]:yK,[lK]:15}},t,a()("div",{[iK]:{[rK]:8}},void 0,e.icon({width:14})),a()("span",{[iK]:g.typeBenefits},void 0,e[tK])))))),"untyped"!==r&&a()(j.Z,{topBorder:!0},void 0,a()(E.Z,{isGray:!0,icon:A.Z.trash,title:a()(u.FormattedMessage,{[aK]:"Remove {type} database",id:"database.viewSettings.databaseTypeSelectionTab.removeTypeDatabase",values:{type:SS.kd[r]}}),[eK]:()=>{}})))},f=e=>{const t=d===e,o=t||!p.canConfigureBlock;return a()(K.Z,{[iK]:{...g.databaseTypeButton,...t&&g.selectedType},disabled:o,[eK]:()=>{(e=>{c(e)})(e)}},void 0,SS.by[e](g.databaseTypeIcon),a()("div",{},void 0,SS.kd[e]))},v=["untyped","tasks","projects"];return l[JE](B.ZP,s()({},e,{title:a()(u.FormattedMessage,{[aK]:"Database type",id:"database.viewSettings.databaseTypeSelectionTab.title"})}),"untyped"!==r&&a()(j.Z,{topBorder:!1,shouldShowBottomDivider:t,title:a()(u.FormattedMessage,{[aK]:"Current database type",id:"database.viewSettings.databaseTypeSelectionTab.currentTypeTitle"}),[iK]:{[lK]:15}},void 0,a()("div",{[iK]:{[fK]:yK,[gK]:mK,[sK]:20}},void 0,a()("div",{},void 0,SS.by[r]({width:13,height:13,[nK]:8})),a()("span",{[iK]:{[pK]:14}},void 0,SS.kd[r]))),"untyped"!==r?y():l[JE](l.Fragment,null,a()(j.Z,{topBorder:!1,shouldShowBottomDivider:t},void 0,a()("div",{[iK]:g.databaseTypesContainer},void 0,a()("div",{[iK]:{[fK]:yK,flexFlow:"wrap",[YE]:mK}},void 0,v.map(f)))),y(),"untyped"!==d&&a()(it.Z,{[iK]:g.continueButton,[eK]:()=>{m[XE]({[vK]:i,item:{type:"databaseTypePropertyMapping",databaseType:d}})}},void 0,a()(u.FormattedMessage,{[aK]:"Continue",id:"database.viewSettings.databaseTypeSelectionTab.continue"})),a()(j.Z,{topBorder:!1},void 0,a()(Ub.Z,{href:(0,Nb.getLocalizedUrl)("guides.databaseType"),title:a()(u.FormattedMessage,{[aK]:"Learn about {type} databases",id:"database.viewSettings.databaseTypeSelectionTab.learnMoreButton.title",values:{type:"untyped"!==d?SS.kd[d]:"typed"}}),[$E]:"set_database_type"}))))}var bK=o(71554),wK=o(79892);const CK=o(85).P3s,PK=o(85).zwt,TK=o(85).vuT,AK=o(85).Dd5,kK=o(85).cZW,_K=o(85).nx5,MK=o(85).dlB,xK=o(85).IcT,ZK=o(85)._tz,IK=o(85).LCr,DK=o(85).pzN,FK=o(85).qLW,VK=o(85).wgE,BK=o(85).ebo,EK=o(85).qU4,KK=o(85).hd7,RK=o(85).zIe,NK=o(85).Yb8,OK=o(85).jI3,WK=o(85).UGA,UK=o(85).uzK,GK=o(85).oWD,LK=o(85).h$M,zK=o(85).ffk,HK=o(85).HxR,qK=o(85).P24;function jK(e){window.__c={n:"CollectionSettingsSetupRelation"};const{[qK]:t,[HK]:o,[zK]:i,formatKey:n,targetCollectionPointer:r,[LK]:d,from:c}=e,p=(0,P.VK)((()=>t[GK]()),[t]),f=(0,P.VK)((()=>{const e=t[UK]();return function(e){const{targetCollectionPointer:t,[GK]:o,[UK]:i}=e;if(!t)return;if(o&&o.pointer===t)return o;return i?zs.NW.createChildStore(i,t):void 0}({targetCollectionPointer:r,[GK]:p,[UK]:e})}),[t,p,r]),v=(0,P.VK)((()=>i?F.getPropertySchema(t,i):void 0),[t,i]),h=Boolean(p&&f&&p.id===f.id),S=Boolean("relation"===(null==v?void 0:v.type)&&v.connectedRelation),b=Boolean("subitem"===c),w=Boolean("timeline_arrows_by"===c),T=(0,P.VK)((()=>t.contextType),[t]),A=(0,C.O7)(),k=(0,u.useIntl)(),_=(0,P.VK)((()=>{const e=null==p?void 0:p.getSchema();return void 0===(null==v?void 0:v.name)&&f&&e?F.getSuggestedRelationName(k,{[WK]:f,isSelfRelation:h,sourceSchema:e,createUnique:!0,from:c}):(null==v?void 0:v.name)||""}),[p,null==v?void 0:v.name,f,k,h,c]),[M,x]=(0,l.useState)(_),[Z,I]=(0,l.useState)("no_limit"),[D,V]=(0,l.useState)(b?{[OK]:!0,[NK]:void 0,[RK]:{enabled:!1}}:w?{[OK]:!0,[NK]:void 0,[RK]:{enabled:!1}}:{[OK]:!1,[NK]:void 0,[RK]:{enabled:!1}}),E=M===_,K=(0,l.useCallback)((()=>{m[KK]({[HK]:o,item:{type:"selectRelationSource",[zK]:i,formatKey:n,[LK]:d}})}),[o,i,n,d]),R=(0,l.useCallback)((()=>{if(!D)return;const{[OK]:e,[NK]:a,[RK]:r}=D,s=t[GK](),l=t[EK]();if(!s||!f)return;const{performResult:u}=y.createAndCommit({userAction:BK,[VK]:A,perform:o=>{const d=i??Je.G3({[VK]:A,[GK]:s,collectionViewArgs:l&&n?{[EK]:l,format:l[FK](),formatKey:n}:void 0,[DK]:"relation",[IK]:o});if(io.n7({[VK]:A,[qK]:t,[GK]:s,[zK]:d,[ZK]:M,[WK]:f,[OK]:e,[NK]:a,[RK]:r,propertyLimit:Z,intl:k,[IK]:o,from:c}),l){var u;const e=(null===(u=l[FK]()[xK])||void 0===u?void 0:u.find((e=>e[zK]===d)))??{[zK]:d,visible:!0};g.updateFormat({stores:[l],update:{[xK]:[...l[FK]()[xK]??[],e]},[IK]:o})}return"subitem"===c&&l?(ao.dR({[EK]:l,propertyId:d,[IK]:o}),ao.jA({[qK]:t,[MK]:d,[IK]:o})):"timeline_arrows_by"===c&&l&&(no.setTimelineArrowsByRelation({[EK]:l,newProperty:d,[IK]:o}),no.setDefaultArrowsByRelation({[qK]:t,[MK]:d,[IK]:o})),d}});"subitem"===c||"timeline_arrows_by"===c?(m.popSettingsItem({[HK]:o}),m[KK]({[HK]:o,item:{type:"main"}})):m.setStackForProperty({[HK]:o,[zK]:u,formatKey:n,[LK]:d}),Ye.trackCreateProperty({[VK]:A,[qK]:t,from:"collectionPage"===T?"page_properties":"view_settings",property_type:"relation"})}),[D,t,f,A,o,i,n,d,T,M,Z,k,c]);return l.createElement(B.ZP,s()({},e,{title:a()(u.FormattedMessage,{[_K]:"New relation",id:"database.viewSettings.setupRelationTab.title"})}),a()(j.Z,{},void 0,a()(Ot.ZP,{value:M||"",[kK]:"Property name",[AK]:e=>x(e.target.value),onBlur:()=>{},onSubmit:()=>{},focusInitial:!0,selectAll:!1})),a()(wK.Z,{isSelfRelation:h,[GK]:f,showAs:"chevron",onClick:K,disabled:b}),!c&&a()(bK.U,{selectedKey:Z,[DK]:"relation",[AK]:e=>I(e)}),f&&!S&&a()(Za.Z,{[qK]:t,[WK]:f,[zK]:i,[ZK]:M,buttonContents:a()(u.FormattedMessage,{[_K]:"Add relation",id:"database.viewSettings.setupRelationTab.addButton.title"}),temporaryInverseState:D,setTemporaryInverseState:V,isInitialPropertyName:E,onSubmit:R,from:c}),a()(j.Z,{},void 0,a()(Ub.Z,{href:(0,Nb.getLocalizedUrl)("guides.relations"),title:a()(u.FormattedMessage,{[_K]:"Learn about relations",id:TK}),[CK]:PK})))}var QK=o(27006),$K=o(63143),XK=o(76464),YK=o(21115),JK=o(29551),eR=o(46978);const tR=o(85).$bT,oR=o(85).rps,iR=o(85).NDn,nR=o(85).Wp_,aR=o(85).hMp,rR=o(85).MLn,sR=o(85).UPJ,lR=o(85).jkI,dR=o(85).Mm1,cR=o(85).PG2,uR=o(85).tBn,pR=o(85).D7I,mR=o(85).nx5,gR=o(85).Tb$,yR=o(85).piI,fR=o(85).HxR,vR=o(85).rMr,hR=o(85).wgE,SR=o(85).QQK,bR=o(85).uzK,wR=o(85).P24,CR=o(85).QmD,PR=o(85).wfR;class TR extends d.Z{constructor(){super(...arguments),this.storeTypes={restrictedStore:ep.default[PR](!1)},this.handleContinue=()=>{const e=this.stores.restrictedStore[CR],{[wR]:t}=this.props,o=t[bR](),i=t[SR];o&&(e&&this.restrictAccessToSyncedContent({[hR]:this[hR],store:o}),p.trackSetDatabaseSyncPermissions(this[hR],{type:e?"restrict":"share"}),m[vR]({[fR]:i}))}}renderComponent(){const{[fR]:e,[wR]:t,[yR]:o,integrationIcon:i}=this.props,{restrictedStore:n}=this.stores,r=t[bR]();if(!r)return;const d=this.createComputedStore((()=>{const e=vD.default[CR].data?YK.getVisibleUsers(vD.default[CR].data):[],t=(0,$K.objectFromEntries)(se().compact(e.map((e=>[e.userId,e.role])))),o=(0,Rc.getMostPermissiveBlockPermissions)(r).map((e=>e[gR]));let i=!1,n=!1;for(const r of o)QK.isPublicPermission(r)?i=!0:QK.isSpacePermission(r)&&!QK.isNone(r.role)&&(n=!0);const a=se().uniq(se().compact([...o.map((e=>"user_permission"===e.type?e.user_id:void 0)),...n?Object.keys(t):[]])),s=a.filter((e=>"none"!==t[e])).length,l=a.filter((e=>{const i=t[e],n=Boolean(o.filter(QK.isUserPermission).find((t=>t.user_id===e)));return Boolean(i&&n&&!QK.canRead(i))})).length;return{numberOfGuests:l,numberOfUsers:s+l,isPublic:i}})),{numberOfGuests:c,numberOfUsers:p,isPublic:g}=d[CR];if(!g&&1===p)return void m[vR]({[fR]:e});const y=a()("div",{style:this.getPromptTitleStyle()},void 0,a()(u.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.header",[mR]:"Share synced content with"})),f=l[pR](l[uR],null,0!==c?l[pR](l[uR],null,a()(u.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.option.share.caption.usersWithGuests",[mR]:"{numberOfUsers} people (including you {numberOfGuests, plural, one {and {numberOfGuests} guest} other {and {numberOfGuests} guests}})",values:{numberOfUsers:p,numberOfGuests:c}})," "):l[pR](l[uR],null,a()(u.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.option.share.caption.usersWithoutGuests",[mR]:"{numberOfUsers} people (including you)",values:{numberOfUsers:p}})," "),g&&l[pR](l[uR],null,a()(u.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.option.share.caption.sharedWithPublic",[mR]:"and those with the link"})," "),a()(u.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.option.share.caption.accessToIntegration",[mR]:"will get access to content synced from {integrationName}",values:{[yR]:o}})),v=a()(JK.gq,{style:{marginTop:10}},void 0,a()(it.Z,{style:{flex:"0 0 100%"},isLarge:!0,[cR]:this.handleContinue},void 0,a()(u.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.continueButton",[mR]:"Continue"}))),h=a()(JK.gq,{style:{[dR]:24},alignItems:lR,[sR]:lR},void 0,a()("img",{style:{width:40},src:i})),S=a()(Wt.Z,{type:Wt.i.Vertical,initialFocus:void 0,sections:[{key:"grant_permissions",items:[{key:"allow",action:()=>null,render:e=>l[pR](Nt.Z,s()({},e,{textWrapperStyle:{[rR]:aR},title:a()(u.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.option.share.title",[mR]:"Anyone on this page"}),shouldWrapCaption:!0,caption:f,icon:a()(eR.Z,{isSelected:!n[CR]}),[cR]:()=>{n[nR](!1)}}))},{key:"restrict",action:()=>null,render:e=>l[pR](Nt.Z,s()({},e,{textWrapperStyle:{[rR]:aR},title:a()(u.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.option.restrict.title",[mR]:"Only you"}),shouldWrapCaption:!0,caption:a()(u.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.option.restrict.caption",[mR]:"You'll need to share with others using the share menu"}),icon:a()(eR.Z,{isSelected:n[CR]}),[cR]:()=>{n[nR](!0)}}))}],render:e=>l[pR](j.Z,e)}]});return l[pR](B.ZP,this.props,a()(JK.gq,{style:this[iR](),[tR]:oR},void 0,h,a()("div",{},void 0,y,S),v))}restrictAccessToSyncedContent(e){const{[hR]:t,store:o}=e,i=t.currentUser.id;i&&y.createAndCommit({userAction:"CollectionSettingsSyncedContentShare.restrictAccessToSyncedContent",[hR]:t,perform:e=>{XK.restrictPermission({[hR]:t,store:o,shouldInherit:!1,transaction:e,[gR]:{type:"user_permission",user_id:i,role:"editor"}})}})}[iR](){return{display:"flex",[tR]:oR,alignItems:lR,[sR]:lR,padding:"0px 16px 16px 16px"}}getPromptTitleStyle(){return{color:this.theme.regularTextColor,fontWeight:_.Z.fontWeight.semibold,fontSize:14}}}TR.displayName="CollectionSettingsSyncedContentShare";const AR=(0,u.injectIntl)(TR);var kR=o(90985),_R=o(97004);const MR=o(85).vwl,xR=o(85).EiQ,ZR=o(85).BrJ,IR=o(85).oBh,DR=o(85).MU8,FR=o(85).HxR,VR=o(85).Xl2,BR=o(85).Z$,ER=o(85).jQT,KR=o(85).tb8,RR=o(85).Yzm,NR=o(85).Uww,OR=o(85).mSd,WR=o(85).nSw,UR=o(85).Lyb,GR=o(85).qq3,LR=o(85).EIp,zR=o(85).ltl,HR=o(85).ewb,qR=o(85).$Pi,jR=o(85).vHy,QR=o(85).wgE,$R=o(85).xQb,XR=o(85).eiN,YR=o(85).ffk,JR=o(85).QmD,eN=o(85).qU4,tN=o(85).P0R,oN=o(85).P24,iN=o(85).OQu,nN=o(85).nx5,aN=o(85).zwB,rN=(0,u.defineMessages)({[aN]:{[nN]:"Filter by‚Ä¶",id:"database.viewSettings.createFilterTab.inputPlaceholder"}});class sN extends d.Z{constructor(){super(...arguments),this[iN]=e=>{if(!e)return;const{[oN]:t}=this[tN],o=t[eN](),i=this.suggestedFilters[JR].find((t=>t[YR]===e));if(!i||!o)return;const n={id:(0,c.default)(),[XR]:i};kR[$R]({[QR]:this[QR],[oN]:t,[jR]:{...t[jR][JR],propertyFilters:{value:[...this.getPropertyFilters(),n]}}}),this.acceptAndOpenPropertyFilter(n)},this.handleCombinatorFilterClick=()=>{const{[oN]:e}=this[tN];if(!e[eN]())return;this[qR]()||kR[$R]({[QR]:this[QR],[oN]:e,[jR]:{...e[jR][JR],[zR]:{value:Ps.TI}}}),this[HR]()},this.suggestedFilters=this[LR]((()=>{const{[oN]:e}=this[tN],t=e[GR][JR],o=e[eN]();if(!o)return[];return(0,_R.qd)({schema:t,[UR]:this.getPropertyFilters(),[WR]:o[WR]})}),!0)}renderComponent(){var e;const{[oN]:t}=this[tN],o=this.suggestedFilters[JR],i=this[qR](),n=t.permissionScopes[JR];return l.createElement(B.ZP,s()({},this[tN],{title:a()(u.FormattedMessage,{[nN]:"Add filter",id:"database.viewSettings.createFilterTab.title"}),footer:n[OR]&&a()(j.Z,{topBorder:!0},void 0,a()(E.Z,{icon:i?A.Z[XR]:A.Z.plus,isGray:!0,title:a()(u.FormattedMessage,i?{[nN]:"Advanced filter",id:"database.viewSettings.createFilterTab.advancedFilter.title"}:{[nN]:"Add advanced filter",id:"database.viewSettings.createFilterTab.addAdvancedFilter.title"}),right:i&&a()(u.FormattedMessage,{[nN]:"{ruleCount, plural, one {{ruleCount} rule} other {{ruleCount} rules}}",id:"database.viewSettings.createFilterTab.advancedFilterRulesCount.title",values:{ruleCount:(null===(e=i[UR])||void 0===e?void 0:e.length)||1}}),onClick:this.handleCombinatorFilterClick}))}),a()(rt.Z,{schema:t[GR][JR],format:t[NR][JR],[KR]:()=>o.map((e=>e[YR])),onAccept:this[iN],[aN]:Et.default[RR](rN[aN])}))}acceptAndOpenPropertyFilter(e){const{[oN]:t,context:o}=this[tN];if(Ye[ER]({[QR]:this[QR],[oN]:t,action:"create_property_filter"}),o===PA.HV.FilterBar||o===PA.HV.TopbarFilterPopup){this[BR]();const o=t.getFilterBarItemSettingsStore(e);m[VR]({[FR]:o,item:{type:XR}})}else if(o===PA.HV.ViewSettings){this[DR]();const o=t.getFilterOptionsItemSettingsStore(e);m[VR]({[FR]:o,item:{type:XR}})}}[HR](){const{[oN]:e,context:t}=this[tN];Ye[ER]({[QR]:this[QR],[oN]:e,action:"create_combinator_filter"}),t===PA.HV.FilterBar||t===PA.HV.TopbarFilterPopup?(this[BR](),m[VR]({[FR]:e[IR],item:{type:XR}})):t===PA.HV.ViewSettings&&(this[DR](),m[VR]({[FR]:e[ZR],item:{type:XR}}))}[BR](){const{[oN]:e,[FR]:t}=this[tN];e.filtersBarOpen.setState(!0),m.popSettingsItem({[FR]:t})}[DR](){const{[FR]:e}=this[tN];m[VR]({[FR]:e,item:{type:"main"}}),m.navigateToItem({[FR]:e,item:{type:UR}})}getPropertyFilters(){const{[oN]:e}=this[tN];return e[xR][JR]}[qR](){const{[oN]:e}=this[tN];return e[MR][JR]}}sN.displayName="CollectionSettingsViewCreateFilter";const lN=(0,u.injectIntl)(sN),dN=o(85).tb8,cN=o(85).Yzm,uN=o(85).Uww,pN=o(85).hd7,mN=o(85).Xl2,gN=o(85).GwZ,yN=o(85).J4z,fN=o(85).vHy,vN=o(85).xQb,hN=o(85).a67,SN=o(85).ffk,bN=o(85).mYq,wN=o(85).ddU,CN=o(85).wgE,PN=o(85).jQT,TN=o(85).qq3,AN=o(85).QmD,kN=o(85).qU4,_N=o(85).HxR,MN=o(85).P24,xN=o(85).OQu,ZN=o(85).nx5,IN=o(85).zwB,DN=(0,u.defineMessages)({[IN]:{[ZN]:"Sort by‚Ä¶",id:"database.viewSettings.createSortTab.inputPlaceholder"}});class FN extends d.Z{constructor(){super(...arguments),this[xN]=e=>{var t;if(!e)return;const{[MN]:o,context:i,[_N]:n}=this.props,a=o[kN](),r=o[TN][AN];if(!a||!r)return;const s=null===(t=r[e])||void 0===t?void 0:t.type;Ye[PN]({[CN]:this[CN],[MN]:o,action:"create_sort_accept",[wN]:a.getType(),[bN]:s});const l={[SN]:e,direction:hN},d=[...this.getSorts(),l];if(kR[vN]({[CN]:this[CN],[MN]:o,[fN]:{...o[fN][AN],sorts:{value:d}}}),i===PA.HV.TopbarSortPopup||i===PA.HV.FilterBar){o.filtersBarOpen.setState(!0),m[yN]({[_N]:n});const{[gN]:e}=o;m[mN]({[_N]:e,item:{type:"sort"}})}else i===PA.HV.ViewSettings&&(m[mN]({[_N]:n,item:{type:"main"}}),m[pN]({[_N]:n,item:{type:"sort"}}))}}renderComponent(){const{[MN]:e}=this.props,t=e[TN][AN],o=this.getSorts();return l.createElement(B.ZP,s()({},this.props,{title:a()(u.FormattedMessage,{[ZN]:"New sort",id:"database.viewSettings.createSortTab.title"})}),a()(rt.Z,{schema:e[TN][AN],format:e[uN][AN],[dN]:()=>Object.keys(t).filter((e=>!o.find((t=>t[SN]===e)))),onAccept:this[xN],[IN]:Et.default[cN](DN[IN])}))}getSorts(){const{[MN]:e}=this.props;return e.currentSortsStore[AN]}}FN.displayName="CollectionSettingsViewCreateSort";const VN=(0,u.injectIntl)(FN);var BN=o(29987),EN=o(77985),KN=o(8982);const RN=o(85).vwl,NN=o(85).fBu,ON=o(85).QLQ,WN=o(85).YDe,UN=o(85).nx5,GN=o(85).qq3,LN=o(85).rMr,zN=o(85).HxR,HN=o(85).jQT,qN=o(85).ltl,jN=o(85).vHy,QN=o(85).xQb,$N=o(85).wgE,XN=o(85).Q_9,YN=o(85).dpF,JN=o(85).DbH,eO=o(85).QmD,tO=o(85).P0R,oO=o(85).P24;class iO extends d.Z{constructor(){super(...arguments),this.handleFilterChange=(e,t)=>{var o;const{[oO]:i}=this[tO],n=null===(o=i[JN][eO])||void 0===o?void 0:o.sizeHint,a=BN.default.mark(YN);BN.default[XN](a,{[$N]:this[$N],getData:()=>$v.getUpdateFilterLagData({from:"combinator_filter",[oO]:i,sizeHintAtStart:n})}),kR[QN]({[$N]:this[$N],[oO]:i,[jN]:{...i[jN][eO],[qN]:{value:t}}}),Ye[HN]({[$N]:this[$N],[oO]:i,action:"update_combinator_filter"})},this.handleRemoveClick=()=>{const{[oO]:e,context:t,[zN]:o}=this[tO];kR[QN]({[$N]:this[$N],[oO]:e,[jN]:{...e[jN][eO],[qN]:{value:void 0}}}),t===PA.HV.FilterBar&&m[LN]({[zN]:o}),Ye[HN]({[$N]:this[$N],[oO]:e,action:"delete_combinator_filter"})}}renderComponent(){const{[oO]:e}=this[tO],t=e.collectionViewStore(),o=e[GN][eO],i=this.getFilter();if(!t||!i)return;const n=t.getType();return n?l.createElement(B.ZP,s()({},this[tO],{title:a()(u.FormattedMessage,{[UN]:"Advanced filter",id:"database.viewSettings.filterTab.title"}),unconstrainedWidth:!0}),a()(KN.D,{},void 0,a()(EN.Pq,{index:0,level:0,[qN]:i,schema:o,onChange:this.handleFilterChange,[WN]:n,[ON]:t.id,[NN]:t})),a()(j.Z,{topBorder:!0},void 0,a()(E.Z,{title:a()(u.FormattedMessage,{[UN]:"Delete filter",id:"database.viewSettings.filterTab.deleteFilterButton.title"}),onClick:this.handleRemoveClick}))):void 0}getFilter(){const{[oO]:e}=this[tO];return e[RN][eO]}}iO.displayName="CollectionSettingsViewFilter";const nO=(0,u.injectIntl)(iO);var aO=o(28398),rO=o(37709),sO=o(58814),lO=o(97774);const dO=o(85).BrJ,cO=o(85).wuN,uO=o(85).Hco,pO=o(85).GCx,mO=o(85).Ek1,gO=o(85).J7Q,yO=o(85).Au,fO=o(85).GmX,vO=o(85).Scd,hO=o(85)._V5,SO=o(85).dLQ,bO=o(85).Mm1,wO=o(85).BQM,CO=o(85).nx5,PO=o(85).vwl,TO=o(85).mSd,AO=o(85).EIp,kO=o(85).oh7,_O=o(85).hd7,MO=o(85).jQT,xO=o(85).vHy,ZO=o(85).wgE,IO=o(85).xQb,DO=o(85).EiQ,FO=o(85).QmD,VO=o(85).uzK,BO=o(85).HxR,EO=o(85).Gm5,KO=o(85).Ieo,RO=o(85).PXg,NO=o(85).XNW,OO=o(85).LlE,WO=o(85).jkI,UO=o(85).H1U,GO=o(85).EMU,LO=o(85).sM5,zO=o(85).P0R,HO=o(85).P24,qO=o(85).tuI;class jO extends d.Z{constructor(){super(...arguments),this[qO]=e=>{const{[HO]:t}=this[zO];return a()("div",{style:{[LO]:GO,[UO]:WO,[OO]:"4px 10px"}},void 0,this.canReorder()&&a()(Lb.ZP,{iconSize:12,style:{[NO]:6,[RO]:6}}),a()(lO.Z,{id:e.id,[EO]:rO.P[KO],[HO]:t,[BO]:t.getFilterOptionsItemSettingsStore(e)},e.id))},this.handleFiltersDrop=e=>{const{[HO]:t}=this[zO];if(!t[VO]())return;const o=t[DO][FO],i=re.compact(e.map((e=>o.find((t=>t.id===e)))));kR[IO]({[ZO]:this[ZO],[HO]:t,[xO]:{...t[xO][FO],propertyFilters:{value:i}}}),Ye[MO]({[ZO]:this[ZO],[HO]:t,action:"reorder_filters"})},this.handleNewFilterClick=()=>{const{[BO]:e,[HO]:t}=this[zO];Ye[MO]({[ZO]:this[ZO],[HO]:t,action:"click_new_filter"}),m[_O]({[BO]:e,item:{type:"createFilter"}}),t.filtersBarOpen.setState(!0)},this[kO]=this[AO]((()=>{const{[HO]:e}=this[zO];return(0,_R.yU)(e)}))}renderComponent(){const{[HO]:e}=this[zO],{device:t}=this[ZO],o=e[DO][FO],i=o.map((e=>e.id)),n=e.permissionScopes[FO],r=n[TO]?e[PO][FO]:void 0;return l.createElement(B.ZP,s()({},this[zO],{title:a()(u.FormattedMessage,{[CO]:"Filters",id:"database.viewSettings.filtersTab.title"}),footer:this[kO][FO]&&a()(j.Z,{topBorder:!0},void 0,this[wO]()),unconstrainedWidth:!0}),a()(j.Z,{desktopStyle:{[bO]:24}},void 0,(i.length>0||r)&&a()("div",{style:t[SO]?{[hO]:8,[vO]:this[yO][fO]}:void 0},void 0,r&&this[gO](),this.canReorder()?a()(Gb.ZP,{[pO]:"vertical",keys:i,renderKey:e=>{const t=i[mO](e);return this[qO](o[t])},onDrop:this.handleFiltersDrop,disabled:!n[TO]}):i.map((e=>{const t=i[mO](e);return this[qO](o[t])}))),a()(Nt.Z,{focused:!1,icon:A.Z.plus({width:14,[NO]:4,[RO]:4,fill:this[yO][uO]}),style:{color:this[yO][cO]},title:a()(u.FormattedMessage,{[CO]:"Add filter",id:"database.viewSettings.filtersTab.newFilter.title"}),onClick:this.handleNewFilterClick})))}[gO](){const{[HO]:e}=this[zO];return a()("div",{style:{[LO]:GO,[UO]:WO,[OO]:"4px 10px"}},void 0,this.canReorder()&&a()(Lb.ZP,{iconSize:12,style:{[NO]:6,[RO]:6,opacity:.4,cursor:void 0}}),a()(sO.Z,{[EO]:rO.P[KO],[HO]:e,[BO]:e[dO]}))}[wO](){const{[HO]:e}=this[zO];return a()(aO.ZP,{[EO]:aO.R1[KO],[HO]:e})}canReorder(){return!this[ZO].device[SO]}}jO.displayName="CollectionSettingsViewFilters";const QO=(0,u.injectIntl)(jO);var $O=o(74194);const XO=o(85).GmX,YO=o(85).Dd5,JO=o(85).wfR,eW=o(85).loK;class tW extends d.Z{constructor(){super(...arguments),this.storeTypes={[eW]:ep.default[JO]("")},this.handleChangeDebounced=se().debounce((e=>{void 0!==e&&this.props[YO](e)}),300)}willMount(e){this.stores[eW].setState(e.value.toString())}renderComponent(){const e=this.stores[eW].state;return a()($O.Z,{type:"number",value:e,inputClassName:"input-hide-arrows",style:{background:this.theme[XO]},[YO]:e=>{const t=e.target.value,o=parseFloat(t);isNaN(o)?this.handleChangeDebounced(void 0):this.handleChangeDebounced(o),this.stores[eW].setState(t)}})}}tW.displayName="CollectionViewGroupMenuNumberInput";const oW=tW,iW=o(85).pkR,nW=o(85).I2,aW=o(85).xd5,rW=o(85).Leq,sW=o(85).HYo,lW=o(85).tX7,dW=o(85).Exd,cW=o(85).BQ6,uW=o(85).Au,pW=o(85).wuN,mW=o(85).qI$,gW=o(85).NKi,yW=o(85).XCs,fW=o(85).YDv,vW=o(85).nx5,hW=o(85).ffk,SW=o(85).Kiu,bW=o(85).P24;class wW extends d.Z{renderComponent(){const{numberGroupBy:e,[bW]:t,[SW]:o}=this.props,i=o[e[hW]];if(t.collectionStore()&&i)return l.createElement(l.Fragment,null,a()(j.Z,{topBorder:!1,disableMobileBorders:!0,title:a()(u.FormattedMessage,{id:"database.groupMenu.numberGroupRange",[vW]:"Group range"}),isTitleUppercase:!1},void 0,a()("div",{[cW]:{display:"flex",[fW]:14,[yW]:14}},void 0,this[gW](e,mW),a()("span",{[cW]:{color:this[uW][pW],margin:"0 8px"}},void 0,"‚Äì"),this[gW](e,"end"))),a()(j.Z,{topBorder:!1,disableMobileBorders:!0,title:a()(u.FormattedMessage,{id:"database.groupMenu.numberGroupSize",[vW]:"Group every"}),isTitleUppercase:!1},void 0,a()("div",{[cW]:{[fW]:14,[yW]:14}},void 0,this[gW](e,"size"),a()("span",{[cW]:{color:this[uW][pW],[dW]:12}},void 0,a()(Ob.Z,{[rW]:e,[aW]:{[hW]:e[hW],value:{type:lW,value:{type:"range",[mW]:e[mW],end:e[mW]+e.size}}},[SW]:o,[nW]:[],[iW]:!0,isHiddenGroup:!1,[cW]:this[sW](),[bW]:t}),", ",a()(Ob.Z,{[rW]:e,[aW]:{[hW]:e[hW],value:{type:lW,value:{type:"range",[mW]:e[mW]+e.size,end:e[mW]+2*e.size}}},[SW]:o,[nW]:[],[iW]:!0,isHiddenGroup:!1,[cW]:this[sW](),[bW]:t}),", ..."))))}[gW](e,t){return a()(oW,{value:e[t],onChange:o=>{"size"===t&&o<=0&&(o=1),"start"===t&&o>e.end&&(o=e.end),"end"===t&&o<e[mW]&&(o=e[mW]),this.props.onChange({newNumberGroupBy:{...e,[t]:o}})}})}[sW](){return{display:"inline",[yW]:0,[fW]:0}}}wW.displayName="CollectionViewNumberGroupMenu";const CW=(0,u.injectIntl)(wW),PW=o(85).mYq,TW=o(85).ddU,AW=o(85).jQT,kW=o(85).LCr,_W=o(85).nXm,MW=o(85).wgE,xW=o(85).j4_,ZW=o(85).Drs,IW=o(85).JJj,DW=o(85).Uww,FW=o(85).qq3,VW=o(85).P24,BW=o(85).HxR,EW=o(85).iy2,KW=o(85).Dg8;class RW extends d.Z{renderComponent(){return l.createElement(B.ZP,s()({},this.props,{title:this[KW]()}),this[EW]())}[KW](){const{[BW]:e}=this.props,t=(0,S.n)(e);if(!t||"groupByNumber"!==t.type)return;const{[VW]:o}=this.props,i=o[FW].state,n=o[DW].state[t.groupByKey];return n?kC({groupBy:n,schema:i}):void 0}[EW](){const{groupByKey:e,groupsFormatKey:t,[VW]:o}=this.props,i=o.collectionViewStore(),n=o[FW].state,r=this.getGroupBy();if(!r||!i)return;const s=xC(r);return s?a()(CW,{numberGroupBy:s,disabled:!1,schema:n,onChange:n=>{if("number"===r.type)y[IW]({[ZW]:xW,[MW]:this[MW],perform:o=>{g[_W]({stores:[i],update:{[e]:n.newNumberGroupBy,[t]:void 0},[kW]:o})}});else if("formula"===r.type){const o=re.omit(n.newNumberGroupBy,"property"),a={...r,groupBy:o};y[IW]({[ZW]:xW,[MW]:this[MW],perform:o=>{g[_W]({stores:[i],update:{[e]:a,[t]:void 0},[kW]:o})}})}Ye[AW]({[MW]:this[MW],[VW]:o,action:"group_by_number_update",[TW]:void 0,[PW]:r.type})},[VW]:o}):void 0}getGroupBy(){const{[VW]:e,groupByKey:t}=this.props;return e[DW].state[t]}}RW.displayName="CollectionSettingsViewGroupByNumber";const NW=(0,u.injectIntl)(RW),OW=o(85).EB9,WW=o(85).tb8,UW=o(85).Uww,GW=o(85).J2Z,LW=o(85).uzK,zW=o(85).hd7,HW=o(85).Xl2,qW=o(85).mYq,jW=o(85).ddU,QW=o(85).jQT,$W=o(85).LCr,XW=o(85).nXm,YW=o(85).nxU,JW=o(85).wgE,eU=o(85).E1q,tU=o(85).Drs,oU=o(85).JJj,iU=o(85).c1l,nU=o(85).qq3,aU=o(85).QmD,rU=o(85).qU4,sU=o(85).P0R,lU=o(85).$KA,dU=o(85).HxR,cU=o(85).P24,uU=o(85).OQu;class pU extends d.Z{constructor(){super(...arguments),this[uU]=e=>{const{[cU]:t,[dU]:o,groupByKey:i,[lU]:n}=this[sU],a=t[rU](),r=t[nU][aU];if(a){if(e){const o=r[e];if(!o||!(0,Eb.LG)(o))return;const s=(0,Eb.fw)(e,o,"collectionTypedView"===t[iU]);y[oU]({[tU]:eU,[JW]:this[JW],[YW]:e=>{g[XW]({stores:[a],update:{[i]:s,[n]:void 0},[$W]:e})}}),Ye[QW]({[JW]:this[JW],[cU]:t,action:"group_by_property_accept",[jW]:void 0,[qW]:o.type})}else y[oU]({[tU]:eU,[JW]:this[JW],[YW]:e=>{g[XW]({stores:[a],update:{[i]:void 0,[n]:void 0},[$W]:e})}}),Ye[QW]({[JW]:this[JW],[cU]:t,action:"group_by_property_accept"});m[HW]({[dU]:o,item:{type:"main"}}),m[zW]({[dU]:o,item:{type:"group",groupByKey:i,[lU]:n}})}},this.sortBySchemaName=(e,t)=>{var o,i;const n=null==e||null===(o=e[1])||void 0===o?void 0:o.name,a=null==t||null===(i=t[1])||void 0===i?void 0:i.name;return n&&a?n.localeCompare(a,void 0,{sensitivity:"base"}):n?1:a?-1:0}}renderComponent(){const{[cU]:e,[dU]:t}=this[sU],o=(0,S.n)(t),i=e[LW](),n=e[rU]();if(!i||!n||!o||"groupByProperty"!==o.type)return;const r=this.getGroupBy();return l.createElement(B.ZP,s()({},this[sU],{title:PC(o.groupByKey,this[GW]())}),a()(rt.Z,{schema:e[nU][aU],format:e[UW][aU],currentProperty:null==r?void 0:r.property,showNoneOption:this.canRemoveGrouping(),[WW]:()=>this.getGroupableProperties(),onAccept:this[uU]}))}getGroupBy(){const{[cU]:e,groupByKey:t}=this[sU];return e[UW][aU][t]}getGroupableProperties(){const{[cU]:e}=this[sU],t=e[nU][aU];return Object.entries(t).sort(this.sortBySchemaName).map((e=>e[0])).filter((e=>{const o=t[e];return o&&(0,Eb.LG)(o)}))}[GW](){var e;const{[cU]:t}=this[sU],o=null===(e=t[rU]())||void 0===e?void 0:e.getType();if(!o)throw new Error(OW);return o}canRemoveGrouping(){return(0,Rb._1)({viewType:this[GW](),groupByKey:this[sU].groupByKey})}}pU.displayName="CollectionSettingsViewGroupByProperty";const mU=(0,u.injectIntl)(pU),gU=o(85).D7I,yU=o(85).nx5;class fU extends d.Z{renderComponent(){return l[gU](B.ZP,s()({},this.props,{title:a()(u.FormattedMessage,{[yU]:"Layout",id:"database.viewSettings.layoutTab.title"}),desktopWidth:290}),l[gU](mb.Z,this.props))}}fU.displayName="CollectionSettingsViewLayout";const vU=(0,u.injectIntl)(fU);var hU=o(75544),SU=o(41418);const bU=o(85).vHy,wU=o(85).xQb,CU=o(85).mSd,PU=o(85).Uww,TU=o(85).qq3,AU=o(85).D7I,kU=o(85).BQM,_U=o(85)._V5,MU=o(85).nx5,xU=o(85).qU4,ZU=o(85).QmD,IU=o(85).P24,DU=o(85).EIp,FU=o(85).oh7,VU=o(85).rMr,BU=o(85).P0R,EU=o(85).HxR,KU=o(85).AbC;class RU extends d.Z{constructor(){super(...arguments),this.handleSortChange=e=>{this.setSorts(e)},this[KU]=()=>{const{[EU]:e,context:t}=this[BU];t===PA.HV.FilterBar&&m[VU]({[EU]:e})},this[FU]=this[DU]((()=>{const{[IU]:e}=this[BU];return(0,_R.Mj)(e)}))}renderComponent(){const{[IU]:e,context:t}=this[BU],o=e.permissionScopes[ZU],i=t===PA.HV.ViewSettings&&this[FU][ZU],n=e[xU]();if(n)return l[AU](B.ZP,s()({},this[BU],{title:a()(u.FormattedMessage,{[MU]:"Sort",id:"database.viewSettings.sortTab.title"}),footer:i&&l[AU](l.Fragment,null,a()("div",{style:{[_U]:24}}),a()(j.Z,{topBorder:!0},void 0,this[kU]())),unconstrainedWidth:!0}),a()(SU.Z,{[xU]:e[xU](),schema:e[TU][ZU],format:e[PU][ZU],sorts:this.getSorts(),disabled:!o[CU],parentStore:n,onChange:this.handleSortChange,showDeleteAll:!0,onDeleteAll:this[KU]}))}[kU](){const{[IU]:e}=this[BU];return a()(aO.ZP,{context:aO.R1.SettingsSort,[IU]:e})}getSorts(){const{[IU]:e}=this[BU];return e.currentSortsStore[ZU]}setSorts(e){const{[IU]:t}=this[BU];t[xU]()&&kR[wU]({environment:this.environment,[IU]:t,[bU]:{...t[bU][ZU],sorts:{value:e}}})}}RU.displayName="CollectionSettingsViewSort";const NU=(0,u.injectIntl)(RU);var OU=o(55384),WU=o(47425);var UU=o(15157),GU=o(32056),LU=o(16402),zU=o(24039),HU=o(16354);const qU=o(85).qLW,jU=o(85).zDZ,QU=o(85).PXg,$U=o(85).fOf,XU=o(85).jkI,YU=o(85).H1U,JU=o(85).rOg,eG=o(85).K4Y,tG=o(85).OiA,oG=o(85).P3s,iG=o(85).j_T,nG=o(85).TPm,aG=o(85).uGP,rG=o(85).qcw,sG=o(85).H0L,lG=o(85).se3,dG=o(85).O87,cG=o(85).OT,uG=o(85).Mm1,pG=o(85).Joh,mG=o(85).D7I,gG=o(85).pkR,yG=o(85).G4H,fG=o(85).ESK,vG=o(85).nx5,hG=o(85).TaW,SG=o(85).uzK,bG=o(85).qJ8,wG=o(85).dL6,CG=o(85).sbn,PG=o(85).gFy,TG=o(85).oWD,AG=o(85).P0R,kG=o(85).P24,_G=o(85).wgE,MG=o(85).Gnd,xG=o(85).QmD,ZG=o(85).Zij,IG=o(85).NlJ,DG=o(85).Mcf,FG=o(85).wfR;class VG extends d.Z{constructor(e){super(e),this.storeTypes={nextSync:ep.default[FG](void 0),uri:ep.default[FG](void 0),botId:ep.default[FG](void 0)},this[DG]={type:IG,filter:void 0,[IG]:{aggregator:"count",property:ZG}},this.setNextSync=this.setNextSync.bind(this)}didMount(){const e=this[MG].uri[xG],t=this[MG].botId[xG];if(e&&t){const o=`${t}:${e}`,i=UU.Z.get({userId:this[_G].currentUser.id,key:o});this.setNextSync(i)}}renderComponent(){var e;const{[kG]:t}=this[AG],o=t[TG](),i=null==o?void 0:o[PG](),n=null==i?void 0:i[wG]("uri")[CG](),r=null==i?void 0:i[wG]("bot_id")[CG](),d=null==o||null===(e=o.pointer)||void 0===e?void 0:e.spaceId,c=qc.default[xG][bG],p=null==i?void 0:i[wG]("original_url")[CG](),m=(0,_B.wY)(p,d),g=t[SG](),y=Ls.default.checkGate("free_tier_sync_database")||c&&!(0,WU.QM)(c[hG]());return this[MG].uri.setState(n),this[MG].botId.setState(r),l[mG](l.Fragment,null,a()(j.Z,{[ZG]:a()(u.FormattedMessage,{[vG]:"Source database",id:"database.viewSettings.syncedSourceTab.sourceDatabase"}),children:a()(xn.Z,{placement:xn.Z[fG].Left,alignment:xn.Z.Alignment.Center,[pG]:()=>g&&a()(zU.Z,{store:g,compactFormat:!0}),render:e=>l[mG](zb.Z,s()({},e,{[ZG]:m,icon:a()(nh.Z,{[gG]:!0,icon:null==o?void 0:o.getIcon(),isEmptyPage:!1,size:20,style:this[yG]().menuItemIcon}),style:this[yG]().menuItemTitle}))}),style:{[uG]:0}}),a()(j.Z,{},void 0,this.renderLimitMenuItem()),a()(j.Z,{topBorder:!0},void 0,y&&n&&r&&this.renderSyncButton({uri:n,botId:r}),a()(E.Z,{isGray:!0,[ZG]:a()(u.FormattedMessage,{[vG]:cG,id:"database.viewSettings.syncedSourceTab.copyDebugging"}),icon:A.Z.copy,onClick:()=>{const e={uri:n,botId:r,spaceId:d};qv[dG]({[_G]:this[_G],[lG]:JSON[sG](e,null,2),[rG]:qv[nG][aG]})}}),a()(HU.Z,{href:`${AB.default[iG]}?target=connected_apps`},void 0,a()(E.Z,{icon:A.Z.settingsConnectedApps,[ZG]:a()(u.FormattedMessage,{[vG]:"Manage my connections",id:"database.viewSettings.syncedSourceTab.manageConnections"}),isGray:!0})),a()(Ub.Z,{href:(0,Nb.getLocalizedUrl)("guides.syncedDatabases"),[ZG]:a()(u.FormattedMessage,{[vG]:"Learn about synced databases",id:"database.viewSettings.syncedSourceTab.learnMoreButton.title."}),[oG]:"view_settings_source"})))}renderCountRowValue(e){const{[kG]:t}=this[AG];return a()(Wb.Z,{id:"table:uncategorized:title:count",[kG]:t,[DG]:this[DG],render:t=>{const o=t[xG];if(!o||"aggregation"!==o.type)return;if("number"!==o[tG].type)return;const i={...o[tG],value:o[tG].value&&Math.min(e,o[tG].value)};return(0,GU.uf)(i.value,eG,this[AG].intl)}})}renderLimitMenuItem(){const{[kG]:e}=this[AG],t=e[TG](),o=null==t?void 0:t[PG](),i="row_limit_exceeded"===(null==o?void 0:o[wG]("sync_state")[wG]("syncing")[CG]()),n=qc.default[xG][bG],r=this.createComputedStore((()=>{var e;return function(e){if(!e)return 2e4;const t=OU.kk.fromSpace(e),o=t.getSetting("database_sync_row_limit");return void 0!==o?o:(0,WU.QM)(t.getSubscriptionTier())?100:2e4}(null===(e=qc.default[xG][bG])||void 0===e?void 0:e.getModel())}));return a()(zb.Z,{[ZG]:a()("span",{style:{display:JU,[YU]:XU}},void 0,i&&n&&(0,WU.QM)(n[hG]())&&a()(xn.Z,{placement:xn.Z[fG].Left,alignment:xn.Z.Alignment.Center,[pG]:()=>a()(u.FormattedMessage,{id:"database.viewSettings.syncedSourceTab.limitFree.toolTip",[vG]:"Free Plans are limited to 1 synced database with up to 100 rows."}),render:e=>l[mG]("div",e,A.Z[$U]({fill:(0,Wv.fi)("orange",this.theme).fill,[QU]:14,width:12,alignSelf:"center"}))}),a()(u.FormattedMessage,{[vG]:"Limit",id:"database.viewSettings.syncedSourceTab.limit"})),right:a()(u.FormattedMessage,{[vG]:"{value}/{limit} rows",id:"database.viewSettings.syncedSourceTab.limitRows",values:{value:this.renderCountRowValue(r[xG]),limit:(0,GU.uf)(r[xG],eG,this[AG].intl)}}),style:this[yG]().menuItem})}renderSyncButton(e){const{uri:t,botId:o}=e,i=this[MG].nextSync[xG],n=!i||i<Date.now();return this.isSyncing()?a()(zb.Z,{[ZG]:a()(u.FormattedMessage,{[vG]:"Syncing",id:"database.viewSettings.syncedSourceTab.isSyncing"}),icon:A.Z.sync(this[yG]().menuItemIcon,"sync-spinner"),style:this[yG]().menuItem}):n?a()(E.Z,{isGray:!0,[ZG]:a()(u.FormattedMessage,{[vG]:"{message}",id:"database.viewSettings.syncedSourceTab.syncNow",values:{message:this.syncButtonMessage()[vG],[jU]:this.syncButtonMessage()[jU]}}),icon:A.Z.sync,onClick:async()=>{var e,n;const a=null===(e=this[AG][kG][TG]())||void 0===e?void 0:e.id,r=!0===(null===(n=this[AG][kG][TG]())||void 0===n?void 0:n[qU]().stale);a&&await m.handleUpdateSyncedCollection({[_G]:this[_G],uri:t,botId:o,collectionId:a,nextSync:i,setNextSync:this.setNextSync,isStale:r})}}):a()(zb.Z,{[ZG]:a()(u.FormattedMessage,{[vG]:"Sync available in {timeToNextSync}",id:"database.viewSettings.syncedSourceTab.syncNow.disabled",values:{timeToNextSync:(0,LU.hH)(Date.now(),i)}}),icon:A.Z.unsync(this[yG]().menuItemIcon),style:this[yG]().menuItem})}setNextSync(e){this[MG].nextSync.setState(e)}isSyncing(){var e,t;const o=this[AG][kG],i=o.numberChildrenUnfurled[xG],n=o.numberChildrenReceived[xG],a=i/n,r=!0===(null===(e=o[TG]())||void 0===e||null===(t=e[qU]().sync_state)||void 0===t?void 0:t.syncing),s=this[_G].device.isMobile;return i&&n&&a<1&&!s||r&&s}[yG](){const e=this[_G].device.isMobile;return{menuItemTitle:{paddingLeft:e?4:8},menuItem:{color:this.theme.mediumTextColor,paddingLeft:e?4:8},menuItemIcon:{height:16,width:16,[QU]:2}}}syncButtonMessage(){const e=qc.default[xG][bG],t=e&&(0,WU.QM)(e[hG]());return{[vG]:t?"Clear and sync database":"Sync database",[jU]:t?"Clears and refreshes the database ":"Refreshes the synced database."}}}VG.displayName="CollectionSettingsViewSyncedSource";const BG=(0,u.injectIntl)(VG),EG=o(85).rMr,KG=o(85).kgm,RG=o(85).nx5,NG=o(85).DCw,OG=o(85).uzK,WG=o(85).J4z,UG=o(85).LCr,GG=o(85).oWD,LG=o(85).wgE,zG=o(85).Drs,HG=o(85).JJj,qG=o(85).HxR,jG=o(85).P24,QG=o(85).U7y,$G=o(85).jKg;class XG extends d.Z{constructor(){super(...arguments),this[$G]="",this[QG]=e=>{const{[jG]:t,[qG]:o}=this.props;y[HG]({[zG]:"CollectionSettingsViewSource.handleSourcePickerAccept",[LG]:this[LG],perform:o=>{et.updateCollectionViewSource({[LG]:this[LG],[jG]:t,[GG]:e,[UG]:o})}}),m[WG]({[qG]:o})}}renderComponent(){var e;const{[jG]:t,[qG]:o}=this.props,i=Boolean(null===(e=t[OG]())||void 0===e?void 0:e[NG]()),n=t[OG]();if(!n)return;const r=ep.default.createValue("");return l.createElement(B.ZP,s()({},this.props,{title:a()(u.FormattedMessage,{[RG]:"Source",id:"database.viewSettings.sourceTab.title"}),handleClose:()=>{Ye[KG]({[LG]:this[LG],eventName:"abandoned_search",sessionId:this[$G],source:FE.S.Source,queryLength:r.state.length}),m[EG]({[qG]:o})}}),i?a()(BG,{[jG]:t}):a()(ap.Z,{[jG]:t,parentStore:n,onAccept:this[QG],context:FE.S.Source,[$G]:this[$G],inputStore:r}))}willMount(){this[$G]=(0,c.default)()}}XG.displayName="CollectionSettingsViewSource";const YG=(0,u.injectIntl)(XG);var JG=o(72897);const eL=o(85).J2Z,tL=o(85).rMr,oL=o(85)._vc,iL=o(85).rSD,nL=o(85).eN5,aL=o(85).SDR,rL=o(85).ImZ,sL=o(85).$Zu,lL=o(85).Y1h,dL=o(85).v1$,cL=o(85).pzN,uL=o(85).GGY,pL=o(85).dyU,mL=o(85).HxR,gL=o(85).Lyb,yL=o(85).Uh4,fL=o(85).Kvi,vL=o(85).ffk,hL=o(85).Dd5,SL=o(85).cZW,bL=o(85).kdC,wL=o(85).LCr,CL=o(85).EdP,PL=o(85).Ql2,TL=o(85).e7B,AL=o(85).nXm,kL=o(85).nxU,_L=o(85).wgE,ML=o(85).Drs,xL=o(85).JJj,ZL=o(85).nm$,IL=o(85).Juc,DL=o(85).Wp_,FL=o(85).D7I,VL=o(85).qU4,BL=o(85).P0R,EL=o(85).P24,KL=o(85).MWD;class RL extends d.Z{constructor(){super(...arguments),this.lastTab=void 0,this.renderMainTab=e=>{var t;if("main"!==e[KL])return;const{[EL]:o}=this[BL];return l[FL](PT,s()({key:null===(t=o[VL]())||void 0===t?void 0:t.id,selectViewNameInitial:e.selectViewNameInitial},this[BL]))},this.renderPageViewTab=e=>{const{[EL]:t}=this[BL],o=t[VL]();if(o)return l[FL](B.ZP,s()({},this[BL],{title:"Select page to display",children:a()("div",{style:{margin:12}},void 0,a()($O.Z,{[bL]:!0,[SL]:"Enter page ID",focusInitial:!0,[hL]:e=>{b.Z[DL]({[IL]:e[ZL].value})},onSubmit:e=>{const t=b.Z.state[IL];t&&y[xL]({[ML]:"collectionSettings.pageView.selectPage",[_L]:this[_L],[kL]:e=>{g[AL]({stores:[o],[TL]:{page_pointer:{id:(0,c.getUUIDWithDashes)(t),[PL]:e[PL],table:CL}},[wL]:e})}})}}))}))},this.renderSetDBTypeTab=()=>l[FL](SK,this[BL]),this.renderDBTypePropertyMappingTab=e=>{if("databaseTypePropertyMapping"===e[KL])return l[FL](CA,s()({},this[BL],{databaseType:e.databaseType}))},this.renderCreateTypedDBTab=()=>l[FL](cb,this[BL]),this.renderSourceTab=()=>l[FL](YG,this[BL]),this.renderCreateViewSourceTab=()=>l[FL](QT.Z,this[BL]),this.renderCreateExternalViewSourceTab=e=>{if("createSyncedViewSource"===e[KL])return l[FL](mS,s()({},this[BL],e))},this.renderSelectAccountForExternalViewSourceTab=e=>{if("selectAccountForExternalSource"===e[KL])return l[FL](vs,s()({},this[BL],e))},this.renderSyncedShareTab=e=>{if("shareSyncedView"===e[KL])return l[FL](AR,s()({},this[BL],e))},this.renderPropertyTypeTab=e=>{if("propertyType"===e[KL])return l[FL](DE,s()({},this[BL],e))},this.renderPropertyAiAutofillTab=e=>{if("propertyAiAutofill"===e[KL])return l[FL](SV,s()({},this[BL],e))},this.renderCreateViewTab=()=>l[FL](jT,this[BL]),this.renderDuplicateExistingViewTab=()=>l[FL](XA.Z,this[BL]),this.renderPropertiesTab=e=>{if("properties"===e[KL])return l[FL](hU.Z,s()({},this[BL],{timelineViewTab:e.timelineViewTab}))},this.renderPropertyTab=e=>{if("property"===e[KL])return l[FL](rD.ZP,s()({key:e[vL]},this[BL],e))},this.renderDeletedPropertiesTab=e=>{if("deletedProperties"===e[KL])return l[FL]($A,s()({},e,this[BL]))},this.renderSelectRelationSourceTab=e=>{if("selectRelationSource"===e[KL])return l[FL](QE,s()({},this[BL],e))},this.renderSetupRelationTab=e=>{if("setupRelation"===e[KL])return l[FL](jK,s()({},this[BL],e))},this.renderLayoutTab=()=>l[FL](vU,this[BL]),this.renderGroupTab=e=>{if("group"===e[KL])return l[FL](VC,s()({},this[BL],e))},this.renderGroupByPropertyTab=e=>{if("groupByProperty"===e[KL])return l[FL](mU,s()({},this[BL],e))},this.renderGroupByNumberTab=e=>{if("groupByNumber"===e[KL])return l[FL](NW,s()({},this[BL],e))},this.renderSubitemTab=e=>{if("subitem"===e[KL])return l[FL](Jr,s()({},this[BL],e,{formatSetting:fL}))},this.renderSubitemV2Tab=e=>{if("subitemV2"===e[KL])return l[FL](wn,s()({},this[BL],{feature:fL}))},this.renderArrowsByTab=e=>{if("arrowsBy"===e[KL])return l[FL](Jr,s()({},this[BL],e,{formatSetting:yL}))},this.renderDependencies=e=>{if("dependencies"===e[KL])return l[FL](wn,s()({},this[BL],{feature:yL}))},this.renderRelationFeaturesAdvancedSettings=e=>{if("relationFeaturesAdvancedSettings"===e[KL])return l[FL](ka,s()({},this[BL],{feature:e.feature}))},this.renderGithubConfigTab=e=>{if("githubConfig"===e[KL])return l[FL](w.Z,s()({},this[BL],{[vL]:e[vL]}))},this.renderFiltersTab=()=>l[FL](QO,this[BL]),this.renderFilterTab=e=>{if("filter"===e[KL])return l[FL](nO,this[BL])},this.renderCreateFilterTab=()=>l[FL](lN,this[BL]),this.renderCreateSortTab=()=>l[FL](VN,this[BL]),this.renderSortTab=()=>l[FL](NU,this[BL]),this.renderAutomationSettingsTab=e=>{if("automationSettings"!==e[KL])return;const t=e[gL]??[];return l[FL](Cv,s()({},this[BL],{[gL]:t,tabSettings:e}))},this.renderAutomationCreateSettingsTab=e=>{if("automationCreateSettings"!==e[KL])return;const{[EL]:t,[mL]:o}=this[BL];return a()(zI,{[EL]:t,[mL]:o,[KL]:pL})},this.renderAutomationEditSettingsTab=e=>{if("automationEditSettings"!==e[KL])return;const{[EL]:t,[mL]:o}=this[BL],{automationId:i}=e;return a()(zI,{automationId:i,[EL]:t,[mL]:o,[KL]:TL})},this.renderSlackAutomationsTab=e=>{if(!(0,v.F6)())return;if("slackAutomations"!==e[KL])return;const{[EL]:t,[mL]:o}=this[BL];return a()(rf,{[EL]:t,[mL]:o})},this.renderCreateSlackAutomationTab=()=>{if(!(0,v.F6)())return;const{[EL]:e,[mL]:t}=this[BL];return a()(aD,{[KL]:pL,[EL]:e,[mL]:t})},this.renderEditSlackAutomationTab=e=>{if(!(0,v.F6)())return;if("editSlackAutomation"!==e[KL])return;const{[EL]:t,[mL]:o}=this[BL],{automationId:i,automationActionId:n}=e;return a()(aD,{[KL]:TL,automationId:i,automationActionId:n,[EL]:t,[mL]:o})},this.tabRenderers={main:this.renderMainTab,source:this.renderSourceTab,createViewSource:this.renderCreateViewSourceTab,createSyncedViewSource:this.renderCreateExternalViewSourceTab,[uL]:this.renderSelectAccountForExternalViewSourceTab,shareSyncedView:this.renderSyncedShareTab,[cL]:this.renderPropertyTypeTab,propertyAiAutofill:this.renderPropertyAiAutofillTab,createView:this.renderCreateViewTab,duplicateExistingView:this.renderDuplicateExistingViewTab,[dL]:this.renderPropertiesTab,[vL]:this.renderPropertyTab,deletedProperties:this.renderDeletedPropertiesTab,selectRelationSource:this.renderSelectRelationSourceTab,setupRelation:this.renderSetupRelationTab,layout:this.renderLayoutTab,group:this.renderGroupTab,groupByProperty:this.renderGroupByPropertyTab,[fL]:this.renderSubitemTab,arrowsBy:this.renderArrowsByTab,githubConfig:this.renderGithubConfigTab,[gL]:this.renderFiltersTab,groupByNumber:this.renderGroupByNumberTab,filter:this.renderFilterTab,createFilter:this.renderCreateFilterTab,createSort:this.renderCreateSortTab,sort:this.renderSortTab,page:this.renderPageViewTab,createTypedDB:this.renderCreateTypedDBTab,setDatabaseType:this.renderSetDBTypeTab,[lL]:this.renderDBTypePropertyMappingTab,[sL]:this.renderAutomationSettingsTab,[rL]:this.renderAutomationCreateSettingsTab,automationEditSettings:this.renderAutomationEditSettingsTab,slackAutomations:this.renderSlackAutomationsTab,createSlackAutomation:this.renderCreateSlackAutomationTab,editSlackAutomation:this.renderEditSlackAutomationTab,[aL]:this.renderDependencies,[nL]:this.renderRelationFeaturesAdvancedSettings,subitemV2:this.renderSubitemV2Tab},this[iL]=e=>{(0,f.ZP)({event:e,context:f.Af[oL],callback:()=>{const{[mL]:e}=this[BL];m[tL]({[mL]:e})}})}}didMountOrUpdate(){const{[mL]:e}=this[BL],t=(0,S.n)(e),o=this[eL]();t&&this.lastTab!==t&&p.trackViewSettings(this[_L],{view_type:o,menu:t[KL]}),this.lastTab=t}renderComponent(){var e,t;const{[mL]:o}=this[BL],i=(0,S.n)(o);if(i)return a()(JG.Z,{capture:!0,preventType:h.Z.Y},void 0,a()(KZ.Z,{capture:!0,onEsc:this[iL]},void 0,null===(e=(t=this.tabRenderers)[i[KL]])||void 0===e?void 0:e.call(t,i)))}[eL](){const{[EL]:e}=this[BL];return e.getViewType()}}RL.displayName="CollectionSettings";const NL=(0,u.injectIntl)(RL)},46978:(e,t,o)=>{o.d(t,{Z:()=>c});var i=o(77094),n=o.n(i),a=o(67294),r=o(24405);const s=o(85).C_1,l=o(85).L97;function d(e,t){let{isSelected:o}=e;window.__c={n:"RadioButtonIcon"};const{radioButtonStyle:i,dotStyle:d}=(0,r.yK)((e=>({radioButtonStyle:{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:16,height:16,borderRadius:16,marginRight:8,background:o?e.blueColor:e[l],border:o?"none":`1px solid ${e.radioButtonBorder}`,transition:"background 100ms ease-out"},dotStyle:{width:6,height:6,borderRadius:6,background:e[s],transition:"opacity 100ms ease-out",opacity:o?1:0}})),[o]);return a.createElement("div",{ref:t,style:i},n()("div",{style:d}))}const c=a.forwardRef(d)}}]);