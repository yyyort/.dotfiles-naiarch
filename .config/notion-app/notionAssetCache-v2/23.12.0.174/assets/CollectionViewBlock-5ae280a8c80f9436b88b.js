"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[3190],{26797:(e,t,i)=>{i.d(t,{JN:()=>q,f$:()=>X,td:()=>Y,fX:()=>j,cQ:()=>J,Fv:()=>ee,xD:()=>te,QG:()=>ie});var o=i(96486),s=i.n(o),r=i(17126),n=i(80951),l=i(40506),a=i(53877),d=i(42875),h=i(6287),c=i(97880),u=i(95802),p=i(15723),m=i(17746),g=i(39098),v=i(49865),f=i(25498),y=i(42239),w=i(19785),S=i(9953);const b=i(85).N6L,k=i(85).xjw,C=i(85).YaF,T=i(85).Btx,x=i(85).b7Q,I=i(85).xG0,P=i(85).TZJ,D=i(85).gLO,M=i(85).d1X,Z=i(85).BPD,B=i(85).qnp,R=i(85).Wp_,E=i(85).E_V,V=i(85).ejZ,A=i(85).eHP,L=i(85).sP9,_=i(85).TeW,O=i(85).ASr,F=i(85).Neb,N=i(85).wuX,G=i(85).Ya7,H=i(85).UoE,W=i(85).B2C,K=i(85).P24,z=i(85).Ttb,U=i(85).LCr,$=i(85).oWD,Q=i(85).wgE;function q(e){const{[Q]:t,droppedStores:i,[$]:o,duplicate:s,calendarBy:c,[U]:u,[z]:p,[K]:m}=e,g=r.ou.fromMillis(e.startOfDay);let f=!0;for(const r of i){if(r.getParentTable()===h.v){f=!1;break}w.moveToCollection({childStore:r,parentStore:o,[U]:u})||(f=!1)}const S=y.LQ({[Q]:t,droppedStores:i,duplicate:s,[U]:u,[W]:!1});for(const r of S){const e=r[H](c),i=n.toDateValue(e.getValue())||a.today((0,d.r)()),s=a[G](i,(0,d.r)()),h=g.toFormat(a[N]);let y;if("date"===s.type||"datetime"===s.type)y={...s,[F]:h};else{const e=a[O](s,(0,d.r)());if(!e.end)return;const t={...s,[F]:h},i=a[O](t,(0,d.r)()).start.diff(e.start,"days"),o=e.end.plus(i).toFormat(a[N]);y={...s,[F]:h,[_]:o}}const w=a[G](y,l.getPersistedTimezone(i)||(0,d.r)());v.addBlockToGroup({[Q]:t,store:r,[$]:o,[K]:m,coerce:!0,[L]:[],[z]:p,[U]:u,alreadyMovedToCollection:f}),te({[Q]:t,type:A,[V]:c,store:r,[U]:u,[A]:w})}}function X(e){const{[E]:t,direction:i,target:o}=e;t[R]({...t.state,[B]:!0,target:o,direction:i})}function Y(e){const{[E]:t,x:i,y:o,calendarBy:h}=e,c=t.state;if(c[B]){const e=n.toDateValue(c.target[H](h).getValue());if(!e)return;const g=a[G](e,(0,d.r)()),v=c[Z]||e,f=a[G](v,(0,d.r)()),y=[];c.dayStoreMap.forEach(((e,t)=>{y.push({store:e,timestamp:t})}));const w=y.find((e=>{let{store:t}=e;const s=u.C.getRectFromStore(t);return Boolean(s&&p.uh(s,i,o))}));let S;if(w){const e=r.ou.fromMillis(w.timestamp),t=e.endOf("day"),i=e.toFormat(a[N]);if(g){const o=a[O](g,(0,d.r)());if(c.direction===m.t.Left)if(r.Xp[D](e,t)[M](o.start))S=g;else{let e;e="datetimerange"===g.type?{...g,[F]:i,[_]:g[_]}:"daterange"===g.type?{...g,[F]:i,[_]:g[_]}:"datetime"===g.type?{type:P,[F]:i,[I]:g[I],[_]:g[F],end_time:g[I],time_zone:g.time_zone,[x]:g[x]}:{type:T,[F]:i,[_]:g[F],[x]:g[x]};const t=a[O](e,(0,d.r)());S=!o.end&&t.start>o.start||o.end&&t.start>o.end?f:e}else if(o.end?r.Xp[D](e,t)[M](o.end):r.Xp[D](e,t)[M](o.start))S=g;else{let e;e="date"===g.type?{...g,type:T,[_]:i}:"datetime"===g.type?{...g,type:P,[_]:i,end_time:"00:00"}:{...g,[_]:i};const t=a[O](e,(0,d.r)());S=t.end&&t.end<t.start?f:e}}}if(S&&!s().isEqual(f,S)){const e=a[G](S,l.getPersistedTimezone(v)||(0,d.r)());t[R]({...c,[Z]:e})}}}function j(e){const{[Q]:t,[E]:i,calendarBy:o,[U]:s}=e,r=i.state;r[B]&&r[Z]&&(te({type:A,[Q]:t,[A]:r[Z],[V]:o,store:r.target,[U]:s}),i[R]({...i.state,[B]:!1}))}function J(e){const{[E]:t}=e,i=t.state;i[B]&&t[R]({...i,[B]:!1})}function ee(e){const{[Q]:t,store:i,[$]:o,[K]:s,startDayOfWeek:l,[z]:h,[U]:c}=e,u=s.dateRangeStart.state,p=(0,d.r)(),m=s[C].state;if(!m||!m.calendar_by)return;const g=m.calendar_by,f=a.getLuxonEndOfWeek(u,l,p),y=f.startOf("month"),w=f.endOf("month"),T=r.ou.now().startOf("day");let x;return x=r.Xp[D](y,w)[M](T)?a.date(T.valueOf(),p):a.date(a.getLuxonStartOfWeek(u,l,p).valueOf(),p),S.updateValue({store:i[k](),data:{[g]:n[b](x)},[U]:c}),v.addBlockToGroup({[Q]:t,store:i,[$]:o,[K]:s,coerce:!0,[z]:h,[L]:[],[U]:c}),i}function te(e){const{[Q]:t,store:i,[V]:o,[U]:s}=e;let r;"timestamp"===e.type?r=a.date(e.timestampMs.valueOf(),(0,d.r)()):"dateValue"===e.type?r=e[A]:(0,c.unreachable)(e);const l=i.getPropertyValue(o),h=n[b](r);S.updateValue({store:i[k](),data:{[o]:h},[U]:s}),f.H({[Q]:t,store:i,dateProperty:{id:o,oldValue:l,newValue:h}})}function ie(e){const{[Q]:t,[$]:i,calendarBy:o,store:s,insertStores:r,[z]:n,[K]:l,[U]:a}=e,d=s[H](o).getValue();for(const h of r)v.addBlockToGroup({[Q]:t,store:h,[$]:i,[K]:l,coerce:!0,[L]:[],[z]:n,[U]:a}),S.setValue({store:h[H](o),value:d,[U]:a});return r.map((e=>g.G.createChildStore(i,e.pointer)))}},29990:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Rhe});var o={};i.r(o),i.d(o,{applyComputedStyle:()=>Fg,getContextParentContainer:()=>Og,handleScroll:()=>Vg,registerContainer:()=>Zg,registerElement:()=>Rg,unregisterContainer:()=>Bg,unregisterElement:()=>Eg});var s,r=i(97464),n=i.n(r),l=i(77094),a=i.n(l),d=i(96486),h=i.n(d),c=i(67294),u=i(73935),p=i(83355),m=i(1302),g=i(6740),v=i(49085),f=i(15145),y=i(23482),w=i(42509),S=i(3909),b=i(15157),k=i(44615),C=i(21202),T=i(13493),x=i(82990),I=i(51454),P=i(5366),D=i(50906),M=i(54642),Z=i(51127),B=i(26797),R=i(77162),E=i(49865),V=i(5149),A=i(98834),L=i(64434),_=i(32603),O=i(80528),F=i(52989),N=i(5978),G=i(61045),H=i(87531),W=i(24677),K=i(98104),z=i(12359),U=i(66890),$=i(66213),Q=i(28020),q=i(93959),X=i(43250),Y=i(97004),j=i(70764),J=i(75079),ee=i(68641),te=i(65742),ie=i(78316),oe=i(73744),se=i(84210),re=i(12534),ne=i(33929),le=i(10663),ae=i(39500),de=i(77546),he=i(45094),ce=i(77907),ue=i(2688),pe=i(29987),me=i(34859),ge=i(79315),ve=i(61766),fe=i(4926),ye=i(63725),we=i(58421),Se=i(7095),be=i(88632),ke=i(10161),Ce=i(30874),Te=i(96049),xe=i(28209),Ie=i(77144),Pe=i(31792),De=i(19671),Me=i(82136),Ze=i(85844),Be=i(13023),Re=i(88923),Ee=i(39098),Ve=i(29026),Ae=i(77794),Le=i(2834),_e=i(14714),Oe=i(97058),Fe=i(71644),Ne=i(96802),Ge=i(90833),He=i(17504);!function(e){e[e.Top=0]="Top",e[e.Bottom=1]="Bottom"}(s||(s={}));const We=s;var Ke=i(21325),ze=i(17311),Ue=i(2032),$e=i(14248),Qe=i(42875),qe=i(47853),Xe=i(16187),Ye=i(87279),je=i(98742),Je=i(75498),et=i(52275),tt=i(31945),it=i(78140),ot=i(32163),st=i(40721),rt=i(89728),nt=i(44532),lt=i(72495),at=i(58032),dt=i(95030);const ht=i(85).lmd,ct=i(85).Ttb,ut=i(85).OO$,pt=i(85).Xhr,mt=i(85)._hR,gt=i(85).OiA,vt=i(85).mmP,ft=i(85)._9S,yt=i(85).ffk,wt=i(85).OM8,St=i(85).Mm1,bt=i(85)._V5,kt=i(85).TEz,Ct=i(85).ChN,Tt=i(85).pkR,xt=i(85).eiN,It=i(85).xd5,Pt=i(85).Kiu,Dt=i(85).NlJ,Mt=i(85).EIp,Zt=i(85).Joh,Bt=i(85).nLZ,Rt=i(85).NF1,Et=i(85).NLk,Vt=i(85).ESK,At=i(85).w30,Lt=i(85).jQT,_t=i(85).P0R,Ot=i(85).P24,Ft=i(85).YQj,Nt=i(85).BCA,Gt=i(85).nQ3,Ht=i(85).j7K,Wt=i(85).SRP,Kt=i(85).D7I,zt=i(85).rpY,Ut=i(85).y79,$t=i(85).N1Z,Qt=i(85).iVN,qt=i(85).nx5,Xt=i(85).ceT,Yt=i(85).dLQ,jt=i(85).wgE;class Jt extends p.Z{constructor(){super(...arguments),this.renderMenu=e=>{const{device:t}=this[jt];let i;return i=t[Yt]?{[Xt]:Ye.og.Modal,title:a()(P.FormattedMessage,{[qt]:"Aggregation",id:"database.mobileBoardAggregationMenu.title"}),right:a()(st.DoneMenuText,{}),[Qt]:e[$t]}:{[Xt]:Ye.og.Popup,width:200},c[Kt](it.Z,i,a()(ot.Z,{type:ot.i[Ut],[Ht]:0,[Gt]:[{key:"aggregation section",[zt]:e=>c[Kt](lt.Z,e),items:this[Wt]()}],[Nt]:e[$t]}))},this[Ft]=e=>{const{onChange:t,[Ot]:i}=this[_t];t(e),R[Lt]({[jt]:this[jt],[Ot]:i,action:"board_change_aggregation"})},this[At]=(e,t,i)=>a()(at.Z,{placement:nt.GI[Vt].Right,delayThreshold:0,[zt]:e=>c[Kt](et.Z,n()({title:t},(0,je.Z)(e,i))),[Zt]:()=>a()("div",{style:{width:140,[Et]:"normal"}},void 0,a()("img",{src:(0,qe.D)(Xe.Sn[e]),style:{[Rt]:3,width:140,[Bt]:4}}),Xe.BG[e])},i.key),this.reducerStore=this[Mt]((()=>{const{[Dt]:e,[Pt]:t,[It]:i}=this[_t];if(e){const o=(0,$e.zk)({[Pt]:t,group:i,timeZone:(0,Qe.r)()});return{type:Dt,[xt]:o,[Dt]:e}}}))}renderComponent(){const{device:e}=this[jt];return a()(at.Z,{[Zt]:()=>this.renderTooltipText(),[zt]:t=>a()(tt.ZP,{popupType:e[Yt]?tt.Z4.SlideUp:tt.Z4.Popup,renderOrigin:e=>c[Kt](rt.Z,n()({[Tt]:this[_t][Tt],style:{[Ct]:x.Z[Ct].regular,color:this[_t].color||this.theme[kt],[bt]:4,[St]:4,height:void 0,[wt]:void 0}},(0,je.Z)(t,e)),this.renderValue()),[Tt]:this[_t][Tt],[zt]:this.renderMenu})})}renderTooltipText(){const{[Dt]:e,[Pt]:t}=this[_t];if(e){const i=Xe.VN[(0,Ue.OV)(e)];if((0,Ue.pK)(e)){const o=t[e[yt]];if(o){return`${i} in ${o.name}`}}return i}return a()(P.FormattedMessage,{[qt]:"Aggregate",id:"database.boardAggregation.tooltip"})}renderValue(){const{[Pt]:e,[Dt]:t,[Ot]:i,[It]:o}=this[_t],s=this.reducerStore.state;if(t&&s)return a()(Je.Z,{id:`board:${(0,_e.mD)(o)}`,[Ot]:i,reducer:s,groupsPointer:[o],[zt]:i=>{const o=i.state;if(!o||"aggregation"!==o.type)return;let s;if((0,Ue.pK)(t)){const i=e[t[yt]];!i||"formula"!==i.type&&"number"!==i.type||(s=i[ft])}return(0,Xe.Ol)({numberFormat:s,dateFormat:void 0,aggregationType:t[vt],userTimeZone:(0,Qe.r)(),value:o[gt],roundDecimal:5})}})}[Wt](){const e=[];for(const r of Ue.o5)e.push(this[mt](r));const t=this.getDefaultProperties();if(t.length>0)for(const r of Ue.Sy)"show_unique"!==r&&e.push(this[pt](r,t));const i=this.getNumericProperties();if(i.length>0)for(const r of Ue.k$)e.push(this[pt](r,i));const o=this.getDateProperties();if(o.length>0)for(const r of Ue.f8)e.push(this[pt](r,o));const s=this.getCheckboxProperties();if(s.length>0)for(const r of Ue.gC)e.push(this[pt](r,s));return e}[pt](e,t){const{device:i}=this[jt],o=Xe.VN[e],s=h().compact(t.map((t=>this[ut](t,e))));return{key:e+o,[zt]:(e,t)=>c[Kt](dt.Z,n()({},e,{onFocus:t.onFocus,renderOrigin:(e,t)=>c[Kt](et.Z,n()({},e,{ref:t,title:o})),renderExtension:(e,r)=>{let n;return n=i[Yt]?{[Xt]:Ye.og.Modal,title:o,right:a()(st.DoneMenuText,{}),[Qt]:r[$t],...e}:{[Xt]:Ye.og.Popup,width:200,...e},c[Kt](it.Z,n,a()(ot.Z,{type:ot.i[Ut],[Ht]:0,[Gt]:[{key:ct,[zt]:e=>c[Kt](lt.Z,e),items:s}],[Nt]:t[Nt]}))}})),action:()=>null}}getDefaultProperties(){const{[Pt]:e}=this[_t];return Object.keys(e)[xt]((t=>{const i=e[t];return i&&(0,Ue.iV)(i)&&!("rollup"===i.type&&"status"===i[ht])}))}getNumericProperties(){const{[Pt]:e}=this[_t];return Object.keys(e)[xt]((t=>{const i=e[t];return i&&(0,Ue.O4)(i)}))}getDateProperties(){const{[Pt]:e}=this[_t];return Object.keys(e)[xt]((t=>{const i=e[t];return i&&(0,Ue.dN)(i)}))}getCheckboxProperties(){const{[Pt]:e}=this[_t];return Object.keys(e)[xt]((t=>{const i=e[t];return i&&(0,Ue.Mv)(i)}))}[mt](e){const t=Xe.VN[e];return{key:e,[zt]:i=>this[At](e,t,i),action:()=>{this[Ft]({[vt]:e})}}}[ut](e,t){const i=this[_t][Pt][e];if(!i)return;const o=i.name;return{key:`${e} ${t}`,[zt]:e=>this[At](t,o,e),action:()=>{this[Ft]({[vt]:t,[yt]:e})}}}}Jt.displayName="BoardAggregation";const ei=Jt;var ti=i(70203);const ii=i(85).LIR,oi=i(85).q$s,si=i(85).sP9,ri=i(85).P24,ni=i(85).wgE;function li(e){const{transaction:t,[ni]:i,resultsStore:o,[ri]:s,isFullScreen:r,[si]:n,insertAtIndex:l,from:a,transient:d}=e;s.searchQuery.state&&L.updateSearchQuery({searchQuery:"",[ri]:s,isFullScreen:r});const{coercionSucceeded:h,newStore:c}=E.createBlockInGroup({[ni]:i,[ri]:s,[si]:n,results:o.state,insertAtIndex:l||o.state.length,coerce:!0,[oi]:!0,transaction:t,from:a});if(i.device.isMobile)N.navigateToBlock({[ni]:i,store:c,[ii]:f.tY.Create});else if(h){const e=c.getBlockTitleStore();W.edit({[ni]:i,store:c}),K.setSelectionAtEnd({store:e}),L.setSelection({store:c,transient:d})}else N.peekBlock({[ni]:i,store:c,peekMode:(0,ie.getPeekMode)(s.collectionViewStore()),resultsStore:o,[ri]:s,[ii]:f.tY.Create});D.trackCreateBlock(i,{from:a,type:"page",new_page_id:c.id,...(0,J.getCollectionAnalyticsContext)(s)})}var ai=i(52821);const di=i(85).nx5,hi=i(85).LCr,ci=i(85).Drs,ui=i(85).JJj,pi=i(85).oWD,mi=i(85).wgE,gi=i(85).vTv,vi=i(85).c1l,fi=i(85).ixe,yi=i(85).BpM,wi=i(85).KNN,Si=i(85).sP9,bi=i(85).MAy,ki=i(85).P24,Ci=i(85).b8T;class Ti extends p.Z{constructor(){super(...arguments),this[Ci]=()=>{var e;const{[ki]:t,[bi]:i,[Si]:o}=this.props,s=null===(e=t[yi][wi](o))||void 0===e?void 0:e[fi];s&&"collectionTypedView"!==t[vi]&&Ke[gi](this[mi])&&t[pi]()&&z[ui]({[ci]:"BoardGroupAddItemButton.handleClick",[mi]:this[mi],perform:e=>{li({[hi]:e,[mi]:this[mi],[fi]:s,[ki]:t,[bi]:i,[Si]:o,from:"board_group_add_item_bottom",transient:!1})}})}}renderComponent(){const e=this.theme.lightTextColor;return a()(rt.Z,{icon:t=>S.Z.plus({...t,fill:this.props.color||e}),isLightGray:!0,isLarge:!0,style:{width:"100%",color:this.props.color||e},onClick:this[Ci],onMouseDown:re.$0},void 0,a()(P.FormattedMessage,{[di]:"New",id:"database.boardView.addItemButtonTitle"}))}}Ti.displayName="BoardGroupAddItemButton";const xi=Ti;var Ii=i(99036),Pi=i(6695),Di=i(93286),Mi=i(6404),Zi=i(51365),Bi=i(9953),Ri=i(49616),Ei=i(68056),Vi=i(65598),Ai=i(19511),Li=i(22294),_i=i(27724),Oi=i(24666),Fi=i(87636),Ni=i(27531),Gi=i(41432),Hi=i(80951),Wi=i(95538),Ki=i(35328),zi=i(87521),Ui=i(71669),$i=i(81865);const Qi=i(85).dMt,qi=i(85).YQH,Xi=i(85).X_m,Yi=i(85).C$H,ji=i(85).mSb,Ji=i(85).I9F,eo=i(85).Ifi,to=i(85).wcE,io=i(85).hMR,oo=i(85).mFu,so=i(85).Bxi,ro=i(85).$Jh,no=i(85).k_5,lo=i(85).Ej5,ao=i(85).MiB,ho=i(85).KuQ,co=i(85).ju6,uo=i(85).QSf,po=i(85).TtP,mo=i(85).QYB,go=i(85).PgK,vo=i(85).BQ6,fo=i(85).Oog,yo=i(85).EIp,wo=i(85).z$9,So=i(85).qc1,bo=i(85).Exd,ko=i(85).TLr,Co=i(85).P0R,To=i(85).XtO;function xo(e){return"number"==typeof e}class Io extends p.Z{constructor(){super(...arguments),this.renderContentBlock=e=>{const{[To]:t}=this[Co],i=Ee.G[ko](t,{table:C.iU,id:e}),o=(0,zi.h)(i);if(o)return a()(Ni.D,{value:this.restrictedContentStore},void 0,a()(o,{[To]:i,disabled:!0,disableCommentMenu:!0,disableHoverMenu:!0,hideContent:(0,Ki.isToggleFormatBlock)(i),[vo]:{[bo]:12,opacity:.8,[So]:wo},isQuickFind:!0,[go]:this[yo]((()=>({depth:0,[fo]:this.createNumberedListCounterStore(e)})))},e))},this.coverStore=this[yo]((()=>{const{[To]:e}=this[Co],t=(0,ie.getTopLevelCoverContent)(e);return t[mo]?t[mo]:t.blockIds})),this.restrictedContentStore=this[yo]((()=>{const{[To]:e}=this[Co],t=(0,ie.getNestedCoverContent)(e);return t[mo]?void 0:t.blockIds})),this.numberedLists=this[yo]((()=>{const{[To]:e}=this[Co],t=this.coverStore.state,i=[];if(h().isArray(t)){let o=0;for(;o<t[po];){let s=t[o],r=Ee.G[ko](e,{table:C.iU,id:s});if(r[uo]()===Gi.Ti[co]){const n=[{[ho]:s,idx:1}],l=[{id:s,format:void 0,depth:n[po]-1,index:n[0].idx}];for(o+=1;o<t[po]&&(s=t[o],r=Ee.G[ko](e,{table:C.iU,id:s}),r[uo]()===Gi.Ti[co]);){{const e=r[ao]();if(r[ao]()===n[n[po]-1][ho])n.push({[ho]:s,idx:1});else{let t=n[n[po]-1].idx;for(;n[po]>0&&n[n[po]-1][ho]!==e;)t=n[n[po]-1].idx,n.pop();n.push({[ho]:s,idx:t+1})}l.push({id:s,format:void 0,depth:n[po]-1,index:n[n[po]-1].idx})}o+=1}i.push(l)}else o+=1}}return i}))}didUpdate(e){this[Co].coverFormat.type!==e.coverFormat.type&&this[Co][lo]()}renderComponent(){const{coverFormat:e}=this[Co];return"page_cover"===e.type?this[no]():"page_content"===e.type?this.renderPageContent():"property"===e.type?this[ro](e.property):void 0}[no](){var e;const{[To]:t}=this[Co],i=null===(e=t.getCover())||void 0===e?void 0:e.cover;return i?a()("div",{[vo]:this[so]()},void 0,a()($i.Z,{url:i,[eo]:!0,[Ji]:this[Co][To][oo],width:this.getCoverWidth(),onFinishedLoadingProxyUrl:e=>this[Co][lo](e),render:(e,t)=>{if(t)return a()(Ui.Z,{[vo]:{...this.getImageStyle(),...this.getCoverStyle(),...this[io](),[to]:`center ${100*(1-this.imagePosition)}%`},src:t})}}),this.renderImageBorder()):this[Co].isGallery?this[ji]():void 0}renderPageContent(){const e=this.coverStore.state,t=this.restrictedContentStore.state;if(e){if(!h().isArray(e))return a()("div",{[vo]:this[so]()},void 0,a()($i.Z,{url:e.url,onFinishedLoadingProxyUrl:e=>this[Co][lo](e),[eo]:!0,[Ji]:e[oo],width:this.getCoverWidth(),render:(e,t)=>{if(t)return a()(Ui.Z,{[vo]:{...this.getImageStyle(),...this.getPageContentImageStyle(),...this[io](),[to]:`center ${100*(1-this.imagePosition)}%`},src:t})}}),this.renderImageBorder());if(e[po]>0)return a()("div",{[vo]:this[Yi]()},void 0,t?e.filter((e=>t.indexOf(e)>=0)).map(this.renderContentBlock):e.map(this.renderContentBlock));if(this[Co].isGallery)return this[ji]()}else if(this[Co].isGallery)return this[ji]()}[ro](e){const{[To]:t}=this[Co],i=(0,Hi.toFileValue)(t.getPropertyValue(e)).find((e=>(0,Wi.SR)({url:e.url})));return i?a()("div",{[vo]:this[so]()},void 0,a()($i.Z,{onFinishedLoadingProxyUrl:e=>this[Co][lo](e),url:i.url,[eo]:!0,[Ji]:this[Co][To][oo],width:this.getCoverWidth(),render:(e,t)=>{if(t)return a()(Ui.Z,{[vo]:{...this.getImageStyle(),...this.getCoverStyle(),...this[io](),[to]:`center ${100*(1-this.imagePosition)}%`},src:t})}}),this.renderImageBorder()):this[Co].isGallery?this[ji]():void 0}[ji](){return a()("div",{[vo]:{[Xi]:this[qi]()}})}renderImageBorder(){return a()("div",{[vo]:{position:"absolute",left:0,right:0,bottom:0,borderBottom:`1px solid ${this.theme[Qi]}`}})}get imagePosition(){const{coverPosition:e,[To]:t}=this[Co];if(xo(e))return e;if(t.getFormatStore().isDefined()){const{page_cover_position:e,card_cover_position:i}=t.getFormat();if(xo(i))return i;if(xo(e))return e}return.5}createNumberedListCounterStore(e){const t=this.numberedLists.state;for(const i of t)if(i.find((t=>t.id===e)))return i;return[]}getImageStyle(){return this[Co][vo]||{}}[qi](){const{coverHeight:e,coverSizeFormat:t}=this[Co];if(e)return e;switch(t){case"large":return ze.Z.card.desktop.large[Xi];case"small":return ze.Z.card.desktop.small[Xi];case"medium":default:return ze.Z.card.desktop.medium[Xi]}}getCoverWidth(){const{coverWidth:e,coverSizeFormat:t}=this[Co];if(e)return e;switch(t){case"large":return ze.Z.card.desktop.large.width;case"small":return ze.Z.card.desktop.small.width;case"medium":default:return ze.Z.card.desktop.medium.width}}[so](){return{[Xi]:this[qi](),position:"relative",[So]:wo,overflow:"hidden"}}[Yi](){const{ThemeStore:e}=this.environment,t="dark"===e.state.mode;return{[Xi]:this[qi](),[So]:wo,overflow:"hidden",background:this.theme.collectionGalleryPreviewCardCover,boxShadow:t?"transparent":`inset 0 -1px 0 0 ${this.theme[Qi]}`,padding:"8px 8px 0"}}getCoverStyle(){return{width:"100%",[Xi]:this[qi](),[to]:"center",borderRadius:0,borderTopLeftRadius:1,borderTopRightRadius:1}}[io](){const{coverAspectFormat:e}=this[Co];return{objectFit:void 0===e?"cover":e}}getPageContentImageStyle(){return{...this.getCoverStyle(),[to]:"center center"}}}Io.displayName="CollectionItemCover";const Po=Io;var Do=i(9118),Mo=i(78030),Zo=i(64203),Bo=i(64921),Ro=i(3386),Eo=i(84076),Vo=i(31278),Ao=i(41714),Lo=i(65187),_o=i(25155);const Oo=i(85).OM8,Fo=i(85).ChN,No=i(85).TEz,Go=i(85).$9E,Ho=i(85).qLW,Wo=i(85).gRm,Ko=i(85).voC,zo=i(85).rI1,Uo=i(85)._V5,$o=i(85).Mm1,Qo=i(85).ewQ,qo=i(85).MHP,Xo=i(85).qc1,Yo=i(85).Yzm,jo=i(85).Sjv,Jo=i(85).NF1,es=i(85).XNW,ts=i(85).nLZ,is=i(85).dmz,os=i(85).rJs,ss=i(85).Dg8,rs=i(85).Ej5,ns=i(85).KS0,ls=i(85).Scd,as=i(85).$bT,ds=i(85).sM5,hs=i(85).jms,cs=i(85).Vgm,us=i(85).z$9,ps=i(85).xOW,ms=i(85).LIR,gs=i(85).XqV,vs=i(85).tDk,fs=i(85).XQm,ys=i(85).Ixn,ws=i(85).EIp,Ss=i(85).PR5,bs=i(85).FqE,ks=i(85).ogB,Cs=i(85).xrO,Ts=i(85).kA0,xs=i(85).YSw,Is=i(85).T4J,Ps=i(85).W1o,Ds=i(85).i7F,Ms=i(85).JrN,Zs=i(85).WCo,Bs=i(85).N1Z,Rs=i(85).YfV,Es=i(85).AL1,Vs=i(85).mYq,As=i(85).du2,Ls=i(85).TtP,_s=i(85).Iol,Os=i(85).kzQ,Fs=i(85).bcx,Ns=i(85).P3s,Gs=i(85).qir,Hs=i(85).kId,Ws=i(85).YGn,Ks=i(85).b8T,zs=i(85).Wp_,Us=i(85).Kor,$s=i(85).gou,Qs=i(85).p2z,qs=i(85).AQx,Xs=i(85).ZG6,Ys=i(85).Gnd,js=i(85).LCr,Js=i(85).nxU,er=i(85).F6Q,tr=i(85).Drs,ir=i(85).JJj,or=i(85).vLt,sr=i(85).Au,rr=i(85).Hco,nr=i(85).PXg,lr=i(85).MpA,ar=i(85).xKX,dr=i(85).oWD,hr=i(85).urI,cr=i(85).ffk,ur=i(85).RSd,pr=i(85).qGZ,mr=i(85).PVc,gr=i(85).Wo8,vr=i(85).zDm,fr=i(85).NRr,yr=i(85).$pZ,wr=i(85).pkR,Sr=i(85).$Jh,br=i(85).fBv,kr=i(85).Soo,Cr=i(85).Xm7,Tr=i(85).f7G,xr=i(85).QNi,Ir=i(85).rpY,Pr=i(85).Joh,Dr=i(85).D7I,Mr=i(85).X_m,Zr=i(85).Jkr,Br=i(85).QYk,Rr=i(85).k9$,Er=i(85).U$H,Vr=i(85).PG2,Ar=i(85).BQ6,Lr=i(85).iNP,_r=i(85).qU4,Or=i(85).PrN,Fr=i(85).bQB,Nr=i(85).c1l,Gr=i(85).Aw$,Hr=i(85).rQ1,Wr=i(85).QmD,Kr=i(85).dLQ,zr=i(85).wgE,Ur=i(85).P0R,$r=i(85).P24,Qr=i(85).XtO,qr=i(85).xNP,Xr=i(85).Bgg,Yr=i(85).M82,jr=i(85).gz2,Jr=i(85).nx5,en=(0,P.defineMessages)({untitledBlock:{[Jr]:"Untitled",id:"collectionViewCardItem.untitledBlock"},typeAName:{[Jr]:"Type a name…",id:"collectionViewCardItem.itemName.placeholder"}});class tn extends Le.Z{constructor(){super(...arguments),this[jr]=void 0,this.storeTypes={[Yr]:Pe.Z,editModeStore:v.default},this.renderControl=e=>{let{[Xr]:t,[qr]:i,handleCancelClick:o,handleRepositionClick:s,handleSavePositionClick:r}=e;const{[Qr]:l,coverFormat:d,coverAspectFormat:h,[$r]:u}=this[Ur],{device:p}=this[zr],{[Kr]:m}=p,g=this[jr]&&d&&"contain"!==h,v=u[Hr][Wr],f=l[Gr]()&&("collectionTypedView"===u[Nr]||v[Fr]);if(t&&!this[Or][Wr])return;const y=Re.default[Wr].open&&Re.default[Wr].target.id===l.id,w=ie.getPeekMode(null==u?void 0:u[_r]()),b=(0,Ri.getPeekModeActionButtonProps)(w,!1);return a()(Fi.Z,{[Xr]:t,[br]:"top"},void 0,g&&!i&&!m&&a()(Bo.Z,{[Ar]:Ao.Z[Lr],[Vr]:e=>s(e,this[jr])},void 0,a()(P.FormattedMessage,{[Jr]:"Reposition",id:"collectionViewCardItem.action.reposition"})),g&&i&&!m&&a()(Bo.Z,{[Ar]:Ao.Z[Lr],[Vr]:r},void 0,a()(P.FormattedMessage,{[Jr]:"Save position",id:"collectionViewCardItem.action.savePosition"})),g&&i&&!m&&a()(Bo.Z,{[Ar]:Ao.Z[Lr],[Vr]:o},void 0,a()(P.FormattedMessage,{[Jr]:"Cancel",id:"collectionViewCardItem.action.cancel"})),this.shouldShowEditButton[Wr]&&f&&!this[Er][Wr]&&!v[Rr]&&a()(at.Z,{[Pr]:()=>a()(P.FormattedMessage,{[Jr]:"Edit",id:"collectionCardItem.edit.tooltip"}),[Ir]:e=>c[Dr](Bo.Z,n()({[Ar]:Ao.Z[Lr],[Vr]:()=>{this[Br]("click")}},e),S.Z.pencil({[Zr]:16,[Mr]:16}))}),this[Er][Wr]&&!y&&a()(at.Z,{[Pr]:()=>b[xr],[Ir]:e=>c[Dr](Bo.Z,n()({[Ar]:Ao.Z[Lr],[Vr]:()=>{this.peekUrl[Wr]&&(N[Tr]({[zr]:this[zr],url:this.peekUrl[Wr]}),this[Cr]())}},e),b.icon({[Zr]:14,[Mr]:14}))}),!i&&a()(at.Z,{[Pr]:()=>a()(P.FormattedMessage,{[Jr]:"Rename, delete, move to and more…",id:"collectionViewCardItem.repositionAction.tooltip"}),[Ir]:e=>c[Dr](Bo.Z,n()({[Ar]:Ao.Z[Lr],[Vr]:this[kr]},e),S.Z.dots({[Zr]:14,[Mr]:14}))}))},this[Sr]=e=>{const{[Qr]:t,[wr]:i,[yr]:o,[$r]:s}=this[Ur],r=t[fr]();if(!r)return;const n=this[Er][Wr],l="gallery"===this[vr]()?Mo.C.GalleryView:Mo.C.Board;return a()(Do.Z,{[Qr]:t,[cr]:e,[wr]:i||!t[Gr](),locked:s[Hr][Wr][gr],[hr]:l,tableWrap:!1,[yr]:o,[dr]:r,showIfEmpty:n,onEnter:this[mr],onEsc:this[mr],onBgClick:this[mr],onTab:this[pr],onUntab:this[ur],[_r]:this[Ur][$r][_r]()},e)},this.renderDiscussionIndicator=()=>{const{[Qr]:e}=this[Ur],t=Vi[ar](e,{[lr]:!1});if(t>0)return a()("div",{[Ar]:this.getDiscussionIndicatorWrapStyle()},void 0,S.Z.speechBubble({[Zr]:14,[Mr]:14,[nr]:4,fill:this[sr][rr]}),t)},this[or]=e=>{let{imagePosition:t,reset:i}=e;z[ir]({[tr]:er,[zr]:this[zr],[Js]:e=>{Ne.updateThumbnailCoverPosition({[Qr]:this[Ur][Qr],coverPosition:t,[js]:e}),i()}})},this.handleBlockEnter=()=>{const{[Qr]:e,onTextEnter:t}=this[Ur];t&&t(e)},this.handleBlockSpace=()=>{this[Br]("space")},this[Br]=e=>{const{[Qr]:t,[$r]:i}=this[Ur],{editModeStore:o}=this[Ys],s=(0,ai.JI)(t);W.edit({[zr]:this[zr],[Qr]:t}),m.default[Xs]((()=>{K[qs]({[Qr]:s})})),L[Qs]({[Qr]:t}),e&&D.trackCollectionItemEditModeEnter(this[zr],$s,{...(0,J.getCollectionAnalyticsContext)(i),[Us]:t.id,from:e,view_type:this[vr]()}),o[zs]("existing")},this[Ks]=e=>{this[Er][Wr]?e[Ws]():(this[Ur][Hs](),this[Cr]())},this[kr]=e=>{const{[$r]:t}=this[Ur];W[Gs]({[zr]:this[zr],[Qr]:this[Ur][Qr]}),Mi.Qn({[zr]:this[zr],[Ys]:_i.default[Wr][Ys],left:e.clientX,top:e.clientY,showInput:!0,actions:Di.Qi,[Ns]:"block_more_menu",[Fs]:{[$r]:t}})},this.handleTextEnter=()=>{const{[Qr]:e,onTextEnter:t,onTextEsc:i,[$r]:o}=this[Ur],{editModeStore:s}=this[Ys];L[Os](),K.clear(this[zr]);e[Gr]()&&o[Hr][Wr][Fr]&&("new_empty"===s[Wr]?i(e):"new"===s[Wr]?t(e):W[Gs]({[zr]:this[zr],[Qr]:e}),this[Cr]())},this.handleTextEsc=()=>{const{[Qr]:e,onTextEsc:t,[$r]:i}=this[Ur],{editModeStore:o}=this[Ys];L[Os]();e[Gr]()&&i[Hr][Wr][Fr]&&("new_empty"===o[Wr]?t(e):W[Gs]({[zr]:this[zr],[Qr]:e}),this[Cr]())},this.handleTextTab=()=>{const{[Qr]:e,[yr]:t}=this[Ur],i=this[_s]();i[Ls]>0&&Zi.open({[zr]:this[zr],[yr]:t,[Qr]:e,[cr]:i[0],[hr]:Mo.C.Page,[$r]:this[Ur][$r]}),this[Cr]()},this.handleTrackTitlePropertyEdit=()=>{const e=this[vr]();if(!e)return;const{[Qr]:t,[$r]:i}=this[Ur];R[As]({[zr]:this[zr],[$r]:i,[Us]:t.id,[cr]:"title",[Vs]:Es,from:e}),this[Cr]()},this.handleTextUntab=()=>{const e=this[_s](),t=h().findLast(e,((e,t)=>this[Rs](e)));t&&Zi.open({[zr]:this[zr],[yr]:this[Ur][yr],[Qr]:this[Ur][Qr],[cr]:t,[hr]:Mo.C.Page,[$r]:this[Ur][$r]}),this[Cr]()},this[mr]=()=>{Zi[Bs]({[zr]:this[zr],[yr]:this[Ur][yr]}),W[Gs]({[zr]:this[zr],[Qr]:this[Ur][Qr]}),this[Cr]()},this[pr]=()=>{const{[Qr]:e,[yr]:t}=this[Ur],i=t[Wr],o=this[_s](),s=i[Zs]?o[Ms]((e=>e===i[cr])):-1,r=o.find(((e,t)=>t>s&&this[Rs](e)))||o.find(((e,t)=>!this[Er][Wr]&&this[Rs](e)));r?m.default[Xs]((()=>{Zi.open({[zr]:this[zr],[yr]:t,[Qr]:e,[cr]:r,[hr]:Mo.C.Page,[$r]:this[Ur][$r]})})):this[Er][Wr]&&m.default[Xs]((()=>{this[Br]()})),Zi[Bs]({[zr]:this[zr],[yr]:t}),this[Cr]()},this[ur]=()=>{const{[Qr]:e,[yr]:t}=this[Ur],i=t[Wr];if(!i[Zs])return;const o=this[_s](),s=o[Ms]((e=>e===i[cr])),r=h().findLast(o,((e,t)=>t<s&&this[Rs](e)))||h().findLast(o,((e,t)=>!this[Er][Wr]&&this[Rs](e)));r?m.default[Xs]((()=>{Zi.open({[zr]:this[zr],[yr]:t,[Qr]:e,[cr]:r,[hr]:Mo.C.Page,[$r]:this[Ur][$r]})})):this[Er][Wr]&&m.default[Xs]((()=>{this[Br]()})),Zi[Bs]({[zr]:this[zr],[yr]:t}),this[Cr]()},this[Ds]=()=>{if(!Te.Z[Wr]){const{[Yr]:e}=this[Ys];e[zs]({...e[Wr],[Ps]:!0})}},this[Is]=()=>{const{[Yr]:e}=this[Ys];e[zs]({...e[Wr],[Ps]:!1})},this[xs]=(0,d.throttle)(this[Ds],100),this[Ts]=(0,d.debounce)(this[Is],100),this[Cs]=async e=>{const{[Qr]:t}=this[Ur],i=t.getIconStore();if(i){const{serverCommitResult:t}=z[ir]({[tr]:"PageViewBlock.handleRecordIconChange",[zr]:this[zr],[Js]:t=>{Bi.setValue({[Qr]:i,value:e,[js]:t})}});await t}this[Cr]()},this[ks]=()=>{const{[Qr]:e,onTextEsc:t,[$r]:i}=this[Ur],{editModeStore:o}=this[Ys];"new_empty"!==o[Wr]||this[Er][Wr]||i[bs][Wr]||(t(e),this[Er][Ss](this[ks]))},this[vr]=()=>{const{[$r]:e}=this[Ur],t=e[_r]();return null==t?void 0:t.getType()},this[Er]=this[ws]((()=>{const e=Ai.Z[Wr];return e[ys]&&e[Qr]===this[Ur][Qr]})),this.shouldShowEditButton=this[ws]((()=>{const e=this.isEditingTitle[Wr],t=this.getVisibleProperties(),i=this[_s]();return!e&&(this[Ur].shouldShowTitle||t[Ls]>0&&t[Ls]!==i[Ls])})),this.isEditingTitle=this[ws]((()=>{var e;const t=Oi.default[Wr];return"editing"===t.mode&&(null===(e=(0,Ei.QY)(t[fs]))||void 0===e?void 0:e[Qr])===(0,ai.JI)(this[Ur][Qr])})),this.peekUrl=this[ws]((()=>{const{[Qr]:e,[$r]:t}=this[Ur],{[vs]:i}=ge.default[Wr];return ie.getPeekModeHref({[Qr]:e,[vs]:i,[$r]:t,[gs]:!1})})),this.pageUrl=this[ws]((()=>{const{[Qr]:e}=this[Ur];return(0,se.ZP)({[Qr]:e,[gs]:!1,[ms]:f.tY.LinkInPage})})),this[Or]=this[ws]((()=>{const{device:e}=this[zr],{isKeyboardMode:t}=Li.Z[Wr];return!e[Kr]&&this[Gr]()&&!t})),this.mouseIsEntered=this[ws]((()=>this[Ys][Yr][Wr][Ps]&&!Te.Z[Wr])),this[Cr]=()=>{const{editModeStore:e}=this[Ys];"new_empty"===e[Wr]&&(e[zs]("new"),Ai.Z[Wr][ys]&&Ai.Z[zs]({...Ai.Z[Wr],transient:!1}))}}activate(){const e=this.peekUrl[Wr];e&&(this[Ur][Hs](),N[Tr]({[zr]:this[zr],url:e}))}willMount(){var e;const{editModeStore:t}=this[Ys],i=Oi.default[Wr],o="editing"===i.mode&&(null===(e=(0,Ei.QY)(i[fs]))||void 0===e?void 0:e[Qr])===(0,ai.JI)(this[Ur][Qr]),s=Ai.Z[Wr],r=s[ys]&&s.transient;o&&r?t[zs]("new_empty"):o?t[zs]("new"):t[zs]("existing")}didMount(){const{editModeStore:e}=this[Ys];super.didMount(),this[Er][Wr]&&"new_empty"===e[Wr]&&this[Er].addListener(this[ks])}willUnmount(){super.willUnmount(),this[Er][Ss](this[ks])}renderComponent(){const{device:e}=this[zr],{[Qr]:t,schema:i,coverFormat:o,coverAspectFormat:s,coverWidth:r,coverHeight:n,coverSizeFormat:l,shouldShowTitle:d,colorStyle:h,onShiftEnter:u}=this[Ur],p=this.pageUrl[Wr],m=this.peekUrl[Wr],g=this.mouseIsEntered[Wr],v=this[Er][Wr],f=this[vr](),y=(0,c.createRef)(),w=c[Dr](Eo.Z,{ref:y,[Ar]:{...this.getStyle(),[br]:g?ps:"static",..."gallery"===f&&{[Mr]:"100%"}},innerStyle:{userSelect:v?void 0:us,[cs]:v?void 0:us,[Mr]:"100%",..."board"===f&&{[hs]:40},..."gallery"===f&&{[ds]:"flex",[as]:"column"}},hoveredStyle:{[ls]:v?ns:(null==h?void 0:h.cardHoveredBackgroundColor)||this[sr].cardHoveredBackground},pressedStyle:{[ls]:v?ns:(null==h?void 0:h.cardPressedBackgroundColor)||this[sr].cardPressedBackground},href:p,metaHref:e[Kr]?p:m,onMouseEnter:this[xs],onMouseMove:this[xs],onMouseLeave:this[Ts],[Vr]:this[Ks]},a()(_o.Z,{[Yr]:this[Ys][Yr],onFlushTemporaryPosition:this[or],source:f,small:"small"===l,[Qr]:this[Ur][Qr],renderControl:this.renderControl},void 0,(e=>{let{imagePosition:d}=e;return o&&a()(Po,{[Qr]:t,coverWidth:r,coverHeight:n,coverFormat:o,coverAspectFormat:s,coverSizeFormat:l,coverPosition:d,schema:i,isGallery:"gallery"===f,[rs]:e=>{this[jr]=e}})})),d&&this[ss](),this[os](),this.renderDiscussionIndicator()),S=_i.default[Wr][Ys].includes(t);return a()(Ro.Z,{capture:v,onEsc:()=>{L[Os](),this[Cr]()},onEnter:this.handleBlockEnter,onSpace:this.handleBlockSpace,onTab:this[pr],onUntab:this[Br]},void 0,a()(Ro.Z,{capture:S,onShiftEnter:()=>{z[ir]({[tr]:er,[zr]:this[zr],[Js]:e=>{u({blocks:_i.default[Wr][Ys],[js]:e})}})}},void 0,w,this.showTutorialTooltip()&&a()(Zo.bZ,{origin:y})))}[ss](){const{device:e}=this[zr],{[Qr]:t,[$r]:i}=this[Ur],o=(0,ai.JI)(t),s=t.hasIcon()||!t.isEmptyPage(),r=t.hasError(),n=t[Gr]()&&i[Hr][Wr][Fr],l=this[Er][Wr],d=this[vr](),h=a()(Vo.Z,n?{[wr]:!1,bucket:is,[Ar]:{...this.getRecordIconStyle(),...e[Kr]?tn.mobileTitleIconStyle:tn.desktopTitleIconStyle,..."board"===d&&{[ts]:1,[es]:0,[nr]:2,[Jo]:5,padding:2,[Zr]:24,[Mr]:24}},progressContainerStyle:this[jo](),icon:t.getIcon(),[Qr]:t,onChange:this[Cs],size:e[Kr]?24:20,isEmptyPage:t.isEmptyPage()}:{[wr]:!0,bucket:is,[Ar]:{...this.getRecordIconStyle(),...e[Kr]?tn.mobileTitleIconStyle:tn.desktopTitleIconStyle},progressContainerStyle:this[jo](),icon:t.getIcon(),[Qr]:t,size:e[Kr]?24:n?20:18,isEmptyPage:t.isEmptyPage()}),c=a()(Lo.Z,{[Qr]:o,[wr]:!l,disableSlashCommands:!0,disableEmojiCommands:!0,[qo]:!0,disableEmbedMenu:!0,onEnter:this.handleTextEnter,onEsc:this.handleTextEsc,onTab:this.handleTextTab,onUntab:this.handleTextUntab,onChange:this.handleTrackTitlePropertyEdit,placeholder:l?ne.default[Yo](en.typeAName):ne.default[Yo](en.untitledBlock),[Ar]:{...e[Kr]?tn.mobileTitleTextStyle:tn.desktopTitleTextStyle,..."board"===d&&{flexGrow:1,padding:2},[Xo]:l?void 0:us,cursor:l?Es:void 0,..."gallery"===d&&{whiteSpace:"pre-wrap"}},disableSelectAllBlocks:!0,pasteBehavior:"inline"});return a()("div",{[Ar]:this.getTitleWrapStyle()},void 0,(s||l)&&!r&&h,r&&S.Z.warning({fill:this[sr][Qo].orange[500],[Zr]:e[Kr]?20:16,[es]:e[Kr]?2:4,[nr]:e[Kr]?4:6,[$o]:6,[Uo]:6,[ds]:"inline-block",[zo]:"bottom"}),c)}[os](){const e=this[_s]();if(0!==e[Ls])return a()("div",{[Ar]:this.getPropertiesWrapStyle()},void 0,e.map(this[Sr]))}[Rs](e){const{schema:t}=this[Ur],i=t[e];return Boolean(i&&!Ii.noPropertyValueOverlayTypes.includes(i.type))}getVisibleProperties(){const{[hr]:e}=this[Ur];return(("board"===this[vr]()?e.board_properties:e.gallery_properties)||[]).filter((e=>e.visible))}[_s](){const{[Qr]:e,schema:t}=this[Ur],i=this.getVisibleProperties();if(!e.isDefined())return[];return i.filter((i=>{const o=this[Er][Wr]&&"title"!==i[cr];return Pi.cardPropertyFormatIsVisible({block:e.getModel(),[cr]:i[cr],schema:t,[Ko]:this[Ur][Qr][Ko],userId:this[zr].currentUser.id,userTimeZone:(0,Qe.r)(),intl:ne.default.getIntl()})||o})).map((e=>e[cr]))}hasNoProperties(){return 0===this[_s]()[Ls]}showTutorialTooltip(){var e,t,i;const{[Qr]:o,[$r]:s}=this[Ur];return!(o.getSpaceId()!==(null===(e=ge.default[Wr].currentSpaceStore)||void 0===e?void 0:e.id))&&((null===(t=s[_r]())||void 0===t?void 0:t[Ho]()[Wo])===y.g3&&o[Ho]()[Wo]===y.z3&&"sprint_board"===(null===(i=ge.default[Wr][vs])||void 0===i?void 0:i[Ho]()[Go])&&(0,q.wY)())}getStyle(){const{colorStyle:e}=this[Ur],t=this[vr]();return{boxShadow:e?this[sr].selectTypeBoardBoxShadow:this[sr].lightBoxShadow,[Jo]:"board"===t?4:3,[ls]:"board"===t?(null==e?void 0:e.cardBackgroundColor)||this[sr].boardItemDefaultBackground:this[sr].collectionGalleryPreviewCardBackground,overflow:"hidden",transition:"background 100ms ease-out",..."board"===t&&{marginBottom:mh}}}getRecordIconStyle(){return{..."board"===this[vr]()&&{[ts]:1,[es]:0,[nr]:2,[Jo]:5,padding:2,[Zr]:24,[Mr]:24}}}[jo](){return{top:14,bottom:"unset",right:"unset",fontSize:12}}getTitleWrapStyle(){const e=this[vr]();return{..."gallery"===e&&{[Zr]:"100%"},[ds]:"flex",[Uo]:8,paddingLeft:"board"===e?6:10,paddingRight:10,[$o]:"gallery"===e&&this.hasNoProperties()?10:6,[br]:ps}}getDiscussionIndicatorWrapStyle(){const e=this[vr]();return{[ds]:"flex",alignItems:"center",color:this[sr][No],fill:this[sr][No],[Fo]:x.Z[Fo].semibold,fontSize:12,paddingLeft:10,paddingRight:10,[$o]:8,..."gallery"===e&&{[Uo]:this.hasNoProperties()&&!this[Ur].shouldShowTitle?8:0}}}getPropertiesWrapStyle(){const{shouldShowTitle:e}=this[Ur],t=this[vr]();return{[Uo]:e?0:8,[$o]:10,..."board"===t&&{[Oo]:1.5,[$o]:4,[ds]:"flex",[as]:"column"}}}}tn.desktopTitleIconStyle={float:"left",[ts]:2,[nr]:4,[es]:-2},tn.mobileTitleIconStyle={float:"left",[ts]:0,[nr]:4,[es]:-2},tn.desktopTitleTextStyle={fontSize:14,[Oo]:1.5,[hs]:21,[Fo]:x.Z[Fo].medium,[Zr]:"auto"},tn.mobileTitleTextStyle={fontSize:16,[Oo]:1.5,[hs]:24,[Fo]:x.Z[Fo].medium,[Zr]:"auto"};const on=tn,sn=i(85).P24,rn=i(85).kId,nn=i(85).$pZ,ln=i(85).Gm0,an=i(85).PgK,dn=i(85).jHz,hn=i(85).P0R;class cn extends Le.Z{renderComponent(){return a()(on,{store:this[hn].store,disabled:this[hn].disabled,isFirstItem:this[hn].isFirstItem,isLastItem:this[hn].isLastItem,hideContent:this[hn].hideContent,[dn]:this[hn][dn],isQuickFind:this[hn].isQuickFind,style:this[hn].style,disableCommentMenu:this[hn].disableCommentMenu,disableHoverMenu:this[hn].disableHoverMenu,disableDrag:this[hn].disableDrag,[an]:this[hn][an],[ln]:this[hn][ln],format:this[hn].format,schema:this[hn].schema,coverFormat:this[hn].coverFormat,coverAspectFormat:this[hn].coverAspectFormat,coverSizeFormat:this[hn].coverSizeFormat,coverHeight:void 0,coverWidth:void 0,shouldShowTitle:this[hn].shouldShowTitle,colorStyle:this[hn].colorStyle,onTextEnter:this[hn].onTextEnter,onTextEsc:this[hn].onTextEsc,onShiftEnter:this[hn].onShiftEnter,[nn]:this[hn][nn],isLast:this[hn].isLast,[rn]:this[hn][rn],[sn]:this[hn][sn]})}}const un=cn;var pn=i(73063);class mn extends p.Z{renderComponent(){const{limit:e}=this.props;return a()(P.FormattedMessage,{defaultMessage:"{limit} pages",values:{limit:e.limit},id:"database.FirstLoadLimitSelectOption.limitPagesTitle"})}}mn.displayName="FirstLoadLimitSelectOption";const gn=(0,P.injectIntl)(mn),vn=i(85).nx5,fn=i(85).D7I;class yn extends p.Z{renderComponent(){const{device:e}=this.environment,{currentLimit:t,onAccept:i,onClose:o,showTitle:s}=this.props,r=[{key:0,render:e=>c[fn](lt.Z,n()({enableActionSheetTitle:!0,title:s&&a()(P.FormattedMessage,{[vn]:"Show on first load",id:"database.firstLoadLimitSelectMenu.firstLoadLimitSetting"})},e)),items:h().compact(Pi.inlineCollectionFirstLoadLimitOptions.map(((e,o)=>({key:o,render:i=>c[fn](et.Z,n()({},i,{disabled:!1,title:a()(gn,{limit:e}),checkState:h().isEqual(t,e)})),action:()=>i(e)}))))}];let l;return l=e.isMobile?{menuType:Ye.og.ActionSheet}:{menuType:Ye.og.Popup,width:200},c[fn](it.Z,l,a()(ot.Z,{type:ot.i.Vertical,sections:r,onAccept:o,initialFocus:void 0}))}}yn.displayName="FirstLoadLimitSelectMenu";const wn=(0,P.injectIntl)(yn),Sn=i(85).D7I,bn=i(85).PXg,kn=i(85).XNW,Cn=i(85).jQT,Tn=i(85).BpM,xn=i(85).LCr,In=i(85).pKK,Pn=i(85).nXm,Dn=i(85).wgE,Mn=i(85).Drs,Zn=i(85).JJj,Bn=i(85).qU4,Rn=i(85).P24,En=i(85).yO8;class Vn extends p.Z{constructor(){super(...arguments),this.renderPopup=e=>a()(wn,{currentLimit:this[En](),onAccept:this.handleFirstLoadLimitAccept,onClose:e.close,showTitle:!0}),this.handleFirstLoadLimitAccept=e=>{const{[Rn]:t}=this.props,i=t[Bn]();if(!i)return;const o=i.getType();o&&(z[Zn]({[Mn]:"FirstLoadLimitActionButton.handleFirstLoadLimitAccept",[Dn]:this[Dn],perform:t=>{Ne[Pn]({stores:[i],update:{[In]:e},[xn]:t})}}),t[Tn].resetAllLimits(),D[Cn](this[Dn],{view_type:o,action:"set_first_load_limit"}))}}renderComponent(){const{device:e}=this[Dn];return a()(tt.ZP,{popupType:e.isMobile?nt.kQ.SlideUp:nt.kQ.Popup,renderOrigin:e=>c[Sn](pn.Z,n()({icon:S.Z.dots,style:{[kn]:4,[bn]:4}},e)),alignmentToOrigin:tt.vR.End,placementToOrigin:tt.pO.Bottom,originGap:8,render:this.renderPopup})}[En](){const{format:e}=this.props;return(0,Pi.getNormalizedInlineCollectionFirstLoadLimit)(e[In],Boolean(e.collection_group_by))}}Vn.displayName="FirstLoadLimitActionButton";const An=Vn,Ln=i(85).nx5,_n=i(85).TEz,On=i(85).MAy,Fn=i(85).wgE,Nn=i(85).gNE,Gn=i(85).BpM,Hn=i(85).KNN,Wn=i(85).Lbv,Kn=i(85).sP9,zn=i(85).P24,Un=i(85).iWP;class $n extends p.Z{constructor(){super(...arguments),this[Un]=e=>{const{[zn]:t,[Kn]:i,[Wn]:o}=this.props,s=t[Gn][Hn](i);if(!s)return;const r=s[Nn].state;(0,re.Wi)(e),W.clear(this[Fn]),r&&E.incrementBlockLimit({[zn]:t,[Fn]:this[Fn],incrementLimitArgs:{[On]:this.props[On],currentResultCount:r.blockIds.length,[Kn]:s[Kn],[Wn]:o}}),D.trackInlineCollectionLoadMoreClick(this[Fn])}}renderComponent(){const{style:e,store:t,format:i,[zn]:o,[Kn]:s}=this.props;if(o[Gn][Hn](s))return a()(Bo.Z,{onClick:this[Un],onMouseDown:re.$0,style:{display:"flex",alignItems:"center",height:30,borderRadius:3,whiteSpace:"break-spaces",fontSize:14,...e}},void 0,S.Z.arrowDown(this.getLoadMoreButtonIconStyle()),a()("div",{style:{color:this.theme[_n]}},void 0,a()(P.FormattedMessage,{id:"database.loadMoreButtonTitle",[Ln]:"Load more"})),t.canEdit()&&a()(An,{[zn]:o,format:i}))}getLoadMoreButtonIconStyle(){return{width:14,height:14,marginLeft:4,marginRight:6,fill:this.theme.lightIconColor}}}$n.displayName="CollectionGroupLoadMoreButton";const Qn=$n;var qn=i(480),Xn=i(81954),Yn=i(24405),jn=i(76205),Jn=i(59054),el=i(95371),tl=i(77181),il=i(40150),ol=i(20144),sl=i(48543),rl=i(92628);const nl=i(85).sy7,ll=i(85).Nxi,al=i(85).bSA,dl=i(85).wu4,hl=i(85).hCp,cl=i(85).BpM,ul=i(85).KNN,pl=i(85).NRr,ml=i(85).EIp,gl=i(85).MOR,vl=i(85).qLW,fl=i(85).owv,yl=i(85).jQA,wl=i(85).qU4,Sl=i(85).kId,bl=i(85).ZG6,kl=i(85).$pZ,Cl=i(85).n36,Tl=i(85).nxU,xl=i(85).Drs,Il=i(85).JJj,Pl=i(85).UgH,Dl=i(85).lmZ,Ml=i(85)._yk,Zl=i(85).Q_9,Bl=i(85).siJ,Rl=i(85).zaB,El=i(85).AYg,Vl=i(85).sS,Al=i(85).Ttb,Ll=i(85).oWD,_l=i(85).wgE,Ol=i(85).ixe,Fl=i(85).bMI,Nl=i(85).QmD,Gl=i(85).P0R,Hl=i(85).sP9,Wl=i(85).P24,Kl=i(85).XtO,zl=i(85).LCr;class Ul extends p.Z{constructor(){super(...arguments),this.handleInsertBelow=e=>{const{insertStores:t,[zl]:i}=e,{[Kl]:o,[Wl]:s,[Hl]:r}=this[Gl],n=this[Fl][Nl];if(!n)return[];const l=this[Ol][Nl];return l?E.insert({[_l]:this[_l],[Ll]:n,[Wl]:s,[Hl]:r,[Al]:l[Nl],insertStores:t,[Kl]:o,[Vl]:!1,[zl]:i}):[]},this.handleInsertAbove=e=>{const{insertStores:t,[zl]:i}=e,{[Kl]:o,[Wl]:s,[Hl]:r}=this[Gl],n=this[Fl][Nl];if(!n)return[];const l=this[Ol][Nl];return l?E.insert({[_l]:this[_l],[Ll]:n,[Wl]:s,[Hl]:r,[Al]:l[Nl],insertStores:t,[Kl]:o,[Vl]:!0,[zl]:i}):[]},this.handleRemove=e=>{const{[Kl]:t,[Wl]:i,[Hl]:o}=this[Gl],{[zl]:s}=e;o.length>0&&E.removeGroup({[Kl]:t,[zl]:s,[Hl]:o,[Wl]:i,[_l]:this[_l]}),E.remove({[Kl]:t,[zl]:s})},this.handleDrop=e=>{const{[El]:t,droppedStores:i,[Rl]:o}=e,{[Kl]:s,[Wl]:r,[Hl]:n,subitemPath:l}=this[Gl],a=this[Fl][Nl];if(!a)return[];const d=this[Ol][Nl];if(!d)return[];const h=pe.default.mark(Bl);pe.default[Zl](h,{[_l]:this[_l],[Ml]:()=>J[Dl]({[Wl]:r,is_native_drop:!1,[Pl]:!1})}),z[Il]({[xl]:"CollectionGroupResultsItem.handleDrop",[_l]:this[_l],[Tl]:e=>{E.handleGroupDrop({[_l]:this[_l],[Ll]:a,targetStore:s,[El]:t,[Wl]:r,[Hl]:n,droppedStores:i,[Al]:d[Nl],[Rl]:o,[zl]:e,subitemPath:l})}})},this[Cl]=e=>{const{files:t,[El]:i}=e,{[Kl]:o,[Wl]:s,[Hl]:r}=this[Gl],n=this[Fl][Nl];if(!n)return[];const l=this[Ol][Nl];if(!l)return[];const a=pe.default.mark(Bl);pe.default[Zl](a,{[_l]:this[_l],[Ml]:()=>J[Dl]({[Wl]:s,is_native_drop:!0,[Pl]:!1})}),z[Il]({[xl]:"CollectionGroupResultsItem.handleNativeDrop",[_l]:this[_l],[Tl]:e=>{E.handleGroupNativeDrop({[_l]:this[_l],[Ll]:n,targetStore:o,[El]:i,[Wl]:s,[Hl]:r,files:t,[Al]:l[Nl],[zl]:e})}})},this.handleInsertRow=e=>t=>{let{[zl]:i}=t;const{[Kl]:o,[Wl]:s,[Hl]:r,subitemPath:n,[kl]:l,onSelectableInsertRow:a}=this[Gl],d=this[Fl][Nl];if(!d)return[];const h=this[Ol][Nl];if(!h)return[];const c=E.insertNewBlock({[_l]:this[_l],[Wl]:s,[Hl]:r,[Al]:h[Nl],[Kl]:o,[Vl]:"above"===e,[Ll]:d,[zl]:i,subitemPath:n,subitemInsertDirection:"below"});c&&a&&a(o,c),c&&l&&m.default[bl]((()=>{m.default[bl]((()=>{Zi.open({isNewBlock:!0,[_l]:this[_l],[kl]:l,[Kl]:c,property:"title",format:Mo.C.Table,[Wl]:s})}))}))},this[Sl]=()=>{const{[Wl]:e,[Sl]:t}=this[Gl],i=e[wl]();pe.default.mark(yl),t&&t(),O.Xd({[Wl]:e,[Ol]:this[Ol][Nl]});const o=null==i?void 0:i.getType();if(o){const e=null==i?void 0:i[vl]()[fl],t=e||sl.Ls[o];D.trackExpandBlock(this[_l],{is_peek:!0,from:o,peek_mode:t})}},this[gl]=this[ml]((()=>this[Gl][Kl].canEdit())),this[Fl]=this[ml]((()=>this[Gl][Kl][pl]())),this[Ol]=this[ml]((()=>{const{[Wl]:e,[Hl]:t}=this[Gl],i=e[cl][ul](t);return null==i?void 0:i[Ol]})),this[hl]=this[ml]((()=>ie[hl](this[Gl][Kl]))),this.normalizedCollectionViewSelectionStore=this[ml]((()=>{const e=Ai.Z[Nl];return e.isActive&&e[Kl]===this[Gl][Kl]}))}didMount(){this[Gl][Wl].onItemMount()}renderComponent(){const{[Kl]:e,resultProps:t,resultComponent:i,[Wl]:o,canDrag:s,canDrop:r,[dl]:n,belowDropZoneMargin:l,[al]:d,disabled:h,direction:u,onSelectableEnter:p,[ll]:m,touchDragOnly:g,isLast:v,[Hl]:f,toggleButton:y,subitemPath:w,disableSelectable:S,itemSelectableHaloStyle:b}=this[Gl],k=!h&&this[gl][Nl],C=this[Gl].shouldShowHoverMenu&&k,T=u!==ld.Vertical&&r,x=u!==ld.Vertical&&r,I=u===ld.Vertical&&r,P=c.createElement(i,{[Sl]:this[Sl],[Wl]:o,...t,[Kl]:e,key:e.id,isLast:v,toggleButton:y,subitemPath:w});return S?P:a()(rl.Z,{style:n?n(v):void 0,[Kl]:e,canSelect:k,shouldShowHalo:!this.normalizedCollectionViewSelectionStore[Nl],shouldForceRenderSelectionHalo:this[hl][Nl],haloStyle:{...ie.getHighlightHaloStyle(this[hl][Nl],this.theme),...b},canDrag:s,canDropBelow:I,canDropLeft:T,canDropRight:x,canNativeDropBelow:I,canNativeDropLeft:T,canNativeDropRight:x,canDropOnto:r,canTriggerContextMenu:k,showBlockMenuInput:!0,shouldShowHoverMenu:C,shouldShowCommentMenu:!1,onSelectableDrop:this.handleDrop,onNativeDrop:this[Cl],onInsertBelow:this.handleInsertBelow,onInsertAbove:this.handleInsertAbove,onRemove:this.handleRemove,canInsertAbove:r,canInsertBelow:r,onInsertRowBelow:this.handleInsertRow("below"),onInsertRowAbove:this.handleInsertRow("above"),belowDropZoneMargin:l,dropzoneShouldNeverUseOrigin:!0,[nl]:!0,[al]:d,shouldShowDropZone:r,dropzoneGap:this[Gl].dropzoneGap,onEnter:p,className:X.collectionItem,[ll]:m,touchDragOnly:g,[Hl]:f},void 0,P)}}Ul.displayName="CollectionGroupResultsItem";const $l=Ul;var Ql=i(5210);const ql=i(85).nx5,Xl=i(85).zrY,Yl=i(85).xej,jl=i(85).g9q,Jl=i(85).D7I,ea=i(85).Hco,ta=i(85).auS,ia=i(85).Zs0,oa=i(85).voC,sa=i(85).OBh,ra=i(85).vwl,na=i(85).EiQ,la=i(85).qU4,aa=i(85).oWD,da=i(85).iKt,ha=i(85).QmD,ca=i(85).TtP,ua=i(85).NRr,pa=i(85).vX_,ma=i(85).aKz,ga=i(85).wu4,va=i(85).P24,fa=i(85).XtO;function ya(e){window.__c={n:"CollectionGroupResultsNestedItem"};const{[fa]:t,[va]:i,subitemPath:o,titleColumnIndex:s,nestedCreateSubitemButton:r,[ga]:l}=e,{[ma]:d,[pa]:h,subitemTreeStore:u}=i,p=(0,Xn.VK)((()=>t[ua]()),[t]),m=(0,Xn.VK)((()=>o&&o[ca]>0?o:(0,el.DY)(u[ha].children,(e=>e.value[fa]===t))),[o,u,t],{useDeepEqual:!0}),g=m?(0,tl.Af)(m.map((e=>e.value[fa]))):"",v=(0,Xn.VK)((()=>h[ha].get(g)),[h,g]),f=Boolean(null==v?void 0:v[da]),y=(0,qn.O7)(),w=(0,Xn.VK)((()=>{const e=d[ha];if(!e||!p)return;const t=p.getSchema()[e.property];return void 0!==t&&(0,Ii.isRelationPropertySchema)(t)?t:void 0}),[d,p]),S=(0,Xn.VK)((()=>{var e;return w&&"relation"===w.type&&(0,Ii.getRelationPropertyCollectionId)(w)===(null===(e=i[aa]())||void 0===e?void 0:e.id)&&w.property}),[i,w]),b=(0,Xn.VK)((()=>{var e;return null===(e=i[la]())||void 0===e?void 0:e.getType()}),[i]),k=(0,Xn.VK)((()=>{const e=!S||b&&(0,tl.Av)(b)?void 0:{property:S,filter:{operator:"is_empty"}};return!(!d[ha]||!p)&&(0,tl.kC)({[fa]:t,[aa]:p,subitemFormat:d[ha],subitemPathKey:g,[va]:i,propertyFilters:[...e&&S?[{id:S,filter:e}]:[],...i[na][ha]],combinatorFilter:i[ra][ha],currentUserId:y.currentUser.id})[ca]>0}),[i,b,d,y.currentUser.id,S,p,g,t]),C=(0,Xn.VK)((()=>{var e;if(!d[ha]||!p)return!1;const t=null===(e=i[la]())||void 0===e?void 0:e.getType();return k||f||y.device.isMobile||"timeline"===t}),[d,y.device.isMobile,p,k,f,i]),T=(0,Xn.VK)((()=>ol.Z.getState().hoveredStore===t),[t]),x=(0,Xn.VK)((()=>{const e=(0,Y.m1)({[va]:i,environment:y});if(e)return(0,jn.q)(e)}),[i,y]),I=(0,c.useCallback)((()=>{const e=h[ha];if(f)e.delete(g),D.trackTableSubitemToggleClose(y,{...(0,J.getCollectionAnalyticsContext)(i),depth:(null==m?void 0:m[ca])||0}),h.emit();else{e.set(g,{[da]:!0,limit:20}),D.trackTableSubitemToggleOpen(y,{...(0,J.getCollectionAnalyticsContext)(i),depth:(null==m?void 0:m[ca])||0});const o=d[ha];x&&e&&w&&o?(0,tl.fd)({blockStore:t,[pa]:h,subitemFormat:o,[sa]:w,compiledFilter:x,pathKey:g,forceStoresToLoad:!1,visitedIds:new Set}).then((()=>{h.emit()})):h.emit()}}),[x,h,f,g,i,d,y,m,t,w]),P=(0,Xn.VK)((()=>{const i=u[ha];return i&&m?(0,tl.Ns)(i).value[fa]===t:e.isLast}),[u,e.isLast,t,m]),M=(0,Xn.VK)((()=>{var e;const i=t.getModel(),o=t[oa];if(!x||!i)return!0;const s=null===(e=t[ia]())||void 0===e?void 0:e.getPropertyMapping();return x({block:i,[oa]:o,propertyMapping:s})}),[x,t]),Z=(0,Xn.VK)((()=>l&&!M?()=>({...l?l(P):{},...M?{}:{opacity:.5}}):l),[l,M,P]);(0,Jn.r5)((async()=>{const e=t.getModel();await t.load();const i=t[oa],o=d[ha];if(!C||!e||!x||!w||!i||!o||M)return;(0,tl.xb)({[fa]:t,subitemFormat:o,[sa]:w})[ca]>0||(await(0,tl.fd)({blockStore:t,[pa]:h,subitemFormat:o,[sa]:w,compiledFilter:x,pathKey:g,forceStoresToLoad:!0,visitedIds:new Set}),h.emit())}),[C,x,d,M,g,t,h,w]);const B=(0,Yn.Fg)(),R=c[Jl]($l,n()({},e,{isLast:P,[ga]:Z,subitemPath:m,toggleButton:(C||T)&&a()(Ql.Z,{isSidebar:!1,open:f,fill:!0,onClick:I,color:k||f?B[ta]:B[ea],disabled:m&&m[ca]>=tl.F0})}));if(!f||!m||0===m[ca]||m[ca]>=tl.F0)return R;const E=m[m[ca]-1].children;return c[Jl](c.Fragment,null,R,E.map((t=>{const i=t.value[fa];return c[Jl](ya,n()({},e,{key:i.id,[fa]:i,subitemPath:[...m,t]}))})),p&&r&&r({[fa]:t,parentStore:p,subitemPath:m,indentLevel:m[ca],titleColumnIndex:s}),v&&E[ca]>0&&E[ca]===v.limit&&a()(wa,{[va]:e[va],pathKey:g,titleColumnIndex:s,limit:v.limit,indentLevel:m[ca]}))}function wa(e){window.__c={n:"NestedTableLoadMoreButton"};const{[va]:t,pathKey:i,titleColumnIndex:o,limit:s,indentLevel:r}=e,n=(0,c.useCallback)((()=>{const{[pa]:e}=t;e[ha].set(i,{[da]:!0,limit:s+20}),e.emit()}),[t,s,i]),l=(0,qn.O7)(),d=(0,Xn.VK)((()=>(0,ie.shouldShowBulkActionsToolbar)({environment:l,[va]:t})),[t,l]),h=(0,Xn.VK)((()=>{var e;return(0,q.$4)()&&"title"===(null===(e=t[la]())||void 0===e?void 0:e.getFormat()[jl])}),[t]),u=(0,Yn.yK)((e=>({button:{display:"flex",alignItems:"center",height:32,width:"100%",paddingLeft:8+(0,il.f2)({columnIndex:0,titleColumnIndex:o,shouldShowBulkActionsToolbar:d,indentLevel:r+1,isSubitemToggleOnTitleColumn:h}),fontSize:14,lineHeight:x.Z.lineHeight.UIRegular.desktop,borderTop:`1px solid ${e[Yl]}`,borderBottom:`1px solid ${e[Yl]}`,background:e[Xl]},icon:{width:14,height:14,marginLeft:-1,marginRight:6,fill:e.lightIconColor},label:{color:e.lightTextColor}})),[r,d,o,h]);return a()(Bo.Z,{onClick:n,onMouseDown:re.$0,style:u.button},void 0,S.Z.arrowDown(u.icon),a()("span",{style:u.label},void 0,a()(P.FormattedMessage,{[ql]:"Load more",id:"database.loadMoreButtonTitle"})))}const Sa=i(85).sy7,ba=i(85).gNE,ka=i(85).hNC,Ca=i(85).y79,Ta=i(85).c1l,xa=i(85).ixe,Ia=i(85).qq3,Pa=i(85).BpM,Da=i(85).KNN,Ma=i(85).EIp,Za=i(85).Xt4,Ba=i(85).LCr,Ra=i(85).Ttb,Ea=i(85).oWD,Va=i(85).nxU,Aa=i(85).Drs,La=i(85).JJj,_a=i(85).UgH,Oa=i(85).lmZ,Fa=i(85)._yk,Na=i(85).wgE,Ga=i(85).Q_9,Ha=i(85).siJ,Wa=i(85).uzK,Ka=i(85).QmD,za=i(85).zaB,Ua=i(85).AYg,$a=i(85).GfJ,Qa=i(85).NRr,qa=i(85).P0R,Xa=i(85).$pZ,Ya=i(85).Nxi,ja=i(85).GCx,Ja=i(85).bSA,ed=i(85).kId,td=i(85).wu4,id=i(85).pkR,od=i(85).sP9,sd=i(85).P24,rd=i(85).TtP,nd=i(85).gym;let ld;!function(e){e[e[Ca]=0]=Ca,e[e.Horizontal=1]="Horizontal"}(ld||(ld={}));class ad extends p.Z{constructor(){super(...arguments),this[nd]=void 0,this.renderResult=(e,t,i)=>{const o=t===i[rd]-1,{[sd]:s,resultProps:r,resultComponent:n,[od]:l,shouldShowHoverMenu:d,canDrag:h,[id]:c,format:u,[td]:p,[ed]:m,belowDropZoneMargin:g,[Ja]:v,[ja]:f,onSelectableEnter:y,canDrop:w,[Ya]:S,touchDragOnly:b,[Xa]:k,onSelectableInsertRow:C,disableSelectable:T,titleColumnIndex:x,nestedCreateSubitemButton:I,itemSelectableHaloStyle:P}=this[qa];if(e[Qa]())return a()(ya,{[td]:p,itemSelectableHaloStyle:P,store:e,canDrag:h,resultProps:r,resultComponent:n,[sd]:s,[od]:l,shouldShowHoverMenu:d,canDrop:w&&!c,format:u,[ed]:m,belowDropZoneMargin:g,[Ja]:v,[id]:c,[ja]:f,dropzoneGap:this[qa].dropzoneGap,onSelectableEnter:y,[Ya]:S,touchDragOnly:b,isLast:o,subitemPath:ad.subResultSubitemPath,titleColumnIndex:x,[Xa]:k,onSelectableInsertRow:C,disableSelectable:T,nestedCreateSubitemButton:I},e.id)},this[$a]=e=>{const{[Ua]:t,droppedStores:i,[za]:o}=e,{[sd]:s,[od]:r}=this[qa],n=this.emptyDroppableIntoStore[Ka];if(!n)return;const l=s[Wa]();if(!l)return;const a=pe.default.mark(Ha);pe.default[Ga](a,{[Na]:this[Na],[Fa]:()=>J[Oa]({[sd]:s,is_native_drop:!1,[_a]:!0})}),z[La]({[Aa]:"CollectionGroupResults.handleEmptyDroppableDrop",[Na]:this[Na],[Va]:e=>{E.handleGroupDrop({[Na]:this[Na],[Ea]:n,targetStore:l,[Ua]:t,[sd]:s,[od]:r,droppedStores:i,[Ra]:this.resultStores[Ka],[za]:o,[Ba]:e})}})},this[Za]=e=>{const{files:t,[Ua]:i}=e,{[sd]:o,[od]:s}=this[qa],r=this.emptyDroppableIntoStore[Ka];if(!r)return;const n=o[Wa]();if(!n)return;const l=pe.default.mark(Ha);pe.default[Ga](l,{[Na]:this[Na],[Fa]:()=>J[Oa]({[sd]:o,is_native_drop:!0,[_a]:!0})}),z[La]({[Aa]:"CollectionGroupResults.handleEmptyDroppableNativeDrop",[Na]:this[Na],[Va]:e=>{E.handleGroupNativeDrop({[Na]:this[Na],[Ea]:r,targetStore:n,[Ua]:i,[sd]:o,[od]:s,files:t,[Ra]:this.resultStores[Ka],[Ba]:e})}})},this.resultsReducerStore=this[Ma]((()=>{const{[sd]:e,[od]:t,loadContentCover:i}=this[qa],o=e[Pa][Da](t);if(!o)return;const s=o.currentLimit[Ka],r=e[Ia][Ka],n=h().compact(t.map((e=>(0,$e.Ko)({schema:r,group:e,timeZone:(0,Qe.r)()})))),l=n[rd]>0?{operator:"and",filters:n}:void 0;return{type:Ra,filter:l,limit:s,loadContentCover:i}})),this.resultStores=this[Ma]((()=>{const{[sd]:e,[od]:t}=this[qa],i=e[Pa][Da](t);return(null==i?void 0:i[xa][Ka])??[]})),this.emptyDroppableIntoStore=this[Ma]((()=>{const{[sd]:e,[od]:t}=this[qa];var i,o;return"collectionTypedView"===e[Ta]?null===(i=e[Pa][Da](t))||void 0===i||null===(o=i[xa][Ka])||void 0===o?void 0:o[0][Qa]():e[Ea]()}))}getNode(){return super.getNode()}willMount(e){super.willMount(e);const t=e[sd][Wa]();t&&(this[nd]=new Ee.G(this[Na],t.pointer))}didMountOrUpdate(){this[qa][sd].renderEmitter.emit()}renderComponent(){const{emptyDroppableStyle:e,[ja]:t}=this[qa],i=this[qa].emptyDroppableSize||"none",o=t===ld[Ca];return c.createElement(c.Fragment,null,a()("div",{style:{...o?{height:i}:{width:i},...e}},void 0,this[ka]()),this.resultStores[Ka].map(this.renderResult),this.renderReducerRequest())}renderReducerRequest(){const{[sd]:e,[od]:t,disableRequest:i}=this[qa];if(i)return;const o=this.resultsReducerStore[Ka];if(!o)return;const s=e[Pa][Da](t);return s?a()(Je.Z,{id:t[rd]>0?`results:${(0,_e.KW)(t)}`:"collection_group_results",reducer:o,[od]:t,[sd]:e,resultStore:s[ba]}):void 0}[ka](){const{[id]:e,[Ja]:t,[ja]:i,onSelectableEnter:o,canDrop:s,[od]:r}=this[qa];if(this[nd]){const n=i!==ld[Ca]&&(!e&&0===this.resultStores[Ka][rd]),l=i===ld[Ca]&&!e;return a()(rl.Z,{store:this[nd],canSelect:!1,canEditText:!1,shouldShowHalo:!0,canDrag:!1,canDropLeft:s&&n,canNativeDropLeft:s&&n,canDropBelow:s&&l,canNativeDropBelow:s&&l,canTriggerContextMenu:!1,showBlockMenuInput:!1,shouldShowHoverMenu:!1,dropzoneShouldNeverUseOrigin:!0,[Sa]:!0,onSelectableDrop:this[$a],onNativeDrop:this[Za],[Ja]:t,shouldShowDropZone:s,onEnter:o,[od]:r,style:i===ld[Ca]?void 0:{width:"100%",height:"100%"}})}}}ad.displayName="CollectionGroupResults",ad.subResultSubitemPath=[];const dd=ad;var hd=i(43145);const cd=i(85).S9$,ud=i(85).jFW,pd=i(85).OtN,md=i(85).Ya2,gd=i(85).D7I,vd=i(85).hSJ,fd=i(85).g7N,yd=i(85).nLZ,wd=i(85).xej,Sd=i(85).bSA,bd=i(85).rRE,kd=i(85).woI,Cd=i(85).Vml,Td=i(85).qdS,xd=i(85).$pZ,Id=i(85).pkR,Pd=i(85).Au,Dd=i(85).xd5,Md=i(85).urI,Zd=i(85).Kiu,Bd=i(85).htK,Rd=i(85).i7F,Ed=i(85).Lbv,Vd=i(85).xYh,Ad=i(85).m3I,Ld=i(85).uzK,_d=i(85).qU4,Od=i(85).qir,Fd=i(85).AAM,Nd=i(85).nxU,Gd=i(85).Drs,Hd=i(85).JJj,Wd=i(85).Maw,Kd=i(85).ZU6,zd=i(85).ixe,Ud=i(85).JrN,$d=i(85).Ylz,Qd=i(85).oWD,qd=i(85).vTv,Xd=i(85).TtP,Yd=i(85).MAy,jd=i(85).LCr,Jd=i(85).RX6,eh=i(85).Lg4,th=i(85).c_3,ih=i(85).YGn,oh=i(85).iPt,sh=i(85).Gm5,rh=i(85).wgE,nh=i(85).gNE,lh=i(85).QmD,ah=i(85).BpM,dh=i(85).KNN,hh=i(85).P0R,ch=i(85).P24,uh=i(85).sP9,ph=i(85).EIp,mh=5;function gh(e){return e?8:12}class vh extends p.Z{constructor(){super(...arguments),this.isReady=this[ph]((()=>{const{[uh]:e,[ch]:t}=this[hh],i=t[ah][dh](e);return Boolean(null==i?void 0:i[nh][lh])})),this.handleGroupMouseDown=e=>{const{device:t}=this[rh];t.isMobile||(0,re.ZP)({event:e,[sh]:re.Af.EditorMouseDown,[oh]:()=>{e[ih](),F[th]({[rh]:this[rh],target:e.target,startX:e.clientX,startY:e.clientY,showSelectionRect:!0,preventSelectStores:[],allowVerticalEdgeScroll:!0,[eh]:!0})}})},this.handleGroupClick=e=>{(0,re.ZP)({event:e,[sh]:re.Af.EditorClick,[oh]:()=>{}})},this[Jd]=e=>{const{blocks:t,[jd]:i}=e,{[uh]:o,[ch]:s,[Yd]:r}=this[hh];if(0===t[Xd])return;const n=t[0];if(!Ke[qd](this[rh])||!s[Qd]()||!s[$d]())return;const l=this.getResultsStore();if(!l)return;const a=l[lh][Ud]((e=>e===n))+1;li({[jd]:i,[rh]:this[rh],[zd]:l,[ch]:s,[Yd]:r,[uh]:o,insertAtIndex:a,from:Kd,transient:!0})},this.handleItemTextEnter=e=>{const{[uh]:t,[ch]:i,[Yd]:o}=this[hh];if(!Ke[qd](this[rh])||!i[Qd]())return this[Wd](e);const s=this.getResultsStore();if(!s)return;const r=s[lh][Ud]((t=>t===e))+1;z[Hd]({[Gd]:"BoardGroupResults.handleItemTextEnter",[rh]:this[rh],[Nd]:e=>{li({[jd]:e,[rh]:this[rh],[zd]:s,[ch]:i,[Yd]:o,[uh]:t,insertAtIndex:r,from:Kd,transient:!0})}})},this[Wd]=e=>{const{[ch]:t}=this[hh],i=t[Qd](),o=e[Fd]();if(!o)return;if(ti.getText(o.getValue()))W[Od]({[rh]:this[rh],store:e});else if(i){const{store:t,[ch]:i}=this[hh],o=this.getResultsStore();if(!o)return;const s=o[lh][Ud]((t=>t===e))-1,r=i[_d](),n=i[Ld]();if(r&&n&&D.trackDeleteNewlyCreatedBoardItem(this[rh],{...(0,J.getCollectionAnalyticsContext)(i),block_id:t.id}),z[Hd]({[Gd]:"BoardGroupResults.handleItemTextEsc",[rh]:this[rh],[Nd]:t=>{E.remove({store:e,[jd]:t})}}),s>=0){const e=o[lh][s];W[Od]({[rh]:this[rh],store:e})}}},this[Ad]=e=>{const{[ch]:t,[Yd]:i,[uh]:o}=this[hh],s=t[Vd][lh],r=t[ah][dh](o),n=null==r?void 0:r[nh][lh];e<ye.Z.incrementScrollOffset&&!s&&n&&n.hasMore&&E.incrementBlockLimit({[ch]:t,[rh]:this[rh],incrementLimitArgs:{[Yd]:i,currentResultCount:n.blockIds[Xd],[uh]:o,[Ed]:!1}})},this[Rd]=()=>{const e=h().last(this[hh][uh]);e&&this[hh][Bd][lh]!==e&&this[hh][Bd].setState(e)},this.colorStore=this[ph]((()=>{const{[uh]:e,[Zd]:t,[Md]:i,[ch]:o}=this[hh],s=h().last(e);return(0,Ge.II)({[rh]:this[rh],[Dd]:s,[Zd]:t,[Md]:i,[ch]:o,[Pd]:this[Pd]})}),!0)}renderComponent(){var e;const{store:t,[uh]:i,[ch]:o,[Id]:s,[Md]:r,[Zd]:n,[xd]:l,[Yd]:d}=this[hh],h=o[ah][dh](i);if(!h)return;const u=this.isReady[lh],p=this.getCoverFormat(),m=(0,ie.shouldUseLoadMoreButton)(o,d),g=h[nh][lh],v=o.permissionScopes[lh],f=!s&&u&&o[$d](),y=!s&&!v.isSyncedCollection,w=(0,ie.shouldRenderLoadMoreButton)({reducerResult:g,[ch]:o,[Yd]:d}),S=Boolean(r[Td]);return a()("div",{style:this.getStyle(),onMouseDown:this.handleGroupMouseDown,onClick:this.handleGroupClick,className:X.boardGroup,onMouseMove:this[Rd]},void 0,a()(dd,{[ch]:o,[uh]:i,[Md]:r,canDrag:y,onSelectableEnter:this[Jd],resultProps:{[Md]:r,[Zd]:n,onTextEnter:this.handleItemTextEnter,onShiftEnter:this[Jd],coverFormat:p,coverAspectFormat:this[Cd](),coverSizeFormat:this[kd](),shouldShowTitle:ai.K8(this[hh][Md],bd),colorStyle:this.colorStore[lh],onTextEsc:this[Wd],[Id]:s,[xd]:l,[ch]:o},canDrop:!0,resultComponent:un,[Id]:s,direction:ld.Vertical,shouldShowHoverMenu:!1,belowDropZoneMargin:2,emptyDroppableSize:S?mh:3,[Sd]:bd,loadContentCover:p&&"page_content"===p.type}),w&&a()(Qn,{[uh]:i,store:t,[ch]:o,[Md]:r,[Yd]:d,[Ed]:!0}),f&&c[gd](c.Fragment,null,w&&a()("div",{style:{width:"100%",borderTop:`1px solid ${this[Pd][wd]}`,[yd]:4,[fd]:4}}),a()(xi,{[uh]:i,[ch]:o,[Yd]:d,color:null===(e=this.colorStore[lh])||void 0===e?void 0:e[vd]})),!m&&a()(hd.Z,{onChange:this[Ad]}))}getCoverFormat(){const{[Md]:e}=this[hh];return e?e.board_cover:void 0}[Cd](){const{[Md]:e}=this[hh];return e?e.board_cover_aspect:void 0}[kd](){const{[Md]:e}=this[hh];return e?e.board_cover_size:void 0}[md](){const{[Md]:e}=this[hh];switch((e||{}).board_cover_size){case"large":return ze.Z.card.desktop.large.width;case"small":return ze.Z.card.desktop.small.width;case"medium":default:return ze.Z.card.desktop.medium.width}}getStyle(){const{[Md]:e}=this[hh],t=this.isReady[lh],i=this.colorStore[lh],o=Boolean(e[Td]);return{flex:"none",paddingLeft:mh,paddingRight:mh,paddingBottom:mh,marginRight:10,boxSizing:"content-box",width:this[md](),height:o?void 0:"max-content",...i&&t&&{[pd]:this[hh].isInPeekRenderer?i.peekBackgroundColor:i[pd],...o?{borderRadius:5}:{[ud]:5,[cd]:5}}}}getResultsStore(){const{[uh]:e,[ch]:t}=this[hh],i=t[ah][dh](e);return null==i?void 0:i[zd]}}vh.displayName="BoardGroupResults";const fh=(0,P.injectIntl)(vh);var yh=i(8848),wh=i(47307),Sh=i(33846),bh=i(93405),kh=i(9050);const Ch=i(85).EB9,Th=i(85).D7I,xh=i(85).Zs0,Ih=i(85).TLr,Ph=i(85).iEt,Dh=i(85).BCA,Mh=i(85).nx5,Zh=i(85).UD6,Bh=i(85).uLY,Rh=i(85).I2,Eh=i(85).$KA,Vh=i(85).X5t,Ah=i(85).J2Z,Lh=i(85).Qm2,_h=i(85).jQT,Oh=i(85).LCr,Fh=i(85).oq7,Nh=i(85).nxU,Gh=i(85).wgE,Hh=i(85).Drs,Wh=i(85).JJj,Kh=i(85).KOz,zh=i(85).oWD,Uh=i(85).aW,$h=i(85).ffk,Qh=i(85).P0R,qh=i(85).P24,Xh=i(85).xd5,Yh=i(85).eWV,jh=i(85).K0Z;class Jh extends p.Z{constructor(){super(...arguments),this.storeTypes={[jh]:Sh.Z},this[Yh]=e=>{const{[Xh]:t,schema:i,[qh]:o}=this[Qh],s=i[t[$h]];if(!s)return;if(!Ii[Uh](s))return;const r=o[zh]();if(!r)return;const n=t.value;if(n.type!==s.type)return;const l=(s[Kh]||[]).map((t=>t.value===n.value?{...t,color:e}:t)),a={...s,[Kh]:l},d={...i,[t[$h]]:a};z[Wh]({[Hh]:"CollectionGroupActionMenu.handleSelectPropertyColorPickerChange",[Gh]:this[Gh],[Nh]:e=>{L[Fh]({[Gh]:this[Gh],[zh]:r,update:{schema:d},[Oh]:e})}}),D[_h](this[Gh],{[Lh]:this[Ah](),[Vh]:"group_change_color"})},this.handleHide=()=>{const{[Xh]:e,[qh]:t,[Eh]:i,[Rh]:o}=this[Qh],s={...e,hidden:!0},r=(0,Ge.ar)(o,s);z[Wh]({[Hh]:"CollectionGroupActionMenu.handleHide",[Gh]:this[Gh],[Nh]:e=>{E.updateGroups({[qh]:t,[Bh]:r,[Eh]:i,[Oh]:e})}}),D[_h](this[Gh],{[Lh]:this[Ah](),[Vh]:"hide_group"})},this.handleShow=()=>{const{[Xh]:e,[qh]:t,[Eh]:i,[Rh]:o,groupsLimitStore:s}=this[Qh],r={...e,hidden:!1},n=(0,Ge.nr)(o,r,s.state);z[Wh]({[Hh]:"CollectionGroupActionMenu.handleShow",[Gh]:this[Gh],[Nh]:e=>{E.updateGroups({[qh]:t,[Bh]:n,[Eh]:i,[Oh]:e})}}),D[_h](this[Gh],{[Lh]:this[Ah](),[Vh]:"show_group"})},this[Zh]=()=>{wh.showDialog({message:a()(P.FormattedMessage,{[Mh]:"Are you sure? All pages inside this group will be deleted.",id:"database.collectionGroupActionMenu.deleteDialogMessage"}),showCancel:!0,keepFocus:!1,items:[{label:"Delete",color:"red",[Dh]:this[Ph]}]})},this[Ph]=async()=>{const{[qh]:e,[Rh]:t,[Xh]:i,[Eh]:o,intl:s}=this[Qh],r=e[zh]();if(!r)return;const n=i.value;if("relation"===n.type&&(0,_e.RA)(n.value)){const e=Ee.G[Ih](r,{id:n.value.id,table:C.iU});await e.load();const t=e[xh]();await(null==t?void 0:t.load())}z[Wh]({[Hh]:"CollectionGroupActionMenu.handleDelete",[Gh]:this[Gh],[Nh]:n=>{E.deleteGroup({[Gh]:this[Gh],[zh]:r,[$h]:i[$h],[Xh]:i,[Rh]:t,[Eh]:o,[qh]:e,[Oh]:n,intl:s})}}),D[_h](this[Gh],{[Lh]:this[Ah](),[Vh]:"delete_group"})}}renderComponent(){const{device:e}=this[Gh],{parent:t}=this[Qh],i=h().compact([this.getGroupActionsSection(),this.getSelectColorSection()]);let o;return o=e.isMobile?{menuType:Ye.og.Modal,title:a()(P.FormattedMessage,{[Mh]:"Action",id:"database.collectionGroupActionMenu.title"}),right:a()(st.DoneMenuText,{}),onClickRight:t.close}:{menuType:Ye.og.Popup},c[Th](it.Z,o,a()(ot.Z,{type:ot.i.Vertical,initialFocus:0,sections:i,[Dh]:e=>{"string"==typeof e.key&&e.key.includes(Jh.colorActionKeyPrefix)||t.close()}}))}getGroupActionsSection(){const{[Xh]:e,[qh]:t}=this[Qh],i=[],o=e.value,s=t.permissionScopes.state;(0,_e.eF)(e)?i.push({key:"show",render:e=>c[Th](bh.Z,n()({},e,{title:a()(P.FormattedMessage,{[Mh]:"Show",id:"database.collectionGroupActionMenu.showButtonTitle"}),svg:S.Z.collectionShow})),[Vh]:this.handleShow}):i.push({key:"hide",render:e=>c[Th](bh.Z,n()({},e,{title:a()(P.FormattedMessage,{[Mh]:"Hide",id:"database.collectionGroupActionMenu.hideButtonTitle"}),svg:S.Z.collectionHide})),[Vh]:this.handleHide}),void 0!==o.value&&s.canEditContent&&!s.isSyncedCollection&&"collectionTypedView"!==t.contextType&&i.push({key:"delete",render:e=>c[Th](bh.Z,n()({},e,{title:a()(P.FormattedMessage,{[Mh]:"Delete pages",id:"database.collectionGroupActionMenu.deleteButtonTitle"}),svg:S.Z.trash})),[Vh]:this[Zh]});return{key:"collection group",render:e=>c[Th](lt.Z,e),items:i}}getSelectColorSection(){const{schema:e,[Xh]:t}=this[Qh],i=t.value;if(void 0===i.value)return;const o=e[t[$h]];if(!o)return;if("select"!==o.type&&"multi_select"!==o.type)return;if(i.type!==o.type)return;const s=(o[Kh]||[]).find((e=>e.value===i.value));if(!s)return;return{key:"collection color section",render:e=>c[Th](lt.Z,n()({},e,{title:a()(P.FormattedMessage,{[Mh]:"Colors",id:"database.collectionGroupActionMenu.colorSectionTitle"}),topBorder:!0})),items:yh.AP.map((e=>({key:`${Jh.colorActionKeyPrefix}_${e}`,render:t=>c[Th](kh.Z,n()({},t,{color:e,checkState:s.color===e})),[Vh]:()=>{this[Yh](e)}})))}}[Ah](){const{[qh]:e}=this[Qh],t=e.getViewType();if(!t)throw new Error(Ch);return t}}Jh.displayName="CollectionGroupActionMenu",Jh.colorActionKeyPrefix="color";const ec=(0,P.injectIntl)(Jh);var tc=i(87052);const ic=i(85).OtN,oc=i(85).nx5,sc=i(85).Yzm,rc=i(85).bey,nc=i(85).D7I,lc=i(85).Isv,ac=i(85).mSd,dc=i(85).jPE,hc=i(85).Ylz,cc=i(85).rQ1,uc=i(85).pkR,pc=i(85).uRL,mc=i(85).EIp,gc=i(85).htK,vc=i(85).i7F,fc=i(85).E3P,yc=i(85).wqF,wc=i(85).cJo,Sc=i(85).qU4,bc=i(85).p2z,kc=i(85).AQx,Cc=i(85).M34,Tc=i(85).f7G,xc=i(85).LIR,Ic=i(85).dLQ,Pc=i(85).LCr,Dc=i(85).q$s,Mc=i(85).sP9,Zc=i(85).nxU,Bc=i(85).Drs,Rc=i(85).JJj,Ec=i(85).ixe,Vc=i(85).BpM,Ac=i(85).KNN,Lc=i(85).piL,_c=i(85).QmD,Oc=i(85).qdS,Fc=i(85).c1l,Nc=i(85).MAy,Gc=i(85).vTv,Hc=i(85).RH8,Wc=i(85).jQT,Kc=i(85).wgE,zc=i(85).oWD,Uc=i(85).ue3,$c=i(85).$KA,Qc=i(85).n4n,qc=i(85).f2X,Xc=i(85).P0R,Yc=i(85).P24,jc=i(85).Kiu,Jc=i(85).urI,eu=i(85).I2,tu=i(85).xd5,iu=i(85).ToB;class ou extends p.Z{constructor(){super(...arguments),this[iu]=e=>{const{[tu]:t,[eu]:i,[Jc]:o,[jc]:s,[Yc]:r}=this[Xc];return a()(ec,{parent:e,[tu]:t,[eu]:i,[Jc]:o,[jc]:s,[Yc]:r,[$c]:qc,groupsLimitStore:r[Qc]})},this[Uc]=e=>{const{[Yc]:t,...i}=this[Xc],o=t[zc]();o&&(E[Uc]({...e,[Kc]:this[Kc],[$c]:qc,[zc]:o,[Yc]:t,...i}),R[Wc]({[Kc]:this[Kc],[Yc]:t,action:"rename_group"}))},this[Hc]=()=>{const{device:e}=this[Kc];if(!Ke[Gc](this[Kc]))return;const{[Jc]:t,[tu]:i,onAddItem:o,[Yc]:s,[Nc]:r}=this[Xc];if("collectionTypedView"===s[Fc])return;const n=Boolean(t[Oc]);s[Lc][_c]&&L.updateSearchQuery({[Lc]:"",[Yc]:s,[Nc]:r});const l=s[zc](),a=s[Vc][Ac](i);if(!l||!a)return;const d=a[Ec];z[Rc]({[Bc]:"BoardGroupHeader.handleAddItemClick",[Kc]:this[Kc],[Zc]:t=>{const{coercionSucceeded:r,newStore:l}=E.createBlockInGroup({[Kc]:this[Kc],[Yc]:s,[Mc]:[i],results:d[_c],insertAtIndex:0,coerce:!0,[Dc]:!0,[Pc]:t,from:"board_group_header"});if(e[Ic]){const e=(0,se.ZP)({store:l,[xc]:f.tY.Create});this[Tc](e)}else if(r&&!n){const e=l[Cc]();W.edit({[Kc]:this[Kc],store:l}),K[kc]({store:e}),L[bc]({store:l})}else N.peekBlock({[Kc]:this[Kc],store:l,peekMode:(0,ie.getPeekMode)(s[Sc]()),[Ec]:d,[Yc]:s,[xc]:f.tY.Create});o&&o(l),D[wc](this[Kc],{from:"board_group_add_item_top",type:"page",new_page_id:l.id,...(0,J.getCollectionAnalyticsContext)(s)})}})},this.handleAggregationChange=e=>{const{[Yc]:t,query:i}=this[Xc],o=t[Sc](),s={...i,[yc]:e?[e]:[]};o&&z[Rc]({[Bc]:"BoardGroupHeader.handleAggregationChange",[Kc]:this[Kc],[Zc]:e=>{L[fc]({[Sc]:o,update:{query2:s},[Pc]:e})}})},this[vc]=()=>{this[Xc][gc][_c]!==this[Xc][tu]&&this[Xc][gc].setState(this[Xc][tu])},this.colorStore=this[mc]((()=>{const{[tu]:e,[jc]:t,[Jc]:i,[Yc]:o}=this[Xc];return(0,Ge.II)({[Kc]:this[Kc],[tu]:e,[jc]:t,[Jc]:i,[Yc]:o,theme:this.theme})}),!0),this.isHoveredStore=this[mc]((()=>(0,_e.ZH)(this[Xc][gc][_c],this[Xc][tu])))}[Tc](e){this.context[pc]?this.context[pc](e):N[Tc]({[Kc]:this[Kc],url:e})}renderComponent(){const{[uc]:e,[Yc]:t}=this[Xc],i=t[cc][_c],o=t[hc]();return a()("div",{style:this.getStyle(),onMouseMove:this[vc]},void 0,this.renderValue(),this[dc](),a()("div",{style:{flexGrow:1}}),!e&&i[ac]&&this[lc](),o&&this.renderAddButton())}[dc](){const{[uc]:e,query:t,[jc]:i,[Yc]:o,[tu]:s}=this[Xc],r=t[yc]?t[yc][0]:void 0,n=o[cc][_c];return a()(ei,{[tu]:s,[uc]:e||!n[ac],aggregation:r,[jc]:i,[Yc]:o,color:this.getTextColor(),onChange:this.handleAggregationChange})}renderValue(){const{[tu]:e,[jc]:t,[uc]:i,[eu]:o,[Jc]:s,groupBy:r,[Yc]:n}=this[Xc],l=su(s),d=n[cc][_c];if(n[Vc][Ac](e))return a()(tc.Z,{groupBy:r,[tu]:e,[eu]:o,[jc]:t,[uc]:i||!d[ac],isHiddenGroup:!1,onChange:this[Uc],style:{maxWidth:l-70},[Yc]:n})}[lc](){const{device:e}=this[Kc];return a()(tt.ZP,{popupType:e[Ic]?tt.Z4.SlideUp:tt.Z4.Popup,renderOrigin:e=>c[nc](pn.Z,n()({icon:S.Z.dots,[rc]:{fill:this.getTextColor()},style:this.getIconButtonStyle()},e)),render:this[iu]})}renderAddButton(){var e;const{[Yc]:t,intl:i}=this[Xc],o=null===(e=t[zc]())||void 0===e?void 0:e.getFormat().app_config_uri,s=(0,y.hf)(o);return a()(at.Z,{renderTooltip:()=>a()(P.FormattedMessage,{[oc]:"Create new {newItemName}",values:{newItemName:i[sc](s)},id:"database.boardView.actions.addNewItem.tooltip"}),render:e=>c[nc](pn.Z,n()({icon:S.Z.plus,onClick:this[Hc],style:this.getIconButtonStyle(),[rc]:{fill:this.getTextColor()}},e))})}getStyle(){const{hidden:e,[Jc]:t}=this[Xc],{device:i}=this[Kc],o=su(t),s=this.colorStore[_c],r=Boolean(t[Oc]);return{display:"flex",alignItems:"center",fontSize:14,width:o,paddingLeft:mh,paddingRight:mh,marginRight:10,marginBottom:e?4:0,boxSizing:"content-box",flexShrink:0,cursor:"pointer",...this[Xc].isPopup&&{padding:i[Ic]?"6px 16px":"8px 12px 4px",width:"none",minWidth:o},...s&&!e&&{[ic]:this[Xc].isInPeekRenderer?s.peekBackgroundColor:s[ic],...r?{borderRadius:5}:{borderTopLeftRadius:5,borderTopRightRadius:5}}}}getTextColor(){const e=this.colorStore[_c];return!this[Xc].hidden&&e?e.textColor:this.theme.lightTextColor}getIconButtonStyle(){const{hidden:e}=this[Xc];if(!e)return{transition:"opacity 100ms ease-in-out",opacity:this.isHoveredStore[_c]?1:0}}}function su(e){switch((e||{}).board_cover_size){case"large":return ze.Z.card.desktop.large.width;case"small":return ze.Z.card.desktop.small.width;case"medium":default:return ze.Z.card.desktop.medium.width}}ou.displayName="BoardGroupHeader",ou.contextTypes={...$.wK,...p.w};const ru=ou;class nu extends v.default{getInitialState(){return{searchQuery:"",limit:nu.defaultLimit}}}nu.defaultLimit=20,nu.loadMoreScrollOffset=200,nu.loadMoreIncrement=20;const lu=nu;var au=i(72087),du=i(21199),hu=i(68894),cu=i(68785),uu=i(43765),pu=i(37064);const mu=i(85).kdC,gu=i(85).cZW,vu=i(85).Yzm,fu=i(85).$Fm,yu=i(85).htK,wu=i(85).sy7,Su=i(85).NlJ,bu=i(85).ELX,ku=i(85).Ttb,Cu=i(85).EIp,Tu=i(85).uzK,xu=i(85).qir,Iu=i(85).AAM,Pu=i(85).ZU6,Du=i(85).JrN,Mu=i(85).Ylz,Zu=i(85).vTv,Bu=i(85).BpM,Ru=i(85).KNN,Eu=i(85).MAy,Vu=i(85).xYh,Au=i(85).E3P,Lu=i(85).wqF,_u=i(85).qU4,Ou=i(85).LCr,Fu=i(85).nxU,Nu=i(85).Drs,Gu=i(85).JJj,Hu=i(85).zaB,Wu=i(85).LZy,Ku=i(85).ogH,zu=i(85).ZIl,Uu=i(85).piL,$u=i(85).F1R,Qu=i(85).Gnd,qu=i(85).Wp_,Xu=i(85).$KA,Yu=i(85).n4n,ju=i(85).f2X,Ju=i(85).oWD,ep=i(85).bSA,tp=i(85).GCx,ip=i(85).kId,op=i(85).y79,sp=i(85).ZvK,rp=i(85).rRE,np=i(85).woI,lp=i(85).Vml,ap=i(85).TtP,dp=i(85).ixe,hp=i(85).$pZ,cp=i(85).urI,up=i(85).Dd5,pp=i(85).m3I,mp=i(85).p6m,gp=i(85).sP9,vp=i(85).gNE,fp=i(85).GzN,yp=i(85).QmD,wp=i(85).iVN,Sp=i(85).rpY,bp=i(85).D7I,kp=i(85).TEz,Cp=i(85).pHx,Tp=i(85).pkR,xp=i(85).ceT,Ip=i(85).dLQ,Pp=i(85).P0R,Dp=i(85).Leq,Mp=i(85).P24,Zp=i(85).I2,Bp=i(85).Kiu,Rp=i(85).xd5,Ep=i(85).wgE,Vp=i(85).kBp,Ap=i(85).fzh,Lp=i(85).LtW,_p=i(85).nx5,Op=i(85).N6T,Fp=(0,P.defineMessages)({[Op]:{[_p]:"Search for a page…",id:"boardHiddenGroup.searchPlaceholder"}});class Np extends p.Z{constructor(){super(...arguments),this.createdStores=new Set,this.storeTypes={[Lp]:ve.Z,[Ap]:lu,[Vp]:au.Z},this.renderPopup=()=>{const{device:e}=this[Ep],{[Rp]:t,[Bp]:i,[Zp]:o,[Mp]:s,[Dp]:r}=this[Pp];let l;l=e[Ip]?{[xp]:Ye.og.Modal,title:a()(tc.Z,{[Dp]:r,[Rp]:t,[Zp]:o,[Bp]:i,[Tp]:!0,isHiddenGroup:!0,[Mp]:s}),left:a()(tt.ZP,{popupType:nt.kQ[Cp],renderOrigin:e=>c[bp]("div",e,S.Z.dots({width:18,height:18,color:this.theme[kp]})),[Sp]:this.renderActionButtonPopup}),right:a()(st.DoneMenuText,{}),[wp]:this.handlePopupClose,header:this.renderHeader()}:{[xp]:Ye.og.Popup,header:this.renderHeader()};const d=this.reducerStore[yp];if(d)return a()(pu.Z,{store:this[fp],isDefaultContainer:!0,droppable:!0,[Sp]:e=>{let{selectableEvents:i}=e;return c[bp](it.Z,n()({},l,i),a()(Je.Z,{id:`board_hidden_group:${(0,_e.mD)(t)}`,reducer:d,[gp]:[t],[Mp]:s,[mp]:this[vp](),[Sp]:this.renderResults}),a()(hd.Z,{[up]:this[pp]}))}})},this.renderResults=()=>{var e,t;const{device:i}=this[Ep],{[Rp]:o,[Tp]:s,[cp]:r,[Mp]:n,[Bp]:l,[hp]:d}=this[Pp],h=null===(e=this[vp]())||void 0===e?void 0:e[yp],c=null===(t=this[dp]())||void 0===t?void 0:t[yp];return h&&c?0===c[ap]?a()(lt.Z,{},void 0,a()(uu.Z,{title:a()(P.FormattedMessage,{[_p]:"No results",id:"database.boardView.searchResults.noResults.label"})})):a()("div",{style:{padding:i[Ip]?"8px 16px":"6px 14px 8px"}},void 0,a()(dd,{[Mp]:n,[gp]:[o],[cp]:r,canDrag:!s,onSelectableEnter:this.handleBoardItemEnter,disableRequest:!0,resultProps:{[cp]:r,[Bp]:l,[Tp]:s,coverFormat:this.getCoverFormat(),coverAspectFormat:this[lp](),coverSizeFormat:this[np](),shouldShowTitle:ai.K8(this[Pp][cp],rp),colorStyle:void 0,[hp]:d,onTextEnter:this.handleBoardItemTextEnter,onTextEsc:this.handleBoardItemTextEsc,onShiftEnter:this.handleBoardItemEnter,[Mp]:n},resultComponent:un,[ip]:Re.default[sp]()?void 0:this.handlePopupClose,canDrop:!0,[Tp]:s,shouldShowHoverMenu:!1,[tp]:ld[op],belowDropZoneMargin:2,emptyDroppableSize:4,[ep]:rp})):a()(lt.Z,{},void 0,a()(uu.Z,{title:a()(cu.Z,{})}))},this.renderActionButtonPopup=e=>{const{[Rp]:t,[Zp]:i,[cp]:o,[Bp]:s,[Mp]:r}=this[Pp];if(r[Ju]())return a()(ec,{parent:e,[Rp]:t,[Zp]:i,[cp]:o,[Bp]:s,[Mp]:r,[Xu]:ju,groupsLimitStore:r[Yu]})},this.handlePopupClose=()=>{this[Qu][Lp][qu]({open:!1})},this[$u]=e=>{this[Qu][Ap][qu]({[Uu]:e.target.value,limit:lu.defaultLimit}),this[zu]()},this[Ku]=()=>{this[Qu][Ap].reset(),this[zu]()},this[Wu]=()=>{this[Qu][Ap].reset(),this[zu]()},this.handleDrop=e=>{const{droppedStores:t,[Hu]:i}=e,{[Mp]:o,[Rp]:s}=this[Pp],r=u.findDOMNode(this);r&&r instanceof Element&&z[Gu]({[Nu]:"BoardHiddenGroup.handleDrop",[Ep]:this[Ep],[Fu]:e=>E.handleCollapsedGroupDrop({[Ep]:this[Ep],[Mp]:o,[gp]:[s],droppedStores:t,[Hu]:i,[Ou]:e})})},this.handleBoardAggregationChange=e=>{const{[Mp]:t,query:i}=this[Pp],o=t[_u](),s={...i,[Lu]:e?[e]:[]};o&&z[Gu]({[Nu]:"BoardHiddenGroup.handleBoardAggregationChange",[Ep]:this[Ep],[Fu]:e=>{L[Au]({[_u]:o,update:{query2:s},[Ou]:e})}})},this.handleBoardGroupHeaderAddItem=e=>{this.createdStores.add(e)},this[pp]=e=>{var t,i;const{[Mp]:o}=this[Pp],{[Ap]:s}=this[Qu],r=s[yp],n=null===(t=this[vp]())||void 0===t||null===(i=t[yp])||void 0===i?void 0:i.blockIds,l=o[Vu][yp];e<lu.loadMoreScrollOffset&&!l&&n&&r.limit<=n[ap]&&s[qu]({...r,limit:r.limit+lu.loadMoreIncrement})},this.handleBoardItemEnter=e=>{const{blocks:t,[Ou]:i}=e,{[Rp]:o,[Mp]:s,[Eu]:r}=this[Pp],n=s[Bu][Ru](o);if(!n)return;const l=n[dp];if(t[ap]>0&&l[yp][ap]>0){const e=t[0];if(!Ke[Zu](this[Ep])||!s[Ju]()||!s[Mu]())return;const n=l[yp][Du]((t=>t===e))+1;li({[Ou]:i,[Ep]:this[Ep],[dp]:l,[Mp]:s,[Eu]:r,[gp]:[o],insertAtIndex:n,from:Pu,transient:!0})}},this.handleBoardItemTextEnter=e=>{const{[Mp]:t,[Eu]:i,[Rp]:o}=this[Pp],s=this[dp]();if(!s)return;if(!Ke[Zu](this[Ep])||!t[Ju]())return this.handleBoardItemTextEsc(e);const r=s[yp][Du]((t=>t===e))+1;z[Gu]({[Nu]:"BoardGroupResults.handleItemTextEnter",[Ep]:this[Ep],[Fu]:e=>{li({[Ou]:e,[Ep]:this[Ep],[dp]:s,[Mp]:t,[Eu]:i,[gp]:[o],insertAtIndex:r,from:Pu,transient:!0})}})},this.handleBoardItemTextEsc=e=>{const{[Mp]:t}=this[Pp],i=t[Ju](),o=e[Iu]();if(ti.getText(o.getValue()))return void W[xu]({[Ep]:this[Ep],store:e});if(!i)return;const s=this[dp]();if(!s)return;const r=s[yp][Du]((t=>t===e))-1,n=t[_u](),l=t[Tu]();if(n&&l&&D.trackDeleteNewlyCreatedBoardItem(this[Ep],{...(0,J.getCollectionAnalyticsContext)(t),block_id:e.id}),z[Gu]({[Nu]:"BoardHiddenGroup.handleBoardItemTextEsc",[Ep]:this[Ep],[Fu]:t=>{E.remove({store:e,[Ou]:t})}}),r>=0){const e=s[yp][r];W[xu]({[Ep]:this[Ep],store:e})}},this.reducerStore=this[Cu]((()=>{const{[Rp]:e,[Bp]:t,[cp]:i}=this[Pp],{[Ap]:o}=this[Qu],{[Uu]:s,limit:r}=o[yp],n=(0,$e.zk)({[Bp]:t,group:e,timeZone:(0,Qe.r)()});if(!n)return;return{type:ku,filter:n,limit:r,[Uu]:s,loadContentCover:Boolean(i&&i.board_cover&&"page_content"===i.board_cover.type)}}))}willMount(e){super.willMount(e);const t=e[Mp][Tu]();t&&(this[fp]=new Ee.G(this[Ep],{table:C.iU,id:t.id}))}renderComponent(){const{device:e}=this[Ep],{[Dp]:t,[Rp]:i,[Tp]:o,query:s,[Bp]:r,[Zp]:l,[Mp]:d}=this[Pp],h=s[Lu]?s[Lu][0]:void 0;return a()(rl.Z,{store:this[fp],canDropOnto:!o,onSelectableDrop:this.handleDrop,dropzoneShouldNeverUseOrigin:!0,[wu]:!0,[ep]:"board_hidden_group",shouldShowDropZone:!0},void 0,a()(tt.ZP,{popupType:e[Ip]?nt.kQ[Cp]:nt.kQ.Popup,renderOrigin:e=>c[bp](Bo.Z,n()({key:(0,_e.mD)(i),style:Np[bu]},e),a()(tc.Z,{[Dp]:t,[Rp]:i,[Zp]:l,[Bp]:r,[Tp]:!0,isHiddenGroup:!0,[Mp]:d}),a()(ei,{[Rp]:i,[Su]:h,[Bp]:r,[Mp]:d,[Tp]:!0,[up]:this.handleBoardAggregationChange})),[Sp]:this.renderPopup,[Lp]:this[Qu][Lp],onClick:this[Wu]}))}renderHeader(){const{device:e}=this[Ep],{[Rp]:t,[Tp]:i,[cp]:o,[Bp]:s,query:r,[Zp]:l,[Mp]:d,[Eu]:h,[yu]:u,[Dp]:p,[fu]:m,intl:g}=this[Pp],{[Uu]:v}=this[Qu][Ap][yp];return a()(c.Fragment,{},void 0,!e[Ip]&&a()(ru,{[Dp]:p,[Zp]:l,[Rp]:t,query:r,[Bp]:s,[cp]:o,[Mp]:d,[Tp]:i||Boolean(v),hidden:!0,isPopup:!0,onAddItem:this.handleBoardGroupHeaderAddItem,[Eu]:h,[yu]:u,[fu]:m,intl:g},(0,_e.mD)(t)),a()("div",{style:{margin:e[Ip]?0:"6px 0"}},void 0,a()(du.Z,{capture:!0,[Sp]:t=>c[bp](hu.ZP,n()({value:v,[gu]:ne.default[vu](Fp[Op]),autoFocus:!e[Ip],[mu]:!0,[up]:this[$u],onClearButtonClick:this[Ku]},t))})))}[zu](){_i.default[yp][Qu][ap]>0&&W.clear(this[Ep])}getCoverFormat(){const{[cp]:e}=this[Pp];return e?e.board_cover:void 0}[lp](){const{[cp]:e}=this[Pp];return e?e.board_cover_aspect:void 0}[np](){const{[cp]:e}=this[Pp];return e?e.board_cover_size:void 0}[vp](){const{[Mp]:e,[Rp]:t}=this[Pp],i=e[Bu][Ru](t);return null==i?void 0:i[vp]}[dp](){const{[Mp]:e,[Rp]:t}=this[Pp],i=e[Bu][Ru](t);return null==i?void 0:i[dp]}}Np.displayName="BoardHiddenGroup",Np[bu]={display:"flex",alignItems:"center",justifyContent:"flex-start",height:32,padding:4,borderRadius:3};const Gp=Np;var Hp=i(4615),Wp=i(97880),Kp=i(68500);const zp=i(85).NF1,Up=i(85).PXg,$p=i(85).Mm1,Qp=i(85)._V5,qp=i(85).XCs,Xp=i(85).OtN,Yp=i(85).Scd,jp=i(85).wuN,Jp=i(85).D7I,em=i(85).nx5,tm=i(85).YDv,im=i(85).g7N,om=i(85).Uww,sm=i(85).EIp,rm=i(85).uLY,nm=i(85).KOz,lm=i(85).MWD,am=i(85).aW,dm=i(85).Gnd,hm=i(85).wgE,cm=i(85).jQT,um=i(85).QmD,pm=i(85).ffk,mm=i(85).P24,gm=i(85).xd5,vm=i(85).fBu,fm=i(85).P0R,ym=i(85).Leq,wm=i(85).I2,Sm=i(85).Kiu,bm=i(85).LtW;class km extends p.Z{constructor(){super(...arguments),this.storeTypes={[bm]:ve.Z},this.renderPopup=()=>{const{[Sm]:e,[wm]:t,[ym]:i}=this[fm];return a()(Kp.Z,{[gm]:void 0,[ym]:i,[wm]:t,[Sm]:e,onChange:this.handleEditMenuChange,onClose:this.handleEditMenuClose,[vm]:this[fm][vm]})},this.handleEditMenuChange=e=>{const{[mm]:t,[ym]:i,[Sm]:o,[wm]:s,onAccept:r,groupsLimitStore:n}=this[fm],{newGroupValue:l}=e,a=o[i[pm]],d=n[um];if(a&&(0,_e.LG)(a))if(R[cm]({[hm]:this[hm],[mm]:t,action:"board_add_group"}),this[dm][bm].reset(),Ii[am](a)){if(a[lm]!==l[lm])return;if(void 0===l.value)return;const e=a[nm]||[],t={id:(0,Hp.default)(),value:l.value,color:(0,Ii.getRandomSelectColor)(e)},n=[...e,t],h={...a,[nm]:n},c={...o,[i[pm]]:h},u={[pm]:i[pm],value:l,hidden:!1},p=(0,Ge.nr)(s,u,d);r({[rm]:p,newSchema:c})}else if("person"===a[lm]||"relation"===a[lm]||(0,_e.HB)(a[lm])){const t={[pm]:i[pm],value:l,hidden:!1},o=(0,Ge.nr)(s,t,d);r({[rm]:o,newPage:e.newPage})}else(0,_e.A1)(a[lm])||"status"===a[lm]||"number"===a[lm]||"created_by"===a[lm]||"last_edited_by"===a[lm]||"formula"===a[lm]||"checkbox"===a[lm]||"location"===a[lm]||(0,Wp.unreachable)(a[lm])},this.handleEditMenuClose=()=>{this[dm][bm].reset()},this.boardColorStore=this[sm]((()=>{const{[Sm]:e,[mm]:t}=this[fm];return(0,Ge.II)({[hm]:this[hm],[gm]:void 0,[Sm]:e,format:t[om][um],[mm]:t,theme:this.theme})}),!0)}renderComponent(){const{[ym]:e,[Sm]:t,[lm]:i}=this[fm],{[bm]:o}=this[dm],s=t[e[pm]];if(s&&(0,_e.LG)(s))return a()(tt.ZP,{render:this.renderPopup,[bm]:o,popupType:this[hm].device.isMobile?tt.Z4.SlideUp:tt.Z4.Popup,renderOrigin:e=>{return"default"===i?c[Jp](rt.Z,n()({isLightGray:!0,icon:S.Z.plus,style:{display:"flex",height:28,marginTop:12,[im]:4,width:"max-content",position:this[fm].stickyLeft?"sticky":void 0,left:this[fm].stickyLeft&&this[fm][tm]?this[fm][tm]:0,...this[fm].style}},e),a()(P.FormattedMessage,{[em]:"Add a group",id:"database.boardView.addGroupButtonTitle"})):c[Jp](pn.Z,n()({icon:e=>S.Z.plus({...e,fill:this.theme[jp]}),style:{width:35,[Yp]:null===(t=this.boardColorStore[um])||void 0===t?void 0:t[Xp],[tm]:10,[qp]:10,[Qp]:mh,[$p]:mh,[Up]:5,[zp]:5,height:33,...this[fm].style}},e));var t}})}}km.displayName="CollectionAddGroupButton";const Cm=km,Tm=i(85).EB9,xm=i(85).lmd,Im=i(85).Ttb,Pm=i(85).OO$,Dm=i(85).Xhr,Mm=i(85)._hR,Zm=i(85).OiA,Bm=i(85)._9S,Rm=i(85).ffk,Em=i(85).TEz,Vm=i(85).ChN,Am=i(85).pkR,Lm=i(85).eiN,_m=i(85).NlJ,Om=i(85).xd5,Fm=i(85).Kiu,Nm=i(85).mmP,Gm=i(85).EIp,Hm=i(85).Joh,Wm=i(85).nLZ,Km=i(85).NF1,zm=i(85).NLk,Um=i(85).ESK,$m=i(85).w30,Qm=i(85).J2Z,qm=i(85).jQT,Xm=i(85).LCr,Ym=i(85).E3P,jm=i(85).Drs,Jm=i(85).JJj,eg=i(85).qU4,tg=i(85).P0R,ig=i(85).urI,og=i(85).P24,sg=i(85).YQj,rg=i(85).BCA,ng=i(85).nQ3,lg=i(85).j7K,ag=i(85).SRP,dg=i(85).D7I,hg=i(85).rpY,cg=i(85).y79,ug=i(85).N1Z,pg=i(85).iVN,mg=i(85).nx5,gg=i(85).ceT,vg=i(85).dLQ,fg=i(85).wgE;class yg extends p.Z{constructor(){super(...arguments),this.renderMenu=e=>{const{device:t}=this[fg];let i;return i=t[vg]?{[gg]:Ye.og.Modal,title:a()(P.FormattedMessage,{[mg]:"Aggregation",id:"database.collectionGroupAggregation.title"}),right:a()(st.DoneMenuText,{}),[pg]:e[ug]}:{[gg]:Ye.og.Popup,width:200},c[dg](it.Z,i,a()(ot.Z,{type:ot.i[cg],[lg]:0,[ng]:[{key:"aggregation section",[hg]:e=>c[dg](lt.Z,e),items:this[ag]()}],[rg]:e[ug]}))},this[sg]=e=>{const{[og]:t,[ig]:i,groupAggregationKey:o}=this[tg],s=t[eg]();s&&z[Jm]({[jm]:"CollectionGroupAggregation.handleChangeAggregation",[fg]:this[fg],perform:t=>{L[Ym]({[eg]:s,update:{[ig]:{...i,[o]:e}},[Xm]:t})}}),D[qm](this[fg],{view_type:this[Qm](),action:"change_aggregation"})},this[$m]=(e,t,i)=>a()(at.Z,{placement:nt.GI[Um].Right,delayThreshold:0,[hg]:e=>c[dg](et.Z,n()({title:t},(0,je.Z)(e,i))),[Hm]:()=>a()("div",{style:{width:140,[zm]:"normal"}},void 0,a()("img",{src:(0,qe.D)(Xe.Sn[e]),style:{[Km]:3,width:140,[Wm]:4}}),Xe.BG[e])},i.key),this.aggregationStore=this[Gm]((()=>{const{[ig]:e,groupAggregationKey:t}=this[tg];return e[t]||{[Nm]:"count"}}),!0),this.reducerStore=this[Gm]((()=>{const{[Fm]:e,[Om]:t}=this[tg],i=this.aggregationStore.state,o=(0,$e.zk)({[Fm]:e,group:t,timeZone:(0,Qe.r)()});return{type:_m,[Lm]:o,[_m]:i}}))}renderComponent(){const{device:e}=this[fg];return a()(at.Z,{[Hm]:()=>this.renderTooltipText(),[hg]:t=>a()(tt.ZP,{popupType:e[vg]?tt.Z4.SlideUp:tt.Z4.Popup,renderOrigin:e=>c[dg](rt.Z,n()({[Am]:this[tg][Am],style:{[Vm]:x.Z[Vm].medium,color:this.theme[Em],height:24}},(0,je.Z)((0,je.Z)(t,e),{onClick:re.Wi})),this.renderValue()),[Am]:this[tg][Am],[hg]:this.renderMenu})})}renderTooltipText(){const{[Fm]:e}=this[tg],t=this.aggregationStore.state,i=Xe.VN[(0,Ue.OV)(t)];if((0,Ue.pK)(t)){const o=e[t[Rm]];if(o){return`${i} in ${o.name}`}}return i}renderValue(){const{[Fm]:e,[og]:t,[Om]:i}=this[tg],o=this.aggregationStore.state,s=this.reducerStore.state;if(s)return a()(Je.Z,{id:`group_aggregation:${(0,_e.mD)(i)}`,[og]:t,reducer:s,groupsPointer:[i],[hg]:t=>{const i=t.state;if(!i||"aggregation"!==i.type)return;let s;if((0,Ue.pK)(o)){const t=e[o[Rm]];!t||"formula"!==t.type&&"number"!==t.type||(s=t[Bm])}return(0,Xe.Ol)({numberFormat:s,dateFormat:void 0,aggregationType:o[Nm],userTimeZone:(0,Qe.r)(),value:i[Zm],roundDecimal:5})}})}[ag](){const e=[];for(const r of Ue.o5)e.push(this[Mm](r));const t=this.getDefaultProperties();if(t.length>0)for(const r of Ue.Sy)"show_unique"!==r&&e.push(this[Dm](r,t));const i=this.getNumericProperties();if(i.length>0)for(const r of Ue.k$)e.push(this[Dm](r,i));const o=this.getDateProperties();if(o.length>0)for(const r of Ue.f8)e.push(this[Dm](r,o));const s=this.getCheckboxProperties();if(s.length>0)for(const r of Ue.gC)e.push(this[Dm](r,s));return e}[Dm](e,t){const{device:i}=this[fg],o=Xe.VN[e],s=h().compact(t.map((t=>this[Pm](t,e))));return{key:e+o,[hg]:(e,t)=>c[dg](dt.Z,n()({},e,{onFocus:t.onFocus,renderOrigin:(e,t)=>c[dg](et.Z,n()({},e,{ref:t,title:o})),renderExtension:(e,r)=>{let n;return n=i[vg]?{[gg]:Ye.og.Modal,title:o,right:i.isPhone?a()(st.DoneMenuText,{}):void 0,[pg]:r[ug],...e}:{[gg]:Ye.og.Popup,width:200,...e},c[dg](it.Z,n,a()(ot.Z,{type:ot.i[cg],[lg]:0,[ng]:[{key:Im,[hg]:e=>c[dg](lt.Z,e),items:s}],[rg]:t[rg]}))}})),action:()=>null}}getDefaultProperties(){const{[Fm]:e}=this[tg];return Object.keys(e)[Lm]((t=>{const i=e[t];return i&&(0,Ue.iV)(i)&&!("rollup"===i.type&&"status"===i[xm])}))}getNumericProperties(){const{[Fm]:e}=this[tg];return Object.keys(e)[Lm]((t=>{const i=e[t];return i&&(0,Ue.O4)(i)}))}getDateProperties(){const{[Fm]:e}=this[tg];return Object.keys(e)[Lm]((t=>{const i=e[t];return i&&(0,Ue.dN)(i)}))}getCheckboxProperties(){const{[Fm]:e}=this[tg];return Object.keys(e)[Lm]((t=>{const i=e[t];return i&&(0,Ue.Mv)(i)}))}[Mm](e){const t=Xe.VN[e];return{key:e,[hg]:i=>this[$m](e,t,i),action:()=>{this[sg]({[Nm]:e})}}}[Pm](e,t){const i=this[tg][Fm][e];if(!i)return;const o=i.name;return{key:`${e} ${t}`,[hg]:e=>this[$m](t,o,e),action:()=>{this[sg]({[Nm]:t,[Rm]:e})}}}[Qm](){const{[og]:e}=this[tg],t=e[eg](),i=null==t?void 0:t.getType();if(!i)throw new Error(Tm);return i}}yg.displayName="CollectionGroupAggregation";var wg=i(45697),Sg=i.n(wg),bg=i(55010);const kg=i(85).LY1,Cg=i(85).BQ6,Tg=i(85).RvT,xg=i(85).HNI,Ig=i(85).Omf,Pg=i(85).xad,Dg=i(85).Gnd,Mg=i(85).L_E;function Zg(e){const{[Mg]:t,parentContainer:i}=e,o=i?i[Dg].store:t[Dg].store;o.state.containerMap.has(t)||o.state.containerMap.set(t,new Set),o.emit()}function Bg(e){const{[Mg]:t,parentContainer:i}=e,o=i?i[Dg].store:t[Dg].store;o.state.containerMap.delete(t),o.emit()}function Rg(e){const{[Pg]:t,[Mg]:i}=e,o=function(e){for(;;){const t=Og(e);if(!t)return e;e=t}}(i),{store:s}=o[Dg],{containerMap:r}=s.state,n=r.get(i);n?n.add(t):r.set(i,new Set([t])),s.emit()}function Eg(e){const{[Pg]:t,[Mg]:i}=e,{store:o}=i[Dg],{containerMap:s}=o.state,r=s.get(i);r&&r.delete(t),o.emit()}function Vg(e){const{environment:t,[Mg]:i}=e,{device:o}=t,{store:s}=i[Dg],{containerMap:r}=s.state,n=Array.from(r.keys()).sort(((e,t)=>{if(e[Pg]&&t[Pg])return(0,bg.Z)(e[Pg],t[Pg]);throw new Error("Element not found")})),l=new Map;for(const a of n){const{[Pg]:e,scrollableAncestor:t}=a,i=r.get(a);if(!e||!t||!i)continue;const s=_g(a).reduce(((e,t)=>e+(l.get(t)||0)),0),n=t[Ig](),d=e[Ig](),h=n.height,c=Math.floor(n.top-d.top),u=Math.floor(n.top+h-d.top),p=Math.floor(d.height)+(a.props.isFullScreen&&!o.isSafari?fe.Z.state:0),m=Array.from(i.values()).sort(((e,t)=>{if(e[Pg]&&t[Pg])return(0,bg.Z)(e[Pg],t[Pg]);throw new Error("Element not found")}));let g=s,v=0;for(const o of m){if(!o[Pg])continue;const e=o[Pg][Ig](),t=g+e.height;o.props.position===We.Top&&(v+=e.height);const i=Ag(c,p,t,s),r=Lg(u,p,t,v);if(o.props.position===We.Top){const e=0!==i,t=o.props[xg]?o.props[xg](e):void 0;e?(o[Pg][Cg][Tg]=`translate3d(0, ${i}px, 0)`,o[Pg][Cg].bottom=""):(o[Pg][Cg][Tg]="",o[Pg][Cg].bottom=""),t&&Fg(o[Pg],t)}else{const e=0!==r,t=o.props[xg]?o.props[xg](e):void 0;if(e?(o[Pg][Cg][Tg]=`translate3d(0, ${r}px, 0)`,o[Pg][Cg].top=""):(o[Pg][Cg][Tg]="",o[Pg][Cg].top=""),t)for(const i in t)o[Pg][Cg][i]=t[i]||""}g=t}l.set(a,g)}}function Ag(e,t,i,o){return e<-o||e>t?0:e>=t-i-1?t-i+o-1:e+o}function Lg(e,t,i,o){return e-o<0||e>t?0:e<i?i-t:e-t}function _g(e){const t=[];for(;;){const i=Og(e);if(!i)break;e=i,t.push(e)}return t}function Og(e){if(e.context[kg]&&!e.props.ignoreAncestorContainer)return e.context[kg]}function Fg(e,t){for(const i in t)e[Cg][i]=t[i]||""}var Ng=i(95477);const Gg=i(85).HNI,Hg=i(85).LY1,Wg=i(85).xad;class Kg extends p.Z{constructor(){super(...arguments),this[Wg]=void 0}didMount(){const{[Hg]:e}=this.context;if(e)Rg({[Wg]:this,container:e});else if("local"===Ng.default.env)throw new Error("Sticky element had no container.");const t=u.findDOMNode(this);if(t){this[Wg]=t;const e=this.props[Gg]?this.props[Gg](!1):void 0;e&&Fg(t,e)}}willUnmount(){const{[Hg]:e}=this.context;if(e)Eg({[Wg]:this,container:e});else if("local"===Ng.default.env)throw new Error("Sticky element had no container.");this[Wg]=void 0}renderComponent(){if(this.props.children)return c.Children.only(this.props.children)}}Kg.displayName="ComputedStickyElement",Kg.contextTypes={[Hg]:Sg().any,...p.w};const zg=Kg,Ug=i(85).SjN,$g=i(85).EB9,Qg=i(85).nx5,qg=i(85).D7I,Xg=i(85).dLQ,Yg=i(85).k9$,jg=i(85).Uk6,Jg=i(85).bSA,ev=i(85).sy7,tv=i(85).gGi,iv=i(85).Lv6,ov=i(85).zrY,sv=i(85).Scd,rv=i(85).XCs,nv=i(85).$bT,lv=i(85).cx2,av=i(85).BQ6,dv=i(85).Isv,hv=i(85).mSd,cv=i(85).jPE,uv=i(85).YDv,pv=i(85).fBv,mv=i(85).jkI,gv=i(85).H1U,vv=i(85).EMU,fv=i(85).sM5,yv=i(85).Ylz,wv=i(85).rQ1,Sv=i(85).I8n,bv=i(85).pkR,kv=i(85).GzN,Cv=i(85).uzK,Tv=i(85).zaB,xv=i(85).T4J,Iv=i(85).Gnd,Pv=i(85).Wp_,Dv=i(85).i7F,Mv=i(85).gIX,Zv=i(85).Xte,Bv=i(85).X_m,Rv=i(85).ZG6,Ev=i(85).sfk,Vv=i(85).eki,Av=i(85).Ub6,Lv=i(85).J2Z,_v=i(85).jQT,Ov=i(85).oWD,Fv=i(85).ue3,Nv=i(85).cJo,Gv=i(85).LCr,Hv=i(85).q$s,Wv=i(85).ixe,Kv=i(85).sP9,zv=i(85).nxU,Uv=i(85).Drs,$v=i(85).JJj,Qv=i(85).piL,qv=i(85).QmD,Xv=i(85).wgE,Yv=i(85).vTv,jv=i(85).BpM,Jv=i(85).KNN,ef=i(85).MAy,tf=i(85).RH8,of=i(85).Y0b,sf=i(85).P0R,rf=i(85).$KA,nf=i(85).P24,lf=i(85).Kiu,af=i(85).I2,df=i(85).xd5,hf=i(85).ToB,cf=i(85).wfR,uf=i(85).v8Q;class pf extends p.Z{constructor(){super(...arguments),this.storeTypes={[uf]:v.default[cf](!1)},this[hf]=e=>{const{[df]:t,[af]:i,format:o,[lf]:s,[nf]:r,[rf]:n}=this[sf];return a()(ec,{parent:e,[df]:t,[af]:i,format:o,[lf]:s,[nf]:r,groupsLimitStore:r[of],[rf]:n})},this[tf]=()=>{const{[df]:e,[nf]:t,[ef]:i,onGroupHeaderAddItem:o}=this[sf],s=t[jv][Jv](e);s&&Ke[Yv](this[Xv])&&(t[Qv][qv]&&L.updateSearchQuery({[Qv]:"",[nf]:t,[ef]:i}),z[$v]({[Uv]:"CollectionGroupHeader.handleAddItemClick",[Xv]:this[Xv],[zv]:i=>{const{coercionSucceeded:r,newStore:n}=E.createBlockInGroup({[Xv]:this[Xv],[nf]:t,[Kv]:[e],results:s[Wv]?s[Wv][qv]:[],insertAtIndex:0,coerce:!0,[Hv]:!0,[Gv]:i,from:"group_header"});o(n,r,this[sf]),D[Nv](this[Xv],{from:"group_add_item_top",type:"page",new_page_id:n.id,...(0,J.getCollectionAnalyticsContext)(t)})}}))},this[Fv]=e=>{const t=this[sf][nf][Ov]();t&&(E[Fv]({...e,[Xv]:this[Xv],[Ov]:t,...this[sf]}),D[_v](this[Xv],{view_type:this[Lv](),action:"rename_group"}))},this[Av]=()=>{const{[df]:e,[nf]:t}=this[sf],i=t[jv][Jv](e);if(!i)return;W.clear(this[Xv]);const o=!i[Vv][qv];if(E.setGroupToggleState({[Xv]:this[Xv],[df]:e,[Vv]:i[Vv],newValue:o,[nf]:t}),!o){const e=u.findDOMNode(this),i=null==e?void 0:e[Ev];i&&m.default[Rv]((()=>{(0,de.Oc)({el:i,windowHeight:this[Xv][Zv][qv][Bv],minEdgeDist:50}),t[Mv].emit()}))}},this[Dv]=()=>{this[Iv][uf][Pv](!0)},this[xv]=()=>{this[Iv][uf][Pv](!1)},this.handleDrop=e=>{const{droppedStores:t,[Tv]:i}=e,{[nf]:o,[df]:s}=this[sf],r=u.findDOMNode(this);r&&r instanceof Element&&z[$v]({[Uv]:"CollectionGroupHeader.handleDrop",[Xv]:this[Xv],[zv]:e=>E.handleCollapsedGroupDrop({[Xv]:this[Xv],[nf]:o,[Kv]:[s],droppedStores:t,[Tv]:i,[Gv]:e})})}}willMount(e){super.willMount(e);const t=e[nf][Cv]();t&&(this[kv]=new Ee.G(this[Xv],{table:C.iU,id:t.id}))}renderComponent(){const{[bv]:e,getComputedStickyStyle:t,[ef]:i,[Sv]:o,preventToggleBackground:s,[df]:r,[nf]:n}=this[sf],l=(0,Ge.qW)({device:this[Xv].device,[ef]:i,[Sv]:o}),d=n[jv][Jv](r);if(!d)return;const h=d[Vv][qv],c=n[wv][qv],u=n[yv](),p=a()("div",{[av]:{[fv]:vv,[gv]:mv,[pv]:this[sf].stickyLeft?"sticky":void 0,left:this[sf][uv]+this.getToggleButtonWidth()+2}},void 0,this.renderValue(),this[cv](),!e&&c[hv]&&this[dv](),u&&this.renderAddButton());return a()(zg,{[pv]:We.Top,getComputedStyle:t},void 0,a()("div",{[av]:this[lv](),onMouseMove:this[Dv],onMouseLeave:this[xv]},void 0,a()("div",{[av]:this.getStickyWrapStyle(h)},void 0,l?a()("div",{[av]:{[fv]:vv,[nv]:"row-reverse",[rv]:2,...this[sf].stickyLeft&&{[pv]:"sticky",left:this[sf][uv]}}},void 0,a()("div",{[av]:{[fv]:vv,[gv]:mv,[sv]:s?this.theme[ov]:void 0,[Bv]:this.getHeight()}},void 0,this[iv](d[Vv]))):this[iv](d[Vv]),h?p:a()(rl.Z,{store:this[kv],canDropOnto:!e,onSelectableDrop:this.handleDrop,dropzoneShouldNeverUseOrigin:!0,[ev]:!0,[Jg]:"board_hidden_group",shouldShowDropZone:!0,[Kv]:[r],[av]:{[fv]:vv,[gv]:mv,[Bv]:tv}},void 0,p)),this[sf].children))}[iv](e){const t=e[qv];return a()(Ql.Z,{isSidebar:!1,open:t,fill:!0,onClick:this[Av],onMouseDown:re.$0,[av]:{flexShrink:0,...this[sf].stickyLeft&&{[pv]:"sticky",left:this[sf][uv]}}})}renderValue(){const{[df]:e,[lf]:t,[bv]:i,[af]:o,groupBy:s,[nf]:r}=this[sf],n=r[wv][qv];return a()(tc.Z,{groupBy:s,[df]:e,[af]:o,[lf]:t,[bv]:i||!n[jg]||n[Yg],isHiddenGroup:!1,onChange:this[Fv],[av]:{maxWidth:400,lineHeight:"24px"},uncategorizedIconStyle:{marginLeft:2},[nf]:r})}[cv](){const{[bv]:e,format:t,[lf]:i,[nf]:o,[df]:s,groupAggregationKey:r}=this[sf],n=o[wv][qv];return a()(yg,{[df]:s,[bv]:e||!n[hv],groupAggregationKey:r,format:t,[lf]:i,[nf]:o})}[dv](){const{device:e}=this[Xv];return a()(tt.ZP,{popupType:e[Xg]?tt.Z4.SlideUp:tt.Z4.Popup,renderOrigin:e=>c[qg](pn.Z,n()({icon:S.Z.dots},e)),onClick:re.Wi,render:this[hf]})}renderAddButton(){return a()(at.Z,{renderTooltip:()=>a()(P.FormattedMessage,{[Qg]:"Create new",id:"database.collectionGroupHeader.actions.addNewPage.tooltip"}),render:e=>c[qg](pn.Z,n()({icon:S.Z.plus,onClick:this[tf]},e))})}[Lv](){const{[nf]:e}=this[sf],t=e.getViewType();if(!t)throw new Error($g);return t}[lv](){var e;const t=(null===(e=this[sf][nf][Ug][qv])||void 0===e?void 0:e[sv])||void 0,i=this[sf].isInPeekRenderer?this.theme[ov]:this.theme.contentBackground;return{[pv]:"relative",zIndex:I.collectionGroupHeader,width:tv,[sv]:void 0===t?i:t,fontSize:14,...this[sf][av]}}getStickyWrapStyle(e){const{[ef]:t,[Sv]:i,[uv]:o}=this[sf],{paddingTop:s,toggleClosedMarginBottom:r}=this[sf];return{[fv]:vv,[gv]:mv,[Bv]:this.getHeight(),paddingTop:s,...this[sf].stickyLeft&&{[pv]:"sticky",left:t||i?o:0},...!e&&{marginBottom:r}}}getHeight(){return this[sf][Bv]||33}getToggleButtonWidth(){return(0,Ql.q)({isSidebar:!1,[Xg]:this[Xv].device[Xg]})}}pf.displayName="CollectionGroupHeader";const mf=pf,gf=i(85).P0z,vf=i(85).P24;function ff(e){const{[vf]:t,groupsPointer:i}=e,o=t[gf].state,s="load_general"===t.loadingDetails.state.type||"load_more_blocks"===t.loadingDetails.state.type&&h().isEqual(t.loadingDetails.state.group,i);return o&&s&&yf()}function yf(){return"on"===ke.default.getEligibleGroup({experimentId:"collections_loading_state",defaultGroup:"control"})}var wf=i(54087),Sf=i.n(wf);class bf extends v.default{getInitialState(){return{containerMap:new Map}}}const kf=bf,Cf=i(85).gIX,Tf=i(85).LY1,xf=i(85).uC$,If=i(85).Ajg,Pf=i(85).L_E,Df=i(85).wgE,Mf=i(85).lTn,Zf=i(85).qQV,Bf=i(85).icV,Rf=i(85).Jiy,Ef=i(85).xad;class Vf extends p.Z{constructor(){super(...arguments),this[Ef]=void 0,this[Rf]=void 0,this[Bf]=void 0,this.callbackQueued=!1,this[Zf]=new ResizeObserver((()=>{this[Mf]()})),this.storeTypes={store:kf},this[Mf]=()=>{this.callbackQueued||(this.callbackQueued=!0,Sf()((()=>{this.callbackQueued=!1,this.mutateDOM((()=>{o[Mf]({[Df]:this[Df],[Pf]:this})}))})))},this[If]=h().throttle(this[Mf],100)}didMount(){const e=o[xf](this);Zg({[Pf]:this,parentContainer:e}),(0,de.Gf)(this[Df])&&this.attachEvents()}willUnmount(){const e=o[xf](this);Bg({[Pf]:this,parentContainer:e}),(0,de.Gf)(this[Df])&&this.removeEvents(),this[Ef]=void 0,this[Rf]=void 0}getChildContext(){return{...this.context,[Tf]:this}}renderComponent(){if(this.props.children)return c.Children.only(this.props.children)}attachEvents(){const e=o[xf](this),t=u.findDOMNode(this);if(t){this[Ef]=t;const i=(0,de.VW)(t);i&&(this[Rf]=i,e||((0,oe.addPassiveEventListener)(i,"scroll",this[Mf]),(0,oe.addPassiveEventListener)(window,"resize",this[If]),this[Zf].observe(this[Ef])));const o=(0,de.Ez)(this[Ef]);o&&(this[Bf]=o,this[Zf].observe(this[Bf]))}this.props[Cf]&&this.props[Cf].addListener(this[Mf])}removeEvents(){this[Rf]&&((0,oe.removePassiveEventListener)(this[Rf],"scroll",this[Mf]),(0,oe.removePassiveEventListener)(window,"resize",this[If]),this[Ef]&&this[Zf].unobserve(this[Ef])),this[Bf]&&this[Zf].unobserve(this[Bf]),this.props[Cf]&&this.props[Cf].removeListener(this[Mf])}}Vf.displayName="ComputedStickyContainer",Vf.contextTypes={[Tf]:Sg().any,...p.w},Vf.childContextTypes={[Tf]:Sg().any,...p.w};const Af=Vf,Lf=i(85).D7I,_f=i(85).xOW,Of=i(85).gIX,Ff=i(85).I2,Nf=i(85).eki,Gf=i(85).$Fm,Hf=i(85).MAy,Wf=i(85).$KA,Kf=i(85).P24,zf=i(85).xd5;class Uf extends p.Z{willMount(e){super.willMount(e);const{[zf]:t,[Kf]:i}=this.props;E.initializeGroupToggleState({environment:this.environment,[Kf]:i,[zf]:t})}renderComponent(){const{renderGroup:e,[zf]:t,groupsDisplayState:i,disabled:o,[Wf]:s,groupAggregationKey:r,format:n,schema:l,[Kf]:d,onGroupHeaderAddItem:h,renderHeader:u,getGroupStyle:p,stickyLeft:m,ignoreAncestorStickyContainer:g,paddingLeft:v,[Hf]:f,index:y,isRootChild:w,[Gf]:S,groupBy:b,isLast:k}=this.props,C=d.groupsStore.getGroupState(t);if(!C)return;const{[Nf]:T}=C,x=T.state,I={[zf]:t,[Ff]:i[Ff],disabled:o,[Wf]:s,groupAggregationKey:r,format:n,schema:l,[Kf]:d,[Hf]:f,[Gf]:S,onGroupHeaderAddItem:h,stickyLeft:m,index:y,paddingLeft:v,isRootChild:w,groupBy:b};return a()(Af,{ignoreAncestorContainer:g,[Of]:d[Of],[Hf]:f},void 0,a()("div",{"data-testid":"collection-group",style:{width:"100%",position:_f,...p?p({[zf]:t,...i,index:y,isLast:k,[Nf]:T}):void 0}},void 0,u?u(I):c[Lf](mf,I),x&&e(t)))}}Uf.displayName="CollectionGroup";const $f=Uf,Qf=i(85).ChN,qf=i(85).wuN,Xf=i(85).OtN,Yf=i(85).nx5,jf=(i(85)._bH,i(85).OQK),Jf=i(85).nLZ,ey=i(85).Au,ty=i(85).Uww,iy=i(85).xd5,oy=i(85).EIp,sy=i(85).wgE,ry=i(85).Wp_,ny=i(85).P0R,ly=i(85).P24,ay=i(85).b8T;class dy extends p.Z{constructor(){super(...arguments),this[ay]=()=>{const{[ly]:e,groupsLimitStore:t}=this[ny];t[ry](t.state+Ge.kW),e.loadingDetails[ry]({type:"load_more_groups"}),R.trackLoadMoreGroups(this[sy])},this.boardColorStore=this[oy]((()=>{const{schema:e,[ly]:t}=this[ny];return(0,Ge.II)({[sy]:this[sy],[iy]:void 0,schema:e,format:t[ty].state,[ly]:t,[ey]:this[ey]})}),!0)}renderComponent(){const{visibleGroups:e,total:t,hiddenGroups:i,type:o}=this[ny],s=Math.min(Ge.kW,t-i.length-e.length);return"default"===o?a()(rt.Z,{onClick:this[ay],onMouseDown:re.$0,style:{height:30,[Jf]:4,marginBottom:4,...this[ny].style},icon:e=>S.Z.dots(e)},void 0,a()(P.FormattedMessage,{id:"database.groups.loadMoreButtonDefault.text",[Yf]:jf,values:{loadMoreAmount:s}})):a()(rt.Z,{onClick:this[ay],onMouseDown:re.$0,style:{background:null===(r=this.boardColorStore.state)||void 0===r?void 0:r[Xf],color:this[ey][qf],[Qf]:x.Z[Qf].medium,paddingLeft:8,paddingRight:8,height:33,marginRight:10,borderRadius:5,width:90,...this[ny].style}},void 0,a()("span",{style:{flexGrow:1}},void 0,a()(P.FormattedMessage,{id:"database.groups.loadMoreButton.text",[Yf]:"{loadMoreAmount} more",values:{loadMoreAmount:s}})),S.Z.dots({width:14,fill:this[ey][qf],marginLeft:4,[Jf]:1}));var r}}dy.displayName="CollectionGroupsLoadMoreButton";const hy=dy,cy=i(85).nx5,uy=i(85).ORX,py=i(85).b8T;class my extends p.Z{constructor(){super(...arguments),this[py]=()=>{const{[uy]:e}=this.props;e.setState(!e.state)}}renderComponent(){const{hiddenGroups:e,[uy]:t}=this.props,i=t.state;return a()(rt.Z,{onClick:this[py],onMouseDown:re.$0,style:{height:30,marginBottom:4,...this.props.style},icon:e=>S.Z.chevronDown({...e,...i&&{transform:"rotate(180deg)"}}),isLightGray:!0},void 0,a()(P.FormattedMessage,{id:"collectionHiddenGroupsButton.hiddenGroupsButton.text",[cy]:"{numberOfHiddenGroups, plural, one {{numberOfHiddenGroups} hidden group} other {{numberOfHiddenGroups} hidden groups}}",values:{numberOfHiddenGroups:e.length}}))}}my.displayName="CollectionHiddenGroupsButton";const gy=my;var vy=i(34232);class fy extends v.default{getInitialState(){return{}}}const yy=fy,wy=i(85).P24,Sy=i(85).kId,by=i(85).$pZ,ky=i(85).Gm0,Cy=i(85).PgK,Ty=i(85).jHz,xy=i(85).P0R;class Iy extends Le.Z{renderComponent(){return a()(on,{store:this[xy].store,disabled:this[xy].disabled,isFirstItem:this[xy].isFirstItem,isLastItem:this[xy].isLastItem,hideContent:this[xy].hideContent,[Ty]:this[xy][Ty],isQuickFind:this[xy].isQuickFind,style:this[xy].style,disableCommentMenu:this[xy].disableCommentMenu,disableHoverMenu:this[xy].disableHoverMenu,disableDrag:this[xy].disableDrag,[Cy]:this[xy][Cy],[ky]:this[xy][ky],format:this[xy].format,schema:this[xy].schema,coverFormat:this[xy].coverFormat,coverAspectFormat:this[xy].coverAspectFormat,coverSizeFormat:this[xy].coverSizeFormat,coverHeight:this[xy].coverHeight,coverWidth:this[xy].coverWidth,shouldShowTitle:this[xy].shouldShowTitle,colorStyle:void 0,onTextEnter:this[xy].onTextEnter,onTextEsc:this[xy].onTextEsc,onShiftEnter:this[xy].onShiftEnter,[by]:this[xy][by],isLast:this[xy].isLast,[Sy]:this[xy][Sy],[wy]:this[xy][wy]})}}const Py=Iy;var Dy=i(36596);function My(e){window.__c={n:"GalleryItemShimmer"};const t=e.minHeight||fS,i=(0,Yn.yK)((e=>({card:{display:"flex",justifyContent:"center",alignItems:"flex-start",alignSelf:"stretch",borderRadius:4,background:`${e.lightDividerColor}`,minHeight:t}})),[t]);return a()(Dy.Z,{style:i.card})}function Zy(e){window.__c={n:"GalleryShimmer"};if(!(0,vy.Z)(!0,0,100))return null;const{hasGroups:t,hasPartialResults:i}=e,o=!t&&!i?ze.Z.card.desktop.medium.height:void 0;return a()(My,{minHeight:o})}const By=i(85).Ya2,Ry=i(85).nx5,Ey=i(85).a3v,Vy=i(85).pF2,Ay=i(85).XNW,Ly=i(85).dMt,_y=i(85).VR,Oy=i(85).UPJ,Fy=i(85).jkI,Ny=i(85).H1U,Gy=i(85).EMU,Hy=i(85).sM5,Wy=i(85).$Fm,Ky=i(85).vK9,zy=i(85).qdS,Uy=i(85).XCs,$y=i(85).YDv,Qy=i(85).ORE,qy=i(85).uRL,Xy=i(85).GmX,Yy=i(85).IY7,jy=i(85).Xte,Jy=i(85).EIp,ew=i(85).qU4,tw=i(85).jDA,iw=i(85).dLQ,ow=i(85).aV8,sw=i(85).cJo,rw=i(85).f7G,nw=i(85).LIR,lw=i(85).q$s,aw=i(85).ixe,dw=i(85).tDk,hw=i(85).vTv,cw=i(85).RH8,uw=i(85).LCr,pw=i(85).nxU,mw=i(85).Drs,gw=i(85).JJj,vw=i(85).AAM,fw=i(85).oWD,yw=i(85).p2z,ww=i(85).AQx,Sw=i(85).M34,bw=i(85).wgE,kw=i(85).xYh,Cw=i(85).m3I,Tw=i(85).Ajg,xw=i(85).dgJ,Iw=i(85).UMi,Pw=i(85).kXs,Dw=i(85).RGT,Mw=i(85).tBn,Zw=i(85).Lbv,Bw=i(85).g7N,Rw=i(85).nLZ,Ew=i(85).Au,Vw=i(85).xej,Aw=i(85).Jkr,Lw=i(85).BQ6,_w=i(85).yT5,Ow=i(85).bSA,Fw=i(85).GCx,Nw=i(85).y79,Gw=i(85).SRH,Hw=i(85).woI,Ww=i(85).Vml,Kw=i(85).Maw,zw=i(85).RX6,Uw=i(85).Mm1,$w=i(85).bQB,Qw=i(85).c1l,qw=i(85).k9$,Xw=i(85).rQ1,Yw=i(85).sP9,jw=i(85).TtP,Jw=i(85).gNE,eS=i(85).BpM,tS=i(85).KNN,iS=i(85)._1A,oS=i(85).QmD,sS=i(85).Gnd,rS=i(85).P0R,nS=i(85).MAy,lS=i(85).$pZ,aS=i(85).Kiu,dS=i(85).P24,hS=i(85).pkR,cS=i(85).urI,uS=i(85).XtO,pS=i(85).D7I,mS=i(85).XDJ,gS=i(85).odo,vS=i(85).R5d,fS=40;class yS extends p.Z{constructor(){super(...arguments),this.storeTypes={collectionGalleryViewStore:yy},this[vS]=null,this[gS]=e=>c[pS](mf,n()({},e,{height:48,getComputedStickyStyle:this[mS]})),this.renderGroup=e=>{const{[uS]:t,[cS]:i,[hS]:o,[dS]:s,[aS]:r,[lS]:n,[nS]:l}=this[rS],{collectionGalleryViewStore:d}=this[sS],h=this[iS][oS],u=this.isReady[oS],p=this.getCoverFormat(),m=e?[e]:[],g=s[eS][tS](m);if(!g)return;const v=g[Jw][oS],f=void 0!==e,y=void 0!==v&&(null==v?void 0:v.blockIds[jw])>0,w=ff({[dS]:s,[Yw]:m}),S=ie.shouldRenderLoadMoreButton({[dS]:s,reducerResult:v,[nS]:l}),b=s[Xw][oS],k=b[qw],C=t.canEdit()&&("collectionTypedView"===s[Qw]||b[$w]),T=u&&!o&&C&&!k,x=!o&&C&&!k;return a()("div",{[Lw]:{[Uw]:e?16:void 0}},void 0,a()("div",{[Lw]:this.getGroupWrapStyle()},void 0,a()(dd,{[dS]:s,[Yw]:m,[cS]:i,canDrag:x,onSelectableEnter:this[zw],resultProps:{[cS]:i,[aS]:r,onTextEnter:this[Kw],onTextEsc:this[Kw],onShiftEnter:this[zw],[hS]:o,coverFormat:p,coverAspectFormat:this[Ww](),coverSizeFormat:this[Hw](),coverHeight:d[oS].coverHeight,coverWidth:d[oS].coverWidth,shouldShowTitle:ai.K8(this[rS][cS],Gw),[lS]:n,[dS]:s},resultComponent:Py,canDrop:!0,[hS]:o,shouldShowHoverMenu:!1,[Fw]:h?ld[Nw]:ld.Horizontal,belowDropZoneMargin:6,emptyDroppableSize:4,dropzoneGap:10,[Ow]:Gw,emptyDroppableStyle:this.getEmptyDroppableStyle(),loadContentCover:p&&"page_content"===p.type}),w&&a()(Zy,{hasGroups:f,hasPartialResults:y}),T&&this[_w](m)),S&&c[pS](c[Mw],null,a()("div",{[Lw]:{[Aw]:"100%",borderTop:e?void 0:`1px solid ${this[Ew][Vw]}`,[Rw]:4,[Bw]:4}}),a()(Qn,{[Yw]:m,[uS]:t,[dS]:s,[cS]:i,[nS]:l,[Zw]:!1})))},this.handleResize=()=>{const{collectionGalleryViewStore:e}=this[sS],t=this[Dw](),i=this[Pw]();e[oS].coverHeight!==t&&this[Iw](t),e[oS].coverWidth!==i&&this.setCardCoverWidth(i)},this[xw]=(0,d.debounce)(this.handleResize,1e3),this[Tw]=(0,d.throttle)(this.handleResize,100),this[Cw]=e=>{var t;const{[dS]:i,[nS]:o}=this[rS],s=i[kw][oS],r=null===(t=this.getDefaultResultStore())||void 0===t?void 0:t[oS];e<ye.Z.incrementScrollOffset&&r&&!s&&null!=r&&r.hasMore&&E.incrementBlockLimit({[dS]:i,[bw]:this[bw],incrementLimitArgs:{[nS]:o,currentResultCount:r.blockIds[jw],[Yw]:[],[Zw]:!1}})},this[zw]=e=>{const t=e.blocks;if(t[jw]>0){const e=t[0],i=e[Sw]();W.edit({[bw]:this[bw],[uS]:e}),K[ww]({[uS]:i}),L[yw]({[uS]:e})}},this[Kw]=e=>{const{[dS]:t}=this[rS],i=t[fw](),o=e[vw]();if(!o)return;ti.getText(o.getValue())?W.select({[bw]:this[bw],[uS]:e}):i&&z[gw]({[mw]:"CollectionGalleryView.handleItemTextEsc",[bw]:this[bw],[pw]:t=>{E.remove({[uS]:e,[uw]:t})}})},this[cw]=e=>{if(!Ke[hw](this[bw]))return;const{[dS]:t}=this[rS],i=t[eS][tS](e);i&&z[gw]({[mw]:"CollectionGalleryView.handleAddItemClick",[bw]:this[bw],[pw]:o=>{const{[dw]:s}=ge.default[oS],{newStore:r}=E.createBlockInGroup({[bw]:this[bw],[dS]:t,[Yw]:e,results:i[aw][oS],insertAtIndex:i[aw][oS][jw],coerce:!0,[lw]:!0,[uw]:o,from:Gw}),n=ie.getPeekModeHref({[uS]:r,[dw]:s,[dS]:t})??(0,se.ZP)({[uS]:r,[nw]:f.tY.Create});this[rw](n),O.Xd({[dS]:t,[aw]:i[aw]}),D[sw](this[bw],{from:"list_view_add_item_bottom",type:"page",new_page_id:r.id,...(0,J.getCollectionAnalyticsContext)(t)})}})},this[ow]=e=>{if(this[bw].device[iw])N[tw]({[bw]:this[bw],[uS]:e,[nw]:f.tY.Create});else{const{[dS]:t}=this[rS];N.peekBlock({[bw]:this[bw],[uS]:e,peekMode:ie.getPeekMode(t[ew]()),[aw]:void 0,[dS]:t,[nw]:f.tY.Create})}},this[iS]=this[Jy]((()=>this[bw][jy][oS][Aw]<=480)),this.isReady=this[Jy]((()=>{const{[dS]:e}=this[rS];return e[eS].anyGroupHasResults()})),this.getGroupStyle=e=>0===e.index?{}:{borderTop:`1px solid ${this[Ew][Vw]}`},this[mS]=e=>({[Yy]:e?`0 -1px 0 ${this[Ew][Xy]}`:void 0})}[rw](e){this.context[qy]?this.context[qy](e):N[rw]({[bw]:this[bw],url:e})}didUpdate(e){(e[cS]||{})[Qy]!==(this[rS][cS]||{})[Qy]&&(this[Iw](),this.setCardCoverWidth())}didMount(){this.setCardCoverWidth(),this[Iw](),(0,oe.addPassiveEventListener)(window,"resize",this[Tw]),this[bw].device[iw]&&(0,oe.addPassiveEventListener)(window,"orientationchange",this[xw])}willUnmount(){(0,oe.removePassiveEventListener)(window,"resize",this[Tw]),this[bw].device[iw]&&(0,oe.removePassiveEventListener)(window,"orientationchange",this[xw])}renderComponent(){const{[uS]:e,[cS]:t,[Uw]:i,[$y]:o,[Uy]:s,[nS]:r,[dS]:l}=this[rS],d=ie.shouldUseLoadMoreButton(l,r),h=t[zy];return(0,He.Z)((t=>a()("div",{[Lw]:{[Uw]:i,[$y]:o,[Uy]:s,[Ky]:this[rS][Ky]},className:X.galleryView},void 0,c[pS](rl.Z,n()({[uS]:e,shouldShowHalo:!r,canSelect:!r,[Ow]:Gw},t,{ref:e=>this[vS]=e}),h?this.renderGroups(h):this.renderGroup(void 0)),!d&&a()(hd.Z,{onChange:this[Cw]}))))}renderGroups(e){const{[uS]:t,[cS]:i,[dS]:o,[aS]:s,[hS]:r,[nS]:n,[$y]:l,isRootChild:d,[Wy]:h}=this[rS];return a()(Tk,{[uS]:t,id:"gallery_groups",groupBy:e,groupsFormatKey:_e.Uh,groupAggregationKey:_e.dQ,[cS]:i,[aS]:s,[dS]:o,[hS]:r,[nS]:n,renderGroup:this.renderGroup,onGroupHeaderAddItem:this[ow],renderHeader:this[gS],getGroupStyle:this.getGroupStyle,[$y]:l,isRootChild:d,[Wy]:h})}[_w](e){return a()(Bo.Z,{onClick:()=>this[cw](e),onMouseDown:re.$0,[Lw]:{[Hy]:Gy,[Ny]:Fy,[Oy]:Fy,fontSize:14,borderRadius:3,[Yy]:"dark"===this[Ew].mode?`${this[Ew][_y]} 0px 0px 0px 1px inset`:`${this[Ew][Ly]} 0px 0px 0px 1px inset`,minHeight:fS}},void 0,a()("div",{[Lw]:{[Hy]:Gy,[Ny]:Fy,[Ay]:-6}},void 0,S.Z.plus(this[Vy]()),a()("div",{[Lw]:{color:this[Ew][Ey]}},void 0,a()(P.FormattedMessage,{[Ry]:"New",id:"database.galleryView.addItemButtonTitle"}))))}[Iw](e){const{collectionGalleryViewStore:t}=this[sS];t.setState({...t[oS],coverHeight:e||this[Dw]()})}setCardCoverWidth(e){const{collectionGalleryViewStore:t}=this[sS];t.setState({...t[oS],coverWidth:e||this[By]()})}getCoverFormat(){const{[cS]:e}=this[rS];return e?e.gallery_cover:void 0}[Ww](){const{[cS]:e}=this[rS];return e?e.gallery_cover_aspect:void 0}[Hw](){const{[cS]:e}=this[rS];return e?e[Qy]:void 0}[By](){const{[cS]:e}=this[rS];switch((e||{})[Qy]){case"large":return ze.Z.card.desktop.large[Aw];case"small":return ze.Z.card.desktop.small[Aw];case"medium":default:return ze.Z.card.desktop.medium[Aw]}}[Pw](){if(this[vS]){const e=this[vS].getNode();if(e){const t=e.querySelector(`.${X.collectionItem}`);if(t)return t.offsetWidth}}return this[By]()}[Dw](){return this[Pw]()*(9/16)}getDefaultResultStore(){var e;const{[dS]:t}=this[rS];return null===(e=t[eS][tS]([]))||void 0===e?void 0:e[Jw]}getGroupWrapStyle(){const e=this[rS][cS][zy],t=this[iS][oS];return{[Hy]:"grid",position:"relative",gridTemplateColumns:`repeat(auto-fill, minmax(${t?"100%":`${this[By]()}px`}, 1fr))`,gridRowGap:16,gridColumnGap:16,paddingTop:e?1:16,[Uw]:4}}getEmptyDroppableStyle(){return this[iS][oS]?{position:"absolute",top:6,left:0,right:0,height:4}:{position:"absolute",top:16,bottom:4,[Aw]:4,height:"none"}}[Vy](){return{[Aw]:14,height:14,[Ay]:-1,marginRight:6,fill:this[Ew][Ey]}}}yS.displayName="CollectionGalleryView",yS.contextTypes={...$.wK,...p.w};const wS=yS,SS=i(85).RJH,bS=i(85).jkI,kS=i(85).Mm1,CS=i(85).H1U,TS=i(85).$bT,xS=i(85).L_E;function IS(){window.__c={n:"GalleryGroupShimmer"};const e=(0,qn.O7)(),t=(0,Xn.VK)((()=>e.WindowSizeStore.state.width<=480),[e]),i=ze.Z.card.desktop.medium.width,o=(0,Yn.yK)((e=>({[xS]:{display:"flex",[TS]:"column",[CS]:"flexStart",alignSelf:"stretch",[kS]:12,height:i},groupContainer:{display:"flex",height:46,[CS]:bS,alignSelf:"stretch"},itemsContainer:{display:"grid",position:"relative",gridTemplateColumns:`repeat(auto-fill, minmax(${t?"100%":`${i}px`}, 1fr))`,gap:16,paddingTop:1,[kS]:4,width:"100%",height:"100%"},[SS]:{display:"flex",width:22,height:16,[TS]:"column",justifyContent:bS,[CS]:bS,gap:10},icon:{width:8,height:8,flexShrink:0,fill:e.icon.tertiary},groupShimmer:{width:120,height:10,marginLeft:8,borderRadius:12,backgroundColor:e.lightDividerColor}})),[i,t]);return a()("div",{style:o[xS]},void 0,a()("div",{style:o.groupContainer},void 0,a()("div",{style:o[SS]},void 0,S.Z.collectionGroupAccordion(o.icon)),a()(Dy.Z,{style:o.groupShimmer})),a()("div",{style:o.itemsContainer},void 0,a()(My,{})))}const PS=i(85).$Vg,DS=i(85).$bT;function MS(e){const{isFullScreen:t}=e,i=t?2:1,o=h().times(i,(e=>a()(IS,{},e)));return a()("div",{style:{display:"flex",[DS]:"column",alignItems:PS}},void 0,o)}const ZS=i(85).SEy,BS=i(85).OtN,RS=i(85).MZ8;function ES(){window.__c={n:"ListItemShimmer"};const e=(0,Yn.yK)((e=>({[RS]:{display:"flex",height:30,alignItems:"center",gap:1,alignSelf:"stretch"},circleShimmer:{width:16,height:16,flexShrink:0,borderRadius:12,[BS]:e[ZS]},rowShimmer:{width:360,height:10,flexShrink:0,borderRadius:12,marginLeft:2,[BS]:e[ZS]},column:{display:"flex",height:34,padding:"7px 0px",alignItems:"center",gap:6,flex:"1 0 0"}})),[]);return a()("div",{style:e[RS]},void 0,a()("div",{style:e.column},void 0,a()(Dy.Z,{style:e.circleShimmer}),a()(Dy.Z,{style:e.rowShimmer})))}const VS=i(85).SEy,AS=i(85).OtN,LS=i(85).NF1,_S=i(85).AIq,OS=i(85).RJH,FS=i(85).jkI,NS=i(85).P4,GS=i(85).$Vg,HS=i(85).H1U,WS=i(85).rps,KS=i(85).$bT,zS=i(85).EMU,US=i(85).L_E;function $S(){window.__c={n:"ListGroupShimmer"};const e=(0,Yn.yK)((e=>({[US]:{display:zS,padding:"8px 0px",[KS]:WS,[HS]:GS,alignSelf:NS},groupContainer:{display:zS,height:36,paddingRight:0,[HS]:FS,alignSelf:NS,gap:8},rowsContainer:{display:zS,[KS]:WS,[HS]:GS,alignSelf:NS},rowContainer:{display:zS,height:30,[HS]:FS,gap:1,alignSelf:NS},[OS]:{display:zS,width:16,height:16,[KS]:WS,justifyContent:FS,[HS]:FS,gap:10},icon:{width:8,height:8,[_S]:0,fill:e.icon.tertiary},groupShimmer:{width:120,height:10,[LS]:12,[AS]:e[VS]},circleShimmer:{width:16,height:16,[_S]:0,[LS]:12,[AS]:e[VS]},rowShimmer:{width:360,height:10,[_S]:0,[LS]:12,marginLeft:2,[AS]:e[VS]}})),[]),t=h().times(3).map((e=>a()(ES,{},e)));return a()("div",{style:e[US]},void 0,a()("div",{style:e.groupContainer},void 0,a()("div",{style:e[OS]},void 0,S.Z.collectionGroupAccordion(e.icon)),a()(Dy.Z,{style:e.groupShimmer})),a()("div",{style:e.rowsContainer},void 0,t))}const QS=i(85).$Vg,qS=i(85).$bT;function XS(e){const{isFullScreen:t}=e,i=t?2:1,o=h().times(i,(e=>a()($S,{},e)));return a()("div",{style:{display:"flex",padding:"8px 4px",[qS]:"column",alignItems:QS,alignSelf:"stretch"}},void 0,o)}const YS=i(85).tBn,jS=i(85).D7I,JS=i(85).BQ6,eb=i(85).xYF,tb=i(85).EOt,ib=i(85).cU_,ob=i(85).SEy,sb=i(85).OtN,rb=i(85).NF1,nb=i(85).AIq,lb=i(85).RJH,ab=i(85).MZ8,db=i(85).$Vg,hb=i(85).rps,cb=i(85).$bT,ub=i(85).P4,pb=i(85).jkI,mb=i(85).H1U,gb=i(85).X_m,vb=i(85).EMU,fb=i(85).sM5,yb=i(85).L_E;function wb(e){window.__c={n:"TableGroupShimmer"};const{isMinimal:t}=e,i=(0,Yn.yK)((e=>({[yb]:{padding:"8px 0px",width:"100%"},groupContainer:{[fb]:vb,[gb]:36,paddingRight:0,[mb]:pb,alignSelf:ub,gap:8},rowsContainer:{[fb]:vb,paddingLeft:16,[cb]:hb,[mb]:db,alignSelf:ub},[ab]:{[fb]:vb,[mb]:db,gap:1,alignSelf:ub,borderBottom:`1px solid ${e.regularDividerColor}`},lastRowContainer:{[fb]:vb,[mb]:db,gap:1,alignSelf:ub},[lb]:{[fb]:vb,width:16,[gb]:16,[cb]:hb,justifyContent:pb,[mb]:pb,gap:10},icon:{width:8,[gb]:8,[nb]:0,fill:e.icon.tertiary},groupShimmer:{width:120,[gb]:10,[rb]:12,[sb]:e[ob]},circleShimmer:{width:16,[gb]:16,[nb]:0,[rb]:12,[sb]:e[ob]},rowShimmer:{width:100,[gb]:10,[nb]:0,[rb]:12,[sb]:e[ob]},[ib]:{width:60,[gb]:10,[nb]:0,[rb]:12,[sb]:e[ob]},rowShimmerLong:{width:200,[gb]:10,[nb]:0,[rb]:12,[sb]:e[ob]},[tb]:{[fb]:vb,width:360,[gb]:34,padding:"7px 8px",[mb]:pb,gap:6},[eb]:{[fb]:vb,width:"100%",[gb]:34,padding:"7px 8px",[mb]:pb,gap:6},[hb]:{[fb]:vb,width:200,[gb]:34,padding:"6px 8px",[mb]:pb,gap:6}})),[]);return a()("div",{[JS]:i[yb]},void 0,a()("div",{[JS]:i.groupContainer},void 0,a()("div",{[JS]:i[lb]},void 0,S.Z.collectionGroupAccordion(i.icon)),a()(Dy.Z,{[JS]:i.groupShimmer})),a()("div",{[JS]:i.rowsContainer},void 0,a()("div",{[JS]:i[ab]},void 0,a()("div",{[JS]:t?i[eb]:i[tb]},void 0,a()(Dy.Z,{[JS]:i.circleShimmer}),a()(Dy.Z,{[JS]:i[ib]})),t?null:c[jS](c[YS],null,a()("div",{[JS]:i[hb]},void 0,a()(Dy.Z,{[JS]:i[ib]})),a()("div",{[JS]:i[hb]},void 0,a()(Dy.Z,{[JS]:i[ib]})),a()("div",{[JS]:i[hb]},void 0,a()(Dy.Z,{[JS]:i[ib]})))),a()("div",{[JS]:i[ab]},void 0,a()("div",{[JS]:t?i[eb]:i[tb]},void 0,a()(Dy.Z,{[JS]:i.circleShimmer}),a()(Dy.Z,{[JS]:i.rowShimmerLong})),t?null:c[jS](c[YS],null,a()("div",{[JS]:i[hb]},void 0,a()(Dy.Z,{[JS]:i.rowShimmer})),a()("div",{[JS]:i[hb]},void 0,a()(Dy.Z,{[JS]:i.rowShimmer})),a()("div",{[JS]:i[hb]},void 0,a()(Dy.Z,{[JS]:i.rowShimmer})))),a()("div",{[JS]:i.lastRowContainer},void 0,a()("div",{[JS]:t?i[eb]:i[tb]},void 0,a()(Dy.Z,{[JS]:i.circleShimmer}),a()(Dy.Z,{[JS]:i.rowShimmerLong})),t?null:c[jS](c[YS],null,a()("div",{[JS]:i[hb]},void 0,a()(Dy.Z,{[JS]:i.rowShimmer})),a()("div",{[JS]:i[hb]},void 0,a()(Dy.Z,{[JS]:i.rowShimmer})),a()("div",{[JS]:i[hb]},void 0,a()(Dy.Z,{[JS]:i.rowShimmer}))))))}const Sb=i(85).$Vg,bb=i(85).$bT;function kb(e){const{isMinimal:t}=e;return a()("div",{style:{display:"flex",paddingTop:8,paddingLeft:4,[bb]:"column",alignItems:Sb,alignSelf:"stretch",width:"100%"}},void 0,a()(wb,{isMinimal:t}))}const Cb=i(85).cU_,Tb=i(85).SEy,xb=i(85).OtN,Ib=i(85).MZ8;function Pb(){window.__c={n:"TimelineTableGroupsShimmer"};const e=(0,Yn.yK)((e=>({rowsContainer:{paddingTop:8},[Ib]:{display:"flex",height:28,alignItems:"center",gap:6,alignSelf:"stretch",flex:"1 0 0"},rowShimmer:{width:"80%",height:10,flexShrink:0,borderRadius:12,marginLeft:12,[xb]:e[Tb]},[Cb]:{width:"50%",height:10,flexShrink:0,borderRadius:12,marginLeft:12,[xb]:e[Tb]}})),[]);return a()("div",{style:e.rowsContainer},void 0,a()("div",{style:e[Ib]},void 0,a()(Dy.Z,{style:e[Cb]})),a()("div",{style:e[Ib]},void 0,a()(Dy.Z,{style:e.rowShimmer})))}const Db=i(85).MAy;function Mb(e){window.__c={n:"GroupsShimmer"};const{viewType:t,[Db]:i}=e;if(!(0,vy.Z)(!0,0,100))return null;switch(t){case"table":return a()(kb,{isMinimal:!1});case"list":return a()(XS,{[Db]:i});case"gallery":return a()(MS,{[Db]:i});case"timeline":return a()(Pb,{});default:return null}}const Zb=i(85).qLW,Bb=i(85).gRm,Rb=i(85).zG9,Eb=i(85).VAS,Vb=i(85).voC,Ab=i(85).ykC,Lb=i(85).uzK,_b=i(85).eiN,Ob=i(85).EIp,Fb=i(85).oWD,Nb=i(85).xAw,Gb=i(85).ud8,Hb=i(85).wgE,Wb=i(85).I2,Kb=i(85).xd5,zb=i(85).n8c,Ub=i(85).BpM,$b=i(85).KNN,Qb=i(85).$Fm,qb=i(85).I8n,Xb=i(85).YDv,Yb=i(85).Kiu,jb=i(85).urI,Jb=i(85).$KA,ek=i(85).tBn,tk=i(85).D7I,ik=i(85).Gnd,ok=i(85).wbq,sk=i(85).TNU,rk=i(85).xOW,nk=i(85).c1l,lk=i(85).Uk6,ak=i(85).mSd,dk=i(85).TtP,hk=i(85).qU4,ck=i(85).rQ1,uk=i(85).Zf2,pk=i(85).Y0b,mk=i(85).QmD,gk=i(85).P0R,vk=i(85).MAy,fk=i(85).Leq,yk=i(85).P24,wk=i(85).pkR,Sk=i(85).ORX,bk=i(85).wfR,kk=i(85).gNE;class Ck extends p.Z{constructor(){super(...arguments),this.storeTypes={[kk]:v.default[bk](void 0),[Sk]:v.default[bk](!1)},this.renderResult=e=>{var t;const{[wk]:i,[yk]:o,[fk]:s,[vk]:r,shouldSurpressShimmer:n}=this[gk],l=o[pk][mk],d=e[uk].slice(0,Ge.ew),h=o[ck][mk],u=!n&&function(e){const{[vf]:t,displayState:i}=e;return t[gf].state&&0===i.visibleGroups.length&&yf()}({[yk]:o,displayState:e}),p=null===(t=o[hk]())||void 0===t?void 0:t.getType(),m=!u&&l<e.total-e[uk][dk],g=!i&&!h.isLocked&&h[ak]&&!u&&(0,_e.Wz)(s,h[lk])&&"collectionTypedView"!==o[nk]&&!(0,Hi.isExternalPropertyId)(s.property);return a()("div",{style:{position:rk}},void 0,this.renderGroups(e[sk]),u&&a()(Mb,{viewType:p,[vk]:r}),m&&this[ok](e),d[dk]>0&&c[tk](c[ek],null,this.renderHiddenGroupsButton(d),this[ik][Sk][mk]&&this.renderGroups(d)),g&&this.renderAddGroupButton())},this.renderGroup=(e,t,i)=>{const{renderGroup:o,[wk]:s,[Jb]:r,groupAggregationKey:n,[jb]:l,[Yb]:d,[yk]:h,[vk]:c,onGroupHeaderAddItem:u,renderHeader:p,getGroupStyle:m,stickyLeft:g,stickyTopHeaderOffset:v,ignoreAncestorStickyContainer:f,[Xb]:y,[qb]:w,[fk]:S,[Qb]:b}=this[gk],k=t===i[dk]-1;if(h[Ub][$b](e))return a()($f,{[fk]:S,[Kb]:e,groupsDisplayState:this[zb][mk],[wk]:s,[Jb]:r,groupAggregationKey:n,[jb]:l,[Yb]:d,[yk]:h,[vk]:c,[qb]:w,renderGroup:o,onGroupHeaderAddItem:u,renderHeader:p,getGroupStyle:m,stickyLeft:g,stickyTopHeaderOffset:v,ignoreAncestorStickyContainer:f,[Xb]:y,index:t,isLast:k,[Qb]:b},(0,_e.mD)(e))},this.handleGroupsChange=()=>{const{[jb]:e,[Jb]:t,[yk]:i}=this[gk],o=this[zb][mk][Wb];E.maybePersistFormatGroups({[Hb]:this[Hb],[jb]:e,[Jb]:t,[yk]:i,[Wb]:o})},this[Gb]=h().debounce(this.handleGroupsChange,5e3),this[Nb]=e=>{const{[yk]:t,[Jb]:i,[fk]:o,[Yb]:s}=this[gk],r=t[Fb]();r&&E[Nb]({update:e,[yk]:t,[Jb]:i,[Fb]:r,[Hb]:this[Hb],[fk]:o,[Yb]:s})},this.reducerStore=this[Ob]((()=>{const{[fk]:e,disableReducerRequest:t,[Yb]:i,[jb]:o,[Jb]:s,[yk]:r}=this[gk],n=r.remoteRequestStore[mk];if(!t)return(0,Ge.ej)({[fk]:e,[Yb]:i,[jb]:o,[_b]:null==n?void 0:n.loader[_b],[Jb]:s,limit:r[pk][mk]})})),this.schemaGroupsStore=this[Ob]((()=>{const{[Yb]:e,[fk]:t}=this[gk];return(0,_e.Qq)({[Yb]:e,[fk]:t})}),!0),this[zb]=this[Ob]((()=>{var e;const{[fk]:t,[Jb]:i,[jb]:o,[Yb]:s,[yk]:r}=this[gk],n=r[pk][mk],l=r[Lb]();if(!l)return{[Wb]:[],[sk]:[],[uk]:[],total:0};const a=this.schemaGroupsStore[mk],d=this[ik][kk][mk],h=d?d.results:void 0,c=d?d.total:0,u=(0,Ge.Cz)({[fk]:t,[Yb]:s,formatGroups:o[i]||[],schemaGroups:a,[Ab]:h,[Vb]:l[Vb],[Eb]:r[Rb][mk],viewAppConfigUri:null===(e=r[hk]())||void 0===e?void 0:e[Zb]()[Bb]}),p=u[_b]((e=>!(0,_e.eF)(e))).slice(0,n),m=u[_b]((e=>(0,_e.eF)(e)));return{[Wb]:[...p,...m],[sk]:p,[uk]:m,total:c}}),!0)}willMount(e){const{disableReducerRequest:t}=this[gk];t||this[zb].addListener(this[Gb])}willUnmount(){this[zb].removeListener(this[Gb]),this[Gb].cancel()}renderComponent(){const e=this.reducerStore[mk],t=this[zb][mk];return e?a()(Je.Z,{id:this[gk].id,reducer:e,[yk]:this[gk][yk],resultStore:this[ik][kk],render:()=>this.renderResult(t)}):this.renderResult(t)}renderGroups(e){return e.map(this.renderGroup)}[ok](e){const{[ok]:t,[yk]:i,[Yb]:o}=this[gk],{[pk]:s}=i;return t?t({[sk]:e[sk],[uk]:e[uk],total:e.total,groupsLimitStore:s,type:"default",[Yb]:o,[yk]:i}):a()("div",{style:{display:"flex"}},void 0,a()(hy,{[sk]:e[sk],[uk]:e[uk],total:e.total,groupsLimitStore:s,type:"default",[Yb]:o,[yk]:i}))}renderHiddenGroupsButton(e){const{renderHiddenGroupsButton:t}=this[gk];return t?t({[Sk]:this[ik][Sk],[uk]:e}):a()("div",{style:{display:"flex"}},void 0,a()(gy,{[Sk]:this[ik][Sk],[uk]:e}))}renderAddGroupButton(){const{[Yb]:e,[fk]:t,renderAddGroupButton:i,[yk]:o,[Xb]:s}=this[gk],r=this[zb][mk][Wb];return i?i({[fk]:t,[Yb]:e,[Wb]:r,onAccept:this[Nb],groupsLimitStore:o[pk],parentStore:this[gk].store,type:"default",[yk]:o}):a()(Cm,{[fk]:t,[Yb]:e,[Wb]:r,onAccept:this[Nb],groupsLimitStore:o[pk],parentStore:this[gk].store,type:"default",[yk]:o,[Xb]:s,stickyLeft:!0})}}Ck.displayName="CollectionGroups";const Tk=Ck;var xk=i(79131);const Ik=i(85).Omf,Pk=i(85).iDK,Dk=i(85).SjN,Mk=i(85).veG,Zk=i(85).KNN,Bk=i(85).ttX,Rk=i(85).YDv,Ek=i(85).c1l,Vk=i(85).wbq,Ak=i(85).GCx,Lk=i(85).XGW,_k=i(85).yaA,Ok=i(85).I8n,Fk=i(85).bSA,Nk=i(85).xPO,Gk=i(85).PXg,Hk=i(85).XNW,Wk=i(85).RxY,Kk=i(85).vr2,zk=i(85).rRE,Uk=i(85).gIX,$k=i(85).nx5,Qk=i(85).mSd,qk=i(85).Uk6,Xk=i(85).Mm1,Yk=i(85).nLZ,jk=i(85).GmX,Jk=i(85).zrY,eC=i(85).Scd,tC=i(85).Au,iC=i(85).SfJ,oC=i(85).gRm,sC=i(85).zG9,rC=i(85).VAS,nC=i(85).voC,lC=i(85).ykC,aC=i(85).uzK,dC=i(85).Zf2,hC=i(85).n4n,cC=i(85).EIp,uC=i(85).T4J,pC=i(85).qU4,mC=i(85).LIR,gC=i(85).XtO,vC=i(85).jDA,fC=i(85).aV8,yC=i(85).ud8,wC=i(85).Lg4,SC=i(85).c_3,bC=i(85).YGn,kC=i(85).dLQ,CC=i(85).E0z,TC=i(85).pc0,xC=i(85).oWD,IC=i(85).xAw,PC=i(85).jQT,DC=i(85).LCr,MC=i(85).f2X,ZC=i(85).$KA,BC=i(85).wgE,RC=i(85).Drs,EC=i(85).JJj,VC=i(85).Ek1,AC=i(85).eiN,LC=i(85).D4Z,_C=i(85).bQB,OC=i(85).Aw$,FC=i(85).rQ1,NC=i(85).$pZ,GC=i(85).X_m,HC=i(85).XDJ,WC=i(85).BQ6,KC=i(85).D7I,zC=i(85).vK9,UC=i(85).EMU,$C=i(85).sM5,QC=i(85).TtP,qC=i(85).KFJ,XC=i(85).QmD,YC=i(85).TNU,jC=i(85).Leq,JC=i(85).xd5,eT=i(85).I2,tT=i(85).$Fm,iT=i(85).Gnd,oT=i(85).VwS,sT=i(85).tZ2,rT=i(85).P0R,nT=i(85).MAy,lT=i(85).pkR,aT=i(85).urI,dT=i(85).P24,hT=i(85).Kiu,cT=i(85).odo,uT=i(85).mKi,pT=i(85).$3K,mT=i(85).i$5,gT=i(85).htK,vT=i(85).wfR;class fT extends Le.Z{constructor(e,t){super(e,t),this.storeTypes={groupsResultStore:v.default[vT](void 0),[gT]:v.default[vT](void 0)},this[mT]=void 0,this[pT]=void 0,this[uT]=void 0,this[cT]=(e,t)=>{const{[hT]:i,[dT]:o,[aT]:s,query:r,[lT]:n,[nT]:l,intl:d}=this[rT];if(this[sT](e)&&s[oT])return a()(ru,{[eT]:t,[JC]:e,query:r,[hT]:i,[aT]:s,[jC]:s[oT],[dT]:o,[gT]:this[iT][gT],[lT]:n,hidden:!1,isPopup:!1,[tT]:this[rT][tT],[nT]:l,intl:d},(0,_e.mD)(e))},this.subGroupMinWidth=()=>{const{[aT]:e}=this[rT];return this[qC][XC][YC][QC]*(su(e)+2*mh+10)},this.renderBoardHiddenGroupsButton=e=>a()("div",{[WC]:{[$C]:UC,[zC]:this.subGroupMinWidth()}},void 0,c[KC](gy,e)),this.renderSubGroupHeader=e=>c[KC](mf,n()({},e,{[GC]:36,getComputedStickyStyle:this[HC],[WC]:{...e[WC],[zC]:this.subGroupMinWidth()}})),this.renderHiddenGroup=e=>{const{[dT]:t,query:i,[hT]:o,[aT]:s,[lT]:r,[NC]:n,[nT]:l,[tT]:d,intl:h}=this[rT],c=this[qC][XC][eT];if(!this[sT](e)||!s[oT])return;const u=t[FC][XC];return a()(Gp,{query:i,[hT]:o,[aT]:s,[JC]:e,[jC]:s[oT],[eT]:c,[dT]:t,[lT]:r||!this[OC]()||!u[_C],[NC]:n,[nT]:l,[gT]:this[iT][gT],[tT]:d,intl:h},(0,_e.mD)(e))},this[LC]=(e,t)=>{const{[dT]:i}=this[rT],o=this[qC][XC][eT],s=o[AC]((t=>e[VC]((0,_e.mD)(t))<0)),r=o[AC]((t=>e[VC]((0,_e.mD)(t))>=0)),n=h().sortBy(r,(t=>{const i=e[VC]((0,_e.mD)(t));return i>=0?i:1/0})),l=t?[...s,...n]:[...n,...s];z[EC]({[RC]:"Board.handleGroupReorder",[BC]:this[BC],perform:e=>{E.updateGroups({[dT]:i,newGroups:l,[ZC]:MC,[DC]:e})}}),R[PC]({[BC]:this[BC],[dT]:i,action:t?"board_reorder_hidden_groups":"board_reorder_groups"})},this[IC]=e=>{const{[dT]:t,[hT]:i,[aT]:o}=this[rT],s=t[xC]();if(!s)return;const r=o[oT];r&&E[IC]({update:e,[dT]:t,[ZC]:MC,[xC]:s,[hT]:i,[jC]:r,[BC]:this[BC]})},this[TC]=e=>{const{[CC]:t}=this[BC];t[kC]||(0,re.ZP)({event:e,context:re.Af.EditorMouseDown,callback:()=>{e[bC](),F[SC]({[BC]:this[BC],target:e.target,startX:e.clientX,startY:e.clientY,showSelectionRect:!0,preventSelectStores:[],allowVerticalEdgeScroll:!0,[wC]:!0})}})},this.handleGroupsChange=()=>{const{[aT]:e,[dT]:t}=this[rT],i=this[qC][XC][eT];E.maybePersistFormatGroups({[BC]:this[BC],[aT]:e,[ZC]:MC,[dT]:t,[eT]:i})},this[yC]=h().debounce(this.handleGroupsChange,5e3),this[fC]=e=>{const{[dT]:t}=this[rT],{[CC]:i}=this[BC];i[kC]?N[vC]({[BC]:this[BC],[gC]:e,[mC]:f.tY.Create}):N.peekBlock({[BC]:this[BC],[gC]:e,peekMode:ie.getPeekMode(t[pC]()),resultsStore:void 0,[dT]:t,[mC]:f.tY.Create})},this[uC]=()=>{this[iT][gT].setState(void 0)},this.schemaGroupsStore=this[cC]((()=>{const{[aT]:e,[hT]:t}=this[rT],i=e[oT];if(i)return(0,_e.Qq)({[hT]:t,[jC]:i})}),!0),this.groupsReducerStore=this[cC]((()=>{const{[aT]:e,[hT]:t,[dT]:i}=this[rT],o=i.remoteRequestStore[XC],s=e[oT];if(s)return(0,Ge.ej)({[jC]:s,[hT]:t,[aT]:e,[AC]:null==o?void 0:o.loader[AC],[ZC]:MC,limit:i[hC][XC]})})),this[qC]=this[cC]((()=>{const{[aT]:e,[hT]:t,[dT]:i}=this[rT],o=e[oT];if(!o)return{[eT]:[],[YC]:[],[dC]:[],total:0};const s=i[aC]();if(!s)return{[eT]:[],[YC]:[],[dC]:[],total:0};const r=i[pC](),n=i[hC][XC],l=this.schemaGroupsStore[XC],a=this[iT].groupsResultStore[XC],d=a?a.results:void 0,h=a?a.total:0,c=(0,Ge.Cz)({[jC]:o,[hT]:t,formatGroups:e[MC]||[],schemaGroups:l,[lC]:d,[nC]:s[nC],[rC]:i[sC][XC],viewAppConfigUri:null==r?void 0:r.getFormat()[oC]}),u=c[AC]((e=>!(0,_e.eF)(e))).slice(0,n),p=c[AC]((e=>(0,_e.eF)(e)));return{[eT]:[...u,...p],[YC]:u,[dC]:p,total:h}}),!0),this[iC]=this[cC]((()=>{const{[hT]:e,[aT]:t,[dT]:i}=this[rT];return!Boolean((0,Ge.II)({[BC]:this[BC],[JC]:void 0,[hT]:e,[aT]:t,[dT]:i,[tC]:this[tC]}))}),!0),this[HC]=e=>({[eC]:this[rT][tT]?this[tC][Jk]:this[tC][jk],boxShadow:e?`0 1px 0 ${this[rT][tT]?this[tC][Jk]:this[tC][jk]}`:void 0}),this.getGroupStyle=e=>({[Yk]:4,...e.isLast&&{[Xk]:12}}),this[mT]=c.createRef(),this[pT]=c.createRef(),this[uT]=0}willMount(){this[qC].addListener(this[yC])}willUnmount(){this[qC].removeListener(this[yC]),this[yC].cancel()}willMountOrUpdate(e){const{[aT]:t,[gC]:i,[dT]:o}=e,s=o[xC]();if(!s)return;const r=o[FC][XC];!t[oT]&&i.isDefined()&&s.isDefined()&&r[qk]&&r[Qk]&&this.updateOrCreateColumnsByProperty(e),m.default.afterNextFlush((()=>this.updateHiddenGroupsHeaderOffset()))}renderPersisted(){const{[aT]:e}=this[rT];return e[oT]?this.renderBoard():a()("div",{[WC]:this.getBoardStyle(),className:X.boardView},void 0,a()(P.FormattedMessage,{[$k]:"Unable to render this view because the database is missing a select property.",id:"database.boardView.missingSelectProperty"}))}renderBoard(){const{[gC]:e,[aT]:t,[nT]:i,[dT]:o}=this[rT],s=this[qC][XC],{[YC]:r,[dC]:l}=s,d=t.collection_group_by;return this.renderBoardColumnsReducerRequest((()=>(0,He.Z)((t=>a()(Af,{[nT]:i,[Uk]:o[Uk]},void 0,c[KC]("div",n()({[WC]:this.getBoardStyle(),className:X.boardView},t),a()(rl.Z,{[WC]:this.getColumnsWrapStyle(),[gC]:e,shouldShowHalo:!i,canSelect:!i,onMouseDown:this[TC],[Fk]:zk,onMouseLeave:this[uC]},void 0,this.renderHeader(s),r[QC]>0&&a()("div",{},void 0,a()("div",{[WC]:{[GC]:34+gh(this[iC][XC])}}),d?this.renderBoardColumnsForGroups(d,r):this[Kk](void 0,r)),this[Wk](s)&&a()("div",{[WC]:{width:90,[Hk]:5,[Gk]:5}}),this[Nk]()&&a()("div",{[WC]:{width:35,[Hk]:5,[Gk]:5}}),l[QC]>0&&this.renderHiddenGroups(l))))))))}renderBoardColumnsReducerRequest(e){const{[dT]:t}=this[rT],i=this.groupsReducerStore[XC];return i?a()(Je.Z,{id:MC,reducer:i,[dT]:t,resultStore:this[iT].groupsResultStore,render:e}):e()}renderHeader(e){const{[aT]:t,[nT]:i,[Ok]:o,[dT]:s}=this[rT],{[dC]:r,[YC]:n,[eT]:l}=e,d=n.map((e=>(0,_e.mD)(e))),h=t[oT];if(!h)return;const u=(0,_e.mu)(h),p=s[FC][XC],m="manual"===u.type&&p[Qk],g=(0,Ge.qW)({[CC]:this[BC][CC],[nT]:i,[Ok]:o});return a()(zg,{position:We.Top},void 0,a()("div",{[WC]:this[_k]()},void 0,g&&a()("div",{[WC]:this.getHeaderSpacerStyle()}),m?a()(xk.ZP,{[Ak]:Lk,keys:d,renderKey:(e,t)=>this[cT](n[t],l),onDrop:e=>this[LC](e,!1)}):d.map(((e,t)=>this[cT](n[t],l))),this[Wk](e)&&this[Vk](e),this[Nk]()&&this.renderAddGroupButton(),r[QC]>0&&c[KC]("div",{[WC]:this.getHiddenGroupsCaptionStyle(),ref:this[pT]},a()(P.FormattedMessage,{[$k]:"Hidden groups",id:"collection.boardView.hiddenGroups.label"}))))}renderHiddenGroups(e){const{[CC]:t}=this[BC],{[dT]:i}=this[rT],o=this[OC]()&&!t[kC]&&!i[FC][XC].isLocked,s=e.slice(0,Ge.ew),r=s.map((e=>(0,_e.mD)(e)));return c[KC]("div",{[WC]:this.getHiddenGroupsWrapStyle(),ref:this[mT]},s[QC]>0&&(o?a()(xk.ZP,{[Ak]:"vertical",keys:r,renderKey:(e,t)=>this.renderHiddenGroup(s[t]),onDrop:e=>this[LC](e,!0)}):a()("div",{},void 0,s.map(this.renderHiddenGroup))))}[Vk](e){const{[dT]:t,[hT]:i}=this[rT],o=t[hC];return a()(hy,{[YC]:e[YC],[dC]:e[dC],total:e.total,groupsLimitStore:o,type:zk,[hT]:i,[dT]:t})}renderAddGroupButton(){const{[aT]:e,[hT]:t,[dT]:i}=this[rT];if(!e[oT])return;if("collectionTypedView"===i[Ek])return;const o=this[qC][XC][eT];return a()(Cm,{[jC]:e[oT],[hT]:t,[eT]:o,onAccept:this[IC],groupsLimitStore:i[hC],parentStore:this[rT][gC],type:zk,[dT]:i})}renderBoardColumnsForGroups(e,t){const{[gC]:i,[aT]:o,[dT]:s,[hT]:r,[lT]:n,[nT]:l,[Rk]:d,[Ok]:h,[tT]:c}=this[rT];return a()(Tk,{[gC]:i,id:Oe.M9,[jC]:e,[ZC]:_e.Uh,groupAggregationKey:_e.dQ,[aT]:o,[hT]:r,[dT]:s,[lT]:n,[nT]:l,[Ok]:h,[Rk]:d,renderGroup:e=>this[Kk](e,t),renderHeader:this.renderSubGroupHeader,renderHiddenGroupsButton:this.renderBoardHiddenGroupsButton,onGroupHeaderAddItem:this[fC],stickyLeft:!this[BC][CC][kC],getGroupStyle:this.getGroupStyle,[tT]:c})}[Kk](e,t){return a()("div",{[WC]:xk.l8},void 0,t.map(((i,o)=>{const s=o===t[QC]-1;return this[Bk](e?[e,i]:[i],s)})))}[Bk](e,t){const{[gC]:i,[dT]:o,[nT]:s,query:r,[hT]:n,[aT]:l,[lT]:d,[NC]:h}=this[rT],c=0!==this[qC][XC][dC][QC];if(!o.groupsStore[Zk](e))return;const u=o[FC][XC],p=this[OC]()&&("collectionTypedView"===o[Ek]||u[_C]);return a()(fh,{[gC]:i,[gT]:this[iT][gT],query:r,[hT]:n,[aT]:l,groupsPointer:e,[dT]:o,[nT]:s,[tT]:this[rT][tT],[lT]:d||!p,isLast:t&&!c,[NC]:h},(0,_e.KW)(e))}updateOrCreateColumnsByProperty(e){const{[dT]:t,[hT]:i}=e,o=t[xC]();if(!o)return;const s=t[pC]();s&&z[EC]({[RC]:"Board.updateOrCreateColumnsByProperty",[BC]:this[BC],perform:e=>{let r,n=ie.findGroupableProperty(i);if(!n){n=(0,Fe.ZP)();r={[n]:{name:this[rT].intl.formatMessage({id:"collection.boardView.selectProperty.defaultName",[$k]:"Status"}),type:"select",options:[]}}}const l=(r||i)[n];l&&(0,_e.LG)(l)&&(Ne.updateFormat({[iT]:[s],update:{[oT]:(0,_e.fw)(n,l,"collectionTypedView"===t[Ek])},[DC]:e}),r&&L[Mk]({[BC]:this[BC],[xC]:o,update:r,[DC]:e}))}})}[sT](e){const{[dT]:t}=this[rT];return t.groupsStore[Zk]([e])}[Wk](e){const{[dT]:t}=this[rT],{[dC]:i,total:o}=e;return t[hC][XC]<o-i[QC]}[Nk](){const{[aT]:e,[dT]:t}=this[rT],i=e[oT],o=t[FC][XC];return o[Qk]&&i&&(0,_e.Wz)(i,o[qk])&&!o.isSyncedCollection}getBoardStyle(){return{[Hk]:this[rT][Rk],[Gk]:this[rT].paddingRight,float:"left",[zC]:"100%"}}[_k](){var e;const{[dT]:t,[tT]:i}=this[rT],o=(null===(e=t[Dk][XC])||void 0===e?void 0:e[eC])||(i?this[tC][Jk]:this[tC][jk]),s=gh(this[iC][XC]);return{position:"absolute",[eC]:o,[GC]:34+s,paddingTop:s,zIndex:I.boardHeader,[$C]:UC,boxShadow:`-3px 0 0 ${o}`,[zC]:"100%"}}getColumnsWrapStyle(){return{[$C]:UC,position:"relative",flexGrow:1,[Xk]:this[rT][Xk]}}getHiddenGroupsWrapStyle(){return{width:220,flexShrink:0,[Yk]:34+gh(this[iC][XC]),[Hk]:12}}getHiddenGroupsCaptionStyle(){return{position:"relative",width:220,flexShrink:0,[$C]:UC,alignItems:"center",fontSize:14,color:this[tC].lightTextColor,[eC]:this[rT][tT]?this[tC][Jk]:this[tC][jk],[Hk]:20}}getHeaderSpacerStyle(){return{[GC]:"calc(100% + 17px)",[eC]:this[rT][tT]?this[tC][Jk]:this[tC][jk],width:20,[Hk]:-20,[Yk]:-17}}updateHiddenGroupsHeaderOffset(){var e;if("function"==typeof this[pT]||null===(e=this[pT])||void 0===e||!e[Pk])return;const t=(this.getHiddenGroupsHeaderOffset()||0)+this[uT];this[uT]=t,this[pT][Pk][WC].left=`${t}px`}getHiddenGroupsHeaderOffset(){var e,t;if("function"==typeof this[pT]||"function"==typeof this[mT]||null===(e=this[pT])||void 0===e||!e[Pk]||null===(t=this[mT])||void 0===t||!t[Pk])return;const i=this[pT][Pk][Ik]().left;return this[mT][Pk][Ik]().left-i+8}}const yT=(0,P.injectIntl)(fT);var wT=i(13991),ST=i(40506),bT=i(7057),kT=i(53877),CT=i(40863),TT=i(95802),xT=i(15723),IT=i(17746),PT=i(50628),DT=i(17126),MT=i(53876),ZT=i(6685),BT=i(76798);const RT=i(85).LWT,ET=i(85)._mQ,VT=i(85).D03,AT=i(85).GCx,LT=i(85).qU4,_T=i(85).Hco,OT=i(85).MpA,FT=i(85).xKX,NT=i(85).nx5,GT=i(85).gLO,HT=i(85).d1X,WT=i(85).wuN,KT=i(85).AIq,zT=i(85).KkB,UT=i(85).Exd,$T=i(85).jkI,QT=i(85).nAm,qT=i(85).z8h,XT=i(85).BQ6,YT=i(85).LCr,jT=i(85).oWD,JT=i(85).H1U,ex=i(85).S9$,tx=i(85).jFW,ix=i(85).mBb,ox=i(85).gGi,sx=i(85).PXg,rx=i(85).XNW,nx=i(85).X_m,lx=i(85).XCs,ax=i(85).YDv,dx=i(85).Mm1,hx=i(85).tLG,cx=i(85).fBv,ux=i(85).pAK,px=i(85).hCp,mx=i(85).OBh,gx=i(85).voC,vx=i(85).ffk,fx=i(85).GKo,yx=i(85).rQ1,wx=i(85).E_V,Sx=i(85).$pZ,bx=i(85).ixe,kx=i(85).pkR,Cx=i(85).XqV,Tx=i(85).tDk,xx=i(85).XtO,Ix=i(85).D7I,Px=i(85).P24,Dx=i(85).wgE,Mx=i(85).kId;class Zx extends Le.Z{activate(){const e=this.getPeekURL();e&&(this.props[Mx](),N.navigate({[Dx]:this[Dx],url:e}))}didMount(){this.props[Px].onItemMount()}renderComponent(){return c[Ix](Rx,this.props)}getPeekURL(){const{[xx]:e,[Px]:t}=this.props,{[Tx]:i}=ge.default.state;return ie.getPeekModeHref({[xx]:e,[Tx]:i,[Px]:t,[Cx]:!1})}}const Bx=Zx;function Rx(e){window.__c={n:"CalendarItemFn"};const{[xx]:t,row:i,schema:o,format:s,[kx]:r,calendarBy:n,[Px]:l,includeTime:d,[bx]:c,[Mx]:u,[Sx]:p,[wx]:m}=e,g=(0,qn.O7)(),v=o[n],f=(0,Xn.VK)((()=>!r&&"date"===(null==v?void 0:v.type)&&!l[yx].state.isSyncedCollection),[l[yx],r,null==v?void 0:v.type]),{start:y,end:w,startOfWeek:S,endOfWeek:b,startColumn:k,columnCount:C}=(0,CT.du)({startUnixTimestampMS:e.start,endUnixTimestampMS:e.end,startOfWeekUnixTimestampMS:e.startOfWeek,endOfWeekUnixTimestampMS:e.endOfWeek}),T=(0,Xn.VK)((()=>{const e=s[fx]?s[fx].filter((e=>e.visible)).map((e=>e[vx])):[],i=e.filter((e=>Pi.cardPropertyFormatIsVisible({block:t.getModel(),[vx]:e,schema:o,[gx]:t[gx],userId:g.currentUser.id,userTimeZone:(0,Qe.r)(),intl:ne.default.getIntl()})));return i.concat(h().difference(e,i))}),[g.currentUser.id,s[fx],o,t]);if(!v||!Ii.isDateType(v))return null;const x=T.length+1,I=y<S,P=void 0!==w&&w>b;return a()(Ex,{[xx]:t,row:i,numRows:x,columnCount:C,startIsBeforeStartOfWeek:I,endIsAfterEndOfWeek:P,startColumn:k,[kx]:r,isEditableDate:f,calendarBy:n,[bx]:c,[Mx]:u},void 0,a()(Vx,{[xx]:t,start:y,startOfWeek:S,end:w,endOfWeek:b,includeTime:d,columnCount:C,[mx]:v}),a()(Lx,{[xx]:t,sortedProperties:T,startIsBeforeStartOfWeek:I,[kx]:r,[Sx]:p}),f&&a()(_x,{[xx]:t,start:y,startOfWeek:S,end:w,endOfWeek:b,calendarBy:n,[wx]:m}))}function Ex(e){window.__c={n:"CalendarItemWrapper"};const{[xx]:t,children:i,columnCount:o,row:s,numRows:r,startColumn:n,[kx]:l,isEditableDate:d,calendarBy:h,[bx]:u,[Mx]:p,startIsBeforeStartOfWeek:m,endIsAfterEndOfWeek:g}=e,v=(0,qn.O7)(),y=(0,U.Y$)(),w=(0,Xn.VK)((()=>ie[px](t)),[t]),S=r*MT.ch+2*sD+2*rD,b=oD+S*s,k=(0,Xn.VK)((()=>ol.Z.state.hoveredStore===e[xx]),[e[xx]]),C=(0,Yn.yK)((e=>({[ux]:{[cx]:hx,paddingTop:3,[dx]:3,[ax]:m?0:6,[lx]:g?0:6,width:g?`calc(100% / 7 * ${o} - 1px)`:`calc(100% / 7 * ${o})`,left:`calc(100% / 7 * ${n})`,[nx]:S,top:b},haloStyle:{...ie.getHighlightHaloStyle(w,e),borderRadius:5,marginTop:2,marginBottom:2,[rx]:m?0:5,[sx]:g?0:5},linkBoxStyle:{[nx]:ox,background:e.calendarItemBackground,borderTopLeftRadius:3,[ix]:3,[tx]:3,[ex]:3,boxShadow:e.lightBoxShadow,...m&&{[ix]:0,[ex]:0},...g&&{borderTopLeftRadius:0,[tx]:0}},linkBoxHoveredStyle:{opacity:1,background:e.calendarItemHoveredBackground},linkBoxInnerStyle:{display:"flex",[cx]:"relative",paddingTop:2,[dx]:2,[nx]:ox,[JT]:"flex-start",flexDirection:"column"}})),[o,g,S,w,n,m,b]),T=(0,c.useCallback)((e=>{const i=y[jT]();return i?B.QG({[Dx]:v,[jT]:i,[Px]:y,[xx]:t,insertStores:e.insertStores,calendarBy:h,[YT]:e[YT],results:u.state}):[]}),[h,y,v,u,t]),x=(0,c.useCallback)((e=>{const{[YT]:i}=e;y[jT]()&&E.remove({[xx]:t,[YT]:i})}),[y,t]),[I,P]=(0,Xn.VK)((()=>{const{[Tx]:e}=ge.default.state,i=ie.getPeekModeHref({[xx]:t,[Tx]:e,[Px]:y,[Cx]:!1});return[(0,se.ZP)({[xx]:t,[Cx]:!1,pageVisitSource:f.tY.LinkInPage}),i]}),[y,t]);return a()(rl.Z,{[xx]:t,[XT]:C[ux],canSelect:!l,shouldShowHalo:!0,shouldForceRenderSelectionHalo:w,haloStyle:C.haloStyle,canTriggerContextMenu:!l,showBlockMenuInput:!0,canDrag:d,onInsertAbove:T,onInsertBelow:T,onRemove:x,canInsertAbove:d,canInsertBelow:d,analyticsName:"calendar",shouldShowDropZone:!0,className:X.collectionItem},t.id,a()(Eo.Z,{[XT]:C.linkBoxStyle,hoveredStyle:C.linkBoxHoveredStyle,pressedStyle:C.linkBoxHoveredStyle,innerStyle:C.linkBoxInnerStyle,onClick:p,href:I,metaHref:P,hovered:k},void 0,i))}function Vx(e){window.__c={n:"CalendarItemTitleRow"};const{[xx]:t,start:i,startOfWeek:o,end:s,endOfWeek:r,includeTime:n,columnCount:l,[mx]:d}=e,h=i<o,c=s&&s>r,u="time_format"in d?d.time_format:ST.defaultTimeFormat,[p,m,g]=(0,Xn.VK)((()=>[t.getIcon(),t.isEmptyPage(),t.hasError()]),[t]),v=(0,Yn.yK)((e=>({[qT]:{[ax]:6,[lx]:6,overflow:QT,...h&&{[ax]:12},...c&&{[lx]:11},width:n?100/l+"%":ox},titleInner:{display:"flex",[JT]:$T,[nx]:24},titleTextStyle:{flexGrow:1,[UT]:14,fontWeight:x.Z.fontWeight.semibold},[zT]:{[KT]:0,[sx]:4,marginTop:2},iconWarningStyle:{[rx]:1,[sx]:5,width:10,fill:e.accentColors.orange[500]},timeStyle:{color:e[WT],[KT]:0,[UT]:10,[rx]:4,[nx]:14},endTimeStyle:{[rx]:"auto",[ax]:4,[sx]:4,color:e[WT],[UT]:10,whiteSpace:"nowrap",marginTop:-1},endTimeAbsoluteStyle:{[cx]:hx,right:4,top:6}})),[l,c,n,h]),f=n&&s&&DT.Xp[GT](o,r)[HT](s)&&i.day!==s.day;return a()("div",{[XT]:v[qT]},void 0,a()("div",{[XT]:v.titleInner},void 0,void 0!==p&&!g&&a()(Vo.Z,{[kx]:!0,icon:p,isEmptyPage:m,size:14,[XT]:v[zT]}),g&&S.Z.warning(v.iconWarningStyle),a()(BT.Z,{[XT]:v.titleTextStyle,[xx]:t,enableHover:!0}),a()(Ax,{[xx]:t}),n&&DT.Xp[GT](o,r)[HT](i)&&a()("div",{[XT]:v.timeStyle},void 0,(0,bT.xE)({dateTime:i,humanReadable:!1,timeFormat:u})),f&&a()("div",{[XT]:{...v.endTimeStyle,...l>1?v.endTimeAbsoluteStyle:void 0}},void 0,a()(P.FormattedMessage,{[NT]:"ends {endTime}",id:"calendarItem.endsTime.message",values:{endTime:(0,bT.xE)({dateTime:s,humanReadable:!1,timeFormat:u})}}))))}function Ax(e){window.__c={n:"DiscussionIndicator"};const{[xx]:t}=e,i=(0,Yn.Fg)(),o=(0,Xn.VK)((()=>Vi[FT](t,{[OT]:!1})),[t]);return 0===o?null:a()("div",{[XT]:{display:"flex",[JT]:$T,color:i[WT],[UT]:12,[rx]:4,[KT]:0}},void 0,S.Z.speechBubble({width:12,[nx]:12,[sx]:4,fill:i[_T]}),o)}function Lx(e){window.__c={n:"CalendarItemPropertiesRows"};const{[xx]:t,sortedProperties:i,startIsBeforeStartOfWeek:o,[kx]:s,[Sx]:r}=e,n=(0,U.Y$)(),l=(0,Xn.VK)((()=>n[yx].state.isLocked),[n[yx]]),[d,h]=(0,Xn.VK)((()=>[n[jT](),n[LT]()]),[n]);return d?a()("div",{[XT]:{[ax]:6,[lx]:6,overflow:QT,width:ox,...o&&{[ax]:12}}},void 0,i.map((e=>a()(Do.Z,{[xx]:t,[vx]:e,[kx]:s,locked:l,format:Mo.C.Calendar,tableWrap:!1,[Sx]:r,[jT]:d,[LT]:h},e)))):null}function _x(e){window.__c={n:"CalendarItemDraggables"};const{[xx]:t,[wx]:i,start:o,startOfWeek:s,end:r,endOfWeek:l,calendarBy:d}=e,h=(0,qn.O7)(),u=(0,Yn.yK)((()=>({leftDragHandle:{[cx]:hx,top:0,left:-4,[nx]:ox,width:12,cursor:"col-resize"},rightDragHandle:{[cx]:hx,top:0,right:-4,[nx]:ox,width:12,cursor:"col-resize"}})),[]),p=(0,c.useCallback)((e=>{B.td({[wx]:i,x:e.currentX,y:e.currentY,calendarBy:d})}),[i,d]),m=(0,c.useCallback)((()=>{z.createAndCommit({userAction:"CalendarItem.handleDraggableDragEnd",[Dx]:h,perform:e=>{B.fX({[Dx]:h,[YT]:e,[wx]:i,calendarBy:d})}})}),[d,i,h]),g=(0,c.useCallback)((()=>{B.cQ({[wx]:i})}),[i]),v=o>s&&a()(ZT.Z,{render:e=>c[Ix]("div",n()({[XT]:u.leftDragHandle},e)),[VT]:()=>{B.f$({[wx]:i,target:t,[AT]:IT.t.Left})},onDraggableDragMove:p,[ET]:m,[RT]:g}),f=(!r||r&&r<l)&&a()(ZT.Z,{render:e=>c[Ix]("div",n()({[XT]:u.rightDragHandle},e)),[VT]:e=>{B.f$({[wx]:i,target:t,[AT]:IT.t.Right})},onDraggableDragMove:p,[ET]:m,[RT]:g});return c[Ix](c.Fragment,null,v,f)}const Ox=i(85).NF1,Fx=i(85).xOW,Nx=i(85).MLn,Gx=i(85).tLG,Hx=i(85).GmX,Wx=i(85).zrY,Kx=i(85).Scd,zx=i(85).SjN,Ux=i(85).$Fm,$x=i(85).veG,Qx=i(85).Cj7,qx=i(85).q$s,Xx=i(85).tDk,Yx=i(85).q$P,jx=i(85).Sgw,Jx=i(85).QLQ,eI=i(85).OBp,tI=i(85).TEz,iI=i(85).Joh,oI=i(85).cJo,sI=i(85).vTv,rI=i(85).LCr,nI=i(85).lmZ,lI=i(85).Q_9,aI=i(85).siJ,dI=i(85).oWD,hI=i(85).Drs,cI=i(85).JJj,uI=i(85).J$i,pI=i(85).Ylz,mI=i(85).GKo,gI=i(85).BPD,vI=i(85).L6v,fI=i(85).$pZ,yI=i(85).urI,wI=i(85).fBv,SI=i(85).Au,bI=i(85).xej,kI=i(85).IY7,CI=i(85).nLZ,TI=i(85).Mcv,xI=i(85).Q9F,II=i(85).PG2,PI=i(85).hMp,DI=i(85).dLQ,MI=i(85).Yzm,ZI=i(85).Exd,BI=i(85).OM8,RI=i(85).PXg,EI=i(85).XNW,VI=i(85).ChN,AI=i(85).g7N,LI=i(85).jkI,_I=i(85).H1U,OI=i(85).EMU,FI=i(85).sM5,NI=i(85).yaA,GI=i(85).nx5,HI=i(85).Jf8,WI=i(85).lGm,KI=i(85).bSA,zI=i(85).D7I,UI=i(85).qI$,$I=i(85).EMf,QI=i(85).BQ6,qI=i(85).vK9,XI=i(85).sP9,YI=i(85).X02,jI=i(85).MAy,JI=i(85).XCs,eP=i(85).YDv,tP=i(85).Mm1,iP=i(85).uRL,oP=i(85).JgC,sP=i(85).yrh,rP=i(85).A_N,nP=i(85).Uk6,lP=i(85).nUE,aP=i(85).rQ1,dP=i(85).SK6,hP=i(85).nSw,cP=i(85).Ttb,uP=i(85).Nbg,pP=i(85).TLr,mP=i(85).tIL,gP=i(85).Pxe,vP=i(85).Ubh,fP=i(85).EIp,yP=i(85).lzS,wP=i(85).qLW,SP=i(85).owv,bP=i(85).ixe,kP=i(85).qU4,CP=i(85).jQA,TP=i(85).kId,xP=i(85).Lg4,IP=i(85).nm$,PP=i(85).c_3,DP=i(85).YGn,MP=i(85).Gm5,ZP=i(85).E6w,BP=i(85).wgE,RP=i(85).pc0,EP=i(85).edE,VP=i(85).P3e,AP=i(85).YSw,LP=i(85).qnp,_P=i(85).i7F,OP=i(85).GPM,FP=i(85).Wp_,NP=i(85).X_m,GP=i(85).T9w,HP=i(85).XtO,WP=i(85).Omf,KP=i(85).Gnd,zP=i(85).lTn,UP=i(85).iQh,$P=i(85).MG9,QP=i(85).xYh,qP=i(85).QmD,XP=i(85).P0R,YP=i(85).P24,jP=i(85).m3I,JP=i(85).wfR,eD=i(85).p6m,tD=i(85).E_V,iD=i(85).xle,oD=30,sD=2,rD=3;class nD extends Le.Z{constructor(){super(...arguments),this.headerEl=void 0,this.root=void 0,this[iD]=void 0,this.storeTypes={[tD]:IT.Z,[eD]:v.default[JP](void 0)},this.handleHeaderMount=e=>{this.headerEl=e},this[jP]=e=>{const{[YP]:t}=this[XP],i=t[QP][qP],o=this[$P]();if(e<ye.Z.incrementScrollOffset&&!i&&o){const{[YP]:e}=this[XP],t=e[UP][qP],i=e.dateRangeEnd[qP],o=(0,kT.getEndOfWeek)((0,kT.addMonthsToDate)({date:i,monthsToAdd:2}),Q.userSettingsStartOfWeekStore[qP]);L.setDateRange({[UP]:t,dateRangeEnd:o,[YP]:e})}},this[zP]=()=>{if(!this.headerEl)return;if(!this[$P]())return;const{[tD]:e}=this[KP],t=e[qP],i=this.headerEl[WP]();let o=[];t.dayStoreMap.forEach(((e,t)=>{o.push({[HP]:e,[GP]:t})})),o=h().sortBy(o,(e=>{let{[GP]:t}=e;return t}));const s=o.find((e=>{let{[HP]:t}=e;const o=TT.C.getRectFromStore(t);return Boolean(o&&o.top<=i.top+i[NP]&&o.top+o[NP]>=i.top+i[NP])}));if(s){const i=(0,kT.getStartOfMonth)((0,kT.addDaysToDate)({date:(0,kT.getEndOfWeek)(s[GP],Q.userSettingsStartOfWeekStore[qP]),daysToAdd:1}));i!==t.startingMonth&&e[FP]({...e[qP],startingMonth:i})}},this[OP]=h().throttle(this[zP],100),this[_P]=e=>{const{[tD]:t}=this[KP],i=t[qP];if(!i[LP]&&!Te.Z[qP]){const o=this.findHoveredDay(e.clientX,e.clientY);i.hoveredDay!==o&&t[FP]({...i,hoveredDay:o})}},this[AP]=h().throttle(this[_P],50),this.handleTodayClick=()=>{const e=this[VP](this[XP][YP]),t="month"===e?(0,kT.getStartOfWeek)((0,kT.getStartOfMonth)(Date.now()),Q.userSettingsStartOfWeekStore[qP]):(0,kT.getStartOfWeek)(Date.now(),Q.userSettingsStartOfWeekStore[qP]);this[EP](t,e)},this[RP]=e=>{const{device:t}=this[BP];t[ZP]||(0,re.ZP)({event:e,[MP]:re.Af.EditorMouseDown,callback:()=>{e[DP](),F[PP]({[BP]:this[BP],[IP]:e[IP],startX:e.clientX,startY:e.clientY,showSelectionRect:!0,preventSelectStores:[this[XP][HP]],allowVerticalEdgeScroll:!0,[xP]:!1})}})},this[TP]=()=>{const{[YP]:e}=this[XP];pe.default.mark(CP);const t=e[kP]();O.Xd({[YP]:e,[bP]:this.sortedResultsStore});const i=null==t?void 0:t[wP]()[SP],o=i||sl.Ls[yP];D.trackExpandBlock(this[BP],{is_peek:!0,from:yP,peek_mode:o})},this.startOfWeekSettingStore=this[fP]((()=>{const{[vP]:e}=ge.default[qP];if(!e)return;const t=e[gP]();return null!=t&&t[mP]?t[mP]:0}),!0),this.reducerStore=this[fP]((()=>{const{[YP]:e}=this[XP];return(0,CT.Ft)({[YP]:e})}),!0),this[bP]=this[fP]((()=>{const{[YP]:e}=this[XP],t=e[kP]();if(!t)return[];const i=this[KP][eD][qP];return i?i.blockIds.map((e=>Ee.G[pP](t,{id:e,table:C.iU}))):[]}),!0),this.weeksStore=this[fP]((()=>{const{[YP]:e}=this[XP],t=ne.default[uP]();return(0,CT.y$)({[YP]:e,[cP]:this[bP][qP],[hP]:this[hP],intl:t})}),!0),this.sortedResultsStore=this[fP]((()=>{var e;const{[YP]:t}=this[XP],i=t[kP]();return i&&(null===(e=this.weeksStore[qP])||void 0===e?void 0:e.flatMap((e=>e.items.map((e=>Ee.G[pP](i,{table:C.iU,id:e.id}))))))||[]}),!0),this[hP]=this[XP][HP][hP]}static getPropertyRowHeight(){return MT.ch}willMount(e){super.willMount(e);const{[YP]:t}=e;this.handleMount(t),Q.userSettingsStartOfWeekStore.addListener((()=>{this.handleMount(this[XP][YP])}))}[dP](e){super[dP](e),Te.Z[qP]&&(this[KP][tD][qP][LP]||this[KP][tD][FP]({...this[KP][tD][qP],hoveredDay:void 0}));const{query:t,[YP]:i}=e,o=i[aP][qP];!t[lP]&&o[nP]&&o.canConfigureBlock&&this.updateOrCreateCalendarProperty(e)}didMountOrUpdate(){this[OP](),this.root||(this.root=u.findDOMNode(this),this.root&&(this[iD]=(0,de.VW)(this.root),this[iD]&&oe[rP](this[iD],"scroll",this[OP]),oe[rP](this.root,sP,this[AP])))}willUnmount(){super.willUnmount(),this[iD]&&oe[oP](this[iD],"scroll",this[OP]),this.root&&oe[oP](this.root,sP,this[AP])}navigate(e){this[MP][iP]?this[MP][iP](e):N.navigate({[BP]:this[BP],url:e})}renderPersisted(){var e,t;const{device:i}=this[BP],{[HP]:o,[tP]:s,[eP]:r,[JI]:l,query:d,schema:h,[YP]:u,[jI]:p}=this[XP],{[lP]:m}=d;if(!m)return this[YI]();const g=h[m];if(!g||!Ii.isDateType(g))return this[YI]();const v=this.reducerStore[qP];if(!v)return;const f=(void 0===(null===(e=this[KP][eD].getState())||void 0===e?void 0:e.blockIds)||0===(null===(t=this[KP][eD].getState())||void 0===t?void 0:t.blockIds.length))&&ff({[YP]:u,[XI]:[]}),y=this[VP](u),w=this.weeksStore[qP];return(0,He.Z)((e=>a()(Je.Z,{id:"calendar_results",[eD]:this[KP][eD],[YP]:u,reducer:v,render:()=>a()(Af,{[jI]:p},void 0,a()(hd.Z,{onChange:this[jP]},void 0,a()("div",{[QI]:{[tP]:s,[eP]:r,[JI]:l,[qI]:this[XP][qI]},[WI]:X.calendarView},void 0,c[zI](rl.Z,n()({[QI]:nD[QI],[HP]:o,shouldShowHalo:!p,canSelect:!p,onMouseDown:this[RP],[KI]:yP},e),this.renderHeader(this[$I](),y),a()("div",{[QI]:i[ZP]?nD.mobileHeaderSpacerStyle:nD.headerSpacerStyle}),a()("div",{[QI]:i[ZP]?nD.mobileRowsWrapStyle:this.getRowsWrapStyle()},void 0,w&&w.map((e=>i[ZP]?this.renderMobileWeek(e[UI],e.items,m,y):this.renderWeek(e[UI],e.end,e.items,m,g,y,f))))))))})))}[YI](){const{[tP]:e,[eP]:t,[JI]:i}=this[XP];return a()("div",{[QI]:{[tP]:e,[eP]:t,[JI]:i},[WI]:X.calendarView},void 0,a()(P.FormattedMessage,{[GI]:HI,id:"database.calendarView.missingDateProperty"}))}renderHeader(e,t){const{device:i}=this[BP],{[YP]:o}=this[XP],s=ne.default[uP]();return a()(zg,{[wI]:We.Top},void 0,c[zI]("div",{[QI]:i[ZP]?this.getHeaderMobileStyle():this[NI](),ref:this.handleHeaderMount},a()("div",{[QI]:{[FI]:OI,[NP]:42,[_I]:LI,[AI]:2}},void 0,a()("div",{[QI]:{[VI]:x.Z[VI].semibold,[EI]:8,[RI]:8,[BI]:1,[ZI]:i[ZP]?16:14}},void 0,this.getHeaderText(t,e,wT.SP)),a()("div",{[QI]:{flexGrow:1}}),a()(pn.Z,{ariaLabel:s[MI]({id:"database.calendarView.previousMonthButton.label",[GI]:"Previous Month"}),mobileFeedback:i[DI],icon:S.Z.chevronLeft,[II]:()=>this.handleCalendarClick(PI,o)}),a()(rt.Z,{isSmall:!0,[II]:this.handleTodayClick},void 0,a()(P.FormattedMessage,{[GI]:"Today",id:"database.calendarView.todayButton.label"})),a()(pn.Z,{ariaLabel:s[MI]({id:"database.calendarView.nextMonthButton.label",[GI]:"Next Month"}),mobileFeedback:i[DI],icon:S.Z[xI],[II]:()=>this.handleCalendarClick(TI,o)})),a()("div",{[QI]:{[FI]:OI,[CI]:i[ZP]?8:0,[kI]:`0 1px 0 ${this[SI][bI]}`},[WI]:X.calendarHeaderDays},void 0,(0,bT.kv)(Q.userSettingsStartOfWeekStore[qP],wT.SP).map((e=>{let[t,i]=e;return a()("div",{[QI]:this.getWeekDayNameStyle()},t,i)})))))}renderWeek(e,t,i,o,s,r,n){const{[YP]:l,[yI]:d,schema:h,[fI]:c}=this[XP],u=l[kP]();if(!u)return;const p=this[vI](),{[tD]:m}=this[KP],g=m[qP],v=[...Array(7).keys()].map((t=>this.renderDay(t,(0,kT.addDaysToDate)({date:e,daysToAdd:t}),o,s,r,n))),f=[];let y=0;for(const x of i){const i=Ee.G[pP](u,{table:C.iU,id:x.id});g[LP]&&g[IP]===i&&g[gI]||f.push(a()(Bx,{[YP]:l,[HP]:i,startOfWeek:e,endOfWeek:t,[UI]:x[UI],end:x.end,row:x.row,includeTime:x.includeTime,[yI]:d,schema:h,calendarBy:o,disabled:!p,[tD]:m,[fI]:c,[bP]:this[bP],[TP]:this[TP]},i.id)),x.row>y&&(y=x.row)}const w=g[LP]&&g[gI]&&(0,kT.getDateRange)(g[gI],(0,Qe.r)());if(g[LP]&&g[gI]&&w&&(0,ST.rangeIntersects)(e,t,w[UI],w.end)){const{[IP]:s,[gI]:r}=g,n=i.find((e=>e.id===s.id));f.push(a()(Bx,{[YP]:l,[HP]:s,startOfWeek:e,endOfWeek:t,[UI]:w[UI],end:w.end,row:n?n.row:0,includeTime:"datetime"===r.type||"datetimerange"===r.type,[yI]:d,schema:h,calendarBy:o,disabled:!p,[tD]:m,[fI]:c,[bP]:this[bP],[TP]:this[TP]},s.id))}const S=(d[mI]?d[mI].filter((e=>e.visible)).map((e=>e.property)):[]).length+1,b="week"===r?372:124,k=nD.getPropertyRowHeight()*S+2*sD+2*rD,T=Math.max((y+1)*k+oD+4,b);return a()("div",{[QI]:{...nD.weekWrapStyle,[NP]:T}},e.toString(),v,f)}renderDay(e,t,i,o,s,r){const{[HP]:l,[YP]:d}=this[XP],{[tD]:h}=this[KP],{dayStoreMap:u}=h[qP],p=ne.default[uP](),m=h[qP],g="date"===o.type,v=d[pI]();let f=u.get(t);f||(f=new Ee.G(this[BP],l.pointer,{userId:l.userId,[uI]:l[uI]}),u.set(t,f));const y=!m[LP]&&m.hoveredDay===t,w=(0,kT.areDatesInSameMonth)({firstDate:t,secondDate:this[$I]()}),b=(0,kT.isDateToday)(t),k=(0,kT.isDateWeekend)(t),C=!w&&!b&&"week"!==s,T=p[MI]({[GI]:"Add an item",id:"database.calendarView.addItemButtonTooltip"});return a()(rl.Z,{[QI]:k?this.getWeekendDayStyle():this.getDayStyle(),[HP]:f,canDropOnto:this[vI]()&&g,onSelectableDrop:e=>{z[cI]({[hI]:"Calendar.renderDay",[BP]:this[BP],perform:o=>{const s=d[dI]();if(!s)return;const r=pe.default.mark(aI);pe.default[lI](r,{[BP]:this[BP],getData:()=>J[nI]({[YP]:d,is_native_drop:!1,is_empty:!1})}),B.JN({...e,[BP]:this[BP],startOfDay:t,calendarBy:i,[dI]:s,[YP]:d,[cP]:this[bP][qP],[rI]:o})}})},onDoubleClick:()=>{this[vI]()&&Ke[sI](this[BP])&&v&&(this.createBlockInDay(t,i),D[oI](this[BP],{type:"page",from:"calendar_day_double_click",...(0,J.getCollectionAnalyticsContext)(d)}))},[KI]:"calendar_day",shouldShowDropZone:!0},t.toString(),y&&(g||b)&&v&&this[vI]()&&a()(at.Z,{[iI]:()=>T,render:e=>c[zI](pn.Z,n()({ariaLabel:T,icon:S.Z.plus,showShadow:!0,hasBackground:!0,[QI]:{[wI]:"absolute",top:6,[PI]:6,width:20,[NP]:20},[II]:()=>{Ke[sI](this[BP])&&(this.createBlockInDay(t,i),D[oI](this[BP],{type:"page",from:"calendar_day_add_button",...(0,J.getCollectionAnalyticsContext)(d)}))}},(0,je.Z)(e,{onMouseDown:re.$0})))}),a()("div",{[QI]:{...b?this.getTodayNumberStyle():nD.dayNumberStyle,...C&&{color:this[SI][tI]}},[WI]:r?`${X.calendarViewDay} notion-shimmer-text animation-delay-${e}`:`${X.calendarViewDay}`},void 0,1!==(0,kT.getDateOfMonth)(t)||b?(0,kT.getDateOfMonth)(t):`${new Intl.DateTimeFormat(p.locale,{month:"short",day:eI})[yI](new Date(t))} `))}renderMobileWeek(e,t,i,o){const s=[...Array(7).keys()].map((s=>{const r=(0,kT.addDaysToDate)({date:e,daysToAdd:s});return this.renderMobileDay(r,(0,kT.getEndOfDay)(r),t,i,o)}));return a()("div",{[QI]:this.getMobileWeekStyle()},e.toString(),s)}renderMobileDay(e,t,i,o,s){const{[YP]:r,query:l,[yI]:d,schema:h,[fI]:u}=this[XP],p=this[vI](),m=i.find((i=>(0,ST.rangeIntersects)(e,t,i[UI],i.end?i.end:void 0))),g=(0,kT.getDateOfMonth)(e),v=(0,kT.areDatesInSameMonth)({firstDate:e,secondDate:this[$I]()}),f=(0,kT.isDateToday)(e),y=!v&&!f&&"week"!==s;return a()(tt.ZP,{popupType:tt.Z4.SlideUp,renderOrigin:e=>c[zI](Bo.Z,n()({[QI]:nD.mobileDayButtonStyle},e),a()("div",{[QI]:{...f?nD.mobileTodayNumberStyle:nD.mobileDayNumberStyle,...y&&{color:this[SI][tI]}}},void 0,g),m&&a()("div",{[QI]:this.getMobileDayEventDotStyle()})),render:t=>a()(ce.LazyMobileCalendarDayMenu,{[YP]:r,initialStartOfDay:e,[yI]:d,schema:h,query:l,calendarBy:o,disabled:!p,onDismiss:t.close,[fI]:u,[bP]:this[bP]})},g.toString())}handleCalendarClick(e,t){const i=(0,kT.getEndOfWeek)(t[UP][qP],Q.userSettingsStartOfWeekStore[qP]),o=this[VP](this[XP][YP]);if("month"===o){const t="left"===e?-1:1,s=(0,kT.getStartOfWeek)((0,kT.getStartOfMonth)((0,kT.addMonthsToDate)({date:i,monthsToAdd:t})),Q.userSettingsStartOfWeekStore[qP]);this[EP](s,o)}else{const i="left"===e?-7:7,s=(0,kT.getStartOfWeek)((0,kT.addDaysToDate)({date:t[UP][qP],daysToAdd:i}),Q.userSettingsStartOfWeekStore[qP]);this[EP](s,o)}}handleMount(e){const t=e[kP]();if(!t)return;const i=this.startOfWeekSettingStore[qP];if(void 0===i)return;const o=this[VP](e),s=IT.Z.getLocalDateRangeStart({[Jx]:t.id,[jx]:this[BP].currentUser.id}),r=(0,kT.getStartOfWeek)(s,i),n=(0,kT.getStartOfWeek)((0,kT.getStartOfMonth)(s),i),l="month"===o?n:r;this[KP][tD][FP]({...this[KP][tD][qP],startingMonth:n.valueOf()}),this[EP](l,o)}getHeaderText(e,t,i){var o,s;const r=(0,bT.Yx)(t,"month_year_long",i);if("month"===e)return r;const n=null===(o=this.weeksStore)||void 0===o||null===(s=o[qP])||void 0===s?void 0:s[0];if(void 0===n)return"";if((0,kT.areDatesInSameMonth)({firstDate:n[UI],secondDate:n.end}))return r;return`${(0,bT.Yx)(n[UI],(0,kT.areDatesInSameYear)({firstDate:n[UI],secondDate:n.end})?"month_short":"month_year_short",i)} - ${(0,bT.Yx)(n.end,"month_year_short",i)}`}setDateRange(e,t){const{[YP]:i}=this[XP],{[tD]:o}=this[KP];L.setDateRange({[UP]:e,dateRangeEnd:t,[YP]:i}),o[FP]({...o[qP],startingMonth:(0,kT.getStartOfMonth)((0,kT.getEndOfWeek)(e,Q.userSettingsStartOfWeekStore[qP]))})}findHoveredDay(e,t){W[Yx]();const{dayStoreMap:i}=this[KP][tD][qP],{selectableRectMap:o}=PT.Z[qP],s=Array.from(i.keys()),r=Array.from(i.values());for(const[n,l]of o.entries())if(l&&xT.uh(l,e,t)&&r.indexOf(n[XP][HP])>=0)return s.find((e=>i.get(e)===n[XP][HP]))}createBlockInDay(e,t){const{[YP]:i}=this[XP],{[Xx]:o}=ge.default[qP];z[cI]({[hI]:"Calendar.createBlockInDay",[BP]:this[BP],perform:s=>{const{newStore:r}=E.createBlockInGroup({[BP]:this[BP],[YP]:i,[XI]:[],[cP]:this[bP][qP],insertAtIndex:0,coerce:!0,[qx]:!0,[rI]:s,from:yP});B.xD({type:GP,[BP]:this[BP],[HP]:r,propertyId:t,timestampMs:e,[rI]:s});const n=ie.getPeekModeHref({[HP]:r,[Xx]:o,[YP]:i})??(0,se.ZP)({[HP]:r,pageVisitSource:f.tY.Create});this.navigate(n),O.Xd({[YP]:i,[bP]:void 0})}})}[EP](e,t){const{[YP]:i}=this[XP],o=i[kP]();if(!o)return;const s=this[$P](),r=Q.userSettingsStartOfWeekStore[qP],n=(0,kT.getEndOfWeek)(e,r),l=(0,kT.getStartOfWeek)(e,r);if(IT.Z.setLocalDateRangeStart({[Jx]:o.id,[UP]:"month"===t?n:l,[jx]:this[BP].currentUser.id}),"month"===t){const t=s?(0,kT.getEndOfWeek)((0,kT.addMonthsToDate)({date:n,monthsToAdd:1}),r):(0,kT.getEndOfWeek)((0,kT.getEndOfMonth)(n),r);this.setDateRange(e,t),this[iD]&&s&&(this[iD].scrollTop=0)}else"week"===t&&this.setDateRange(e,n)}[$P](){const{device:e}=this[BP],{[YP]:t}=this[XP],i="month"===this[VP](t);return this[XP][jI]&&!e[DI]&&i}isInMonth(e){const{startOfDay:t,startOfMonth:i}=e;return(0,kT.isDateInMonth)({date:t,startOfMonth:i})}updateOrCreateCalendarProperty(e){const{schema:t}=e,{[YP]:i}=this[XP],o=ne.default[uP](),s=i[dI]();if(!s)return;const r=i[kP]();r&&z[cI]({[hI]:"Calendar.updateOrCreateCalendarProperty",[BP]:this[BP],perform:e=>{let i,n=ie.findCalendarProperty(t);if(!n){n=(0,Fe.ZP)();i={[n]:{name:o[MI]({id:"database.calendarView.dateProperty.defaultName",[GI]:"Date"}),type:"date"}}}L[Qx]({[kP]:r,update:{[lP]:n},[rI]:e}),i&&L[$x]({[BP]:this[BP],[dI]:s,update:i,[rI]:e})}})}[vI](){const e=this[XP][YP][aP][qP];return this.canEdit()&&e.canEditContent}[NI](){var e;const{[YP]:t,[Ux]:i}=this[XP],o=(null===(e=t[zx][qP])||void 0===e?void 0:e[Kx])||(i?this[SI][Wx]:this[SI][Hx]);return{[wI]:Gx,[PI]:0,[TI]:0,[Kx]:o,zIndex:I.collectionStickyTopElement}}getHeaderMobileStyle(){return{[wI]:Gx,[PI]:0,[TI]:0,[Kx]:this[SI][Hx],zIndex:I.collectionStickyTopElement}}getRowsWrapStyle(){return{[kI]:`-1px 0 0 ${this[SI][bI]}`,[CI]:1,overflow:"hidden"}}getWeekDayNameStyle(){return{flexGrow:1,flexBasis:0,[Nx]:LI,[ZI]:12,[NP]:24,color:this[SI][tI]}}getDayStyle(){return{[wI]:Fx,flexGrow:1,flexShrink:0,flexBasis:0,borderRight:`1px solid ${this[SI][bI]}`,borderBottom:`1px solid ${this[SI][bI]}`,cursor:"default"}}getWeekendDayStyle(){return{...this.getDayStyle(),[Kx]:this[XP][Ux]?this[SI].cardSidebarBackground:this[SI].sidebarBackground}}getTodayNumberStyle(){return{[wI]:Gx,[ZI]:14,top:4,[TI]:4,[NP]:24,width:24,[BI]:"24px",[Ox]:"100%",[Nx]:LI,color:yh.ZP.white,[Kx]:this[SI].calendarTodayBackground}}getMobileWeekStyle(){return{[FI]:OI,[kI]:`0 -1px 0 ${this[SI][bI]}`,paddingTop:8,[tP]:8,[ZI]:14}}getMobileDayEventDotStyle(){return{width:8,[NP]:8,[Kx]:this[SI].mediumIconColor,[Ox]:"100%",[CI]:2,[EI]:"auto",[RI]:"auto"}}[VP](e){const t=e[kP](),i=null==t?void 0:t.getFormatStore();return(null==i?void 0:i.getKeyStore("calendar_view_range").getValue())??"month"}[$I](){const e=this[XP][YP][UP][qP];return this[$P]()||!e?this[KP][tD][qP].startingMonth:(0,kT.getStartOfMonth)((0,kT.getEndOfWeek)(e,Q.userSettingsStartOfWeekStore[qP]))}}nD.contextTypes={...$.wK,...p.w},nD[QI]={[wI]:Fx,[eP]:1},nD.viewRangeSelectorButtonStyle={[RI]:6,[JI]:6},nD.headerSpacerStyle={[NP]:66},nD.mobileHeaderSpacerStyle={[NP]:74},nD.mobileRowsWrapStyle={},nD.weekWrapStyle={[wI]:Fx,[FI]:OI},nD.dayNumberStyle={[wI]:Gx,[ZI]:14,top:4,[TI]:10,[NP]:24,[BI]:"24px",[Nx]:TI,transition:"color 100ms ease-out"},nD.mobileDayButtonStyle={width:"100%",[NP]:44,[Ox]:3},nD.mobileDayNumberStyle={[NP]:28,[FI]:OI,[_I]:LI,justifyContent:LI},nD.mobileTodayNumberStyle={[NP]:28,width:28,[BI]:"28px",[Ox]:"100%",[Nx]:LI,color:yh.ZP.white,[Kx]:yh.ZP.red,[EI]:"auto",[RI]:"auto"},nD.loadingSpinnerStyle={margin:"8px auto"};const lD=nD;var aD=i(6776);const dD=i(85).LIR,hD=i(85).q$s,cD=i(85).sP9,uD=i(85).P24,pD=i(85).wgE;function mD(e){const{[pD]:t,newStore:i,previousStore:o}=e;W.edit({[pD]:t,store:i}),L.setSelection({store:i}),aD.Z.setState({store:i,editMode:"new",previousStore:o})}var gD=i(37190);const vD=i(85).xej,fD=i(85).tvI,yD=i(85).XqV,wD=i(85).tDk,SD=i(85).voC,bD=i(85).YfV,kD=i(85).aKz,CD=i(85).Zij,TD=i(85).GGR,xD=i(85).gdQ,ID=i(85).yzD,PD=i(85).lWm,DD=i(85).KS0,MD=i(85).Scd,ZD=i(85).Vgm,BD=i(85).z$9,RD=i(85).sI1,ED=i(85).Dg8,VD=i(85).g7N,AD=i(85).nLZ,LD=i(85).EMU,_D=i(85).Lv6,OD=i(85).M34,FD=i(85).AQx,ND=i(85).JbR,GD=i(85).yfk,HD=i(85).Vtz,WD=i(85).b4U,KD=i(85).EIp,zD=i(85).kA0,UD=i(85).YSw,$D=i(85).T4J,QD=i(85).W1o,qD=i(85).Wp_,XD=i(85).Gnd,YD=i(85).i7F,jD=i(85).LCr,JD=i(85).nxU,eM=i(85).wgE,tM=i(85).Drs,iM=i(85).JJj,oM=i(85).xrO,sM=i(85).kId,rM=i(85).BQ6,nM=i(85).Hco,lM=i(85).PXg,aM=i(85).XCs,dM=i(85).YDv,hM=i(85).ChN,cM=i(85).Au,uM=i(85).TEz,pM=i(85).jkI,mM=i(85).H1U,gM=i(85).rOg,vM=i(85).sM5,fM=i(85).MpA,yM=i(85).xKX,wM=i(85).PG2,SM=i(85).oWD,bM=i(85).ffk,kM=i(85).VFU,CM=i(85).RSd,TM=i(85).qGZ,xM=i(85).bxj,IM=i(85).QvG,PM=i(85).qU4,DM=i(85).rQ1,MM=i(85).QmD,ZM=i(85).Wo8,BM=i(85).Aw$,RM=i(85).NRr,EM=i(85).P0R,VM=i(85).P24,AM=i(85).$pZ,LM=i(85).pkR,_M=i(85).XtO,OM=i(85).$Jh,FM=i(85).M82;class NM extends Le.Z{constructor(){super(...arguments),this.storeTypes={[FM]:Pe.Z},this[OM]=e=>{const{[_M]:t,[LM]:i,[AM]:o,[VM]:s}=this[EM],r=t[RM]();if(r)return a()(Do.Z,{[_M]:t,[bM]:e,[LM]:i||!t[BM](),locked:s[DM][MM][ZM],format:Mo.C.ListView,tableWrap:!1,[AM]:o,[SM]:r,[PM]:this[EM][VM][PM](),showIfEmpty:this[IM][MM],onBgClick:this[xM],onEnter:this[xM],onEsc:this[xM],onTab:this[TM],onUntab:this[CM],[wM]:this[kM]},e)},this.renderDiscussionIndicator=()=>{const{[_M]:e}=this[EM],t=Vi[yM](e,{[fM]:!1});if(t>0)return a()("div",{[rM]:{[vM]:gM,[mM]:pM,color:this[cM][uM],[hM]:x.Z[hM].semibold,fontSize:12,[dM]:10,[aM]:10}},void 0,S.Z.speechBubble({width:14,height:14,[lM]:4,fill:this[cM][nM]}),t)},this[sM]=()=>{this[kM](),this[EM][sM]()},this[oM]=e=>{const{[_M]:t}=this[EM],i=t.getIconStore();i&&z[iM]({[tM]:"CollectionListViewItem.handleRecordIconChange",[eM]:this[eM],[JD]:t=>{Bi.setValue({[_M]:i,value:e,[jD]:t})}})},this[YD]=()=>{if(!Te.Z[MM]){const{[FM]:e}=this[XD];e[qD]({...e[MM],[QD]:!0})}},this[$D]=()=>{const{[FM]:e}=this[XD];e[qD]({...e[MM],[QD]:!1})},this[UD]=(0,d.throttle)(this[YD],100),this[zD]=(0,d.debounce)(this[$D],100),this.mouseIsEntered=this[KD]((()=>this[XD][FM][MM][QD])),this[IM]=this[KD]((()=>{const e=Ai.Z[MM];return Boolean(e.isActive&&e[_M].id===this[EM][_M].id)})),this.newItemEditMode=this[KD]((()=>{const e=aD.Z[MM];return e[_M]&&e[_M].id===this[EM][_M].id?e.editMode:void 0})),this.newItemPreviousStore=this[KD]((()=>{const e=aD.Z[MM];return e[_M]&&e[_M].id===this[EM][_M].id?e.previousStore:void 0})),this.removeCollectionListViewItem=e=>{z[iM]({[tM]:"CollectionListViewItem.handleItemTextEsc",[eM]:this[eM],[JD]:t=>{E.remove({[_M]:e,[jD]:t})}})},this[kM]=()=>{L[kM]({[_M]:this[EM][_M]})},this[xM]=()=>{Zi.close({[eM]:this[eM],[AM]:this[EM][AM]}),W.select({[eM]:this[eM],[_M]:this[EM][_M]}),this[kM]()},this.handleTitleTab=()=>{const e=this[WD](),t=this[HD](e);this.handleTitleTabShortcuts(t)},this[GD]=()=>{const e=this[WD](),t=this.findLastOpenableProperty(e);this.handleTitleTabShortcuts(t)},this[TM]=()=>{const e=this.findNextOpenableProperty();this[ND](e)},this[CM]=()=>{const e=this.findPreviousOpenableProperty();this[ND](e)},this.shouldCaptureKeyboard=this[KD]((()=>_i.default[MM][XD].length>0&&_i.default[MM][XD][0].id===this[EM][_M].id))}activate(){const e=this.getPeekUrl();e&&(this[EM][sM](),N.navigate({[eM]:this[eM],url:e}))}didMount(){super.didMount(),this[IM][MM]&&"new"===this.newItemEditMode[MM]&&K[FD]({[_M]:this[EM][_M][OD]()})}willUnmount(){super.willUnmount(),aD.Z.reset(),Ai.Z.reset()}renderComponent(){const{device:e}=this[eM],{showProperties:t}=this[EM],i=e.isPhone&&this[EM].showProperties.length>0,o=this[_D]();return i?a()("div",{[rM]:{[vM]:LD}},void 0,o,a()(Eo.Z,{href:this.getBlockUrl(),metaHref:this.getPeekUrl(),external:!1,[rM]:this.getTwoLineMobileWrapStyle(),[RD]:{[aM]:4,[AD]:10,[VD]:10}},void 0,a()("div",{[rM]:{[vM]:LD,[mM]:pM}},void 0,this[ED]()),a()("div",{[rM]:{[vM]:LD,[mM]:pM,[dM]:6,[AD]:4}},void 0,t.map(this[OM])))):a()(Ro.Z,{capture:this.shouldCaptureKeyboard[MM],onShiftEnter:this[EM].onShiftEnter},void 0,a()("div",{[rM]:{[vM]:LD}},void 0,o,a()(Eo.Z,{href:this.getBlockUrl(),metaHref:this.getPeekUrl(),[wM]:this[sM],external:!1,[rM]:this.getInlineWrapStyle(this[IM][MM]?"multi":"single"),[RD]:{[vM]:LD,[mM]:pM,[aM]:4,userSelect:this[IM][MM]?void 0:BD,[ZD]:this[IM][MM]?void 0:BD},[xD]:{[MD]:this[IM][MM]?DD:this[cM][PD]},pressedStyle:{[MD]:this[IM][MM]?DD:this[cM][ID]},[TD]:this[UD],onMouseMove:this[UD],onMouseLeave:this[zD]},void 0,this[ED](),t.map(this[OM]))))}[ED](){const{[_M]:e,[LM]:t,[VM]:i,[AM]:o}=this[EM],s=e[RM]();if(!s)return;const{isSyncedCollection:r}=i[DM][MM];return a()(Do.Z,{[_M]:e,[bM]:r?" title":CD,[LM]:t||!e[BM](),locked:i[DM][MM][ZM],format:Mo.C.ListView,tableWrap:!1,[AM]:o,[SM]:s,[PM]:i[PM](),forceMouseEntered:this.mouseIsEntered[MM],[sM]:this[sM],onTab:this.handleTitleTab,onUntab:this[GD]})}[_D](){const{[VM]:e,toggleButton:t,subitemPath:i}=this[EM],o=e[kD][MM],s=(null==i?void 0:i.length)??0;if(!o)return;const r=Math.max((s-1)*tl.Hw,0)+tl.gY;return t?a()("div",{[rM]:{paddingTop:4,[vM]:LD}},void 0,a()("div",{[rM]:{width:r}}),t):a()("div",{[rM]:{minWidth:r+tl.Hw}})}[ND](e){const{[_M]:t,[AM]:i}=this[EM];if(i[MM].isOpen){if("title"===e){Zi.close({[eM]:this[eM],[AM]:i});const e=t[OD]();W.edit({[eM]:this[eM],[_M]:t}),K[FD]({[_M]:e})}else e?(Zi.close({[eM]:this[eM],[AM]:i}),Zi.open({[eM]:this[eM],[AM]:i,[_M]:t,[bM]:e,format:Mo.C.ListView,[VM]:this[EM][VM]})):Zi.close({[eM]:this[eM],[AM]:i});this[kM]()}}handleTitleTabShortcuts(e){e&&Zi.open({[eM]:this[eM],[AM]:this[EM][AM],[_M]:this[EM][_M],[bM]:e,format:Mo.C.ListView,[VM]:this[EM][VM]}),this[kM]()}findPreviousOpenableProperty(){const{[AM]:e}=this[EM],t=e[MM],i=this[WD](),o=t.isOpen?i.findIndex((e=>e===t[bM])):-1,s=h().findLast(i,((e,t)=>t<o&&this[bD](e)));return s||(this[IM][MM]?CD:this.findLastOpenableProperty(i))}findNextOpenableProperty(){const{[AM]:e}=this[EM],t=e[MM],i=this[WD](),o=t.isOpen?i.findIndex((e=>e===t[bM])):-1,s=i.find(((e,t)=>t>o&&this[bD](e)));return s||(this[IM][MM]?CD:this[HD](i))}findLastOpenableProperty(e){return h().findLast(e,(e=>this[bD](e)))}[HD](e){return e.find((e=>this[bD](e)))}[bD](e){const{schema:t}=this[EM],i=t[e];return Boolean(i&&!Ii.noPropertyValueOverlayTypes.includes(i.type))}[WD](){const{[_M]:e,schema:t,showProperties:i}=this[EM];return e.isDefined()?i.filter((i=>{const o="title"!==i&&this[IM][MM];return!Hi.valueIsEmpty({[bM]:i,schema:t,block:e.getModel(),[SD]:e[SD],userId:this[eM].currentUser.id,userTimeZone:(0,Qe.r)(),intl:ne.default.getIntl()})||o})):[]}getPeekUrl(){const{[_M]:e,[VM]:t}=this[EM],{[wD]:i}=ge.default[MM];return ie.getPeekModeHref({[_M]:e,[wD]:i,[VM]:t,[yD]:!1})}getBlockUrl(){return(0,se.ZP)({[_M]:this[EM][_M],[yD]:!1,pageVisitSource:f.tY.LinkInPage})}getInlineWrapStyle(e){return{[vM]:LD,flexGrow:1,[fD]:BD,overflow:"hidden",borderRadius:3,..."single"===e?{height:30}:{minHeight:30}}}getTwoLineMobileWrapStyle(){return{flexGrow:1,[fD]:BD,overflow:"hidden",borderBottom:`1px solid ${this[cM][vD]}`}}getTitleWrapStyle(){const{device:e}=this[eM];return{[vM]:LD,[lM]:"auto",minWidth:e.isMobile?0:240}}getTitleStyle(){return{[hM]:x.Z[hM].medium,borderBottom:`1px solid ${this[cM][vD]}`,lineHeight:1.3}}}NM.iconStyle={marginLeft:2,[lM]:6};const GM=NM,HM=i(85).nx5,WM=(i(85).wH1,i(85).TEz),KM=i(85).g9q,zM=i(85).qU4,UM=i(85).wgE,$M=i(85).oWD,QM=i(85).sP9,qM=i(85).P24;function XM(e){window.__c={n:"CollectionNestedCreateSubitemButton"};const t=(0,qn.O7)(),{store:i,[qM]:o,disabled:s,[QM]:r,[$M]:n,subitemPath:l,indentLevel:d,onSubitemCreate:h}=e,u=(0,Xn.VK)((()=>(0,ie.shouldShowBulkActionsToolbar)({[UM]:t,[qM]:o})),[o,t]),p=(0,Xn.VK)((()=>{var e;return"timeline"===(null===(e=o[zM]())||void 0===e?void 0:e.getType())}),[o]),m=(0,Xn.VK)((()=>{var e;return(0,q.$4)()&&"title"===(null===(e=o[zM]())||void 0===e?void 0:e.getFormat()[KM])}),[o]),g=(0,Xn.VK)((()=>(0,il.f2)({columnIndex:0,titleColumnIndex:0,shouldShowBulkActionsToolbar:u,indentLevel:d+1,isSubitemToggleOnTitleColumn:m})),[d,m,u]),v=(0,Yn.yK)((t=>({newRowButton:{display:"flex",alignItems:"center",height:32,width:"100%",paddingLeft:g+8,fontSize:14,lineHeight:x.Z.lineHeight.UIRegular.desktop,borderBottom:`1px solid ${t.tableDividerColor}`,background:t.contentBackground,left:0,right:0,...p&&{background:"none",borderTop:"none"},...e.styles},newRowContainer:{display:"inline-flex",alignItems:"center",position:"sticky",left:g+8,color:t[WM]},newIcon:{width:14,height:14,marginLeft:-1,marginRight:6,fill:t.lightIconColor},newText:{color:t[WM]}})),[g,p,e.styles]),f=(0,Xn.VK)((()=>{const e=o.permissionScopes.state,t=n.isSyncedCollection();return!s&&e.canEditContent&&!t}),[o,s,n]),y=(0,c.useCallback)((()=>{z.createAndCommit({userAction:"CollectionNestedCreateSubitemButton.handleClick",[UM]:t,perform:e=>{var s;const a=null===(s=o.groupsStore.getGroupState(r))||void 0===s?void 0:s.resultsStore,d=E.insertNewBlock({[UM]:t,[qM]:o,[QM]:r,results:(null==a?void 0:a.state)??[],store:i,before:!1,[$M]:n,transaction:e,subitemPath:l,subitemInsertDirection:"into"});d&&h(d)}}),D.trackTableSubItemCreate(t)}),[o,t,r,n,i,l,h]);return f?a()(Bo.Z,{onClick:y,onMouseDown:re.$0,style:v.newRowButton},void 0,a()("span",{style:v.newRowContainer},void 0,S.Z.plus(v.newIcon),a()("span",{style:v.newText},void 0,a()(P.FormattedMessage,{[HM]:"New sub-item",id:"database.tableView.nest.addSubitem"})))):null}const YM=i(85).$Vg,jM=i(85).$bT;function JM(e){window.__c={n:"ListShimmer"};const{isFullScreen:t,hasGroups:i,hasPartialResults:o,hasSearchQuery:s}=e;if(!(0,vy.Z)(!0,0,100))return null;let r=1;i||o||s||(r=t?10:3);const n=h().times(r).map((e=>a()(ES,{},e)));return a()("div",{style:{display:"flex",[jM]:"column",alignItems:YM,alignSelf:"stretch",marginLeft:3}},void 0,n)}const eZ=i(85).uRL,tZ=i(85).KzW,iZ=i(85).nx5,oZ=i(85).TEz,sZ=i(85).pF2,rZ=i(85).NF1,nZ=i(85).$Fm,lZ=i(85).ncO,aZ=i(85).vK9,dZ=i(85).qdS,hZ=i(85).XCs,cZ=i(85).YDv,uZ=i(85).GmX,pZ=i(85).EIp,mZ=i(85).mV8,gZ=i(85).iKt,vZ=i(85).vX_,fZ=i(85)._2_,yZ=i(85).Ylz,wZ=i(85).qU4,SZ=i(85).xd5,bZ=i(85).LIR,kZ=i(85).jDA,CZ=i(85).aV8,TZ=i(85).ixe,xZ=i(85).Ttb,IZ=i(85).LCr,PZ=i(85).nxU,DZ=i(85).Drs,MZ=i(85).JJj,ZZ=i(85).vTv,BZ=i(85).RH8,RZ=i(85).wgE,EZ=i(85).xYh,VZ=i(85).m3I,AZ=i(85).tBn,LZ=i(85).yT5,_Z=i(85).g7N,OZ=i(85).nLZ,FZ=i(85).Au,NZ=i(85).xej,GZ=i(85).Lbv,HZ=i(85).bSA,WZ=i(85).GCx,KZ=i(85).oWD,zZ=i(85).Wp_,UZ=i(85).p2z,$Z=i(85).GPw,QZ=i(85).fBu,qZ=i(85).wu4,XZ=i(85).y79,YZ=i(85).uzK,jZ=i(85).Mm1,JZ=i(85).sP9,eB=i(85).piL,tB=i(85).TtP,iB=i(85).bQB,oB=i(85).Aw$,sB=i(85).k9$,rB=i(85).gNE,nB=i(85).rQ1,lB=i(85).BpM,aB=i(85).KNN,dB=i(85).QmD,hB=i(85).Iol,cB=i(85).P0R,uB=i(85).$pZ,pB=i(85).Kiu,mB=i(85).P24,gB=i(85).pkR,vB=i(85).MAy,fB=i(85).urI,yB=i(85).XtO,wB=i(85).D7I,SB=i(85).XDJ,bB=i(85).odo;class kB extends p.Z{constructor(){super(...arguments),this[bB]=e=>c[wB](mf,n()({},e,{height:48,getComputedStickyStyle:this[SB]})),this.renderGroup=e=>{const{[yB]:t,[fB]:i,[vB]:o,[gB]:s,[mB]:r,[pB]:n,[uB]:l}=this[cB],d=e?[e]:[],h=this[hB](),u=this.isReady[dB],p=r[lB][aB](d);if(!p)return;const m=r[nB][dB],g=p[rB][dB],v=m[sB],f=ie.shouldRenderLoadMoreButton({[mB]:r,reducerResult:g,[vB]:o}),y=u&&!s&&t[oB]()&&m[iB]&&!v,w=!s&&t[oB]()&&m[iB]&&!v,S=void 0!==g&&(null==g?void 0:g.blockIds[tB])>0,b=""!==r[eB][dB],k=void 0!==e,C=ff({[mB]:r,[JZ]:d});return a()("div",{style:{[jZ]:e?16:void 0}},void 0,a()(dd,{[mB]:r,[JZ]:d,[fB]:i,canDrag:w,resultProps:{[pB]:n,[YZ]:this[cB][yB],showProperties:h,[gB]:s,[uB]:l,[mB]:r,onShiftEnter:()=>this.onItemShiftEnter(p)},canDrop:!0,resultComponent:GM,[gB]:s,shouldShowHoverMenu:!0,[WZ]:ld[XZ],[HZ]:"list",[qZ]:this[qZ],emptyDroppableSize:0,onSelectableInsertRow:this.onSelectableInsertRow,nestedCreateSubitemButton:e=>{const{[yB]:t,[QZ]:i,subitemPath:o,indentLevel:n}=e;if(i)return a()(XM,{[yB]:t,[KZ]:i,subitemPath:o,indentLevel:n,[mB]:r,[gB]:s,[JZ]:d,styles:{[$Z]:void 0,borderTop:void 0},onSubitemCreate:e=>{L[UZ]({[yB]:e,transient:!1}),aD.Z[zZ]({[yB]:e,editMode:"new",previousStore:void 0})}})}}),C&&a()(JM,{[vB]:o,hasGroups:k,hasPartialResults:S,hasSearchQuery:b}),f&&a()(Qn,{[JZ]:d,[yB]:t,[mB]:r,[fB]:i,[vB]:o,[GZ]:!1}),y&&c[wB](c[AZ],null,f&&a()("div",{style:{width:"100%",borderTop:e?void 0:`1px solid ${this[FZ][NZ]}`,[OZ]:4,[_Z]:4}}),this[LZ](p)))},this[VZ]=e=>{const{[mB]:t,[vB]:i}=this[cB],o=t[EZ][dB],s=t[lB][aB]([]);if(!s)return;const r=s[rB][dB];e<ye.Z.incrementScrollOffset&&r&&!o&&r.hasMore&&E.incrementBlockLimit({[mB]:t,[RZ]:this[RZ],incrementLimitArgs:{[vB]:i,currentResultCount:r.blockIds[tB],[JZ]:[],[GZ]:!1}})},this[BZ]=e=>{if(!Ke[ZZ](this[RZ]))return;const{[mB]:t}=this[cB];t[KZ]()&&z[MZ]({[DZ]:"CollectionListView.handleAddItemClick",[RZ]:this[RZ],[PZ]:i=>{t[KZ]()&&function(e){const{transaction:t,[pD]:i,results:o,resultsStore:s,[uD]:r,isFullScreen:n,[cD]:l,insertAtIndex:a,from:d}=e;let h;r.searchQuery.state&&L.updateSearchQuery({searchQuery:"",[uD]:r,isFullScreen:n}),a>0&&(h=o[a]);const{newStore:c,coercionSucceeded:u}=E.createBlockInGroup({[pD]:i,[uD]:r,[cD]:l,results:o,insertAtIndex:a,coerce:!0,[hD]:!0,transaction:t,from:d});i.device.isMobile?N.navigateToBlock({[pD]:i,store:c,[dD]:f.tY.Create}):u?mD({[pD]:i,newStore:c,previousStore:h}):N.peekBlock({[pD]:i,store:c,peekMode:(0,ie.getPeekMode)(r.collectionViewStore()),resultsStore:s,[uD]:r,[dD]:f.tY.Create}),D.trackCreateBlock(i,{from:d,type:"page",new_page_id:c.id,...(0,J.getCollectionAnalyticsContext)(r)})}({[IZ]:i,[RZ]:this[RZ],[xZ]:e[TZ][dB],[TZ]:e[TZ],[mB]:t,[vB]:this[cB][vB],[JZ]:e[JZ],insertAtIndex:e[TZ][dB][tB],from:"list_view_add_item_bottom"})}})},this[CZ]=(e,t,i)=>{if(this[RZ].device.isMobile)N[kZ]({[RZ]:this[RZ],[yB]:e,[bZ]:f.tY.Create});else if(t)mD({[RZ]:this[RZ],newStore:e,previousStore:void 0});else{const{[mB]:t}=this[cB],{[SZ]:o}=i,s=o?[o]:[],r=t[lB][aB](s);N.peekBlock({[RZ]:this[RZ],[yB]:e,peekMode:ie.getPeekMode(t[wZ]()),[TZ]:null==r?void 0:r[TZ],[mB]:t,[bZ]:f.tY.Create})}},this.onItemShiftEnter=e=>{const{[mB]:t}=this[cB],i=t[KZ]();if(!i||!t[yZ]())return;const o=_i.default[dB].stores[0];if(!o)return;const s=t[fZ][dB],r=(0,el.DY)(s.children,(e=>e.value[yB]===o));if(!r)return;const n=r?(0,tl.Af)(r.map((e=>e.value[yB]))):"",l=t[vZ][dB].get(n),a=Boolean(null==l?void 0:l[gZ]);z[MZ]({[DZ]:"CollectionListView.onItemShiftEnter",[RZ]:this[RZ],[PZ]:s=>{const n=E.insertNewBlock({[RZ]:this[RZ],[mB]:t,[JZ]:e[JZ],[xZ]:e[TZ][dB],[yB]:o,before:!1,[KZ]:i,[IZ]:s,subitemPath:r,subitemInsertDirection:a?"into":"below"});n&&mD({[RZ]:this[RZ],newStore:n,previousStore:o})}}),D.trackCollectionItemEditModeEnter(this[RZ],mZ,{...(0,J.getCollectionAnalyticsContext)(t),block_id:o.id,from:"shiftEnter",view_type:"list"})},this.onSelectableInsertRow=(e,t)=>{mD({[RZ]:this[RZ],newStore:t,previousStore:e})},this.isReady=this[pZ]((()=>{const{[mB]:e}=this[cB];return e[lB].anyGroupHasResults()})),this[qZ]=()=>kB.itemSelectableStyle,this.getGroupStyle=e=>0===e.index?{}:{borderTop:`1px solid ${this[FZ][NZ]}`},this[SB]=e=>({boxShadow:e?`0 -1px 0 ${this[FZ][uZ]}`:void 0})}renderComponent(){const{[yB]:e,[fB]:t,[jZ]:i,[cZ]:o,[hZ]:s,[vB]:r,[mB]:l}=this[cB],d=ie.shouldUseLoadMoreButton(l,r),h=t[dZ];return(0,He.Z)((t=>a()("div",{style:{[jZ]:i,[cZ]:o,[hZ]:s,[aZ]:this[cB][aZ]},className:X.listView},void 0,c[wB](rl.Z,n()({[yB]:e,shouldShowHalo:!r,canSelect:!r,[HZ]:"list",style:this[lZ]()},t),h?this.renderGroups(h):this.renderGroup(void 0)),!d&&a()(hd.Z,{onChange:this[VZ]}))))}renderGroups(e){const{[yB]:t,[fB]:i,[mB]:o,[pB]:s,[gB]:r,[vB]:n,[cZ]:l,isRootChild:d,[nZ]:h}=this[cB];return a()(Tk,{[yB]:t,id:"list_groups",groupBy:e,groupsFormatKey:_e.Uh,groupAggregationKey:_e.dQ,[fB]:i,[pB]:s,[mB]:o,[gB]:r,[vB]:n,renderGroup:this.renderGroup,renderHeader:this[bB],getGroupStyle:this.getGroupStyle,onGroupHeaderAddItem:this[CZ],[cZ]:l,isRootChild:d,[nZ]:h,onSelectableInsertRow:this.onSelectableInsertRow})}[LZ](e){return c[wB](Bo.Z,{onClick:()=>this[BZ](e),onMouseDown:re.$0,ref:e=>{e&&gD.registerElementForShadowCursor("db-new-in-list",e)},style:{display:"flex",alignItems:"center",height:30,[rZ]:3,fontSize:14}},S.Z.plus(this[sZ]()),a()("div",{style:{color:this[FZ][oZ]}},void 0,a()(P.FormattedMessage,{[iZ]:"New",id:"database.listView.addItemButtonTitle"})))}[hB](){const{[fB]:e}=this[cB];return(e[tZ]?e[tZ]:[]).filter((e=>e.visible)).map((e=>{let{property:t}=e;return t}))}navigate(e){this.context[eZ]?this.context[eZ](e):N.navigate({[RZ]:this[RZ],url:e})}[lZ](){const{[fB]:e}=this[cB];return{display:"flex",flexDirection:"column",paddingTop:e[dZ]?void 0:8,[jZ]:4}}[sZ](){return{width:14,height:14,marginLeft:4,marginRight:6,fill:this[FZ].lightIconColor}}}kB.displayName="CollectionListView",kB.contextTypes={...$.wK,...p.w},kB.itemSelectableStyle={[OZ]:1,[_Z]:1,[rZ]:3};const CB=kB;var TB=i(33665);class xB extends v.default{getInitialState(){return{query:"",limit:20}}}const IB=xB;var PB=i(81870),DB=i(26909),MB=i(44514),ZB=i(45669),BB=i(11470);const RB=i(85).tDk,EB=i(85).XCs,VB=i(85).YDv,AB=i(85).NF1,LB=i(85).jkI,_B=i(85).H1U,OB=i(85).Dd5,FB=i(85).cZW,NB=i(85).dLQ,GB=i(85).Yzm,HB=i(85).Dg8,WB=i(85).wgE,KB=i(85).piL,zB=i(85).UgH,UB=i(85).mUE,$B=i(85).ffk,QB=i(85).EIp,qB=i(85).xYh,XB=i(85).P24,YB=i(85).m3I,jB=i(85).Wp_,JB=i(85).GPG,eR=i(85).j7K,tR=i(85).D7I,iR=i(85).Ttb,oR=i(85).y79,sR=i(85).Zij,rR=i(85).HFP,nR=i(85).QmD,lR=i(85).Gnd,aR=i(85).P0R,dR=i(85).YDe,hR=i(85).wfR,cR=i(85).p6m,uR=i(85).XtO,pR=i(85).nx5,mR=i(85).N6T,gR=(0,P.defineMessages)({[mR]:{[pR]:"Search for a page…",id:"collectionNoDateMenu.searchPlaceholder"}});class vR extends p.Z{constructor(){super(...arguments),this.storeTypes={[uR]:IB,[cR]:v.default[hR](void 0)},this.renderResults=()=>{const{[dR]:e}=this[aR],{[uR]:t}=this[lR],{query:i}=t[nR],o=this[rR](),s=a()(P.FormattedMessage,"calendar"===e?{[pR]:"Click to add to the calendar",id:"collectionNoDateMenu.addResultToCalendar.prompt"}:{[pR]:"Click to add to the timeline",id:"collectionNoDateMenu.addResultToTimeline.prompt"});return o?o&&0===o.blockIds.length?a()(lt.Z,{[sR]:s},void 0,a()(uu.Z,{[sR]:a()(P.FormattedMessage,{[pR]:"No results",id:"collectionNoDateMenu.noResults.title"})})):a()(ot.Z,{type:ot.i[oR],sections:[{key:iR,render:e=>c[tR](lt.Z,n()({},e,{[sR]:s})),items:this.getMenuListItems(o.blockIds)}],[eR]:i?0:void 0}):a()(lt.Z,{[sR]:s,loading:!0},void 0,a()(uu.Z,{[sR]:a()(P.FormattedMessage,{[pR]:"Loading…",id:"collectionNoDateMenu.loading.message"})}))},this[JB]=e=>{this[lR][uR][jB]({query:e.target.value,limit:vR.loadMoreIncrement})},this[YB]=e=>{const{[XB]:t}=this[aR],{[uR]:i}=this[lR],o=this[rR](),s=i[nR].limit,r=t[qB][nR];e<vR.loadMoreScrollOffset&&o&&o.hasMore&&!r&&i[jB]({...i[nR],limit:s+vR.loadMoreIncrement})},this.reducerStore=this[QB]((()=>{const{[$B]:e}=this[aR],{[uR]:t}=this[lR],{query:i,limit:o}=t[nR];return{type:iR,filter:{[UB]:"and",filters:[{[$B]:e,filter:{[UB]:zB}}]},limit:o,[KB]:i}}))}renderComponent(){const{[XB]:e}=this[aR],{device:t}=this[WB],{[uR]:i,[cR]:o}=this[lR],{query:s}=i[nR];return a()(DB.ZP,{[sR]:this[HB](),onCancel:this[aR].onClose,helpButton:a()(PB.Z,{helpButtonContext:"collection_no_date_menu",href:(0,TB.getLocalizedUrl)("guides.databaseCalendar")}),desktopWidth:450},void 0,a()(lt.Z,{isInput:!0},void 0,a()(hu.ZP,{[FB]:ne.default[GB](gR[mR]),focus:!t[NB]||void 0,focusAfterAnimation:!0,value:s,[OB]:this[JB]})),a()(Je.Z,{id:"no_date_results",reducer:this.reducerStore[nR],[XB]:e,render:this.renderResults,[cR]:o}),a()(hd.Z,{[OB]:this[YB]}))}[HB](){const{noDateTotal:e}=this[aR];return this[WB].device[NB]?a()(P.FormattedMessage,{[pR]:"Pages with no date",id:"collectionNoDateMenu.mobileMenuTitle"}):a()(MB.Q,{prefix:a()(P.FormattedMessage,{[pR]:"{noDateTotal, plural, one {{noDateTotal} page with no date in} other {{noDateTotal} pages with no date in}}",id:"collectionNoDateMenu.pagesWithNoDateInPrefix",values:{noDateTotal:e}}),viewType:this[aR][dR],viewName:a()(ZB.Z,{collectionViewName:this[aR].collectionViewName,[dR]:this[aR][dR]})})}renderMenuListItem(e,t,i){const{device:o}=this[WB];return c[tR](BB.Z,n()({},e,{[uR]:t,hidePath:!0,right:a()(Eo.Z,{href:i,innerStyle:{display:"flex",[_B]:LB,[AB]:3,[VB]:o[NB]?8:6,[EB]:o[NB]?8:6,height:o[NB]?44:22},onClick:()=>{D.trackCollectionNoDateMenuView(this[WB])}},t.id,a()(P.FormattedMessage,{[pR]:"View",id:"collectionNoDateMenu.view.button.label"})),dontShrinkRight:!0}))}getMenuListItems(e){const{collectionStore:t,[$B]:i}=this[aR],o=e.map((e=>Ee.G.createChildStore(t,{table:C.iU,id:e}))).filter((e=>!Hi.toDateValue(e.getPropertyStore(i).getValue()))).map((e=>{const{[RB]:t}=ge.default[nR];if(!t)return;const i=(0,se.ZP)({[uR]:t,peekViewBlockId:e.id,pageVisitSource:f.tY.LinkInPage});return{key:e.id,render:t=>this.renderMenuListItem(t,e,i),action:()=>{this[aR].onAddPage(e),D.trackCollectionNoDateMenuAdd(this[WB])}}}));return h().compact(o)}[rR](){return this[lR][cR][nR]}}vR.displayName="CollectionNoDateMenu",vR.loadMoreScrollOffset=200,vR.loadMoreIncrement=20;const fR=vR;var yR=i(65669),wR=i(74487);const SR=wR.undefinable(wR.object({required:{blockIdToVersion:wR.record(wR.string(),wR.number())},optional:{hasMore:wR.boolean()}}));var bR=i(29477),kR=i(36054);const CR=i(85).$7D,TR=i(85).X2z,xR=i(85).ToI,IR=i(85).S_W,PR=i(85).wgE,DR=i(85).P24,MR=i(85).r9_,ZR=i(85).a6o,BR=i(85).IAj;class RR{constructor(e,t){this[BR]=void 0,this[ZR]=void 0,this[MR]=void 0,this[DR]=void 0,this[PR]=void 0,this.isServerQueryCollectionRequired=e=>{if(!ke.default.checkGate("client_handle_query_collection_locally"))return!0;const t=this[DR][IR].state,i=Boolean(e&&(0,kR.P9)(SR,e)&&e.hasMore);if(t&&!i)return!1;const o=this[DR].remoteRequestStore.state;if(!o)return!0;return!!(0,Wp.objectEntries)(o.loader.reducers||{}).some((e=>{let[t,i]=e;return"results"!==i.type}))||!(e&&(0,kR.P9)(SR,e)&&!e.hasMore)},this.throttledRefetch=(0,yR.Z)((e=>this.refetchFromRemote({...e,queuedTimestamp:Date.now()}))),this.processCollectionRefetch=async e=>{const t=this[ZR],i=this[MR];this.reset(),i?this.throttledRefetch({src:e}):R.trackBypassedQueryCollectionRequest(this[PR]),t&&await L.refreshRecordsAndAddToResultSet({[PR]:this[PR],[DR]:this[DR],blockIdToMinimumVersion:t})},this.refetchFromRemote=async e=>{const t=ke.default[xR]({experimentId:TR,defaultGroup:"control"}),i="control"===t?1e3:parseInt(t);await Promise.all([L.fetchRemoteResult(this[PR],this[DR],e),(0,bR.timeout)(i)])},this[BR]=!1,this[MR]=!1,this[ZR]={},this[DR]=e,this[PR]=t}reset(){this[BR]=!1,this[MR]=!1,this[ZR]={}}addBlockIdToRefetch(e,t){this[ZR][e]=Math.max(this[ZR][e]??0,t)}async handleCollectionEmit(e){const{src:t,passThroughData:i,[CR]:o}=e;if((0,kR.P9)(SR,i)&&null!=i&&i.blockIdToVersion&&(0,Wp.objectEntries)(i.blockIdToVersion).forEach((e=>{let[t,i]=e;return this.addBlockIdToRefetch(t,i)})),this[MR]=this[MR]||this.isServerQueryCollectionRequired(i),!o)return await this.processCollectionRefetch(t);this[BR]=!0}async maybeProcessQueuedCollectionEmit(e){if(this[BR])return await this.processCollectionRefetch(e)}}var ER=i(91007),VR=i(43664),AR=i(42858),LR=i(58202),_R=i(96620),OR=i(13966),FR=i(68709),NR=i(23063),GR=i(19387);const HR=i(85).Hww,WR=i(85).nrD,KR=i(85).z70,zR=i(85).$pZ,UR=i(85).QYk,$R=i(85).NRr,QR=i(85).Omf,qR=i(85).xad,XR=i(85).iDK,YR=i(85).OBh,jR=i(85).ffk,JR=i(85).Uww,eE=i(85).qq3,tE=i(85).jFW,iE=i(85).FOQ,oE=i(85).bey,sE=i(85).A3y,rE=i(85).rpY,nE=i(85).Joh,lE=i(85).ESK,aE=i(85).PG2,dE=i(85).gdQ,hE=i(85).BQ6,cE=i(85).D7I,uE=i(85).ULC,pE=i(85).jUc,mE=i(85).vN2,gE=i(85).EKG,vE=i(85).bSA,fE=i(85).Yzm,yE=i(85).AEP,wE=i(85)._Fe,SE=i(85).S9$,bE=i(85).NF1,kE=i(85).jkI,CE=i(85).uzK,TE=i(85).P24,xE=i(85).wgE,IE=i(85).Q_p,PE=i(85).dr3,DE=i(85).XNW,ME=i(85).nx5,ZE=i(85).rG;function BE(e){return{boxShadow:`1px 0 0 ${e.regularDividerColor}`,marginRight:1}}const RE=(0,P.defineMessages)({[ZE]:{id:"CollectionsBulkActionsToolbar.deleteButton.tooltip",[ME]:"Delete"}});function EE(e){window.__c={n:"CollectionsBulkActionsToolbar"};const t=(0,U.Y$)(),{[DE]:i}=e,o=(0,qn.O7)(),s=(0,Xn.qz)(void 0,_R.Z),r=(0,c.useRef)(null),[l,d]=(0,c.useState)(!1),h=(0,Xn.VK)((()=>s.state[PE]),[s]),u=(0,Xn.VK)((()=>_i.default.state.stores.filter((e=>LR.R.findBlockFromStore(e)))),[h]),p=u.length,m=(0,Xn.VK)((()=>s[IE]()),[s]),g=(0,Xn.VK)((()=>{var e;return!!(0,ie.shouldShowBulkActionsToolbar)({[xE]:o,[TE]:t})&&(m>0||u.length>=1&&(0,ie.areParentedBySameCollectionViewBlock)(u,null===(e=t[CE]())||void 0===e?void 0:e.id))}),[t,o,m,u]),v=(0,Yn.yK)((e=>({inner:{position:"absolute",top:1,left:0+(i??0),display:"inline-flex",justifyContent:kE,alignItems:kE,[bE]:5,background:e.popoverBackground,boxShadow:e.lightBoxShadow,height:32},outer:{position:"sticky",top:0,left:0,zIndex:I.overlayContainer,visibility:l?"visible":"hidden"},blockActionMenuButton:{width:30,height:"100%",[bE]:void 0,borderTopRightRadius:5,[SE]:5},blockActionMenuButtonIcon:{fill:e[wE]},trashButton:{[bE]:0,height:"100%",border:0,...BE(e),width:28},trashButtonIcon:{width:16},trashButtonIconHovered:{fill:e.accentColors.red[500]}})),[l,i]);return a()(NR.Z,{isVisible:g,enterAnimationStyle:{[yE]:0},animationStyle:{[yE]:1},exitAnimationStyle:{[yE]:0},springConfig:{[yE]:{stiffness:100,damping:10,precision:1e-4}},onAnimationEnd:e=>{e||d(!1)},[rE]:()=>a()(du.Z,{capture:!0,[rE]:e=>c[cE]("div",n()({ref:r},e,{[hE]:v.outer}),a()(FR.p,{allowSelectionWithin:!1},void 0,a()("div",{[hE]:v.inner},void 0,a()(VE,{selectedItemCount:p,collectionsBulkActionsToolbarStore:s}),a()(AE,{collectionsBulkActionsToolbarStore:s,selectedItems:u,[DE]:i,setIsReadyToRender:d,outerContainerRef:r}),a()(at.Z,{[nE]:()=>a()("div",{},void 0,ne.default[fE](RE[ZE])),[rE]:e=>c[cE](pn.Z,n()({},e,{ariaLabel:ne.default[fE](RE[ZE]),icon:()=>S.Z.trash(v.trashButtonIcon),[hE]:v.trashButton,[dE]:v.trashButtonIconHovered,hasBackground:!0,isDarkIconColor:!0,showShadow:!0,[aE]:async()=>{D.trackBlockAction(o,{[vE]:Di.sY[gE][ME],from:"bulk_actions_toolbar",[mE]:pE}),await AR[uE]({[xE]:o,blocks:u})}})),placement:at.Z[lE].Top}),a()(OR.Z,{store:u[0],fadeIn:!1,[hE]:v.blockActionMenuButton,[dE]:v.blockActionMenuButton,[oE]:v.blockActionMenuButtonIcon,extraAnalyticsData:{[sE]:!0}}))))})})}function VE(e){window.__c={n:"SelectedItemCountWidget"};const{collectionsBulkActionsToolbarStore:t,selectedItemCount:i}=e,o=(0,qn.O7)(),s=(0,Xn.VK)((()=>t[IE]()),[t]),r=(0,Xn.VK)((()=>s>0?s:i),[s,i]),n=(0,Yn.yK)((e=>({[iE]:{color:e.blueColor,fontSize:14,whiteSpace:"nowrap",height:"100%",alignItems:kE,display:"flex",paddingRight:10,paddingLeft:10,borderTopLeftRadius:5,[tE]:5,fontVariantNumeric:"tabular-nums",...BE(e)}})),[]);return a()(Bo.Z,{[hE]:n[iE],[aE]:()=>W.clear(o)},void 0,a()(P.FormattedMessage,{id:"SelectedItemCountWidget.numItemsSelected",[ME]:"{itemsSelectedCount} selected",values:{itemsSelectedCount:r}}))}function AE(e){window.__c={n:"EditPropertyButtons"};const{outerContainerRef:t,collectionsBulkActionsToolbarStore:i,selectedItems:o,[DE]:s,setIsReadyToRender:r}=e,n=(0,U.Y$)(),l=(0,Xn.VK)((()=>n[eE].state),[n]),d=(0,c.useRef)(null),u=(0,Xn.VK)((()=>{var e;const t=n[JR].state;return(null==t||null===(e=t.table_properties)||void 0===e?void 0:e.filter((e=>{const t=l[e[jR]];return e.visible&&t&&"title"!==t.type&&(0,ai.Sb)({[YR]:t,[jR]:e[jR],blockStores:o,collectionSchema:l})})))??[]}),[n,l,o]).slice(0,6),p=(0,c.useRef)([]),[m,g]=(0,c.useState)(6),[v,f]=(0,c.useState)(!1);return(0,c.useEffect)((()=>{p[XR].length>0&&p[XR].forEach((e=>{var t,i;e&&(e.rightEdge=(null===(t=e[qR])||void 0===t||null===(i=t[XR])||void 0===i?void 0:i[QR]().right)??0)}))}),[p]),function(e){let{outerContainerRef:t,propertyButtonsContainerRef:i,propertyButtonRefs:o,[DE]:s,setIsReadyToRender:r,setShowIconsOnly:n,setHiddenButtonsIndex:l}=e;(0,c.useEffect)((()=>{const e=h().debounce((()=>{var e,a,d;const h=(null===(e=t[XR])||void 0===e?void 0:e[QR]().right)??window.innerWidth,c=((null===(a=t[XR])||void 0===a?void 0:a[QR]().width)??window.innerWidth)-(s??0),u=(null===(d=i[XR])||void 0===d?void 0:d[QR]().left)??0,p=h-150;let m=o[XR].findIndex((e=>e.rightEdge>p));m=-1!==m?m:6;let g=o[XR].findIndex(((e,t)=>u+32*t>p));g=-1!==g?g:6;const v=m<2||c<=450;n(v),l(v?g:m),r(!0)}),150,{maxWait:150,leading:!0,trailing:!1});if(t[XR]){const i=new ResizeObserver((t=>{e()}));return e(),i.observe(t[XR]),()=>{i.disconnect()}}}),[s,t,o,i,l,r,n])}({propertyButtonsContainerRef:d,propertyButtonRefs:p,outerContainerRef:t,[DE]:s,setIsReadyToRender:r,setHiddenButtonsIndex:g,setShowIconsOnly:f}),c[cE]("div",{ref:d,[hE]:{display:"flex"}},u.map(((e,t)=>{var o;let s=null===(o=p[XR][t])||void 0===o?void 0:o[qR];if(!s){const e=c.createRef();p[XR][t]={[qR]:e,rightEdge:0},s=e}const r=t>=m;return c[cE]("div",{ref:s,key:e[jR]},a()(LE,{collectionsBulkActionsToolbarStore:i,schema:l,[jR]:e[jR],isHidden:r,showIconsOnly:v},e[jR]))})))}function LE(e){window.__c={n:"EditPropertyButton"};const{[jR]:t,schema:i,collectionsBulkActionsToolbarStore:o,isHidden:s,showIconsOnly:r}=e,l=(0,U.Y$)(),d=i[t],h=(0,qn.O7)(),u=(0,Xn.VK)((()=>!(l.permissionScopes.state.canEditContent||"collectionTypedView"===l.contextType)),[l]),p=(0,Yn.yK)((e=>({[iE]:{display:s?"none":"flex",padding:8,...BE(e)}})),[s]),m=(0,c.useRef)(null),g=(0,Xn.qz)(void 0,Pe.Z),v=(0,c.useCallback)((async e=>{var i,s;if(!m[XR])return;const r=_i.default.state.stores;e.stopPropagation(),e.preventDefault();const n=null===(i=m[XR])||void 0===i?void 0:i[QR](),a=r[0][$R]();l&&n&&a&&await VR[UR]({[xE]:h,store:r[0],additionalStores:r.slice(1),[jR]:t,rect:n,format:Mo.C.Table,collectionStore:a,[zR]:Q[KR](),[TE]:l,statusSetCheckbox:"checkbox"===(null===(s=l.getPropertyFormat(t))||void 0===s?void 0:s.statusShowAs),mouseStore:g,preventClearSelection:!0,collectionsBulkActionsToolbarStore:o})}),[m,l,h,t,g,o]),f=(0,Yn.Fg)();return d?a()(at.Z,{[nE]:()=>d.name,[rE]:e=>c[cE](Bo.Z,n()({},e,{ariaLabel:d.name,ref:m,[hE]:p[iE],disabled:u,[aE]:v}),a()(GR.Z,{[hE]:{maxWidth:"250px",[WR]:HR},[YR]:d,hideName:r,showIcon:!0,[jR]:t,[oE]:{fill:f[wE]}})),disableTooltip:!r,placement:at.Z[lE].Top}):null}var _E=i(54634),OE=i(49670),FE=i(13005),NE=i(91496),GE=i(54281),HE=i(64815);class WE extends v.default{getInitialState(){return{}}}const KE=WE,zE=32;var UE=i(35431),$E=i(88108);const QE=i(85).wj5,qE=i(85).Trf;class XE extends UE.Z{[qE](e){return this[QE]({filter:t=>e.uiContains(t.props.store)})}}const YE=new XE;(0,$E.exposeDebugValue)("GlobalCollectionTimelineViewItemRegistry",YE);var jE=i(20294),JE=i(55367),eV=i(82994);const tV=i(85).uDf,iV=i(85).WbK,oV=i(85).WwI,sV=i(85).D7I,rV=i(85).mFu,nV=i(85).T4J,lV=i(85).i7F,aV=i(85).fmj,dV=i(85).P24,hV=i(85).QQh,cV=i(85).DWf,uV=i(85).EEt,pV=i(85).Omf,mV=i(85).qnp,gV=i(85).PR5,vV=i(85).BxA,fV=i(85).c0M,yV=i(85).Gnd,wV=i(85).QmD,SV=i(85).HwH,bV=i(85).Mcv,kV=i(85).qc1,CV={position:"absolute",left:0,top:0,zIndex:I.timelineDependenciesOverlay,width:"100%",height:"100%",[kV]:"none"};function TV(e){const{startItemPosition:t,value:i}=e;return t&&i?(i&&t&&i.left<=t.left&&(i[bV]<t.left?i.left=i[bV]:(i.left=t.left+12,i.top=i.top-15)),i):i}function xV(e){window.__c={n:"CollectionTimelineRelationArrow"};const{startItem:t,endItem:i,endRelationPointer:o,[SV]:s,disabled:r,isFullScreen:n,isRootChild:l,relationType:d,isUserDrawnTemp:h,isNewSubitemPlaceholder:u,renderEmitter:p}=e,g=(0,U.Y$)(),v=(0,qn.O7)(),f=(0,jE.k)(),[y,w]=(0,c.useState)(!1),S=(0,Yn.Fg)(),[b,k]=(0,c.useState)(null),[C,T]=(0,c.useState)(null),x=(0,c.useCallback)((e=>{k(e[wV])}),[]),P=(0,c.useCallback)((e=>{T(e[wV])}),[]),D=(0,c.useCallback)((()=>{m.default.afterNextFlush((()=>{f()}))}),[f]);(0,c.useEffect)((()=>(k(t[yV].node[wV]),T(i?i[yV].node[wV]:null),t[yV].node[fV](x),null==i||i[yV].node[fV](P),null==p||p[fV](D),g[vV][fV](D),()=>{t[yV].node[gV](x),null==i||i[yV].node[gV](P),null==p||p[gV](D),g[vV][gV](D)})),[t,i,p,x,P,D,g[vV]]);const M=(0,Xn.VK)((()=>JE.ZP[wV][mV]&&JE.ZP[wV].draggedStores.includes(t.props.store)),[t]),Z=(0,Xn.VK)((()=>i&&JE.ZP[wV][mV]&&JE.ZP[wV].draggedStores.includes(i.props.store)),[i]),B=(0,Xn.VK)((()=>{const e=JE.ZP[wV];return e[mV]?e.currentY-e.startY:0}),[]),R=b&&b[pV]().y+(M?B:0),E=(0,Xn.VK)((()=>{const e=t[uV][wV];return R&&e?{left:e.left,[bV]:"subitem"===d?e.left+12:e[bV],top:"subitem"===d?R+15:R}:void 0}),[d,t[uV],R]),V=C&&C[pV]().y+(Z?B:0),A=(0,Xn.VK)((()=>{const e=V&&null!=i&&i[uV][wV]?{...i[uV][wV],top:V}:void 0;return"subitem"===d?TV({startItemPosition:t[uV][wV],value:e}):e}),[i,V,d,t[uV]]),L=(0,Xn.VK)((()=>void 0!==s.dragState[wV]),[s]),_=(0,Xn.VK)((()=>void 0!==s[cV][wV]),[s]),O=(0,Xn.VK)((()=>s.hoveredItem[wV]),[s.hoveredItem]),F=y&&!L&&!_,N=(0,c.useCallback)((()=>{o&&!r&&GE.removeDependency({[hV]:{store:t.props.store,relationPointer:o},[dV]:g,environment:v,[SV]:s,isFullScreen:n,isRootChild:l})}),[t,r,o,g,v,s,n,l]),G=(0,c.useCallback)((()=>{w(!0)}),[w]),H=(0,c.useCallback)((()=>{w(!1)}),[w]),W=(0,c.useCallback)((e=>{if(A)return a()(IV,{topOffset:e,endPosition:A,handleCloseButtonClick:N})}),[A,N]),K=O===t.props.store,z=i&&O===i.props.store,$=K||z||F||"subitem"===d?1:.7;let Q,q=!0;"subitem"===d&&(Q=S[aV],q=!1);const X=(0,Yn.yK)((()=>({svgStyle:{zIndex:F||z?I.timelineDependenciesOverlay:I.timelineDependenciesUnderlay}})),[F,z]);return E?h?a()(PV,{startPosition:E,[SV]:s}):u?a()(DV,{startPosition:E,[SV]:s}):t!==i&&A?a()(MV,{startPosition:E,endPosition:A,strokeOpacity:$,strokeColorOverride:Q,svgStyle:X.svgStyle,cornerRadiusOverride:"subitem"===d?8:void 0,relationType:d,[lV]:G,[nV]:H,renderChildren:q&&F?W:void 0}):null:null}function IV(e){window.__c={n:"RemoveDependencyButton"};const{topOffset:t,endPosition:i,handleCloseButtonClick:o}=e,s=(0,Yn.yK)((e=>({icon:{background:e.white,borderRadius:5,fill:e.accentColors.red[500],height:14,width:14}})),[]);return c[sV](c.Fragment,null,a()("foreignObject",{width:16,height:16,x:i.left-16,y:i.top-t+8,style:{cursor:rV,[kV]:"all"},onClick:o},void 0,S.Z.clearInput(s.icon)))}function PV(e){window.__c={n:"UserDrawnTempDependencyArrow"};const{startPosition:t,[SV]:i}=e,o=(0,Xn.VK)((()=>{const e=i[cV][wV];if(!e||void 0===e.xOffsetPx||void 0===e.yOffsetPx)return;return{left:t[bV]+e.xOffsetPx+18,top:t.top+e.yOffsetPx}}),[t,i[cV]]);return o?a()(MV,{startPosition:t,endPosition:o,strokeOpacity:1,relationType:hV}):null}function DV(e){var t;window.__c={n:"NewSubitemPlaceholderArrow"};const{startPosition:i,[SV]:o}=e,s=(0,Yn.Fg)(),r=(0,Xn.VK)((()=>o[oV][wV]),[o[oV]]),n=(0,Xn.VK)((()=>null!=r&&r.active?r.date:void 0),[r]),l=null!=r&&r.active?null===(t=r[iV])||void 0===t?void 0:t.subitemPath:void 0,d=l?l[l.length-1].children.length:0,h=i.top+33*d+15+5,c=(0,Xn.VK)((()=>{const e=(0,te.HZ)({[SV]:o,dateValue:n,placeholderDate:n,subitemPlaceholderDate:void 0}),t=h&&e?{...e,top:h}:void 0;return TV({startItemPosition:i,value:t})}),[n,h,i,o]);return c?a()(MV,{startPosition:i,endPosition:c,strokeOpacity:1,strokeColorOverride:s[aV],relationType:"subitem"}):null}function MV(e){window.__c={n:"RelationArrowBase"};const{startPosition:t,endPosition:i,strokeColorOverride:o,cornerRadiusOverride:s,strokeOpacity:r,relationType:n,svgStyle:l,[lV]:d,[nV]:h}=e,u=(0,U.Y$)(),p=(0,Yn.Fg)(),[m,g]=(0,c.useState)(0),v=t[bV],f=t.top+15-m,y=i.left-3,w=i.top+15-m,S=(0,Xn.VK)((()=>{if(o)return o;return(0,te.H5)(u)&&t[bV]&&i.left?t[bV]<i.left?p[tV]:p.collectionInvalidDependencyArrow:p[aV]}),[u,i.left,t[bV],o,p]);return c[sV]("svg",{style:{...CV,...l},ref:e=>{e&&g(e[pV]().top)}},a()(eV.Z,{startPoint:{x:v,y:f},endPoint:{x:y,y:w},style:{stroke:S,strokeWidth:te.lf,strokeOpacity:r},useRightAngles:"subitem"===n,showArrowHead:"dependency"===n&&!e.renderChildren,cornerRadiusOverride:s,[lV]:d,[nV]:h},void 0,e.renderChildren&&e.renderChildren(m)))}const ZV=i(85).WbK,BV=i(85).WwI,RV=i(85).w1W,EV=i(85).tBn,VV=i(85).D7I,AV=i(85).Kvi,LV=i(85).r_2,_V=i(85).QQh,OV=i(85).P0R,FV=i(85).xd5,NV=i(85).XtO,GV=i(85).Trf,HV=i(85).iTm,WV=i(85).uzK,KV=i(85).DWf,zV=i(85).gIX,UV=i(85).I8n,$V=i(85).MAy,QV=i(85).pkR,qV=i(85).HwH;function XV(e){window.__c={n:"CollectionTimelineDependenciesOverlay"};const{[qV]:t,[QV]:i,isReady:o,[$V]:s,[UV]:r,[zV]:n}=e,l=(0,U.Y$)(),d=(0,c.useCallback)((()=>{t[KV].setState(void 0)}),[t[KV]]),h=(0,Xn.VK)((()=>l[WV]()),[l]),u=(0,Xn.VK)((()=>l.settingsStore.state.open),[l]);if((0,c.useEffect)((()=>{var e;!u&&null!==(e=t[KV].state)&&void 0!==e&&e[HV]&&d()}),[u,t[KV],d]),!o||!h)return null;const p=YE[GV](h);return c[VV](c[EV],null,p.map((e=>{const{[NV]:o,[FV]:l}=e[OV],d=null==l?void 0:l.value,h=d?(0,_e.Hd)(d):"noGroup";return c[VV](c[EV],null,a()(YV,{[LV]:e,[qV]:t,[QV]:i,[$V]:s,[UV]:r,[zV]:n,relationType:_V},`${o.id}-${h}-${o.key}-dependency`),a()(YV,{[LV]:e,[qV]:t,[QV]:i,[$V]:s,[UV]:r,[zV]:n,relationType:AV},`${o.id}-${h}-${o.key}-subitem`))})))}function YV(e){window.__c={n:"CollectionTimelineRelationAnnotationItem"};const{[LV]:t,[qV]:i,[QV]:o,[$V]:s,[UV]:r,relationType:n,[zV]:l}=e,{[NV]:d,schema:h}=t[OV],u=(0,U.Y$)(),p=(0,Xn.VK)((()=>"dependency"===n?i[KV].state:void 0),[i[KV],n]),m=(0,Xn.VK)((()=>(null==p?void 0:p.startStore)===d),[d,p]),g=(0,Xn.VK)((()=>m&&!(null!=p&&p[HV])),[p,m]),v=(0,Xn.VK)((()=>"dependency"===n?m&&p?p[RV]:(0,te.YE)(u,d,h):"subitem"===n?(0,te.wI)(u,d,h):[]),[m,p,u,d,h,n]),f=(0,Xn.VK)((()=>u[WV]()),[u]),y=(0,Xn.VK)((()=>{var e;const o=i[BV].state;if("subitem"!==n||null==o||!o.active||!o[ZV])return;const s=o[ZV].subitemPath;return(s?null===(e=s[s.length-1])||void 0===e?void 0:e.value[NV]:void 0)===t[OV][NV]?o:void 0}),[n,t[OV][NV],i[BV]]);if(!f)return null;const w=YE[GV](f);return c[VV](c[EV],null,v.map((e=>{if(d.id===e.id)return null;const h=w.filter((t=>t[OV][NV].id===e.id));return c[VV](c[EV],null,h.map((d=>{const h=d[OV][NV],c=d[OV][FV];return a()(xV,{[LV]:t,endItem:d,endRelationPointer:e,[qV]:i,[QV]:o,[$V]:s,[UV]:r,[zV]:l,relationType:n},`${h.id}-${null==c?void 0:c.value.value}-${h.key}`)})))})),"dependency"===n&&g&&a()(xV,{isUserDrawnTemp:!0,[LV]:t,endItem:void 0,endRelationPointer:void 0,[qV]:i,[QV]:!1,[$V]:s,[UV]:r,relationType:"dependency"}),"subitem"===n&&y&&a()(xV,{isNewSubitemPlaceholder:!0,[LV]:t,endItem:void 0,endRelationPointer:void 0,[qV]:i,[QV]:!1,[$V]:s,[UV]:r,relationType:"subitem"}))}var jV=i(36488);const JV=i(85).Hco,eA=i(85).XNW,tA=i(85).j7K,iA=i(85).nQ3,oA=i(85).Ek1,sA=i(85).y79,rA=i(85).iVN,nA=i(85).nx5,lA=i(85).ceT,aA=i(85).dLQ,dA=i(85).D7I,hA=i(85).rpY,cA=i(85).wgE,uA=i(85).YNm;class pA extends p.Z{constructor(){super(...arguments),this.renderZoomLevelMenu=e=>{const{[uA]:t,onChange:i}=this.props,{device:o}=this[cA],s=[{key:"calendar by section",[hA]:e=>c[dA](lt.Z,e),items:Pi.timelineZoomLevels.map((t=>({key:t,[hA]:e=>c[dA](et.Z,n()({},e,{title:this.renderZoomLevelText(t)})),action:()=>{i(t),e.close()}})))}];return a()(jV.Z,{capture:!0,allowEsc:!0,[hA]:i=>{let r;return r=o[aA]?{[lA]:Ye.og.Modal,title:a()(P.FormattedMessage,{[nA]:"Select a zoom level",id:"database.timelineView.mobileTimelineZoomPicker.title"}),right:a()(st.DoneMenuText,{}),[rA]:e.close,...i}:{[lA]:Ye.og.Popup,width:180,...i},c[dA](it.Z,r,a()(ot.Z,{type:ot.i[sA],[iA]:s,[tA]:Pi.timelineZoomLevels[oA](t)}))}})}}renderComponent(){const{[uA]:e}=this.props,{device:t}=this[cA];return a()(tt.ZP,{popupType:t[aA]?nt.kQ.SlideUp:nt.kQ.Popup,renderOrigin:t=>c[dA](rt.Z,n()({isSmall:!0,isGray:!0},t),this.renderZoomLevelText(e),S.Z.chevronDown({width:10,[eA]:4,fill:this.theme[JV]})),originGap:8,[hA]:this.renderZoomLevelMenu})}renderZoomLevelText(e){return"hours"===e?a()(P.FormattedMessage,{id:"database.timelineView.zoomLevel.hours",[nA]:"Hours"}):"day"===e?a()(P.FormattedMessage,{id:"database.timelineView.zoomLevel.day",[nA]:"Day"}):"week"===e?a()(P.FormattedMessage,{id:"database.timelineView.zoomLevel.week",[nA]:"Week"}):"bi_week"===e?a()(P.FormattedMessage,{id:"database.timelineView.zoomLevel.biWeek",[nA]:"Bi-week"}):"month"===e?a()(P.FormattedMessage,{id:"database.timelineView.zoomLevel.month",[nA]:"Month"}):"quarter"===e?a()(P.FormattedMessage,{id:"database.timelineView.zoomLevel.quarter",[nA]:"Quarter"}):"year"===e?a()(P.FormattedMessage,{id:"database.timelineView.zoomLevel.year",[nA]:"Year"}):void(0,Wp.unreachable)(e)}}pA.displayName="CollectionTimelineViewZoomLevelButtonPopup";const mA=pA;var gA=i(33411);const vA=i(85).Q9F,fA=i(85).Hco,yA=i(85).gGi,wA=i(85).zOY,SA=i(85).E6w,bA=i(85).Joh,kA=i(85).nx5,CA=i(85).BQ6,TA=i(85).PG2,xA=i(85).D7I,IA=i(85).a3v,PA=i(85).X_m,DA=i(85).nLZ,MA=i(85).PXg,ZA=i(85).XNW,BA=i(85).XCs,RA=i(85).cx2,EA=i(85).XLC,VA=i(85).GmX,AA=i(85).Au,LA=i(85).zrY,_A=i(85).Scd,OA=i(85).SjN,FA=i(85).E0z,NA=i(85).$Fm,GA=i(85).oki,HA=i(85).nKX,WA=i(85).O1p,KA=i(85).AR5,zA=i(85).IXi,UA=i(85).EIp,$A=i(85).LCr,QA=i(85).nXm,qA=i(85).Drs,XA=i(85).JJj,YA=i(85).qU4,jA=i(85).q9x,JA=i(85).wgE,eL=i(85).C_5,tL=i(85).Jkr,iL=i(85).YNm,oL=i(85).QmD,sL=i(85).P0R,rL=i(85).P24,nL=i(85).I8n,lL=i(85).MAy,aL=i(85).urI,dL=i(85).YDv,hL=i(85).HwH;class cL extends p.Z{constructor(){super(...arguments),this.handleLeftArrowClick=()=>{const{[hL]:e,[dL]:t,[aL]:i,[lL]:o,[nL]:s,[rL]:r}=this[sL],n=e[iL][oL],l=(e[eL].rect[oL][tL]-(0,te.xI)({[JA]:this[JA],[dL]:t,[aL]:i,[lL]:o,[nL]:s}))/2,a=(0,te.al)(e)-(0,te.x2)(n,l);GE.resetWindow({[hL]:e,[JA]:this[JA],[iL]:n,[jA]:a}),D.trackTimelineShiftTimeClick(this[JA],{...(0,te.Ii)({[JA]:this[JA],[rL]:r,[hL]:e,[lL]:o,[nL]:s}),type:"left"})},this.handleRightArrowClick=()=>{const{[hL]:e,[dL]:t,[aL]:i,[lL]:o,[nL]:s,[rL]:r}=this[sL],n=e[iL][oL],l=(e[eL].rect[oL][tL]-(0,te.xI)({[JA]:this[JA],[dL]:t,[aL]:i,[lL]:o,[nL]:s}))/2,a=(0,te.al)(e)+(0,te.x2)(n,l);GE.resetWindow({[hL]:e,[JA]:this[JA],[iL]:n,[jA]:a}),D.trackTimelineShiftTimeClick(this[JA],{...(0,te.Ii)({[JA]:this[JA],[rL]:r,[hL]:e,[lL]:o,[nL]:s}),type:"right"})},this.handleTodayClick=()=>{const{[hL]:e,[dL]:t,[aL]:i,[rL]:o,[lL]:s,[nL]:r}=this[sL],n=e[iL][oL],l=(0,te.bK)({timestamp:Date.now(),[JA]:this[JA],[hL]:e,[dL]:t,[aL]:i});GE.resetWindow({[hL]:e,[JA]:this[JA],[iL]:n,[jA]:l}),D.trackTimelineTodayClick(this[JA],(0,te.Ii)({[JA]:this[JA],[rL]:o,[hL]:e,[lL]:s,[nL]:r}))},this.handleZoomLevelChange=e=>{const{[hL]:t,[rL]:i,[lL]:o,[nL]:s}=this[sL];GE.resetWindow({[hL]:t,[JA]:this[JA],[iL]:e,[jA]:(0,te.al)(t)}),D.trackTimelineZoomLevelUpdate(this[JA],(0,te.Ii)({[JA]:this[JA],[rL]:i,[hL]:t,[lL]:o,[nL]:s}))},this.handleShowTableClick=()=>{const{[aL]:e,[hL]:t,[rL]:i,[lL]:o,[nL]:s}=this[sL],r=i[YA]();r&&(z[XA]({[qA]:"CollectionTimelineViewControlBar.handleShowTableClick",[JA]:this[JA],perform:t=>{const i=(0,te.YP)(e,!0);Ne[QA]({stores:[r],update:i,[$A]:t})}}),D.trackTimelineToggleTableClick(this[JA],{...(0,te.Ii)({[JA]:this[JA],[rL]:i,[hL]:t,[lL]:o,[nL]:s}),show:!0}))},this.currentScrolledSecondaryDisplayUnitStore=this[UA]((()=>{const{[hL]:e,scrollerLeftOffset:t,[dL]:i,showTable:o,[lL]:s}=this[sL],r=e[iL][oL],{[zA]:n,[KA]:l}=te.BJ[r],a=e[WA][oL],{startTimestamp:d}=e[HA][oL];if(void 0!==a){const e=d+(0,te.x2)(r,a+t+(!o&&s?i:0));return(0,te.DS)(DT.ou[GA](e),n).startOf(l).valueOf()}}))}renderComponent(){var e;const{[hL]:t,showTable:i,[lL]:o,[nL]:s,isReady:r,[rL]:l,[NA]:d}=this[sL],{[FA]:h}=this[JA],u=t[iL][oL],{[KA]:p}=te.BJ[u],m=this.currentScrolledSecondaryDisplayUnitStore[oL],g=(0,te.d$)({[JA]:this[JA],[lL]:o,[nL]:s}),v=l.permissionScopes[oL],f=!i&&g&&v.canConfigureBlock,y=(null===(e=l[OA][oL])||void 0===e?void 0:e[_A])||(d?this[AA][LA]:this[AA][VA]),w=d?this[AA].cardContentBackgroundTransparent:this[AA][EA];return a()(zg,{position:We.Top},void 0,a()("div",{[CA]:this[RA]()},void 0,m&&a()("div",{[CA]:this.getCurrentScrolledSecondaryDisplayUnitStyle()},void 0,f&&a()(at.Z,{render:e=>c[xA](rt.Z,n()({isSmall:!0,[TA]:this.handleShowTableClick,[CA]:{[dL]:4,[BA]:4,[ZA]:2,[MA]:4,[DA]:h.isIOS?0:1,[PA]:22,fill:this[AA][IA]}},e),S.Z.doubleChevronRight({[tL]:14})),[bA]:()=>a()(P.FormattedMessage,{id:"database.timelineView.controlHeader.showTableButton.title",[kA]:"Show table"})}),a()("span",{[CA]:{[dL]:f||this[JA][FA][SA]?0:o||i?16:2}},void 0,(0,te.qG)(m,p)),!r&&!i&&this[wA](),a()("div",{[CA]:{[tL]:30,[MA]:-30,[PA]:"100%",backgroundImage:`linear-gradient(to right, ${y} 20%, ${w} 100%)`}})),a()("div",{[CA]:this.getControlBarRightStyle()},void 0,a()("div",{[CA]:{[tL]:30,[ZA]:-30,[PA]:yA,backgroundImage:`linear-gradient(to left, ${y} 20%, ${w} 100%)`}}),a()(mA,{[iL]:u,onChange:this.handleZoomLevelChange}),a()(rt.Z,{isSmall:!0,isGray:!0,[TA]:this.handleLeftArrowClick,[CA]:{[ZA]:4,[dL]:4,[BA]:4}},void 0,S.Z.chevronLeft({[tL]:12,fill:this[AA][fA]})),a()(rt.Z,{isSmall:!0,[TA]:this.handleTodayClick},void 0,a()(P.FormattedMessage,{id:"database.timelineView.controlHeader.todayButton.title",[kA]:"Today"})),a()(rt.Z,{isSmall:!0,isGray:!0,[TA]:this.handleRightArrowClick,[CA]:{[dL]:4,[BA]:4}},void 0,S.Z[vA]({[tL]:12,fill:this[AA][fA]})))))}[wA](){return a()(gA.Z,{show:!0,showDelay:400,showHold:0,render:e=>e?a()(cu.Z,{[CA]:{[ZA]:8,[DA]:1}}):void 0})}[RA](){const{[hL]:e}=this[sL],{[eL]:t}=e;return{position:"sticky",left:0,[tL]:t.rect[oL][tL],zIndex:I.timelineViewControlBar,[PA]:0}}getCurrentScrolledSecondaryDisplayUnitStyle(){var e;const{scrollerLeftOffset:t,[dL]:i,[lL]:o,showTable:s,[rL]:r,[NA]:n}=this[sL],l=(null===(e=r[OA][oL])||void 0===e?void 0:e[_A])||(n?this[AA][LA]:this[AA][VA]);return{position:"absolute",top:1,left:0,[dL]:o&&!s?t+i:t,display:"flex",alignItems:"center",[PA]:32,paddingTop:6+(this[JA][FA].isMobile?2:0),[_A]:l,fontSize:14,fontWeight:x.Z.fontWeight.medium}}getControlBarRightStyle(){var e;const{[BA]:t,[rL]:i,[NA]:o}=this[sL],s=(null===(e=i[OA][oL])||void 0===e?void 0:e[_A])||(o?this[AA][LA]:this[AA][VA]);return{position:"absolute",top:1,right:0,[BA]:t,display:"flex",alignItems:"center",[PA]:32,paddingTop:7,[_A]:s}}}cL.displayName="CollectionTimelineViewControlBar";const uL=cL,pL=i(85).nx5,mL=i(85).D7I,gL=i(85).a3v,vL=i(85).tLG,fL=i(85).LCr,yL=i(85).nXm,wL=i(85).wgE,SL=i(85).Drs,bL=i(85).JJj,kL=i(85).qU4,CL=i(85).HwH,TL=i(85).I8n,xL=i(85).MAy,IL=i(85).P24;class PL extends p.Z{constructor(){super(...arguments),this.handleHideTableClick=()=>{const{format:e,[IL]:t,[xL]:i,[TL]:o,[CL]:s}=this.props,r=t[kL]();r&&(z[bL]({[SL]:"CollectionTimelineViewHideTableButton.handleHideTableClick",[wL]:this[wL],perform:t=>{const i=(0,te.YP)(e,!1);Ne[yL]({stores:[r],update:i,[fL]:t})}}),D.trackTimelineToggleTableClick(this[wL],{...(0,te.Ii)({[wL]:this[wL],[IL]:t,[CL]:s,[xL]:i,[TL]:o}),show:!1}))}}renderComponent(){const{device:e}=this[wL],{isGrouped:t}=this.props;return a()(at.Z,{render:i=>c[mL](rt.Z,n()({isSmall:!0,onClick:this.handleHideTableClick,style:{position:vL,top:t?e.isIOS?3:4:e.isIOS?7:8,right:t?6:8,zIndex:I.timelineHideTableButton,fill:this.theme[gL]}},i),S.Z.doubleChevronLeft({width:14})),renderTooltip:()=>a()(P.FormattedMessage,{id:"database.timelineView.tableGroupResults.hideTableButton.title",[pL]:"Hide table"})})}}PL.displayName="CollectionTimelineViewHideTableButton";const DL=(0,P.injectIntl)(PL);var ML=i(24211);function ZL(e){window.__c={n:"TimelineShimmerWrapper"};const{shouldShowShimmer:t,children:i}=e,o=(0,vy.Z)(t,0,100);return a()("div",o?{className:"notion-shimmer",style:{height:"100%"}}:{},void 0,i)}const BL=i(85).xej,RL=i(85).zrY,EL=i(85).SjN,VL=i(85).hSV,AL=i(85).jx_,LL=i(85).U8r,_L=i(85).LlE,OL=i(85).GRp,FL=i(85).Isj,NL=i(85).wuN,GL=i(85).TEz,HL=i(85).tGk,WL=i(85).rI1,KL=i(85)._Fe,zL=i(85).UA5,UL=i(85).ChN,$L=i(85).Exd,QL=i(85).XCs,qL=i(85).jkI,XL=i(85).H1U,YL=i(85).EMU,jL=i(85).sM5,JL=i(85).tBn,e_=i(85).D7I,t_=i(85).NF1,i_=i(85).Au,o_=i(85).Scd,s_=i(85).nLZ,r_=i(85).tLG,n_=i(85).AR5,l_=i(85).oki,a_=i(85).Jkr,d_=i(85).wcf,h_=i(85).guB,c_=i(85).nKX,u_=i(85).BQ6,p_=i(85).nAm,m_=i(85).ydP,g_=i(85).xOW,v_=i(85).fBv,f_=i(85).X_m,y_=i(85).cx2,w_=i(85).wgE,S_=i(85).IXi,b_=i(85).qI$,k_=i(85).uM3,C_=i(85).bfN,T_=i(85).IU2,x_=i(85).WwI,I_=i(85).YNm,P_=i(85).W0d,D_=i(85).QmD,M_=i(85).oWD,Z_=i(85).P0R,B_=i(85).HwH,R_=i(85).P24,E_=i(85).EIp,V_=i(85).khk,A_=i(85).ASm,L_=22,__=32;class O_ extends p.Z{constructor(){super(...arguments),this[A_]=void 0,this.handleSeconds=()=>{0===(new Date).getSeconds()&&this[V_]()},this.activeRangeStore=this[E_]((()=>{const{[R_]:e,[B_]:t,query:i,schema:o,intl:s}=this[Z_],r=e[M_]();if(!r)return;const n=t[P_][D_],l=t[I_][D_],a=t.hoveredItem[D_],d=t[x_][D_],{[T_]:c}=te.BJ[l];if(!c)return;let u;if(n)u=n.temporaryValues.map((e=>(0,te.XO)(e,C_)));else if(d.active)u=[(0,te.XO)(d.date,C_)];else{const{stores:t}=_i.default[D_],n=t.filter((e=>e.getParentCollectionId()===r.id)),l=h().uniq(h()[k_]([...n,a]));u=h()[k_](l.map((t=>{const r=(0,te.bk)({store:t,query:i,schema:o,userId:e.getCurrentUserId(),intl:s});if(r)return(0,te.XO)(r,C_)})))}const p=h().minBy(u,(e=>{let{[b_]:t}=e;return t.valueOf()})),m=h().maxBy(u,(e=>{let{end:t}=e;return t.valueOf()}));return p&&m?{[b_]:p[b_].valueOf(),end:m.end.valueOf()}:void 0}),!0)}willMount(e){super.willMount(e)}didMount(){super.didMount(),this[A_]=setInterval(this.handleSeconds,1e3)}willUnmount(){super.willUnmount(),clearInterval(this[A_])}renderComponent(){const{[R_]:e,[B_]:t}=this[Z_],i=t[I_][D_],o=te.BJ[i],{[S_]:s,[T_]:r}=o,n=(0,te.ST)(s),l=DT.ou.now(),d=n?l.startOf("minute"):l.startOf(C_),h=l.startOf("minute"),{device:c}=this[w_],u=!e.groupsStore.anyGroupHasNonEmptyResults()&&ff({[R_]:e,groupsPointer:[]});return a()(zg,{[v_]:We.Top},void 0,a()("div",{[u_]:this[y_]()},void 0,a()("div",{[u_]:{[f_]:32,[v_]:g_,[m_]:p_}},void 0,!c.isPhone&&this.renderSecondaryIndicators()),a()("div",{[u_]:{[f_]:__,[v_]:g_,[m_]:p_}},void 0,a()(ZL,{shouldShowShimmer:u,children:this.renderPrimaryIndicators(d)}),"highlight_days"===r&&this.renderActiveRange(),this.renderNowIndicator(d),"display_range"===r&&this.renderActiveRange()),this.renderNowCircle(h)))}renderPrimaryIndicators(e){const{[B_]:t}=this[Z_],i=t[I_][D_],{startTimestamp:o,endTimestamp:s}=t[c_][D_],r=te.BJ[i],{[S_]:n,[h_]:l}=r,a=l||0,d=this[d_](e,!1),h=d.left+a,c=d.left+d[a_]-a,u=[];let p=(0,te.DS)(DT.ou[l_](o),n);for(;p.valueOf()<s;){const e=this[d_](p,!1),t=e.left+a,i=e.left+e[a_]-a;void 0!==l&&(h>=t&&h<=i||c>=t&&c<=i)||u.push(this.renderPrimaryIndicator(p,!1));p=(0,te.Ip)(p,n)}return u}renderSecondaryIndicators(){const{[B_]:e}=this[Z_],t=e[I_][D_],{startTimestamp:i,endTimestamp:o}=e[c_][D_],s=te.BJ[t],{[S_]:r,[n_]:n}=s,l=[];let a=(0,te.DS)(DT.ou[l_](i),n);for(;a.valueOf()<o;){l.push(this.renderSecondaryIndicator(a));const e=(0,te.Ip)(a,n);a=(0,te.xP)(e,r)}return l}renderActiveRange(){const{[B_]:e}=this[Z_],t=e[I_][D_],{startTimestamp:i,endTimestamp:o}=e[c_][D_],s=te.BJ[t],{[T_]:r}=s,n=this.activeRangeStore[D_];if(n){const e=(0,te.DS)(DT.ou[l_](n[b_]),C_),s=(0,te.e$)(t,e.valueOf()-i);if("highlight_days"===r){const r=[];let l=DT.ou[l_](Math.max(e.valueOf(),(0,te.DS)(DT.ou[l_](i),C_).valueOf()));for(;l.valueOf()<n.end&&l.valueOf()<o;){r.push(l);l=(0,te.Ip)(l,C_)}const d=(0,te.e$)(t,l.valueOf()-i)-s+8,h=r.map(((e,t)=>this.renderPrimaryIndicator(e,0===t||t===r.length-1)));return c[e_](c[JL],null,a()("div",{[u_]:{[v_]:r_,left:s-4,[a_]:d,[s_]:3,[f_]:L_,[o_]:this[i_].timelineDarkerBackground,[t_]:11}}),h)}{const o=(0,te.DS)(DT.ou[l_](n.end),C_),r=(0,te.cK)(DT.ou[l_](n.end),C_),l=(0,te.e$)(t,o.valueOf()-i)-s+8;return a()("div",{[u_]:{[jL]:YL,[XL]:qL,[v_]:r_,left:s-4,minWidth:l,[s_]:3,[f_]:L_,[o_]:this[i_].timelineDarkerBackground,[t_]:11,paddingLeft:6,[QL]:6}},void 0,this.renderActiveDisplayRangeIndicator(e,e.valueOf()!==r.valueOf()?r:void 0,l))}}}renderPrimaryIndicator(e,t){const{[B_]:i}=this[Z_],o=i[I_][D_],{[S_]:s}=te.BJ[o],{left:r,[a_]:n}=this[d_](e,!1);return a()("div",{[u_]:{[v_]:r_,left:r,[a_]:n,[f_]:28,[jL]:YL,[XL]:b_,lineHeight:"28px"}},r,a()("div",{[u_]:{[$L]:12,margin:"0 auto"}},void 0,this.formatPrimaryDisplayUnit(e,o,s,t)))}renderNowIndicator(e){const{[B_]:t}=this[Z_],i=t[I_][D_],{[S_]:o}=te.BJ[i],{left:s,[a_]:r}=this[d_](e,!0);return a()("div",{[u_]:{[v_]:r_,left:s,[a_]:r,[f_]:28,[jL]:YL,[XL]:qL,[UL]:500}},s,a()("div",{[u_]:{[$L]:12,margin:"0 auto",[jL]:YL}},void 0,this.formatNowIndicator(e,i,o)))}renderNowCircle(e){const{[B_]:t}=this[Z_],i=t[I_][D_],{startTimestamp:o}=t[c_][D_],s=Math.floor((0,te.e$)(i,e.valueOf()-o));return a()("div",{[u_]:{[v_]:r_,left:s-3.5,top:Math.floor(60.5),[a_]:7,[f_]:7,[o_]:this[i_].timelineRed,[t_]:"100%"}})}renderSecondaryIndicator(e){const{[B_]:t}=this[Z_],i=t[I_][D_],{startTimestamp:o}=t[c_][D_],{[n_]:s}=te.BJ[i],r=(0,te.e$)(i,e.valueOf()-o);return a()("div",{[u_]:{[v_]:r_,left:r,[f_]:__,[zL]:this[i_][KL],[$L]:14,[UL]:x.Z[UL].medium,[WL]:"middle",paddingTop:6+(this[w_].device.isMobile?2:0),[jL]:YL,[XL]:qL}},r,(0,te.EW)((0,ML.E2)(this[Z_].intl),e.valueOf(),s))}renderActiveDisplayRangeIndicator(e,t,i){return e&&t?i>=110?c[e_](c[JL],null,a()("div",{[u_]:this[HL]()},void 0,(0,bT.Yx)(e.valueOf(),"month_day",wT.SP)),a()("div",{[u_]:{flexGrow:1}}),a()("div",{[u_]:this[HL]()},void 0,(0,bT.Yx)(t.valueOf(),"month_day",wT.SP))):a()("div",{[u_]:this[HL]()},void 0,(0,bT.Yx)(e.valueOf(),"month_day",wT.SP)," – ",e.month===t.month?(0,bT.Yx)(t.valueOf(),C_,wT.SP):(0,bT.Yx)(t.valueOf(),"month_day",wT.SP)):a()("div",{[u_]:this[HL]()},void 0,(0,bT.Yx)(e.valueOf(),"month_day",wT.SP))}formatPrimaryDisplayUnit(e,t,i,o){const s=e.setLocale(wT.SP),r=(0,te.xJ)(),n=o?this[i_][KL]:this[i_][GL],l=o?this[i_][KL]:this[i_][NL],d=o?this[i_][NL]:this[i_][GL],h=s[FL]("t").startsWith(s[FL]("a"));if("fifteen_minutes"===i){if(r)return a()("span",{[u_]:{[zL]:n}},void 0,s[FL](OL));{const e=a()("span",{[u_]:{[zL]:l,[QL]:h?void 0:3}},void 0,s[FL]("h:mm")),t=a()("span",{[u_]:{[zL]:d,[QL]:h?3:void 0}},void 0,s[FL]("a"));return h?c[e_](c[JL],null,t,e):c[e_](c[JL],null,e,t)}}if("hour"===i){if(r)return a()("span",{[u_]:{[zL]:n}},void 0,s[FL](OL));{const e=a()("span",{[u_]:{[zL]:l,[QL]:h?void 0:3}},void 0,s[FL]("h")),t=a()("span",{[u_]:{[zL]:d,[QL]:h?3:void 0}},void 0,s[FL]("a"));return h?c[e_](c[JL],null,t,e):c[e_](c[JL],null,e,t)}}if("day"===i||"week"===i)return"week"===t||"bi_week"===t?c[e_](c[JL],null,a()("span",{[u_]:{[zL]:d,[QL]:3}},void 0,s[FL]("ccccc")),a()("span",{[u_]:{[zL]:l,[_L]:"2px 7px"}},void 0,s[FL]("d"))):a()("span",{[u_]:{[zL]:n}},void 0,s[FL]("d"));(0,Wp.unreachable)(i)}formatNowIndicator(e,t,i){const o=e.setLocale(wT.SP),s=(0,te.ST)(i),r=(0,te.xJ)();return s?r?a()("span",{[u_]:{[zL]:this[i_].timelineRed}},void 0,o[FL](OL)):a()("span",{[u_]:{[zL]:this[i_].timelineRed,[QL]:3}},void 0,o[FL]("t")):"week"===t||"bi_week"===t?c[e_](c[JL],null,a()("span",{[u_]:{[zL]:this[i_][GL],[QL]:3}},void 0,o[FL]("ccccc")),a()("div",{[u_]:{[v_]:g_}},void 0,a()("div",{[u_]:this[LL]()}),a()("span",{[u_]:{[v_]:g_,[zL]:AL,[_L]:"2px 7px"}},void 0,o[FL]("d")))):a()("div",{[u_]:{[v_]:g_}},void 0,a()("div",{[u_]:this[LL]()}),a()("span",{[u_]:{[v_]:g_,[zL]:AL,[_L]:"2px 7px"}},void 0,o[FL]("d")))}[d_](e,t){const{[B_]:i}=this[Z_],o=i[I_][D_],{startTimestamp:s}=i[c_][D_],{[S_]:r,[VL]:n}=te.BJ[o],l=(0,te.DS)(e,r),a=(0,te.Ip)(e,r),d=(0,te.e$)(o,l.valueOf()-s),h=(0,te.e$)(o,e.valueOf()-s),c=(0,te.e$)(o,a.valueOf()-s)-d,u=t?4:0;return{left:("range_start"===n?h-c/2:h)-u,[a_]:c+2*u}}[y_](){var e;const{[R_]:t,isInPeekRenderer:i}=this[Z_],o=(null===(e=t[EL][D_])||void 0===e?void 0:e[o_])||(i?this[i_][RL]:this[i_].contentBackground),s=t.viewIsFlushToTopbar();return{[v_]:r_,left:0,top:0,[a_]:"100%",[o_]:o,borderTop:s?`1px solid ${this[i_][BL]}`:"1px solid transparent",borderBottom:`1px solid ${this[i_][BL]}`}}[HL](){return{[zL]:this[i_][KL],[$L]:12}}[LL](){return{[o_]:this[i_].timelineRed,[a_]:22,[f_]:22,[t_]:11,[v_]:r_,left:"calc(50% - 11px)",top:"calc(50% - 11px)"}}}O_.displayName="CollectionTimelineViewTimeBar";const F_=(0,P.injectIntl)(O_);var N_=i(1742),G_=i(29376),H_=i(97180),W_=i(3072);const K_=i(85).nx5,z_=i(85).cZW,U_=i(85).AEP,$_=i(85).lmd,Q_=i(85).XPl,q_=i(85).g5Y,X_=i(85)._9S,Y_=i(85).ki8,j_=i(85).OiA,J_=i(85).icz,eO=i(85).D7I,tO=i(85).sP9,iO=i(85).xYh,oO=i(85).LtW,sO=i(85).Mcf,rO=i(85).Vgm,nO=i(85).jkI,lO=i(85).H1U,aO=i(85).ELX,dO=i(85).jQT,hO=i(85).mmP,cO=i(85).NlJ,uO=i(85).YaF,pO=i(85).P24,mO=i(85).Kiu,gO=i(85).ffk,vO=i(85).pkR;function fO(e){window.__c={n:"TableAggregation"};const{[vO]:t,[gO]:i,[mO]:o,[pO]:s,groupFormat:r,isHovered:l,onChange:d}=e,h=(0,Xn.qz)(void 0,ve.Z),u=(0,qn.O7)(),{isMobile:p}=(0,qn.Fy)(),[m,g]=(0,c.useState)(!0),v=(0,Xn.VK)((()=>{const e=s[uO].state,t=((null==e?void 0:e.aggregations)||[]).find((e=>e[gO]===i));if(!t)return;const n=r?(0,$e.zk)({[mO]:o,group:r,timeZone:(0,Qe.r)()}):void 0;return{type:cO,filter:n,[cO]:t}}),[o,r,s,i]),f=(0,c.useCallback)((e=>{e?(g(!0),d(i,{[hO]:e,[gO]:i}),D[dO](u,{view_type:"table",action:"table_change_aggregation"})):(d(i,void 0),D[dO](u,{view_type:"table",action:"table_remove_aggregation"}))}),[u,d,i]),y=(0,c.useCallback)((()=>{h.update((e=>({...e,open:!1})))}),[h]),w=(0,Yn.yK)((e=>({[aO]:{display:"flex",[lO]:nO,justifyContent:"flex-end",width:"100%",height:32,paddingRight:8,overflow:"hidden",whiteSpace:"nowrap",userSelect:"auto",[rO]:"auto"}})),[]);return a()(tt.ZP,{popupType:p?tt.Z4.SlideUp:tt.Z4.Popup,[oO]:h,[vO]:t,renderOrigin:e=>c[eO](Bo.Z,n()({[vO]:t,style:w[aO]},e),v?a()(Je.Z,{id:`table:${(0,_e.mD)(r)}:${i}:${v[cO][hO]}`,[pO]:s,[sO]:v,[tO]:r?[r]:void 0,render:e=>a()(yO,{[sO]:v,reducerResult:e,[mO]:o,[gO]:i,isHovered:l,[vO]:t,[oO]:h,[iO]:m,setIsLoading:g})}):a()(yO,{[sO]:v,[mO]:o,[gO]:i,isHovered:l,[vO]:t,[oO]:h,[iO]:m,setIsLoading:g})),render:()=>a()(W_.Z,{[gO]:i,[mO]:o,onChange:f,onClose:y,source:"tableAggregation"})})}function yO(e){window.__c={n:"TableAggregationButtonContent"};const{[sO]:t,reducerResult:i,[mO]:o,[gO]:s,isHovered:r,[vO]:n,[oO]:l,[iO]:d,setIsLoading:h}=e,{isMobile:u}=(0,qn.Fy)(),p=(0,U.Y$)(),m=(0,Xn.VK)((()=>l.getState().open),[l]),g=(0,Yn.yK)((e=>({valueStyle:{display:"flex",[lO]:nO,height:"100%",fontSize:14},aggregationTypeNameStyle:{fontSize:10,textTransform:"uppercase",letterSpacing:1,color:e.mediumTextColor,marginTop:2,marginRight:4,userSelect:"none",[rO]:"none"},[J_]:{display:"flex",[lO]:nO},placeholderText:{marginBottom:2,color:e.lightTextColor},chevronIcon:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]),{[j_]:v,reducerResultType:f}=(0,Xn.VK)((()=>{var e,t;const o=null==i||null===(e=i.getState())||void 0===e?void 0:e[j_],s=null==i||null===(t=i.getState())||void 0===t?void 0:t.type;return{[j_]:o,reducerResultType:s}}),[i]);(0,c.useEffect)((()=>{void 0!==v&&h(!1)}),[v,h]);const y=(0,c.useMemo)((()=>{if(!t||!i||"aggregation"!==f||!v)return;let e=Xe.v6[(0,Ue.OV)(t[cO])];return(0,Ue.en)(t[cO][hO])&&(e=t[cO][hO][Y_]in H_.ZA?H_.ZA[t[cO][hO][Y_]]:t[cO][hO][Y_]),e}),[v,t,i,f]),w=o[s],b=(0,Xn.VK)((()=>{if(w&&("formula"===w.type||"number"===w.type))return w[X_];if("rollup"===(null==w?void 0:w.type)&&w[q_]&&w[Q_]&&"number"===w[$_]){if(o[w[q_]]){var e;const t=(0,G_.getTargetCollectionStoreFromPropertySchema)(p,o[w[q_]]),i=null==t||null===(e=t.getModel())||void 0===e?void 0:e.getNormalizedSchema(),s=null==i?void 0:i[w[Q_]];if("number"===(null==s?void 0:s.type))return s[X_]}}}),[w,o,p]),k=(0,c.useMemo)((()=>void 0!==t&&void 0!==v?(0,Xe.Ol)({numberFormat:b,dateFormat:void 0,aggregationType:t[cO][hO],value:v,userTimeZone:(0,Qe.r)(),roundDecimal:5}):void 0),[v,b,t]);return y?c[eO](c.Fragment,null,a()("span",{style:g.aggregationTypeNameStyle},"type",y),d?a()(cu.Z,{}):a()("span",{style:g.valueStyle},"value",k)):!n&&(u||r||m)?a()(NR.Z,{isVisible:!0,animationStyle:{[U_]:1},enterAnimationStyle:{[U_]:0},exitAnimationStyle:{[U_]:0},render:()=>a()("div",{style:g[J_]},void 0,a()("span",{style:g.placeholderText},z_,a()(P.FormattedMessage,{[K_]:"Calculate",id:"database.tableView.aggregationPlaceholder"})),S.Z.chevronDown(g.chevronIcon))}):null}const wO=i(85).zrY,SO=i(85).SjN,bO=i(85).Au,kO=i(85).E0z,CO=i(85).dLQ,TO=i(85).XCs,xO=i(85).e9w,IO=i(85).k6_,PO=i(85).RZA,DO=i(85).LCr,MO=i(85).E3P,ZO=i(85).Drs,BO=i(85).JJj,RO=i(85).uM3,EO=i(85).JrN,VO=i(85).wqF,AO=i(85).qU4,LO=i(85).BQ6,_O=i(85).Jkr,OO=i(85).EMU,FO=i(85).sM5,NO=i(85).ffk,GO=i(85).wgE,HO=i(85).Gnd,WO=i(85).QmD,KO=i(85).W1o,zO=i(85).P0R,UO=i(85).xd5,$O=i(85).TN,QO=i(85).P24,qO=i(85).pkR,XO=i(85).jPE,YO=i(85).M82;class jO extends p.Z{constructor(){super(...arguments),this.storeTypes={[YO]:Pe.Z},this[XO]=(e,t)=>{const{schema:i,[qO]:o,[QO]:s,[$O]:r,[UO]:n}=this[zO],{[KO]:l}=this[HO][YO][WO],d=(0,ie.shouldShowBulkActionsToolbar)({[GO]:this[GO],[QO]:s});return a()("div",{[LO]:{[FO]:OO,[_O]:void 0!==e[_O]?e[_O]+(0===t&&d?il.Xx+1:0):void 0}},e[NO],a()(fO,{[UO]:n,[qO]:o,isHovered:(l||0===t&&!n&&r[WO])&&!o,[NO]:e[NO],[QO]:s,schema:i,onChange:this.handleTableAggregationChange}))},this.handleTableAggregationChange=(e,t)=>{const{[QO]:i,query:o}=this[zO],s=i[AO]();if(!s)return;let r=o[VO]?[...o[VO]]:[];const n=(o[VO]||[])[EO]((t=>t[NO]===e));r=n<0?h()[RO]([...r,t]):h()[RO](r.map(((e,i)=>n===i?t:e)));const l={...o,[VO]:r};z[BO]({[ZO]:"TableAggregationRow.handleTableAggregationChange",[GO]:this[GO],perform:e=>{L[MO]({[AO]:s,update:{query2:l},[DO]:e})}})},this[PO]=e=>{(0,re.ZP)({event:e,context:re.Af.EditorMouseDown,callback:()=>{}})},this.handleAggregationRowEnter=()=>{this[HO][YO].enter()},this.handleAggregationRowLeave=()=>{this[HO][YO].exit()}}renderComponent(){var e;const{[IO]:t,[QO]:i}=this[zO],o=t[WO],s=null===(e=this[zO][QO][AO]())||void 0===e?void 0:e[xO](),[r,n]=void 0!==s?[o.slice(0,s+1),o.slice(s+1)]:[[],o];return a()(zg,{position:We.Bottom},void 0,a()(FR.p,{allowSelectionWithin:!1,[LO]:this.getAggregationsRowStyle(),onMouseMove:this.handleAggregationRowEnter,onMouseLeave:this.handleAggregationRowLeave,onMouseDown:this[PO]},void 0,a()("div",{[LO]:{[FO]:OO,[TO]:!this[zO][qO]&&this[zO].showRightActionsSpacer?32:0}},void 0,a()("div",{[LO]:{[FO]:OO}},void 0,void 0!==s&&a()("div",{[LO]:{...(0,il.oc)({[QO]:i,[CO]:this[GO][kO][CO],[bO]:this[bO]}),[FO]:"flex"}},void 0,r.map(this[XO])),n.map(((e,t)=>this[XO](e,t+(void 0!==s?s+1:0))))))))}getAggregationsRowStyle(){var e;const{[QO]:t,isInPeekRenderer:i}=this[zO],o=(null===(e=t[SO][WO])||void 0===e?void 0:e.background)||(i?this[bO][wO]:this[bO].contentBackground);return{[FO]:OO,position:"absolute",background:o,zIndex:I.collectionStickyBottomElement,fontSize:14,height:NX+(this[zO].isFullScreen?fe.Z[WO]:0)+1,minWidth:"100%",clipPath:"polygon(0% -20%, 100% -20%, 100% 100%, 0% 100%)",left:0,borderTop:`1px solid ${this[bO].tableDividerColor}`,...this[zO][LO]}}}jO.displayName="TableAggregationRow";const JO=jO,eF=i(85).nx5,tF=i(85).EiQ,iF=i(85).vwl,oF=i(85).miS,sF=i(85).P24;function rF(e){window.__c={n:"TableEmptyPlaceholder"};const{[sF]:t,[oF]:i,paddingLeft:o,handleAddRowClick:s}=e,r=(0,Xn.VK)((()=>Boolean(t[iF].state||t[tF].state.length>0)),[t]),n=(0,Xn.VK)((()=>t.shouldShowSpinner.state),[t]),l=(0,vy.Z)(n,ie.collectionViewLoadingSpinnerThrottles.showDelay,ie.collectionViewLoadingSpinnerThrottles.showHold,!0),d=(0,Yn.yK)((e=>({button:{display:"flex",alignItems:"center",height:FX+1,width:"100%",paddingLeft:GX,fontSize:14,lineHeight:x.Z.lineHeight.UIRegular.desktop,background:e.contentBackground,left:0,right:0,textAlign:"center",borderBottom:"1px solid transparent"},buttonInner:{color:e.lightTextColor,position:"sticky",left:o+GX}})),[o]);return a()(Bo.Z,{onClick:s,onMouseDown:re.$0,disabled:!i,style:d.button},void 0,a()("span",{style:d.buttonInner},void 0,a()(P.FormattedMessage,l?{[eF]:"Loading results…",id:"database.tableView.loadingResults"}:i?r?{[eF]:"No filter results. Click to add a row.",id:"database.tableView.emptyTablePlaceholderWithFilters"}:{[eF]:"Empty. Click to add a row.",id:"database.tableView.emptyTablePlaceholder"}:r?{[eF]:"No filter results.",id:"database.tableView.cannotEdit.emptyTablePlaceholderWithFilters"}:{[eF]:"Empty.",id:"database.tableView.cannotEdit.emptyTablePlaceholder"})))}var nF=i(46328),lF=i(87085),aF=i(73060);class dF extends v.default{getInitialState(){return{}}}const hF=dF;var cF=i(12137),uF=i(15095),pF=i(25898),mF=i(62619),gF=i(45452);const vF=i(85).D7I,fF=i(85).LWT,yF=i(85).Omf,wF=i(85).rGB,SF=i(85)._S$,bF=i(85).iDK,kF=i(85).qEN,CF=i(85).gde,TF=i(85).w3q,xF=i(85).$bT,IF=i(85).qKK,PF=i(85).kLA,DF=i(85).t4z,MF=i(85).X_m,ZF=i(85).HcV,BF=i(85).qnp,RF=i(85).u9,EF=i(85).GCx;const VF={position:"absolute",display:"flex",opacity:.5,zIndex:81},AF=function(e){window.__c={n:"DraggableSectionedGhostList"};const t=(0,c.useRef)(null),i=(0,c.useRef)(),o=(0,Xn.qz)(e.store,gF.Z),s=(0,Xn.VK)((()=>o.state),[o]),{[EF]:r,sectionedKeys:l,sectionStyles:d,keys:p,disableVerticalEdgeScroll:m,[RF]:g,disabled:v}=e,f={..."horizontal"===r?xk.l8:xk.yA,...s[BF]&&{position:"relative",zIndex:1,width:s[ZF].width,[MF]:s[ZF][MF]},...e.style};function y(e){return"string"==typeof e?e:e.key}const w=(0,Xn.VK)((()=>p.map(((t,i)=>{const{renderKey:o,[EF]:r}=e,n=y(t),l=o(n,i,e.keys.map(y).map(y));if(s[BF]&&s[TF]===n){const{savedKeyRects:e,[ZF]:t,[CF]:o,[kF]:d}=s,h=e[i];let c,u;"vertical"===r?(c=(0,cF.Z)(h.top+d,t.top,t.top+t[MF]-h[MF])-t.top,u=h.left-t.left):(c=h.top-t.top,u=(0,cF.Z)(h.left+o,t.left,t.left+t.width-h.width)-t.left);const p={...VF,left:u,top:c,width:h.width,[MF]:h[MF],zIndex:1};return a()("div",{style:p},n,l)}}))),[p,e,s]);function S(){const{[EF]:o}=e;return i[bF]||(i[bF]="vertical"===o?(0,de.VW)(u.findDOMNode(t[bF])):(0,de.xH)(u.findDOMNode(t[bF]))),i[bF]}const b=v?{}:{[fF]:()=>{s[BF]&&o.reset()},onDraggableDragEnd:()=>{if(s[BF]){const{keys:t,onDrop:i}=e,{[DF]:r,[PF]:n}=s;if(r!==n){const e=h().clone(t);e.splice(n,0,e.splice(r,1)[0]);const o=y(t[r]);i(e.map(y),{key:o,startPosition:r,endPosition:n})}e.onDragEnd&&e.onDragEnd(),o.reset()}},onDraggableDragStart:i=>{i.preventDefault();const{keys:s}=e,r=u.findDOMNode(t[bF]);if(!r)return;if(!(r instanceof Element))return;const n=mF.closestNode(i.target,(e=>mF.isElement(e)&&e.classList.contains(X.draggableGhostSection))),a=mF.closestNode(i.target,(e=>e.parentNode===n));if(n&&a){const t=uF[SF](r[wF]).indexOf(n),i=uF[SF](n[wF]).indexOf(a);let d=0;const c=Object.keys(l);for(let e=0;e<t;e++)d+=l[c[e]].length;d+=i;const u=s[d];if("object"==typeof u&&!u.draggable)return;const p=r[yF](),m=h().flatten(h().map(Object.keys(l),((e,t)=>h().map(l[e],((e,i)=>r[wF][t][wF][i][yF]()))))),g=S();if(g){const t=y(s[d]);e.onDraggingKeyChanged&&e.onDraggingKeyChanged(t),o.setState({[BF]:!1,willDrag:!0,[CF]:0,[kF]:0,[TF]:t,[DF]:d,startScrollX:g.scrollLeft,startScrollY:g.scrollTop,[PF]:d,[ZF]:p,savedKeyRects:m})}}},onDraggableDragMove:t=>{!s[BF]&&s.willDrag&&s[TF]&&(0,pF.Z)(t.startX,t.startY,t.currentX,t.currentY)>=ae.minDragDist[t.device]&&(o.setState({[CF]:s[CF],[kF]:s[kF],startScrollX:s.startScrollX,startScrollY:s.startScrollY,[DF]:s[DF],[PF]:s[PF],savedKeyRects:s.savedKeyRects,[ZF]:s[ZF],[TF]:s[TF],[BF]:!0,willDrag:!1}),e.onDragStart&&e.onDragStart());const i=S();if(s[BF]&&i){const{savedKeyRects:e,startScrollX:r,startScrollY:n}=s,l=i.scrollLeft-r,a=i.scrollTop-n,d=h().minBy(e,(e=>(0,pF.Z)(t.currentX+l,t.currentY+a,e.left+e.width/2,e.top+e[MF]/2)));if(d){const i=e.indexOf(d);o.setState({...s,[CF]:t.diffX+l,[kF]:t.diffY+a,[PF]:i})}}}};return c[vF](c.Fragment,null,c[vF](ZT.Z,n()({ref:t},b,{forceTouch:!0,allowDragWhileTextEditing:!0,disableVerticalEdgeScroll:m||"horizontal"===r,[RF]:g||"vertical"===r,render:t=>{let i=0;return c[vF]("div",n()({style:f},t),Object.entries(l).map((t=>{let[o,r]=t;const n=((e,t)=>a()("div",{className:X.draggableGhostSection,style:null==d?void 0:d[e]},e,t))(o,r.map(((t,o)=>((t,i)=>{const{renderKey:o}=e,r=y(t),n=o(r,i,e.keys.map(y).map(y));let l="";if(s[BF]){const{[DF]:t,[PF]:o}=s;t===o?l="":"horizontal"===e[EF]?o===i&&i<t?l=`inset 4px 0 ${yh.ZP[IF](.5)}`:o===i&&i>t&&(l=`inset -4px 0 ${yh.ZP[IF](.5)}`):"vertical"===e[EF]&&(o===i&&i<t?l=`inset 0 4px ${yh.ZP[IF](.5)}`:o===i&&i>t&&(l=`inset 0 -4px ${yh.ZP[IF](.5)}`))}return a()("div",{style:{display:"flex",[xF]:"vertical"===e[EF]?"column":"horizontal"===e[EF]?"row":(0,Wp.unreachable)(e[EF]),boxShadow:l}},r,n)})(t,o+i))));return i+=r.length,n})))}})),w)};var LF=i(39068),_F=i(79362),OF=i(74446),FF=i(90985),NF=i(16956),GF=i(4636),HF=i(80402),WF=i(99417),KF=i(75081),zF=i(67695),UF=i(30905),$F=i(26122),QF=i(41837),qF=i(28992),XF=i(74420),YF=i(86825);const jF=i(85).ewQ;function JF(e){window.__c={n:"FrozenColumnDivider"};const t=(0,qn.Fy)().isMobile,i=(0,Yn.yK)((e=>({border:{position:"absolute",top:0,right:0,width:1,height:"calc(100% + 1px)",background:"dark"===e.mode?e[jF].gray[500]:e[jF].gray[200]},shadow:{position:"absolute",top:0,right:-4,width:4,height:"calc(100% + 1px)",background:"dark"===e.mode?"transparent":`linear-gradient(to right, ${yh.se[e.mode].gray.alpha(.15).css()},\n                                ${yh.se[e.mode].gray.alpha(.1).css()},  transparent)`}})),[]);return t?null:c.createElement(c.Fragment,null,a()("div",{style:i.border}),e.isScrolled&&a()(NR.Z,{isVisible:!0,animationStyle:{opacity:e.isScrolled?1:0},render:()=>a()("div",{style:i.shadow})}))}var eN=i(42402);const tN=i(85).mPA,iN=i(85).D7I,oN=i(85).xOW,sN=i(85).fBv,rN=i(85).ZWc,nN=i(85).X_m,lN=i(85).mFu,aN=i(85).EMU,dN=i(85).sM5,hN=i(85).jkI,cN=i(85).UPJ,uN=i(85).$Vg,pN=i(85).H1U,mN=i(85).PXg,gN=i(85).P24;function vN(e){window.__c={n:"MultiSelectCheckbox"};const{checkedState:t,onClick:i,checkboxType:o,[gN]:s}=e,r=(0,qn.O7)(),n=(0,Xn.qz)(void 0,Pe.Z),l=(0,Xn.VK)((()=>n.state.mouseEntered),[n]),d=(0,c.useRef)(null);(0,c.useEffect)((()=>{d.current&&(d.current.indeterminate="indeterminate"===t)}),[t]);const h=(0,Xn.VK)((()=>JE.ZP.state.isDragging),[]),u=(0,c.useCallback)((e=>{i(e),R.trackCollectionsMultiSelectCheckboxClicked({environment:r,[gN]:s,checkbox_type:o})}),[o,s,r,i]);return a()(NR.Z,{isVisible:!0,animationStyle:{opacity:!1===t&&!l||h?0:1},render:()=>a()("label",{style:{[mN]:`${il._n}px`,[pN]:uN,[cN]:hN,[dN]:aN,cursor:lN,zIndex:1},onMouseEnter:()=>n.enter(),onMouseLeave:()=>n.exit(),onClick:re.Wi,onMouseDown:re.$0},void 0,a()("div",{style:{width:`${il.bu}px`,[nN]:`${il.bu}px`,[dN]:aN,[cN]:hN,[pN]:hN}},void 0,c[iN](tN,{type:rN,style:{width:il.tA,[nN]:il.tA,cursor:lN,[sN]:oN,right:"2px"},ref:d,checked:!0===t,onChange:u})))})}const fN=i(85).p2z,yN=i(85).MRL,wN=i(85).sOA,SN=i(85).$bT,bN=i(85).plP,kN=i(85).nLZ,CN=i(85).PXg,TN=i(85).XNW,xN=i(85).TEz,IN=i(85).h$M,PN=i(85).hd7,DN=i(85).rER,MN=i(85).x1G,ZN=i(85).dMt,BN=i(85).Mm1,RN=i(85).kUY,EN=i(85).bey,VN=i(85).N1Z,AN=i(85).zwB,LN=i(85).Yzm,_N=i(85).Uk6,ON=i(85).nx5,FN=i(85).sei,NN=i(85).NLk,GN=i(85).k$k,HN=i(85).TtP,WN=i(85).Y$Q,KN=i(85).YDe,zN=i(85).unR,UN=i(85).vnp,$N=i(85).zkl,QN=i(85).C3o,qN=i(85).Cr4,XN=i(85).HxR,YN=i(85).Xl2,jN=i(85).vHy,JN=i(85).xQb,eG=i(85).eiN,tG=i(85).voC,iG=i(85).nSw,oG=i(85).uzK,sG=i(85).EiQ,rG=i(85).QSf,nG=i(85).ddU,lG=i(85).jQT,aG=i(85).nXm,dG=i(85).swS,hG=i(85).zaB,cG=i(85).veG,uG=i(85).fBu,pG=i(85).v1$,mG=i(85).JmH,gG=i(85).Uww,vG=i(85).mYq,fG=i(85).rG,yG=i(85).ZYq,wG=i(85).iEt,SG=i(85).UD6,bG=i(85).TuS,kG=i(85).s3u,CG=i(85).rGX,TG=i(85).x3V,xG=i(85).e7B,IG=i(85).E3P,PG=i(85).urI,DG=i(85).X5t,MG=i(85).BQW,ZG=i(85).Mt_,BG=i(85).LCr,RG=i(85).nxU,EG=i(85).Drs,VG=i(85).JJj,AG=i(85).UBi,LG=i(85).oWD,_G=i(85).rUR,OG=i(85).Dkz,FG=i(85).K0Z,NG=i(85).rpY,GG=i(85).Joh,HG=i(85).OBh,WG=i(85).XCs,KG=i(85).YDv,zG=i(85).gGi,UG=i(85).Jkr,$G=i(85).jkI,QG=i(85).H1U,qG=i(85).EMU,XG=i(85).sM5,YG=i(85).ESK,jG=i(85).BQ6,JG=i(85).Au,eH=i(85).S6b,tH=i(85).TUY,iH=i(85).mSd,oH=i(85).cx2,sH=i(85).rQ1,rH=i(85).QmD,nH=i(85).e9w,lH=i(85).qU4,aH=i(85).sP9,dH=i(85)._V5,hH=i(85).pkR,cH=i(85).Kiu,uH=i(85).ffk,pH=i(85).XjH,mH=i(85).P24,gH=i(85).XO9,vH=i(85).EIp,fH=i(85).Gnd,yH=i(85).Wp_,wH=i(85).YGn,SH=i(85).E0z,bH=i(85).dLQ,kH=i(85).I7D,CH=i(85).Zj$,TH=i(85).wgE,xH=i(85).b8T,IH=i(85).D7I,PH=i(85).P0R,DH=i(85).wfR,MH=i(85).p6m,ZH=i(85).LtW;class BH extends p.Z{constructor(){super(...arguments),this.storeTypes={[ZH]:ve.Z,[MH]:v.default[DH](void 0)},this.renderPopup=e=>c[IH](RH,n()({},this[PH],{parent:e})),this[xH]=()=>{K.clear(this[TH]),W.clear(this[TH]),L[CH]()},this[kH]=e=>{this[TH][SH][bH]||(e[wH](),(0,re.ZP)({event:e,context:re.Af.EditorContextMenu,callback:()=>{this[xH](),this[fH][ZH][yH]({open:!0})}}))},this.shouldShowMultiSelectCheckbox=this[vH]((()=>{const{[gH]:e,[mH]:t}=this[PH];return(0,ie.shouldShowBulkActionsToolbar)({[TH]:this[TH],[mH]:t})&&0===e}))}get registries(){return[zF.Z]}[pH](){var e;const{[uH]:t,[cH]:i,[hH]:o,[mH]:s,isScrolled:r,renderSpacer:l,[dH]:d,isLast:h,[gH]:u,[aH]:p}=this[PH],m=i[t],{[SH]:g}=this[TH];if(!m)return;const v=null===(e=s[lH]())||void 0===e?void 0:e[nH](),f=void 0!==v&&v===u,y=this.shouldShowMultiSelectCheckbox[rH],w=s[sH][rH];return c[IH](c.Fragment,null,y&&a()(EH,{[aH]:p,[mH]:s}),a()("div",{[jG]:this[oH](),className:X.tableViewHeaderCell,onContextMenu:this[kH]},void 0,a()(tt.ZP,{popupType:g[bH]?nt.kQ.SlideUp:nt.kQ.Popup,[hH]:!w[iH],originGap:1,alignmentToOrigin:tt.vR.Start,[ZH]:this[fH][ZH],renderOrigin:e=>a()(at.Z,{[GG]:()=>{const e=(0,Ii.getAiInferenceFromPropertySchema)(m);return a()("div",{},void 0,a()("div",{},void 0,m.name),e&&e[tH]&&a()("div",{[jG]:{color:this[JG][eH]}},void 0,c[IH](P.FormattedMessage,QF.sY.keptUpToDateWithNotionAITooltip)))},delayThreshold:500,placement:at.Z[YG].Right,[NG]:i=>c[IH](Bo.Z,n()({[jG]:{[XG]:qG,[QG]:$G,[UG]:zG,height:zG,[KG]:8,[WG]:8,[dH]:d},[hH]:o},(0,je.Z)(i,e)),l&&l(h),a()(GR.Z,{[HG]:m,showIcon:!0,showBadge:!0,[jG]:BH.propertyStyle,[uH]:t}),f&&a()(JF,{isScrolled:Boolean(r)}))}),[NG]:this.renderPopup,onClick:this[xH]})))}[oH](){const{[UG]:e,disableCellRightBorder:t}=this[PH];return{[XG]:qG,flexShrink:0,overflow:"hidden",fontSize:14,padding:0,[UG]:e,borderRight:t?void 0:`1px solid ${this[JG].tableDividerColor}`}}}BH.displayName=CG,BH.propertyStyle={fontSize:14};class RH extends p.Z{constructor(){super(...arguments),this.storeTypes={propertyTypeButtonPopupStore:ve.Z,[FG]:v.default[DH]("")},this[OG]=e=>{if(this[_G]())return;const{[uH]:t,[mH]:i}=this[PH],o=i[LG]();if(!o)return;const s=o[AG]()[t];(null==s?void 0:s.name)!==e&&(z[VG]({[EG]:"TableHeaderCell.handlePropertyNameSubmit",[TH]:this[TH],[RG]:i=>{NF.Bv({[LG]:o,[uH]:t,name:e,[BG]:i})}}),R[ZG]({[TH]:this[TH],[mH]:i,[uH]:t,from:MG,[DG]:"rename"}))},this.handleHide=()=>{const{[mH]:e,[uH]:t,[PG]:i,formatKey:o,[gH]:s}=this[PH],r=e[lH]();if(!r)return;const n=(i[o]||[]).map((e=>e[uH]===t?{...e,visible:!1}:e)),l={...i,[o]:n};z[VG]({[EG]:"TableHeaderCell.updatePropertyFormat",[TH]:this[TH],[RG]:t=>{L[IG]({[lH]:r,[xG]:{[PG]:l},[BG]:t}),HF[TG]({[TH]:this[TH],[mH]:e,currentIndex:s,entrypoint:CG,[BG]:t,propertyAction:"hide"})}})},this[kG]=()=>{const{[mH]:e}=this[PH];z[VG]({[EG]:"TableHeaderCell.handleFreezeColumns",[TH]:this[TH],[RG]:t=>{HF[TG]({[TH]:this[TH],[mH]:e,currentIndex:this[PH][gH],[BG]:t,entrypoint:CG})}})},this[bG]=()=>{var e;const{[PG]:t,formatKey:i,[uH]:o}=this[PH];return null===(e=t[i])||void 0===e?void 0:e.find((e=>e[uH]===o))},this[SG]=async()=>{const{[mH]:e,[uH]:t}=this[PH];await NF.TI({[TH]:this[TH],[mH]:e,[uH]:t,[wG]:this[wG],[JG]:this[JG]})},this[wG]=()=>{const{[uH]:e,[cH]:t,[mH]:i,[gH]:o}=this[PH],s=i[LG]();if(!s)return;z[yG]({[TH]:this[TH],[EG]:"TableHeaderCell.handleDeleteAccept",waitForServerCommit:!1,[RG]:async r=>{await NF.yV({[TH]:this[TH],[LG]:s,[cH]:t,[uH]:e,[BG]:r}),HF[TG]({[TH]:this[TH],[mH]:i,currentIndex:o,entrypoint:CG,[BG]:r,propertyAction:fG})}});const r=s[AG]()[e];r&&R.trackDeleteProperty({[TH]:this[TH],[mH]:i,[vG]:r.type,from:"table_column",[uH]:e})},this.handleDuplicate=async()=>{const{[uH]:e,[mH]:t,formatKey:i,[gH]:o}=this[PH],s=this[bG](),r=t[LG](),n=t[lH](),l=t[gG][rH][i]||[],a=null==r?void 0:r[mG]();if(!(r&&n&&a&&s))return;const d=r[AG](),h=d[e];if(!h)return;const c=await(0,ie.getDuplicatePropertyUpdate)({[TH]:this[TH],[cH]:d,[uH]:e,[pG]:l,[uG]:r,spaceId:a});c&&(z[VG]({[EG]:"TableHeaderCell.handleDuplicate",[TH]:this[TH],[RG]:e=>{L[cG]({[TH]:this[TH],[LG]:r,[xG]:{[c.newProperty]:c.newPropertySchema},[BG]:e}),HF[TG]({[TH]:this[TH],[mH]:t,currentIndex:o,entrypoint:CG,[BG]:e,propertyAction:hG}),c.automationUpdate&&L[dG]({[TH]:this[TH],[LG]:r,[xG]:c.automationUpdate,[BG]:e}),i&&Ne[aG]({[fH]:[n],[xG]:{[i]:c.newProperties},[BG]:e})}}),R[lG]({[TH]:this[TH],[mH]:t,[DG]:"duplicate_property",[nG]:null==n?void 0:n[rG](),[vG]:h.type}))},this.handleAddFilter=()=>{const{[uH]:e,[mH]:t,[cH]:i}=this[PH],o=t[sG][rH],s=t[oG](),r=(null==s?void 0:s[tG][iG])??OF.mF.constant(void 0);let n=o.find((t=>{let{[eG]:i}=t;return i[uH]===e}));if(!n){const s=(0,Y.H_)({[uH]:e,[cH]:i,[iG]:r});if(!s)return;const l={id:(0,Hp.default)(),[eG]:s};t.filtersBarOpen[yH](!0),FF[JN]({[TH]:this[TH],[mH]:t,[jN]:{...t[jN][rH],propertyFilters:{value:[...o,l]}}}),n=l}if(!n)return;const l=t.getFilterBarItemSettingsStore(n);V[YN]({[XN]:l,item:{type:eG}}),L[qN]({[mH]:t})},this.handleSortAscending=()=>{this.createSort(!0)},this.handleSortDescending=()=>{this.createSort(!1)},this[QN]=(e,t)=>{const{[uH]:i,[mH]:o}=this[PH],s=o[LG]();s&&(z[VG]({[EG]:"TableHeaderCell.handlePropertyIconSubmit",[TH]:this[TH],[RG]:t=>{NF.OK({[LG]:s,[uH]:i,icon:e,[BG]:t})}}),R[ZG]({[TH]:this[TH],[mH]:o,[uH]:i,icon:e,from:$N,[DG]:"change_icon"}))},this[UN]=this[vH]((()=>{const e=this[PH][mH][lH]();return!!e&&(ke.default[zN]("freeze_columns")&&"table"===e[rG]())})),this.isRightmostFrozen=this[vH]((()=>{const e=this[PH][mH][lH]();if(!e)return!1;const t=e[nH]();return Boolean(void 0!==t&&this[PH][gH]===t)})),this[KN]=this[vH]((()=>{var e,t;return null===(e=this[PH][mH][lH]())||void 0===e||null===(t=e.getModel())||void 0===t?void 0:t[rG]()}))}willMountOrUpdate(e){const{[uH]:t,[cH]:i,[mH]:o}=e,s=i[t];if(s&&"relation"===s.type){const e=G_[WN](o,s);null==e||e.load()}}[pH](){const{[SH]:e}=this[TH];let t;t=e[bH]?{menuType:Ye.og.ActionSheet}:{menuType:Ye.og.Popup,minWidth:220};const i=this.getMenuSections(this[PH].parent);return c[IH](it.Z,t,a()(ot.Z,{type:ot.i.Vertical,initialFocus:void 0,sections:h().compact(i.map(((e,t)=>{if(e[HN]>0)return{key:t,[NG]:e=>c[IH](lt.Z,n()({},e,{topBorder:0!==t})),items:e}})))}))}[_G](){const{[uH]:e,[cH]:t}=this[PH],{[FG]:i}=this[fH],o=i[rH],s=Object.keys(t).find((i=>{var s;return i!==e&&(null===(s=t[i])||void 0===s?void 0:s.name)===o}));return Boolean(s)}getMenuSections(e){var t;const{[uH]:i,[cH]:o,[mH]:s,formatKey:r,allowHidingTitle:l,[PG]:d}=this[PH],{[TH]:h,[JG]:u}=this,{[SH]:p}=h,m=o[i],g=s[sH][rH],v=s.settingsStore,f=s[lH](),y=s[LG]();if(!f||!m)return[];const w=(0,Hi.isExternalPropertyId)(i),b=Boolean((null===(t=this[bG]())||void 0===t?void 0:t.wrap)||f.getFormat().table_wrap)&&"timeline"!==f[rG](),k=s.databaseType,C=Boolean(y&&k&&q.cR(k,i,y)),T="title"===m.type,x=[];if(w&&"person"===m.type){const e=[];x[GN](e),e[GN]({key:"synced_person",[NG]:e=>c[IH](qF.Z,n()({},e,{title:m.name||"",icon:S.Z.info({[UG]:14}),caption:a()("div",{[jG]:{[NN]:"pre-wrap",wordBreak:FN,minWidth:300,maxWidth:350}},void 0,a()(P.FormattedMessage,{[ON]:"People synced from external sources may require additional set up. Visit <helpcenterlink>the help center</helpcenterlink> for more information.",id:"database.tableHeaderCell.syncedPersonPropertyCaption",values:{helpcenterlink:function(){for(var e=arguments[HN],t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return a()(eN.Z,{href:(0,TB.getLocalizedUrl)("guides.syncedContent")},void 0,t)}}}))})),[DG]:()=>{}})}if(g[_N]&&!w){const t=[];if(x[GN](t),t[GN]({key:"rename",[NG]:t=>a()(lt.Z,{},void 0,c[IH]($F.Z,n()({},t,{initialValue:m.name||"",placeholder:ne.default[LN](QF.sY[AN]),focusInitial:!0,[FG]:this[fH][FG],onBlur:this[OG],onSubmit:t=>{this[OG](t),e[VN]()},iconButton:{icon:e=>a()(LF.ZP,{type:m.type,icon:m.icon,size:16,[JG]:u,[jG]:e}),[EN]:{fill:_F.IconColorVariationsMap[u.mode][RN]},enforceIconColor:RN,onSubmit:this[QN]}})),this[_G]()&&a()(QF.mJ,{propertyName:this[fH][FG][rH],styles:p[bH]?{[BN]:5,[KG]:16,[WG]:16,margin:0,boxShadow:`inset 0 -1px 0 ${u[ZN]}`}:{}})),[DG]:()=>{R[lG]({[TH]:this[TH],[mH]:s,[DG]:"table_header_rename"}),L[qN]({[mH]:s}),e[VN]()}}),t[GN]({key:"edit_property",[NG]:e=>a()(at.Z,{placement:at.Z[YG].Left,[NG]:t=>c[IH](et.Z,n()({[hH]:void 0===y,title:a()(P.FormattedMessage,{[ON]:"Edit property",id:MN}),icon:S.Z.options({[UG]:14})},(0,je.Z)(e,t))),[jG]:{[NN]:"normal"},[GG]:()=>a()(P.FormattedMessage,{[ON]:"Edit property name, type, and other options...",id:"database.tableHeaderCell.editPropertyTooltip"})}),[DG]:()=>{y&&(R[lG]({[TH]:this[TH],[mH]:s,[DG]:"table_header_edit"}),L[qN]({[mH]:s}),e[VN](),V[DN]({[mH]:s,[XN]:v}),V[PN]({[XN]:v,item:{type:pG,timelineViewTab:$N}}),V[PN]({[XN]:v,item:{type:uH,formatKey:r,[uH]:i,[IN]:y.pointer}}))}}),y&&(0,WF.Zt)(this[TH])&&(0,Ii.isAiAutofillablePropertySchema)(m)){const o=(0,Ii.getAiInferenceFromPropertySchema)(m),l=Pi.getUpdateAiInferencesForCollectionRunningState(y.getFormat(),i);o?t[GN]({key:"fill_all_pages",[NG]:e=>a()(at.Z,{placement:at.Z[YG].Left,[GG]:()=>a()(UF.qQ,{[LG]:y,[HG]:m}),[NG]:t=>c[IH](et.Z,n()({titleStyle:{color:l.isRunning?u[xN]:void 0},[hH]:l.isRunning||!y,icon:a()(UF.Xh,{updateAiInferencesTaskStatus:l,[EN]:{[TN]:-1,[CN]:-1},progressIconStyle:{[kN]:4,[TN]:0,[CN]:-3}}),title:a()(UF.ZP,{updateAiInferencesTaskStatus:l}),caption:void 0!==l.numPagesFilled&&void 0!==l[bN]&&a()(UF.Y7,{updateAiInferencesTaskStatus:l})},(0,je.Z)(e,t)))}),[DG]:async()=>{await GF.autofillPropertyForCollection({[TH]:h,[LG]:y,[HG]:m,[uH]:i})}}):t[GN]({key:"autofill_with_ai",[NG]:e=>c[IH](et.Z,n()({[hH]:void 0===y,title:a()("div",{[jG]:{[XG]:qG,[SN]:"row",[QG]:$G}},void 0,a()(P.FormattedMessage,{[ON]:"Set up AI autofill",id:"database.tableHeaderCell.autofillWithAI"}),a()(XF.Z,{[jG]:{[XG]:wN}})),icon:S.Z.magicWand({[UG]:14,fill:u[yN]})},e)),[DG]:()=>{y&&(e[VN](),V[DN]({[mH]:s,[XN]:v}),V[PN]({[XN]:v,item:{type:pG,timelineViewTab:$N}}),V[PN]({[XN]:v,item:{type:uH,formatKey:r,[uH]:i,[IN]:y.pointer}}),V[PN]({[XN]:v,item:{type:"propertyAiAutofill",[HG]:m,[uH]:i}}))}})}}if(g[iH]){const t=[];x[GN](t),t[GN]({key:"sort_asc",[NG]:e=>c[IH](et.Z,n()({},e,{title:a()(P.FormattedMessage,{[ON]:"Sort ascending",id:"database.tableHeaderCell.sortAscending"}),icon:S.Z.arrowUp({[UG]:14})})),[DG]:()=>{R[lG]({[TH]:this[TH],[mH]:s,[DG]:"table_header_sort_asc"}),e[VN](),this.handleSortAscending()}}),t[GN]({key:"sort_desc",[NG]:e=>c[IH](et.Z,n()({},e,{title:a()(P.FormattedMessage,{[ON]:"Sort descending",id:"database.tableHeaderCell.sortDescending"}),icon:S.Z.arrowDown({[UG]:14})})),[DG]:()=>{R[lG]({[TH]:this[TH],[mH]:s,[DG]:"table_header_sort_desc"}),e[VN](),this.handleSortDescending()}}),t[GN]({key:eG,[NG]:e=>c[IH](et.Z,n()({},e,{title:a()(P.FormattedMessage,{[ON]:"Filter",id:"database.tableHeaderCell.filter"}),icon:S.Z[eG]({[UG]:14})})),[DG]:()=>{"collectionVirtualView"!==s.contextType&&(R[lG]({[TH]:this[TH],[mH]:s,[DG]:"table_header_filter"}),e[VN](),this.handleAddFilter())}})}const I=[];if(x[GN](I),(l||"title"!==m.type)&&g[iH]&&I[GN]({key:"hide",[NG]:e=>c[IH](et.Z,n()({},e,{title:a()(P.FormattedMessage,{[ON]:"Hide in view",id:"database.tableHeaderCell.hideInView"}),icon:S.Z.eyeHidePadded({[UG]:22,[TN]:-4,[CN]:-4})})),[DG]:()=>{R[lG]({[TH]:this[TH],[mH]:s,[DG]:"table_header_hide"}),e[VN](),this.handleHide()}}),this[UN][rH]&&!p[bH]&&"table"===this[KN][rH]&&g[iH]&&I[GN]({key:"freeze_column",[NG]:e=>c[IH](et.Z,n()({},e,{title:this.isRightmostFrozen[rH]?a()(P.FormattedMessage,{[ON]:"Unfreeze columns",id:"database.tableHeaderCell.unfreezeColumns"}):a()(P.FormattedMessage,{[ON]:"Freeze up to column",id:"database.tableHeaderCell.freezeUpToColumn"}),icon:this.isRightmostFrozen[rH]?S.Z.pinStrikethrough({[UG]:14}):S.Z.pin({[UG]:12,margin:"0px 1px"})})),[DG]:()=>{this[kG]()}}),!ai.Tr.includes(m.type)||(0,Ii.isNonDuplicatablePropertySchema)(m)||!g[_N]||w||T||I[GN]({key:hG,[NG]:e=>c[IH](et.Z,n()({},e,{title:a()(P.FormattedMessage,{[ON]:"Duplicate property",id:"database.tableHeaderCell.duplicateProperty"}),icon:S.Z[hG]({[UG]:14})})),[DG]:async()=>{R[lG]({[TH]:this[TH],[mH]:s,[DG]:"table_header_duplicate"}),e[VN](),await this.handleDuplicate()}}),ai.Tr.includes(m.type)&&g[_N]&&!w&&!T&&I[GN]({key:fG,[NG]:e=>a()(at.Z,{placement:at.Z[YG].Left,disableTooltip:!C,[GG]:e=>(0,KF.A7)(k,e),[NG]:t=>c[IH](et.Z,n()({},e,t,{[hH]:C,disabledFeedback:C,title:a()(P.FormattedMessage,{[ON]:"Delete property",id:"database.tableHeaderCell.deleteProperty"}),caption:this[TH][SH][bH]&&C?(0,KF.A7)(k):null,icon:C?c[IH]("div",t,S.Z.lockedFilled({[UG]:14})):S.Z.trash({[UG]:14})}))}),[DG]:async()=>{R[lG]({[TH]:this[TH],[mH]:s,[DG]:"table_header_delete"}),e[VN](),await this[SG]()}}),g[iH]&&"timeline"!==f[rG]()){const e=[];x[GN](e),e[GN]({key:"wrap_cell",[NG]:e=>c[IH](YF.Z,n()({},e,{title:a()(P.FormattedMessage,{[ON]:"Wrap column",id:"database.tableHeaderCell.wrapColumn"}),on:b})),[DG]:()=>{HF.toggleWrapColumn({currentValue:b,[TH]:this[TH],[uH]:i,[lH]:f,[PG]:d,formatKey:r}),R[lG]({[TH]:this[TH],[mH]:s,[DG]:"table_header_wrap_column"})}})}return x}createSort(e){const{[uH]:t,[mH]:i,[cH]:o}=this[PH];if(!o[t])return;const s=[{[uH]:t,direction:e?"ascending":"descending"}];i.filtersBarOpen[yH](!0),FF[JN]({[TH]:this[TH],[mH]:i,[jN]:{...i[jN][rH],sorts:{value:s}}}),L[qN]({[mH]:i})}}function EH(e){window.__c={n:"GroupSelectCheckbox"};const{[aH]:t,[mH]:i}=e,o=(0,qn.O7)(),s=(0,c.useCallback)((()=>(0,tl.A7)(t[0],i)),[i,t]),r=(0,Xn.VK)((()=>{const e=s(),t=e[HN];if(0===t)return!1;const i=_i.default[rH][fH][eG]((t=>e.includes(t)))[HN];return 0!==i&&(i===t||"indeterminate")}),[s]),n=(0,c.useCallback)((e=>{var t;const n=s(),l=_i.default[rH][fH],a=(0,il.vg)({collectionViewBlockId:null===(t=i[oG]())||void 0===t?void 0:t.id})?[]:l;!1===r||"indeterminate"===r?W[fN]({[TH]:o,[fH]:h().union(a,n)}):!0===r&&W[fN]({[TH]:o,[fH]:h().without(a,...n)}),e.stopPropagation()}),[r,i,o,s]);return a()(vN,{checkedState:r,onClick:n,checkboxType:"group",[mH]:i})}RH.displayName="TableHeaderCellMenu";const VH=(0,P.injectIntl)(BH);var AH=i(35011),LH=i(58299);const _H=i(85).Omf,OH=i(85).qc1,FH=i(85).fBv,NH=i(85).qKK,GH=i(85).u9,HH=i(85).LWT,WH=i(85)._mQ,KH=i(85).D03,zH=i(85).D7I,UH=i(85).BQ6,$H=i(85).W1o,QH=i(85).OBh,qH=i(85).Jkr,XH=i(85).sT6,YH=i(85).Bfb,jH=i(85).BCA,JH=i(85).Mzw,eW=i(85).QmD,tW=i(85).Gnd,iW=i(85).Wp_,oW=i(85).P0R,sW=i(85).YGn,rW=i(85).con,nW=i(85).wfR,lW=i(85).p6m,aW=i(85).M82,dW=i(85).eDh;class hW extends p.Z{constructor(){super(...arguments),this[dW]=void 0,this.storeTypes={[aW]:Pe.Z,[lW]:v.default[nW](void 0)},this[rW]=e=>{e[sW](),this[dW]=this[oW].leftFormat,this[tW][aW][iW]({...this[tW][aW][eW],mousePressed:!0})},this[JH]=e=>{const t=this.getNewFormat(e);t&&this[oW].onTemporaryResize(t)},this.handleDragEnd=e=>{const t=this.getNewFormat(e);t&&this[oW][jH](t),this[tW][aW][iW]({...this[tW][aW][eW],mousePressed:!1})},this[YH]=()=>{this[oW].onCancel(),this[dW]=void 0,this[tW][aW][iW]({...this[tW][aW][eW],mousePressed:!1})},this[XH]=()=>{const e=this[tW][lW][eW]?this[tW][lW][eW].blockIds:[],t=d.compact(e.map((e=>{const t=LH.Z.findBlockPropertyValueByBlockId(e,this[oW].leftFormat.property),i=null==t?void 0:t.getNode();if(i)return this.calculateMaxWidth(i)})));if(this[oW].leftFormat[qH]){const e={...this[oW].leftFormat,[qH]:Math.min(800,Math.max(Math.max(...t),cW(this[oW][QH],this[oW].leftFormat)))};this[oW][jH](e)}}}renderComponent(){const{device:e}=this.environment,{[$H]:t,mousePressed:i}=this[tW][aW][eW],o=(i||t)&&!e.isPhone;return a()("div",{[UH]:hW[UH],onMouseMove:()=>this[tW][aW][iW]({...this[tW][aW][eW],[$H]:!0}),onMouseLeave:()=>this[tW][aW][iW]({...this[tW][aW][eW],[$H]:!1})},void 0,a()(ZT.Z,{[KH]:this[rW],onDraggableDragMove:this[JH],[WH]:this.handleDragEnd,[HH]:this[YH],disableVerticalEdgeScroll:!0,[GH]:!0,render:e=>c[zH]("div",n()({[UH]:o?this.getInnerActiveStyle():this.getInnerStyle(),onDoubleClick:this[XH]},e))}))}getInnerStyle(){return{[qH]:5,marginLeft:-3,marginTop:-1,height:this[oW].height,transition:"background 200ms ease-out",background:yh.ZP[NH](0),cursor:"col-resize"}}getInnerActiveStyle(){return{...this.getInnerStyle(),background:yh.ZP[NH](.8)}}calculateMaxWidth(e){const t=e.cloneNode(!0);let i=!1;"relative"===(null==e?void 0:e[UH][FH])&&(e[UH][FH]="unset",i=!0);const o=getComputedStyle(e);for(let n=0;n<o.length;n++){const e=o[n],i=o.getPropertyValue(e);t[UH][e]=i}i&&(e[UH][FH]="relative"),t.id="notion-table-view-cell-shadow",t[UH].top="0px",t[UH].left="0px",t[UH][OH]="none",t[UH][qH]="auto",t[UH].opacity="0",t[UH].display="flex",t[UH][FH]="absolute";const s=t.querySelectorAll("*");for(const n of s)n[UH]&&(n[UH][OH]="none",n[UH][qH]="auto");document.body.appendChild(t);const r=t[_H]();return t.remove(),null!=r&&r[qH]?Math.ceil(r[qH]):void 0}getNewFormat(e){if(this[dW]&&this[dW][qH]){const t=Math.max(this[dW][qH]+e.diffX,cW(this[oW][QH],this[oW].leftFormat));return{...this[dW],[qH]:t}}}getTableColumnMinWidth(e,t){if("checkbox"===(null==e?void 0:e.type)||"status"===(null==e?void 0:e.type)&&"checkbox"===t.statusShowAs)return 32;var i;if(("number"===(null==e?void 0:e.type)||"formula"===(null==e?void 0:e.type)&&"number"===(0,AH.mm)(e))&&"ring"===(null==e||null===(i=e.show_as)||void 0===i?void 0:i.type))return 32;return"auto_increment_id"===(null==e?void 0:e.type)?64:100}}function cW(e,t){if("checkbox"===(null==e?void 0:e.type)||"status"===(null==e?void 0:e.type)&&"checkbox"===t.statusShowAs)return 32;var i;if(("number"===(null==e?void 0:e.type)||"formula"===(null==e?void 0:e.type)&&"number"===(0,AH.mm)(e))&&"ring"===(null==e||null===(i=e.show_as)||void 0===i?void 0:i.type))return 32;return"auto_increment_id"===(null==e?void 0:e.type)?64:100}hW.displayName="TableHeaderResizer",hW[UH]={[FH]:"absolute",right:0,[qH]:0,flexGrow:0,zIndex:1};const uW=hW;var pW=i(81415);const mW=i(85).nx5;function gW(e){window.__c={n:"LearnMoreLink"};const{href:t,style:i}=e,o=(0,Yn.yK)((e=>({default:{display:"flex",marginTop:7,marginBottom:7,alignItems:"center",cursor:"pointer",textDecoration:"none",pointerEvents:"auto",width:"fit-content",color:e.mediumTextColor}})),[]);return a()("a",{href:t,target:"_blank",style:{...o.default,...i}},void 0,S.Z.help({width:14,marginRight:4}),a()(P.FormattedMessage,{id:"LearnMoreLink.learnMore",[mW]:"Learn more"}))}var vW=i(71424);const fW=i(85).D7I,yW=i(85).ChN,wW=i(85).feQ,SW=i(85).nx5;function bW(e){window.__c={n:"WikiPropertiesOnboardingTooltip"};const{origin:t,propertyType:i}=e,o=(0,qn.O7)();return a()(pW.U,{origin:t,placementToOrigin:"bottom",header:function(){switch(i){case"owner":return a()(P.FormattedMessage,{id:"WikiPropertiesOnboardingTooltip.header.ownerProperty",[SW]:"Owner"});case wW:return a()(P.FormattedMessage,{id:"WikiPropertiesOnboardingTooltip.header.verificationProperty",[SW]:"Verification"});case"tags":return a()(P.FormattedMessage,{id:"WikiPropertiesOnboardingTooltip.header.tagsProperty",[SW]:"Add tags and more"});default:(0,Wp.unreachable)(i)}}(),content:function(){switch(i){case"owner":return a()(P.FormattedMessage,{[SW]:"Owners are responsible for keeping the page updated. By default, the owner is the page creator",id:"WikiPropertiesOnboardingTooltip.content.ownerProperty",values:{bold:e=>a()("span",{style:{[yW]:x.Z[yW].semibold}},void 0,e)}});case wW:return c[fW](c.Fragment,null,a()(P.FormattedMessage,{[SW]:"Page owners can mark a page as verified or expired, to help viewers understand whether they can trust the content",id:"WikiPropertiesOnboardingTooltip.content.verificationProperty"}),a()(gW,{href:(0,TB.getLocalizedUrl)("guides.wikis"),style:{color:yh.ZP.uiLightGray}}));case"tags":return c[fW](c.Fragment,null,a()(P.FormattedMessage,{[SW]:"Customize your wiki with tags or other database properties",id:"WikiPropertiesOnboardingTooltip.content.tagsProperty"}),a()(gW,{href:(0,TB.getLocalizedUrl)("guides.databaseProperties"),style:{color:yh.ZP.uiLightGray}}));default:(0,Wp.unreachable)(i)}}(),numSteps:3,currStepIndex:function(){switch(i){case"owner":return 0;case wW:return 1;case"tags":return 2;default:(0,Wp.unreachable)(i)}}(),onCloseClick:()=>{aF.nX(o)},onPrimaryButtonClick:()=>aF.Rg(o),onBackButtonClick:()=>aF.FO(o),shouldDismissUponOutsideClick:!0,pointerLength:vW.EZ,pointerOffset:vW.FD,style:{width:vW.G5}})}const kW=i(85).$Vg,CW=i(85).UPJ,TW=i(85).xej,xW=i(85).zrY,IW=i(85).SjN,PW=i(85).Hco,DW=i(85).GCx,MW=i(85).XGW,ZW=i(85).EMU,BW=i(85).sM5,RW=i(85).fBv,EW=i(85).rGB,VW=i(85).Au,AW=i(85).u9,LW=i(85).RZA,_W=i(85).phM,OW=i(85).v1$,FW=i(85).hd7,NW=i(85).rER,GW=i(85)._tz,HW=i(85).k9$,WW=i(85).QQK,KW=i(85).HxR,zW=i(85).Xl2,UW=i(85).Zj$,$W=i(85).mOq,QW=i(85).Wp_,qW=i(85).X5t,XW=i(85).jQT,YW=i(85).LCr,jW=i(85).E3P,JW=i(85).nxU,eK=i(85).Drs,tK=i(85).JJj,iK=i(85).e9w,oK=i(85).tb8,sK=i(85).qU4,rK=i(85).BQ6,nK=i(85).tBn,lK=i(85).D7I,aK=i(85).OBh,dK=i(85).BCA,hK=i(85).X_m,cK=i(85).QC4,uK=i(85).Kje,pK=i(85).NPw,mK=i(85).sP9,gK=i(85).XO9,vK=i(85).ffk,fK=i(85).urI,yK=i(85).Jkr,wK=i(85).pzN,SK=i(85).dLQ,bK=i(85).uzK,kK=i(85).Er,CK=i(85).qLW,TK=i(85).gRm,xK=i(85).oWD,IK=i(85).k6_,PK=i(85).QmD,DK=i(85).v5W,MK=i(85).P0R,ZK=i(85).xd5,BK=i(85)._V5,RK=i(85).pkR,EK=i(85).P24,VK=i(85).wgE,AK=i(85).FRA,LK=i(85).Dv6,_K=i(85).wfR,OK=i(85).p6m;class FK extends p.Z{constructor(){super(...arguments),this.storeTypes={tableHeaderRowStore:hF,[OK]:v.default[_K](void 0)},this.propertyRef=c[LK](),this[AK]=(e,t,i)=>{var o,s,r,n;const{device:l}=this[VK],{store:d,[EK]:h,schema:u,query:p,[OK]:m,[RK]:g,formatKey:v,isScrolled:f,disableCellRightBorder:w,renderSpacer:S,allowHidingTitle:b,[BK]:k,[ZK]:C}=this[MK],T=this[DK](),x=this[MK][IK][PK][t],I=t===i.length-1,P=C?[C]:[],D=aF.B1(),M=(null===(o=h[xK]())||void 0===o?void 0:o[CK]()[TK])===y.GZ&&d[kK]()&&d.id===(null===(s=h[bK]())||void 0===s?void 0:s.id),Z=M&&e===nF.k.Owner&&"owner"===D,B=M&&"verification"===(null===(r=u[e])||void 0===r?void 0:r.type)&&"verification"===D,R=M&&"multi_select"===(null===(n=u[e])||void 0===n?void 0:n.type)&&"tags"===D,E=!l[SK]&&(Z||B||R),V=c[lK](c[nK],null,E&&a()(bW,{origin:this.propertyRef,[wK]:D}),x&&x[yK]&&a()(VH,{[fK]:T,schema:u,query:p,[vK]:e,[yK]:x[yK],[bK]:d,[EK]:h,isScrolled:f,[RK]:g,formatKey:v,isLast:I,disableCellRightBorder:w,allowHidingTitle:b,renderSpacer:S,[BK]:k,[gK]:t,[OK]:m,[mK]:P}),!g&&!l.isPhone&&a()(uW,{leftFormat:x,onTemporaryResize:this[pK],[dK]:this[uK],onCancel:this[cK],[hK]:this[MK][hK],[aK]:u[e],[OK]:m}));return c[lK]("div",{key:e,[rK]:this.getHeaderCellWrapStyle(),ref:E?this.propertyRef:void 0},V)},this.handleColumnReorder=(e,t)=>{const{[EK]:i,formatKey:o}=this[MK],{startPosition:s,endPosition:r}=t,n=i[sK]();if(!n)return;let l={...this[DK](),[o]:h().sortBy(this[oK](),(t=>{const i=e.indexOf(t[vK]);return i>=0?i:1/0}))};const a=n[iK]();if(void 0!==a){let e=a;s>a&&r<=a?e+=1:s<=a&&r>=a&&(e-=1),l={...l,table_frozen_column_index:e}}z[tK]({[eK]:"TableHeaderRow.handleColumnReorder",[VK]:this[VK],[JW]:e=>{L[jW]({[sK]:n,update:{[fK]:l},[YW]:e})}}),R[XW]({[VK]:this[VK],[EK]:i,[qW]:"table_reorder_columns"})},this[pK]=e=>{this[MK][$W][QW]({...this[MK][$W][PK],temporaryFormat:this.getNewResizeFormat(e)})},this[uK]=e=>{const{[EK]:t,formatKey:i}=this[MK],o=t[sK]();if(!o)return;const s={...this[DK](),[i]:this[oK]().map((t=>t[vK]===e[vK]?e:t))};z[tK]({[eK]:"TableHeaderRow.handleColumnResizeAccept",[VK]:this[VK],[JW]:e=>{L[jW]({[sK]:o,update:{[fK]:s},[YW]:e})}}),this[MK][$W][QW]({...this[MK][$W][PK],temporaryFormat:void 0}),R[XW]({[VK]:this[VK],[EK]:t,[qW]:"table_resize_columns"})},this[cK]=()=>{this[MK][$W][QW]({...this[MK][$W][PK],temporaryFormat:void 0})},this.handleAddColumnClick=()=>{const{[EK]:e}=this[MK],t=e[xK]();t&&(K.clear(this[VK]),W.clear(this[VK]),L[UW](),R[XW]({[VK]:this[VK],[EK]:e,[qW]:"click_new_property"}),V[zW]({[KW]:e[WW],item:{type:wK,propertyTypes:(0,ai.TP)({[HW]:t[HW](),[EK]:e,[VK]:this[VK]}),[dK]:(t,i)=>{lF.PW({[VK]:this[VK],[EK]:e,[wK]:t,[GW]:i,from:"table"})}}}))},this.handleConfigureColumnsClick=()=>{const{[EK]:e}=this[MK];V[NW]({[EK]:e,[KW]:e[WW]}),R[XW]({[VK]:this[VK],[EK]:e,[qW]:"click_table_header_dot_menu"}),V[FW]({[KW]:e[WW],item:{type:OW,timelineViewTab:_W}})},this[LW]=e=>{(0,re.ZP)({event:e,context:re.Af.EditorMouseDown,callback:()=>{}})}}renderComponent(){var e;const{[RK]:t,showRightActions:i,[AW]:o,[EK]:s}=this[MK],r=s.permissionScopes[PK],n=this[MK][IK][PK].map((e=>e[vK])),l=null===(e=s[sK]())||void 0===e?void 0:e[iK](),d={...void 0!==l?(0,il.oc)({[EK]:s,[SK]:this[VK].device[SK],stickyLeft:0,[VW]:this[VW]}):{}},h=n.slice(0,(l??0)+1),u=n.slice((l??0)+1),p=!t&&i?c[lK](c[nK],null,this.renderAddColumnButton(),this.renderConfigureColumnsButton()):null;return t||!r.canConfigureBlock?a()(zg,{[RW]:We.Top},void 0,a()("div",{[rK]:this.getHeaderRowStyle()},void 0,a()("div",{[rK]:xk.l8},void 0,n.map(this[AK])),p,this[MK][EW])):void 0!==l?a()(zg,{[RW]:We.Top},void 0,a()("div",{[rK]:this.getHeaderRowStyle()},void 0,a()(AF,{[rK]:{[BW]:ZW},[DW]:MW,keys:n,sectionedKeys:{frozen:h,unfrozen:u},sectionStyles:{frozen:{[BW]:ZW,...d},unfrozen:{[BW]:ZW}},renderKey:this[AK],onDrop:this.handleColumnReorder,[AW]:o}),p,this[MK][EW])):a()(zg,{[RW]:We.Top},void 0,a()("div",{[rK]:this.getHeaderRowStyle()},void 0,a()(xk.ZP,{[DW]:MW,keys:n,renderKey:this[AK],onDrop:this.handleColumnReorder,[AW]:o}),p,this[MK][EW]))}renderAddColumnButton(){return a()(Bo.Z,{[rK]:this.getAddColumnStyle(),onMouseDown:this[LW],onClick:this.handleAddColumnClick,className:X.tableViewAddColumn},void 0,a()("div",{[rK]:FK.addColumnIconWrapStyle},void 0,S.Z.plus({[yK]:12,fill:this[VW][PW]})))}renderConfigureColumnsButton(){return a()(Bo.Z,{[rK]:this.getConfigureColumnsStyle(),onMouseDown:this[LW],onClick:this.handleConfigureColumnsClick,className:X.tableViewAddColumn},void 0,a()("div",{[rK]:FK.addColumnIconWrapStyle},void 0,S.Z.dots({[yK]:12,fill:this[VW][PW]})))}[DK](){const{[fK]:e}=this[MK],{temporaryFormat:t}=this[MK][$W][PK];return t||e}getNewResizeFormat(e){const{formatKey:t}=this[MK];return{...this[DK](),[t]:this[oK]().map((t=>t[vK]===e[vK]?e:t))}}[oK](){const{formatKey:e}=this[MK];return this[DK]()[e]||[]}getHeaderCellWrapStyle(){return{[BW]:ZW,[RW]:"relative"}}getHeaderRowStyle(){var e;const{[EK]:t,isInPeekRenderer:i,[hK]:o,minWidth:s,disableTopBorder:r}=this[MK],n=t[sK]();if(!n)return{};const l=(null===(e=t[IW][PK])||void 0===e?void 0:e.background)||(i?this[VW][xW]:this[VW].contentBackground);return{[BW]:ZW,[RW]:"absolute",background:l,zIndex:I.collectionStickyTopElement,[hK]:o-1,color:this[VW].mediumTextColor,borderTop:r?void 0:`1px solid ${this[VW][TW]}`,boxShadow:`\n\t\t\t\t-3px 0 0 ${l},\n\t\t\t\t0 1px 0 ${this[VW][TW]}\n\t\t\t`,minWidth:s,left:"timeline"===n.getType()?void 0:0,right:"timeline"===n.getType()?void 0:0}}getAddColumnStyle(){return{[BW]:ZW,[CW]:kW,[yK]:32}}getConfigureColumnsStyle(){return{[BW]:ZW,[CW]:kW,flexGrow:1,[yK]:32}}}FK.displayName="TableHeaderRow",FK.contextTypes={...p.w,...U.xm},FK.addColumnIconWrapStyle={[BW]:ZW,[yK]:32,[hK]:"100%",alignItems:"center",[CW]:"center"};const NK=(0,P.injectIntl)(FK);var GK=i(86486),HK=i(29370);const WK=i(85).$Vg,KK=i(85).UPJ,zK=i(85).oWD,UK=i(85).bb$,$K=i(85).xej,QK=i(85).NRr,qK=i(85).u9,XK=i(85).E5B,YK=i(85).eNH,jK=i(85).ffk,JK=i(85).g9q,ez=i(85).aKz,tz=i(85).TtP,iz=i(85).$pZ,oz=i(85).BQ6,sz=i(85).Lek,rz=i(85).Uk6,nz=i(85).Wo8,lz=i(85).rQ1,az=i(85).gFy,dz=i(85).EMU,hz=i(85).sM5,cz=i(85).e9w,uz=i(85).qU4,pz=i(85).Dpi,mz=i(85).uzK,gz=i(85).Aw$,vz=i(85).VFD,fz=i(85).xd5,yz=i(85).pkR,wz=i(85).D7I,Sz=i(85).wgE,bz=i(85).QmD,kz=i(85).tDk,Cz=i(85).XtO,Tz=i(85).kId,xz=i(85).P24;class Iz extends Le.Z{activate(){const{[xz]:e,[Tz]:t,[Cz]:i}=this.props,{[kz]:o}=ge.default[bz],s=ie.getPeekModeHref({[Cz]:i,[kz]:o,[xz]:e,fullyQualified:!1});s&&(t(),N.navigate({[Sz]:this[Sz],url:s}))}renderPersisted(){return c[wz](Pz,this.props)}}function Pz(e){window.__c={n:"TableRowFunctional"};const{[yz]:t,[Cz]:i,[fz]:o,[xz]:s,[vz]:r,showRightActionsSpacer:l,disableTableWrap:d,...h}=e,{isMobile:u}=(0,qn.Fy)(),p=(0,Xn.VK)((()=>!t&&i[gz]()),[t,i]),m=(0,Xn.VK)((()=>(0,tl.A7)(o,s).findIndex((e=>e===i))),[s,o,i]),g=(0,Xn.VK)((()=>{var t;const{[xz]:i,[fz]:o}=e,s=HK.Z[bz],r=i[mz]();if(!r)return!1;if(!s.isActive||!(0,HK.N)(s[pz],{[mz]:r,[fz]:o}))return!1;const{selection:n}=s,{start:l}=n,a=null===(t=i[uz]())||void 0===t?void 0:t[cz]();return void 0!==a&&m===l.row&&l.col<=a}),[e,m]),v=(0,Yn.Fg)(),f=(0,Xn.VK)((()=>{var e;return null===(e=s[uz]())||void 0===e?void 0:e[cz]()}),[s]),y=Boolean(void 0!==f),w=y?{...(0,il.oc)({[xz]:s,isMobile:u,theme:v}),[hz]:dz,...g?{zIndex:I.tableFrozenColumns+1}:{}}:{},[S,b]=(0,c.useMemo)((()=>y&&void 0!==f?[r.slice(0,f+1),r.slice(f+1)]:[[],r]),[f,r,y]),k=(0,Xn.VK)((()=>{var e;return Boolean(!d&&(null===(e=s[uz]())||void 0===e?void 0:e[az]().getKeyStore("table_wrap").getValue()))}),[s,d]),C=(0,Xn.VK)((()=>{var e;return Boolean("timeline"===(null===(e=s[uz]())||void 0===e?void 0:e.getType())||!k&&!r.some((e=>e.wrap)))}),[s,r,k]),T=(0,Xn.VK)((()=>{const e=s[lz][bz];return e[nz]||!e[rz]||!e.canConfigureBlock}),[s[lz]]);return a()(c.Fragment,{},void 0,a()("div",{[oz]:{[hz]:dz}},void 0,a()("div",{[oz]:{[hz]:dz}},void 0,a()("div",{[oz]:y?w:{}},void 0,a()(Bz,{[Cz]:i}),c[wz](Dz,n()({[Cz]:i,[gz]:p,[vz]:S,shouldSetCellHeight:C,indexAddendum:0,[sz]:m,[yz]:t,[fz]:o,disableTableWrap:d,[nz]:T},h))),c[wz](Dz,n()({[Cz]:i,[gz]:p,[vz]:b,shouldSetCellHeight:C,indexAddendum:y&&void 0!==f?f+1:0,[sz]:m,[yz]:t,[fz]:o,disableTableWrap:d,[nz]:T},h)))),l&&!T&&a()(Rz,{}))}function Dz(e){window.__c={n:"TableRowValues"};const{[iz]:t,[vz]:i,[Cz]:o,disableTableWrap:s,shouldSetCellHeight:r,indexAddendum:l,...a}=e,d=(0,U.Y$)(),h=(0,Xn.VK)((()=>d[uz]()),[d]),u=(0,Xn.VK)((()=>!!h&&Boolean(!s&&h[az]().getKeyStore("table_wrap").getValue())),[h,s]),p=(0,Xn.VK)((()=>{const e=GK.default[bz];return Boolean(e.isOpen&&e.currentStore===o)}),[o]),m=(0,Xn.VK)((()=>!t[bz].isOpen&&_i.default[bz].stores[tz]>0&&_i.default[bz].stores[0].id===o.id),[o.id,t]),g=(0,Xn.VK)((()=>d[ez][bz]),[d[ez]]),v=(0,Xn.VK)((()=>(0,q.$4)()&&"title"===(null==h?void 0:h.getFormat()[JK])),[h]),f=(0,Xn.VK)((()=>{var e;return null===(e=d[uz]())||void 0===e?void 0:e[cz]()}),[d]);return c[wz](c.Fragment,null,i.map(((e,i)=>c[wz](Mz,n()({index:i+(l??0),key:e[jK],[Cz]:o,propertyFormat:e,isLastColumn:i+(l??0)===length-1,isRightMostFrozenColumn:void 0!==f&&f===i+(l??0),[uz]:h,tableWrap:u,shouldSetCellHeight:r,isShowingHoverMenu:p,shouldCaptureKeyboard:m,subitemFormat:g,isSubitemToggleOnTitleColumn:v,[iz]:t},a)))))}const Mz=e=>{window.__c={n:"TableRowValue"};const{propertyFormat:t,index:i,[gz]:o,isLastColumn:s,isRightMostFrozenColumn:r,[Cz]:n,schema:l,[yz]:d,disableCellBorderRight:u,subitemPath:p,onShiftEnter:m,tableWrap:g,subitemFormat:v,isShowingHoverMenu:f,shouldCaptureKeyboard:y,[nz]:w,toggleButton:S,onPropertyClick:b,titleColumnIndex:k,isSubitemToggleOnTitleColumn:C,disableLastCellBorderRight:T,onPropertyTab:x,onPropertyUntab:I,onPropertyEnter:P,onPropertyEsc:D,onPropertyBgClick:M,[YK]:Z,[uz]:B,[iz]:R,isScrolled:E,shouldSetCellHeight:V,[XK]:A,[qK]:L,[Tz]:_,[fz]:O,[sz]:F}=e,{width:N,[jK]:G,wrap:H}=t,W=(0,U.Y$)(),K=(0,Xn.VK)((()=>n[QK]()),[n]),z=(null==p?void 0:p[tz])??0,$=v&&(0,il.lO)({columnIndex:i,titleColumnIndex:k,isSubitemToggleOnTitleColumn:C}),Q=(0,c.useMemo)((()=>{if(void 0!==N)return $?N-(0,il.lZ)({columnIndex:i,indentLevel:z,titleColumnIndex:k,isSubitemToggleOnTitleColumn:C}):N}),[z,i,C,$,k,N]),q=(0,c.useMemo)((()=>$&&a()(Zz,{subitemFormat:v,toggleButton:S,subitemPath:p})),[$,v,p,S]),Y=(0,c.useCallback)((()=>b(n,G,l)),[b,G,l,n]),j=d||!o,J=(0,Xn.VK)((()=>{const e=HK.Z[bz],t=W[mz]();if(!t)return!1;if(!e.isActive||!(0,HK.N)(e[pz],{[mz]:t,[fz]:O}))return!1;const{selection:o}=e,{start:s,end:r}=o,n=F===s.row||F===r.row||h().inRange(F,s.row,r.row),l=i===s.col||i===r.col||h().inRange(i,s.col,r.col);return n&&l}),[W,O,i,F]),ee=(0,Xn.VK)((()=>{const e=HK.Z[bz],t=W[mz]();if(!t)return!1;if(!e.isActive||!(0,HK.N)(e[pz],{[mz]:t,[fz]:O}))return!1;const{selection:o}=e,{start:s}=o;return F===s.row&&i===s.col}),[W,O,i,F]),te=(0,Yn.yK)((e=>({tableCell:{width:N||void 0,height:"calc(100% + 1px)",borderBottom:`1px solid ${e[$K]}`,position:"relative",borderRight:u||r||s&&T?"none":`1px solid ${e[$K]}`,background:J?yh.ZP.blueWithAlpha(.07):void 0},tableSelectionOverlay:{borderRadius:ee?3:void 0,boxShadow:ee?e[UK]:void 0,position:"absolute",pointerEvents:"none",left:0,top:0,width:"calc(100% + 1px)",height:"100%"},propertyValueContainer:{[hz]:dz,overflowX:"hidden",height:"100%",width:N||void 0}})),[u,T,J,s,r,ee,N]),ie=a()(Ro.Z,{capture:y,onShiftEnter:m},void 0,a()(Do.Z,{[zK]:K,[Cz]:n,[jK]:G,[yz]:j,locked:w,width:Q,format:Mo.C.Table,forceMouseEntered:"title"===G&&o?f:void 0,tableWrap:Boolean(g||H),isLast:s,disableTableBorderRight:u||r||s&&T||$,indentLevel:0===i&&p?p[tz]:void 0,onTab:x,onUntab:I,onEnter:P,onClick:Y,onEsc:D,onBgClick:M,onContextMenu:Z,[uz]:B,shouldSetCellHeight:V,[XK]:A,[iz]:R,[qK]:L,[Tz]:_},G),r&&a()(JF,{isScrolled:Boolean(E)}));return a()("div",{className:X.tableViewCell,"data-row-index":F,"data-col-index":i,[oz]:te.tableCell},void 0,a()("div",{[oz]:te.propertyValueContainer},void 0,$&&q,ie),ee&&a()("div",{[oz]:te.tableSelectionOverlay}))};function Zz(e){const{toggleButton:t,subitemPath:i}=e,o=(null==i?void 0:i[tz])??0,s=Math.max((o-1)*tl.Hw,0)+tl.gY;return t?a()("div",{[oz]:{paddingTop:4,[hz]:dz}},void 0,a()("div",{[oz]:{width:s}}),t):a()("div",{[oz]:{minWidth:s+tl.Hw}})}const Bz=c.memo((e=>{window.__c={n:"RowSelectCheckboxMaybe"};const{[Cz]:t}=e,i=(0,U.Y$)(),o=(0,qn.O7)(),s=(0,Xn.VK)((()=>_i.default[bz].stores.some((e=>e===t))),[t]),r=(0,Xn.VK)((()=>ie.shouldShowBulkActionsToolbar({[Sz]:o,[xz]:i})),[i,o]),n=(0,c.useCallback)((e=>{var s;(0,il.vg)({collectionViewBlockId:null===(s=i[mz]())||void 0===s?void 0:s.id})?W.setSelection({[Sz]:o,stores:[t]}):W.select({[Sz]:o,[Cz]:t,toggle:!0}),e.stopPropagation()}),[i,o,t]);return r?a()(vN,{checkedState:s,onClick:n,checkboxType:"single_row",[xz]:i}):null}));function Rz(){return a()("div",{[oz]:{[hz]:dz,[KK]:WK,flexGrow:1,width:64}})}const Ez=Iz;var Vz=i(55061),Az=i(11302),Lz=i(39865),_z=i(4708),Oz=i(25464);const Fz=i(85).rps,Nz=i(85).$bT,Gz=i(85).nx5,Hz=i(85).S6b,Wz=i(85).EMU,Kz=i(85).nSw,zz=i(85).Kvv,Uz=i(85).OX5,$z=i(85).qlv,Qz=i(85).Omf,qz=i(85).kpr,Xz=i(85).tEv,Yz=i(85).sfk,jz=i(85).LWT,Jz=i(85)._mQ,eU=i(85).D03,tU=i(85).BQ6,iU=i(85).D7I,oU=i(85).vK9,sU=i(85).xOW,rU=i(85).fBv,nU=i(85).eNH,lU=i(85).uRL,aU=i(85).e9w,dU=i(85).EIp,hU=i(85).xtO,cU=i(85).P3s,uU=i(85).Lhq,pU=i(85).qir,mU=i(85).b0M,gU=i(85).v8g,vU=i(85).vN2,fU=i(85).rG,yU=i(85).bSA,wU=i(85).UVz,SU=i(85).P3C,bU=i(85).vkj,kU=i(85).WCo,CU=i(85).fCB,TU=i(85).wcv,xU=i(85).N1Z,IU=i(85).LIR,PU=i(85).ixe,DU=i(85).qU4,MU=i(85).BpM,ZU=i(85).KNN,BU=i(85).q$s,RU=i(85).ZG6,EU=i(85).Ttb,VU=i(85).sP9,AU=i(85).oWD,LU=i(85).iKt,_U=i(85).vX_,OU=i(85)._2_,FU=i(85).Ylz,NU=i(85).vTv,GU=i(85).Ano,HU=i(85).f7G,WU=i(85).XqV,KU=i(85).tDk,zU=i(85)._Te,UU=i(85).qq3,$U=i(85).UD6,QU=i(85).YOX,qU=i(85).g5n,XU=i(85).dLQ,YU=i(85).E0z,jU=i(85).LCr,JU=i(85).HA$,e$=i(85).nxU,t$=i(85).Drs,i$=i(85).JJj,o$=i(85).OdC,s$=i(85).UoE,r$=i(85).u9,n$=i(85).urI,l$=i(85).XtO,a$=i(85).$pZ,d$=i(85).fbO,h$=i(85).pkR,c$=i(85).k6_,u$=i(85).ffk,p$=i(85).Kiu,m$=i(85).iJA,g$=i(85).Rf7,v$=i(85).TtP,f$=i(85).rTT,y$=i(85).shZ,w$=i(85).dnY,S$=i(85).FcT,b$=i(85).xd5,k$=i(85).Dpi,C$=i(85).wgE,T$=i(85).P0R,x$=i(85).P24,I$=i(85).uzK,P$=i(85).c7P,D$=i(85).Zj$,M$=i(85).Bfb,Z$=i(85).U1G,B$=i(85).Mzw,R$=i(85).qI$,E$=i(85).p2z,V$=i(85).qSW,A$=i(85).Gnd,L$=i(85).nm$,_$=i(85).xY5,O$=i(85).QmD,F$=i(85).YGn,N$=i(85).con,G$=i(85).wfR,H$=i(85).sfz,W$=i(85).$DE;var K$;!function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Up=2]="Up",e[e.Down=3]="Down"}(K$||(K$={}));class z$ extends p.Z{constructor(){super(...arguments),this.rowsWrapEl=null,this[W$]=void 0,this.storeTypes={[H$]:v.default[G$](void 0)},this[N$]=e=>{e[F$]();const t=this[_$][O$];if(t&&this.isDragAndFillEnabled()&&this.isTargetWithinDragAndFillHandle(e[L$]))return void this[A$][H$].setState({...t});const i=this[V$](e[L$]);i&&this[E$]({[R$]:i,end:i})},this[B$]=e=>{if(ae[Z$]()){var t;const i=this[V$](e[L$]);if(!i)return;const o=this[A$][H$][O$],s=o?o[R$]:null===(t=this[_$][O$])||void 0===t?void 0:t[R$];if(!s)return;const r=i;if(this[A$][H$][O$]&&s.col!==r.col)return;this[E$]({[R$]:s,end:r})}},this.handleDragEnd=()=>{this.dragAndFillCells()},this[M$]=()=>{this[A$][H$].reset(),L[D$]()},this.handleLeft=e=>{e[F$]&&e[F$](),Li.Z[P$](!0);const t=this[_$][O$];if(!t)return;const i=this[T$][x$][I$]();i&&(HF.arrowLeft({[C$]:this[C$],[k$]:{[I$]:i,[b$]:this[T$][b$]},[S$]:t,[w$]:"shiftKey"in e&&e[w$]||!1,columnCount:this[y$]()}),this[f$](K$.Left))},this.handleRight=e=>{e[F$]&&e[F$](),Li.Z[P$](!0);const t=this[_$][O$];if(!t)return;const i=this[T$][x$][I$]();i&&(HF.arrowRight({[C$]:this[C$],[k$]:{[I$]:i,[b$]:this[T$][b$]},[S$]:t,columnCount:this[y$](),rowCount:this[T$][g$][O$][v$],[w$]:"shiftKey"in e&&e[w$]||!1}),this[f$](K$.Right))},this.handleUp=e=>{e[F$]&&e[F$](),Li.Z[P$](!0);const t=this[_$][O$];if(!t)return;const i=this[T$][x$][I$]();i&&(HF.arrowUp({[C$]:this[C$],[k$]:{[I$]:i,[b$]:this[T$][b$]},[S$]:t,[w$]:"shiftKey"in e&&e[w$]||!1}),this[f$](K$.Up))},this.handleDown=e=>{e[F$]&&e[F$](),Li.Z[P$](!0);const t=this[_$][O$];if(!t)return;const i=this[T$][x$][I$]();i&&(HF.arrowDown({[C$]:this[C$],[k$]:{[I$]:i,[b$]:this[T$][b$]},[S$]:t,rowCount:this[T$][g$][O$][v$],[w$]:"shiftKey"in e&&e[w$]||!1}),this[f$](K$.Down))},this[m$]=e=>{e[F$]&&e[F$](),Li.Z[P$](!0);const{[p$]:t}=this[T$],i=this[_$][O$];if(!i)return;const o=this[T$][g$][O$],s=o[i[R$].row],r=this[T$][c$][O$][i[R$].col][u$],n=t[r];if(n&&!this[T$][h$])if(Ii.noPropertyValueOverlayTypes[d$](n.type)){if("checkbox"===n.type){const e=s[s$](r),t=Hi.toCheckboxValue(e.getValue()),n=o[o$](i[R$].row,i.end.row+1);z[i$]({[t$]:"TableSelectionOverlay.handleEnter",[C$]:this[C$],[e$]:e=>{for(const i of n)Bi[JU]({[l$]:i[s$](r),value:Hi.fromCheckboxValue(!t),[jU]:e})}})}}else Zi.open({[C$]:this[C$],[a$]:this[T$][a$],[l$]:s,[u$]:r,[n$]:Mo.C.Table,[r$]:this[T$][r$],[x$]:this[T$][x$]}),L[D$]()},this.handleTab=e=>{e[F$](),Li.Z[P$](!0);const t=this[_$][O$];if(!t)return;const i=this[T$][x$][I$]();i&&(HF.arrowRight({[C$]:this[C$],[k$]:{[I$]:i,[b$]:this[T$][b$]},[S$]:t,columnCount:this[y$](),rowCount:this[T$][g$][O$][v$],[w$]:!1}),this[f$](K$.Right))},this.handleUntab=e=>{e[F$](),Li.Z[P$](!0);const t=this[_$][O$];if(!t)return;const i=this[T$][x$][I$]();i&&(HF.arrowLeft({[C$]:this[C$],[k$]:{[I$]:i,[b$]:this[T$][b$]},[S$]:t,[w$]:!1,columnCount:this[y$]()}),this[f$](K$.Left))},this.handleEsc=e=>{const{[YU]:t}=this[C$];if(t[XU])return;e[F$](),Li.Z[P$](!0);const i=this[_$][O$];if(L[D$](),i){const e=(0,il.AV)(i),t=this[T$][g$][O$][o$](e.minRow,e.maxRow+1);W[E$]({[C$]:this[C$],[A$]:t})}},this.handleMoveTo=e=>{e[F$]&&e[F$](),Li.Z[P$](!0);const t=this[_$][O$];if(L[D$](),t){const e=(0,il.AV)(t),i=this[T$][g$][O$][o$](e.minRow,e.maxRow+1);if(0===i[v$])return;W[E$]({[C$]:this[C$],[A$]:i});const o=TT.C.getRectFromStore(i[0]);Az.bA({[C$]:this[C$],[qU]:i,[QU]:o,moveToContext:"action_menu"})}},this[$U]=e=>{const t=this[_$][O$],i=this[T$][x$][UU][O$];t&&!this[T$][h$]&&z[i$]({[t$]:"TableSelectionOverlay.handleDelete",[C$]:this[C$],[e$]:e=>{HF.deleteSelection({[S$]:t,[p$]:i,[zU]:this[T$][c$][O$],currentRows:this[T$][g$][O$],[jU]:e})}})},this.handleCut=e=>{const t=this[_$][O$],i=this[T$][x$][UU][O$],o=this[T$][x$][I$]();o&&t&&!this[T$][h$]&&z[i$]({[t$]:"TableSelectionOverlay.handleCut",[C$]:this[C$],[e$]:s=>{HF.cutSelection({[k$]:{[I$]:o,[b$]:this[T$][b$]},[p$]:i,[S$]:t,[zU]:this[T$][c$][O$],currentRows:this[T$][g$][O$],event:e,[jU]:s})}})},this.handleCopy=e=>{const t=this[_$][O$],i=this[T$][x$][UU][O$],o=this[T$][x$][I$]();o&&t&&HF.copySelection({[k$]:{[I$]:o,[b$]:this[T$][b$]},[p$]:i,[S$]:t,[zU]:this[T$][c$][O$],currentRows:this[T$][g$][O$],event:e})},this.handlePaste=e=>{const{[x$]:t,[b$]:i,[p$]:o,[c$]:s,[g$]:r}=this[T$],n=this[_$][O$],l=this[T$][x$][I$]();l&&n&&!this[T$][h$]&&z[i$]({[t$]:"TableSelectionOverlay.handlePaste",[C$]:this[C$],[e$]:a=>{HF.pasteSelection({[C$]:this[C$],[x$]:t,[k$]:{[I$]:l,[b$]:i},[S$]:n,[zU]:s[O$],currentRows:r[O$],event:e,[jU]:a,[p$]:o})}})},this.handleCommandEnter=e=>{const{[YU]:t}=this[C$],i=this[_$][O$];if(t[XU]||!i)return;const{[x$]:o}=this[T$],s=this[T$][g$][O$][i[R$].row],{[KU]:r}=ge.default[O$],n=ie.getPeekModeHref({[l$]:s,[KU]:r,[x$]:o,[WU]:!1});n&&this[HU](n)},this[GU]=()=>{const{[YU]:e}=this[C$];if(e[XU])return;const t=this[_$][O$];if(!t)return;if(!Ke[NU](this[C$]))return;const{[x$]:i,[b$]:o}=this[T$];if(!i[FU]())return;const s=this[T$][g$][O$],r=this[T$][g$][O$][t[R$].row],n=i[OU][O$],l=(0,el.DY)(n.children,(e=>e.value[l$]===r)),a="table_selection_overlay_shift_enter";if(l){const e=l?(0,tl.Af)(l.map((e=>e.value[l$]))):"",n=i[_U][O$].get(e),d=Boolean(null==n?void 0:n[LU]),h=[...l].splice(0,l[v$]-1),c=h?(0,tl.Af)(h.map((e=>e.value[l$]))):"",u=i[_U][O$].get(c),p=Boolean(null==u?void 0:u[LU]);if(d||p)z[i$]({[t$]:"TableSelectionOverlay.handleNestedItemShiftEnter",[C$]:this[C$],[e$]:e=>{const t=i[AU]();if(!t)return;const n=E.insertNewBlock({[C$]:this[C$],[x$]:i,[VU]:o?[o]:[],[EU]:s,[l$]:r,before:!1,[AU]:t,[jU]:e,subitemPath:l,subitemInsertDirection:p&&!d?"below":"into"});n&&this[T$][a$]&&m.default[RU]((()=>{m.default[RU]((()=>{Zi.open({isNewBlock:!0,[C$]:this[C$],[a$]:this[T$][a$],[l$]:n,[u$]:"title",[n$]:Mo.C.Table,[x$]:i})}))}))}});else{const e={col:t.end.col,row:i.currentViewHasSort()?s[v$]:t.end.row+1};z[i$]({[t$]:"TableSelectionOverlay.handleShiftEnter",[C$]:this[C$],[e$]:t=>{const{coercionSucceeded:r,newStore:n}=E.createBlockInGroup({[C$]:this[C$],[x$]:i,[VU]:o?[o]:[],[EU]:s,insertAtIndex:e.row,coerce:!0,[BU]:!0,[jU]:t,from:a});if(!r){const e=o?[o]:[],t=i[MU][ZU](e);N.peekBlock({[C$]:this[C$],[l$]:n,peekMode:ie.getPeekMode(i[DU]()),[PU]:null==t?void 0:t[PU],[x$]:i,[IU]:f.tY.Create})}}}),m.default[RU]((()=>{this[E$]({[R$]:e,end:e})}))}}else{const e={col:t.end.col,row:i.currentViewHasSort()?s[v$]:t.end.row+1};z[i$]({[t$]:"TableSelectionOverlay.handleShiftEnter",[C$]:this[C$],[e$]:t=>{const{coercionSucceeded:r,newStore:n}=E.createBlockInGroup({[C$]:this[C$],[x$]:i,[VU]:o?[o]:[],[EU]:s,insertAtIndex:e.row,coerce:!0,[BU]:!0,[jU]:t,from:a});if(!r){const e=o?[o]:[],t=i[MU][ZU](e);N.peekBlock({[C$]:this[C$],[l$]:n,peekMode:ie.getPeekMode(i[DU]()),[PU]:null==t?void 0:t[PU],[x$]:i,[IU]:f.tY.Create})}}}),m.default[RU]((()=>{this[E$]({[R$]:e,end:e})}))}this[f$](K$.Down),Zi[xU]({[C$]:this[C$],[a$]:this[T$][a$]})},this.handleDuplicate=e=>{const{[YU]:t}=this[C$];if(t[XU])return;const i=this[_$][O$];i&&i[R$].col===i.end.col&&!this[T$][h$]&&Ke[NU](this[C$])&&(e[F$](),z[i$]({[t$]:"TableSelectionOverlay.handleDuplicate",[C$]:this[C$],[e$]:e=>{this[TU]({[jU]:e,[S$]:i,[R$]:i[R$]})}}))},this.handleCommandShiftEnter=e=>{const{[YU]:t}=this[C$];if(t[XU])return;const i=this[_$][O$];if(i){const e=this[T$][g$][O$][i[R$].row],t=(0,se.ZP)({[l$]:e,[WU]:!1,[IU]:f.tY.LinkInPage});N[CU]({[C$]:this[C$],url:t})}},this.handleKeypress=e=>{if(!e.key||e.metaKey||e.ctrlKey)return;e[F$](),Li.Z[P$](!0);const{[p$]:t}=this[T$],i=this[_$][O$];if(!i)return;const o=this[T$][g$][O$][i[R$].row],s=this[T$][c$][O$][i[R$].col][u$],r=t[s];r&&!this[T$][h$]&&Ii.insertStringOverlayTypes[d$](r.type)&&e.key&&1===e.key[v$]&&(Zi.open({[C$]:this[C$],[a$]:this[T$][a$],[l$]:o,[u$]:s,[n$]:Mo.C.Table,[r$]:this[T$][r$],insertChar:e.key,[x$]:this[T$][x$]}),L[D$]())},this.handlePropertyTab=()=>{const e=this[T$][a$][O$];if(e[kU]){const{[l$]:t,[u$]:i}=e,o=this[bU](t,i),s=this[T$][c$][O$],r={col:Math.min(o.col+1,s[v$]-1),row:o.row};this[E$]({[R$]:r,end:r}),this[f$](K$.Right),Zi[xU]({[C$]:this[C$],[a$]:this[T$][a$]})}},this.handlePropertyUntab=()=>{const e=this[T$][a$][O$];if(e[kU]){const{[l$]:t,[u$]:i}=e,o=this[bU](t,i),s={col:Math.max(o.col-1,0),row:o.row};this[E$]({[R$]:s,end:s}),this[f$](K$.Left),Zi[xU]({[C$]:this[C$],[a$]:this[T$][a$]})}},this.handlePropertyEnter=()=>{const e=this[T$][a$][O$];if(!e[kU])return;const{[l$]:t,[u$]:i}=e,o=this[bU](t,i),s={col:o.col,row:o.row+1};m.default[RU]((()=>{this[SU]()&&this[E$]({[R$]:s,end:s})})),this[f$](K$.Down),Zi[xU]({[C$]:this[C$],[a$]:this[T$][a$]})},this.handlePropertyClick=(e,t,i)=>{var o;const{[YU]:s}=this[C$];if("checkbox"!==(null===(o=i[t])||void 0===o?void 0:o.type)||s[XU])L[D$]();else{const i=this[bU](e,t);this[E$]({[R$]:i,end:i})}},this.dismissPropertyOverlay=e=>{const{[YU]:t}=this[C$],i=this[T$][a$][O$];if(i[kU]){const{[l$]:o,[u$]:s}=i,r=this[bU](o,s);t[XU]?L[D$]():this[SU]()&&this[E$]({[R$]:r,end:r}),this[f$](K$.Down),Zi[xU]({[C$]:this[C$],[a$]:this[T$][a$]}),null==e||e(i)}},this.handlePropertyBgClick=()=>{this.dismissPropertyOverlay()},this.handlePropertyEsc=()=>{this.dismissPropertyOverlay((e=>{const{isNewBlock:t,[l$]:i}=e;t&&i.isEmptyTitle()&&i.isEmptyPage()&&z[i$]({[t$]:"TableSelectionOverlay.handlePropertyEsc",[C$]:this[C$],[e$]:e=>{Lz.y8({[C$]:this[C$],[qU]:[i],[jU]:e}),e[wU].push((e=>{if(!e){const e=this[T$][x$][AU](),t=this[T$][x$][I$]();D.trackBlockAction(this[C$],{[yU]:fU,from:"collection_esc_shortcut",block_id:i.id,[vU]:"page",[gU]:null==e?void 0:e.id,[mU]:null==t?void 0:t.id})}}))}})}))},this.handlePropertyOpenProperty=e=>{const t=this[T$][a$][O$];if(t[kU]){const{[l$]:i}=t;Zi.open({[C$]:this[C$],[a$]:this[T$][a$],[l$]:i,[u$]:e,[n$]:Mo.C.Table,[r$]:this[T$][r$],[x$]:this[T$][x$]})}},this.handlePropertyContextMenu=e=>{e[F$]();const t=this[T$][g$][O$],i=this[_$][O$],o=this[V$](e[L$]);let s=!1;if(i&&o){const r=Math.min(i[R$].row,i.end.row),n=Math.max(i[R$].row,i.end.row);if(o.row>=r&&o.row<=n){const i=t[o$](r,n+1);i[v$]>0&&(W[E$]({[C$]:this[C$],[A$]:i}),W[pU]({[C$]:this[C$],[l$]:i[0]}),Mi.Qn({[C$]:this[C$],[A$]:_i.default[O$][A$],left:e.clientX,top:e.clientY,[uU]:Di.Qi,showInput:!0,[cU]:"content_block_menu"}),s=!0)}}if(!s&&o){const i=t[o.row];i&&(W[pU]({[C$]:this[C$],[l$]:i}),Mi.Qn({[C$]:this[C$],[A$]:_i.default[O$][A$],left:e.clientX,top:e.clientY,[uU]:Di.Qi,showInput:!0,[cU]:"content_block_menu"}))}},this.handleRowSelectableEnter=e=>{const t=this[T$][g$][O$],i=e[qU].map((e=>t.indexOf(e))),o=h().min(i)||0,s=h().max(i)||0;o>=0&&s>=0&&this[E$]({[R$]:{col:0,row:o},end:{col:0,row:s}})},this.handleRowsWrapMount=e=>{this.rowsWrapEl=e},this.handleRowsObserverChange=()=>{this[hU].recompute()},this[_$]=this[dU]((()=>{const e=HK.Z[O$],t=this[T$][x$][I$]();if(!t)return;const{[b$]:i}=this[T$];if(!e.isActive||!(0,HK.N)(e[k$],{[I$]:t,[b$]:i}))return;const{[S$]:o}=e;return this.normalizeTableSelection(o)}),!0),this[hU]=this[dU]((()=>{const e=this[_$][O$];if(e)return this.getCellRect(e[R$])}),!0),this.frozenIndexStore=this[dU]((()=>{const e=this[T$][x$][DU]();return null==e?void 0:e[aU]()})),this.frozenSectionWidthStore=this[dU]((()=>{const e=this.frozenIndexStore[O$];var t;if(void 0!==e)return null===(t=this.getCellRect({col:e,row:0}))||void 0===t?void 0:t.right}),!0)}willUnmount(){super.willUnmount(),this[W$]&&this[W$].disconnect()}didMount(){super.didMount(),this.rowsWrapEl&&(this[W$]=new MutationObserver(this.handleRowsObserverChange),this[W$].observe(this.rowsWrapEl,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))}[HU](e){this.context[lU]?this.context[lU](e):N[HU]({[C$]:this[C$],url:e})}renderComponent(){const{[l$]:e,[p$]:t,[g$]:i,[c$]:o}=this[T$],s=this[_$][O$],r=this.isDragAndFillEnabled()&&s&&(s[R$].col===s.end.col&&s[R$].row===s.end.row||this[A$][H$][O$])?a()(U$,{[l$]:e,[p$]:t,[S$]:s,[H$]:this[A$][H$],[g$]:i,[c$]:o,[hU]:this[hU],frozenIndexStore:this.frozenIndexStore}):null,l=this[T$].render({onPropertyTab:this.handlePropertyTab,onPropertyUntab:this.handlePropertyUntab,onPropertyEnter:this.handlePropertyEnter,onPropertyClick:this.handlePropertyClick,onPropertyEsc:this.handlePropertyEsc,onPropertyBgClick:this.handlePropertyBgClick,[nU]:this.handlePropertyContextMenu,onOpenProperty:this.handlePropertyOpenProperty,onSelectableEnter:this.handleRowSelectableEnter});return a()(Ro.Z,{capture:void 0!==this[_$][O$],onLeft:this.handleLeft,onRight:this.handleRight,onUp:this.handleUp,onDown:this.handleDown,onEnter:this[m$],onTab:this.handleTab,onUntab:this.handleUntab,onEsc:this.handleEsc,onDelete:this[$U],onBackspace:this[$U],onCut:this.handleCut,onCopy:this.handleCopy,onPaste:this.handlePaste,onCommandEnter:this.handleCommandEnter,onShiftEnter:this[GU],onCommandShiftEnter:this.handleCommandShiftEnter,onDuplicate:this.handleDuplicate,onKeypress:this.handleKeypress,onMoveTo:this.handleMoveTo},void 0,a()(ZT.Z,{[eU]:this[N$],onDraggableDragMove:this[B$],[Jz]:this.handleDragEnd,[jz]:this[M$],[r$]:this[T$][r$],render:e=>c[iU]("div",n()({[tU]:{[rU]:sU,[oU]:this[T$][oU]}},e,{ref:this.handleRowsWrapMount}),r,l)}))}[V$](e){let t=e;for(;null!==t&&!t.classList.contains(X.tableViewCell);)t=t[Yz];if(null===t)return;return{col:parseInt(t[Xz]("data-col-index")??"0"),row:parseInt(t[Xz]("data-row-index")??"0")}}dragAndFillCells(){var e;const t=this[A$][H$][O$];if(!t)return;const{[R$]:i,end:o}=t;if(i.col!==o.col||i.row!==o.row)return;const{[c$]:s,[p$]:r,[x$]:n}=this[T$],l=null===(e=r[s[O$][i.col][u$]])||void 0===e?void 0:e.type;if("verification"===l)return;const a=this[_$][O$];if(!a)return;z[i$]({[t$]:"TableSelectionOverlay.handleDragAndFill",[C$]:this[C$],[e$]:e=>{this[TU]({[jU]:e,[S$]:a,[R$]:i})}});const d=Math.min(a[R$].row,a.end.row),h=Math.max(a[R$].row,a.end.row);l&&h!==d&&R.trackTableDragAndFill({[C$]:this[C$],[x$]:n,property_type:l,num_rows:h-d}),this[A$][H$].reset()}[SU](){if(!(0,_z.isCollectionsMultiSelectToolbarEnabled)(this[C$]))return!0;const e=this[T$][a$][O$];return!e[kU]||0===e.additionalStores[v$]}isDragAndFillEnabled(){const{[h$]:e,[x$]:t}=this[T$],i=t.permissionScopes[O$];return!(e||!i.canEditContent)&&"on"===ke.default.getEligibleGroup({experimentId:"collection_table_drag_and_fill",defaultGroup:"control"})}[E$](e){const t=this[T$][x$][I$]();t&&(HF[E$]({[C$]:this[C$],[k$]:{[I$]:t,[b$]:this[T$][b$]},[S$]:this.normalizeTableSelection(e)}),this[hU].recompute())}getRowRect(e){const{rowsWrapEl:t}=this;if(!t)return;const i=TT.C[qz](e).map((e=>e.getNode())).find((e=>t.contains(e)));return i?i[Qz]():void 0}isTargetWithinDragAndFillHandle(e){let t=e;for(;null!==t;){if(t.classList.contains(X.tableViewDragAndFillHandle))return!0;t=t[Yz]}return!1}[y$](){return this[T$][c$][O$][v$]}[bU](e,t){const i=this[T$][g$][O$];return{col:this[T$][c$][O$].findIndex((e=>e[u$]===t)),row:i.findIndex((t=>e===t))}}[f$](e){const t=this[_$][O$];if(t){let i;i=e===K$.Down?t[R$].row>t.end.row?t[R$]:t.end:e===K$.Up?t[R$].row<t.end.row?t[R$]:t.end:e===K$.Right?t[R$].col>t.end.row?t[R$]:t.end:t[R$].col<t.end.row?t[R$]:t.end;const o=this[T$][g$][O$][i.row],s=this[T$][c$][O$][i.col][u$],r=LH.Z[$z](o,s),n=(null==r?void 0:r.getNode())??null;if(n){const e=this.frozenSectionWidthStore[O$]??0,i=this.frozenIndexStore[O$],o=this[T$][r$]||i&&t[R$].col<=i&&t.end.col<=i;G.scrollElementIntoView({element:n,vertical:{reveal:"closest",paddingToTopEdge:96,paddingToBottomEdge:48},horizontal:o?void 0:{reveal:"closest",paddingToLeftEdge:e},scrollers:{verticalScroller:null==r?void 0:r[Uz](),horizontalScroller:null==r?void 0:r[zz]()}})}}}[TU](e){const{[jU]:t,[S$]:i,[R$]:o}=e,{[g$]:s,[c$]:r}=this[T$],n=s[O$],l=r[O$][o.col],a=n[o.row].getPropertyValue(l[u$])||[],d=Math.min(i[R$].row,i.end.row),h=Math.max(i[R$].row,i.end.row);n[o$](d,h+1).forEach((e=>{e.pointer!==n[o.row].pointer&&Bi[JU]({[l$]:e[s$](l[u$]),value:a,[jU]:t})}))}normalizeTableSelection(e){const t=this[y$](),i=this[T$][g$][O$][v$];return{[R$]:{col:(0,cF.Z)(e[R$].col,0,t-1),row:(0,cF.Z)(e[R$].row,0,i-1)},end:{col:(0,cF.Z)(e.end.col,0,t-1),row:(0,cF.Z)(e.end.row,0,i-1)}}}getXForFirstCellInRow(){const{[x$]:e}=this[T$];return(0,ie.shouldShowBulkActionsToolbar)({[C$]:this[C$],[x$]:e})?il.Xx:0}getCellRect(e){const{rowsWrapEl:t}=this;if(!t)return;const{[c$]:i,[g$]:o}=this[T$],s=i[O$],r=o[O$][e.row],n=this.getRowRect(r);if(!n)return;const l=t[Qz](),a=n.height,d=n.top-l.top-1,h=s[e.col].width||0,c=a+1;let u=this.getXForFirstCellInRow();for(let p=0;p<e.col;p++){const e=s[p];e.width&&(u+=e.width)}return new DOMRect(u-1,d,h+1,c)}}z$.displayName="TableSelectionOverlay",z$.contextTypes={...$.wK,...p.w};function U$(e){var t;window.__c={n:"DragAndFillHandle"};const{[l$]:i,[p$]:o,[S$]:s,[H$]:r,[g$]:l,[c$]:d,[hU]:h,frozenIndexStore:u}=e,p=(0,Xn.VK)((()=>r[O$]),[r]),m=(0,Xn.VK)((()=>{const e=(null==p?void 0:p[R$])||s[R$];return d[O$][e.col]}),[p,s,d]),g=(0,P.useIntl)(),v=(0,Xn.VK)((()=>{if(!p||!m)return[];const{[R$]:e}=p,t=l[O$][e.row].getModel();return t?(0,Vz.v4)({[u$]:m[u$],[p$]:o,block:t,[Kz]:i[Kz],userTimeZone:(0,Qe.r)(),baseURL:void 0,intl:g}):""}),[l,p,g,m,o,i]),f=m?null===(t=o[m[u$]])||void 0===t?void 0:t.type:void 0,y=(0,Xn.VK)((()=>h[O$]),[h]),w=(0,Xn.VK)((()=>{const e=u[O$];return void 0!==e&&s[R$].col<=e}),[u,s]),S=(0,Yn.yK)((e=>({dragAndFillContainer:{zIndex:w?I.tableFrozenColumns+2:void 0,display:Wz,[rU]:sU},dragAndFillOutsideStickyWrapper:{display:Wz,width:"calc(100% - 64px)"},dragAndFillInsideStickyWrapper:{[rU]:w?"sticky":void 0,left:"0"},tooltipOrigin:{[rU]:"absolute",left:y?y.left+y.width-4:void 0,top:y?y.bottom-7:void 0,width:10,height:15,pointerEvents:"auto",cursor:"ns-resize"},tooltipCircle:{[rU]:"absolute",left:y?y.left+y.width-4:void 0,top:y?y.bottom-5:void 0,width:9,height:9,border:`2px solid ${yh.ZP.blueWithAlpha(.57)}`,transform:p?"scale(1.3)":void 0,transition:"transform 0.2s ease",background:e.contentBackground,borderRadius:"50%",zIndex:I.collectionTableSelection,cursor:"ns-resize"},tooltipText:{color:e[Hz],maxWidth:200,...x.Z.textOverflowStyle}})),[p,y,w]);return y?!f||Ii.isMetadataPropertyType(f)||"rollup"===f||"formula"===f||"verification"===f?null:a()(at.Z,{renderTooltip:()=>{const e=a()(P.FormattedMessage,{id:"tableView.selectionOverlay.dragAndFill.tooltip",[Gz]:"Drag vertically to fill value"});return p?a()("div",{[tU]:{display:Wz,[Nz]:Fz}},void 0,e,a()("div",{[tU]:S.tooltipText},void 0,v)):e},delayThreshold:300,forceVisibleState:!!p||void 0,placement:Oz.u.Right,render:e=>c[iU]("div",n()({},e,{className:X.tableViewDragAndFillHandle,[tU]:S.dragAndFillContainer}),a()("div",{[tU]:S.dragAndFillOutsideStickyWrapper},void 0,a()("div",{[tU]:S.dragAndFillInsideStickyWrapper},void 0,a()("div",{[tU]:S.tooltipOrigin}),a()("div",{[tU]:S.tooltipCircle}))))}):null}const $$=z$,Q$=i(85).dMt,q$=i(85).MZ8,X$=i(85).P4,Y$=i(85).$Vg,j$=i(85).H1U,J$=i(85).rps,eQ=i(85).$bT,tQ=i(85).L_E;function iQ(e){window.__c={n:"TableShimmer"};const{isFullScreen:t,hasGroups:i,propertyWidths:o,hasPartialResults:s,hasSearchQuery:r}=e,n=(0,Yn.yK)((e=>({[tQ]:{display:"flex",[eQ]:J$,[j$]:Y$,alignSelf:X$},rowsContainer:{display:"flex",[eQ]:J$,[j$]:Y$,alignSelf:X$},[q$]:{display:"flex",padding:"0px 16px",[j$]:Y$,gap:1,alignSelf:X$,borderBottom:`1px solid ${e[Q$]}`},lastRowContainerOverride:{borderBottom:void 0},rowShimmer:{width:200,height:10,flexShrink:0,borderRadius:12,backgroundColor:e.lightDividerColor,marginLeft:6},firstRowPartialResultsOverride:{borderTop:`1px solid ${e[Q$]}`},[J$]:{display:"flex",width:200,height:34,padding:"6px 8px",[j$]:"center",gap:6}})),[]);if(!(0,vy.Z)(!0,0,100))return null;const l=o.map(((e,t)=>a()("div",{style:{...n[J$],width:e}},t,a()(Dy.Z,{style:{...n.rowShimmer,width:.6*e}}))));let d=1;i||s||r||(d=t?10:3);const h=[...Array(d)].map(((e,t)=>{const i=s?n.firstRowPartialResultsOverride:{},o=t===d-1?n.lastRowContainerOverride:{};return a()("div",{style:{...n[q$],...i,...o}},t,l)}));return a()("div",{style:n[tQ]},void 0,a()("div",{style:n.rowsContainer},void 0,h))}const oQ=i(85).uRL,sQ=i(85).rOg,rQ=i(85).zrY,nQ=i(85).Scd,lQ=i(85).SjN,aQ=i(85).qc1,dQ=i(85).TN,hQ=i(85).nx5,cQ=i(85).fBv,uQ=i(85).TEz,pQ=i(85).Y9u,mQ=i(85).OM8,gQ=i(85).jkI,vQ=i(85).H1U,fQ=i(85).bSA,yQ=i(85).fBu,wQ=i(85).zkl,SQ=i(85).NF1,bQ=i(85).y79,kQ=i(85).u9,CQ=i(85).E5B,TQ=i(85).eNH,xQ=i(85).vlf,IQ=i(85).Syl,PQ=i(85).Anf,DQ=i(85).MnL,MQ=i(85).VFD,ZQ=i(85).k9$,BQ=i(85).IcT,RQ=i(85).mOq,EQ=i(85).mSd,VQ=i(85).Uk6,AQ=i(85).v5W,LQ=i(85).Uww,_Q=i(85).$ZS,OQ=i(85).$Fm,FQ=i(85).Mm1,NQ=i(85).vK9,GQ=i(85).pkR,HQ=i(85).Kiu,WQ=i(85).YDv,KQ=i(85).miS,zQ=i(85).Au,UQ=i(85).xej,$Q=i(85).GPw,QQ=i(85).X_m,qQ=i(85).EMU,XQ=i(85).sM5,YQ=i(85).wu4,jQ=i(85).JrN,JQ=i(85).rQ1,eq=i(85).bQB,tq=i(85).Jkr,iq=i(85).k6_,oq=i(85).Lbv,sq=i(85).gNE,rq=i(85).iWP,nq=i(85).cJo,lq=i(85).qU4,aq=i(85).f7G,dq=i(85).LIR,hq=i(85).XqV,cq=i(85).dLQ,uq=i(85).q$s,pq=i(85).TtP,mq=i(85).piL,gq=i(85).vTv,vq=i(85).BpM,fq=i(85).KNN,yq=i(85).MAy,wq=i(85).NqT,Sq=i(85).urI,bq=i(85).Zij,kq=i(85).ffk,Cq=i(85).ZG6,Tq=i(85).LCr,xq=i(85).ixe,Iq=i(85).Ttb,Pq=i(85).sP9,Dq=i(85).nxU,Mq=i(85).wgE,Zq=i(85).Drs,Bq=i(85).JJj,Rq=i(85).iKt,Eq=i(85).vX_,Vq=i(85).XtO,Aq=i(85).rGB,Lq=i(85)._2_,_q=i(85).Ylz,Oq=i(85).oWD,Fq=i(85).$pZ,Nq=i(85).QmD,Gq=i(85).P0R,Hq=i(85).P24,Wq=i(85).xd5,Kq=i(85).unR,zq=i(85).EIp;class Uq extends Le.Z{constructor(){super(...arguments),this.useExperimentalTableSelectionOverlay=this[zq]((()=>ke.default[Kq]("layout_functional_inner_table_overlay"))),this.allRowsStore=this[zq]((()=>{const{[Wq]:e,[Hq]:t}=this[Gq];return(0,tl.A7)(e,t)})),this.onItemShiftEnter=()=>{const e=this.groupStateStore[Nq];if(!e)return;const{[Hq]:t,[Fq]:i}=this[Gq],o=t[Oq]();if(!o||!t[_q]())return;const s=_i.default[Nq].stores[0];if(!s)return;const r=t[Lq][Nq],n=(0,el.DY)(r[Aq],(e=>e.value[Vq]===s));if(!n)return;const l=n?(0,tl.Af)(n.map((e=>e.value[Vq]))):"",a=t[Eq][Nq].get(l);Boolean(null==a?void 0:a[Rq])&&z[Bq]({[Zq]:"TableGroupResults.onItemShiftEnter",[Mq]:this[Mq],[Dq]:r=>{const l=E.insertNewBlock({[Mq]:this[Mq],[Hq]:t,[Pq]:e[Pq],[Iq]:e[xq][Nq],[Vq]:s,before:!1,[Oq]:o,[Tq]:r,subitemPath:n,subitemInsertDirection:"into"});l&&i&&m.default[Cq]((()=>{m.default[Cq]((()=>{Zi.open({isNewBlock:!0,[Mq]:this[Mq],[Fq]:i,[Vq]:l,[kq]:bq,[Sq]:Mo.C.Table,[Hq]:t})}))}))}})},this[wq]=()=>{const e=new N_.sA(this[Mq],wq),{[Hq]:t,[yq]:i,[Wq]:o}=this[Gq],{device:s}=this[Mq],r=o?[o]:[],n=t[vq][fq](r);if(!Ke[gq](this[Mq])||!n)return void e.fail("invalid_state");t[mq][Nq]&&L.updateSearchQuery({[mq]:"",[Hq]:t,[yq]:i});const l=n[xq][Nq];z[Bq]({[Zq]:"TableGroupResults.handleAddRowClick",[Mq]:this[Mq],[Dq]:i=>{const{coercionSucceeded:r,newStore:a}=E.createBlockInGroup({[Mq]:this[Mq],[Hq]:t,[Pq]:o?[o]:[],[Iq]:l,insertAtIndex:l[pq],coerce:!0,[uq]:!0,[Tq]:i,from:"table_group_results",tracker:e});if(s[cq]){const e=(0,se.ZP)({[Vq]:a,[hq]:!1,[dq]:f.tY.Create});this[aq](e)}else{m.default[Cq]((()=>{m.default[Cq]((()=>{m.default[Cq]((()=>{r?Zi.open({isNewBlock:!0,[Mq]:this[Mq],[Fq]:this[Gq][Fq],[Vq]:a,[kq]:bq,[Sq]:Mo.C.Table,[Hq]:this[Gq][Hq]}):N.peekBlock({[Mq]:this[Mq],[Vq]:a,peekMode:ie.getPeekMode(t[lq]()),[xq]:n[xq],[Hq]:t,[dq]:f.tY.Create})}))}))}));const e=t[Lq][Nq];D[nq](this[Mq],{from:e[Aq]?"table_add_parent_item_bottom":"table_add_item_bottom",type:"page",new_page_id:a.id,...(0,J.getCollectionAnalyticsContext)(t)})}}})},this[rq]=e=>{const{[Hq]:t,[Wq]:i}=this[Gq],o=t[vq][fq](i);if(!o)return;const s=o[sq][Nq];(0,re.Wi)(e),W.clear(this[Mq]),s&&E.incrementBlockLimit({[Hq]:t,[Mq]:this[Mq],incrementLimitArgs:{[yq]:this[Gq][yq],currentResultCount:s.blockIds[pq],[Pq]:o[Pq],[oq]:!1}}),D.trackInlineCollectionLoadMoreClick(this[Mq])},this.groupStateStore=this[zq]((()=>{const{[Hq]:e,[Wq]:t}=this[Gq],i=t?[t]:[];return e[vq][fq](i)})),this[iq]=this[zq]((()=>this.getTableProperties().filter((e=>e.visible))),!0),this.tableWidthStore=this[zq]((()=>{const{[Hq]:e}=this[Gq];return this[iq][Nq].reduce(((e,t)=>e+(t[tq]||0)),0)+(e[JQ].getState()[eq]?32:0)})),this.propertiesWidthStore=this[zq]((()=>this[iq][Nq].map((e=>e[tq]||Pi.defaultTableColumnWidth)))),this.titleColumnIndexStore=this[zq]((()=>this[iq][Nq][jQ]((e=>"title"===e[kq])))),this[YQ]=e=>({[XQ]:qQ,[QQ]:"calc(100% + 2px)",[$Q]:e?void 0:`1px solid ${this[zQ][UQ]}`})}renderComponent(){const{[Hq]:e,[yq]:t,[Wq]:i}=this[Gq],o=this.groupStateStore[Nq];if(!o)return;const s=o[sq][Nq],r=void 0!==s,n=ie.shouldRenderLoadMoreButton({[Hq]:e,reducerResult:s,[yq]:t}),l=void 0!==i,d=i?[i]:[],h=void 0!==s&&(null==s?void 0:s.blockIds[pq])>0,u=""!==e[mq][Nq],p=ff({[Hq]:e,[Pq]:d}),m=r&&!p&&0===(null==s?void 0:s.blockIds[pq]);return c.createElement(c.Fragment,null,this.renderHeaderRow(o),a()("div",{style:{[QQ]:OX}}),this.renderRows(o),p&&a()(iQ,{[yq]:t,hasGroups:l,propertyWidths:this.propertiesWidthStore[Nq],hasPartialResults:h,hasSearchQuery:u}),m&&a()(rF,{[Hq]:this[Gq][Hq],[KQ]:this[KQ](),[wq]:this[wq],[WQ]:this[Gq][WQ]}),a()("div",{style:{[tq]:this.tableWidthStore[Nq]}}),n&&this.renderLoadMoreButton(),this[KQ]()&&this.renderAddRowButton(),this.renderAggregationRow(),a()("div",{style:{[QQ]:NX}}))}renderHeaderRow(e){const{[Vq]:t,[HQ]:i,query:o,[GQ]:s,[Hq]:r,[NQ]:n,[FQ]:l,isScrolled:d,[OQ]:h,[Fq]:c,[Wq]:u}=this[Gq],p=r.viewIsFlushToTopbar(),m=r[JQ][Nq],g=Boolean(u),v=p&&!g,f=Boolean(r[LQ][Nq][_Q]);return a()(NK,{[Vq]:t,[Sq]:this[AQ](),[Wq]:u,[HQ]:i,query:o,[Hq]:r,[OQ]:h,[NQ]:n,[FQ]:l,[Fq]:c,resultStore:e[sq],[iq]:this[iq],showRightActions:m[VQ]&&m[EQ],allowHidingTitle:!1,[RQ]:this[Gq][RQ],formatKey:BQ,[GQ]:s||!m[VQ]&&!m[EQ],disableTopBorder:!v,disableCellRightBorder:!v||f,[QQ]:OX,isScrolled:d})}renderRows(e){const{device:t}=this[Mq],{[Vq]:i,[HQ]:o,query:s,[GQ]:r,[Hq]:n,[NQ]:l,[Fq]:d,[Wq]:h}=this[Gq],c=n[lq]();if(!c)return;const u=h?[h]:[],p=this[iq][Nq],g=n[JQ][Nq],v=this.canEditTable()&&t[cq]&&!c[ZQ](),f=Boolean(n[LQ][Nq][_Q]),y=this.titleColumnIndexStore[Nq];return a()($$,{[Vq]:i,[Sq]:this[AQ](),[HQ]:o,query:s,[Hq]:n,[NQ]:l,[Fq]:d,[iq]:this[iq],currentRowsStore:this.allRowsStore,[GQ]:!this.canEditTable(),[Wq]:h,render:e=>this.useExperimentalTableSelectionOverlay[Nq]?a()($q,{args:e,[Hq]:n,collectionViewFormat:this[AQ](),[Fq]:d,isScrolled:Boolean(this[Gq].isScrolled),[Wq]:h,[MQ]:this[iq][Nq],[HQ]:o,canDrag:v,[GQ]:r,titleColumnIndex:y,onShiftEnter:this.onItemShiftEnter}):a()(dd,{[Hq]:n,[Pq]:u,[Sq]:this[AQ](),canDrag:v,resultProps:{[HQ]:o,[Hq]:n,[MQ]:p,onPropertyTab:e.onPropertyTab,[DQ]:e[DQ],[PQ]:e[PQ],[IQ]:e[IQ],onPropertyEsc:e.onPropertyEsc,[xQ]:e[xQ],[TQ]:e[TQ],[CQ]:e[CQ],[GQ]:r,[Fq]:d,isScrolled:Boolean(this[Gq].isScrolled),showRightActionsSpacer:g[VQ],disableCellBorderRight:f,[kQ]:!1,disableLastCellBorderRight:!1,disableTableWrap:!1,onShiftEnter:()=>this.onItemShiftEnter(),titleColumnIndex:y,[Wq]:h},canDrop:!0,resultComponent:Ez,[GQ]:r,direction:ld[bQ],[YQ]:this[YQ],itemSelectableHaloStyle:{[SQ]:0},shouldShowHoverMenu:!0,[fQ]:wQ,emptyDroppableSize:0,touchDragOnly:!0,onSelectableEnter:e.onSelectableEnter,[Fq]:d,titleColumnIndex:y,nestedCreateSubitemButton:e=>{const{[Vq]:t,[yQ]:i,subitemPath:o,indentLevel:s}=e;if(i)return a()(XM,{[Vq]:t,[Oq]:i,subitemPath:o,indentLevel:s,[Hq]:n,[GQ]:r,[Pq]:u,onSubitemCreate:e=>{d&&m.default[Cq]((()=>{m.default[Cq]((()=>{Zi.open({isNewBlock:!0,[Mq]:this[Mq],[Fq]:d,[Vq]:e,[kq]:bq,[Sq]:Mo.C.Table,[Hq]:n})}))}))}})}})})}renderLoadMoreButton(){const{[Hq]:e,[Sq]:t}=this[Gq];return a()(Bo.Z,{onMouseDown:re.$0,onClick:this[rq],style:{[XQ]:qQ,[vQ]:gQ,[QQ]:FX+1,[tq]:"100%",[WQ]:GX,[FQ]:2,fontSize:14,[mQ]:x.Z[mQ][pQ].desktop,boxShadow:`0 -1px 0 ${this[zQ][UQ]}`,whiteSpace:"break-spaces"}},void 0,a()("span",{style:{[XQ]:qQ,[vQ]:gQ,color:this[zQ][uQ],[cQ]:"sticky",left:(this[Gq][WQ]||0)+GX}},void 0,S.Z.arrowDown(this.getNewRowButtonIconStyle()),a()(P.FormattedMessage,{id:"database.loadMoreButtonTitle",[hQ]:"Load more"}),this.canEditTable()&&a()(An,{[Hq]:e,[Sq]:t})))}renderAggregationRow(){const{[Vq]:e,[HQ]:t,query:i,[GQ]:o,[Hq]:s,[Fq]:r,[dQ]:n,[NQ]:l,[FQ]:d,[OQ]:h,[yq]:c,[Wq]:u}=this[Gq],p=s[JQ][Nq];return a()(JO,{[Vq]:e,[Wq]:u,[GQ]:o||!p[EQ],[Sq]:this[AQ](),[HQ]:t,query:i,[Hq]:s,[Fq]:r,[OQ]:h,[yq]:c,[NQ]:l,[FQ]:d,[iq]:this[iq],showRightActionsSpacer:p[VQ],[dQ]:n,style:{...!this.isReady()&&{opacity:0,[aQ]:"none",left:0,right:0}}})}renderAddRowButton(){var e;const{[Hq]:t,[OQ]:i}=this[Gq],o=(null===(e=t[lQ][Nq])||void 0===e?void 0:e[nQ])||(i?this[zQ][rQ]:this[zQ].contentBackground);return a()(Bo.Z,{onClick:this[wq],onMouseDown:re.$0,style:{[XQ]:qQ,[vQ]:gQ,[QQ]:FX,[tq]:"100%",[WQ]:8,fontSize:14,[mQ]:x.Z[mQ][pQ].desktop,borderTop:`1px solid ${this[zQ][UQ]}`,[nQ]:o,left:0,right:0},className:X.tableViewAddRow},void 0,a()("span",{style:{[XQ]:sQ,[vQ]:gQ,[cQ]:"sticky",left:this[Gq][WQ]+8,color:this[zQ][uQ]}},void 0,S.Z.plus(this.getNewRowButtonIconStyle()),a()(P.FormattedMessage,{[hQ]:"New",id:"database.tableView.addRowButton"})))}[AQ](){const{[Sq]:e}=this[Gq],{temporaryFormat:t}=this[Gq][RQ][Nq];return t||e}getTableProperties(){const e=this[AQ]();return e&&e[BQ]?e[BQ]:[]}[aq](e){this.context[oQ]?this.context[oQ](e):N[aq]({[Mq]:this[Mq],url:e})}[KQ](){const{[Hq]:e}=this[Gq];return Boolean(this.isReady()&&this.canEditTable()&&e[_q]())}isReady(){var e;return void 0!==(null===(e=this.groupStateStore[Nq])||void 0===e?void 0:e[sq][Nq])}canEditTable(){const{[Hq]:e}=this[Gq],t=e[JQ][Nq];return!!this.canEdit()&&(!t[ZQ]&&t[eq])}getNewRowButtonIconStyle(){return{[tq]:14,[QQ]:14,marginLeft:-1,marginRight:6,fill:this[zQ].lightIconColor}}}function $q(e){window.__c={n:"TableSelectionOverlayInner"};const t=(0,qn.O7)(),{args:i,[Hq]:o,collectionViewFormat:s,[Fq]:r,isScrolled:n,[Wq]:l,[MQ]:d,[HQ]:h,canDrag:u,[GQ]:p,titleColumnIndex:g,onShiftEnter:v}=e,f=(0,c.useMemo)((()=>l?[l]:[]),[l]),y=(0,Xn.VK)((()=>o[JQ][Nq]),[o[JQ]]),w=(0,Xn.VK)((()=>Boolean(o[LQ][Nq][_Q])),[o[LQ]]),S=(0,Yn.yK)((e=>({itemSelectableHalo:{[SQ]:0,zIndex:I.tableFrozenColumns}})),[]),b=(0,Yn.Fg)(),k=(0,c.useCallback)((e=>({[XQ]:qQ,[QQ]:"calc(100% + 2px)",[$Q]:e?void 0:`1px solid ${b[UQ]}`})),[b[UQ]]),C=(0,c.useCallback)((e=>{const{[Vq]:i,[yQ]:s,subitemPath:n,indentLevel:l}=e;if(s)return a()(XM,{[Vq]:i,[Oq]:s,subitemPath:n,indentLevel:l,[Hq]:o,[GQ]:p,[Pq]:f,onSubitemCreate:e=>{r&&m.default[Cq]((()=>{m.default[Cq]((()=>{Zi.open({isNewBlock:!0,[Mq]:t,[Fq]:r,[Vq]:e,[kq]:bq,[Sq]:Mo.C.Table,[Hq]:o})}))}))}})}),[r,o,p,t,f]),T=(0,c.useMemo)((()=>({[HQ]:h,[Hq]:o,[MQ]:d,onPropertyTab:i.onPropertyTab,[DQ]:i[DQ],[PQ]:i[PQ],[IQ]:i[IQ],onPropertyEsc:i.onPropertyEsc,[xQ]:i[xQ],[TQ]:i[TQ],[CQ]:i[CQ],[GQ]:p,[Fq]:r,isScrolled:n,showRightActionsSpacer:y[VQ],disableCellBorderRight:w,[kQ]:!1,disableLastCellBorderRight:!1,disableTableWrap:!1,onShiftEnter:v,titleColumnIndex:g,[Wq]:l})),[i[CQ],i[xQ],i[IQ],i[TQ],i[PQ],i.onPropertyEsc,i.onPropertyTab,i[DQ],r,o,p,w,n,v,y[VQ],d,h,g,l]);return a()(dd,{[Hq]:o,[Pq]:f,[Sq]:s,canDrag:u,resultProps:T,canDrop:!0,resultComponent:Ez,[GQ]:p,direction:ld[bQ],[YQ]:k,itemSelectableHaloStyle:S.itemSelectableHalo,shouldShowHoverMenu:!0,[fQ]:wQ,emptyDroppableSize:0,touchDragOnly:!0,onSelectableEnter:i.onSelectableEnter,[Fq]:r,titleColumnIndex:g,nestedCreateSubitemButton:C})}Uq.contextTypes={...$.wK,...p.w};const Qq=(0,P.injectIntl)(Uq),qq=i(85).$pZ,Xq=i(85).TN,Yq=i(85).gIX,jq=i(85).ttX,Jq=i(85).xOW,eX=i(85).XCs,tX=i(85).YDv,iX=i(85).Mm1,oX=i(85).GmX,sX=i(85).zrY,rX=i(85).$Fm,nX=i(85).Au,lX=i(85).xej,aX=i(85).fHC,dX=i(85).rHi,hX=i(85).ToI,cX=i(85).P0z,uX=i(85).xeN,pX=i(85).QQK,mX=i(85).EIp,gX=i(85).ixe,vX=i(85).qU4,fX=i(85).xd5,yX=i(85).LIR,wX=i(85).jDA,SX=i(85).aV8,bX=i(85).Lbv,kX=i(85).sP9,CX=i(85).wgE,TX=i(85).gNE,xX=i(85).BpM,IX=i(85).KNN,PX=i(85).xYh,DX=i(85).QmD,MX=i(85).P0R,ZX=i(85).MAy,BX=i(85).P24,RX=i(85).m3I,EX=i(85)._V5,VX=i(85).D7I,AX=i(85).XDJ,LX=i(85).odo,_X=i(85).mOq,OX=34,FX=32,NX=32,GX=8;class HX extends Le.Z{constructor(){super(...arguments),this.storeTypes={[_X]:KE},this[LX]=e=>c[VX](mf,n()({},e,{height:42,[EX]:8,toggleClosedMarginBottom:8,getComputedStickyStyle:this[AX]})),this[RX]=e=>{const{[BX]:t,[ZX]:i}=this[MX],o=t[PX][DX],s=t[xX][IX]([]),r=null==s?void 0:s[TX][DX];e<ye.Z.incrementScrollOffset&&r&&!o&&r.hasMore&&E.incrementBlockLimit({[BX]:t,[CX]:this[CX],incrementLimitArgs:{[ZX]:i,currentResultCount:r.blockIds.length,[kX]:[],[bX]:!1}})},this[SX]=(e,t,i)=>{if(this[CX].device.isMobile)N[wX]({[CX]:this[CX],store:e,[yX]:f.tY.Create});else{const{[BX]:t}=this[MX],{[fX]:o}=i,s=o?[o]:[],r=t[xX][IX](s);N.peekBlock({[CX]:this[CX],store:e,peekMode:ie.getPeekMode(t[vX]()),[gX]:null==r?void 0:r[gX],[BX]:t,[yX]:f.tY.Create})}},this.viewSettingsSidebarOpen=this[mX]((()=>{var e;return this[MX][BX][pX][DX].open&&"sidebar"===(null===(e=this[MX][uX])||void 0===e?void 0:e[DX])})),this.getGroupStyle=e=>{const{[BX]:t}=this[MX],i=t.viewIsFlushToTopbar();if(0===e.index&&!i)return{};return t[cX][DX]&&"on"===ke.default[hX]({[dX]:"collections_loading_state",[aX]:"control"})&&e.index>0?{}:{borderTop:`1px solid ${this[nX][lX]}`}},this[AX]=e=>({boxShadow:e?`0 -1px 0 ${this[MX][rX]?this[nX][sX]:this[nX][oX]}`:void 0})}renderPersisted(){const{store:e,[iX]:t,[tX]:i,[eX]:o,[ZX]:s,[BX]:r,format:l}=this[MX],d=ie.shouldUseLoadMoreButton(r,s),h=l.collection_group_by;return(0,He.Z)((l=>{const u=c[VX](rl.Z,n()({store:e,shouldShowHalo:!s,canSelect:!s,analyticsName:"table",style:{position:Jq}},l),h?this.renderGroups(h):this[jq](void 0));return a()("div",{style:{...HX.style,[iX]:t,[tX]:i,[eX]:o+(this.viewSettingsSidebarOpen[DX]?FE.nJ+20:0)},className:X.tableView},void 0,h?u:a()(Af,{[Yq]:r[Yq],[ZX]:s},void 0,u),!d&&a()(hd.Z,{onChange:this[RX]}))}))}renderGroups(e){const{store:t,format:i,[BX]:o,schema:s,disabled:r,[ZX]:n,[tX]:l,isRootChild:d,[rX]:h}=this[MX];return a()(Tk,{store:t,id:"table_groups",groupBy:e,groupsFormatKey:_e.Uh,groupAggregationKey:_e.dQ,format:i,schema:s,[BX]:o,disabled:r,[ZX]:n,renderGroup:e=>this[jq](e),renderHeader:this[LX],onGroupHeaderAddItem:this[SX],[tX]:l,getGroupStyle:this.getGroupStyle,isRootChild:d,[rX]:h,stickyLeft:!0})}[jq](e){const{store:t,format:i,schema:o,query:s,[BX]:r,[Xq]:n,isScrolled:l,[ZX]:d,[rX]:h,disabled:c,[qq]:u,minWidth:p,[iX]:m,[tX]:g}=this[MX];if(r[xX][IX](e?[e]:[]))return a()(Qq,{[_X]:this.stores[_X],[fX]:e,store:t,format:i,schema:o,query:s,[BX]:r,[Xq]:n,isScrolled:l,[ZX]:d,[rX]:h,disabled:c,[qq]:u,minWidth:p,[iX]:m,[tX]:g})}}HX.style={position:Jq,float:"left",minWidth:"100%",WebkitUserSelect:"none",fontVariantNumeric:"lining-nums tabular-nums"};const WX=(0,P.injectIntl)(HX),KX=i(85).dMt,zX=i(85).NR2,UX=i(85).nKX,$X=i(85).w0c,QX=i(85).YNm,qX=i(85).QmD,XX=i(85).HwH,YX=i(85).gGi,jX=i(85).tLG,JX=i(85).fBv,eY=i(85).khk,tY=i(85).ASm;class iY extends p.Z{constructor(){super(...arguments),this[tY]=void 0,this.handleSeconds=()=>{0===(new Date).getSeconds()&&this[eY]()}}didMount(){super.didMount(),this[tY]=setInterval(this.handleSeconds,1e3)}willUnmount(){super.willUnmount(),clearInterval(this[tY])}renderComponent(){return a()("div",{style:{[JX]:jX,width:YX,height:YX,overflow:"hidden",cursor:"default"}},void 0,this.renderWeekendIndicators(),this.renderVerticalDividers(),this.renderNowVerticalDivider())}renderWeekendIndicators(){const{[XX]:e}=this.props,t=e[QX][qX],{[$X]:i}=te.BJ[t];if(!i)return;const{startTimestamp:o,endTimestamp:s}=e[UX][qX];let r=(0,te.DS)(DT.ou.fromMillis(o),"day");const n=[];for(;r.valueOf()<s;){6===r.weekday&&n.push(this.renderWeekendIndicator(r));r=(0,te.Ip)(r,"day")}return n}renderWeekendIndicator(e){const{[XX]:t}=this.props,i=t[QX][qX],{startTimestamp:o}=t[UX][qX],s=e.plus({day:2}).startOf("day"),r=(0,te.e$)(i,e.valueOf()-o),n=(0,te.e$)(i,s.valueOf()-o);return a()("div",{style:{[JX]:jX,left:r,width:n-r,height:YX,background:this.theme.timelineDarkerBackground}},e.valueOf())}renderVerticalDividers(){const{[XX]:e}=this.props,t=e[QX][qX],{verticalDividerUnit:i}=te.BJ[t];if(!i)return;const{startTimestamp:o,endTimestamp:s}=e[UX][qX],r=[];let n=(0,te.DS)(DT.ou.fromMillis(o),i);for(;n.valueOf()<s;){r.push(this.renderVerticalDivider(n.valueOf()));n=(0,te.Ip)(n,i)}return r}renderVerticalDivider(e){const{[XX]:t}=this.props,i=t[QX][qX],{startTimestamp:o}=t[UX][qX],s=(0,te.e$)(i,e-o);return a()("div",{style:{[JX]:jX,left:s,height:YX,[zX]:`1px solid ${this.theme[KX]}`}},e)}renderNowVerticalDivider(){const{[XX]:e}=this.props,t=e[QX][qX],{startTimestamp:i}=e[UX][qX],o=DT.ou.now().startOf("minute"),s=Math.floor((0,te.e$)(t,o.valueOf()-i));return a()("div",{style:{[JX]:jX,left:s,height:YX,[zX]:`1px solid ${this.theme.timelineRed}`}})}}iY.displayName="TimelineBackground";const oY=iY,sY=i(85).sy7,rY=i(85).uzK,nY=i(85).n36,lY=i(85).Ttb,aY=i(85).sP9,dY=i(85).nxU,hY=i(85).Drs,cY=i(85).JJj,uY=i(85).UgH,pY=i(85).lmZ,mY=i(85)._yk,gY=i(85).wgE,vY=i(85).Q_9,fY=i(85).siJ,yY=i(85)._2_,wY=i(85).QmD,SY=i(85).xd5,bY=i(85).ixe,kY=i(85).zaB,CY=i(85).AYg,TY=i(85).oWD,xY=i(85).LCr,IY=i(85).P0R,PY=i(85).P24,DY=i(85).XtO;class MY extends p.Z{constructor(){super(...arguments),this.handleRemove=e=>{const{[DY]:t,[PY]:i}=this[IY],{[xY]:o}=e;i[TY]()&&E.remove({[DY]:t,[xY]:o})},this.handleDrop=e=>{const{[CY]:t,droppedStores:i,[kY]:o}=e,{[DY]:s,[PY]:r,[TY]:n,[bY]:l,[SY]:a}=this[IY],d=r[yY][wY],h=(0,el.DY)(d.children,(e=>e.value[DY]===s)),c=pe.default.mark(fY);pe.default[vY](c,{[gY]:this[gY],[mY]:()=>J[pY]({[PY]:r,is_native_drop:!1,[uY]:!1})}),z[cY]({[hY]:"CollectionTimelineViewDroppableRow.handleDrop",[gY]:this[gY],[dY]:e=>{E.handleGroupDrop({[gY]:this[gY],[TY]:n,targetStore:s,[CY]:t,[PY]:r,[aY]:a?[a]:[],droppedStores:i,[lY]:l[wY],[kY]:o,[xY]:e,subitemPath:h})}})},this.handleInsertBelow=e=>{const{insertStores:t,[xY]:i}=e,{[DY]:o,[PY]:s,[TY]:r,[bY]:n,[SY]:l}=this[IY];return E.insert({[gY]:this[gY],[TY]:r,[PY]:s,[aY]:l?[l]:[],[lY]:n[wY],insertStores:t,[DY]:o,before:!1,[xY]:i})},this.handleInsertAbove=e=>{const{insertStores:t,[xY]:i}=e,{[DY]:o,[PY]:s,[TY]:r,[bY]:n,[SY]:l}=this[IY];return E.insert({[gY]:this[gY],[TY]:r,[PY]:s,[aY]:l?[l]:[],[lY]:n[wY],insertStores:t,[DY]:o,before:!0,[xY]:i})},this[nY]=e=>{const{files:t,[CY]:i}=e,{[PY]:o,[TY]:s,[bY]:r,[SY]:n}=this[IY],l=o[rY](),a=pe.default.mark(fY);pe.default[vY](a,{[gY]:this[gY],[mY]:()=>J[pY]({[PY]:o,is_native_drop:!0,[uY]:!1})}),l&&z[cY]({[hY]:"CollectionTimelineViewDroppableRow.handleNativeDrop",[gY]:this[gY],[dY]:e=>{E.handleGroupNativeDrop({[gY]:this[gY],[TY]:s,targetStore:l,[CY]:i,[PY]:o,[aY]:n?[n]:[],files:t,[lY]:r[wY],[xY]:e})}})}}renderComponent(){const{[DY]:e}=this[IY];return a()(rl.Z,{[DY]:e,style:{width:"100%",height:33},canDropBelow:!0,canNativeDropBelow:!0,shouldShowDropZone:!0,dropzoneShouldNeverUseOrigin:!0,[sY]:!0,canInsertAbove:!0,canInsertBelow:!0,onInsertBelow:this.handleInsertBelow,onInsertAbove:this.handleInsertAbove,onSelectableDrop:this.handleDrop,onNativeDrop:this[nY],onRemove:this.handleRemove,analyticsName:"timeline"},e.id)}}MY.displayName="CollectionTimelineViewDroppableRow";const ZY=MY,BY=i(85).sy7,RY=i(85).bSA,EY=i(85).gGi,VY=i(85).phM,AY=i(85).hNC,LY=i(85).k9$,_Y=i(85).Xt4,OY=i(85).LCr,FY=i(85).QmD,NY=i(85).Ttb,GY=i(85).sP9,HY=i(85).nxU,WY=i(85).Drs,KY=i(85).JJj,zY=i(85).UgH,UY=i(85).lmZ,$Y=i(85)._yk,QY=i(85).wgE,qY=i(85).Q_9,XY=i(85).siJ,YY=i(85).uzK,jY=i(85).zaB,JY=i(85).AYg,ej=i(85).GfJ,tj=i(85).kId,ij=i(85).ixe,oj=i(85).BpM,sj=i(85).KNN,rj=i(85).oWD,nj=i(85).P0R,lj=i(85).xd5,aj=i(85).P24;class dj extends p.Z{constructor(){super(...arguments),this.instanceStore=void 0,this.renderRowDropzoneSelectable=e=>{const{[aj]:t,[lj]:i}=this[nj],o=t[rj]();if(!o)return;const s=t[oj][sj](i);return s?a()(ZY,{store:e,[lj]:i,[rj]:o,[aj]:t,[ij]:s[ij],isLast:!1,[tj]:()=>{}},e.id):void 0},this[ej]=e=>{const{[JY]:t,droppedStores:i,[jY]:o}=e,{[lj]:s,[aj]:r}=this[nj],n=r[rj]();if(!n)return;const l=r[oj][sj](s);if(!l)return;const a=r[YY](),d=pe.default.mark(XY);pe.default[qY](d,{[QY]:this[QY],[$Y]:()=>J[UY]({[aj]:r,is_native_drop:!1,[zY]:!0})}),a&&z[KY]({[WY]:"TimelineDropzoneSelectableGroupResults.handleEmptyDroppableDrop",[QY]:this[QY],[HY]:e=>{E.handleGroupDrop({[QY]:this[QY],[rj]:n,targetStore:a,[JY]:t,[aj]:r,[GY]:l[GY],droppedStores:i,[NY]:l[ij][FY],[jY]:o,[OY]:e})}})},this[_Y]=e=>{const{files:t,[JY]:i}=e,{[aj]:o,[lj]:s}=this[nj],r=o[rj]();if(!r)return;const n=o[oj][sj](s);if(!n)return;const l=o[YY](),a=pe.default.mark(XY);pe.default[qY](a,{[QY]:this[QY],[$Y]:()=>J[UY]({[aj]:o,is_native_drop:!0,[zY]:!0})}),l&&z[KY]({[WY]:"TimelineDropzoneSelectableGroupResults.handleEmptyDroppableNativeDrop",[QY]:this[QY],[HY]:e=>{E.handleGroupNativeDrop({[QY]:this[QY],[rj]:r,targetStore:l,[JY]:i,[aj]:o,[GY]:s?[s]:[],files:t,[NY]:n[ij][FY],[OY]:e})}})}}willMount(e){super.willMount(e),this.instanceStore=new Ee.G(this[QY],e.store.pointer)}renderComponent(){const{device:e}=this[QY],{[lj]:t,canEdit:i,disabled:o,format:s,[aj]:r}=this[nj],n=r[oj][sj](t);if(!n)return;const l=r.permissionScopes[FY],d=r[rj](),h=r.collectionViewStore(),u=i&&l.canEditContent&&!l[LY]&&e.isMobile&&!(null!=h&&h[LY]());return c.createElement(c.Fragment,null,this[AY](),n&&d?a()(dd,{[aj]:r,[GY]:t?[t]:[],format:s,canDrag:u,disableRequest:!0,resultProps:{[lj]:t,[rj]:d,[aj]:r,[ij]:n[ij],isLast:!1,[tj]:()=>{}},canDrop:!0,resultComponent:ZY,disabled:o,direction:ld.Vertical,shouldShowHoverMenu:!1,[RY]:VY,emptyDroppableSize:0,touchDragOnly:!0,disableSelectable:!0,nestedCreateSubitemButton:e=>a()("div",{style:{width:EY,height:33}})}):n[ij][FY].map(this.renderRowDropzoneSelectable))}[AY](){if(this.instanceStore){const{canEdit:e}=this[nj];return a()(rl.Z,{store:this.instanceStore,shouldShowDropZone:e,canDropBelow:e,canNativeDropBelow:e,dropzoneShouldNeverUseOrigin:!0,[BY]:!0,onSelectableDrop:this[ej],onNativeDrop:this[_Y],[RY]:VY,style:{width:EY}})}}}dj.displayName="TimelineDropzoneSelectableGroupResults";const hj=dj;var cj=i(42239);const uj=i(85).LWT,pj=i(85).D7I,mj=i(85).BQ6,gj=i(85).fmj,vj=i(85).uDf,fj=i(85).wgE,yj=i(85).DN1,wj=i(85).P24,Sj=i(85).HwH;function bj(e){window.__c={n:"TimelineItemDependencyDrawHandle"};const{store:t,schema:i,[Sj]:o,dateValueStore:s,[wj]:r,isFullScreen:l,isRootChild:d}=e,h=(0,c.useRef)(null),[u,p]=(0,c.useState)(!1),m=(0,qn.O7)(),g=(0,Xn.VK)((()=>{const e=o.drawState.state;if(e)return e.startStore===t}),[t,o.drawState]),v=(0,Xn.VK)((()=>!g&&o.hoveredItem.state===t&&!Te.Z.state),[g,t,o.hoveredItem]),f=(0,Xn.VK)((()=>(0,te.H5)(r)),[r]),y=(0,c.useCallback)((e=>{if(e.preventDefault(),!o.scrollLeft.state||!h.current)return;const s=(0,de.VW)(h.current);GE.startDraw({[Sj]:o,store:t,startX:e.startX,startY:e.startY,schema:i,[wj]:r,[yj]:s}),p(!1)}),[r,i,t,o]),w=(0,c.useCallback)((e=>{if(!h.current)return;const t=(0,de.VW)(h.current);GE.continueDraw({[Sj]:o,currentX:e.currentX,currentY:e.currentY,[yj]:t})}),[o]),S=(0,c.useCallback)((()=>{z.createAndCommit({userAction:"TimelineItemDependencyDrawHandle.handleDraggableDragEnd",[fj]:m,perform:e=>{GE.completeDraw({[Sj]:o,[fj]:m,transaction:e,[wj]:r,isFullScreen:l,isRootChild:d})}})}),[m,o,r,l,d]),b=(0,c.useCallback)((e=>{GE.cancelDraw({[Sj]:o,[fj]:m})}),[m,o]),k=(0,c.useCallback)((()=>{p(!0)}),[p]),C=(0,c.useCallback)((()=>{p(!1)}),[p]),T=(0,Yn.yK)((e=>({draggableStyle:{position:"absolute",top:0,right:-24,width:24,height:"100%",zIndex:1},draggableSvgStyle:{position:"absolute",left:0,cursor:"pointer"},svgPathStyle:{stroke:f?e[vj]:e[gj],strokeWidth:te.lf},svgCircleFill:{color:e.white}})),[f]),x=(0,c.useCallback)((e=>{if(!s.state)return;return c[pj]("div",n()({ref:h,[mj]:T.draggableStyle},e),v&&c[pj](c.Fragment,null,a()("div",{[mj]:T.draggableSvgStyle},void 0,a()("svg",{[mj]:{width:22,height:30},onMouseMove:k,onMouseLeave:C},void 0,a()(eV.Z,{startPoint:{x:0,y:14},endPoint:{x:10,y:14},[mj]:T.svgPathStyle,showArrowHead:u}),a()("circle",{cx:u?10+te.S7:10,cy:14,r:u?te.S7:te.Wk,[mj]:T.svgPathStyle,fill:T.svgCircleFill.color})))))}),[s,C,k,v,T.draggableStyle,T.draggableSvgStyle,T.svgCircleFill.color,T.svgPathStyle,u]);return a()(ZT.Z,{render:x,onDraggableDragStart:y,onDraggableDragMove:w,onDraggableDragEnd:S,[uj]:b})}const kj=i(85).qc1,Cj=i(85)._Fe,Tj=i(85).tLG,xj=i(85).fBv,Ij=i(85).LWT,Pj=i(85).W0d,Dj=i(85).EIp,Mj=i(85).Gnd,Zj=i(85).Wp_,Bj=i(85).LCr,Rj=i(85).Drs,Ej=i(85).JJj,Vj=i(85).I8n,Aj=i(85).MAy,Lj=i(85).P24,_j=i(85).wgE,Oj=i(85).Kiu,Fj=i(85).YGn,Nj=i(85).tBn,Gj=i(85).D7I,Hj=i(85).NF1,Wj=i(85).LlE,Kj=i(85).Au,zj=i(85).$Fm,Uj=i(85).Scd,$j=i(85).BQ6,Qj=i(85).T4J,qj=i(85).i7F,Xj=i(85).YNm,Yj=i(85).QmD,jj=i(85).P0R,Jj=i(85).UxW,eJ=i(85).HwH,tJ=i(85).wfR,iJ=i(85).v8Q;class oJ extends p.Z{constructor(){super(...arguments),this.storeTypes={[iJ]:v.default[tJ](!1)},this.renderDraggableInner=e=>{const{type:t,[eJ]:i,[Jj]:o}=this[jj],s="left"===t,r=o[Yj],l=i[Xj][Yj],d=this.isActiveStore[Yj];if(r)return c[Gj]("div",n()({[$j]:s?oJ.leftDraggableStyle:oJ.rightDraggableStyle,onMouseMove:this[qj],onMouseLeave:this[Qj]},e),d&&c[Gj](c[Nj],null,a()("div",{[$j]:s?this.getLeftDraggableIndicatorStyle():this.getRightDraggableIndicatorStyle()}),a()("span",{[$j]:s?this.getLeftDraggableLabelStyle():this.getRightDraggableLabelStyle()},void 0,a()("span",{[$j]:{[Uj]:this[jj][zj]?this[Kj].peekTimelineBackground:this[Kj].timelineBackground,[Wj]:4,[Hj]:4}},void 0,s?(0,te.yk)(r,l):(0,te.fc)(r,l)))))},this.handleLeftResizerDragStart=e=>{e[Fj]();const{type:t,store:i,[eJ]:o,query:s,[Oj]:r,intl:n}=this[jj];GE.startDrag({[eJ]:o,store:i,startX:e.startX,type:"left"===t?te.px.LeftResizer:te.px.RightResizer,query:s,[Oj]:r,intl:n,[_j]:this[_j]})},this.handleDraggableDragMove=e=>{const{[eJ]:t}=this[jj];GE.continueDrag({[eJ]:t,currentX:e.currentX})},this.handleDraggableDragEnd=()=>{const{[eJ]:e,query:t,[Oj]:i,intl:o,[Lj]:s,[Aj]:r,[Vj]:n,type:l}=this[jj];z[Ej]({[Rj]:"TimelineItemResizer.handleDraggableDragEnd",[_j]:this[_j],perform:s=>{GE.completeDrag({[eJ]:e,query:t,[Oj]:i,intl:o,[_j]:this[_j],[Bj]:s})}}),D.trackTimelineItemResize(this[_j],{...(0,te.Ii)({[_j]:this[_j],[Lj]:s,[eJ]:e,[Aj]:r,[Vj]:n}),type:l})},this.handleDraggableDragCancel=e=>{const{[eJ]:t}=this[jj];GE.cancelDrag({[eJ]:t,[_j]:this[_j]})},this[qj]=()=>{this[Mj][iJ][Zj](!0)},this[Qj]=()=>{this[Mj][iJ][Zj](!1)},this.isActiveStore=this[Dj]((()=>{const{store:e,type:t,[eJ]:i}=this[jj],o=this[Mj][iJ][Yj],s=i[Pj][Yj];return s?s[Mj][0]===e&&("left"===t?s.type===te.px.LeftResizer:s.type===te.px.RightResizer):o&&!Te.Z[Yj]}))}renderComponent(){return a()(ZT.Z,{render:this.renderDraggableInner,onDraggableDragStart:this.handleLeftResizerDragStart,onDraggableDragMove:this.handleDraggableDragMove,onDraggableDragEnd:this.handleDraggableDragEnd,[Ij]:this.handleDraggableDragCancel})}getLeftDraggableIndicatorStyle(){return{[xj]:Tj,left:Math.ceil(3.5)+1,top:6,[Hj]:3,width:3,bottom:6,[Uj]:this[Kj][Cj]}}getRightDraggableIndicatorStyle(){return{[xj]:Tj,left:Math.floor(.5),top:6,[Hj]:3,width:3,bottom:6,[Uj]:this[Kj][Cj]}}getLeftDraggableLabelStyle(){return{fontSize:12,[xj]:Tj,right:12,textAlign:"right",width:200,lineHeight:"32px",[kj]:"none"}}getRightDraggableLabelStyle(){return{fontSize:12,[xj]:Tj,left:12,width:200,lineHeight:"32px",[kj]:"none"}}}oJ.displayName="TimelineItemResizer",oJ.leftDraggableStyle={[xj]:Tj,top:0,left:-6,width:8,height:"100%",zIndex:1,cursor:"col-resize"},oJ.rightDraggableStyle={[xj]:Tj,top:0,right:-6,width:8,height:"100%",zIndex:1,cursor:"col-resize"};const sJ=oJ,rJ=i(85).gGi,nJ=i(85).lWm,lJ=i(85).NF1,aJ=i(85)._tz,dJ=i(85).MHP,hJ=i(85).XuB,cJ=i(85).EHj,uJ=i(85).Yzm,pJ=i(85).NLk,mJ=i(85).Au,gJ=i(85).ewQ,vJ=i(85).rI1,fJ=i(85).XNW,yJ=i(85).ChN,wJ=i(85).PXg,SJ=i(85).EMU,bJ=i(85).sM5,kJ=i(85).D7I,CJ=i(85).rJs,TJ=i(85).LWT,xJ=i(85)._mQ,IJ=i(85).D03,PJ=i(85).bSA,DJ=i(85).lGm,MJ=i(85).p6m,ZJ=i(85).$Fm,BJ=i(85).sI1,RJ=i(85).kId,EJ=i(85).phM,VJ=i(85).cx2,AJ=i(85).Lv6,LJ=i(85).aKz,_J=i(85).I8n,OJ=i(85).MAy,FJ=i(85).l5C,NJ=i(85).UxW,GJ=i(85).hCp,HJ=i(85).bqt,WJ=i(85).voC,KJ=i(85).O1p,zJ=i(85).EEt,UJ=i(85).M34,$J=i(85).XQm,QJ=i(85).DWf,qJ=i(85).tDk,XJ=i(85).LIR,YJ=i(85).XqV,jJ=i(85).EIp,JJ=i(85).zdT,e5=i(85).FiA,t5=i(85).tLG,i5=i(85).BQ6,o5=i(85).fBv,s5=i(85).QKL,r5=i(85).uM3,n5=i(85).kpr,l5=i(85).Wp_,a5=i(85).E0z,d5=i(85).LCr,h5=i(85).Drs,c5=i(85).JJj,u5=i(85).wgE,p5=i(85).W0d,m5=i(85).QmD,g5=i(85).Kiu,v5=i(85).VMs,f5=i(85).HwH,y5=i(85).YGn,w5=i(85).oWD,S5=i(85).ffk,b5=i(85).P24,k5=i(85).qU4,C5=i(85).Aw$,T5=i(85).Dg8,x5=i(85).NRr,I5=i(85).P0R,P5=i(85).$pZ,D5=i(85).pkR,M5=i(85).XtO,Z5=i(85).$Jh,B5=i(85).Dv6,R5=i(85).nx5,E5=(0,P.defineMessages)({typeAName:{[R5]:"Type a name…",id:"timelineItem.itemName.placeholder"}});var V5;!function(e){e[e.Absolute=0]="Absolute",e[e.Sticky=1]="Sticky"}(V5||(V5={}));class A5 extends p.Z{constructor(){super(...arguments),this.propertiesWrapEl=c[B5](),this[Z5]=(e,t)=>{const{showProperties:i,[M5]:o,[D5]:s,[P5]:r,clonedStore:n}=this[I5],l=t===i.length-1,d=null==o?void 0:o[x5]();if(d){if("title"===e)return this[T5](l);if(o&&n)return a()(Do.Z,{[M5]:n,[S5]:e,[D5]:s||!o[C5](),locked:!1,format:Mo.C.Timeline,tableWrap:!1,isLast:l,[P5]:r,enablePointerEventsForInteractiveTypes:!0,[w5]:d,[k5]:this[I5][b5][k5]()},e)}},this.handleSelectableDragStart=e=>{e[y5]()},this.handleSelectableDragMove=e=>{const{[M5]:t,[f5]:i,[v5]:o,[g5]:s,intl:r}=this[I5];t&&(i[p5][m5]||GE.startDrag({[f5]:i,[M5]:t,startX:e.startX,type:te.px.ItemDrag,[v5]:o,[g5]:s,intl:r,[u5]:this[u5]}),GE.continueDrag({[f5]:i,currentX:e.currentX}))},this.handleSelectableDragEnd=()=>{const{[f5]:e,[v5]:t,[g5]:i,intl:o}=this[I5];z[c5]({[h5]:"TimelineItemDateRange.handleSelectableDragEnd",[u5]:this[u5],perform:s=>{GE.completeDrag({[f5]:e,[v5]:t,[g5]:i,intl:o,[u5]:this[u5],[d5]:s})}})},this.handleSelectableDragCancel=()=>{const{[f5]:e}=this[I5];GE.cancelDrag({[f5]:e,[u5]:this[u5]})},this.handleDateRangeButtonMouseMove=()=>{const{[M5]:e,[f5]:t}=this[I5],i=t[p5][m5];(Te.Z[m5]||i)&&!this.isDrawingDependencyStore[m5]||this[u5][a5].isPhone||t.hoveredItem[l5](e)},this.handleDateRangeButtonMouseLeave=()=>{const{[f5]:e}=this[I5],t=e[p5][m5];(Te.Z[m5]||t)&&!this.isDrawingDependencyStore[m5]||e.hoveredItem[l5](void 0)},this.handleGetGhostElement=e=>{const t=TT.C[n5](e),i=h()[r5](t.map((e=>e.getNode()))),o=h()[r5](i.map((e=>e.closest(`.${X.timelineItemRow}`))))[0];if(o){const e=cj.eN(o),t=e.cloned[s5](`.${X.timelineItemDateRange}`),i=e.cloned[s5](`.${X.timelineItemProperties}`);return t&&i&&"sticky"===i[i5][o5]&&(i[i5][o5]=t5,i[i5].left=t[i5].left),[e]}return i.map(cj.eN)},this.handleTextEnterOrEsc=()=>{const{[M5]:e}=this[I5];e&&W.select({[u5]:this[u5],[M5]:e})},this[e5]=()=>{const{current:e}=this.propertiesWrapEl,t=this[JJ][m5];e&&t&&(e[i5][o5]=t[o5]===V5.Absolute?t5:"sticky",e[i5].left=`${t.left}px`)},this.pageURLStore=this[jJ]((()=>{const{[M5]:e}=this[I5];if(e)return(0,se.ZP)({[M5]:e,[YJ]:!1,[XJ]:f.tY.LinkInPage})})),this.peekURLStore=this[jJ]((()=>{const{[M5]:e,[b5]:t}=this[I5],{[qJ]:i}=ge.default[m5];if(e&&i)return ie.getPeekModeHref({[M5]:e,[qJ]:i,[b5]:t,[YJ]:!1})})),this.isHoveredStore=this[jJ]((()=>{const{[M5]:e,[f5]:t}=this[I5];return t.hoveredItem[m5]===e})),this.isDrawingDependencyStore=this[jJ]((()=>{const{[M5]:e,[f5]:t}=this[I5],i=t[QJ][m5];return i&&i.startStore!==e})),this.editingTitleStore=this[jJ]((()=>{var e;const{[M5]:t}=this[I5],i=Oi.default[m5];if("editing"!==i.mode)return!1;const o=null===(e=(0,Ei.QY)(i[$J]))||void 0===e?void 0:e[M5];return t&&o&&o===t[UJ]()})),this[JJ]=this[jJ]((()=>{const{[f5]:e,scrollerLeftOffset:t,[zJ]:i}=this[I5],o=i[m5];if(o){const{left:i,right:s}=o,r=s-i;if(!(this.canPerformantlyUpdateOnScroll()&&r>50))return{[o5]:V5.Absolute,left:i};{const o=e[KJ][m5];if(void 0!==o){const e=o+t-i+21;if(e<0)return{[o5]:V5.Absolute,left:i};if(e>r)return{[o5]:V5.Absolute,left:s};if(e>0)return{[o5]:V5.Sticky,left:t+21}}}}})),this.passesFilterStore=this[jJ]((()=>{var e,t;const i=(0,Y.m1)({[b5]:this[I5][b5],[u5]:this[u5]}),o=null===(e=this[I5][M5])||void 0===e?void 0:e.getModel(),s=null===(t=this[I5][M5])||void 0===t?void 0:t[WJ];if(!i||!o||!s)return!0;return(0,jn.q)(i)({block:o,[WJ]:s,[HJ]:void 0})})),this[GJ]=this[jJ]((()=>!!this[I5][M5]&&ie[GJ](this[I5][M5])))}didMount(){super.didMount(),this[JJ].addListener(this[e5]),this[e5]()}willUnmount(){super.willUnmount(),this[JJ].removeListener(this[e5])}willUpdate(){this[JJ].enqueueRecompute()}renderComponent(){const{[zJ]:e,[M5]:t,[f5]:i,[v5]:o,[g5]:s,[NJ]:r,[D5]:n,[FJ]:l,[b5]:d,[OJ]:h,[_J]:u,intl:p}=this[I5],m=e[m5];if(!m)return;const g=(0,te.H5)(d),{left:v,right:f,maskPercent:y}=m,w=this.isHoveredStore[m5],S=this.pageURLStore[m5],b=this.peekURLStore[m5],k=!n&&(null==t?void 0:t[C5]()),C=this[u5][a5].isPhone,T=k&&!C&&(g||d.permissionScopes[m5].canConfigureBlock),x=d[LJ][m5]?42:10,I=Math.max(f-v,x)+1,P=l[m5],D=this[AJ](),M=this.passesFilterStore[m5];return t&&!m.isPlaceholder?c[kJ](c.Fragment,null,a()(rl.Z,{[i5]:this[VJ](v,I,P,m,M),haloStyle:this.getHaloStyle(),[DJ]:X.timelineItemDateRange,[M5]:t,canSelect:!0,shouldShowHalo:!0,shouldForceRenderSelectionHalo:this[GJ][m5],canDrag:k,[PJ]:EJ,[IJ]:this.handleSelectableDragStart,onDraggableDragMove:this.handleSelectableDragMove,[xJ]:this.handleSelectableDragEnd,[TJ]:this.handleSelectableDragCancel,canTriggerContextMenu:k,getGhostElement:this.handleGetGhostElement,disableScrollToReveal:!0,onMouseMove:this.handleDateRangeButtonMouseMove,onMouseLeave:this.handleDateRangeButtonMouseLeave,showBlockMenuInput:!0},void 0,D,a()(Eo.Z,{[i5]:this.getLinkBoxStyle(),[BJ]:this.getLinkBoxInnerStyle(),onClick:this[I5][RJ],href:S,metaHref:b,hovered:w,ignoreLocalHoverState:!0}),T&&this.renderTimelineItemDependencyDrawHandle(),k&&!C&&a()(sJ,{type:"left",[M5]:t,[v5]:o,[g5]:s,[f5]:i,[NJ]:r,[b5]:d,[OJ]:h,[ZJ]:this[I5][ZJ],[_J]:u,intl:p,[MJ]:this[I5][MJ]}),k&&!C&&a()(sJ,{type:"right",[M5]:t,[v5]:o,[g5]:s,[f5]:i,[NJ]:r,[b5]:d,[OJ]:h,[ZJ]:this[I5][ZJ],[_J]:u,intl:p,[MJ]:this[I5][MJ]})),this[CJ](y,P,M)):c[kJ](c.Fragment,null,a()("div",{[i5]:this[VJ](v,I,P,m,M),[DJ]:X.timelineItemDateRange}),this[CJ](y,P,M))}[AJ](){const{[b5]:e,toggleButton:t,[zJ]:i}=this[I5],o=e[LJ][m5],s=i[m5];if(o&&t&&(null==s||!s.isExistingSubitemPlaceholder))return a()("span",{[i5]:{zIndex:1,paddingTop:3}},void 0,t)}renderTimelineItemDependencyDrawHandle(){const{[M5]:e,[OJ]:t,[_J]:i}=this[I5];if(e)return a()(bj,{[M5]:e,[g5]:this[I5][g5],[f5]:this[I5][f5],[NJ]:this[I5][NJ],[b5]:this[I5][b5],[OJ]:t,[_J]:i})}[CJ](e,t,i){const{showProperties:o}=this[I5];return a()("div",{[i5]:this.getPropertiesWrapStyle(e,t,i)},void 0,c[kJ]("div",{[i5]:this.getPropertiesWrapInnerStyle(),ref:this.propertiesWrapEl,[DJ]:X.timelineItemProperties},o.map(this[Z5])))}[T5](e){var t;const{[M5]:i}=this[I5],o=i?i.getIcon():void 0,s=null==i?void 0:i.hasError(),r=!i||i.isEmptyPage(),n=this.editingTitleStore[m5],{parentStore:l,[b5]:d}=this[I5],c=d[LJ][m5],u=c&&l?null===(t=l.getSchema()[c[S5]])||void 0===t?void 0:t.name:"";return a()("div",{[i5]:{[bJ]:SJ,[wJ]:e?0:10,fontSize:14,[yJ]:x.Z[yJ].medium,alignItems:"center"}},"title",o&&!s&&a()(Vo.Z,{[D5]:!0,icon:o,isEmptyPage:r,size:20,[i5]:{[fJ]:2,[wJ]:6}}),s&&S.Z.warning({[bJ]:"inline-block",[vJ]:"text-top",[fJ]:4,[wJ]:7,width:16,fill:this[mJ][gJ].orange[500]}),i&&!n&&a()(BT.Z,{[i5]:{[pJ]:"nowrap",maxWidth:400},[M5]:i}),n&&i&&a()(Lo.Z,{[M5]:i[UJ](),[i5]:{[pJ]:this[u5][a5].isFirefox?"pre":"nowrap"},[D5]:!1,[cJ]:!0,[hJ]:!0,[dJ]:!0,disableEmbedMenu:!0,onEnter:this.handleTextEnterOrEsc,onEsc:this.handleTextEnterOrEsc,onTab:h().identity,placeholder:ne.default[uJ](E5.typeAName),disableSelectAllBlocks:!0,pasteBehavior:"inline"}),!i&&a()("span",{},void 0,a()(P.FormattedMessage,l&&u?{[R5]:"New page in {propertyName}",id:"timeline.itemPlaceholder.nest.addSubitemWithPropertyName",values:{[aJ]:u}}:{id:"timeline.itemPlaceholder.newPage",[R5]:"New page"})))}canPerformantlyUpdateOnScroll(){return(0,te.Tp)(this[u5])}[VJ](e,t,i,o,s){const r=this[mJ].mode;return{[o5]:t5,left:e,marginTop:1,marginBottom:1,width:t,height:30,[lJ]:4,[bJ]:SJ,...o.isExistingSubitemPlaceholder?void 0:{..."light"===r?{background:o.isPlaceholder?this[mJ][nJ]:this[mJ].contentBackground,boxShadow:o.isPlaceholder?void 0:this[mJ].buttonBoxShadow}:{background:this[I5][ZJ]?this[mJ].calendarItemBackground:this[mJ].popoverBackground,boxShadow:o.isPlaceholder?void 0:this[mJ].lightBoxShadow}},...o.isPlaceholder&&{cursor:"crosshair"},...i&&{[bJ]:"none"},...!s&&{opacity:.5},zIndex:I.timelineItemDateRange}}getPropertiesWrapStyle(e,t,i){return{width:rJ,WebkitMaskImage:e<1&&this.isHoveredStore[m5]?`linear-gradient(90deg, rgba(0,0,0,1) ${100*e}%, rgba(0,0,0,0.4) ${100*e}%)`:void 0,pointerEvents:"none",...t&&{[bJ]:"none"},zIndex:I.timelineItemDateRange,opacity:i?1:.5}}getPropertiesWrapInnerStyle(){const{[b5]:e,toggleButton:t}=this[I5],i=e[LJ][m5];return{[bJ]:SJ,height:31,paddingLeft:i&&t?24:6,width:800,overflow:"hidden"}}getHaloStyle(){return{[lJ]:4,...ie.getHighlightHaloStyle(this[GJ][m5],this[mJ])}}getLinkBoxStyle(){return{width:rJ,height:rJ,[lJ]:4}}getLinkBoxInnerStyle(){return{width:rJ,height:rJ,[bJ]:SJ,paddingLeft:6,paddingRight:6,[lJ]:4}}}A5.displayName="TimelineItemDateRange";const L5=A5,_5=i(85).D7I,O5=i(85).GmX,F5=i(85).Au,N5=i(85).zrY,G5=i(85).$Fm,H5=i(85).ncO,W5=i(85).C_5,K5=i(85).O1p,z5=i(85).l5C,U5=i(85).EEt,$5=i(85).EIp,Q5=i(85).E0z,q5=i(85).E6w,X5=i(85).UIj,Y5=i(85).Wp_,j5=i(85).q9x,J5=i(85).wgE,e8=i(85).T9w,t8=i(85).YNm,i8=i(85).P0R,o8=i(85).I8n,s8=i(85).MAy,r8=i(85).P24,n8=i(85).YDv,l8=i(85).UxW,a8=i(85).HwH,d8=i(85).b8T,h8=i(85).p1r,c8=i(85).qc1,u8=i(85).RvT,p8=i(85).BQ6,m8=i(85).$_k,g8=i(85).QmD,v8=i(85).iDK,f8=i(85).XQ0,y8=i(85).yUP,w8=i(85).AGn,S8=i(85).Dv6;var b8;!function(e){e[e.Hidden=0]="Hidden",e[e.VisibleInItem=1]="VisibleInItem",e[e.VisibleOutOfItem=2]="VisibleOutOfItem",e[e.NotDefined=3]="NotDefined"}(b8||(b8={}));class k8 extends p.Z{constructor(){super(...arguments),this.lastVisibilityState=b8.NotDefined,this.buttonRef=c[S8](),this.wrapRef=c[S8](),this[w8]=v.default[y8](!1),this[f8]=()=>{const e=this.buttonRef[v8],t=this.wrapRef[v8];if(e&&t){const i=this[m8][g8],o=i===b8.VisibleInItem||i===b8.VisibleOutOfItem;e[p8].opacity=""+(o?1:0),e[p8][u8]=`scale(${o?1:.3})`,t[p8][c8]=i===b8.VisibleOutOfItem?"":"none";this.lastVisibilityState!==b8.NotDefined&&i!==b8.NotDefined&&!e[p8][h8]&&(e[p8][h8]="transform 160ms ease-in-out, opacity 160ms ease-in-out"),this.lastVisibilityState=i}},this[d8]=()=>{const{store:e,type:t,[a8]:i,[l8]:o,[n8]:s,format:r,[r8]:n,[s8]:l,[o8]:a}=this[i8],d=o[g8],h=i[t8][g8],{snapUnit:c}=te.BJ[h],u=(0,te.x2)(h,200);if(d)if("left"===t){const{start:e}=(0,te.XO)(d,c),t=(0,te.GK)({[e8]:e.valueOf(),[J5]:this[J5],[a8]:i,[n8]:s,format:r})-u;GE.resetWindow({[a8]:i,[J5]:this[J5],[t8]:h,[j5]:t})}else{const{end:e}=(0,te.XO)(d,c),t=(0,te.PF)({[e8]:e.valueOf(),[a8]:i})+u;GE.resetWindow({[a8]:i,[J5]:this[J5],[t8]:h,[j5]:t})}this[w8][Y5](!1),W.select({[J5]:this[J5],store:e}),D.trackTimelineItemScrollArrowClick(this[J5],{...(0,te.Ii)({[J5]:this[J5],[r8]:n,[a8]:i,[s8]:l,[o8]:a}),type:t})},this[X5]=()=>{this[J5][Q5][q5]||Te.Z[g8]||this[w8][Y5](!0)},this.handleMouseOut=()=>{this[J5][Q5][q5]||this[w8][Y5](!1)},this[m8]=this[$5]((()=>{const{type:e,[a8]:t,scrollerLeftOffset:i,[U5]:o,[z5]:s}=this[i8],r=o[g8];if(r){const{left:o,right:n}=r;if(s[g8])return b8.Hidden;const l=t[K5][g8];if(void 0!==l){if("left"===e){const e=l+i;if(e-n>0)return b8.VisibleOutOfItem;if(e-o>0)return b8.VisibleInItem}else{const{[W5]:e}=t,i=l+e.rect[g8].width;if(o-i>0)return b8.VisibleOutOfItem;if(n-i>0)return b8.VisibleInItem}return b8.Hidden}}return b8.NotDefined}))}didMount(){super.didMount(),this[m8].addListener(this[f8]),this[f8]()}willUnmount(){super.willUnmount(),this[m8].removeListener(this[f8])}willUpdate(){this[m8].enqueueRecompute()}renderComponent(){const{type:e}=this[i8],t=this[w8][g8],i="left"===e?S.Z.collectionTimelineArrowLeft:S.Z.collectionTimelineArrowRight;return c[_5]("div",{[p8]:this[H5](),onMouseOver:this[X5],onMouseOut:this.handleMouseOut,onMouseDown:re.$0,onClick:this[d8],ref:this.wrapRef},c[_5]("div",{[p8]:this.getArrowStyle(),ref:this.buttonRef},i({height:6,fill:this[i8][G5]?this[F5][N5]:this[F5][O5]})),t&&this.renderDateRange())}renderDateRange(){const{[l8]:e,[a8]:t}=this[i8],i=e[g8];if(!i)return;const o=t[t8][g8];return a()("span",{[p8]:this.getDateRangeStyle()},void 0,(0,te._Q)(i,o))}[H5](){const{type:e,scrollerLeftOffset:t,[a8]:i}=this[i8],{[W5]:o}=i;return{position:"sticky",left:"left"===e?t:o.rect[g8].width-220,width:220,height:OX-6,marginTop:2,display:"flex",alignItems:"center",cursor:"pointer",flexDirection:"right"===e?"row-reverse":void 0,whiteSpace:"nowrap",textOverflow:"ellipsis",zIndex:I.timelineItemScrollArrow}}getArrowStyle(){const{type:e}=this[i8],t=this[w8][g8];return{display:"flex",alignItems:"center",width:16,height:16,flexShrink:0,[c8]:"auto",background:t?this[F5].regularIconColor:this[F5].mediumIconColor,borderRadius:3,border:`1px solid ${this[F5][O5]}`,..."left"===e&&{marginLeft:8,marginRight:4},..."right"===e&&{marginRight:8,marginLeft:4}}}getDateRangeStyle(){return{fontSize:12,[n8]:4,paddingRight:4,borderRadius:4,background:this[i8][G5]?this[F5].peekTimelineBackground:this[F5].timelineBackground,[c8]:"none"}}}k8.displayName="TimelineScrollArrow";const C8=k8,T8=i(85).dMt,x8=i(85).D7I,I8=i(85).kId,P8=i(85).Nbg,D8=i(85).cx2,M8=i(85).p6m,Z8=i(85).$Fm,B8=i(85).I8n,R8=i(85).MAy,E8=i(85).$pZ,V8=i(85).YDv,A8=i(85).NRr,L8=i(85).qnp,_8=i(85).fbO,O8=i(85).l5C,F8=i(85).Trf,N8=i(85).IqQ,G8=i(85).SUZ,H8=i(85).s4U,W8=i(85).UxW,K8=i(85).EIp,z8=i(85).Gnd,U8=i(85).LIR,$8=i(85).ixe,Q8=i(85).qU4,q8=i(85).irQ,X8=i(85).iDK,Y8=i(85).EEt,j8=i(85).LCr,J8=i(85).Drs,e0=i(85).JJj,t0=i(85).BpM,i0=i(85).KNN,o0=i(85).P24,s0=i(85).b8T,r0=i(85).T4J,n0=i(85).WbK,l0=i(85).fBu,a0=i(85).WwI,d0=i(85).Wp_,h0=i(85).Qe6,c0=i(85).oki,u0=i(85).Omf,p0=i(85)._9,m0=i(85).nKX,g0=i(85).YNm,v0=i(85).O1p,f0=i(85).kMZ,y0=i(85).DWf,w0=i(85).W0d,S0=i(85).QmD,b0=i(85).P0R,k0=i(85).Kiu,C0=i(85).VMs,T0=i(85).pkR,x0=i(85).xd5,I0=i(85).XtO,P0=i(85).HwH,D0=i(85).i7F,M0=i(85).Lg4,Z0=i(85).c_3,B0=i(85).YGn,R0=i(85).iPt,E0=i(85).Gm5,V0=i(85).wgE,A0=i(85).pc0,L0=i(85).wfR,_0=i(85).Dv6;class O0 extends p.Z{constructor(){super(...arguments),this.clonedStore=void 0,this.dateRangeRef=c[_0](),this.storeTypes={node:v.default[L0](null)},this[A0]=e=>{this[V0].device.isMobile||(0,re.ZP)({event:e,[E0]:re.Af.EditorMouseDown,[R0]:()=>{e[B0](),F[Z0]({[V0]:this[V0],target:e.target,startX:e.clientX,startY:e.clientY,showSelectionRect:!0,preventSelectStores:[],allowVerticalEdgeScroll:!0,[M0]:!0})}})},this[D0]=e=>{const{[P0]:t,[I0]:i,[x0]:o,[T0]:s,[C0]:r,[k0]:n}=this[b0],l=t[w0][S0],a=t[y0][S0],{[f0]:d}=t,h=t[v0][S0],c=t[g0][S0],u=t[m0][S0],{snapUnit:p,[p0]:m}=te.BJ[c];if(!a&&Te.Z[S0]||l||this.getPersistedDateValue()||!d||void 0===h||s)return;const g=d[u0](),v=h+(e.clientX-g.left),f=(0,te.x2)(c,v),y=DT.ou[c0](u.startTimestamp+f),w=(0,te.DS)(y,p),S=(0,te.DS)(m(y),p),b=(0,kT.date)(w.valueOf(),(0,Qe.r)()),k=(0,te.AZ)({[h0]:b,snapUnit:p,desiredStart:w,desiredEnd:S});t[a0][d0]({active:!0,[I0]:i,[l0]:this.parentCollectionStore[S0],[x0]:o,date:k,[n0]:void 0,existingTimelineItemProps:{[C0]:r,[k0]:n}})},this[r0]=()=>{const{[P0]:e}=this[b0];e[a0][d0]({active:!1})},this[s0]=e=>{const{[I0]:t,[C0]:i,[k0]:o,[P0]:s,[x0]:r,[o0]:n}=this[b0],l=s[a0][S0],a=n[t0][i0](r);if(a)if(l.active){const{date:e}=l;z[e0]({[J8]:"CollectionTimelineViewItem.handleClick",[V0]:this[V0],perform:s=>{GE.setItemDateValue({[V0]:this[V0],[I0]:t,[C0]:i,[k0]:o,date:e,[j8]:s})}}),s[a0][d0]({active:!1})}else{const{[P0]:i,[o0]:o}=this[b0],{[f0]:s}=i,r=i[v0][S0],n=this[Y8][S0],l=this.dateRangeRef[X8];if(!s||void 0===r||!n||!l)return;const d=s[u0](),h=r+(e.clientX-d.left),c=l.propertiesWrapEl[X8];if(!c)return;const u=c.lastElementChild;if(!u)return;const p=r+(u[u0]().right-d.left);h>n.right&&h<=p&&(0,re.ZP)({event,[E0]:re.Af.EditorClick,[R0]:()=>{(0,ae.mouseDidMoveAfterLastMouseDown)()||N.peekBlock({[V0]:this[V0],[I0]:t,openInNew:oe[q8](e),peekMode:(0,ie.getPeekMode)(o[Q8]()),[$8]:a[$8],[o0]:o,[U8]:f.tY.PeekOpen})}})}},this.onRefChange=e=>{this[z8].node[d0](e)},this[Y8]=this[K8]((()=>{const{[P0]:e}=this[b0];return(0,te.HZ)({[P0]:e,dateValue:this[W8][S0],placeholderDate:this[H8][S0],subitemPlaceholderDate:this[G8][S0]})})),this[N8]=this[K8]((()=>{const e=this[Y8][S0];return Boolean(e)})),this.shouldRenderScrollArrowsStore=this[K8]((()=>{const e=this[Y8][S0];return Boolean(e&&!e.isPlaceholder)})),this[G8]=this[K8]((()=>{const{subitemPath:e}=this[b0],t=(0,el.ub)(e);if(!t||Boolean(this[W8][S0]))return;const i=t.value[I0],o=YE[F8](i);if(o.length>0){return o[0][W8][S0]}})),this[H8]=this[K8]((()=>{const{[I0]:e,[P0]:t,[x0]:i}=this[b0],o=t[a0][S0];if(o.active&&o[I0]===e&&!o[n0]&&(0,_e.ZH)(o[x0],i))return o.date})),this[W8]=this[K8]((()=>{const{[I0]:e,[P0]:t}=this[b0],i=t[w0][S0],o=this[H8][S0];if(o)return o;if(i){const t=i[z8].indexOf(e);if(t>=0)return i.temporaryValues[t]}return this.getPersistedDateValue()}),!0),this[O8]=this[K8]((()=>{const{[I0]:e,[P0]:t}=this[b0],i=t[w0][S0],o=JE.ZP[S0];return Boolean(i&&i[z8][_8](e)&&o[L8]&&o.draggedStores[_8](e))})),this.parentCollectionStore=this[K8]((()=>this[b0][I0][A8]()))}get registries(){return[YE]}willMount(e){super.willMount(e),this.clonedStore=e[I0].clone()}renderComponent(){var e;const{[I0]:t,[P0]:i,scrollerLeftOffset:o,[V8]:s,format:r,[C0]:n,[k0]:l,[E8]:d,[T0]:h,showProperties:u,showTable:p,[o0]:m,[R8]:g,[B8]:v,toggleButton:f,[x0]:y}=this[b0],w=this[N8][S0],S=this.shouldRenderScrollArrowsStore[S0],b=Boolean(this[H8][S0])||Boolean(this[G8][S0]),k=null===(e=m[t0][i0](y))||void 0===e?void 0:e.reducerResultStore;if(k)return c[x8](c.Fragment,null,a()("div",{style:{display:"flex",height:0}},void 0,S&&a()(C8,{[I0]:t,type:"left",[P0]:i,scrollerLeftOffset:o,[Y8]:this[Y8],[W8]:this[W8],[V8]:s,format:r,[O8]:this[O8],[o0]:m,[R8]:g,[Z8]:this[b0][Z8],[B8]:v,[M8]:k}),S&&a()(C8,{[I0]:t,type:"right",[P0]:i,scrollerLeftOffset:o,[Y8]:this[Y8],[W8]:this[W8],[V8]:s,format:r,[O8]:this[O8],[o0]:m,[Z8]:this[b0][Z8],[R8]:g,[B8]:v,[M8]:k})),c[x8]("div",{style:this[D8](b,p),onMouseDown:this[A0],onMouseMove:this[D0],onMouseLeave:this[r0],onClick:this[s0],className:X.timelineItemRow,ref:this.onRefChange},w&&c[x8](L5,{[I0]:t,[l0]:this.parentCollectionStore[S0],toggleButton:f,clonedStore:this.clonedStore,[Y8]:this[Y8],[W8]:this[W8],[C0]:n,[k0]:l,[P0]:i,[E8]:d,[T0]:h,showProperties:u,scrollerLeftOffset:o,[O8]:this[O8],[o0]:m,[R8]:g,[Z8]:this[b0][Z8],[B8]:v,intl:ne.default[P8](),ref:this.dateRangeRef,[M8]:k,[I8]:this[b0][I8]})))}getPersistedDateValue(){const{[I0]:e,[C0]:t,[k0]:i}=this[b0];return(0,te.bk)({[I0]:e,[C0]:t,[k0]:i,userId:this[V0].currentUser.id,intl:ne.default[P8]()})}[D8](e,t){return{display:"flex",height:zE+(e?2:1),width:"100%",...e&&{borderTop:`1px solid ${this.theme[T8]}`,marginBottom:-1},...e&&!t&&{borderBottom:`1px solid ${this.theme[T8]}`},cursor:"default"}}}O0.displayName="CollectionTimelineViewItem";const F0=O0,N0=i(85).dMt,G0=i(85).nx5,H0=i(85)._tz,W0=(i(85).wH1,i(85).wuN),K0=i(85).aKz,z0=i(85).kId,U0=i(85).p6m,$0=i(85).$Fm,Q0=i(85).cx2,q0=i(85).Ylz,X0=i(85).I8n,Y0=i(85).$pZ,j0=i(85).l5C,J0=i(85).IqQ,e1=i(85).s4U,t1=i(85).UxW,i1=i(85).EIp,o1=i(85).EEt,s1=i(85).cJo,r1=i(85).LCr,n1=i(85).Drs,l1=i(85).JJj,a1=i(85).H4r,d1=i(85).jV9,h1=i(85).b8T,c1=i(85).T4J,u1=i(85).WbK,p1=i(85).WwI,m1=i(85).Wp_,g1=i(85).Qe6,v1=i(85).oki,f1=i(85).Omf,y1=i(85).ixe,w1=i(85).BpM,S1=i(85).KNN,b1=i(85)._9,k1=i(85).nKX,C1=i(85).YNm,T1=i(85).O1p,x1=i(85).kMZ,I1=i(85).W0d,P1=i(85).DWf,D1=i(85).QmD,M1=i(85).P0R,Z1=i(85).P24,B1=i(85).MAy,R1=i(85).Kiu,E1=i(85).pkR,V1=i(85).xd5,A1=i(85).fBu,L1=i(85).XtO,_1=i(85).HwH,O1=i(85).i7F,F1=i(85).Lg4,N1=i(85).c_3,G1=i(85).YGn,H1=i(85).wgE,W1=i(85).pc0;class K1 extends p.Z{constructor(){super(...arguments),this.clonedStore=void 0,this[W1]=e=>{this[H1].device.isMobile||(0,re.ZP)({event:e,context:re.Af.EditorMouseDown,callback:()=>{e[G1](),F[N1]({[H1]:this[H1],target:e.target,startX:e.clientX,startY:e.clientY,showSelectionRect:!0,preventSelectStores:[],allowVerticalEdgeScroll:!0,[F1]:!0})}})},this[O1]=e=>{var t;const{[_1]:i,[L1]:o,[A1]:s,[V1]:r,[E1]:n,query:l,[R1]:a,[B1]:d,canEditTimelineItems:h,subitemPath:c,[Z1]:u}=this[M1],p=i[P1][D1],m=i[I1][D1],{[x1]:g}=i,v=i[T1][D1],f=i[C1][D1],y=i[k1][D1],{snapUnit:w,[b1]:S}=te.BJ[f];if(!p&&Te.Z[D1]||m||!g||void 0===v||n)return;const b=null===(t=u[w1][S1](r))||void 0===t?void 0:t[y1];if(!b)return;const k=g[f1](),C=v+(e.clientX-k.left),T=(0,te.x2)(f,C),x=DT.ou[v1](y.startTimestamp+T),I=(0,te.DS)(x,w),P=(0,te.DS)(S(x),w),D=(0,kT.date)(I.valueOf(),(0,Qe.r)()),M=(0,te.AZ)({[g1]:D,snapUnit:w,desiredStart:I,desiredEnd:P});i[p1][m1]({active:!0,[L1]:o,[A1]:s,[V1]:r,date:M,[u1]:{query:l,[R1]:a,[y1]:b,[B1]:d,canEditTimelineItems:h,subitemPath:c},existingTimelineItemProps:void 0})},this[c1]=()=>{const{[_1]:e}=this[M1];e[p1][m1]({active:!1})},this[h1]=e=>{var t;const{[A1]:i,query:o,[R1]:s,[_1]:r,[B1]:n,[V1]:l,canEditTimelineItems:a,[Z1]:d,subitemPath:h}=this[M1],c=r[p1][D1],u=null===(t=d[w1][S1](l))||void 0===t?void 0:t[y1];if(u&&c.active){const{date:e}=c,t=h?d1:a1;z[l1]({[n1]:"CollectionTimelineViewItem.handleClick",[H1]:this[H1],perform:r=>{GE.createNewTimelineItem({[H1]:this[H1],[r1]:r,date:e,[L1]:this[M1][L1],[A1]:i,query:o,[R1]:s,[y1]:u,[B1]:n,[V1]:l,canEditTimelineItems:a,[Z1]:d,subitemPath:h,from:t}),D[s1](this[H1],{from:t,type:"page",...(0,J.getCollectionAnalyticsContext)(d)})}}),r[p1][m1]({active:!1})}},this[o1]=this[i1]((()=>{const{[_1]:e}=this[M1];return(0,te.HZ)({[_1]:e,dateValue:this[t1][D1],placeholderDate:this[e1][D1],subitemPlaceholderDate:void 0})})),this[J0]=this[i1]((()=>{const e=this[o1][D1];return Boolean(e)})),this[j0]=this[i1]((()=>!1)),this[e1]=this[i1]((()=>{const{[L1]:e,[A1]:t,[_1]:i,[V1]:o}=this[M1],s=i[p1][D1];if(s.active&&s[L1]===e&&s[u1]&&s[A1]===t&&(0,_e.ZH)(s[V1],o))return s.date})),this[t1]=this[i1]((()=>{const e=this[e1][D1];if(e)return e}),!0)}willMount(e){super.willMount(e),e[L1]&&(this.clonedStore=e[L1].clone())}renderComponent(){var e;const{[L1]:t,[A1]:i,[_1]:o,scrollerLeftOffset:s,query:r,[R1]:n,[Y0]:l,[E1]:d,showProperties:h,showTable:u,[Z1]:p,[B1]:m,[X0]:g,toggleButton:v,[V1]:f}=this[M1],y=Boolean(this[e1][D1]),w=this[J0][D1],S=null===(e=p[w1][S1](f))||void 0===e?void 0:e.reducerResultStore,b=!t&&!w&&p[q0]();if(S)return c.createElement(c.Fragment,null,a()("div",{style:this[Q0](y,u),onMouseDown:this[W1],onMouseMove:this[O1],onMouseLeave:this[c1],onClick:this[h1],className:X.timelineItemRow},void 0,w&&a()(L5,{[L1]:i?void 0:t,[A1]:i,toggleButton:v,clonedStore:this.clonedStore,[o1]:this[o1],[t1]:this[t1],query:r,[R1]:n,[_1]:o,[Y0]:l,[E1]:d,showProperties:h,scrollerLeftOffset:s,[j0]:this[j0],[Z1]:p,[B1]:m,[$0]:this[M1][$0],[X0]:g,intl:ne.default.getIntl(),[U0]:S,[z0]:()=>{}}),b&&this.renderAddRowIndicator()))}renderAddRowIndicator(){var e;const{[A1]:t,[Z1]:i}=this[M1],o=i[K0][D1],s=o&&t?null===(e=t.getSchema()[o.property])||void 0===e?void 0:e.name:"";return a()("div",{style:this.getAddRowIndicatorWrapStyle()},void 0,a()("div",{style:this.getAddRowIndicatorStyle()},void 0,S.Z.plus(this.getNewRowIndicatorIconStyle()),a()("span",{style:{color:this.theme[W0]}},void 0,a()(P.FormattedMessage,t&&s?{[G0]:"New page in {propertyName}",id:"database.timelineView.nest.addSubitemWithPropertyName",values:{[H0]:s}}:{[G0]:"New",id:"database.timelineView.item.addRowButton"}))))}[Q0](e,t){let i=e?2:1;return this[M1][A1]&&(i=e?1:0),{display:"flex",height:zE+i,width:"100%",...e&&{borderTop:`1px solid ${this.theme[N0]}`,marginBottom:-1},...e&&!t&&{borderBottom:`1px solid ${this.theme[N0]}`},cursor:"default"}}getNewRowIndicatorIconStyle(){return{width:14,height:14,marginLeft:-1,marginRight:6,fill:this.theme.mediumIconColor}}getAddRowIndicatorWrapStyle(){const{paddingLeft:e,[B1]:t,showTable:i}=this[M1];return{position:"sticky",left:t&&!i?e+8:8,display:"flex",alignItems:"center"}}getAddRowIndicatorStyle(){return{display:"flex",alignItems:"center",paddingBottom:2,fontSize:14,height:FX,lineHeight:x.Z.lineHeight.UIRegular.desktop}}}K1.displayName="CollectionTimelineViewItemNew";const z1=K1,U1=i(85).fBu,$1=i(85).D7I,Q1=i(85).Lbv,q1=i(85).sP9,X1=i(85).gNE,Y1=i(85).Ttb,j1=i(85).TtP,J1=i(85).mUE,e4=i(85).ZzJ,t4=i(85).EIp,i4=i(85).wgE,o4=i(85).phM,s4=i(85).qLW,r4=i(85).owv,n4=i(85).ixe,l4=i(85).qU4,a4=i(85).jQA,d4=i(85).XtO,h4=i(85).kId,c4=i(85).bQB,u4=i(85).c1l,p4=i(85).rQ1,m4=i(85).QmD,g4=i(85).BpM,v4=i(85).KNN,f4=i(85).P0R,y4=i(85).$Fm,w4=i(85).CIR,S4=i(85).YDv,b4=i(85).xd5,k4=i(85).I8n,C4=i(85).MAy,T4=i(85).$pZ,x4=i(85).P24,I4=i(85).Kiu,P4=i(85).urI,D4=i(85).pkR,M4=i(85).HwH;class Z4 extends p.Z{constructor(){super(...arguments),this.renderTimelineItem=e=>{const{[M4]:t,[D4]:i,query:o,[P4]:s,[I4]:r,[x4]:n,[T4]:l,[C4]:d,[k4]:h,[b4]:c,[S4]:u,showTimelinePropertiesStore:p,[w4]:m,showTable:g,canEditTimelineItems:v,[y4]:f}=this[f4];if(!n[g4][v4](c))return;const y=n[p4][m4],w="collectionTypedView"===n[u4]||y[c4];return a()(F0,{[d4]:e,[D4]:i||!w,[M4]:t,[I4]:r,query:o,[P4]:s,scrollerLeftOffset:m[m4],[S4]:u,showProperties:p[m4],[T4]:l,[x4]:n,[C4]:d,showTable:g,[k4]:h,[b4]:c,canEditTimelineItems:v,[y4]:f,[h4]:this[h4],isLast:!1},e.id)},this[h4]=()=>{const{[x4]:e,[b4]:t}=this[f4],i=e[g4][v4](t);if(!i)return;pe.default.mark(a4);const o=e[l4]();O.Xd({[x4]:e,[n4]:i[n4]});const s=null==o?void 0:o[s4]()[r4],r=s||sl.Ls[o4];D.trackExpandBlock(this[i4],{is_peek:!0,from:o4,peek_mode:r})},this.resultsReducerStore=this[t4]((()=>{const{[x4]:e,[I4]:t,[b4]:i,query:o,showTable:s}=this[f4];if(!o[e4])return;const r=e[g4][v4](i);if(!r)return;const n=r.currentLimit[m4],l=h().compact([i&&(0,$e.Ko)({[I4]:t,group:i,timeZone:(0,Qe.r)()}),!s&&{property:o[e4],filter:{[J1]:"is_not_empty"}}]),a=l[j1]>0?{[J1]:"and",filters:l}:void 0;return{type:Y1,filter:a,limit:n}}))}renderComponent(){const{[d4]:e,[P4]:t,[b4]:i,[x4]:o,[C4]:s,[S4]:r,showTable:l}=this[f4],d=o[g4][v4](i);if(!d)return;const h=i?[i]:[],u=this.resultsReducerStore[m4],p=d[X1][m4],m=ie.shouldRenderLoadMoreButton({[x4]:o,reducerResult:p,[C4]:s});return c[$1](c.Fragment,null,u&&a()(Je.Z,{id:h[j1]>0?`results:${(0,_e.KW)(h)}`:"timeline_results",reducer:u,[q1]:h,[x4]:o,resultStore:d[X1]}),this.renderCollectionGroupResults(),m&&a()("div",{style:{width:"100%"}},void 0,l?a()("div",{style:{height:33}}):a()(Qn,{style:{position:"sticky",left:s?r:3,width:"max-content",height:33},[q1]:h,[d4]:e,[x4]:o,[P4]:t,[C4]:s,[Q1]:!1})),c[$1](B4,n()({},this[f4],{[d4]:void 0,indentLevel:0,[h4]:this[h4]})))}renderCollectionGroupResults(){const{[b4]:e,[D4]:t,query:i,[P4]:o,[I4]:s,[T4]:r,[x4]:l,[C4]:d,[k4]:h,showTable:u,canEditTimelineItems:p,[w4]:m,[M4]:g,[S4]:v,showTimelinePropertiesStore:f,[y4]:y}=this[f4];if(!l[g4][v4](e))return;const w=l[p4][m4],S="collectionTypedView"===l[u4]||w[c4];return a()(dd,{disableSelectable:!0,[x4]:l,[q1]:e?[e]:[],[P4]:o,canDrag:!1,disableRequest:!0,resultProps:{[D4]:t||!S,[M4]:g,[I4]:s,query:i,[P4]:o,scrollerLeftOffset:m[m4],[S4]:v,showProperties:f[m4],[T4]:r,[x4]:l,[C4]:d,showTable:u,[k4]:h,[b4]:e,canEditTimelineItems:p,[y4]:y,[h4]:this[h4],isLast:!1},canDrop:!1,resultComponent:F0,[D4]:!0,direction:ld.Vertical,shouldShowHoverMenu:!1,analyticsName:o4,emptyDroppableSize:0,nestedCreateSubitemButton:e=>c[$1](B4,n()({},this[f4],{[d4]:e[d4],indentLevel:e.indentLevel,[U1]:e[U1],subitemPath:e.subitemPath,[h4]:this[h4]}))})}}function B4(e){window.__c={n:"AddRowTimelineItem"};const{[d4]:t,[U1]:i,subitemPath:o,[M4]:s,[D4]:r,query:n,[P4]:l,[I4]:d,[x4]:h,[T4]:c,[C4]:u,[k4]:p,[b4]:m,[S4]:g,showTimelinePropertiesStore:v,[w4]:f,showTable:y,canEditTimelineItems:w,[y4]:S,isReady:b,canEdit:k}=e,C=(0,Xn.VK)((()=>h[g4][v4](m)),[h,m]),T=(0,Xn.VK)((()=>h[p4][m4]),[h[p4]]),x=(0,Xn.VK)((()=>f[m4]),[f]),I=(0,Xn.VK)((()=>v[m4]),[v]);return C&&b&&k&&!T.isSyncedCollection?a()(z1,{[d4]:t,[D4]:r||!T[c4],[M4]:s,[I4]:d,query:n,[P4]:l,scrollerLeftOffset:x,[S4]:g,showProperties:I,[T4]:c,[x4]:h,[C4]:u,showTable:y,[k4]:p,[b4]:m,canEditTimelineItems:w,[y4]:S,[U1]:i,subitemPath:o}):null}Z4.displayName="TimelineItemGroupResults";const R4=(0,P.injectIntl)(Z4),E4=i(85).MZ8;function V4(){window.__c={n:"TimelineTableShimmer"};const e=(0,Yn.yK)((e=>({[E4]:{display:"flex",height:34,padding:"7px 0px",alignItems:"center",gap:6,alignSelf:"stretch",flex:"1 0 0",borderBottom:`1px solid ${e.regularDividerColor}`},rowShimmer:{width:"80%",height:10,flexShrink:0,borderRadius:12,marginLeft:12,backgroundColor:e.lightDividerColor}})),[]);return a()("div",{style:e[E4]},void 0,a()(Dy.Z,{style:e.rowShimmer}))}const A4=i(85).zrY,L4=i(85).uRL,_4=i(85).opf,O4=i(85).nx5,F4=i(85).TEz,N4=i(85).GmX,G4=i(85).Scd,H4=i(85).Y9u,W4=i(85).OM8,K4=i(85).Exd,z4=i(85).YDv,U4=i(85).gGi,$4=i(85).jkI,Q4=i(85).H1U,q4=i(85).Nxi,X4=i(85).bSA,Y4=i(85).oWD,j4=i(85).fBu,J4=i(85).phM,e2=i(85).E5B,t2=i(85).eNH,i2=i(85).vlf,o2=i(85).Syl,s2=i(85).Anf,r2=i(85).MnL,n2=i(85).VFD,l2=i(85).k9$,a2=i(85).Uk6,d2=i(85).lDm,h2=i(85).I8n,c2=i(85).HwH,u2=i(85).g7N,p2=i(85).k6_,m2=i(85).mSd,g2=i(85).miS,v2=i(85).BQ6,f2=i(85).rQ1,y2=i(85).TN,w2=i(85).Mm1,S2=i(85).$Fm,b2=i(85).Kiu,k2=i(85).pkR,C2=i(85).X_m,T2=i(85).Au,x2=i(85).xej,I2=i(85).GPw,P2=i(85).EMU,D2=i(85).sM5,M2=i(85).wu4,Z2=i(85).JrN,B2=i(85).k2h,R2=i(85).EIp,E2=i(85).Lbv,V2=i(85).gNE,A2=i(85).iWP,L2=i(85).H4r,_2=i(85).cJo,O2=i(85).qU4,F2=i(85).u9,N2=i(85).urI,G2=i(85).Zij,H2=i(85).ffk,W2=i(85).$pZ,K2=i(85).ZG6,z2=i(85).f7G,U2=i(85).LIR,$2=i(85).XqV,Q2=i(85).XtO,q2=i(85).dLQ,X2=i(85).LCr,Y2=i(85).q$s,j2=i(85).TtP,J2=i(85).sP9,e6=i(85).Drs,t6=i(85).JJj,i6=i(85).ixe,o6=i(85).piL,s6=i(85).QmD,r6=i(85).vTv,n6=i(85).BpM,l6=i(85).KNN,a6=i(85).wgE,d6=i(85).P0R,h6=i(85).xd5,c6=i(85).MAy,u6=i(85).P24,p6=i(85).NqT;class m6 extends p.Z{constructor(){super(...arguments),this[p6]=()=>{const{[u6]:e,[c6]:t,[h6]:i}=this[d6],{device:o}=this[a6],s=i?[i]:[],r=e[n6][l6](s);if(!Ke[r6](this[a6])||!r)return;e[o6][s6]&&L.updateSearchQuery({[o6]:"",[u6]:e,[c6]:t});const n=r[i6][s6];z[t6]({[e6]:"TimelineTableGroupResults.handleAddRowClick",[a6]:this[a6],perform:t=>{const{coercionSucceeded:s,newStore:r}=E.createBlockInGroup({[a6]:this[a6],[u6]:e,[J2]:i?[i]:[],results:n,insertAtIndex:n[j2],coerce:!0,[Y2]:!0,[X2]:t,from:"timeline_table_group_results"});if(o[q2]){const e=(0,se.ZP)({[Q2]:r,[$2]:!1,[U2]:f.tY.Create});this[z2](e)}else m.default[K2]((()=>{m.default[K2]((()=>{if(s)Zi.open({[a6]:this[a6],[W2]:this[d6][W2],[Q2]:r,[H2]:G2,[N2]:Mo.C.Table,[u6]:e,[F2]:!0});else{const t=i?[i]:[],o=e[n6][l6](t);N.peekBlock({[a6]:this[a6],[Q2]:r,peekMode:(0,ie.getPeekMode)(e[O2]()),[i6]:null==o?void 0:o[i6],[u6]:e,[U2]:f.tY.Create})}}))}));D[_2](this[a6],{from:L2,type:"page",new_page_id:r.id,...(0,J.getCollectionAnalyticsContext)(e)})}})},this[A2]=e=>{const{[u6]:t,[h6]:i}=this[d6],o=t[n6][l6](i);if(!o)return;const s=o[V2][s6];(0,re.Wi)(e),W.clear(this[a6]),s&&E.incrementBlockLimit({[u6]:t,[a6]:this[a6],incrementLimitArgs:{[c6]:this[d6][c6],currentResultCount:s.blockIds[j2],[J2]:o[J2],[E2]:!1}}),D.trackInlineCollectionLoadMoreClick(this[a6])},this.allRowsStore=this[R2]((()=>{const{[h6]:e,[u6]:t}=this[d6];return(0,tl.A7)(e,t)})),this.titleColumnIndexStore=this[R2]((()=>{const{[B2]:e}=this[d6];return e[s6][Z2]((e=>"title"===e[H2]))})),this[M2]=()=>({[D2]:P2,[I2]:`1px solid ${this[T2][x2]}`,width:"fit-content",[C2]:33})}renderComponent(){const{[h6]:e,[c6]:t,[u6]:i,[W2]:o,isReady:s,[Q2]:r,[k2]:n,[N2]:l,[b2]:d,[S2]:h,[w2]:u,query:p,[B2]:m,[y2]:g}=this[d6],v=e?[e]:[],f=i[n6][l6](v);if(!f)return;const y=f[V2][s6],w=(0,ie.shouldRenderLoadMoreButton)({[u6]:i,reducerResult:y,[c6]:t}),S=i.shouldShowSpinner[s6]&&"on"===ke.default.getEligibleGroup({experimentId:"collections_loading_state",defaultGroup:"control"}),b=s&&0===(null==y?void 0:y.blockIds[j2])&&!S,k=i[f2][s6];return c.createElement(c.Fragment,null,this.renderTableHeaderRow(e),a()("div",{[v2]:{[C2]:(0,te.vX)(Boolean(e)),width:0}}),b&&this.renderEmptyTablePlaceholder(),this.renderTableRows(e),S&&a()(V4,{}),w&&this.renderLoadMoreButton(),this[g2]()&&this.renderTableAddRowButton(),a()(JO,{[h6]:e,[v2]:this.getAggregationRowStyle(),[Q2]:r,[k2]:n||!k[m2],[N2]:l,[b2]:d,query:p,[u6]:i,[S2]:h,[c6]:t,minWidth:void 0,[w2]:u,[W2]:o,[p2]:m,[y2]:g,showRightActionsSpacer:!1}),(e||t)&&a()("div",{[v2]:{[C2]:NX,width:0,[u2]:e?te.y1:void 0}}))}renderTableHeaderRow(e){const{[Q2]:t,[N2]:i,[b2]:o,query:s,[u6]:r,[w2]:n,[S2]:l,[W2]:d,tableStore:h,[B2]:c,[c2]:u,[c6]:p,[h2]:m}=this[d6];if(!r[n6][l6](e))return;const g=Boolean(e),v=r[f2][s6],f=r.viewIsFlushToTopbar();return a()(NK,{[Q2]:t,[N2]:i,[b2]:o,query:s,[u6]:r,[S2]:l,minWidth:void 0,[w2]:n,[W2]:d,[p2]:c,showRightActions:!1,allowHidingTitle:!0,tableStore:h,formatKey:d2,[k2]:!v[a2],[F2]:!0,[C2]:(0,te.vX)(g),paddingTop:g?0:te.Ne-te.pe,disableTopBorder:!f||g,disableCellRightBorder:!0,[h6]:e},void 0,!g&&v[m2]&&a()(DL,{isGrouped:!1,[N2]:i,[u6]:r,[c2]:u,[c6]:p,[h2]:m}))}renderTableRows(e){const{device:t}=this[a6],{[Q2]:i,[b2]:o,query:s,[k2]:r,[u6]:n,[W2]:l,[B2]:d,canEdit:h,[N2]:c}=this[d6],u=n[O2]();if(!u)return;const p=e?[e]:[];if(!n[n6][l6](e))return;const g=d[s6],v=!h&&t[q2]&&!u[l2](),f=this.titleColumnIndexStore[s6];return a()($$,{[Q2]:i,[N2]:c,[b2]:o,query:s,[u6]:n,minWidth:void 0,[W2]:l,[p2]:d,currentRowsStore:this.allRowsStore,[k2]:!h,[F2]:!0,[h6]:e,render:t=>a()(dd,{[u6]:n,[J2]:p,disableRequest:!0,[N2]:c,canDrag:v,resultProps:{[b2]:o,[u6]:n,[n2]:g,onPropertyTab:t.onPropertyTab,[r2]:t[r2],[s2]:t[s2],[o2]:t[o2],onPropertyEsc:t.onPropertyEsc,[i2]:t[i2],[t2]:t[t2],[e2]:t[e2],[k2]:r,[W2]:l,isScrolled:!1,showRightActionsSpacer:!1,[F2]:!0,disableLastCellBorderRight:!0,disableTableWrap:!0,disableCellBorderRight:!1,onShiftEnter:()=>{},titleColumnIndex:f,[h6]:e},resultComponent:Ez,canDrop:!1,[k2]:r,direction:ld.Vertical,[M2]:this[M2],shouldShowHoverMenu:!0,[X4]:J4,emptyDroppableSize:0,onSelectableEnter:t.onSelectableEnter,[q4]:!0,[W2]:l,titleColumnIndex:f,nestedCreateSubitemButton:e=>{const{[Q2]:t,[j4]:i,subitemPath:o,indentLevel:s}=e;if(i)return a()(XM,{[Q2]:t,[Y4]:i,subitemPath:o,indentLevel:s,[u6]:n,[k2]:r,[J2]:p,onSubitemCreate:e=>{l&&m.default[K2]((()=>{m.default[K2]((()=>{Zi.open({isNewBlock:!0,[a6]:this[a6],[W2]:l,[Q2]:e,[H2]:G2,[N2]:Mo.C.Table,[u6]:n,[F2]:!0})}))}))}})}})})}renderEmptyTablePlaceholder(){const{canEdit:e}=this[d6];return a()(Bo.Z,{onClick:this[p6],onMouseDown:re.$0,[k2]:!e,[v2]:{[D2]:P2,[Q4]:$4,[C2]:FX,width:U4,[z4]:8,[K4]:14,[W4]:x.Z[W4][H4].desktop,[G4]:this[T2][N4],left:0,right:0,[I2]:"1px solid transparent"}},void 0,e?a()("span",{[v2]:{color:this[T2][F4]}},void 0,a()(P.FormattedMessage,{[O4]:"Empty. Click to add a row.",id:"database.timelineView.emptyTablePlaceholder"})):a()("span",{[v2]:{color:this[T2][F4]}},void 0,a()(P.FormattedMessage,{[O4]:"Empty.",id:"database.timelineView.cannotEdit.emptyTablePlaceholder"})))}renderLoadMoreButton(){const{[u6]:e,[h6]:t,[N2]:i,canEdit:o}=this[d6],s=t?[t]:[];if(e[n6][l6](s))return a()(Bo.Z,{onMouseDown:re.$0,onClick:this[A2],[v2]:{[D2]:P2,[Q4]:$4,[C2]:FX+1,width:U4,[z4]:8,[w2]:2,[K4]:14,[W4]:x.Z[W4][H4].desktop,boxShadow:`0 -1px 0 ${this[T2][x2]}`,whiteSpace:"break-spaces"}},void 0,S.Z.arrowDown(this[_4]()),a()("span",{[v2]:{color:this[T2][F4]}},void 0,a()(P.FormattedMessage,{id:"database.loadMoreButtonTitle",[O4]:"Load more"})),o&&a()(An,{[u6]:e,[N2]:i}))}renderTableAddRowButton(){return a()(Bo.Z,{onClick:this[p6],[v2]:this.getTableAddRowButtonStyle(),className:X.tableViewAddRow,onMouseDown:re.$0},void 0,S.Z.plus(this[_4]()),a()("span",{[v2]:{color:this[T2][F4]}},void 0,a()(P.FormattedMessage,{[O4]:"New",id:"database.timelineView.addRowButton"})))}[z2](e){this.context[L4]?this.context[L4](e):N[z2]({[a6]:this[a6],url:e})}[g2](){const{[u6]:e,isReady:t,canEdit:i}=this[d6],o=e[f2][s6];return Boolean(t&&i&&!o[l2])}getTableAddRowButtonStyle(){return{[D2]:P2,[Q4]:$4,[C2]:FX,width:U4,[z4]:8,[K4]:14,[W4]:x.Z[W4][H4].desktop,[G4]:this[d6][S2]?this[T2][A4]:this[T2][N4]}}[_4](){return{width:14,[C2]:14,marginLeft:-1,marginRight:6,fill:this[T2].lightIconColor}}getAggregationRowStyle(){const{isReady:e,[h6]:t,[c6]:i,[z4]:o}=this[d6];return{...!e&&{opacity:0,pointerEvents:"none"},...!i&&!t&&{position:"sticky",left:o},...i&&!t&&{left:o}}}}m6.displayName="TimelineTableGroupResults",m6.contextTypes={...$.wK,...p.w};const g6=(0,P.injectIntl)(m6),v6=i(85).zrY,f6=i(85).eki,y6=i(85).veG,w6=i(85).Cj7,S6=i(85).lDm,b6=i(85).wbq,k6=i(85).$KA,C6=i(85).nx5,T6=i(85).Jf8,x6=i(85).bSA,I6=i(85).z$9,P6=i(85).qc1,D6=i(85).tLG,M6=i(85).phM,Z6=i(85).cx2,B6=i(85).gIX,R6=i(85).qdS,E6=i(85).X02,V6=i(85).LCr,A6=i(85).JJj,L6=i(85).iTm,_6=i(85).CxS,O6=i(85).Uk6,F6=i(85).ZzJ,N6=i(85).SK6,G6=i(85).oWD,H6=i(85).GmX,W6=i(85).bZD,K6=i(85).Au,z6=i(85).xej,U6=i(85).IY7,$6=i(85).jms,Q6=i(85).abK,q6=i(85).BCr,X6=i(85).ij9,Y6=i(85).eiN,j6=i(85).EIp,J6=i(85).ixe,e3=i(85).qU4,t3=i(85).LIR,i3=i(85).jDA,o3=i(85).dLQ,s3=i(85).aV8,r3=i(85).m3M,n3=i(85).c0M,l3=i(85).q9x,a3=i(85).nKX,d3=i(85).YNm,h3=i(85).Wp_,c3=i(85).E0z,u3=i(85).O1p,p3=i(85).kMZ,m3=i(85).Lbv,g3=i(85).sP9,v3=i(85).TtP,f3=i(85).wgE,y3=i(85).gNE,w3=i(85).xYh,S3=i(85).m3I,b3=i(85).WxM,k3=i(85).c1l,C3=i(85).XCs,T3=i(85).EMU,x3=i(85).sM5,I3=i(85).GPw,P3=i(85).KS0,D3=i(85).Scd,M3=i(85).p1r,Z3=i(85).gGi,B3=i(85).fBv,R3=i(85).C_5,E3=i(85).Jkr,V3=i(85).CIR,A3=i(85).Se8,L3=i(85).kOb,_3=i(85).Aw$,O3=i(85).YDv,F3=i(85).xd5,N3=i(85).k4y,G3=i(85).v5W,H3=i(85).Gnd,W3=i(85).k2h,K3=i(85).BpM,z3=i(85).KNN,U3=i(85).zat,$3=i(85).pkR,Q3=i(85).Mm1,q3=i(85).TN,X3=i(85).$pZ,Y3=i(85).$Fm,j3=i(85).VMs,J3=i(85).Kiu,e7=i(85).XtO,t7=i(85).BQ6,i7=i(85)._V5,o7=i(85).X_m,s7=i(85).D7I,r7=i(85).HwH,n7=i(85).mSd,l7=i(85).dEG,a7=i(85).rQ1,d7=i(85).QmD,h7=i(85).P0R,c7=i(85).I8n,u7=i(85).MAy,p7=i(85).P24,m7=i(85).urI,g7=i(85).w2X,v7=i(85).wfR,f7=i(85).ORX,y7=i(85).mOq;class w7 extends Le.Z{constructor(){super(...arguments),this.widthEl=null,this.storeTypes={[y7]:KE,[f7]:v.default[v7](!1),[g7]:v.default[v7](void 0)},this.renderTableGroupHeader=e=>{const{[m7]:t,[p7]:i,[u7]:o,[c7]:s}=this[h7],r=i[a7][d7];return c[s7](mf,n()({},e,{[o7]:te.Zn-1,[i7]:te.xd,toggleClosedMarginBottom:te.xd,getComputedStickyStyle:this.getTableGroupHeaderComputedStickyStyle,[t7]:this.getGroupHeaderStyle(e[l7])}),0===e[l7]&&r[n7]&&a()(DL,{isGrouped:!0,[m7]:t,[p7]:i,[r7]:this[r7],[u7]:o,[c7]:s})," ")},this.renderTableGroupResults=e=>{const{[e7]:t,[u7]:i,[J3]:o,[j3]:s,[Y3]:r,[p7]:n,[X3]:l,[q3]:d,[Q3]:h,[c7]:c,[$3]:u}=this[h7],p=this.isReady[d7],m=this[U3]();if(n[K3][z3](e))return a()(g6,{[e7]:t,[F3]:e,[J3]:o,[j3]:s,[Y3]:r,[r7]:this[r7],[p7]:n,[X3]:l,[W3]:this[W3],[q3]:d,[y7]:this[H3][y7],[O3]:m,[Q3]:h,[m7]:this[G3](),[u7]:i,[c7]:c,isReady:p,[_3]:this[N3](),[$3]:u&&this[N3]()})},this[L3]=e=>{const{[e7]:t,[u7]:i,[J3]:o,[j3]:s,[Y3]:r,[p7]:n,[X3]:l,[c7]:d,[$3]:h}=this[h7],c=this.isReady[d7],u=this[U3]();return a()(R4,{[e7]:t,[F3]:e,[J3]:o,[j3]:s,[Y3]:r,[r7]:this[r7],[p7]:n,[X3]:l,showTimelinePropertiesStore:this.showTimelinePropertiesStore,[O3]:u,[m7]:this[G3](),[u7]:i,[c7]:d,isReady:c,[_3]:this[N3](),[$3]:h,showTable:this[A3][d7],canEditTimelineItems:this.canEditTimelineItemsStore[d7],[V3]:this[V3]})},this.renderTimelineItemGroupHeader=e=>{if(this[A3][d7])return;const t=this[r7][R3].rect[d7][E3];return a()("div",{[t7]:{[B3]:"sticky",left:0,[E3]:t,[o7]:te.Zn,zIndex:I.collectionGroupHeader}},void 0,c[s7](mf,n()({},e,{[t7]:{[E3]:Z3,[o7]:Z3,[O3]:this[h7][u7]?this[U3]():32,zIndex:void 0,[M3]:"background 200ms ease-in-out, border 200ms  ease-in-out",[D3]:P3,[I3]:"1px solid transparent"},getComputedStickyStyle:this.getTimelineItemGroupHeaderStickyStyle,preventToggleBackground:this[h7][Y3]})))},this.renderTimelineItemHiddenGroupsButton=e=>{if(this[A3][d7])return;const{[u7]:t}=this[h7];return a()("div",{[t7]:{[E3]:Z3,[o7]:34,[x3]:T3}},void 0,c[s7](gy,n()({},e,{[t7]:{[B3]:"sticky",left:t?this[U3]():3,[E3]:"max-content",[O3]:4,[C3]:8}})))},this.renderTimelineAddGroupButton=e=>{if(this[A3][d7])return;const{[u7]:t,[p7]:i}=this[h7];return"collectionTypedView"!==i[k3]?a()("div",{[t7]:{[E3]:Z3,[o7]:32,[x3]:T3}},void 0,c[s7](Cm,n()({},e,{[t7]:{[B3]:"sticky",left:t?this[U3]():3,[E3]:"max-content",[O3]:4,[C3]:8}}))):void 0},this.renderTimelineGroupsLoadMoreButton=e=>{if(this[A3][d7])return;const{[u7]:t}=this[h7];return a()("div",{[t7]:{[E3]:Z3,[o7]:38,[x3]:T3}},void 0,c[s7](hy,n()({},e,{[t7]:{[B3]:"sticky",left:t?this[U3]():3,[E3]:"max-content",[O3]:4,[C3]:8}})))},this[b3]=e=>{const{[p7]:t,[e7]:i,[u7]:o,[m7]:s,[$3]:r}=this[h7];return a()(hj,{[e7]:i,[F3]:e,[p7]:t,[u7]:o,[_3]:this[N3](),[m7]:s,[$3]:r&&this[N3]()})},this.renderDropzoneSelectableGroupHeader=()=>{},this.renderDropzoneSelectableHiddenGroupsButton=()=>{},this.renderDropzoneSelectableAddGroupButton=()=>{},this.renderDropzoneSelectableGroupsLoadMoreButton=()=>{},this[S3]=e=>{const{[p7]:t,[u7]:i}=this[h7],o=t[w3][d7],s=t[K3][z3]([]);if(!s)return;const r=s[y3][d7];e<ye.Z.incrementScrollOffset&&r&&!o&&r.hasMore&&E.incrementBlockLimit({[p7]:t,[f3]:this[f3],incrementLimitArgs:{[u7]:i,currentResultCount:r.blockIds[v3],[g3]:[],[m3]:!1}})},this.handleHorizontalScroll=()=>{const{[r7]:e}=this,{[p3]:t,savePreference:i}=e;if(!t)return;const o=t[u3],s=e[u3][d7];this[f3][c3].isIOS&&void 0!==s&&0===o&&s>te.lx?t[u3]=s:(i&&i(),e[u3][h3](o),(0,te.rr)(this[f3])?this.resetWindowForScrollDebounced():this.resetWindowForScroll())},this.resetWindowForScroll=()=>{const{[r7]:e}=this,{[p3]:t,[R3]:i}=e;if(!t)return;const o=e[d3][d7],{startTimestamp:s,endTimestamp:r}=e[a3][d7],n=t[u3],l=i.rect[d7][E3],a=(0,te.e$)(o,r-s),d=(0,te.al)(e);if(n<te.lx){const t=-(0,te.x2)(o,te.Ge);e[a3][h3]({startTimestamp:s+t,endTimestamp:r+t}),GE.resetWindow({[r7]:e,[f3]:this[f3],[d3]:o,[l3]:d})}else if(n+l>a-te.lx){const t=(0,te.x2)(o,te.Ge);e[a3][h3]({startTimestamp:s+t,endTimestamp:r+t}),GE.resetWindow({[r7]:e,[f3]:this[f3],[d3]:o,[l3]:d})}},this.resetWindowForScrollDebounced=h().debounce(this.resetWindowForScroll,200),this.handleWidthElMount=e=>{if(this.widthEl=e,e){const{[r7]:t}=this,{[R3]:i}=t;i.observe(e);const o=(0,de.xH)(e);o&&(t[p3]=o,(0,oe.addPassiveEventListener)(o,"scroll",this.handleHorizontalScroll),t[R3].rect[n3](this[r3]),this[r3]())}},this.handleTimelineElMount=e=>{if(e){const{[r7]:t}=this,{timelineSizeObserver:i}=t;i.observe(e)}},this[r3]=()=>{const{[r7]:e}=this,{startTimestamp:t,endTimestamp:i}=e[a3][d7];GE[r3]({[r7]:e,[l3]:(t+i)/2})},this[s3]=(e,t,i)=>{if(this[f3][c3][o3])N[i3]({[f3]:this[f3],[e7]:e,[t3]:f.tY.Create});else{const{[p7]:t}=this[h7],{[F3]:o}=i,s=o?[o]:[],r=t[K3][z3](s);N.peekBlock({[f3]:this[f3],[e7]:e,peekMode:ie.getPeekMode(t[e3]()),[J6]:null==r?void 0:r[J6],[p7]:t,[t3]:f.tY.Create})}},this[W3]=this[j6]((()=>this.getTimelineTableProperties()[Y6]((e=>e[X6]))),!0),this.tableWidthStore=this[j6]((()=>this[A3][d7]?this[W3][d7].reduce(((e,t)=>e+(t[E3]||0)),0):0)),this[V3]=this[j6]((()=>(0,te.xI)({[f3]:this[f3],[O3]:this[U3](),[m7]:this[h7][m7],[u7]:this[h7][u7],[c7]:this[h7][c7]}))),this.scrollPixelWidthStore=this[j6]((()=>{const{[r7]:e}=this,t=e[d3][d7],{startTimestamp:i,endTimestamp:o}=e[a3][d7];return(0,te.e$)(t,o-i)})),this.showTimelinePropertiesStore=this[j6]((()=>{const{[m7]:e}=this[h7];return(e[q6]||[])[Y6]((e=>{let{[X6]:t}=e;return t})).map((e=>{let{property:t}=e;return t}))})),this[A3]=this[j6]((()=>{const{[m7]:e,[u7]:t,[c7]:i}=this[h7];return(0,te.C1)({[f3]:this[f3],[m7]:e,[u7]:t,[c7]:i})})),this.canEditTimelineItemsStore=this[j6]((()=>{const{[j3]:e,[J3]:t}=this[h7];return ie.canEditTimelineItems({[j3]:e,[J3]:t})})),this.isReady=this[j6]((()=>{const{[p7]:e}=this[h7];return e[K3].anyGroupHasResults()})),this.getTimelineItemGroupStyle=e=>{const t=this[A3][d7],i=this.getGroupPaddingState(e);let o=0,s=0;return i.groupHeader&&t&&(o+=te.Zn-1),i[Q6]&&(o+=te.pe),i.tableEmptyRow&&(o+=FX),i.tableAggregationRow&&(s+=NX),i.hiddenGroupsButton&&t&&(s+=34),i.groupsLoadMoreButton&&t&&(s+=38),i.addGroupButton&&t&&(s+=32),i.groupPaddingBottom&&(s+=te.y1),i.extraGroupMarginBottom&&(s+=te.xd+1),{[i7]:o,[Q3]:s,[$6]:te.Zn,[U6]:e[l7]>0&&(!t||i[Q6])?`0 -1px 0 ${this[K6][z6]}`:void 0}},this[W6]=e=>{if(!e)return{[i7]:0,[Q3]:0};const t=this.getGroupPaddingState(e);let i=0,o=0;return t.groupHeader&&(i+=te.Zn),t[Q6]&&(i+=te.pe),t.tableEmptyRow&&(i+=FX),t.addItemRow&&(o+=zE),t.loadMoreButton&&(o+=33),t.tableAggregationRow&&(o+=NX),t.hiddenGroupsButton&&(o+=34),t.groupsLoadMoreButton&&(o+=38),t.groupPaddingBottom&&(o+=te.y1),t.extraGroupMarginBottom&&(o+=te.xd),t.addGroupButton&&(o+=32),t.dropZoneSelectableGroupExtraBottomPadding&&(o+=1),{[i7]:i,[Q3]:o}},this.getTableGroupHeaderComputedStickyStyle=e=>({[U6]:e?`0 -1px 0 ${this[K6][z6]}`:void 0}),this.getTimelineItemGroupHeaderStickyStyle=e=>e?{[D3]:this[K6][H6],[U6]:`0 1px 0 ${this[K6][z6]}`}:{[D3]:P3,[U6]:void 0}}get registries(){return super.registries.concat(HE.Z)}willMount(e){super.willMount(e),this[r7]=(0,te.Gz)({[u7]:e[u7],[c7]:e[c7]});const{[p7]:t}=e,i=t[G6](),o=t[e3]();i&&o&&GE.initialize({[r7]:this[r7],[f3]:this[f3],[e3]:o,[p7]:t})}[N6](e){super[N6](e);const{[r7]:t}=this,{[j3]:i,[p7]:o}=e;Te.Z[d7]&&t.hoveredItem[h3](void 0);const s=o[G6]();if(!s)return;const r=o[a7][d7];!i[F6]&&r[O6]&&r[n7]&&s.isDefined()&&this.updateOrCreateTimelineProperty(e)}[_6](){super[_6]();const e=this[r7],{[p7]:t,[u7]:i,[c7]:o}=this[h7];D.trackTimelineView(this[f3],(0,te.Ii)({[f3]:this[f3],[p7]:t,[r7]:e,[u7]:i,[c7]:o}));const s=e.drawState[d7];if(null!=s&&s[L6]){(0,te.H5)(t)&&z[A6]({userAction:"TimelineItemDependencyDrawHandle.completeUserDrawnArrow",[f3]:this[f3],perform:s=>{GE.completeDraw({[r7]:e,[f3]:this[f3],[V6]:s,[p7]:t,[u7]:i,[c7]:o})}})}}willUnmount(){super.willUnmount();const{[r7]:e}=this,{[p3]:t,[R3]:i,timelineSizeObserver:o}=e;i.destroy(),o.destroy(),e.destroyed=!0,t&&(0,oe.removePassiveEventListener)(t,"scroll",this.handleHorizontalScroll)}customizeEdgeScrollRect(e){const t=this[V3][d7];return xT.iL.from({...e,left:e.left+t,[E3]:e[E3]-t})}addBlockToView(e){const{[e7]:t,[V6]:i}=e,{[p7]:o}=this[h7],s=o[G6]();if(s)return GE.addBlockToView({[f3]:this[f3],[e7]:t,[r7]:this[r7],[j3]:this[h7][j3],[G6]:s,[p7]:this[h7][p7],[F3]:void 0,[V6]:i})}renderPersisted(){const{[e7]:e,[Y3]:t,[C3]:i,[u7]:o,[c7]:s,[j3]:r,[J3]:l,[m7]:d,[p7]:h,[$3]:u}=this[h7],{[F6]:p}=r;if(!p)return this[E6]();const m=l[p];if(!m||!Ii.isDateType(m))return this[E6]();const{[r7]:g}=this,v=this[V3][d7],f=this[A3][d7],y=this[U3](),w=ie.shouldUseLoadMoreButton(h,o),S=d[R6],b=h.viewIsFlushToTopbar(),k=(0,He.Z)((p=>a()(Af,{[u7]:o,[B6]:h[B6]},void 0,c[s7]("div",n()({[t7]:this[Z6](f),className:X.timelineView},p),a()(rl.Z,{[e7]:e,[x6]:M6,shouldShowHalo:!o,canSelect:!o},void 0,a()(oY,{[r7]:g,[Y3]:this[h7][Y3]}),c[s7]("div",{[t7]:{[B3]:D6,[E3]:Z3,zIndex:0,top:te.Ne},ref:this.handleTimelineElMount},S?this.renderTimelineItemGroups(S):this[L3](void 0),a()(XV,{[r7]:g,[$3]:u,isReady:this.isReady[d7],[B6]:h[B6],[u7]:o,[c7]:s})),a()(F_,{[Y3]:t,[r7]:g,[j3]:r,[J3]:l,scrollerLeftOffset:v,[p7]:h,showTable:f}),a()(uL,{[r7]:g,[Y3]:t,[O3]:y,[C3]:!o&&s?8:i,[m7]:d,scrollerLeftOffset:v,[u7]:o,[c7]:s,showTable:f,[p7]:h,isReady:this.isReady[d7]}),f&&this.renderTable(S,y),a()("div",{[t7]:{[i7]:te.Ne,[P6]:I6}},void 0,S?this.renderRowDropzoneSelectableGroups(S):a()("div",{[t7]:this[W6](void 0)},void 0,this[b3](void 0))),!w&&a()(hd.Z,{onChange:this[S3]}))))));return c[s7](c.Fragment,null,c[s7]("div",{ref:this.handleWidthElMount}),!b&&a()("div",{[t7]:{[o7]:4}}),k)}[E6](){return a()("div",{[t7]:{[O3]:this[U3](),[C3]:this[h7][C3]}},void 0,a()(P.FormattedMessage,{[C6]:T6,id:"database.timelineView.missingDateProperty"}))}renderTable(e,t){const{[e7]:i,[u7]:o,[p7]:s}=this[h7];return a()("div",{[t7]:{[B3]:"sticky",left:0,[o7]:0,[E3]:this.tableWidthStore[d7],zIndex:I.timelineViewTable}},void 0,a()(rl.Z,{[t7]:this.getTableSelectableStyle(t),[e7]:i,shouldShowHalo:!1,canSelect:!o,[x6]:M6},void 0,e?this.renderTableGroups(e):a()(Af,{[u7]:o,ignoreAncestorContainer:!0,[B6]:s[B6]},void 0,a()("div",{},void 0,this.renderTableGroupResults(void 0)))))}renderTableGroups(e){const{[e7]:t,[m7]:i,[p7]:o,[J3]:s,[$3]:r,[u7]:n,[O3]:l,[c7]:d,[Y3]:h}=this[h7];return a()(Tk,{[e7]:t,id:"timeline_groups",groupBy:e,[k6]:_e.Uh,groupAggregationKey:_e.dQ,[m7]:i,[J3]:s,[p7]:o,[$3]:r,[u7]:n,renderGroup:this.renderTableGroupResults,renderHeader:this.renderTableGroupHeader,onGroupHeaderAddItem:this[s3],[f7]:this[H3][f7],[y3]:this[H3][g7],disableReducerRequest:!0,ignoreAncestorStickyContainer:!0,[O3]:l,[c7]:d,[Y3]:h})}renderTimelineItemGroups(e){const{[e7]:t,[m7]:i,[p7]:o,[J3]:s,[$3]:r,[u7]:n,[O3]:l,[c7]:d,[Y3]:h}=this[h7];return a()(Tk,{[e7]:t,id:"timeline_groups",groupBy:e,[k6]:_e.Uh,groupAggregationKey:_e.dQ,[m7]:i,[J3]:s,[p7]:o,[$3]:r,[u7]:n,renderGroup:this[L3],onGroupHeaderAddItem:this[s3],[f7]:this[H3][f7],renderHeader:this.renderTimelineItemGroupHeader,getGroupStyle:this.getTimelineItemGroupStyle,[y3]:this[H3][g7],renderHiddenGroupsButton:this.renderTimelineItemHiddenGroupsButton,renderAddGroupButton:this.renderTimelineAddGroupButton,[b6]:this.renderTimelineGroupsLoadMoreButton,[O3]:l,[c7]:d,[Y3]:h,shouldSurpressShimmer:!0})}renderRowDropzoneSelectableGroups(e){const{[e7]:t,[m7]:i,[p7]:o,[J3]:s,[$3]:r,[u7]:n,[O3]:l,[c7]:d,[Y3]:h}=this[h7];return a()(Tk,{[e7]:t,id:"timeline_groups",groupBy:e,[k6]:_e.Uh,groupAggregationKey:_e.dQ,[m7]:i,[J3]:s,[p7]:o,[$3]:r,[u7]:n,renderGroup:this[b3],onGroupHeaderAddItem:this[s3],[f7]:this[H3][f7],renderHeader:this.renderDropzoneSelectableGroupHeader,getGroupStyle:this[W6],[y3]:this[H3][g7],disableReducerRequest:!0,renderHiddenGroupsButton:this.renderDropzoneSelectableHiddenGroupsButton,renderAddGroupButton:this.renderDropzoneSelectableAddGroupButton,[b6]:this.renderDropzoneSelectableGroupsLoadMoreButton,[O3]:l,[c7]:d,[Y3]:h,shouldSurpressShimmer:!0})}[G3](){const{[m7]:e}=this[h7],{temporaryFormat:t}=this[H3][y7][d7];return t||e}getTimelineTableProperties(){const e=this[G3]();return e&&e[S6]?e[S6]:[]}updateOrCreateTimelineProperty(e){const{[J3]:t}=e,{[p7]:i}=this[h7],o=i[G6]();if(!o)return;const s=i[e3]();if(!s)return;const r=(0,P.defineMessages)({date:{id:"database.timelineView.dateProperty.defaultName",[C6]:"Date"}});z[A6]({userAction:"CollectionTimelineView.updateOrCreateTimelineProperty",[f3]:this[f3],perform:e=>{let i,n=ie.findDateProperty(t);if(!n){n=(0,Fe.ZP)();i={[n]:{name:ne.default.formatMessage(r.date),type:"date"}}}L[w6]({[e3]:s,update:{[F6]:n},[V6]:e}),i&&L[y6]({[f3]:this[f3],[G6]:o,update:i,[V6]:e})}})}[N3](){const e=this[h7][p7][a7][d7];return this[_3]()&&e.canEditContent&&!e.isSyncedCollection}isInlineFullWidth(){const{[c7]:e,[u7]:t,[m7]:i}=this[h7];return(0,te.fj)({[f3]:this[f3],[c7]:e,[u7]:t,[m7]:i})}getGroupPaddingState(e){const{[F3]:t,currentGroups:i,visibleGroups:o,hiddenGroups:s,total:r}=e,{[p7]:n,[u7]:l,[$3]:a,[m7]:d}=this[h7],{[f7]:h}=this[H3],c=d[R6],u=this[A3][d7],p=n[K3][z3](t),m=Boolean(t&&!(null!=p&&p[f6][d7])),g=this.isFirstNonCollapsedGroup(t,m,i),v=null==p?void 0:p[y3][d7],f=ie.shouldRenderLoadMoreButton({[p7]:n,reducerResult:v,[u7]:l}),y=t===s[s[v3]-1],w=t===o[o[v3]-1],S=o[v3]<r,b=h[d7]?y:w,k=n[a7][d7],C=b&&!a&&k[n7]&&c&&(0,_e.Wz)(c,k[O6]),T=v&&0===v.blockIds[v3];return{groupHeader:Boolean(t&&(!u||!g)),[Q6]:Boolean(u&&!m&&!g),tableAggregationRow:Boolean(u&&!m),addItemRow:Boolean(this[N3]()&&!m),hiddenGroupsButton:Boolean(w&&s[v3]>0),groupsLoadMoreButton:Boolean(w&&S),loadMoreButton:Boolean(!m&&f),groupPaddingBottom:Boolean(!m),tableEmptyRow:Boolean(u&&!m&&T),extraGroupMarginBottom:Boolean(u&&m),addGroupButton:Boolean(C),dropZoneSelectableGroupExtraBottomPadding:Boolean(!u)}}isFirstNonCollapsedGroup(e,t,i){const{[p7]:o}=this[h7];if(!e)return!0;const s=i.indexOf(e);return!t&&!i.find(((e,t)=>{if(t<s){const t=o[K3][z3]([e]);return null==t?void 0:t[f6][d7]}return!1}))}[U3](){return this.isInlineFullWidth()?te.Qw:this[h7][O3]}[Z6](e){const{[u7]:t,[Q3]:i}=this[h7],o=this.scrollPixelWidthStore[d7],s=this.isReady[d7];return{[B3]:"relative",float:"left",minWidth:Z3,[E3]:o,[D3]:this[h7][Y3]?this[K6].peekTimelineBackground:this[K6].timelineBackground,...!t&&!e&&{[I3]:`1px solid ${this[K6][z6]}`},...!s&&{[$6]:150},...t&&{[Q3]:i},[o7]:this.getComputedOuterHeight()}}getTableSelectableStyle(e){return{whiteSpace:"nowrap",[D3]:this[h7][Y3]?this[K6][v6]:this[K6][H6],[O3]:e,borderRight:`1px solid ${this[K6][z6]}`,[U6]:this[K6].timelineTableBoxShadow,clipPath:"polygon(0% 0%, 120% 0%, 120% 100%, 0% 100%)",[E3]:this.tableWidthStore[d7]+e+1,[o7]:this.getComputedOuterHeight()}}getComputedOuterHeight(){const{[c3]:e}=this[f3],{[Q3]:t,[u7]:i}=this[h7],{timelineSizeObserver:o}=this[r7],s=o.rect[d7][o7]||120,r=this[A3][d7];return s+t+(i?0:72)+(!i&&r?28:0)+(i&&e[o3]?72:0)}getGroupHeaderStyle(e){const{[p7]:t}=this[h7],i=t.viewIsFlushToTopbar();return 0!==e||i?{borderTop:`1px solid ${this[K6][z6]}`}:{}}}w7.contextTypes={...$.wK,...p.w};const S7=w7;var b7=i(89086),k7=i(44862);const C7=i(85).oWD,T7=i(85).P24;class x7 extends p.Z{renderComponent(){const{store:e,titleStyle:t,actionButton:i,[T7]:o}=this.props;return a()("div",{},void 0,a()("div",{style:{display:"flex"}},void 0,a()(BT.Z,{store:e,style:t}),i),a()(k7.Z,{[C7]:e,[T7]:o}))}}x7.displayName="CollectionHeader";const I7=x7;var P7=i(40662);const D7=i(85)._Fe,M7=i(85).Au,Z7=i(85).u3H,B7=i(85).v8g,R7=i(85).vN2,E7=i(85).BJF,V7=i(85).dmz,A7=i(85).MHP,L7=i(85).XuB,_7=i(85).EHj,O7=i(85).pkR,F7=i(85).Yzm,N7=i(85).yKA,G7=i(85).Uie,H7=i(85).PXg,W7=i(85).dLQ,K7=i(85).XNW,z7=i(85).TN,U7=i(85).Isv,$7=i(85).BQ6,Q7=i(85).ELX,q7=i(85).h8z,X7=i(85).UPJ,Y7=i(85).jkI,j7=i(85).H1U,J7=i(85).EMU,e9=i(85).sM5,t9=i(85).fBv,i9=i(85).Jkr,o9=i(85).vCp,s9=i(85).uzK,r9=i(85).PJ8,n9=i(85).EIp,l9=i(85).xrO,a9=i(85).j7K,d9=i(85).mSd,h9=i(85).Lhq,c9=i(85).y79,u9=i(85).LCr,p9=i(85).U9S,m9=i(85).nXm,g9=i(85).nxU,v9=i(85).Drs,f9=i(85).JJj,y9=i(85).qU4,w9=i(85).tb2,S9=i(85).XtO,b9=i(85).Uk6,k9=i(85).jQT,C9=i(85).N1Z,T9=i(85).wgE,x9=i(85).irQ,I9=i(85).X5t,P9=i(85).D7I,D9=i(85).Tuj,M9=i(85).rpY,Z9=i(85).uM3,B9=i(85).rQ1,R9=i(85).QmD,E9=i(85).k9$,V9=i(85).oWD,A9=i(85).P0R,L9=i(85).P24,_9=i(85).J5t,O9=i(85).nx5,F9=(0,P.defineMessages)({titlePlaceholder:{[O9]:"Untitled",id:"database.source.titlePlaceholder"}});class N9 extends p.Z{constructor(){super(...arguments),this[_9]=()=>{const{[L9]:e}=this[A9],t=e[V9]();if(!t)return 22;return t[E9]()?58:22},this.renderActionsPopup=e=>{const{[L9]:t}=this[A9],i=t[B9][R9],o=t[V9]();if(!o)return;const s=o[E9](),r=d[Z9]([{key:"view",[M9]:e=>c[P9](et.Z,n()({},e,{title:a()(P.FormattedMessage,{id:"database.source.viewDatabase.title",[O9]:"View database"}),icon:S.Z.alias(this[D9]())})),[I9]:i=>{const o=this.getHref();if(!o)return;const s=oe[x9](i.event);N.navigate({[T9]:this[T9],url:o,openInNew:s}),s||e[C9](),R[k9]({[T9]:this[T9],[L9]:t,[I9]:"click_source_view"})}},i[b9]&&!s&&{key:"edit_name",[M9]:e=>c[P9](et.Z,n()({},e,{title:a()(P.FormattedMessage,{id:"database.source.editTitle.title",[O9]:"Edit database title"}),icon:S.Z.pencil(this[D9]())})),[I9]:()=>{K.selectAllText({[T9]:this[T9],[S9]:o.getNameStore(),[w9]:!1}),e[C9](),R[k9]({[T9]:this[T9],[L9]:t,[I9]:"click_source_edit_title"})}}]),l={key:"show_title",[M9]:e=>c[P9](et.Z,n()({},e,{icon:S.Z.eyeHidePadded(this[D9](!0)),title:a()(P.FormattedMessage,{id:"database.source.hideTitle.title",[O9]:"Hide database title"})})),[I9]:()=>{const{[L9]:t}=this[A9],i=t[y9]();i&&(z[f9]({[v9]:"CollectionViewBlockSource.showTitleItem",[T9]:this[T9],[g9]:e=>{Ne[m9]({stores:[i],update:{[p9]:!0},[u9]:e})}}),e[C9](),R[k9]({[T9]:this[T9],[L9]:t,[I9]:"click_source_hide_title"}))}};return a()(ot.Z,{type:ot.i[c9],sections:d[Z9]([{key:h9,[M9]:e=>c[P9](lt.Z,e),items:r},i[d9]&&{key:"show_title",[M9]:e=>c[P9](lt.Z,n()({},e,{topBorder:!0})),items:[l]}]),[a9]:void 0})},this[l9]=e=>{const{[L9]:t}=this[A9],i=t[V9]();if(!i)return;const o=i&&i.getIconStore();o&&z[f9]({[v9]:"CollectionViewBlockSource.handleRecordIconChange",[T9]:this[T9],[g9]:t=>{Bi.setValue({[S9]:o,value:e,[u9]:t})}})},this.handleNameBlur=()=>{W.clear(this[T9])},this.handleNameButtonClick=()=>{const{[L9]:e}=this[A9];R[k9]({[T9]:this[T9],[L9]:e,[I9]:"click_collection_name_link_button"})},this.handleNameInputClick=()=>{const{[L9]:e}=this[A9];R[k9]({[T9]:this[T9],[L9]:e,[I9]:"click_collection_name_input"})},this.isEditingName=this[n9]((()=>{const{[L9]:e}=this[A9],t=e[V9]();if(!t)return!1;const i=t.getNameStore();return Boolean((0,b7.J5)(i))})),this[r9]=this[n9]((()=>{const{[S9]:e}=this[A9],t=Re.default[R9];return(0,ie.isInFrameWhenSidePeekOpen)(e)||!(0,ie.isInPeekRenderer)(e)&&t.open&&t.isClosing}))}renderComponent(){var e;const{[L9]:t,isFullScreen:i,canEdit:o}=this[A9],s=t[V9](),r=t[B9][R9],n=t[s9]();if(!s||!n)return;const l=Boolean((null===(e=s[o9]())||void 0===e?void 0:e.id)===n.id),d=Boolean(s[E9]()),h=this.isEditingName[R9],c=this[r9][R9],{WindowSizeStore:u}=this[T9],p=Math.min(Q.pageViewBlockDefaultWidth,u[R9][i9]),m=(l||h)&&r[b9]&&!d;return a()("div",{[$7]:{...(i||c)&&(0,de.eA)(this[T9])&&{[t9]:"sticky",left:0},paddingTop:8,boxSizing:c?"content-box":void 0,[i9]:c?p:"100%",[e9]:J7,[j7]:Y7,[X7]:q7}},void 0,m?this.renderNameInput():this.renderLinkButton(),d&&a()("div",{[$7]:{[e9]:"flex"}},void 0,a()(P7.Z,{canEdit:o,[S9]:n,[Q7]:{margin:0}})))}[U7](){const{[z7]:e}=this[A9];return a()(NR.Z,{isVisible:!0,animationStyle:{opacity:e[R9]?1:0},[M9]:()=>a()("div",{[$7]:{[e9]:J7,[j7]:Y7,[K7]:4}},void 0,a()(tt.ZP,{popupType:this[T9].device[W7]?nt.kQ.SlideUp:nt.kQ.Popup,[M9]:this.renderActionsPopup,renderOrigin:e=>c[P9](pn.Z,n()({icon:S.Z.dots},e)),[$7]:{[i9]:240},originGap:4}))})}renderLinkButton(){const{[L9]:e}=this[A9],t=e[V9](),i=e[s9]();if(t&&i)return a()(Eo.Z,{[$7]:{[i9]:"max-content",maxWidth:"100%",[H7]:4,...x.Z[G7]},innerStyle:{paddingLeft:4,paddingRight:4,[e9]:J7,[j7]:Y7,borderRadius:3},href:this.getHref(),onClick:this.handleNameButtonClick},void 0,this.renderIcon(!0),a()(I7,{actionButton:this[U7](),[S9]:t,[L9]:e,titleStyle:this[N7]()}))}renderNameInput(){const{[L9]:e}=this[A9],t=e[V9](),i=e[s9]();if(t&&i)return a()("div",{[$7]:{[e9]:J7,[j7]:Y7,[K7]:4,[H7]:4}},void 0,this.renderIcon(!1),a()(Lo.Z,{[S9]:t.getNameStore(),[$7]:{...this[N7](),[H7]:4},[O7]:!1,[_7]:!0,[L7]:!0,[A7]:!0,disableMobileActionBar:!1,disableComment:!0,placeholder:ne.default[F7](F9.titlePlaceholder),onEnter:this.handleNameBlur,onEsc:this.handleNameBlur,onClick:this.handleNameInputClick,disableShiftEnter:!0,pasteBehavior:"inline"}),this[U7]())}renderIcon(e){var t;const{[L9]:i}=this[A9],o=i[V9](),s=i[s9]();if(!o||!s)return;const r=o.getIcon(),n=Boolean((null===(t=o[o9]())||void 0===t?void 0:t.id)===s.id);return r?a()("div",{[$7]:{[t9]:"relative",[i9]:this[_9]()+2,height:this[_9]()+2,[H7]:4}},void 0,a()(Vo.Z,e?{[O7]:!0,bucket:V7,[S9]:o,icon:r,isEmptyPage:!1,[$7]:this[E7](),size:this[_9]()}:{[O7]:!1,bucket:V7,[S9]:o,icon:r,isEmptyPage:!1,[$7]:this[E7](),size:this[_9](),[Z7]:{recordTable:o.table,source:"inline_collection",[R7]:s.getType(),[B7]:o.id},onChange:this[l9]}),!n&&S.Z.pageLinkIndicator({[t9]:"absolute",[i9]:"50%",height:"50%",right:0,bottom:0,fill:"dark"===this[M7].mode?this[M7][D7]:"#3E3C38",stroke:"dark"===this[M7].mode?this[M7].sidebarBackground:"white",strokeWidth:"dark"===this[M7].mode?"1.85px":"1.5px"})):!n&&a()("div",{[$7]:{[i9]:20,[H7]:4}},void 0,S.Z.alias({[i9]:20}))}getHref(){const{[L9]:e}=this[A9],t=e[V9]();if(!t)return;const i=t[o9]();return i?(0,se.ZP)({[S9]:i,fullyQualified:!1,pageVisitSource:f.tY.Breadcrumb}):void 0}[N7](){return{fontWeight:x.Z.fontWeight.bold,fontSize:22}}[E7](){return{[i9]:this[_9](),height:this[_9](),[H7]:4}}[D9](e){return{[i9]:24,height:e?24:16,fill:this[M7].regularIconColor}}}N9.displayName="CollectionViewBlockSource";const G9=(0,P.injectIntl)(N9);var H9=i(37709),W9=i(80503),K9=i(31194),z9=i(12323);const U9=i(85).EB9,$9=i(85).D7I,Q9=i(85).BQ6,q9=i(85).IY7,X9=i(85).gGi,Y9=i(85).EMU,j9=i(85).xej,J9=i(85).GmX,eee=i(85).Au,tee=i(85).zrY,iee=i(85).Scd,oee=i(85).tLG,see=i(85).AEP,ree=i(85).J2Z,nee=i(85).XCs,lee=i(85).$Fm,aee=i(85).Omf,dee=i(85).bR0,hee=i(85).uzK,cee=i(85).ZvK,uee=i(85).MAy,pee=i(85).Wp_,mee=i(85).I7L,gee=i(85).Xte,vee=i(85).X_m,fee=i(85).q7Z,yee=i(85).EIp,wee=i(85).wgE,See=i(85).rMr,bee=i(85).iPt,kee=i(85)._vc,Cee=i(85).rSD,Tee=i(85).HxR,xee=i(85).Gm5,Iee=i(85).QQK,Pee=i(85).Gnd,Dee=i(85).QmD,Mee=i(85).P0R,Zee=i(85).P24,Bee=i(85).HGU,Ree=i(85).wfR,Eee=i(85).rwP;class Vee extends p.Z{constructor(){super(...arguments),this.storeTypes={[Eee]:v.default[Ree](void 0),headerRectStore:v.default[Ree](void 0),[Bee]:v.default[Ree](!1)},this.lastPlacement=void 0,this.justOpened=!1,this.renderMenu=e=>{const{[Zee]:t}=this[Mee];if(!this[Pee][Bee][Dee])return a()(_E.P,{[xee]:ee.HV.ViewSettings,[Zee]:t,[Tee]:t[Iee],fullHeight:e})},this[Cee]=e=>{(0,re.ZP)({event:e,[xee]:re.Af[kee],[bee]:()=>{const{[Zee]:e}=this[Mee];V[See]({[Tee]:e[Iee]})}})},this.captureMouseDown=e=>{(0,re.ZP)({event:e,[xee]:re.Af.EditorMouseDown,[bee]:()=>{K.clear(this[wee])}})},this.sidebarLayoutStore=this[yee]((()=>{const e=this[Mee][fee].rect[Dee],t=this[wee][gee][Dee][vee],i=e[vee]-z9.L,o=t-(e.top+z9.L);return{[mee]:o,moveUp:i}}))}willMountOrUpdate(e){const{[Zee]:t}=e,i=this.settingsOpen(),o=this[Pee][Eee][Dee];i&&!o&&this[Mee][fee].recompute();const s=this[Mee][fee].rect[Dee];if(i&&!o&&s){const e=this.getPlacement(s);this[Pee][Eee][pee](e),this.justOpened=!0,this.lastPlacement=e}else this.justOpened=!1;i||this[Pee][Eee][pee](void 0),this.justOpened&&(!t[uee][Dee]&&"popup"!==this[Pee][Eee][Dee]||Re.default[cee]())&&this[Pee][Bee][pee](!0)}didMountOrUpdate(){const{[Zee]:e}=this[Mee],{[Bee]:t}=this[Pee];if(t[Dee]){const i=e[hee]();if(i){const t=LR.R[dee](i);if(t){const i=u.findDOMNode(t);if(i){const t=i[aee](),o=this[wee][gee][Dee][vee]-t.bottom,s=t.top;(o<FE.j9||s<W9.Aj||e[lee][Dee])&&((0,de.Wr)(i,{edgeDist:0,animate:!1}),this[Mee][fee].recompute())}}}t[pee](!1)}}renderComponent(){const{[nee]:e,[Zee]:t}=this[Mee],i=this.settingsOpen(),o=this.lastPlacement,s=t[uee][Dee],r=t.viewIsFlushToTopbar(),l=this[ree](),d=("timeline"===l||"table"===l)&&r;if(o){if("sidebar"===o){const t=this.sidebarLayoutStore[Dee];if(!t)return;const{[mee]:o,moveUp:r}=t;return a()(NR.Z,{isVisible:i,enterAnimationStyle:{[see]:0,translateX:12},animationStyle:{[see]:1,translateX:0},exitAnimationStyle:{[see]:0,translateX:12},springConfig:Aee,render:()=>a()(jV.Z,{capture:i,allowMobileAutoScroll:!0,allowUndo:!0,render:t=>c[$9]("div",n()({[Q9]:{position:oee,top:(d?1:0)-r,right:-e,[vee]:`calc(100% + ${r}px)`,[iee]:this[Mee][lee]?this[eee][tee]:this[eee][J9],borderLeft:`1px solid ${this[eee][j9]}`,[nee]:e,zIndex:I.collectionSettings,...s&&{[vee]:o},...!s&&{[mee]:o}},className:X.viewSettingsSidebar},(0,je.Z)({onMouseDown:this.captureMouseDown},t)),a()("div",{[Q9]:{display:Y9,[vee]:X9}},void 0,a()("div",{[Q9]:{[q9]:`0 -1px 0 ${this[eee][j9]}`}},void 0,this.renderMenu(!0)),a()("div",{[Q9]:{width:e}})))})})}return a()(nt.ZP,{popupType:this[wee].device.isMobile?nt.kQ.SlideUp:nt.kQ.Popup,open:i,placementToOrigin:K9.Iw.Bottom,alignmentToOrigin:K9.lU.End,[Q9]:{marginTop:-1},origin:a()("div",{}),render:this.renderMenu,onDismiss:this[Cee],originRect:this[Mee][fee].rect[Dee]})}}settingsOpen(){const{[Zee]:e}=this[Mee],t=e[Iee][Dee];return t.open&&!0!==t.hideSettingsPopup}getPlacement(e){const{[Zee]:t}=this[Mee];if(!this.settingsOpen())return;const i=(null==e?void 0:e.width)||0;return this[wee].device.isMobile||Re.default[cee]()||!(t[uee][Dee]||i>600)?"popup":"sidebar"}[ree](){var e;const{[Zee]:t}=this[Mee],i=null===(e=t.collectionViewStore())||void 0===e?void 0:e.getType();if(!i)throw new Error(U9);return i}}Vee.displayName="CollectionViewSettingsPopup";const Aee={translateX:{stiffness:120,damping:12,precision:.1},[see]:{stiffness:120,damping:10,precision:.001}},Lee=(0,P.injectIntl)(Vee),_ee=i(85).Omf,Oee=i(85).BQ6;let Fee;class Nee{constructor(e){this[Oee]=void 0,this.lastResult=void 0,this[Oee]=e[Oee]}measure(e){var t;if(e===(null===(t=this.lastResult)||void 0===t?void 0:t.text))return this.lastResult.rect;Fee||(Fee=document.createElement("div"),Fee[Oee].position="absolute",Fee[Oee].left="0",Fee[Oee].top="0",Fee[Oee].pointerEvents="none",Fee[Oee].opacity="0",document.body.appendChild(Fee)),h().forOwn(this[Oee],((e,t)=>{Fee&&(Fee[Oee][t]=e)})),Fee.textContent=e;const i=Fee[_ee]();return this.lastResult={text:e,rect:i},i}}var Gee=i(1136),Hee=i(29798),Wee=i(13401),Kee=i(73657);const zee=i(85).jtM,Uee=i(85).apZ,$ee=i(85).MvG,Qee=i(85).zaB,qee=i(85).U9S,Xee=i(85).QQK,Yee=i(85).HxR,jee=i(85).rER,Jee=i(85).$Fm,ete=i(85).I8n,tte=i(85).MAy,ite=i(85).QLQ,ote=i(85).q9g,ste=i(85).wgE,rte=i(85).jQT,nte=i(85).X5t,lte=i(85).Tuj,ate=i(85).nx5,dte=i(85).mSd,hte=i(85).uzK,cte=i(85).qU4,ute=i(85).P24,pte=i(85).D7I,mte=i(85).rpY;class gte extends p.Z{renderComponent(){const e=this.getMenuSections();return a()(ot.Z,{type:ot.i.Vertical,initialFocus:void 0,sections:d.compact(e.map(((e,t)=>{if(e.length>0)return{key:t,[mte]:e=>c[pte](lt.Z,n()({},e,{topBorder:0!==t})),items:e}})))})}getMenuSections(){const{onClose:e,[ute]:t,[cte]:i,intl:o}=this.props,s=t.permissionScopes.state,r=t[cte](),l=t[hte]();if(!r||!l)return[];const d=r.id===i.id,h=i.getAppConfigUri(),u=!(0,Wp.isDefined)(h)||!(0,q.xB)(h),p=[];if(p.push([]),s[dte]){if(p[0].push({key:"rename",[mte]:e=>a()(at.Z,{placement:at.Z.Placement.Left,disableTooltip:u,[mte]:t=>c[pte](et.Z,n()({},e,{disabled:!u,disabledFeedback:!0,title:a()(P.FormattedMessage,{[ate]:"Rename",id:"database.viewSettings.viewActionMenu.rename"}),icon:S.Z.rename(this[lte](!1))},t)),renderTooltip:()=>a()(P.FormattedMessage,{id:"database.viewSettings.viewActionMenu.cannotRename",[ate]:"This view can’t be renamed."})}),[nte]:()=>{R[rte]({[ste]:this[ste],[ute]:t,[nte]:"view_action_menu_rename"}),null==e||e(!0),d||L[ote]({[ste]:this[ste],[ute]:t,[ite]:i.id,[tte]:t[tte].state,[ete]:t[ete].state,[Jee]:t[Jee].state}),V[jee]({[ute]:t,[Yee]:t[Xee],selectViewNameInitial:!0})}}),"page"===i.getType())return p;p[0].push({key:"edit",[mte]:e=>c[pte](et.Z,n()({},e,{title:a()(P.FormattedMessage,{[ate]:"Edit view",id:"database.viewSettings.viewActionMenu.editView"}),icon:S.Z.options(this[lte](!1))})),[nte]:()=>{R[rte]({[ste]:this[ste],[ute]:t,[nte]:"view_action_menu_edit"}),null==e||e(!0),d||L[ote]({[ste]:this[ste],[ute]:t,[ite]:i.id,[tte]:t[tte].state,[ete]:t[ete].state,[Jee]:t[Jee].state}),V[jee]({[ute]:t,[Yee]:t[Xee]})}})}p.push([]),p[1].push({key:"copyLink",[mte]:e=>c[pte](et.Z,n()({},e,{title:a()(P.FormattedMessage,{[ate]:"Copy link to view",id:"database.viewSettings.viewActionMenu.copyLink"}),icon:S.Z.link(this[lte](!1))})),[nte]:async()=>{R[rte]({[ste]:this[ste],[ute]:t,[nte]:"view_action_menu_copy_link"}),await V.handleCopyLinkToCollectionView({[ste]:this[ste],[ute]:t,[cte]:i}),null==e||e(!1)}});return i.getFormat()[qee]&&s[dte]&&p[1].push({key:"showDatabaseTitle",[mte]:e=>c[pte](et.Z,n()({},e,{title:a()(P.FormattedMessage,{[ate]:"Show database title",id:"database.viewSettings.viewActionMenu.showDatabaseTitle"}),icon:S.Z.eyePadded(this[lte](!0))})),[nte]:()=>{R[rte]({[ste]:this[ste],[ute]:t,[nte]:"click_source_show_title"}),z.createAndCommit({userAction:"CollectionViewActionMenu.getMenuSections",[ste]:this[ste],perform:e=>{Ne.updateFormat({stores:[i],update:{[qee]:!1},transaction:e})}}),null==e||e(!1)}}),p.push([]),s[dte]&&p[2].push({key:Qee,[mte]:e=>c[pte](et.Z,n()({},e,{title:a()(P.FormattedMessage,{[ate]:"Duplicate",id:"database.viewSettings.viewActionMenu.duplicate"}),icon:S.Z[Qee](this[lte](!1))})),[nte]:()=>{R[rte]({[ste]:this[ste],[ute]:t,[nte]:"view_action_menu_duplicate"}),V.handleDuplicateCollectionView({[ste]:this[ste],[ute]:t,[cte]:i,[Yee]:t[Xee],intl:o}),null==e||e(!0)}}),s[dte]&&p[2].push({key:"delete",[mte]:e=>c[pte](et.Z,n()({},e,{title:a()(P.FormattedMessage,{[ate]:"Delete",id:"database.viewSettings.viewActionMenu.delete"}),icon:S.Z.trash(this[lte](!1))})),[nte]:async()=>{R[rte]({[ste]:this[ste],[ute]:t,[nte]:"view_action_menu_delete"});await V.handleDeleteCollectionView({[ste]:this[ste],[ute]:t,[cte]:i,[Yee]:t[Xee],from:"view_action_menu"})&&(null==e||e(!1))}}),l[$ee]()&&p.push([{key:"edit settings",[mte]:e=>c[pte](et.Z,n()({},e,{icon:S.Z.options(this[lte](!1)),title:a()(P.FormattedMessage,{[ate]:"Edit {databaseName} settings",id:"CollectionViewActionMenu.editSettings",values:{[Uee]:a()(BT.Z,{store:l,style:{display:zee}})}})})),[nte]:()=>{V.openCollectionViewBlockSettings({[ste]:this[ste],store:l}),null==e||e(!0)}}]),p}[lte](e){return{width:24,height:e?24:16,fill:this.theme.regularIconColor}}}gte.displayName="CollectionViewActionMenu";const vte=(0,P.injectIntl)(gte),fte=i(85).mSd,yte=i(85).rQ1,wte=i(85).P24,Ste=i(85).YDe,bte=i(85).lzz,kte=i(85).iIv,Cte=i(85).D7I,Tte=i(85).rSD,xte=i(85).P0R,Ite=i(85).Ie8,Pte=i(85).ceT,Dte=i(85).dLQ,Mte=i(85).wgE,Zte=i(85).ToB,Bte=i(85).LtW;class Rte extends p.Z{constructor(){super(...arguments),this.storeTypes={[Bte]:ve.Z},this[Zte]=()=>{const{device:e}=this[Mte];let t;return t=e[Dte]?{[Pte]:Ye.og[Ite]}:{[Pte]:Ye.og.Popup,width:220},c[Cte](it.Z,t,c[Cte](vte,n()({},this[xte],{[kte]:this[Tte]})))},this[Tte]=e=>{this.stores[Bte].setState({open:!1}),e&&this[xte][kte]()}}renderComponent(){const{collectionViewStore:e,menuListItemProps:t}=this[xte],i=e.getName(),o=e.getType(),s=e.getFormat()[bte];if(void 0!==o)return c[Cte](et.Z,n()({title:a()(ZB.Z,{[Ste]:o,collectionViewName:i}),icon:a()(Gee.F,{color:"regular",viewIcon:s,viewType:o}),showDragHandle:this.showDragHandle(),right:this.renderActionsPopup(),rightStyle:{marginRight:8}},t))}renderActionsPopup(){const{device:e}=this[Mte],{[Bte]:t}=this.stores,{[wte]:i}=this[xte];if(i[yte].state[fte])return a()(tt.ZP,{popupType:e[Dte]?tt.Z4.SlideUp:tt.Z4.Popup,renderOrigin:e=>c[Cte](pn.Z,n()({icon:S.Z.dots},e)),render:this[Zte],[Bte]:t})}showDragHandle(){const{[wte]:e}=this[xte],t=e[yte].state,{device:i}=this[Mte];return!i[Dte]&&t[fte]}}Rte.displayName="CollectionViewSelectItem";const Ete=(0,P.injectIntl)(Rte),Vte=i(85).Mm1,Ate=i(85).g7N,Lte=i(85).nLZ,_te=i(85).Yzm,Ote=i(85).dLQ,Fte=i(85).GGR,Nte=i(85).D7I,Gte=i(85).lzz,Hte=i(85).$Fm,Wte=i(85).MAy,Kte=i(85).P24,zte=i(85).OgC,Ute=i(85).wgE,$te=i(85).SDR,Qte=i(85).TtP,qte=i(85).uzK,Xte=i(85).GiO,Yte=i(85).nx5,jte=i(85).jb8,Jte=(0,P.defineMessages)({[jte]:{[Yte]:"Suggested",id:"database.collectionViewSuggestedViews.suggestedTitle"}});function eie(e,t){const i=(0,qn.O7)(),o=(0,Xn.VK)((()=>ge.default.state[Xte]),[]),s=(0,Xn.VK)((()=>e[qte]()),[e]),r=(0,Xn.VK)((()=>e.collectionStore()),[e]),l=(0,Xn.VK)((()=>{var e;if(!r)return;const t=null===(e=r.getFormat())||void 0===e?void 0:e.app_config_uri;return t?(0,q.vi)(t):void 0}),[r]),d=c.useCallback((r=>{if(!s||!l||!o)return;const n=s.getParentStore();if(!n||"block"!==n.table&&"space"!==n.table&&"team"!==n.table)return;if(1!==r[$te][Qte])return;const a=r[$te][0];z.createAndCommit({userAction:"CollectionViewSuggestedViews.createView",[Ute]:i,perform:d=>{var h;Z.applyFeatures({[Ute]:i,spaceViewStore:o,appParentStore:n,appUri:l.uri,features:[{type:"simple",featureUri:r.uri}],[zte]:[s],createOrModify:"modify",transaction:d});const c=((null===(h=s.getFormat())||void 0===h?void 0:h.app_uri_map)??{})[a.uri];L.setCurrentView({[Ute]:i,[Kte]:e,collectionViewId:c,[Wte]:e[Wte].state,isRootChild:e.isRootChild.state,[Hte]:e[Hte].state}),t()}}),R.trackCreateView({[Ute]:i,[Kte]:e,view_type:a.value.type,view_config_uri:r.uri})}),[s,l,o,i,e,t]);return{renderSuggestedView:c.useCallback((e=>({key:e.uri,render:t=>a()(at.Z,{placement:at.Z.Placement.Left,render:i=>((e,t)=>{var i;const o=e[$te][0],s=a()(Gee.F,{color:"regular",viewIcon:null===(i=o.value.format)||void 0===i?void 0:i[Gte],viewType:o.value.type});return c[Nte](et.Z,n()({title:o.value.name?o.value.name:"New View",icon:s},t))})(e,{...t,...i,[Fte]:e=>{var o,s;null===(o=i[Fte])||void 0===o||o.call(i,e),null===(s=t[Fte])||void 0===s||s.call(t,e)}}),renderTooltip:()=>e.description}),action:()=>{d(e)}})),[d])}}function tie(e){window.__c={n:"CollectionViewSuggestedViews"};const t=(0,qn.O7)().device,i=(0,Yn.yK)((e=>({showMoreLabel:{color:e.mediumTextColor}})),[]),o=e.suggestedViews,{renderSuggestedView:s}=eie(e[Kte],e.onClose),[r,l]=(0,c.useState)(!1),{[Kte]:d,onClose:h,onNewEmptyViewClick:u}=e,p=(0,Xn.VK)((()=>d.permissionScopes.state),[d]),m=(null==o?void 0:o.map((e=>s(e))))??[],g={key:"showMore",render:e=>c[Nte](et.Z,n()({},e,{style:i.showMoreLabel,title:a()(P.FormattedMessage,{[Yte]:"Show more...",id:"collectionViewSuggestedViews.showMore.label"})})),action:()=>{l(!0)}},v=a()(ot.Z,{type:ot.i.Vertical,initialFocus:0,sections:[{key:"suggested_views",render:e=>c[Nte](lt.Z,e),items:r||m[Qte]<=5?m:[...m.slice(0,5),g]}]}),f=p.canConfigureBlock&&a()(lt.Z,{topBorder:!0},void 0,a()(Wee.Z,{title:a()(P.FormattedMessage,{[Yte]:"New empty view",id:"database.collectionViewSuggestedViews.newEmptyViewTitle"}),onClick:()=>{u("CollectionViewSuggestedViews2.handleNewEmptyViewClick"),h()},focused:!1}));return a()(jV.Z,{capture:!0,allowEsc:!0,render:e=>{let i;return i=t[Ote]?{menuType:Ye.og.Modal,title:ne.default[_te](Jte[jte]),right:a()(st.DoneMenuText,{}),onClickRight:h,...e}:{menuType:Ye.og.Popup,minWidth:290,maxWidth:320,maxHeight:"50vh",...e},c[Nte](it.Z,i,m[Qte]&&a()(lt.Z,{title:!t[Ote]&&ne.default[_te](Jte[jte]),disableMobilePadding:!0,topBorder:!1,desktopTitleStyle:{[Lte]:2,[Ate]:2},style:{[Vte]:0}},void 0,v),f)}})}const iie=i(85).$Fm,oie=i(85).MAy,sie=i(85).yHv,rie=i(85).irQ,nie=i(85).cZW,lie=i(85).Yzm,aie=i(85).PXg,die=i(85).XNW,hie=i(85).g7N,cie=i(85).nLZ,uie=i(85).Er,pie=i(85).ccq,mie=i(85).TtP,gie=i(85).mSd,vie=i(85).dLQ,fie=i(85).nx5,yie=i(85).kau,wie=i(85).rQ1,Sie=i(85).pek,bie=i(85).VFs,kie=i(85).iB2,Cie=i(85).QmD,Tie=i(85).Wp_,xie=i(85).Gnd,Iie=i(85).LCr,Pie=i(85).wgE,Die=i(85).Drs,Mie=i(85).JJj,Zie=i(85).uzK,Bie=i(85).q9g,Rie=i(85).u$q,Eie=i(85).qU4,Vie=i(85).P0R,Aie=i(85).iIv,Lie=i(85).P24,_ie=i(85).GCx,Oie=i(85).Ek1,Fie=i(85).rGB,Nie=i(85).TVJ,Gie=i(85).pN4,Hie=i(85).D7I,Wie=i(85).wfR,Kie=i(85).FwR,zie=i(85).P0G;class Uie extends p.Z{constructor(){super(...arguments),this.initialMenuListFocus=0,this.storeTypes={[zie]:Hee.Z,[Kie]:v.default[Wie]("")},this.renderViewsSection=e=>{if(this.isDraggable()){const t=this[Gie]().map((e=>e.id));return c[Hie](lt.Z,n()({},e,{[Fie]:a()(xk.ZP,{[_ie]:Nie,keys:t,renderKey:i=>e[Fie][t[Oie](i)],onDrop:this.handleViewsDrop})}))}return c[Hie](lt.Z,e)},this.renderViewMenuItem=(e,t)=>{const{[Lie]:i,[Aie]:o}=this[Vie];return a()(Ete,{[Lie]:i,[Eie]:e,[Aie]:o,menuListItemProps:t})},this.handleViewClick=(e,t)=>{const i=this[Vie][Lie][Eie]();i&&this[Vie].onViewClick({[Rie]:i,newCollectionViewStore:e,openInNew:t}),this[Bie](e,t),t||this[Vie][Aie]()},this.handleCreateButtonClick=()=>{this[Vie].onAddViewClick("CollectionViewSelect2.handleCreateButtonClick"),this[Vie][Aie]()},this.handleViewsDrop=e=>{const{[Lie]:t}=this[Vie],i=t[Zie]();i&&(z[Mie]({[Die]:"CollectionViewSelect2.handleViewsDrop",[Pie]:this[Pie],perform:t=>{L.reorderCollectionViews({[Zie]:i,newViewIds:e,[Iie]:t})}}),this[xie][zie].reset())},this.handleViewFilterQueryChange=e=>{this[xie][Kie][Tie](e.target.value),this[xie][zie][Tie]({...this[xie][zie][Cie],focus:{section:0,[kie]:0,[bie]:0}})},this.filterView=e=>(0,ie.filterCollectionView)(e,this[xie][Kie][Cie])}willMount(e){var t,i;const{[Lie]:o}=e,s=null===(t=o[Eie]())||void 0===t?void 0:t.id,r=((null===(i=o[Zie]())||void 0===i?void 0:i[Sie]())||[]).findIndex((e=>e.id===s));r>=0&&(this.initialMenuListFocus=r),this[xie][Kie][Tie]("")}renderComponent(){const{intl:e,[Lie]:t,[Aie]:i,onAddViewClick:o}=this[Vie],{device:s}=this[Pie],r=t[wie][Cie],l=a()(Wee.Z,{title:a()(P.FormattedMessage,{[fie]:"Add view",id:yie}),onClick:this.handleCreateButtonClick,focused:!1});return a()(jV.Z,{capture:!0,allowEsc:!0,render:d=>{var h,u;let p;p=s[vie]?{menuType:Ye.og.Modal,title:this.renderMenuTitle(),right:a()(st.DoneMenuText,{}),onClickRight:this[Vie][Aie],...d}:{menuType:Ye.og.Popup,minWidth:290,maxWidth:320,maxHeight:"50vh",...d};const m=r[gie]&&a()(lt.Z,{topBorder:!0},void 0,this[Vie].suggestedViews&&this[Vie].suggestedViews[mie]?a()(tt.ZP,{popupType:this[Pie].device[vie]?nt.kQ.SlideUp:nt.kQ.Popup,alignmentToOrigin:tt.vR.Center,[pie]:tt.pO.Right,renderOrigin:e=>c[Hie](Wee.Z,n()({title:a()(P.FormattedMessage,{[fie]:"Add view",id:"database.collectionViewSelect.addViewButtonTitle"}),focused:!1},e)),render:()=>a()(tie,{[Lie]:t,suggestedViews:this[Vie].suggestedViews??[],[Aie]:i,onNewEmptyViewClick:o})}):l);return c[Hie](it.Z,n()({},p,{header:!s[vie]&&!(null!==(h=t[Zie]())&&void 0!==h&&h[uie]())&&a()(hu.ZP,{value:this[xie][Kie][Cie],focus:!0,style:{[cie]:8,[hie]:4},textWrapperStyle:{[die]:8,[aie]:8},onChange:this.handleViewFilterQueryChange,[nie]:e[lie]({[fie]:"Search for a view...",id:"collectionViewSelect.viewSearch.label"})}),footer:!s[vie]&&m}),a()(lt.Z,{title:!s[vie]&&!(null!==(u=t[Zie]())&&void 0!==u&&u[uie])&&this.renderMenuTitle(),disableMobilePadding:!0,topBorder:!1,desktopTitleStyle:{[cie]:0,[hie]:0}},void 0,this.renderMenuList()),this[xie][Kie][Cie]&&0===this[Gie]()[mie]&&a()(Kee.Z,{caption:a()(P.FormattedMessage,{[fie]:"No results",id:"database.collectionViewSelect.noResultsTitle"})}),s[vie]&&m)}})}renderMenuList(){const e=this[Gie]();if(e[mie]>0)return a()(ot.Z,{type:ot.i.Vertical,initialFocus:this.initialMenuListFocus,sections:[{key:"views",render:this.renderViewsSection,items:e.map((e=>({key:e.id,render:t=>this.renderViewMenuItem(e,t),action:t=>{let{event:i}=t;this.handleViewClick(e,oe[rie](i))}})))}],store:this[xie][zie]})}renderMenuTitle(){return a()(P.FormattedMessage,{[fie]:"{numberOfViews, plural, one {{numberOfViews} view} other {{numberOfViews} views}}",id:"database.mobileSelectViewMenu.title",values:{numberOfViews:this[sie]()[mie]}})}[Bie](e,t){L[Bie]({[Pie]:this[Pie],[Lie]:this[Vie][Lie],collectionViewId:e.id,openInNew:t,[oie]:this[Vie][oie],isRootChild:this[Vie].isRootChild,[iie]:this[Vie][iie]}),R.trackConfigureView({[Pie]:this[Pie],[Lie]:this[Vie][Lie],action:"click_view_in_dropdown",new_view_type:e.getType(),new_view_id:e.id})}[sie](){var e;const{[Lie]:t}=this[Vie];return(null===(e=t[Zie]())||void 0===e?void 0:e[Sie]())||[]}[Gie](){return this[sie]().filter(this.filterView)}isDraggable(){return this.showDragHandle()&&""===this[xie][Kie][Cie]}showDragHandle(){const{[Lie]:e}=this[Vie],t=e[wie][Cie],{device:i}=this[Pie];return!i[vie]&&t[gie]}}Uie.displayName="CollectionViewSelect";const $ie=(0,P.injectIntl)(Uie);var Qie=i(14976),qie=i(26991);const Xie=i(85).QQK,Yie=i(85).nx5,jie=i(85).mPB,Jie=i(85).FH8,eoe=i(85).S6b,toe=i(85).YDe,ioe=i(85).kk0,ooe=i(85).$Fm,soe=i(85).MAy,roe=i(85).nLZ,noe=i(85).Uie,loe=i(85).BQ6,aoe=i(85).kwI,doe=i(85).PXg,hoe=i(85).cJC,coe=i(85).fsm,uoe=i(85).wuN,poe=i(85).ChN,moe=i(85).Exd,goe=i(85)._V5,voe=i(85).Au,foe=i(85)._Fe,yoe=i(85).GPw,woe=i(85).jkI,Soe=i(85).H1U,boe=i(85).EMU,koe=i(85).sM5,Coe=i(85).$9E,Toe=i(85).tDk,xoe=i(85).gRm,Ioe=i(85).uzK,Poe=i(85).Scd,Doe=i(85).SjN,Moe=i(85).QmD,Zoe=i(85).qLW,Boe=i(85).lzz,Roe=i(85).G3i,Eoe=i(85).U66,Voe=i(85).YGn,Aoe=i(85).I7D,Loe=i(85).QSf,_oe=i(85).jQT,Ooe=i(85).q9g,Foe=i(85).Gnd,Noe=i(85).Wp_,Goe=i(85).u$q,Hoe=i(85).irQ,Woe=i(85).P24,Koe=i(85).qU4,zoe=i(85).b8T,Uoe=i(85).D7I,$oe=i(85).P0R,Qoe=i(85).rSD,qoe=i(85).iVN,Xoe=i(85).ceT,Yoe=i(85).wgE,joe=i(85).wfR;class Joe extends p.Z{constructor(){super(...arguments),this.storeTypes={popupOpen:v.default[joe](!1)},this.renderPopup=()=>{const{device:e}=this[Yoe];let t;return t=e.isPhone?{[Xoe]:Ye.og.Modal,right:a()(st.DoneMenuText,{}),[qoe]:this[Qoe]}:{[Xoe]:Ye.og.Popup,minWidth:220},c[Uoe](it.Z,t,c[Uoe](vte,n()({},this[$oe],{onClose:this[Qoe]})))},this[zoe]=e=>{const{[Koe]:t,[Woe]:i}=this[$oe],o=i[Koe]();if(!o)return;const s=oe[Hoe](e);this[$oe].onViewClick({[Goe]:o,newCollectionViewStore:t,openInNew:s}),o.id===t.id?this[Foe].popupOpen[Noe](!0):this[Ooe](t.id,s),R[_oe]({[Yoe]:this[Yoe],[Woe]:i,action:"click_view_tab",new_view_type:t[Loe](),new_view_id:t.id})},this[Aoe]=e=>{e[Voe](),(0,re.ZP)({event:e,context:re.Af.EditorContextMenu,callback:()=>{this[Foe].popupOpen[Noe](!0)}})},this[Qoe]=()=>{this[Foe].popupOpen[Noe](!1)}}renderComponent(){var e,t,i;const{[Koe]:o,[Woe]:s}=this[$oe],{popupOpen:r}=this[Foe],{device:l}=this[Yoe],d=(0,c.createRef)(),h=this[Eoe]();if(!o[Roe]()||!h)return;const u=o[Loe](),p=o[Zoe]()[Boe],m=h.id===o.id,g=(null===(e=s[Doe][Moe])||void 0===e?void 0:e[Poe])||"none",v=s[Ioe]();if(!v)return c[Uoe](c.Fragment,null);const f=v.getSpaceId()!==(null===(t=ge.default[Moe].currentSpaceStore)||void 0===t?void 0:t.id),w=o[Zoe]()[xoe]===y.g3&&(0,q.wY)()&&"sprint_board"===(null===(i=ge.default[Moe][Toe])||void 0===i?void 0:i[Zoe]()[Coe])&&!f;return a()(nt.ZP,{popupType:l.isMobile?nt.kQ.SlideUp:nt.kQ.Popup,alignmentToOrigin:nt.ZP.Alignment.Start,open:r[Moe],render:this.renderPopup,onDismiss:this[Qoe],origin:a()("div",{className:X.collectionViewTabButton,[loe]:{[koe]:boe,[Soe]:woe,[Poe]:g,height:"100%",...m&&{[yoe]:`2px solid ${this[voe][foe]}`,[goe]:2}},onContextMenu:this[Aoe]},void 0,w&&a()(Zo.FF,{origin:d}),a()(ese,{[Koe]:o,render:e=>c[Uoe](rt.Z,n()({"aria-selected":m,role:"tab",ref:d,key:o.id,[loe]:{[koe]:boe,[Soe]:woe,[moe]:14,[poe]:x.Z[poe].medium,color:m?this[voe][foe]:this[voe][uoe],[coe]:yre},hovered:r[Moe],onClick:this[zoe]},e),a()(Gee.F,{color:m?"regular":hoe,viewIcon:p,[aoe]:u,[loe]:{[doe]:6}}),a()("span",{[loe]:{...x.Z[noe],[roe]:1}},void 0,a()(tse,{[Woe]:s,[Koe]:o})))}))})}[Ooe](e,t){const{[Woe]:i}=this[$oe];L[Ooe]({[Yoe]:this[Yoe],[Woe]:i,collectionViewId:e,openInNew:t,[soe]:i[soe][Moe],isRootChild:i.isRootChild[Moe],[ooe]:i[ooe][Moe]})}[Eoe](){return this[$oe][Woe][Koe]()}}function ese(e){window.__c={n:"CollectionViewTabTooltip"};const t=(0,Yn.Fg)(),i=(0,P.useIntl)(),{[Koe]:o,render:s}=e,r=(0,Xn.VK)((()=>o[ioe]()),[o]),n=(0,Xn.VK)((()=>null==r?void 0:r.getModel()),[r]),l=(0,Xn.VK)((()=>o.getModel()),[o]);return l?a()(at.Z,{placement:at.Z.Placement.Bottom,alignment:at.Z.Alignment.Start,delayThreshold:800,render:s,renderTooltip:()=>c[Uoe](c.Fragment,null,a()("div",{},void 0,(0,ie.getRenderedViewName)({collectionViewName:l.getName(),[toe]:l[Loe]()})),r&&n&&a()("div",{[loe]:{color:t[eoe]}},void 0,a()(P.FormattedMessage,{[Yie]:"{viewType, select, Table {Table view of {collection}} Board {Board view of {collection}} Timeline {Timeline view of {collection}} Calendar {Calendar view of {collection}} List {List view of {collection}} Gallery {Gallery view of {collection}} other {collection}}",id:"collectionTabBar.viewTab.tooltip",values:{[aoe]:ai.Bh[l[Loe]()],[Jie]:(0,Qie.renderTextAsString)(r.getName(),r)||n[jie]({intl:i})}})))}):null}function tse(e){window.__c={n:"CollectionViewTabTitle"};const{[Koe]:t,[Woe]:i}=e,[o,s]=(0,Xn.VK)((()=>{const e=i[Xie][Moe];return[e.open,h().last(e.stack)]}),[i[Xie]]),r=(0,Xn.VK)((()=>i[Koe]()),[i]),n=(0,Xn.VK)((()=>t[ioe]()),[t]),l=(0,Xn.VK)((()=>{if(t[Roe]()){return(null==t?void 0:t.getFormatStore().getKeyStore(xoe).getValue())===y.g3&&null!=n&&n[Roe]()?{name:(0,qie.fz)(i,t,n.getSchema()),type:t[Loe]()}:{name:t.getName(),type:t[Loe]()}}}),[t,n,i]);return!l||r&&r.id===t.id&&o&&s&&("duplicateExistingView"===s.type||"createViewSource"===s.type||"createView"===s.type)?a()(P.FormattedMessage,{[Yie]:"New view",id:"collectionTabBar.newViewPlaceholder.title"}):a()(ZB.Z,{collectionViewName:l.name,[toe]:l.type})}Joe.displayName="CollectionViewTab";const ise=(0,P.injectIntl)(Joe);var ose=i(78454);const sse=i(85).nx5;function rse(e){window.__c={n:"WikiHomeOnboardingTooltip"};const{origin:t}=e,i=(0,qn.O7)();return a()(pW.U,{origin:t,placementToOrigin:"bottom",header:a()(P.FormattedMessage,{id:"WikiHomeOnboardingTooltip.header",[sse]:"Welcome to your new wiki!"}),content:a()(P.FormattedMessage,{[sse]:"Viewers will have the same reading experience as before, but editors have new features to keep content up to date",id:"WikiHomeOnboardingTooltip.content"}),onCloseClick:()=>{aF.Rg(i)},shouldDismissUponOutsideClick:!0,pointerPosition:"18%",pointerLength:vW.EZ,pointerOffset:vW.rK,style:{width:vW.G5}})}const nse=i(85).ChN,lse=i(85).nx5;function ase(e){window.__c={n:"WikiViewsOnboardingTooltip"};const{origin:t}=e,i=(0,qn.O7)();return a()(pW.U,{origin:t,placementToOrigin:"right",header:a()(P.FormattedMessage,{id:"WikiViewsOnboardingTooltip.header",[lse]:"New views"}),content:a()(P.FormattedMessage,{[lse]:"The <bold>All pages</bold> and <bold>Pages I own</bold> views will give you an overview of pages in your wiki",id:"WikiViewsOnboardingTooltip.content",values:{bold:e=>a()("span",{style:{[nse]:x.Z[nse].semibold}},void 0,e)}}),onCloseClick:()=>{aF.Rg(i)},pointerPosition:"50%",pointerLength:vW.EZ,pointerOffset:vW.FD,shouldDismissUponOutsideClick:!0,style:{width:vW.G5}})}const dse=i(85).pek,hse=i(85).XG6,cse=i(85).u9,use=i(85).XGW,pse=i(85).mSd,mse=i(85).rQ1,gse=i(85).nx5,vse=i(85).wuN,fse=i(85).a3v,yse=i(85).nLZ,wse=i(85).Uie,Sse=i(85).PXg,bse=i(85).Au,kse=i(85)._Fe,Cse=i(85).ChN,Tse=i(85).Y9u,xse=i(85).Exd,Ise=i(85).lzz,Pse=i(85).U66,Dse=i(85).BQ6,Mse=i(85).lGm,Zse=i(85).rpY,Bse=i(85).jkI,Rse=i(85).H1U,Ese=i(85).EMU,Vse=i(85).sM5,Ase=i(85).JrN,Lse=i(85).FEr,_se=i(85).cjE,Ose=i(85).soi,Fse=i(85).Er,Nse=i(85).TtP,Gse=i(85).yHv,Hse=i(85).TN,Wse=i(85).EIp,Kse=i(85).LKA,zse=i(85).jQT,Use=i(85).LCr,$se=i(85).nxU,Qse=i(85).Drs,qse=i(85).JJj,Xse=i(85).uzK,Yse=i(85).qU4,jse=i(85).tBn,Jse=i(85).D7I,ere=i(85).iIv,tre=i(85).N1Z,ire=i(85).Ar,ore=i(85).dLQ,sre=i(85).qLW,rre=i(85).gRm,nre=i(85).oWD,lre=i(85).$Fm,are=i(85).I8n,dre=i(85).MAy,hre=i(85).QmD,cre=i(85).wgE,ure=i(85).E0z,pre=i(85).P0R,mre=i(85).P24,gre=i(85).LtW,vre=i(85).Dv6,fre=i(85).rpW,yre=220;class wre extends p.Z{constructor(){super(...arguments),this[fre]=new Ae.E({throttleMs:200}),this.viewIdWidthEstimatorMap=new Map,this.homeViewRef=c[vre](),this.viewsDropdownRef=c[vre](),this.storeTypes={[gre]:ve.Z},this.renderViewsPopup=(e,t)=>{var i;const{[mre]:o}=this[pre],{[ure]:s}=this[cre],r=o[dre][hre],n=o[are][hre],l=o[lre][hre],d=(null===(i=o[nre]())||void 0===i?void 0:i[sre]()[rre])===y.GZ;return c[Jse](c[jse],null,!s[ore]&&"views"===aF.B1()&&d&&a()(ase,{origin:this.viewsDropdownRef}),c[Jse]("div",{ref:this.viewsDropdownRef},a()($ie,{[mre]:o,onAddViewClick:this[ire],suggestedViews:t,[ere]:e[tre],[dre]:r,[are]:n,[lre]:l,onViewClick:this[pre].onViewClick})))},this.renderViewTab=e=>{const{[mre]:t,onViewClick:i}=this[pre];return a()(ise,{[mre]:t,[Yse]:e,onViewClick:i})},this.handleViewSelectContainerMount=e=>{e&&this[fre].observe(e)},this.handleViewTabsDrop=e=>{const{[mre]:t}=this[pre],i=t[Xse]();i&&z[qse]({[Qse]:"CollectionViewTabBar.handleViewTabsDrop",[cre]:this[cre],[$se]:t=>{L.reorderCollectionViews({[Xse]:i,newViewIds:e,[Use]:t})}})},this.renderSuggestedViewsPopup=(e,t)=>{const{[mre]:i}=this[pre];return a()(tie,{[mre]:i,suggestedViews:t,[ere]:e[tre],onNewEmptyViewClick:this[ire]})},this[ire]=e=>{const{[mre]:t}=this[pre];z[qse]({[Qse]:e,[cre]:this[cre],[$se]:e=>{L.createAndFocusCollectionView({[cre]:this[cre],[mre]:t,[Use]:e})}}),R.trackCreateView({[cre]:this[cre],[mre]:t,view_type:"table"})},this.handleMoreViewsClick=()=>{const{[mre]:e}=this[pre];R[zse]({[cre]:this[cre],[mre]:e,action:"click_views_dropdown"})},this[Kse]=this[Wse]((()=>{var e;const{[mre]:t,[Hse]:i}=this[pre],{[ure]:o}=this[cre],s=this[Gse](),r=this.showViewTabsStore[hre],n=(null==r?void 0:r[Nse])||0,l=s[Nse]-n,a=(null===(e=t[Xse]())||void 0===e?void 0:e[Fse]())||o.isPhone||r&&(0===n||1===n&&s[Nse]>1)?_se:l>0?Ose:"allTabsVisible",d=t[dre][hre]||i[hre];return{showMoreViewsButton:"someTabsNotVisible"===a||"dropdown"===a,showAddViewButton:this[Lse]()&&"allTabsVisible"===a,addViewButtonAnimatedIn:d,viewSelectState:a,moreViewsCount:l}})),this.showViewTabsStore=this[Wse]((()=>{const{[mre]:e}=this[pre],t=this[Gse](),i=e[Yse]();if(!i)return;const o=Math.max(100,this[Lse]()?105:0);let s=this[fre].rect[hre].width-o;const r=[],n=this.measureViewTabWidth(i);if(!(n<s))return r;r.push(i),s-=n;for(const d of t)if(d.id!==i.id){const e=this.measureViewTabWidth(d);if(!(e<s))break;r.push(d),s-=e}const l=r.filter((e=>e.id!==i.id)),a=t[Ase]((e=>e.id===i.id));return l.splice(a,0,i),l}))}willUnmount(){super.willUnmount(),this[fre].destroy()}renderComponent(){const e=this[Kse][hre],t=this.getSuggestedViewsForTypedDB();return c[Jse]("div",{role:"tablist",[Dse]:{[Vse]:Ese,[Rse]:Bse,height:"100%",flexGrow:1},ref:this.handleViewSelectContainerMount},this.renderViewTabs(),e.showMoreViewsButton&&a()(tt.ZP,{popupType:this[cre][ure][ore]?nt.kQ.SlideUp:nt.kQ.Popup,[Zse]:e=>this.renderViewsPopup(e,t),renderOrigin:e=>this.renderViewSelectButton(e),onClick:this.handleMoreViewsClick}),e.showAddViewButton&&a()(NR.Z,{isVisible:!0,animationStyle:{opacity:e.addViewButtonAnimatedIn?1:0},[Zse]:()=>t&&t[Nse]?a()(tt.ZP,{popupType:tt.Z4.Popup,alignmentToOrigin:ose.v2.Center,[Zse]:e=>this.renderSuggestedViewsPopup(e,t),renderOrigin:e=>c[Jse](pn.Z,n()({[Mse]:X.collectionAddNewView,icon:S.Z.plus},e))},"suggested-views"):a()(pn.Z,{[Mse]:X.collectionAddNewView,icon:S.Z.plus,onClick:()=>this[ire]("CollectionViewTabBar.handleAddViewClick")})}))}renderViewSelectButton(e){var t;const{[mre]:i}=this[pre],{[ure]:o}=this[cre],s=this[Kse][hre],r=this[Pse]();if(!r)return;if(!r.isDefined())return;const l=(null===(t=i[nre]())||void 0===t?void 0:t[sre]()[rre])===y.GZ&&"page"===r.getType();if("dropdown"===s.viewSelectState){const t=r.getType(),s=r[sre]()[Ise];return c[Jse](c[jse],null,!o[ore]&&l&&"home"===aF.B1()&&a()(rse,{origin:this.homeViewRef}),a()(ese,{[Yse]:r,[Zse]:o=>c[Jse](rt.Z,n()({ref:this.homeViewRef,[Dse]:{[Vse]:Ese,[Rse]:Bse,[xse]:x.Z[xse][Tse].desktop,[Cse]:x.Z[Cse].semibold,color:this[bse][kse],maxWidth:yre}},e,o),a()(Gee.F,{color:"regular",viewType:t,viewIcon:s,[Dse]:{[Sse]:6}}),a()("span",{[Dse]:{...x.Z[wse],[Sse]:6,[yse]:1}},void 0,a()(tse,{[mre]:i,[Yse]:r})),S.Z.chevronDown({[yse]:2,width:10,height:10,fill:this[bse][fse]}))}))}return"someTabsNotVisible"===s.viewSelectState?c[Jse](rt.Z,n()({[Dse]:{[Vse]:Ese,[Rse]:Bse,[xse]:x.Z[xse][Tse].desktop,color:this[bse][vse]}},e),a()("span",{[Dse]:{[yse]:1}},void 0,a()(P.FormattedMessage,{[gse]:"{moreViewsCount} more…",id:"collectionTabBar.showMoreViews.title",values:{moreViewsCount:s.moreViewsCount}}))):void 0}renderViewTabs(){const{[mre]:e}=this[pre],t=e[mse][hre],i=this.showViewTabsStore[hre],o=this[Kse][hre];if(i&&"dropdown"!==o.viewSelectState)return t[pse]?a()(xk.ZP,{direction:use,keys:i.map((e=>e.id)),[Dse]:{height:"100%"},disableVerticalEdgeScroll:!0,[cse]:!0,renderKey:e=>{const t=i.find((t=>t.id===e));if(t)return this.renderViewTab(t)},onDrop:this.handleViewTabsDrop}):i.map(this.renderViewTab)}[Lse](){const{[mre]:e,[hse]:t}=this[pre];return e[mse][hre][pse]&&!t[hre]}measureViewTabWidth(e){const t=e.getName(),i=e.getType();if(!i)return 0;let o=this.viewIdWidthEstimatorMap.get(e.id);o||(o=new Nee({[Dse]:{[xse]:`${x.Z[xse][Tse].desktop}px`,[Cse]:x.Z[Cse].medium}}),this.viewIdWidthEstimatorMap.set(e.id,o));const s=(0,ie.getRenderedViewName)({collectionViewName:t,collectionViewType:i}),r=o.measure(s);return Math.min(40+r.width,yre)}[Gse](){var e;return(null===(e=this.getCurrentCollectionViewBlockStore())||void 0===e?void 0:e[dse]())||[]}getCurrentCollectionViewBlockStore(){return this[pre][mre][Xse]()}[Pse](){return this[pre][mre][Yse]()}getSuggestedViewsForTypedDB(){const e=this[pre][mre][nre](),t=this[pre][mre][Xse]();if(!e||!t)return;const i=e[sre]()[rre],o=i?(0,q.vi)(i):void 0;return o?(0,q.AG)(o,e,t):void 0}}wre.displayName="CollectionViewTabBar";const Sre=(0,P.injectIntl)(wre);var bre=i(68689),kre=i(42922),Cre=i(74194),Tre=i(18647),xre=i(76745),Ire=i(46736),Pre=i(90530),Dre=i(23564),Mre=i(51944);const Zre=i(85).XD0,Bre=i(85).P24,Rre=i(85).vwf,Ere=i(85).IWE;class Vre extends v.default{getInitialState(){return{stage:"NOT_TRACKING"}}}function Are(e){window.__c={n:"SetupInitialDatabaseItemsVisibleTracker"};const{[Bre]:t}=e,{handleInitialDatabaseRender:i,handleItemMount:o}=function(e){const t=(0,qn.O7)(),i=(0,Xn.qz)(void 0,Vre),o=(0,c.useRef)(0),s=(0,c.useCallback)((()=>{"NOT_TRACKING"===i.state.stage&&i.setState({stage:Ere})}),[i]),r=(0,c.useCallback)((()=>{if("COUNTING_VISIBLE_ITEMS"===i.state.stage&&(o.current++,1===o.current)){const e=performance.now();m.default.afterNextFlush((()=>{"COUNTING_VISIBLE_ITEMS"===i.state.stage&&i.setState({stage:"SHOULD_TRACK",endTime:e})}))}}),[i]),n=(0,c.useCallback)((i=>{"SHOULD_TRACK"===i.state.stage&&(pe.default.measureFromAppStart({metricName:Rre,endTime:i.state.endTime},{environment:t,data:J.getInitialDatabaseItemsVisibleData({[Bre]:e,visibleItemsCount:o.current||0})}),i.reset(),o.current=0)}),[e,t]);return(0,c.useEffect)((()=>(i.addListener(n),()=>{i.removeListener(n)})),[n,i]),{handleInitialDatabaseRender:s,handleItemMount:r}}(t);return t[Zre]||(t[Zre]={handleInitialDatabaseRender:i,handleItemMount:o}),null}const Lre=i(85)._AA,_re=i(85).qD$,Ore=i(85).rSR,Fre=i(85).gRQ,Nre=i(85).fA6,Gre=i(85).OM8,Hre=i(85).EB9,Wre=i(85).uRL,Kre=i(85).pek,zre=i(85).q$s,Ure=i(85).xej,$re=i(85).piI,Qre=i(85).xm3,qre=i(85).FOQ,Xre=i(85).g7N,Yre=i(85).a3v,jre=i(85).UPJ,Jre=i(85)._V5,ene=i(85).NbQ,tne=i(85).tvI,ine=i(85).NF1,one=i(85).sOA,sne=i(85).MLn,rne=i(85).TEz,nne=i(85).$pZ,lne=i(85).Mm1,ane=i(85).vK9,dne=i(85).IMw,hne=i(85).z70,cne=i(85).nLZ,une=i(85).lf7,pne=i(85).tPo,mne=i(85).Ylz,gne=i(85).Hco,vne=i(85).P3s,fne=i(85).ChN,yne=i(85).kdC,wne=i(85).cZW,Sne=i(85).Dd5,bne=i(85).raT,kne=i(85).nAm,Cne=i(85).ydP,Tne=i(85).jkI,xne=i(85).JLj,Ine=i(85).SfX,Pne=i(85).pHx,Dne=i(85).GGR,Mne=i(85).ejF,Zne=i(85).Joh,Bne=i(85).bey,Rne=i(85).uvl,Ene=i(85).Yzm,Vne=i(85).LIR,Ane=i(85).sG$,Lne=i(85).OLW,_ne=i(85).p6m,One=i(85).rpY,Fne=i(85).yT5,Nne=i(85).zOY,Gne=i(85).H1U,Hne=i(85).AEP,Wne=i(85).yaA,Kne=i(85).E6w,zne=i(85).Aw$,Une=i(85).SKu,$ne=i(85).xOW,Qne=i(85).X_m,qne=i(85).fBv,Xne=i(85).rps,Yne=i(85).$bT,jne=i(85).EMU,Jne=i(85).sM5,ele=i(85).AIq,tle=i(85).lGm,ile=i(85).Q25,ole=i(85).PG2,sle=i(85).bSA,rle=i(85).pkR,nle=i(85).f57,lle=i(85).aXo,ale=i(85).fRr,dle=i(85).YaF,hle=i(85).qq3,cle=i(85).yrh,ule=i(85).b0M,ple=i(85).fIn,mle=i(85).TLr,gle=i(85).LMv,vle=i(85).yHv,fle=i(85).SK6,yle=i(85).oc3,wle=i(85).unR,Sle=i(85).DCw,ble=i(85).sP9,kle=i(85).pd1,Cle=i(85).IQb,Tle=i(85).Gpy,xle=i(85).TN,Ile=i(85).mmP,Ple=i(85).UgH,Dle=i(85).mUE,Mle=i(85).NlJ,Zle=i(85).OiA,Ble=i(85).PXg,Rle=i(85).XNW,Ele=i(85).Er,Vle=i(85).b6d,Ale=i(85).PJ8,Lle=i(85).l7Z,_le=i(85).cbT,Ole=i(85).sbn,Fle=i(85).I8n,Nle=i(85).Uww,Gle=i(85).urI,Hle=i(85).fMX,Wle=i(85).ngE,Kle=i(85).L1Q,zle=i(85).gRm,Ule=i(85).uzK,$le=i(85).bQB,Qle=i(85).$ay,qle=i(85).qJ8,Xle=i(85).Ubh,Yle=i(85).y7i,jle=i(85).k9$,Jle=i(85).EIp,eae=i(85).JmH,tae=i(85).c1l,iae=i(85).nR2,oae=i(85).N20,sae=i(85).qLW,rae=i(85).AeB,nae=i(85).p2z,lae=i(85).kk0,aae=i(85).XG6,dae=i(85).C1,hae=i(85).MVb,cae=i(85).n4d,uae=i(85).sfC,pae=i(85).bCl,mae=i(85).V5q,gae=i(85).PvM,vae=i(85).LCr,fae=i(85).RH8,yae=i(85).wlH,wae=i(85).J2Z,Sae=i(85).Qm2,bae=i(85).piL,kae=i(85).Vkz,Cae=i(85).KzC,Tae=i(85).XD0,xae=i(85).Qm,Iae=i(85).Q_9,Pae=i(85)._yk,Dae=i(85).x$g,Mae=i(85).QBK,Zae=i(85).jdj,Bae=i(85).MAy,Rae=i(85).ILR,Eae=i(85).An8,Vae=i(85).wdh,Aae=i(85).T4J,Lae=i(85).W1o,_ae=i(85).i7F,Oae=i(85).O1p,Fae=i(85).lTn,Nae=i(85).nxU,Gae=i(85).Drs,Hae=i(85).JJj,Wae=i(85).ZG6,Kae=i(85).U1G,zae=i(85).Lg4,Uae=i(85).nm$,$ae=i(85).c_3,Qae=i(85).YGn,qae=i(85).dLQ,Xae=i(85).E0z,Yae=i(85).pc0,jae=i(85).kMZ,Jae=i(85).GUN,ede=i(85).U66,tde=i(85).We_,ide=i(85).Bgg,ode=i(85).IVB,sde=i(85).$7D,rde=i(85).AcI,nde=i(85).GwZ,lde=i(85).Wp_,ade=i(85).TtP,dde=i(85).BxA,hde=i(85).EiQ,cde=i(85).vwl,ude=i(85).mSd,pde=i(85).DbH,mde=i(85).Vq8,gde=i(85).u$q,vde=i(85).$Zu,fde=i(85).KCN,yde=i(85).Xl2,wde=i(85).rER,Sde=i(85).rMr,bde=i(85).MWD,kde=i(85).QQK,Cde=i(85).X5t,Tde=i(85).jQT,xde=i(85).iPt,Ide=i(85)._vc,Pde=i(85).YDe,Dde=i(85).ffk,Mde=i(85).QLQ,Zde=i(85).G3i,Bde=i(85).QSf,Rde=i(85).qU4,Ede=i(85).BQ6,Vde=i(85).LlE,Ade=i(85).Jkr,Lde=i(85).Au,_de=i(85).wuN,Ode=i(85).UA5,Fde=i(85).Exd,Nde=i(85).Wo8,Gde=i(85).cZf,Hde=i(85).Uk6,Wde=i(85).rQ1,Kde=i(85).oWD,zde=i(85).rwP,Ude=i(85).D7I,$de=i(85).XH5,Qde=i(85).QmD,qde=i(85).XCs,Xde=i(85).YDv,Yde=i(85).P0R,jde=i(85).XtO,Jde=i(85).$Fm,ehe=i(85).HxR,the=i(85).Gm5,ihe=i(85).Gnd,ohe=i(85).uKQ,she=i(85).xeN,rhe=i(85).Ryu,nhe=i(85).e4A,lhe=i(85).wfR,ahe=i(85).ylc,dhe=i(85).Dy7,hhe=i(85).M82,che=i(85).iAO,uhe=i(85).jyI,phe=i(85).Exw,mhe=i(85).RiT,ghe=i(85).avC,vhe=i(85).JoY,fhe=i(85).Dv6,yhe=i(85).P4q,whe=i(85).q7Z,She=i(85).P24,bhe=i(85).PR5,khe=i(85).Nnw,Che=i(85).c0M,The=i(85).wgE,xhe=i(85).A8W,Ihe=i(85).nx5,Phe=i(85).A4A,Dhe=(0,P.defineMessages)({[Phe]:{[Ihe]:"Type to search...",id:"database.searchInputPlaceholder"},openAutomationsSettingsButtonTooltip:{[Ihe]:"Create or view an automation",id:"database.collectionViewBlock.openAutomationsSettingsButton.tooltip"},openAutomationsSettingsButtonAriaLabel:{[Ihe]:"Create or view an automation",id:"database.collectionViewBlock.openAutomationsSettingsButton.ariaLabel"},openFullscreenPageButtonTooltip:{[Ihe]:"Open as full page",id:"database.collectionViewBlock.openFullscreenPageButton.tooltip"}});class Mhe{constructor(e,t,i){this.listener=void 0,this.didEmit=void 0,this[xhe]=void 0,this.handleEmit=(e,t,i)=>{let o=!0;this.didEmit||(this.didEmit=!0,o=!1),this[xhe]===t?o=!1:this[xhe]=t,o&&this.onEmit(t,i)},this[The]=e,this.listenerEventKey=t,this.onEmit=i,this.didEmit=!1,this[xhe]=void 0}subscribe(){this.listener=ue.Z[Che](this.listenerEventKey,this.handleEmit,void 0,this[The])}[khe](){this.listener&&ue.Z[bhe](this.listener,this[The])}}class Zhe extends Le.Z{constructor(){super(...arguments),this.isCollectionViewBlock=!0,this[She]=new ye.Z(this[The]),this[whe]=new Ae.E,this.headerEl=null,this[yhe]=null,this.timelineViewRef=c[fhe](),this[vhe]=void 0,this[ghe]=void 0,this[mhe]=new Map,this[phe]=void 0,this[uhe]=new RR(this[She],this[The]),this.syncStateTimeout=void 0,this[che]=void 0,this.storeTypes={[She]:ye.Z,[hhe]:Pe.Z,[dhe]:Pe.Z,[ahe]:v.default[lhe](!1),scrollStore:v.default[lhe](!1),noDateResultStore:v.default[lhe](void 0),[nhe]:ve.Z,filterBarSettingsStore:v.default[lhe]({[rhe]:!1,stack:[]}),createFilterButtonPopupStore:ve.Z,createFilterSettingsStore:v.default[lhe]({[rhe]:!1,stack:[]}),filterBarCreateFilterSettingsStore:v.default[lhe]({[rhe]:!1,stack:[]}),createSortSettingsStore:v.default[lhe]({[rhe]:!1,stack:[]}),[she]:v.default[lhe](void 0),[ohe]:ve.Z},this.renderCreateFilterPopup=()=>{const{[She]:e}=this,{createFilterSettingsStore:t}=this[ihe];return a()(_E.P,{[the]:ee.HV.TopbarFilterPopup,[She]:e,[ehe]:t,hideDesktopHeader:!0})},this.renderCreateSortPopup=()=>{const{[She]:e}=this,{createSortSettingsStore:t}=this[ihe];return a()(_E.P,{[the]:ee.HV.TopbarSortPopup,[She]:e,[ehe]:t,hideDesktopHeader:!0})},this.renderViewSettings=()=>{const e=this[Jde](),t=(0,ie.isInFrameWhenSidePeekOpen)(this[Yde][jde])?{[Xde]:0,[qde]:0}:this[$de][Qde];if(t)return c[Ude](Lee,n()({[She]:this[She],[whe]:this[whe],[zde]:this[ihe][she],[Jde]:e},t))},this.renderTemplatesPopup=()=>{const{[She]:e}=this,{[jde]:t}=this[Yde],i=e[Kde]();if(i){if(be.Z[Qde].online){const o=e[Wde][Qde];return a()(NE.Z,{isOverlay:!0,[Kde]:i,[Hde]:o[Hde],onEmptyPageClick:this[Gde],onEmptyEnter:this[Gde],onTemplateClick:this.handleTemplateClick,onCancelClick:this.handleTemplateCancelClick,locked:t[Nde]()})}return a()("div",{[Ede]:{[Fde]:14,[Ode]:this[Lde][_de],[Ade]:280,[Vde]:8}},void 0,a()(P.FormattedMessage,{[Ihe]:"Please go online to use a template.",id:"collectionViewBlock.actionBar.offlineTemplatePicker.message"}))}},this.renderNoDatePopup=e=>{const{[She]:t}=this,i=this.noDateTotal[Qde],o=t[Kde](),s=t[Rde](),r=this.getNoDateProperty();if(!o||!s||!r)return;const n=s[Bde](),l=s.getName();return!s[Zde]()||"timeline"!==n&&"calendar"!==n?void 0:a()(fR,{[Kde]:o,[Mde]:s.id,[Dde]:r,onClose:e.close,onAddPage:this.handleNoDateAddPage,[Pde]:n,collectionViewName:l,[She]:t,noDateTotal:i})},this.handleViewSettingsClick=e=>{(0,re.ZP)({event:e,[the]:re.Af[Ide],[xde]:this.handleViewSettingsClickInner}),R[Tde]({[The]:this[The],[She]:this[She],[Cde]:"click_topbar_view_settings"}),this.projManagementTooltipTourComplete()},this.handleViewSettingsClickInner=()=>{const{[She]:e}=this,t=e[kde],i=t[Qde][rhe],o=(0,we.n)(t);i&&"main"===(null==o?void 0:o[bde])?V[Sde]({[ehe]:t}):V[wde]({[She]:e,[ehe]:t})},this.handleViewAutomationSettingsClick=e=>{(0,re.ZP)({event:e,[the]:re.Af.CollectionAutomationSettingsClick,[xde]:this.handleViewAutomationSettingsClickInner})},this.handleViewAutomationSettingsClickInner=()=>{const{[She]:e}=this,t=e[kde],i=t[Qde][rhe],o=(0,we.n)(t);i&&"automationSettings"===(null==o?void 0:o[bde])?V[Sde]({[ehe]:t}):(V[wde]({[She]:e,[ehe]:t}),V[yde]({[ehe]:t,item:{source:fde,[bde]:vde}}))},this.handleViewClick=e=>{let{[gde]:t,newCollectionViewStore:i,openInNew:o}=e;if(t.id!==i.id&&!o){const e=t[Bde](),o=i[Bde]();var s;if(e&&o)this[che]={from:e,to:o,metric:pe.default.mark(mde),sizeHintAtStart:null===(s=this[She][pde][Qde])||void 0===s?void 0:s.sizeHint}}},this.handleFilterClick=()=>{const{[She]:e}=this,{createFilterSettingsStore:t}=this[ihe],i=e[Wde][Qde][ude]?e[cde][Qde]:void 0,o=e[hde][Qde],s=e[dde][Qde];s||o[ade]>0||i?e.filtersBarOpen[lde](!s):V[yde]({[ehe]:t,item:{[bde]:"createFilter"}}),R[Tde]({[The]:this[The],[She]:this[She],[Cde]:"click_topbar_filter"})},this.handleSortClick=()=>{const{[She]:e}=this,{createSortSettingsStore:t}=this[ihe];this.hasSort[Qde]?(e.filtersBarOpen[lde](!0),V[yde]({[ehe]:e[nde],item:{[bde]:"sort"}})):V[yde]({[ehe]:t,item:{[bde]:"createSort"}}),R[Tde]({[The]:this[The],[She]:this[She],[Cde]:"click_topbar_sort"})},this.handleCreateFilterPopupDismiss=()=>{const{createFilterSettingsStore:e}=this[ihe];V[Sde]({[ehe]:e})},this.handleCreateSortPopupDismiss=()=>{const{createSortSettingsStore:e}=this[ihe];V[Sde]({[ehe]:e})},this[rde]=(e,t)=>{this[uhe][rde]({src:"msg",passThroughData:t,[sde]:this[sde]()})},this[ode]=()=>{this.shouldRefetch()&&this[uhe].maybeProcessQueuedCollectionEmit("page_show")},this.handlePeekViewChange=()=>{this.shouldRefetch()&&this[uhe].maybeProcessQueuedCollectionEmit("exit_peek")},this[sde]=()=>{var e;return!Ze.Z[Qde][ide]||!(!Re.default[tde]()||null!==(e=Re.default.peekTarget[Qde])&&void 0!==e&&e.uiContains(this[Yde][jde]))},this.shouldRefetch=()=>{if(!Re.default[tde]()&&Ze.Z[Qde][ide])return!0},this.handleHeaderMount=e=>{e&&this[whe].observe(e),this.headerEl=e},this.handleHorizontalScrollerMount=e=>{var t;const i=null===(t=this[ede]())||void 0===t?void 0:t[Bde]();if(i)if("table"===i){var o;var s;if(null==e||null===(o=e.scrollerEl())||void 0===o?void 0:o[Jae].contains(X.scrollerHorizontal))this[yhe]=e;else this[yhe]=(null==e||null===(s=e[the].scrollerContext)||void 0===s?void 0:s[jae])||null}else this[yhe]=e},this[Yae]=e=>{const{[Xae]:t}=this[The],i=this[ede]();if(!i||t[qae])return;const o=i[Bde]();o&&(0,re.ZP)({event:e,[the]:re.Af.EditorMouseDown,[xde]:()=>{e[Qae](),F[$ae]({[The]:this[The],[Uae]:e[Uae],startX:e.clientX,startY:e.clientY,showSelectionRect:!0,preventSelectStores:[],allowVerticalEdgeScroll:!0,[zae]:"board"===o||"table"===o})}})},this.handleEditorClick=(e,t)=>{(0,re.ZP)({event:e,[the]:re.Af.EditorClick,[xde]:()=>{if(this[Jde]()||O.E5(this[The]),"page"===t&&!ae[Kae]()){const{clientX:t,clientY:i,[Uae]:o}=e;m.default[Wae]((()=>{z[Hae]({[Gae]:"CollectionViewBlock.PageView.click",[The]:this[The],[Nae]:e=>{K.editNearestBlockOrInsertIfAtBottomOfPage(this[The],{x:t,y:i,[Uae]:o instanceof Element?o:void 0},e)}})}))}}})},this[Fae]=e=>{var t,i,o;const s=null===(t=this[yhe])||void 0===t||null===(i=t.scrollerEl())||void 0===i?void 0:i[Oae],r=null===(o=this[$de][Qde])||void 0===o?void 0:o[Xde];void 0!==s&&r&&(s>r?this[ihe].scrollStore[lde](!0):this[ihe].scrollStore[lde](!1))},this.handleFocusIn=e=>{const t=e[Uae];null!==t&&t instanceof HTMLElement&&(0,g.E)(t)&&this[ihe][ahe][lde](!0)},this.handleFocusOut=()=>{this[ihe][ahe][lde](!1)},this[_ae]=()=>{Te.Z[Qde]||this[ihe][hhe][lde]({...this[ihe][hhe][Qde],[Lae]:!0})},this[Aae]=()=>{this[ihe][hhe][lde]({...this[ihe][hhe][Qde],[Lae]:!1})},this.handleHeaderMouseMove=()=>{Te.Z[Qde]||this[ihe][dhe][lde]({...this[ihe][dhe][Qde],[Lae]:!0})},this[Vae]=()=>{this[ihe][dhe][lde]({...this[ihe][dhe][Qde],[Lae]:!1})},this[Eae]=()=>{var e,t;if(!this.isLoadedStore[Qde]||!this[Rae]||this[She].wasCreatedThisSession[Qde]||!this[Bae]())return;const i=this[The][Zae][Qde];let o;"page"===i.route.name&&(o=i.route.mobileData);const s={is_push:(null===(e=o)||void 0===e?void 0:e.isPush)??!1,[Pde]:null===(t=this[She][Rde]())||void 0===t?void 0:t[Bde](),[Mae]:this[The][Zae][Qde].initialRoute.name};var r;Ie.Z[Qde][Dae]?pe.default[Iae](Cae,{[The]:this[The],[Pae]:()=>s}):(_.setInitialRenderCompleted(),pe.default.measureFromAppStartAfterNextFlush("initial_database_render",{[The]:this[The],[Pae]:()=>s,shouldSendIfStatsigNotInitialized:!0}),this[ghe]&&pe.default[Iae]({metricName:xae,startTime:this[ghe]},{[The]:this[The],[Pae]:()=>s}),this[ghe]=void 0,null===(r=this[She][Tae])||void 0===r||r.handleInitialDatabaseRender())},this.handleSearchButtonClick=()=>{this[She].searchOpen[lde](!0),R[Tde]({[The]:this[The],[She]:this[She],[Cde]:"click_topbar_search"})},this[kae]=e=>{L.updateSearchQuery({[bae]:e[Uae].value,[She]:this[She],[Bae]:Boolean(this[Yde][Bae])}),D.trackCollectionSearch(this[The],{[Sae]:this[wae]()})},this.handleSearchBlur=()=>{this[She][bae][Qde]||this[yae]()},this.handleSearchKeyDown=e=>{27===e.keyCode&&this[yae]()},this[yae]=()=>{this[She][bae][lde](""),this[She].searchOpen[lde](!1)},this[fae]=()=>{z[Hae]({[Gae]:"CollectionViewBlock.handleAddItemClick",[The]:this[The],[Nae]:e=>{this.createItem({[vae]:e,coerce:!0,from:"cvb_add_item"})}}),R[Tde]({[The]:this[The],[She]:this[She],[Cde]:"click_topbar_new_item"}),this[gae]()},this.handleTemplatesDropdownClick=()=>{R[Tde]({[The]:this[The],[She]:this[She],[Cde]:"click_topbar_templates_dropdown"})},this.handleTemplateClick=e=>{z[Hae]({[Gae]:"CollectionViewBlock.handleTemplateClick",[The]:this[The],[Nae]:t=>{const i=this.createItem({[vae]:t,coerce:!1,from:"cvb_template"});A[mae]({title:pae,[The]:this[The],[jde]:i,[uae]:e[uae],isKeyboard:e.isKeyboard,[cae]:!1,[vae]:t,from:hae})}}),this[gae](),this[ihe][nhe][dae]()},this[Gde]=()=>{z[Hae]({[Gae]:"CollectionViewBlock.handleTemplateEmptyPageClick",[The]:this[The],[Nae]:e=>{this.createItem({[vae]:e,coerce:!1,from:"cvb_template_empty_page"})}}),this[ihe][nhe][dae]()},this.handleTemplateCancelClick=()=>{this[ihe][nhe][dae]()},this.handleSetSourceClick=()=>{const{[She]:e}=this,t=e[kde];this[aae][Qde]?V.openExternalViewSourceSettings({[ehe]:t}):(V[wde]({[She]:e,[ehe]:t}),R[Tde]({[The]:this[The],[She]:this[She],[Cde]:"click_select_data_source"}))},this.handleNoDateAddPage=e=>{const{[She]:t}=this,i=this[lae](),o=this[ede](),s=this.timelineViewRef.current;if(!o||!i)return;if(!o[Zde]())return;const{performResult:r}=z[Hae]({[Gae]:"CollectionViewBlock.insertedStore",[The]:this[The],[Nae]:r=>"calendar"===o[Bde]()?B.Fv({[The]:this[The],[jde]:e,[Kde]:i,[She]:t,startDayOfWeek:Q.userSettingsStartOfWeekStore[Qde],results:this.getDefaultResults(),[vae]:r}):s?s.addBlockToView({[jde]:e,[vae]:r}):void 0});r&&W[nae]({[The]:this[The],[ihe]:[r]})},this.handleOpenAsPageClick=()=>{D.trackOpenCollectionAsPage(this[The],{[Sae]:this[wae]()})},this.handleNoDateButtonClick=()=>{R[Tde]({[The]:this[The],[She]:this[She],[Cde]:"click_topbar_no_date"})},this[rae]=async()=>{if(this.isSyncingStore[Qde]){const e=this[lae](),t=null==e?void 0:e[sae]().uri,i=null==e?void 0:e[sae]().bot_id,o=null==e?void 0:e.id;if(!t||!i||!o)return;await this.pollSyncState({uri:t,botId:i,[oae]:o})}},this.pollSyncState=async e=>{const t=await M.getExternalCollectionSyncState(this[The],e);if("success"===t[bde]&&t.data.result){const i=t.data.result,o=this[She].numberChildrenReceived,s=this[She].numberChildrenUnfurled;o[lde](i.numberChildrenReceived),s[lde](i.numberChildrenUnfurled),s[Qde]/o[Qde]<1&&(this.syncStateTimeout=setTimeout((async()=>{await this.pollSyncState(e)}),1e4))}},this[iae]=e=>{const t=Array.from(this[mhe].keys()),i=h().difference(t,e),o=h().difference(e,t);for(const r of i){var s;null===(s=this[mhe].get(r))||void 0===s||s[khe](),this[mhe].delete(r)}for(const r of o){const e=new Mhe(this[The],(0,k.getCollectionEventKey)(r),this[rde]);e.subscribe(),this[mhe].set(r,e)}},this.subscribeToTypeChanges=()=>{const e=this[She][tae],t=this[She].databaseType;if("collectionTypedView"!==e||!t||this[phe])return;const i=new Mhe(this[The],(0,k.getCollectionTypeChangeEventKey)({spaceId:this[Yde][jde][eae](),databaseType:t}),this[rde]);i.subscribe(),this[phe]=i},this.isSyncingStore=this[Jle]((()=>{var e;const t=this[lae](),i=null==t?void 0:t[jle](),o=!0===(null==t||null===(e=t[sae]()[Yle])||void 0===e?void 0:e.syncing),s=this[The][Xae][qae];return Boolean(i&&o&&!s)})),this.canShowPmIntroTooltipStore=this[Jle]((()=>{if(this[The][Xae][qae])return!1;const e=ge.default[Qde][Xle],t=ge.default[Qde][qle];if(!(0,q.jH)(e,t)&&(!t||t[Qle]()<q.VL))return!1;if(!this.isTasksDB())return!1;if(this[Yde][jde].pathIsDead())return!1;return!!this[She][Wde][Qde][$le]&&(!!(0,q.Z0)()&&ge.default[Qde].inAppCalloutStore.canShow("pm_intro_tooltip"))})),this.isTasksDB=()=>{const e=this[She][Ule]();return(null==e?void 0:e[sae]()[zle])===y.TZ},this.shouldRestrictHeaderWidthForMarginComments=()=>this[Kle]()&&!(0,ie.isPageFullWidth)(this[Yde][jde])&&this[Wle][Qde],this[Hle]=()=>void 0!==this[She][Kde]()||"collectionTypedView"===this[She][tae],this.shouldRestrictWidthForMarginComments=this[Jle]((()=>{const e=this[ede](),t=null==e?void 0:e[Bde]();return this.shouldRestrictHeaderWidthForMarginComments()&&t&&(ie.nonFullWidthCollectionTypes.has(t)||"timeline"===t&&this[She][Kde]()&&!(0,te.C1)({[The]:this[The],[Gle]:this[She][Nle][Qde],[Bae]:this[Bae](),[Fle]:this[Kle]()}))})),this[aae]=this[Jle]((()=>{const e=this[lae]();return!!e&&(0,w.OY)(e[Ole]())})),this.getExternalIntegrationId=this[Jle]((()=>{const e=this[lae]();if(e)return e[sae]()[_le]})),this[$de]=this[Jle]((()=>{var e;const{[jde]:t,[Bae]:i,overridePaddingLeft:o,overridePaddingRight:s}=this[Yde],r=(0,ie.getLeftRightPadding)({[The]:this[The],[jde]:t,[Bae]:i,[Lle]:this[whe],viewType:null===(e=this[She][Rde]())||void 0===e?void 0:e[Bde]()});r&&void 0!==o&&(r[Xde]=o),r&&void 0!==s&&(r[qde]=s);const n=this.shouldRestrictWidthForMarginComments[Qde];return r&&n&&(r[qde]+=(0,le.gC)(this[The],(0,ie.isInPeekRenderer)(t),this[Ale][Qde])),r})),this.isLoadedStore=this[Jle]((()=>Boolean(this[She][pde][Qde]))),this[Vle]=this[Jle]((()=>{if(!this[Kle]()||!this[Wle][Qde]||!(0,ie.isPageFullWidth)(this[Yde][jde])||this[Yde][jde][Ele]())return{[Rle]:void 0,[Ble]:void 0};const e=le.QB/2;return{[Rle]:e,[Ble]:-e}})),this.noDateTotal=this[Jle]((()=>{if(this.noDateReducerStore[Qde]){const e=this[ihe].noDateResultStore[Qde];return e&&"aggregation"===e[bde]&&"number"===e[Zle][bde]&&e[Zle].value?e[Zle].value:0}return 0})),this.noDateReducerStore=this[Jle]((()=>{const e=this.getNoDateProperty();if(e){return{[bde]:Mle,filter:{[Dle]:"and",filters:[{[Dde]:e,filter:{[Dle]:Ple}}]},[Mle]:{[Ile]:"count"}}}})),this.hasAppliedFilter=this[Jle]((()=>(0,Y.RL)({[She]:this[She],applySubitemFilter:!1})[ade]>0)),this.hasSort=this[Jle]((()=>{const{[She]:e}=this;return e.currentSortsStore[Qde][ade]>0})),this[xle]=this[Jle]((()=>{const{[Xae]:e}=this[The],{[hhe]:t,[dhe]:i,[ahe]:o,createSortSettingsStore:s,createFilterSettingsStore:r,filterBarCreateFilterSettingsStore:n,[ohe]:l}=this[ihe],{[She]:a}=this,d=this[Bae](),h=o[Qde],c=a[kde][Qde][rhe],u=a.searchOpen[Qde],p=s[Qde][rhe],m=r[Qde][rhe],g=n[Qde][rhe],v=a[nde][Qde][rhe],f=Array.from(a[Cle][Tle]()),y=l[Qde][rhe],w=f.some((e=>e[Qde][rhe]));return Boolean(t[Qde][Lae]||i[Qde][Lae]||h||d||this[kle]()||e[qae]||c||w||p||m||g||u||y||v)})),this.isCollectionScrolled=this[Jle]((()=>this[ihe].scrollStore[Qde])),this.showCompactDesktopHeaderStore=this[Jle]((()=>{const{[Xae]:e}=this[The],t=this[whe].rect[Qde];return!e[qae]&&t[Ade]&&t[Ade]<400})),this[Ale]=this[Jle]((()=>(0,ie.isInFrameWhenSidePeekOpen)(this[Yde][jde]))),this.isInPeek=this[Jle]((()=>(0,ie.isInPeekRenderer)(this[Yde][jde])))}insertBlocks(e,t){const i=this[lae]();if(i)for(const o of e)E.addBlockToGroup({[The]:this[The],[jde]:o,[Kde]:i,[She]:this[She],coerce:!0,[ble]:[],results:this.getDefaultResults(),[vae]:t});return[]}handleCreated(){W.clear(this[The]),m.default[Wae]((()=>{const{[She]:e}=this,t=e[Kde](),i=e[Ule](),o=e[kde];if(!i)return;const s=i[Sle]();if(this[aae][Qde])V.openExternalViewSourceSettings({[ehe]:o});else if(s)L.selectCollectionTitle({[The]:this[The],[She]:e});else if(t)V[wde]({[She]:e,[ehe]:o}),(0,OE.V)({[Kde]:t,[She]:e,[ehe]:o});else{const t=ke.default[wle]("typed_db_creation");V[wde]({[She]:e,[ehe]:o}),t?V[yde]({[ehe]:o,item:{[bde]:"createTypedDB"}}):V[yde]({[ehe]:o,item:{[bde]:"createViewSource"}})}}))}willMount(e){super.willMount(e),this[yle]({isFirstRender:!0}),this.isLoadedStore[Che](this[Eae]),this[Eae](),this[ghe]=performance.now()}[fle](e){super[fle](e);const{[jde]:t}=e,i=t.id,{[She]:o}=this,s=this[She][Rde](),r=this[She][Kde](),n=this[The].currentUser.id,l=s?s.id:void 0,a=r?r.id:void 0,d=this[vle]().map((e=>e.id)),h=this.getDefaultCollectionViewStore(),c=b.Z.get({userId:n,key:ye.Z[gle](i)});let u;if(e.viewId&&d.indexOf(e.viewId)>=0?u=e.viewId:s&&d.indexOf(s.id)>=0?u=s.id:c&&d.indexOf(c)>=0?u=c:h&&d.indexOf(h.id)>=0&&(u=h.id),u){const e=Ee.Xr[mle](t,{table:T.n,id:u}),s=e[lae](),r=!s||s[Zde]();e[Zde]()&&r&&(u!==c&&b.Z.set({userId:n,key:ye.Z[gle](i),value:u}),(u!==l||s&&s.id!==a)&&L[dae]({[The]:this[The],[Ule]:t,[Rde]:e,[Kde]:s,[She]:o,[Bae]:this[Bae](),[Fle]:this[Kle](),[Jde]:this[Jde]()}))}const p=o[Kde]();if(p){p[ple]().map((e=>e[Ole]()))}this.isSyncingStore[Che](this[rae]),this.ensureStoreListeners()}willUpdate(){this[yle]({isFirstRender:!1})}didMount(){super.didMount(),Ze.Z[Che](this[ode]),Re.default[Che](this.handlePeekViewChange);const e=this[She][Rde](),t=this[She][Kde]();if(e&&t){const i=e[Bde]();i&&D.trackDatabaseVisit(this[The],{collection_id:t.id,[ule]:e.id,collection_view_block_id:this[Yde][jde].id,[bde]:i,is_full_screen:this[Bae](),is_peek:this[Jde](),peek_mode:Re.default[Qde].mode})}if(e&&"collectionTypedView"===this[She][tae]){const t=this[She].databaseType,i=xe.Z[Qde].userHomePageId,o=e[Bde]();t&&o&&D.trackTypeAggregatedDatabaseVisit(this[The],{[ule]:e.id,collection_view_block_id:this[Yde][jde].id,[bde]:o,databaseType:t,is_my_tasks:i===this[Yde][jde].id})}ke.default[wle]("collection_settings_skip_preload")||ce.deps.CollectionSettings.loader()}didMountOrUpdate(){var e;const t=this[lae]();var i;(t&&this[iae]([t.id]),this[She].remoteCollectionIds[Che]((e=>this[iae](e[Qde]))),this.subscribeToTypeChanges(),this[vhe])||(this[vhe]=null===(i=u.findDOMNode(this))||void 0===i?void 0:i.parentElement,this[vhe]&&((0,oe.addPassiveEventListener)(this[vhe],"focusin",this.handleFocusIn),(0,oe.addPassiveEventListener)(this[vhe],"focusout",this.handleFocusOut),(0,oe.addPassiveEventListener)(this[vhe],cle,this[_ae]),(0,oe.addPassiveEventListener)(this[vhe],"mouseleave",this[Aae])));const o=null===(e=this[yhe])||void 0===e?void 0:e.scrollerEl();o&&(0,oe.addPassiveEventListener)(o,"scroll",this[Fae])}didUpdate(e){this.trackSwitchViewLag()}willUnmount(){super.willUnmount();const{[She]:e}=this;L.destroy({[She]:e}),this.unsubscribeAll(),this[whe].destroy(),Ze.Z[bhe](this[ode]),Re.default[bhe](this.handlePeekViewChange),this.isLoadedStore[bhe](this[Eae]),this[vhe]&&((0,oe.removePassiveEventListener)(this[vhe],"focusin",this.handleFocusIn),(0,oe.removePassiveEventListener)(this[vhe],"focusout",this.handleFocusOut),(0,oe.removePassiveEventListener)(this[vhe],cle,this[_ae]),(0,oe.removePassiveEventListener)(this[vhe],"mouseleave",this[Aae])),this.isSyncingStore[bhe](this[rae]),clearTimeout(this.syncStateTimeout)}renderPersisted(){const{[She]:e}=this,t=this[ede](),i=this[lae](),o=e[hle][Qde],s=e[dle][Qde],r=e[Nle][Qde],n=this[Bae]();if(!(t&&o&&s&&r))return;const l=t[Bde]();if(!l)return;if(i&&!i[Zde]())return;if(this[ale]())return a()(U.L1,{value:this[She]},void 0,c[Ude](FR.p,{allowSelectionWithin:!0,[Ede]:this.getHeaderWrapStyle(),onMouseDown:this[Yae],onMouseMove:this.handleHeaderMouseMove,onMouseLeave:this[Vae],[ole]:this.handleEditorClick,ref:this.handleHeaderMount},a()(rl.Z,{[jde]:this[Yde][jde],shouldShowHoverMenu:!0,[sle]:this[lle](l),shouldShowHalo:!this[Bae](),canSelect:!this[Bae]()},void 0,a()(xre.Z,{[jde]:this[Yde][jde],[Ede]:{[Ade]:nle},[rle]:!1}))));const d=(0,he.getMainEditorFrameWidth)(this[The])-Q.pageViewBlockDefaultWidth,h=this[Ale][Qde]&&!this[Yde][Bae]&&!(0,ie.isPageFullWidth)(this[Yde][jde])&&d>0,u=this.renderView(i,t,l,o,s,r),p=c[Ude](Tre.Z,{[bde]:this.isInPeek[Qde]?me.Z.X:(0,Q.getCollectionViewBlockScrollType)({[The]:this[The],[Bae]:this[Bae]()}),[tle]:X.collectionViewBody,onMouseDown:this[Yae],preventType:this.isInPeek[Qde]?me.Z.None:G.getPreventScrollType(this[The]),[ole]:e=>this.handleEditorClick(e,l),[Ede]:this[ile](l,r,h?d/2:void 0),ref:this.handleHorizontalScrollerMount},u),m={flexGrow:1,[ele]:0,[Jne]:jne,[Yne]:Xne,...this[Vle][Qde]},g=n?c[Ude](c.Fragment,null,a()("div",{[Ede]:{[qne]:"sticky",[Qne]:0,left:0,zIndex:I.collectionSettings}},void 0,this.renderViewSettings()),a()(FR.p,{allowSelectionWithin:!0,[Ede]:{...m,[qne]:$ne}},void 0,p)):a()(FR.p,{allowSelectionWithin:!0,[Ede]:{flexGrow:1,[ele]:0,[Jne]:jne,[Yne]:Xne,...this[Vle][Qde],...h&&{[Rle]:-d/2}}},void 0,a()("div",{[Ede]:{[qne]:$ne}},void 0,p,this.renderViewSettings()));return a()(U.L1,{value:this[She]},void 0,this.renderMultiSelectToolbar(),!this[Yde].hideHeader&&this.renderHeader(l),g,this.renderBottomBorderForViewSettings(),a()(Are,{[She]:this[She]}))}renderHeader(e){var t,i,o;const{[Xae]:s}=this[The],{[jde]:r,disableHoverMenu:n}=this[Yde],l=this[Bae](),d=this.noDateReducerStore[Qde],h=this[xle][Qde],u=this.showCompactDesktopHeaderStore[Qde],p=null===(t=Se.Z[Qde])||void 0===t?void 0:t[ehe][Qde][rhe],m=this[$de][Qde],g=(null===(i=this[She][Ule]())||void 0===i?void 0:i[Ele]())&&"page"===(null===(o=this[She][Rde]())||void 0===o?void 0:o[Bde]()),v=this[kle]()?a()(ER.Z,{[jde]:r,origin:this.renderViewSettingsButton(),isFirstTooltip:!1,phase:Une}):this.renderViewSettingsButton();return c[Ude](FR.p,{allowSelectionWithin:!0,[Ede]:this.getHeaderWrapStyle(),onMouseDown:this[Yae],onMouseMove:this.handleHeaderMouseMove,onMouseLeave:this[Vae],ref:this.handleHeaderMount},m&&a()(rl.Z,{[jde]:r,shouldShowCopyLinkButton:r[Nde](),shouldShowHoverMenu:!n&&this[zne]()&&!l,[sle]:this[lle](e)},void 0,s[Kne]?a()("div",{[Ede]:this[Wne]()},void 0,this.renderViewTabBar(),!this[Yde].hideHeaderActions&&a()(NR.Z,{[ide]:!0,animationStyle:{[Hne]:h?1:0},[One]:()=>a()("div",{[Ede]:{[Jne]:"flex",[Gne]:"center"}},void 0,this[Nne](),this.renderFullScreenButton(),v,this[Fne]())})):a()("div",{[Ede]:this[Wne]()},void 0,this.renderViewTabBar(),!p&&!this[Yde].hideHeaderActions&&a()(NR.Z,{[ide]:!0,animationStyle:{[Hne]:h?1:0},[One]:()=>a()("div",{[Ede]:{[Jne]:"flex",[Gne]:"center",gap:2}},void 0,this[Nne](),!u&&this.renderLockIndicator(),!u&&this.renderNoDateButton(),!u&&"page"!==e&&this.renderFilterButton(),!u&&"page"!==e&&this.renderSortButton(),this.renderAutomationSettingsButton(),!u&&"page"!==e&&this.renderSearch(),g&&this.renderPageViewSearch(),this.renderFullScreenButton(),v,this[Fne]())})),d&&a()(Je.Z,{id:"no_date_count",[She]:this[She],reducer:d,[_ne]:this[ihe].noDateResultStore})),a()("div",{[Ede]:this[Lne]()},void 0,this[Ane](),this.renderFilterBar()))}renderLockIndicator(){const{[Xae]:e}=this[The],{[jde]:t}=this[Yde];if(!this[Bae]()&&!e[Kne]&&t.canEditCollection())return a()(Ire.Z,{[jde]:t,[qae]:!1,isInlineCollection:!0,disableTooltip:!0,buttonStyle:{[Rle]:4,[Ble]:4}})}renderViewTabBar(){return a()(Sre,{[She]:this[She],[xle]:this[xle],[aae]:this[aae],onViewClick:this.handleViewClick})}renderFullScreenButton(){const{[jde]:e}=this[Yde];if(this[Bae]())return;const t=(0,se.ZP)({[jde]:e,fullyQualified:!1,[Vne]:f.tY.Expand}),i=ne.default[Ene](Dhe.openFullscreenPageButtonTooltip);return a()(at.Z,{[Zne]:()=>i,[One]:e=>c[Ude](pn.Z,n()({ariaLabel:i,href:t,[ole]:this.handleOpenAsPageClick,icon:S.Z.openAsPageThick,[Ede]:this[Rne](),[Bne]:{fill:this[Lde][_de],[Ade]:16}},e))})}renderAutomationSettingsButton(){const{[She]:e}=this,t=this[ede](),i=null==t?void 0:t[Bde](),o=e[kde],s=o[Qde][rhe],r=(0,we.n)(o),l=ke.default[wle](Mne),d=Bhe({isStatusAutomationExperimentEnabled:l,tab:r}),h=e.aliveAutomationCount[Qde];if("page"!==i&&l&&!this[aae][Qde])return a()(at.Z,{[Zne]:()=>ne.default[Ene](Dhe.openAutomationsSettingsButtonTooltip),[One]:e=>c[Ude](pn.Z,n()({ariaLabel:ne.default[Ene](Dhe.openAutomationsSettingsButtonAriaLabel),[tle]:X.collectionAutomationEditView,icon:0===h?S.Z.bolt:S.Z.boltFilled,[Ede]:this[Rne](),[Bne]:{[Ade]:void 0,[Qne]:14,fill:this[Lde][_de]},hovered:s&&d,[ole]:this.handleViewAutomationSettingsClick},e))})}renderViewSettingsButton(){const{[She]:e}=this,t=this[ede](),i=null==t?void 0:t[Bde](),o=e[kde],s=o[Qde][rhe],r=e[Wde][Qde],l=(0,we.n)(o),d=!Bhe({isStatusAutomationExperimentEnabled:ke.default[wle](Mne),tab:l});if("page"!==i&&(r[$le]||"collectionTypedView"===e[tae])&&!this[aae][Qde])return a()(at.Z,{[Zne]:()=>a()(P.FormattedMessage,{[Ihe]:"Edit view layout, grouping and more...",id:"database.collectionViewBlock.openViewSettingsButton.tooltip"}),[One]:e=>c[Ude](pn.Z,n()({[tle]:X.collectionEditView,icon:S.Z.dots,[Ede]:this[Rne](),[Bne]:{[Ade]:void 0,[Qne]:3,fill:this[Lde][_de]},hovered:s&&d,[ole]:this.handleViewSettingsClick},e,{[Dne]:function(){for(var t,i=arguments[ade],o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];null===(t=e[Dne])||void 0===t||t.call(e,...o)}}))})}renderFilterButton(){const{[Xae]:e}=this[The],{createFilterSettingsStore:t}=this[ihe];if(this[Hle]()&&!this[aae][Qde])return a()(nt.ZP,{popupType:e[qae]?tt.Z4[Pne]:tt.Z4.Popup,[rhe]:t[Qde][rhe],origin:this.renderFilterButtonOrigin(),onDismiss:this.handleCreateFilterPopupDismiss,originGap:4,[One]:this.renderCreateFilterPopup})}renderFilterButtonOrigin(){const e=this.hasAppliedFilter[Qde];return a()(rt.Z,{[Ede]:this[Ine](e),isBlue:e,[ole]:this.handleFilterClick},void 0,a()(P.FormattedMessage,{[Ihe]:"Filter",id:"collectionViewBlock.action.filter.title"}))}renderSortButton(){const{[Xae]:e}=this[The];if(!this[Hle]()||this[aae][Qde])return;const{createSortSettingsStore:t}=this[ihe];return a()(nt.ZP,{popupType:e[qae]?tt.Z4[Pne]:tt.Z4.Popup,[rhe]:t[Qde][rhe],origin:this.renderSortButtonOrigin(),onDismiss:this.handleCreateSortPopupDismiss,originGap:4,[One]:this.renderCreateSortPopup})}renderSortButtonOrigin(){const e=this.hasSort[Qde];return a()(rt.Z,{[Ede]:this[Ine](e),isBlue:e,[ole]:this.handleSortClick},void 0,a()(P.FormattedMessage,{[Ihe]:"Sort",id:"collectionViewBlock.action.sort.title"}))}renderSearch(){const{[She]:e}=this;if(!this[Hle]()||this[aae][Qde])return;const t=e.searchOpen[Qde],i=e[bae][Qde];return c[Ude](c.Fragment,null,a()(pn.Z,{icon:S.Z[xne],[Bne]:{[Ade]:14,[Qne]:void 0,fill:this[Lde][_de]},[Ede]:this[Rne](),[ole]:this.handleSearchButtonClick}),a()(NR.Z,{[ide]:t,animationStyle:{[Ade]:150,[Hne]:1},enterAnimationStyle:{[Ade]:0,[Hne]:0},exitAnimationStyle:{[Ade]:0,[Hne]:0},[One]:()=>a()(jV.Z,{capture:t,allowEsc:!0,[One]:e=>c[Ude]("div",e,a()("div",{[Ede]:{[Jne]:jne,[Gne]:Tne,[Cne]:kne}},void 0,a()(Cre.Z,{[Ede]:this.getSearchInputStyle(),[Gle]:Cre.Z.Format[bne],value:i,[Sne]:this[kae],[wne]:ne.default[Ene](Dhe[Phe]),focusInitial:t,[yne]:!0,onBlur:this.handleSearchBlur,onCancel:this[yae],[ole]:re.Wi,onClearButtonClick:this[yae],onKeyDown:this.handleSearchKeyDown})))})}))}renderPageViewSearch(){var e;const t=this[ede]();if("page"!==(null==t?void 0:t[Bde]()))return null;const i=null===(e=this[She][Ule]())||void 0===e?void 0:e.id;return i?a()(rt.Z,{[Ede]:{[Jne]:jne,[Gne]:Tne,[Fde]:14,[fne]:x.Z[fne].medium,[Ode]:this[Lde][_de]},[ole]:()=>{H.Kf({[The]:this[The],[vne]:"wiki-home-collection-view"}),Ve.ZP.updateFilters({ancestors:[i]})}},void 0,S.Z[xne]({[Ade]:14,fill:this[Lde][gne],[Ble]:6}),a()(P.FormattedMessage,{[Ihe]:"Search",id:"database.collectionViewBlock.pageView.search"})):null}[Fne](){const{[She]:e}=this,t=this[ede]();if("page"===(null==t?void 0:t[Bde]())||this[aae][Qde]||!e[mne]({overrideAllowForTypedViews:!0}))return;const i="collectionTypedView"===e[tae]?a()(P.FormattedMessage,{[Ihe]:"New {singleItemName}",id:"collectionViewBlock.action.newItem.typedDatabaseTitle",[Tle]:{singleItemName:ne.default[Ene]((0,y.hf)(e.databaseType))}}):a()(P.FormattedMessage,{[Ihe]:"New",id:"collectionViewBlock.action.newItem.nonTypedDatabaseTitle"}),o={[Rle]:8,[Fde]:14,[Qne]:28};if("collectionTypedView"===e[tae])return a()(kre.Z,{[ole]:this[fae],[Ede]:o},void 0,i);const s=e=>a()(Dre.Z,{title:i,[Ode]:"blue",[ole]:this[fae],dropdownEvents:e,[Ede]:o,[tle]:X.collectionViewItemAdd});return a()(tt.ZP,{popupType:this[The][Xae][qae]?nt.kQ[Pne]:nt.kQ.Popup,[One]:this.renderTemplatesPopup,originGap:4,[ole]:this.handleTemplatesDropdownClick,renderOrigin:e=>this[kle]()?a()(ER.Z,{[jde]:this[Yde][jde],origin:s(e),isFirstTooltip:!0,phase:pne}):s(e),buttonPopupStore:this[ihe][nhe]})}renderNoDateButton(){const e=this.noDateTotal[Qde],{[She]:t}=this,i=t[Wde][Qde];if(t[Kde]()&&0!==e&&i[$le])return a()(tt.ZP,{popupType:this[The][Xae][qae]?nt.kQ[Pne]:nt.kQ.Popup,[One]:this.renderNoDatePopup,[ole]:this.handleNoDateButtonClick,renderOrigin:t=>c[Ude](rt.Z,n()({isGray:!0,[Ede]:this[Ine](!1)},t),a()(P.FormattedMessage,{[Ihe]:"No date ({noDateTotal})",id:"collectionViewBlock.action.noDateButton.noProperty.label",[Tle]:{noDateTotal:e}}))})}renderFilterBar(){const{[She]:e}=this,t=e[dde][Qde],i=this[ede]();if("page"!==(null==i?void 0:i[Bde]())){if(!t){const t=e[une][Qde];if(!t)return;return a()("div",{[Ede]:{[Jne]:jne,[cne]:9}},void 0,a()("div",{[Ede]:{[jne]:1}}),a()(bre.v,{[She]:e,completeSprintAutomationContext:t}))}return a()(H9.Z,{[She]:this[She],[xle]:this[xle],createFilterSettingsStore:this[ihe].filterBarCreateFilterSettingsStore,[ohe]:this[ihe][ohe]})}}[Ane](){if(!this[aae][Qde])return this[She].shouldShowSource[Qde]?a()(G9,{[jde]:this[Yde][jde],[She]:this[She],[Bae]:this[Bae](),[xle]:this[xle],[zne]:this[zne]()}):void 0}renderView(e,t,i,o,s,r){const{[jde]:l}=this[Yde],{[She]:d}=this,h=!this[zne]();"rendered"!==ge.default[Qde].renderPhase&&ge.default[lde]({...ge.default[Qde],renderPhase:"rendered"});const u=this[Bae](),p=this[Jde](),m=this[hne](),g=this[Kle]();let v=this[$de][Qde];if(v){if(!e&&this[She].hasSingleCollection())return this.renderNoSourcePlaceholder(i);if(this[aae][Qde])return this.renderNoSourceExternalCollectionPlaceholder(i);if("table"===i)return c[Ude](WX,n()({key:t.id,schema:o,[Gle]:r,query:s,[jde]:l,[She]:d,[xle]:this[xle],isScrolled:this.isCollectionScrolled[Qde],[Bae]:u,[Jde]:p},v,{[ane]:this.getMinWidth(),[lne]:this[dne](i),[rle]:h,[nne]:m,[Fle]:g,[she]:this[ihe][she]}));if("board"===i)return c[Ude](yT,n()({key:t.id,schema:o,[Gle]:r,query:s,[jde]:l,[She]:d,[Bae]:u,[Jde]:p},v,{[lne]:this[dne](i),[rle]:h,[nne]:m,[Fle]:g}));if("page"===i){const e=t[sae]().page_pointer,i=d[kde];if(!e)return a()("div",{[Ede]:{[Fde]:17,[fne]:x.Z[fne].medium,[Ode]:this[Lde][rne],[sne]:Tne,[cne]:20,[Jne]:one,[Ade]:"100%"}},void 0,a()(P.FormattedMessage,{[Ihe]:"No page specified",id:"collectionViewBlock.noPagePlaceholder.title"}),a()("div",{[Ede]:{[Fde]:11}},void 0,a()(Bo.Z,{[ole]:()=>V[wde]({[She]:d,[ehe]:i})},void 0,"Enter a page ID to continue")));const o=this[Jle]((()=>l.id===e.id?l:Ee.G[mle](l,{table:e.table,id:e.id}))),s=(0,Q.getPageViewBlockDefaultPaddingLeftRight)(this[The]);return a()(Pre.Z,{[the]:Me.S.CollectionPageView,[jde]:o[Qde],[lne]:Pre.Z[lne](this[The]),[Xde]:s,[qde]:s,pageCoverHeight:0,[rle]:this[Yde][jde][Nde]()||this[Yde][rle],loadingContainerStore:void 0,preventDefaultTitleTabBehavior:!0,preventDefaultTitleUntabBehavior:!0})}return"calendar"===i?c[Ude](lD,n()({key:t.id,schema:o,[Gle]:r,query:s,[jde]:l,[She]:d,[Bae]:u,[Jde]:p},v,{[ane]:this.getMinWidth(),[lne]:this[dne](i),[rle]:h,[nne]:m,[Fle]:g})):"list"===i?(this[Ale][Qde]&&(v={...v,[qde]:24}),c[Ude](CB,n()({key:t.id,schema:o,[Gle]:r,query:s,[jde]:l,[She]:d,[Bae]:u,[Jde]:p},v,{[ane]:this.getMinWidth(),[lne]:this[dne](i),[rle]:h,[nne]:m,[Fle]:g}))):"gallery"===i?c[Ude](wS,n()({key:t.id,schema:o,[Gle]:r,query:s,[jde]:l,[She]:d,[Bae]:u,[Jde]:p},v,{[ane]:this.getMinWidth(),[lne]:this[dne](i),[rle]:h,[nne]:m,[Fle]:g})):"timeline"===i?c[Ude](S7,n()({key:t.id,schema:o,[Gle]:r,query:s,[jde]:l,[She]:d,[Bae]:u,[Fle]:g,[Jde]:p,[ane]:this.getMinWidth(),[lne]:this[dne](i),[rle]:h,[nne]:m,[xle]:this[xle],ref:this.timelineViewRef},v)):void 0}}renderNoSourcePlaceholder(e){const t=this[Bae](),i=this[She][Wde][Qde],o=this[She][kde][Qde][rhe],s={[Jne]:"inline",[Vde]:"1px 2px",[ine]:3,[tne]:ene};return a()("div",{[Ede]:{...this[$de][Qde],[Jre]:8,[lne]:t?void 0:this[dne](e),[Qne]:250,[Jne]:jne,[Gne]:Tne,[jre]:Tne}},void 0,a()("div",{[Ede]:{[qde]:o?FE.nJ:void 0}},void 0,S.Z.folderUnknownLarge({[Qne]:48,fill:this[Lde][Yre],margin:"0 auto"}),a()("div",{[Ede]:{[Fde]:17,[fne]:x.Z[fne].medium,[Ode]:this[Lde][rne],[sne]:Tne,[Xre]:-2}},void 0,a()(P.FormattedMessage,{[Ihe]:"No data source",id:"collectionViewBlock.noSourcePlaceholder.title"})),i[ude]&&a()("div",{[Ede]:{margin:"0 auto",[Ade]:"max-content",[Fde]:14,[Ode]:this[Lde][rne]}},void 0,a()(P.FormattedMessage,{[Ihe]:"<button>Select a data source</button> to continue",id:"collectionViewBlock.setSourceButton.title",[Tle]:{[qre]:e=>a()(Bo.Z,{[Ede]:s,[ole]:this.handleSetSourceClick},void 0,e)}}))))}renderNoSourceExternalCollectionPlaceholder(e){var t;const i=this[Bae](),o=this[She][Wde][Qde],s=this[She][kde][Qde][rhe],r={[Jne]:"inline",[Vde]:"1px 2px",[ine]:3,[tne]:ene},n=this.getExternalIntegrationId[Qde],l=Ce.Z[Qre][Qde].find((e=>e.id===n)),d=!(this[The][Xae].isMobileBrowser&&this[aae][Qde]&&!this.isUserAuthenticated());if(l)return a()("div",{[Ede]:{...this[$de][Qde],[Jre]:8,[lne]:i?void 0:this[dne](e),[Qne]:250,[Jne]:jne,[Gne]:Tne,[jre]:Tne}},void 0,a()("div",{[Ede]:{[qde]:s?FE.nJ:void 0,[Jne]:jne,[Yne]:Xne,[Gne]:Tne}},void 0,a()(Vo.Z,{icon:null===(t=this[She][Kde]())||void 0===t?void 0:t.getIcon(),size:48,[rle]:!0,isEmptyPage:!1}),a()("div",{[Ede]:{[Fde]:17,[fne]:x.Z[fne].medium,[Ode]:this[Lde][rne],[sne]:Tne,[Xre]:-2}},void 0,a()(P.FormattedMessage,{[Ihe]:"{integrationName}",id:"collectionViewBlock.setExternalSource.title",[Tle]:{[$re]:l.name}})),o[ude]&&a()("div",{[Ede]:{margin:"0 auto",[Ade]:"max-content",[Fde]:14,[sne]:"center",[Ode]:this[Lde][rne]}},void 0,d&&a()(P.FormattedMessage,{[Ihe]:"<button>Link to {integrationName}</button> to continue",id:"collectionViewBlock.setExternalSourceButton.title",[Tle]:{[$re]:l.name,[qre]:e=>a()(Bo.Z,{[Ede]:r,[ole]:this.handleSetSourceClick},void 0,e)}}))))}[Nne](){const e=this[She].shouldShowSpinner[Qde];return c[Ude](gA.Z,n()({key:"loading-spinner",show:e},ie.collectionViewLoadingSpinnerThrottles,{[One]:e=>e?a()("div",{[Ede]:{[Jne]:jne,[Gne]:Tne,[Yne]:Xne,[Ble]:4}},void 0,a()(cu.Z,{[Ede]:{[Ade]:14,[Qne]:14}})):void 0}))}renderBottomBorderForViewSettings(){const{[She]:e}=this;if(e[kde][Qde][rhe]&&"sidebar"===this[ihe][she][Qde])return a()("div",{[Ede]:{...this[$de][Qde],...this[Vle][Qde],borderTop:`1px solid ${this[Lde][Ure]}`,[Qne]:12}})}renderMultiSelectToolbar(){if((0,ie.shouldShowBulkActionsToolbar)({[The]:this[The],[She]:this[She]})){var e;const t=(null===(e=this[$de][Qde])||void 0===e?void 0:e[Xde])??0,i=this[Vle][Qde][Rle]??0;return a()(EE,{[Rle]:t+i})}}unsubscribeAll(){for(const e of this[mhe][Tle]())e[khe]();this[phe]&&this[phe][khe]()}[ale](){var e;const t=null===(e=this[lae]())||void 0===e?void 0:e[Ole]();return Boolean(t&&(0,w.Ev)(t))}isUserAuthenticated(){const e=this[She][Kde]();if(!e)return!1;const t=e[sae]()[_le],i=Ce.Z[Qre][Qde].find((e=>e.id===t));return!(!t||!i)&&(0,j.NP)(t)[ade]>0}createItem(e){const{[vae]:t,coerce:i,from:o}=e,{[She]:s}=this,{newStore:r}=E.createBlockInGroup({[The]:this[The],[She]:s,[ble]:[],results:this.getDefaultResults(),insertAtIndex:0,coerce:i,[zre]:i,[vae]:t,from:o}),n=this.isTasksDB()&&"on"===ke.default.getEligibleGroup({experimentId:"quick_capture_tasks_with_layer",defaultGroup:"control"})?"mini_peek":(0,ie.getPeekMode)(s[Rde]());N.peekBlock({[The]:this[The],[jde]:r,peekMode:n,resultsStore:void 0,[She]:s,[Vne]:f.tY.Create});const l=s.subitemTreeStore[Qde];return D.trackCreateBlock(this[The],{from:l.children?"collection_view_new_parent_item":"collection_view_new_item",[bde]:"page",new_page_id:r.id,...J.getCollectionAnalyticsContext(s)}),r}[vle](){const{[jde]:e}=this[Yde];return e[Kre]()}[ede](){return this[She][Rde]()}getDefaultCollectionViewStore(){var e;const t=this[vle]();if(null!==(e=t[0])&&void 0!==e&&e[Zde]())return t[0]}[lae](){return this[She][Kde]()}getMinWidth(){const{[jde]:e}=this[Yde],{[Xae]:t}=this[The],i=t[Kne],o=this[Bae](),s=this[wae](),r=("gallery"===s||("calendar"===s||"list"===s)&&o)&&this[Ale][Qde],n=(0,he.getTotalRightSidebarWidth)(this[The],this[Jde]()),l=Re.default[Qde];return o||this[Kle]()?i?`calc(100% - ${2*(0,Q.getPageViewBlockDefaultPaddingLeftRight)(this[The])}px - ${n}px)`:this[Jde]()?`calc(100% - ${2*Re.PeekModePadding.horizontal[l.mode]}px - ${n}px)`:this[Ale][Qde]?(0,he.getMainEditorFrameWidth)(this[The])+(r?(0,he.getCurrentSidePeekWidth)(this[The]):0):o?`calc(100% - ${2*(0,Q.getFullScreenCollectionPaddingLeftRight)(this[The])}px - ${n}px)`:(0,ie.isPageFullWidth)(e)?`calc(100% - ${2*(0,Q.getPageViewBlockDefaultPaddingLeftRight)(this[The])}px - ${n}px)`:Q.pageViewBlockDefaultWidth-2*(0,Q.getPageViewBlockDefaultPaddingLeftRight)(this[The])-n:`calc(100% - ${n}px)`}[Jde](){return(0,ie.isInPeekRenderer)(this[Yde][jde])}[hne](){return this[Jde]()?Be.Z:De.Z}resetLeftScrollAfterFlush(){m.default[Wae]((()=>{var e;const t=null===(e=this[yhe])||void 0===e?void 0:e.scrollerEl();if(t){t[Oae]=0;const e=de.xH(t);e&&(e[Oae]=0)}}))}[Bae](){return Boolean(this[Yde][Bae])}getDefaultResults(){const e=this[She].localResultStore[Qde],t=this[lae]();if(t&&e&&"reducer"===e[bde]){const i=h().find(e.reducerResults,(e=>"results"===e[bde]));if(i)return i.blockIds.map((e=>Ee.G[mle](t,{id:e,table:C.iU})))}return[]}navigate(e){this[the][Wre]?this[the][Wre](e):N.navigate({[The]:this[The],url:e})}[wae](){var e;const{[She]:t}=this,i=null===(e=t[Rde]())||void 0===e?void 0:e[Bde]();if(!i)throw new Error(Hre);return i}getNoDateProperty(){const e=this[She][Rde](),t=this[She][dle][Qde];if(!e||!t)return;const i=e[Bde]();return"timeline"===i&&t.timeline_by?t.timeline_by:"calendar"===i&&t.calendar_by?t.calendar_by:void 0}ensureStoreListeners(){const{[She]:e}=this,{[jde]:t}=this[Yde];e.blockIsPrivateStore[Qde];for(const i of t[Kre]())i[Ole]()}[ile](e,t,i){const{[jde]:o}=this[Yde],s=this[Bae](),r=this[Kle](),n=Re.default.isSidePeekClosing[Qde]?{[Xde]:0,[qde]:0}:this[$de][Qde],l=this[dne](e),a=this[She][kde][Qde][rhe];return{flexGrow:1,[ele]:0,...o[Nde]()&&{cursor:"default"},..."timeline"===e&&this[She][Kde]()&&!s&&!(0,te.fj)({[The]:this[The],[Bae]:s,[Fle]:r,[Gle]:t})&&n&&{[Rle]:n[Xde],[Ble]:n[qde],[Xre]:l},...a&&!s&&"sidebar"===this[ihe][she][Qde]&&{minHeight:FE.j9},...this[Ale][Qde]?{[qne]:"sticky",left:0,[Xde]:i,[Ade]:(0,he.getMainEditorFrameWidth)(this[The])}:{}}}[dne](e){return this[Yde][Bae]?"timeline"===e?96:180:"timeline"===e||"gallery"===e?0:fe.Z[Qde]}getHeaderWrapStyle(){const e=this[$de][Qde],t=(0,he.getMainEditorFrameWidth)(this[The]),i=(0,ie.isPageFullWidth)(this[Yde][jde])||this[Bae]()?t:Math.min(Q.pageViewBlockDefaultWidth,t),o=this[Ale][Qde]&&!Re.default.isSidePeekOpening[Qde];return{minHeight:Mre.L,[Xde]:null==e?void 0:e[Xde],[qde]:o?0:null==e?void 0:e[qde],[ele]:0,...(this[Bae]()||o)&&{[qne]:"sticky",zIndex:86,left:0,[Ade]:o&&e?i-(e[Xde]/2??0):void 0},...this[Yde][jde][Nde]()&&{cursor:"default"},...this[Vle][Qde]}}[Wne](){const{[She]:e}=this,t=this[wae](),i=e.viewIsFlushToTopbar(),o=("timeline"===t||"table"===t)&&i;return{[Jne]:jne,[Gne]:Tne,[Qne]:Mre.L,boxShadow:o?void 0:`inset 0 -1px 0 ${this[Lde][Ure]}`,...this[Lne]()}}[Lne](){const e=this[$de][Qde];return{left:null==e?void 0:e[Xde],[Ade]:"100%"}}getSearchInputStyle(){return{[Fde]:14,[Gre]:1,[qde]:4,[Ode]:this[Lde].regularTextColor,[Xre]:1}}[Ine](e){return{[Jne]:jne,[Gne]:Tne,[Fde]:14,[Qne]:28,[Vde]:6,[Ode]:e?this[Lde].blueColor:this[Lde][_de],[fne]:x.Z[fne].regular,[Gre]:1,[ine]:3}}[Rne](){return{[Jne]:jne,[Gne]:Tne,[Fde]:14,[Qne]:28,[Ade]:28,[Vde]:6,[Ode]:this[Lde][_de],fill:this[Lde][gne],[fne]:x.Z[fne].regular,[Gre]:1,[ine]:3}}[lle](e){return"page"===e?"page_view":e}[kle](){return this.canShowPmIntroTooltipStore[Qde]}[gae](){const e=ge.default[Qde][Xle],t=ge.default[Qde][qle];e&&t&&Z[Nre]({[The]:this[The],requiredCurrPhase:pne,nextPhase:Fre,[Xle]:e,[qle]:t})}projManagementTooltipTourComplete(){const e=ge.default[Qde][Xle],t=ge.default[Qde][qle];if(e&&t){"click_view_settings"===(0,q.jH)(e,t)&&Z[Nre]({[The]:this[The],requiredCurrPhase:void 0,nextPhase:"complete",[Xle]:e,[qle]:t})}}[yle](e){let{isFirstRender:t}=e;const i=pe.default.mark(Ore);pe.default[Iae](i,{[The]:this[The],[Pae]:()=>({...J[_re](this[She]),is_first_render:t})})}trackSwitchViewLag(){if(!this[che])return;const{from:e,to:t,metric:i,sizeHintAtStart:o}=this[che];pe.default[Iae](i,{[The]:this[The],[Pae]:()=>{const i=J[_re](this[She]),{[Sae]:s,[Lre]:r,...n}=i;return{from:e,to:t,did_trigger_fetch:this[She].isLoading[Qde],[Lre]:J.getRowCountCategory(o),...n}}}),this[che]=void 0}}function Bhe(e){const{isStatusAutomationExperimentEnabled:t,tab:i}=e;return t&&("automationSettings"===(null==i?void 0:i[bde])||"automationCreateSettings"===(null==i?void 0:i[bde])||"automationEditSettings"===(null==i?void 0:i[bde]))}Zhe.displayName="CollectionViewBlock",Zhe.contextTypes={...$.wK,...p.w};const Rhe=Zhe}}]);