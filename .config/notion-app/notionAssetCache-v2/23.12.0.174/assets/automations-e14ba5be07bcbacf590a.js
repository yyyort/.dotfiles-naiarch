"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[1655],{66580:(e,t,o)=>{o.r(t),o.d(t,{AutomationButtonActionList:()=>ci,PlacedButtonBlockEditor:()=>Xi,useButtonAnalysisStore:()=>Fi});var n=o(97464),i=o.n(n),r=o(77094),a=o.n(r),l=o(67294),s=o(480),c=o(81954),d=o(24405),u=o(3909),p=o(5366),m=o(98963),h=o(98114),g=o(12359),v=o(63362),y=o(97428),f=o(4615),S=o(97880),k=o(23223),b=o(98742),w=o(24457),C=o(63474),P=o(52275),T=o(78140),x=o(32163),M=o(72495),Z=o(58032),A=o(60442);const F=o(85).sFt,B=o(85).j_x,_=o(85).Gm5,V=o(85).EQe,I=o(85).D7I,D=o(85).Yzm,O=o(85).sM5;function K(e){window.__c={n:"AddActionMenu"};const{contextStore:t,onActionAdded:o,insertionPoint:n}=e,r=(0,p.useIntl)(),d=(0,s.O7)(),u=(0,C.D)(),m=(0,w.F)({width:280}),F=function(e){const{contextStore:t}=e,[o,n]=(0,l.useState)([]),i=(0,c.VK)((()=>(0,k.uV)(t[_][V],t[_].type)),[t[_][V],t[_].type]),r=(0,l.useMemo)((()=>(0,y.P)(O)),[]);return(0,c.VK)((async()=>{if(i){const e=await Promise.all(r.map((async e=>await e.isAvailableForContext(i))));return n(function(e){const t=e=>e?1:-1;return e.slice().sort(((e,o)=>t(o[O][B])-t(e[O][B])))}(r.filter(((t,o)=>e[o]))))}o.length>0&&n([])}),[i,o.length,r]),o}({contextStore:t}).map((e=>{const{[O]:s}=e;return{key:e.type,render:e=>{const t=t=>l[I](P.Z,i()({},(0,b.Z)(t??{},e),{icon:a()(R,{[O]:s}),disabled:!1,title:r[D](s.name)})),o=s.description;return o?a()(Z.Z,{renderTooltip:()=>a()(A.Z,{caption:r[D](o)}),placement:Z.Z.Placement.Right,delayThreshold:0,render:t}):t()},action:()=>{const i=(0,f.default)(),a=t[_][V];g.createAndCommit({userAction:"AutomationActionList.addAction",environment:d,perform:t=>{h.zY({actionId:i,actionType:e.type,[V]:a,environment:d,intl:r,transaction:t,insertionPoint:n})}}),(0,v.eI)(u,{automation_id:a.id,automation_action_id:i,automation_action_type:e.type}),o(i)}}})).filter(S.isDefined);return l[I](T.Z,m,a()(x.Z,{type:x.i.Vertical,sections:[{key:0,render:e=>l[I](M.Z,i()({enableActionSheetTitle:!0},e)),items:F}],initialFocus:0}))}function R(e){window.__c={n:"AddActionIcon"};const{[O]:t}=e,o=(0,d.yK)((e=>({icon:{width:13,height:13,fill:t[B]?e.blueColor:e.mediumIconColor},iconWrapper:{width:20,height:20,[O]:"flex",alignItems:"center",justifyContent:"center",background:t[B]?F:e.accentColors.gray[50],borderRadius:3,marginLeft:-2}})),[t[B]]);return a()("div",{style:o.iconWrapper},void 0,t.icon(o.icon))}var L=o(23290),W=o(82990),E=o(9953),H=o(92223),z=o(5971),Q=o(89733),G=o(29502),U=o(28267),N=o(1533),q=o(23063),Y=o(31945),j=o(50478),J=o(73063),X=o(91839),$=o(44532),ee=o(27186);const te=o(85).ZWt,oe=o(85).rG,ne=o(85).wbK,ie=o(85).LCr,re=o(85).wgE,ae=o(85).Drs,le=o(85).JJj,se=o(85).zaB,ce=o(85).Gm5,de=o(85).EQe,ue=o(85).TtP,pe=o(85).ESK,me=o(85).ccq,he=o(85).Yzm,ge=o(85).I3e,ve=o(85).ewQ,ye=o(85).sFt,fe=o(85).j_x,Se=o(85).X_m,ke=o(85).tBn,be=o(85).D7I,we=o(85).rpY,Ce=o(85).Bgg,Pe=o(85).AEP,Te=o(85).i7F,xe=o(85).T4J,Me=o(85).H1U,Ze=o(85).jkI,Ae=o(85).sM5,Fe=o(85).pkR,Be=o(85).nx5,_e=(0,p.defineMessages)({moreActionsButtonAriaLabel:{[Be]:"More actions",id:"buttonBlock.button.moreActionsButtonAriaLabel"}});function Ve(e){window.__c={n:"AutomationActionHeader"};const{contextStore:t,actionStore:o,[Fe]:n,dragging:i,title:r,picker:s,onActionAdded:u}=e,p=(0,l.useRef)(null),m=(0,U.X)(p),h=(0,l.useMemo)((()=>Boolean(m&&m.width<320)),[m]),g=(0,c.qz)(void 0,N.Z),v=(0,c.VK)((()=>i||g.state.hovered),[i,g]),f=(0,d.yK)((e=>({iconHandle:{[Ae]:"flex",justifyContent:Ze,left:0,position:"absolute",top:0,width:24},iconWrap:{position:"relative",width:24},nameRow:{[Ae]:"flex",[Me]:h?"flex-start":Ze},name:{flexGrow:1,fontWeight:W.Z.fontWeight.medium,[Ae]:"flex",overflow:"hidden",...h?{flexDirection:"row",flexWrap:"wrap",marginLeft:8,[Me]:Ze}:{[Me]:Ze,marginLeft:8}},title:{whiteSpace:"nowrap"},picker:{position:"relative",left:-4,...h?{flexShrink:1,[Ae]:"inline-flex",minWidth:0}:{flexGrow:1,width:0}}})),[h]),S=(0,c.VK)((()=>o.getType()),[o]);if(!S)return null;const k=(0,y.z)(S),{[Ae]:b}=k;return l[be]("div",{onMouseLeave:e=>Q[xe]({store:g,event:e,[Fe]:n}),onMouseMove:e=>Q[Te]({store:g,event:e,[Fe]:n}),style:f.nameRow,ref:p},a()("div",{style:f.iconWrap},void 0,a()(q.Z,{[Ce]:!0,animationStyle:{[Pe]:v?0:1},enterAnimationStyle:{[Pe]:1},exitAnimationStyle:{[Pe]:1},[we]:()=>a()(Ie,{[Ae]:b})}),a()(q.Z,{[Ce]:!n,animationStyle:{[Pe]:v?1:0},enterAnimationStyle:{[Pe]:0},exitAnimationStyle:{[Pe]:0},[we]:()=>a()("div",{style:f.iconHandle},void 0,a()(j.ZP,{hideClickMessage:!0}))})),a()("div",{style:f.name},void 0,a()("div",{style:f.title},void 0,r),!h&&l[be](l[ke],null,"Â "),s&&a()("div",{style:f.picker},void 0,s)),!n&&a()(De,{contextStore:t,actionStore:o,onActionAdded:u}))}function Ie(e){window.__c={n:"ActionIcon"};const{[Ae]:t}=e,o=(0,d.yK)((e=>({iconWrap:{width:24,[Se]:24,[Ae]:"flex",[Me]:Ze,borderRadius:4,background:t[fe]?ye:e[ve].gray[50],flexShrink:0},icon:{width:14,[Se]:14,fill:t[fe]?e.blueColor:e[ve].gray[500],margin:"0 auto"}})),[t[fe]]);return a()("div",{style:o.iconWrap},void 0,t.icon(o.icon))}function De(e){window.__c={n:"MoreActionsButton"};const{contextStore:t,actionStore:o,onActionAdded:n}=e,r=(0,p.useIntl)(),s=(0,G.d)(),[c,d]=(0,l.useState)(ge),[m,h]=l.useState(void 0);return l[be](l[ke],null,a()(Y.ZP,{popupType:s,alignmentToOrigin:Y.vR.Center,[me]:Y.pO.Bottom,originGap:0,renderOrigin:e=>l[be](J.Z,i()({ariaLabel:r[he](_e.moreActionsButtonAriaLabel),icon:u.Z.dots},e)),[we]:t=>l[be](Ke,i()({onClose:()=>t.close(),onAddStep:e=>{h(new DOMRect(ee.pointerState.x,ee.pointerState.y,1,1)),d(e?"above":"below"),t.close()}},e))}),a()($.ZP,{popupType:s,open:"closed"!==c,originRect:m,[me]:$.ZP[pe].Bottom,alignmentToOrigin:$.ZP.Alignment.Center,[we]:()=>a()(K,{contextStore:t,onActionAdded:e=>{n(e),d(ge)},insertionPoint:"above"===c?{beforeActionId:o.id}:{afterActionId:o.id}}),onDismiss:()=>d(ge)}))}function Oe(e,t,o){if(t<0||t>=e[ue]||o<0||o>=e[ue])return e;const n=[...e];return n[t]=e[o],n[o]=e[t],n}function Ke(e){window.__c={n:"MoreActionsMenu"};const{onClose:t,contextStore:o,actionStore:n,onAddStep:r}=e,d=(0,p.useIntl)(),y=(0,s.O7)(),f=(0,C.D)(),k=(0,c.VK)((()=>o[ce][de]),[o]),b=(0,c.VK)((()=>k.getActionIds()),[k]),[Z,A]=(0,l.useState)(!1),F=b[ue]<m.FT,B=b.indexOf(n.id),_=0===B,V=B===b[ue]-1,I=(0,w.F)(),D={key:se,action:async()=>{A(!0);const e=g[le]({[ae]:"AutomationAction.duplicateAction",[re]:y,perform:e=>h.AN({actionStore:n,[de]:k,[re]:y,intl:d,[ie]:e})});n.isDefined()&&(0,v.eI)(f,{[ne]:o[ce][de].id,automation_action_id:n.id,automation_action_type:n.getType(),from:se});try{await e.performResult.onComplete}finally{A(!1)}t()},[we]:e=>{const t=Z?a()(X.Z,{}):u.Z[se]({[Se]:16,width:16}),o=a()(p.FormattedMessage,Z?{id:"automations.duplicatingActionButton.label",[Be]:"Duplicating..."}:{id:"automations.duplicateBelowActionButton.label",[Be]:"Duplicate below"});return l[be](P.Z,i()({},e,{[Fe]:Z,icon:t,title:o}))}},O={key:oe,action:()=>{g[le]({[ae]:"AutomationAction.removeAction",[re]:y,perform:e=>{h.sl({[te]:o[ce],actionStore:n,[ie]:e}),n.isDefined()&&(0,v.co)(f,{[ne]:o[ce][de].id,automation_action_id:n.id,automation_action_type:n.getType()})}}),t()},[we]:e=>l[be](P.Z,i()({},e,{icon:u.Z.trash({[Se]:16,width:16}),title:a()(p.FormattedMessage,{id:"automations.deleteActionButton.label",[Be]:"Delete"})}))},K=[!0,!1].map((e=>{if(!(e&&_||!e&&V))return{key:e?"moveUp":"moveDown",action:()=>{g[le]({[ae]:"AutomationAction.moveAction",[re]:y,perform:t=>{let n;n=Oe(b,e?B-1:B+1,B),h.kM({[te]:o[ce],[ie]:t,newActionIds:n})}}),t()},[we]:t=>l[be](P.Z,i()({},t,{icon:(e?u.Z.arrowUp:u.Z.arrowDown)({width:16,[Se]:16}),title:a()(p.FormattedMessage,e?{id:"automations.moveUpButton.label",[Be]:"Move up"}:{id:"automations.moveDownButton.label",[Be]:"Move down"})}))}})).filter(S.isDefined),R=[!0,!1].map((e=>({key:e?"addStepAbove":"addStepBelow",action:()=>{r(e)},[we]:t=>l[be](P.Z,i()({},t,{disabledFeedback:!0,icon:e?u.Z.insertUp({width:16,[Se]:16}):u.Z.insertDown({width:16,[Se]:16}),title:a()(p.FormattedMessage,e?{id:"automations.addStepAboveButton.label",[Be]:"Add step above"}:{id:"automations.addStepBelowButton.label",[Be]:"Add step below"})}))})));return l[be](T.Z,I,a()(x.Z,{type:x.i.Vertical,sections:[...K[ue]>0?[{key:"movement",[we]:e=>l[be](M.Z,i()({enableActionSheetTitle:!0},e)),items:K}]:[],...F?[{key:"addSteps",[we]:e=>l[be](M.Z,i()({enableActionSheetTitle:!0,topBorder:!0},e)),items:R},{key:se,[we]:e=>l[be](M.Z,i()({enableActionSheetTitle:!0,topBorder:!0},e)),items:[D]}]:[],{key:oe,[we]:e=>l[be](M.Z,i()({enableActionSheetTitle:!0,topBorder:!0},e)),items:[O]}],initialFocus:0}))}var Re=o(87494),Le=o(68214),We=o(96486),Ee=o.n(We),He=o(21202),ze=o(39098),Qe=o(40071),Ge=o(76798),Ue=o(38752);const Ne=o(85).sfC,qe=o(85).Uk6,Ye=o(85).dLQ,je=o(85).T7S,Je=o(85).D7I,Xe=o(85).nx5,$e=o(85).PzB,et=o(85).fIn,tt=o(85).B3e,ot=o(85).Dd5,nt=o(85).oWD;function it(e){window.__c={n:"AutomationCollectionTemplatePicker"};const{[nt]:t,currentTemplateId:o,[ot]:n,disabled:r,errorMessage:d}=e,u=(0,s.O7)(),{device:m}=u,h=(0,c.VK)((()=>{let e=o;if(!e&&t){const o=t.getFormat()[tt];o&&"empty"!==o&&(e=o.template_page_id)}if(e&&t)return ze.G.createChildStore(t,{table:He.iU,id:e,spaceId:t.getSpaceId()})}),[t,o]),g=(0,G.d)(),v=(0,Ue.d)({errorMessage:d,hasValue:!0}),y=(0,c.VK)((()=>{var e;return(null==t||null===(e=t[et]())||void 0===e?void 0:e.filter((e=>e[$e]())))??[]}),[t]),f=Boolean(o);return a()(Y.ZP,{popupType:g,alignmentToOrigin:Y.vR.End,placementToOrigin:Y.pO.Bottom,originGap:0,disabled:r,renderOrigin:e=>l[Je](Ue.S,i()({},v,e,{disabled:r,style:{minWidth:50}}),h&&(f||h[$e]())?a()(Ge.Z,{store:h}):a()(p.FormattedMessage,{id:"automations.templatePicker.buttonPlaceholder",[Xe]:"Empty"})),render:e=>{const o=(0,w.U)({device:m,width:280});return l[Je](T.Z,o,t&&a()(rt,{[nt]:t,templatePageStores:y,parent:e,[ot]:n}))}})}function rt(e){window.__c={n:"AutomationCollectionTemplateMenuList"};const{[nt]:t,templatePageStores:o,parent:n,[ot]:r}=e,d=(0,s.O7)(),{device:u}=d,m=(0,c.VK)((()=>t[je]()),[t]),h=o.map((e=>({key:e.id,render:o=>l[Je](Qe.Z,i()({},o,{key:e.id,isOverlay:!0,[nt]:t,[qe]:!1,[Ne]:e,[Ye]:u[Ye],locked:!0,isDefault:m===e,onCancelClick:()=>{},draggable:!1})),action:t=>{r(e.id),n.close()}}))),g={key:"empty",render:e=>l[Je](Qe.Z,i()({},e,{key:"empty",isOverlay:!0,[nt]:t,[qe]:!1,[Ne]:void 0,[Ye]:u[Ye],locked:!0,onCancelClick:()=>{},draggable:!1})),action:e=>{r(void 0),n.close()}};return a()(x.Z,{type:x.i.Vertical,initialFocus:0,sections:[{key:"results",render:e=>l[Je](M.Z,i()({},e,{title:a()(p.FormattedMessage,{id:"automations.templatePicker.menuHeader",[Xe]:"Select a template"})})),items:Ee().compact([...h,m?void 0:g])}]})}const at=o(85).D7I,lt=o(85).oWD,st=o(85).MQM,ct=o(85).Dd5,dt=o(85).f4X,ut=o(85).NLk,pt=o(85).jkI,mt=o(85).H1U,ht=o(85).nx5,gt=o(85).v1$,vt=o(85).BP7,yt=o(85).JJj,ft=o(85).PzB,St=o(85).fIn,kt=o(85).PwI,bt=o(85).FH8,wt=o(85).tqF,Ct=o(85).pkR;var Pt=o(43250),Tt=o(12534),xt=o(61134),Mt=o(68709),Zt=o(17748),At=o(92628);const Ft=o(85).Xls,Bt=o(85).Yzm,_t=o(85).bSA,Vt=o(85).lGm,It=o(85).kUS,Dt=o(85).wgE,Ot=o(85).JJj,Kt=o(85).opx,Rt=o(85).D7I,Lt=o(85).pkR,Wt=o(85).nx5,Et=(0,p.defineMessages)({aboveButtonLabel:{id:"automations.DuplicateBlocksAction.aboveButtonLabel",[Wt]:"Above button"},belowButtonLabel:{id:"automations.DuplicateBlocksAction.belowButtonLabel",[Wt]:"Below button"}});function Ht(e){window.__c={n:"DuplicateBlocksActionEditor"};const{actionStore:t,[Lt]:o,contentParentPointer:n}=e,i=(0,s.O7)(),r=(0,d.yK)((e=>({listWrap:{background:e.contentBackground,boxShadow:e.inputBoxShadow,padding:"3px 9px",borderRadius:5,minHeight:64,..."dark"===e.mode?{backgroundColor:e.inputBackground}:{}},[Kt]:{caretColor:e.mediumTextColor,color:e.lightTextColor,fontSize:14,padding:"5px 0",display:"inline-block"}})),[]),u=(0,c.VK)((()=>ze.G.createChildStore(t,n)),[t,n]),m=(0,c.VK)((()=>u.getContentStore()),[u]),v=(0,l.useCallback)((e=>{(0,Tt.ZP)({event:e,context:Tt.Af.EditorClick,callback:()=>{if(!m)return;(m.getValue()||[]).length>0||g[Ot]({userAction:"DuplicateBlocksAction.handleListClick",[Dt]:i,perform:e=>{h.Nj({[Dt]:i,parentStore:m,transaction:e})}})}})}),[i,m]);return m?l[Rt](l.Fragment,null,a()(At.Z,{store:u,[_t]:"duplicate_blocks_action",isListContainer:!0},void 0,a()(Mt.p,{allowSelectionWithin:!0},void 0,a()("div",{style:r.listWrap,onClick:v,[Vt]:Pt.focusableWithin},void 0,a()(xt.O,{[It]:"DuplicateBlocksActionContent",[Lt]:o},void 0,a()(Zt.Z,{[Lt]:o,store:m,[Kt]:a()("div",{style:r[Kt]},void 0,a()(p.FormattedMessage,{id:"automations.DuplicateBlocksAction.emptyPlaceholder",[Wt]:"Click to edit or drop blocks hereâ¦"})),disableCommentMenu:!0,disableHoverMenu:!1,disableDrag:!1})))))):null}const zt={before:{icon:u.Z.insertUp({width:16}),key:"before",title:Et.aboveButtonLabel},after:{icon:u.Z.insertDown({width:16}),key:"after",title:Et.belowButtonLabel}};function Qt(e){window.__c={n:"InsertBlockInDropdownButton"};const{actionStore:t,[Lt]:o}=e,n=(0,p.useIntl)(),r=(0,d.yK)((e=>({button:{fontWeight:"normal"}})),[]),s=(0,G.d)(),u=(0,c.VK)((()=>t.getInsertionPoint()),[t]),m=Object.values(zt),h=m.find((e=>e.key===u));return h?a()(Y.ZP,{popupType:s,alignmentToOrigin:Y.vR.End,[Lt]:o,placementToOrigin:Y.pO.Bottom,originGap:0,renderOrigin:e=>l[Rt](Ue.S,i()({[Lt]:o,style:r.button,variant:"gray"},e),n[Bt](h.title)),render:e=>a()(Gt,{actionStore:t,[Ft]:h,options:m,parent:e})}):null}function Gt(e){window.__c={n:"InsertBlockInDropdownMenu"};const{actionStore:t,[Ft]:o,options:n,parent:r}=e,c=(0,s.O7)(),d=(0,p.useIntl)(),u=(0,l.useCallback)((e=>{g[Ot]({userAction:"DuplicateBlocksAction.setInsertionPoint",[Dt]:c,perform:o=>{E.updateValue({store:t.getConfigStore(),data:{insertion_point:e},transaction:o})}})}),[c,t]),m=(0,w.F)({maxWidth:360}),h=n.map((e=>({key:e.key,render:t=>l[Rt](P.Z,i()({},t,{checkState:o.key===e.key,icon:e.icon,title:d[Bt](e.title)})),action:()=>{u(e.key),r.close()}})));return l[Rt](T.Z,m,a()(x.Z,{initialFocus:0,sections:[{key:0,render:e=>l[Rt](M.Z,i()({enableActionSheetTitle:!0},e)),items:h}],type:x.i.Vertical}))}var Ut=o(72865),Nt=o(10052);const qt=o(85).cZW,Yt=o(85).Yzm,jt=o(85).D7I,Jt=o(85).BP7,Xt=o(85).dL6,$t=o(85).sM5,eo=o(85).pkR,to=o(85).nx5,oo=(0,p.defineMessages)({confirmationInputPlaceholder:{[to]:"Write a message to show usersâ¦",id:"automations.BaseModalAction.confirmationPlaceholder"},continueButtonHint:{[to]:"Completes button action",id:"automations.BaseModalAction.continueButtonHint"},cancelButtonHint:{[to]:"Stops button action",id:"automations.BaseModalAction.cancelButtonHint"}});function no(e){window.__c={n:"WithRightOverlay"};const{children:t,overlayContent:o}=e,n=(0,d.yK)((e=>({wrap:{position:"relative"},overlay:{position:"absolute",height:"100%",[$t]:"flex",alignItems:"center",top:0,right:10,color:e.lightTextColor}})),[]);return a()("div",{style:n.wrap},void 0,t,a()("div",{style:n.overlay},void 0,o))}var io=o(98421);const ro=o(85).L_E;function ao(e){window.__c={n:"AutomationKeyValueRow"};const{keyComp:t,valueComp:o,style:n}=e,i=(0,d.yK)((()=>({[ro]:{display:"flex",alignItems:"center",justifyContent:"space-between",...n}})),[n]);return a()("div",{style:i[ro]},void 0,t,o)}function lo(e){return a()("div",{style:{marginRight:4,flexShrink:0}},void 0,e.text)}var so=o(84619),co=o(61766),uo=o(21396),po=o(29758);const mo=o(85).D7I,ho=o(85).nx5,go=o(85).Hnr,vo=o(85).TLr,yo=o(85).Dn1;function fo(e){window.__c={n:"AutomationPagePicker"};const{contextStore:t,actionStore:o,target:n,onChange:r,disabled:s,errorMessage:d}=e,u=(0,c.qz)(void 0,co.Z),m=(0,c.VK)((()=>{if(n&&"variable"===n.type)return t[yo](o.id,n.id)}),[n,t,o.id]),h=(0,G.d)(),g=(0,Ue.d)({errorMessage:d,hasValue:Boolean(n)}),v=(0,l.useCallback)((e=>{"page"!==e.type&&"variable"!==e.type||(r(e),u.reset())}),[r,u]),y=(0,l.useCallback)((()=>u.reset()),[u]);return a()(Y.ZP,{buttonPopupStore:u,popupType:h,alignmentToOrigin:Y.vR.End,placementToOrigin:Y.pO.Bottom,originGap:0,disabled:s,renderOrigin:e=>l[mo](Ue.S,i()({disabled:s},g,e),n&&"page"===n.type?a()(Ge.Z,{store:ze.G[vo](t.context[go],n.page)}):m?a()(uo.F,{value:m,format:so.l.Medium,isSingle:!0}):a()(p.FormattedMessage,{id:"automations.AutomationPagePicker.pagesDropdown.label",[ho]:"Select page"})),render:e=>a()(po.L,{actionId:o.id,automationContextStore:t,onChange:v,onClose:y,selectedTarget:n,skipCollections:!0})})}const So=o(85).D7I,ko=o(85).MQM,bo=o(85).nx5,wo=o(85).BP7,Co=o(85).JJj,Po=o(85).pkR;function To(e){window.__c={n:"OpenPageInDropdownButton"};const{actionStore:t,[Po]:o}=e,n=(0,d.Fg)(),r=(0,c.VK)((()=>t.getOpenPageIn()),[t]),s=(0,G.d)(),u=(0,io.v)({currentViewType:void 0,theme:n}).find((e=>e.key===r));return u?a()(Y.ZP,{popupType:s,alignmentToOrigin:Y.vR.End,placementToOrigin:Y.pO.Bottom,originGap:0,[Po]:o,renderOrigin:e=>l[So](Ue.S,i()({[Po]:o,variant:"gray"},e),u.title),render:t=>l[So](xo,i()({currentOpenPageIn:r,parent:t},e))}):null}function xo(e){window.__c={n:"OpenPageInDropdownMenu"};const{currentOpenPageIn:t,actionStore:o,parent:n}=e,r=(0,s.O7)(),c=(0,d.Fg)(),u=(0,d.yK)((()=>({menuItem:{paddingTop:8,paddingBottom:8}})),[]),p=(0,l.useCallback)((e=>{g[Co]({userAction:"OpenPageAction.setTarget",environment:r,perform:t=>{E.updateValue({store:o[wo](),data:{open_in:e},transaction:t})}})}),[r,o]),m=(0,w.F)({width:280,maxWidth:360}),h=(0,io.v)({currentViewType:void 0,theme:c}),v=We.compact(h.map(((e,o)=>({key:o,render:o=>l[So](P.Z,i()({},o,{[Po]:!1,title:e.title,icon:e.icon,caption:e.caption,body:e.body,style:u.menuItem,checkState:t===e.key},o)),action:()=>{p(e.key),n.close()}}))));return l[So](T.Z,m,a()(x.Z,{type:x.i.Vertical,sections:[{key:0,render:e=>l[So](M.Z,i()({enableActionSheetTitle:!0},e)),items:v}],initialFocus:0}))}var Mo=o(87279),Zo=o(61053),Ao=o(41418),Fo=o(80117);const Bo=o(85).qU4,_o=o(85).Hnr,Vo=o(85).QBU,Io=o(85).j7K,Do=o(85).y79,Oo=o(85).tb8,Ko=o(85).ESK,Ro=o(85).rpY,Lo=o(85).ccq,Wo=o(85).N1Z,Eo=o(85).Omf,Ho=o(85).kUY,zo=o(85).pHx,Qo=o(85).UBi,Go=o(85).Ie8,Uo=o(85).ceT,No=o(85).dLQ,qo=o(85).tBn,Yo=o(85).LtW,jo=o(85).oWD,Jo=o(85).D7I,Xo=o(85).Dd5,$o=o(85).f4X,en=o(85).LCr,tn=o(85).vwy,on=o(85).nxU,nn=o(85).wgE,rn=o(85).Drs,an=o(85).JJj,ln=o(85).eiN,sn=o(85).BP7,cn=o(85).dL6,dn=o(85).sbn,un=o(85).pkR,pn=o(85).nx5,mn=(0,p.defineMessages)({addSortLimit:{id:"automations.QueryCollectionAction.addSortLimitButton.addSortLimit",[pn]:"Add sort, limit"},addLimit:{id:"automations.QueryCollectionAction.addSortLimitButton.addLimit",[pn]:"Add limit"},addSort:{id:"automations.QueryCollectionAction.addSortLimitButton.addSort",[pn]:"Add sort"},limitDescription:{id:"automations.QueryCollectionAction.limitPopup.limitDescription",[pn]:"{numberOfPages, plural, one {{numberOfPages} page} other {{numberOfPages} pages}}"},unlimitedDescription:{id:"automations.QueryCollectionAction.limitPopup.unlimitedDescription",[pn]:"Unlimited"}});function hn(e){window.__c={n:"AddSortLimitButton"};const{actionStore:t,[jo]:o,[un]:n,onSortAdded:r,onLimitAdded:d}=e,u=(0,s.Fy)(),m=(0,s.O7)(),[h,v]=(0,l.useState)(!1);let y;y=u[No]?{[Uo]:Mo.og[Go]}:{[Uo]:Mo.og.Popup,width:250};const f=(0,l.useRef)(null),[S,k]=l.useState(void 0),b=(0,c.VK)((()=>o[Qo]()??{}),[o]),w=(0,c.VK)((()=>o.getFormat()??{}),[o]),C=(0,l.useCallback)((()=>Object.keys(o[Qo]())),[o]),P=(0,c.VK)((()=>t.hasSort()),[t]),x=(0,c.VK)((()=>t.hasLimit()),[t]),M=(0,l.useCallback)((e=>{e&&g[an]({[rn]:"QueryCollectionAction.setInitialSort",[nn]:m,[on]:o=>{E[tn]({store:t[sn](),data:{sort:[{property:e,direction:"ascending"}]},[en]:o})}}),v(!1),r()}),[t,m,r]),Z=(0,l.useCallback)((()=>{g[an]({[rn]:"QueryCollectionAction.setInitialLimit",[nn]:m,[on]:e=>{E[tn]({store:t[sn](),data:{limit:1},[en]:e})}}),d()}),[t,m,d]);if(P&&x)return null;let A;return A=P?mn.addLimit:x?mn.addSort:mn.addSortLimit,l[Jo](l[qo],null,a()(Y.ZP,{popupType:u[No]?$.kQ[zo]:$.kQ.Popup,alignmentToOrigin:Y.vR.Start,[Lo]:Y.pO.Bottom,originGap:0,[un]:n,renderOrigin:e=>l[Jo](Ue.S,i()({[un]:n,variant:Ho,ref:f},e),l[Jo](p.FormattedMessage,A)),[Ro]:e=>a()(gn,{showSortOption:!P,showLimitOption:!x,onSortSelected:()=>{var t;v(!0),k(null===(t=f.current)||void 0===t?void 0:t[Eo]()),e[Wo]()},onLimitSelected:()=>{Z(),e[Wo]()}})}),a()($.ZP,{popupType:u[No]?$.kQ[zo]:$.kQ.Popup,open:h,[Lo]:$.ZP[Ko].Bottom,alignmentToOrigin:$.ZP.Alignment.Start,originRect:S,[Ro]:()=>l[Jo](T.Z,y,a()(Zo.Z,{schema:b,format:w,currentProperty:void 0,[Oo]:C,onAccept:M})),onDismiss:()=>v(!1)}))}function gn(e){window.__c={n:"AddSortLimitMenu"};const{showSortOption:t,showLimitOption:o,onSortSelected:n,onLimitSelected:r}=e;let c;c=(0,s.Fy)()[No]?{[Uo]:Mo.og[Go]}:{[Uo]:Mo.og.Popup,width:250};const d=[];return t&&d.push({key:"sort",action:n,[Ro]:e=>l[Jo](P.Z,i()({},e,{title:"Sort",icon:u.Z.arrowsUpDown({width:16})}))}),o&&d.push({key:"limit",action:r,[Ro]:e=>l[Jo](P.Z,i()({},e,{title:"Limit",icon:u.Z.arrowDown({width:16})}))}),l[Jo](T.Z,c,a()(x.Z,{type:x.i[Do],sections:[{key:0,[Ro]:e=>l[Jo](M.Z,i()({enableActionSheetTitle:!0},e)),items:d}],[Io]:0}))}function vn(e){window.__c={n:"SortPopup"};const{contextStore:t,actionStore:o,[jo]:n,[un]:r,[Yo]:d}=e,u=(0,s.O7)(),{device:m}=u,h=(0,c.VK)((()=>{var e,t;return(null===(e=o.getConfig())||void 0===e||null===(t=e.sort)||void 0===t?void 0:t.length)??0}),[o]);return a()(Y.ZP,{popupType:m[No]?$.kQ[zo]:$.kQ.Popup,alignmentToOrigin:Y.vR.End,[Lo]:Y.pO.Bottom,originGap:0,[un]:r,[Yo]:d,renderOrigin:e=>l[Jo](Ue.S,i()({[un]:r,variant:Ho},e),a()(p.FormattedMessage,h>0?{[pn]:Vo,values:{numberOfSorts:h},id:"automations.QueryCollectionAction.oneOrMoreSorts.title"}:{[pn]:"None",id:"automations.QueryCollectionAction.noSorts.title"})),[Ro]:e=>a()(yn,{contextStore:t,[jo]:n,actionStore:o,[un]:r})})}function yn(e){window.__c={n:"SortMenu"};const{contextStore:t,actionStore:o,[jo]:n,[un]:i}=e,r=(0,s.O7)(),{device:d}=r;let u;u=d[No]?{[Uo]:Mo.og[Go]}:{[Uo]:Mo.og.Popup,minWidth:300};const p=(0,l.useCallback)((e=>{g[an]({[rn]:"QueryCollectionAction.setSort",[nn]:r,[on]:t=>{E[tn]({store:o[sn](),data:{sort:e},[en]:t})}})}),[r,o]),m=(0,c.VK)((()=>o[sn]()[cn]("sort")[dn]()??[]),[o]),h=(0,c.VK)((()=>n[Qo]()),[n]),v=(0,c.VK)((()=>n.getFormat()),[n]);return l[Jo](T.Z,u,a()(Ao.Z,{schema:h,format:v,[Bo]:void 0,sorts:m,[un]:i,parentStore:t.context[_o],[Xo]:p}))}function fn(e){window.__c={n:"LimitPopup"};const{actionStore:t,[un]:o,[Yo]:n}=e,r=(0,s.O7)(),{device:d}=r,u=(0,c.VK)((()=>t[sn]()[cn]("limit")[dn]()),[t]);return a()(Y.ZP,{popupType:d[No]?$.kQ[zo]:$.kQ.Popup,alignmentToOrigin:Y.vR.End,[Lo]:Y.pO.Bottom,originGap:0,[un]:o,[Yo]:n,renderOrigin:e=>l[Jo](Ue.S,i()({[un]:o,variant:Ho},e),(0,S.isDefined)(u)&&l[Jo](p.FormattedMessage,i()({},mn.limitDescription,{values:{numberOfPages:u}}))),[Ro]:e=>a()(Sn,{onLimitChanged:o=>{(e=>{g[an]({[rn]:"QueryCollectionAction.setLimit",[nn]:r,[on]:o=>{E[tn]({store:t[sn](),data:{limit:e},[en]:o})}})})(o),e[Wo]()}})})}function Sn(e){window.__c={n:"LimitMenu"};const{onLimitChanged:t}=e;let o;o=(0,s.Fy)()[No]?{[Uo]:Mo.og[Go]}:{[Uo]:Mo.og.Popup,minWidth:250};const n=[];for(let r=1;r<=5;r++)n.push({key:`limit-${r}`,action:()=>{t(r)},[Ro]:e=>l[Jo](P.Z,i()({},e,{title:l[Jo](p.FormattedMessage,i()({},mn.limitDescription,{values:{numberOfPages:r}}))}))});return n.push({key:"unlimited",action:()=>{t(void 0)},[Ro]:e=>l[Jo](P.Z,i()({},e,{title:l[Jo](p.FormattedMessage,mn.unlimitedDescription)}))}),l[Jo](T.Z,o,a()(x.Z,{type:x.i[Do],sections:[{key:0,[Ro]:e=>l[Jo](M.Z,i()({enableActionSheetTitle:!0},e)),items:n}],[Io]:0}))}var kn=o(43690),bn=o(78106),wn=o(68626),Cn=o(37034);const Pn=o(85).Dd5,Tn=o(85).oWD,xn=o(85).Gpy,Mn=o(85).O_,Zn=o(85).D7I,An=o(85).MQM,Fn=o(85).nx5,Bn=o(85).Dn1,_n=o(85).$Qz,Vn=o(85).FH8,In=o(85).Gm5,Dn=o(85).Hnr,On=o(85).TLr,Kn=o(85).MWD,Rn=o(85).wgE,Ln=o(85).JJj,Wn=o(85).dL6,En=o(85).sbn,Hn=o(85).pkR;function zn(e){window.__c={n:"TargetPicker"};const{contextStore:t,actionStore:o,[Hn]:n,[An]:r}=e,d=(0,s.O7)(),u=(0,c.VK)((()=>{const e=o.getVariableTargetStore();if(e)return e[En]();const t=o.getCollectionTargetStore();if(t){const e=t[Wn](Vn)[En]();if(e)return{[Vn]:e,[Kn]:Vn}}}),[o]),m=(0,c.VK)((()=>{if(u&&"variable"===u[Kn])return t[Bn](o.id,u.id)}),[t,o,u]),h=(0,Ue.d)({[An]:r,hasValue:Boolean(u||m)}),v=(0,c.qz)(void 0,co.Z),y=(0,G.d)(),f=(0,l.useCallback)((e=>{let t;if("collection"===e[Kn])t="UpdatePageAction.updateCollection";else if("variable"===e[Kn])t="UpdatePageAction.updateVariable";else{if("page"===e[Kn])throw new Error("Not implemented yet.");(0,S.unreachable)(e)}g[Ln]({userAction:t,[Rn]:d,perform:t=>{E.updateValue({store:o.getConfigStore(),transaction:t,data:{target:e,properties:null,[xn]:null}})}}),v.reset()}),[d,o,v]),k=(0,l.useCallback)((()=>v.reset()),[v]);return a()(Y.ZP,{buttonPopupStore:v,popupType:y,alignmentToOrigin:Y.vR.End,placementToOrigin:Y.pO.Bottom,originGap:0,[Hn]:n,renderOrigin:e=>l[Zn](Ue.S,i()({[Hn]:n},h,e),u&&"collection"===u[Kn]?a()(Ge.Z,{store:ze.NW[On](t[In][Dn],u[Vn])}):m?a()(uo.F,{value:m,format:so.l.Medium,isSingle:!0}):a()(p.FormattedMessage,{id:"automations.UpdatePagesAction.pagesDropdown.label",[Fn]:"Select database"})),render:e=>a()(po.L,{actionId:o.id,automationContextStore:t,[Pn]:f,onClose:k,selectedTarget:u,skipPages:!0})})}const Qn={create_page:function(e){window.__c={n:"CreatePageAction"};const{contextStore:t,actionStore:o,[Ct]:n,showErrorIfPresent:r}=e,d=(0,s.O7)(),u=(0,c.VK)((()=>o.getCollectionStore()),[o]),m=(0,c.VK)((()=>{var e;return null===(e=o[wt]())||void 0===e?void 0:e[bt]}),[o]),h=(0,c.VK)((()=>{var e;return null===(e=o[wt]())||void 0===e?void 0:e[kt]}),[o]),v=(0,c.VK)((()=>{var e;if(!u)return[];return((null===(e=u[St]())||void 0===e?void 0:e.filter((e=>e[ft]())))??[]).length>0}),[u]),y=(0,z.E)("create_page_with_template_action"),f=(0,l.useCallback)((e=>{g[yt]({userAction:"CreatePageAction.setCollection",environment:d,perform:t=>{E.updateValue({store:o[vt](),data:{[bt]:e,[gt]:["title"],values:null,[kt]:null},transaction:t})}})}),[d,o]),S=(0,l.useCallback)((e=>{g[yt]({userAction:"CreatePageAction.setTemplate",environment:d,perform:t=>{const n=o[wt]();if(!n)return;const{[gt]:i,values:r}=n;let a=!1;if(e&&i&&1===i.length&&i.includes("title")){var l;const e=null==r?void 0:r.title;e&&null!==(l=e.value)&&void 0!==l&&l.value||(a=!0)}E.updateValue({store:o[vt](),data:{[kt]:e??null,...a&&{[gt]:[]}},transaction:t})}})}),[d,o]),k=(0,H.TU)({contextStore:t,actionId:o.id,shouldShow:r,errorKey:bt}),b=(0,H.TU)({contextStore:t,actionId:o.id,shouldShow:r,errorKey:"template"});return l[at](l.Fragment,null,l[at](Ve,i()({},e,{title:a()(p.FormattedMessage,{id:"automations.CreatePageAction.header",[ht]:"Add page to"}),picker:a()("div",{style:{display:"flex",[mt]:pt,[ut]:"normal"}},void 0,a()(Le.a,{[dt]:m,contextStore:t,[ct]:f,[Ct]:n,[st]:k}),u&&v&&y&&a()(p.FormattedMessage,{id:"automations.CreatePageAction.asTemplate",[ht]:"as {templateName}",values:{templateName:a()(it,{[lt]:u,currentTemplateId:h,[ct]:S,[Ct]:n,[st]:b})}}))})),u&&a()(Re.Q,{contextStore:t,[lt]:u,actionStore:o,[Ct]:n,showSetPropertyActions:!1}))},update_pages:function(e){window.__c={n:"UpdatePagesAction"};const{contextStore:t,actionStore:o,[Hn]:n,showErrorIfPresent:r}=e,d=(0,s.O7)(),u=(0,p.useIntl)(),m=(0,c.VK)((()=>o.getTargetStore()),[o]),h=(0,c.VK)((()=>"collection"===m[Wn]("type")[En]()),[m]),v=(0,c.VK)((()=>{var e;const t=o.getCollectionTargetStore();return null==t||null===(e=t[Wn]("filter"))||void 0===e?void 0:e[En]()}),[o]),y=(0,l.useCallback)((e=>{g[Ln]({userAction:"QueryCollectionAction.setFilter",[Rn]:d,perform:t=>{E.updateValue({store:m,transaction:t,data:{filter:e}})}})}),[d,m]),f=(0,c.VK)((()=>{const e=m[En]();if(e){if("collection"===e[Kn])return ze.NW[On](t[In][Dn],e[Vn]);if("variable"===e[Kn]){const o=t[_n].state;if(wn.x.isFail(o))return;const n=(0,bn.vx)(o.value.valueTypes,e.id);if(n&&"block"===n[Kn][Kn]&&n[Kn][Vn])return ze.NW[On](t[In][Dn],n[Kn][Vn]);if(n&&"array"===n[Kn][Kn]&&"block"===n[Kn].of[Kn]&&n[Kn].of[Vn])return ze.NW[On](t[In][Dn],n[Kn].of[Vn])}else{if("page"===e[Kn])return;(0,S.unreachable)(e)}}}),[m,t[In][Dn],t[_n]]),k=(0,c.VK)((()=>f?(0,Cn.vU)({[Rn]:d,intl:u,store:f}):void 0),[f,u,d]),b=(0,c.VK)((()=>v?(0,kn.getNormalizedFilter)(v,(null==f?void 0:f.getSchema())||{}):void 0),[v,f]),w=(0,H.TU)({contextStore:t,actionId:o.id,shouldShow:r}),C=(0,c.VK)((()=>{var e;const n=null===(e=o.getVariableTargetStore())||void 0===e?void 0:e[En]();if(!n)return!1;const i=t[Bn](o.id,n.id);return!!i&&"block"===i[Kn][Kn]}),[o,t]);return l[Zn](l.Fragment,null,l[Zn](Ve,i()({},e,{title:a()(p.FormattedMessage,C?{id:"automations.UpdatePagesAction.singularHeader",[Fn]:"Edit"}:{id:"automations.UpdatePagesAction.header",[Fn]:"Edit pages in"}),picker:a()(zn,{contextStore:t,actionStore:o,[Hn]:n,[An]:w})})),h&&f&&a()("div",{style:{margin:"0 0 -4px 8px"}},void 0,a()(ao,{keyComp:a()(lo,{text:a()(p.FormattedMessage,{id:"automations.UpdatePagesAction.filter.label",[Fn]:"Pages to edit"})}),valueComp:a()(Fo.W,{contextStore:t,filter:b,[Tn]:f,[Pn]:y,[Hn]:n,noFiltersMessage:(0,S.isDefined)(k)?a()(p.FormattedMessage,{[Fn]:"All pages in {collectionName}",id:"automations.UpdatePagesAction.filterRuleCount.noFilters.label",[xn]:{[Mn]:k}}):a()(p.FormattedMessage,{[Fn]:"All pages in database",id:"automations.UpdatePagesAction.filterRuleCount.noFilters.fallbackLabel",[xn]:{[Mn]:k}})})})),f&&a()(Re.Q,{contextStore:t,[Tn]:f,actionStore:o,[Hn]:n,showSetPropertyActions:!0}))},query_collection:function(e){window.__c={n:"QueryCollectionAction"};const{contextStore:t,actionStore:o,[un]:n}=e,r=(0,s.O7)(),d=(0,c.VK)((()=>o.getCollectionStore()),[o]),u=(0,c.VK)((()=>o[sn]()[cn]("collection")[dn]()),[o]),m=(0,c.VK)((()=>o[sn]()[cn](ln)[dn]()),[o]),h=(0,c.VK)((()=>o.hasSort()),[o]),v=(0,c.VK)((()=>o.hasLimit()),[o]),y=(0,c.qz)(void 0,co.Z),f=(0,c.qz)(void 0,co.Z),S=(0,l.useCallback)((e=>{g[an]({[rn]:"QueryCollectionAction.setCollection",[nn]:r,[on]:t=>{E[tn]({store:o[sn](),data:{collection:e,[ln]:void 0,sort:void 0},[en]:t})}})}),[r,o]),k=(0,l.useCallback)((e=>{g[an]({[rn]:"QueryCollectionAction.setFilter",[nn]:r,[on]:t=>{E[tn]({store:o[sn](),data:{[ln]:e},[en]:t})}})}),[r,o]),b=(0,l.useCallback)((()=>{y.setState({open:!0})}),[y]),w=(0,l.useCallback)((()=>{f.setState({open:!0})}),[f]);return l[Jo](l[qo],null,l[Jo](Ve,i()({},e,{title:a()(p.FormattedMessage,{id:"automations.QueryCollectionAction.title",[pn]:"Get pages from"}),picker:a()(Le.a,{[$o]:u,contextStore:t,[Xo]:S,[un]:n})})),d&&l[Jo](l[qo],null,a()("div",{style:{margin:"0 8px"}},void 0,a()(ao,{keyComp:a()(lo,{text:a()(p.FormattedMessage,{id:"automations.QueryCollectionAction.filter.label",[pn]:"Filter"})}),valueComp:a()(Fo.W,{contextStore:t,[jo]:d,[ln]:m,[Xo]:k,[un]:n,noFiltersMessage:a()(p.FormattedMessage,{[pn]:"Return all pages",id:"automations.QueryCollectionAction.filterRuleCount.noFilters.label"})})}),h&&a()(ao,{keyComp:a()(lo,{text:a()(p.FormattedMessage,{id:"automations.QueryCollectionAction.sort.label",[pn]:"Sort"})}),valueComp:a()(vn,{contextStore:t,[jo]:d,actionStore:o,[un]:n,[Yo]:y})}),v&&a()(ao,{keyComp:a()(lo,{text:a()(p.FormattedMessage,{id:"automations.QueryCollectionAction.limit.label",[pn]:"Limit"})}),valueComp:a()(fn,{actionStore:o,[un]:n,[Yo]:f})})),a()(hn,{[jo]:d,actionStore:o,[un]:n,onSortAdded:b,onLimitAdded:w})))},open_page:function(e){window.__c={n:"OpenPageAction"};const{contextStore:t,actionStore:o,[Po]:n,showErrorIfPresent:r}=e,d=(0,s.O7)(),u=(0,l.useCallback)((e=>{g[Co]({userAction:"OpenPageAction.setTarget",environment:d,perform:t=>{E.updateValue({store:o[wo](),data:{target:e},transaction:t})}})}),[d,o]),m=(0,c.VK)((()=>{var e;return null===(e=o.getConfig())||void 0===e?void 0:e.target}),[o]),h=(0,H.TU)({contextStore:t,actionId:o.id,shouldShow:r});return l[So](l.Fragment,null,l[So](Ve,i()({},e,{title:a()(p.FormattedMessage,{id:"automations.OpenPageAction.header",[bo]:"Open"}),picker:a()(fo,{actionStore:o,target:m,onChange:u,contextStore:t,[Po]:n,[ko]:h})})),a()("div",{style:{margin:"0 8px"}},void 0,a()(ao,{keyComp:a()(lo,{text:a()(p.FormattedMessage,{id:"automations.OpenPageAction.openPageIn.label",[bo]:"Open page in"})}),valueComp:l[So](To,e)})))},duplicate_blocks:function(e){window.__c={n:"DuplicateBlocksAction"};const{actionStore:t,[Lt]:o}=e,n=(0,c.VK)((()=>We.first(t.getBlockPointers())),[t],{useDeepEqual:!0});return l[Rt](l.Fragment,null,l[Rt](Ve,i()({},e,{title:a()(p.FormattedMessage,{id:"automations.DuplicateBlocksAction.header",[Wt]:"Insert blocks"}),picker:a()(Qt,{actionStore:t,[Lt]:o})})),n?l[Rt](Ht,i()({},e,{contentParentPointer:n})):null)},modal_confirmation:function(e){window.__c={n:"ModalConfirmationAction"};const{actionStore:t,[eo]:o}=e,n=(0,s.O7)(),r=(0,p.useIntl)(),u=(0,d.yK)((e=>({wrap:{[$t]:"flex",flexDirection:"column",gap:10},plainTextInput:{backgroundColor:e.contentBackground,paddingTop:6,paddingBottom:6}})),[]),h=(0,c.VK)((()=>t.getType()),[t]),v=(0,c.VK)((()=>t[Jt]()[Xt]("text")),[t]),f=(0,c.VK)((()=>v.getValue()),[v]),S=(0,l.useCallback)((e=>{g.createAndCommit({userAction:"BaseModalAction.handleTextChange",environment:n,perform:t=>{E.setValue({store:v,value:e,transaction:t})}})}),[n,v]),k=t[Jt]()[Xt]("continue_button")[Xt]("text"),b=(0,c.VK)((()=>t[Jt]()[Xt]("cancel_button")[Xt]("text")),[t]);if(!h)return null;const w=(0,y.z)(h);return l[jt](l.Fragment,null,l[jt](Ve,i()({},e,{title:l[jt](p.FormattedMessage,w[$t].name)})),a()("div",{style:u.wrap},void 0,a()(Ut.D,{[eo]:o,value:f,onChange:S,multiline:!0,[qt]:r[Yt](oo.confirmationInputPlaceholder),disableFormattingAndMentions:!0,disableMobileActionBar:!0}),a()(no,{overlayContent:l[jt](p.FormattedMessage,oo.continueButtonHint)},void 0,a()(Nt.Y,{[eo]:o,maxlength:m.OO,style:u.plainTextInput,store:k})),a()(no,{overlayContent:l[jt](p.FormattedMessage,oo.cancelButtonHint)},void 0,a()(Nt.Y,{[eo]:o,maxlength:m.OO,style:u.plainTextInput,store:b}))))},slack_notification:()=>null};const Gn=o(85).sFt,Un=o(85).Nhc,Nn=o(85).L_E;function qn(e){window.__c={n:"AutomationAction"};const{contextStore:t,actionStore:o,disabled:n,dragging:i,showErrorIfPresent:r,onActionAdded:l}=e,s=(0,d.yK)((e=>({[Nn]:{background:e.contentBackground,borderRadius:5,display:"flex",flexDirection:"column",gap:8,padding:8,marginLeft:12,marginRight:12,marginBottom:8,fontSize:14,boxShadow:i?e.mediumBoxShadow:e.lightBoxShadow,width:Un},nameRow:{display:"flex",alignItems:"center",marginBottom:4},name:{flexGrow:1,fontWeight:W.Z.fontWeight.medium,marginLeft:8},iconWrap:{width:24,height:24,display:"flex",alignItems:"center",borderRadius:4,background:Gn},icon:{width:14,height:14,fill:e.blueColor,margin:"0 auto"}})),[i]),u=(0,c.VK)((()=>o.getType()),[o]);if(!u||!(0,L.lK)(u,"display"))return null;const p=Qn[u];return a()("div",{style:s[Nn]},void 0,a()(p,{contextStore:t,actionStore:o,disabled:n,dragging:i,showErrorIfPresent:r,onActionAdded:l}))}var Yn=o(79131),jn=o(45452);const Jn=o(85).nx5,Xn=o(85).D7I,$n=o(85).GCx,ei=o(85).LCr,ti=o(85).ZWt,oi=o(85).wgE,ni=o(85).Drs,ii=o(85).JJj,ri=o(85).TVJ,ai=o(85).Gm5,li=o(85).EQe,si=o(85).pkR;function ci(e){window.__c={n:"AutomationButtonActionList"};const{contextStore:t,[si]:o,suppressErrors:n,onActionAdded:i}=e,r=(0,s.O7)(),u=(0,c.VK)((()=>t[ai][li].getActionStores()),[t[ai][li]]),p=(0,c.VK)((()=>u.map((e=>e.id))),[u]),v=(0,c.qz)(void 0,jn.Z),y=(0,c.VK)((()=>v.state.isDragging),[v]),f=(0,c.VK)((()=>v.state.isDragging&&v.state.draggingKey),[v]),S=!o&&u.length<m.FT,k=(0,d.yK)((e=>({actionsLineWrap:{cursor:y?"grabbing":void 0,position:"relative"},actionLine:{position:"absolute",top:0,bottom:8,left:28,width:4,background:e.accentColors.gray[100],zIndex:1},actionsWrap:{position:"relative",zIndex:2}})),[y]);return l[Xn](l.Fragment,null,a()("div",{style:k.actionsLineWrap},void 0,a()("div",{style:k.actionLine}),a()("div",{style:k.actionsWrap},void 0,a()(Yn.ZP,{[$n]:ri,[si]:o,keys:p,onDrop:e=>{g[ii]({[ni]:"AutomationButtonAction.moveAction",[oi]:r,perform:o=>{h.kM({[ti]:t[ai],[ei]:o,newActionIds:e})}})},renderKey:e=>{const r=u.find((t=>t.id===e));return r?a()(qn,{actionStore:r,contextStore:t,[si]:o,dragging:f===e,onActionAdded:i,showErrorIfPresent:Array.isArray(n)?!n.includes(r.id):!n},r.id):null},store:v}))),S&&a()(di,{contextStore:t,[si]:o,onActionAdded:i}))}function di(e){window.__c={n:"AddActionButton"};const{contextStore:t,[si]:o,onActionAdded:n}=e,r=(0,s.O7)(),{device:m}=r,[h,g]=(0,l.useState)(!0),v=(0,d.yK)((e=>({buttonWrap:{boxShadow:"initial",background:"transparent"},button:{color:e.mediumTextColor,fill:e.mediumIconColor},buttonIcon:{width:24,height:m.isMobile?18:16,marginRight:-2}})),[m.isMobile]),y=(0,c.qz)(void 0,co.Z),f=(0,G.d)(),S=(0,c.VK)((()=>t[ai][li].hasAnyActions()),[t[ai][li]]);return(0,l.useEffect)((()=>{!S&&h&&(y.setState({open:!0}),g(!1))}),[y,S,h]),a()(Y.ZP,{popupType:f,alignmentToOrigin:Y.vR.Start,placementToOrigin:Y.pO.Bottom,originGap:0,buttonPopupStore:y,[si]:o,renderOrigin:e=>l[Xn](P.Z,i()({focused:!1,style:v.buttonWrap,buttonStyle:v.button,icon:u.Z.plus(v.buttonIcon),title:a()(p.FormattedMessage,S?{id:"automations.addActionButton.nonEmpty.label",[Jn]:"Add another step"}:{id:"automations.addActionButton.empty.label",[Jn]:"Add a step"})},e)),render:e=>a()(K,{contextStore:t,onActionAdded:t=>{n(t),e.close()}})})}var ui=o(27153),pi=o(24677),mi=o(98104),hi=o(42922),gi=o(31278),vi=o(18647),yi=o(38797),fi=o(42402);const Si=o(85).TtP,ki=o(85).nx5,bi=o(85).BQ6,wi="https://www.notion.so/help/template-buttons";function Ci(e){window.__c={n:"FactoryButtonMigrationBanner"};const{handleDismissBanner:t}=e,o=(0,d.yK)((e=>({banner:{width:"100%",display:"flex",alignItems:"start",backgroundColor:e.accentColors.blue["light"===e.mode?50:300],borderRadius:4,padding:12,fontSize:12,lineHeight:1.5,gap:8},icon:{width:12,color:e.blueColor},bannerContent:{flex:"1 1 auto"},bannerTitle:{fontWeight:W.Z.fontWeight.medium},bannerCaption:{color:e.mediumTextColor},closeButton:{borderRadius:"50%"},starIcon:{flex:"0 0 auto",marginBlockStart:3},link:{color:e.text.interactive}})),[]);return a()("div",{[bi]:o.banner},void 0,a()("div",{[bi]:o.starIcon},void 0,u.Z.starFilled(o.icon)),a()("div",{[bi]:o.bannerContent},void 0,a()("div",{[bi]:o.bannerTitle},void 0,a()(p.FormattedMessage,{id:"factoryButton.deprecationBanner.title",[ki]:"Your buttons just got better"})),a()("div",{[bi]:o.bannerCaption},void 0,a()(p.FormattedMessage,{id:"factoryButton.deprecationBanner.caption",[ki]:"Now you can create, edit and open pages and <buttonsHelpCenterLink>more</buttonsHelpCenterLink>.",values:{buttonsHelpCenterLink:function(){for(var e=arguments[Si],t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return a()(fi.Z,{href:wi,disableUnderline:!0,[bi]:o.link},void 0,t)}}}))),a()(J.Z,{icon:u.Z.close,ariaLabel:"closeButton",[bi]:o.closeButton,onClick:()=>t()}))}var Pi=o(59557),Ti=o(33929),xi=o(34859),Mi=o(68910);const Zi=o(85).wGK,Ai=o(85).EQe;function Fi(e){const{store:t,[Ai]:o}=e,n=(0,s.O7)().currentUser.id;return(0,c.VK)((()=>{const e=t[Zi]();if(o&&e instanceof ze.G)return(0,k.Gb)({type:"button_block",persisted:!0,[Ai]:o,blockStore:t,pageStore:e,intl:Ti.default.getIntl(),parentRecordStore:o,currentUserId:n})}),[o,t,n])}const Bi=o(85).Yf1,_i=o(85).j2G,Vi=o(85).IY7,Ii=o(85).cZW,Di=o(85).PG2,Oi=o(85).mFu,Ki=o(85).h31,Ri=o(85).Dd5,Li=o(85).Yzm,Wi=o(85).Omf,Ei=o(85).wGK,Hi=o(85).t9A,zi=o(85).EQe,Qi=o(85).pkR,Gi=o(85).YOX,Ui=o(85).BQ6,Ni=o(85).D7I,qi=o(85).nLZ,Yi=o(85).OSs,ji=o(85).nx5,Ji=(0,p.defineMessages)({addIconButtonAriaLabel:{[ji]:"Add icon",id:"buttonBlock.button.addIconButtonAriaLabel"},editButtonAriaLabel:{[ji]:"Edit button",id:"buttonBlock.button.editButtonAriaLabel"},buttonPlaceholder:{[ji]:"New button",id:"buttonBlock.button.placeholder"},buttonInsufficientPermissions:{[ji]:"You donât have permission to run this button",id:"buttonBlock.button.insufficientPermissions"},clickToEdit:{[ji]:"Click to edit button",id:"buttonBlock.button.clickToEdit"}});function Xi(e){window.__c={n:"PlacedButtonBlockEditor"};const{buttonBlockStore:t}=e,o=(0,c.VK)((()=>t.state.editing?t.state:void 0),[t]),n=(0,d.yK)((e=>({popup:{width:400},[Yi]:{background:e.sidebarBackground,..."inline"===(null==o?void 0:o.placement.type)?{[qi]:6,borderRadius:6,border:`1px solid ${e.regularDividerColor}`,maxWidth:600}:{}}})),[null==o?void 0:o.placement.type]),r=(0,G.d)({tabletBehavior:"slideUp"});return o?"popup"===o.placement.type?a()($.ZP,{open:!0,popupType:r,render:()=>l[Ni]($i,i()({},e,{[Ui]:n[Yi]})),[Gi]:o.placement[Gi],[Ui]:n.popup,originGap:4,onDismiss:()=>{t.stopEditing()}}):"inline"===o.placement.type?l[Ni]($i,i()({},e,{[Ui]:n[Yi]})):void(0,S.unreachable)(o.placement):null}function $i(e){window.__c={n:"ButtonBlockEditor"};const{[Qi]:t,store:o,buttonBlockStore:n}=e,r=(0,s.O7)(),m=r.currentUser.id,h=(0,p.useIntl)(),y=(0,d.yK)((e=>({header:{display:"flex",alignItems:"center",padding:"12px 12px 8px 12px",gap:6},scroller:{maxHeight:"75vh"},nameInputWrap:{flexGrow:"1"},factoryButtonDeprecationBanner:{margin:"12px 12px 6px 12px"}})),[]),f=(0,C.D)(),S=(0,c.VK)((()=>o.getAutomationStore()),[o]),k=(0,c.VK)((()=>null==S?void 0:S.getNameStore()),[S]),w=(0,c.VK)((()=>null==S?void 0:S.getIconStore()),[S]),P=(0,c.VK)((()=>(null==k?void 0:k.getValue())??""),[k]),T=Fi({store:o,[zi]:S}),x=(0,c.VK)((()=>{var e;return o.canEdit()&&"sufficient"===(null==T||null===(e=T.state)||void 0===e?void 0:e[Hi])}),[o,T]),{showFactoryButtonDeprecationBanner:A,handleDismissFactoryButtonMigrationBanner:F}=(0,Pi.N)({blockStore:o}),B=(0,c.VK)((()=>null==w?void 0:w.getValue()),[w]),_=(0,c.VK)((()=>{const e=o[Ei]();if(e instanceof ze.G)return e}),[o]),V=(0,l.useMemo)((()=>{if(S&&_)return new Mi.L({type:"button_block",persisted:!0,[zi]:S,blockStore:o,pageStore:_,intl:Ti.default.getIntl(),parentRecordStore:S,currentUserId:m})}),[S,_,o,m]),I=(0,l.useCallback)((e=>{(0,Tt.ZP)({event:e,context:Tt.Af.EditorClick,callback:()=>{mi.clear(r),pi.clear(r)}})}),[r]),D=(0,l.useCallback)((()=>{n.stopEditing(),(0,v.lN)(f,{block_id:o.id,automation_id:null==S?void 0:S.id})}),[S,n,o,f]),O=(0,l.useCallback)(((e,t)=>{S&&g.createAndCommit({userAction:"ButtonBlock.updateProperty",environment:r,perform:o=>{E.updateValue({store:S.getPropertiesStore(),transaction:o,data:{[e]:t??null}})}})}),[S,r]),K=(0,l.useCallback)((e=>O("icon",e)),[O]),R=(0,l.useCallback)((e=>O("name",e)),[O]),L=(0,l.useCallback)((e=>{ui.show(r,{[Gi]:e.currentTarget[Wi](),originGap:4,popupWidth:yi.ZP.desktopPopupWidth,popupHeight:yi.ZP.desktopPopupHeight,isSmallWidth:!1,title:h[Li]({[ji]:"Icon",id:"buttonBlock.button.iconHeading"}),currentTab:"icon",tabs:[{type:"icon",[Ri]:e=>{K(e),ui.clear()}},{type:"emoji",[Ri]:(e,t)=>{K(e),ui.clear()}}],onDelete:()=>{K(void 0),ui.clear()}})}),[r,K,h]),W=(0,c.VK)((()=>n.state[Ki]),[n]),H=t||!x;if(!V)return null;const z=e=>l[Ni](J.Z,i()({ariaLabel:h[Li](Ji.addIconButtonAriaLabel),[Ui]:{width:26,height:26},iconStyle:{width:16,height:16},hasBackground:!0,[Qi]:H,showShadow:!0,icon:e=>B?a()(gi.Z,{[Qi]:!0,isEmptyPage:!1,size:24,icon:{icon:B,[Oi]:o[Oi]},[Ui]:e}):u.Z.addPageIcon(e)},(0,b.Z)(e??{},{[Di]:L}))),Q=B?z():a()(Z.Z,{renderTooltip:()=>a()(p.FormattedMessage,{[ji]:"Add an icon",id:"buttonBlock.button.addIcon"}),delayThreshold:300,render:z});return a()("div",{[Ui]:e[Ui],[Di]:I},void 0,A&&a()("div",{[Ui]:y.factoryButtonDeprecationBanner},void 0,a()(Ci,{handleDismissBanner:F})),a()(Mt.p,{allowSelectionWithin:!0,[Ui]:y.header},void 0,Q,a()(Nt.b,{[Ri]:R,value:P,[Qi]:H,[Ii]:Ti.default[Li](Ji.buttonPlaceholder),wrapStyle:y.nameInputWrap}),a()(hi.Z,{[Di]:D},void 0,a()(p.FormattedMessage,{[ji]:"Done",id:"buttonBlock.button.done"}))),a()(vi.Z,{[Ui]:y.scroller,type:xi.Z.Y},void 0,a()(M.Z,{mobileStyle:{[Vi]:_i},mobileTitleStyle:{[Bi]:"none",[qi]:8},title:a()(p.FormattedMessage,{id:"buttonBlock.actions",[ji]:"When button is clicked"})},void 0,a()(ci,{contextStore:V,[Qi]:H,suppressErrors:W,onActionAdded:e=>{n.suppressErrorsForAction(e)}}),a()("div",{}))))}},21269:(e,t,o)=>{o.d(t,{Z:()=>d});var n=o(77094),i=o.n(n),r=(o(67294),o(480)),a=o(3909),l=o(50906),s=o(42917),c=o(16354);const d=function(e){window.__c={n:"CollectionSettingsLearnMoreButton"};const{title:t,href:o,analyticsFrom:n}=e,d=(0,r.O7)();return i()(c.Z,{href:o,onClick:()=>l.trackClickHelpButton(d,{from:n}),external:!0},void 0,i()(s.Z,{icon:a.Z.help,title:t,isGray:!0}))}},61053:(e,t,o)=>{o.d(t,{Z:()=>Q});var n=o(77094),i=o.n(n),r=o(97464),a=o.n(r),l=o(43261),s=o.n(l),c=o(96486),d=o(67294),u=o(83355),p=o(49085),m=o(6695),h=o(3909),g=o(5366),v=o(52821),y=o(33929),f=o(29798),S=o(73657),k=o(52275),b=o(68894),w=o(32163),C=o(72495),P=o(69872);const T=o(85).VFs,x=o(85).iB2,M=o(85).dLQ,Z=o(85).Wp_,A=o(85).TtP,F=o(85).PXg,B=o(85).XNW,_=o(85).wuN,V=o(85).D7I,I=o(85).Yzm,D=o(85).nR5,O=o(85).Gnd,K=o(85).P0G,R=o(85).wfR,L=o(85).K0Z,W=o(85).nx5,E=o(85).zwB,H=(0,g.defineMessages)({[E]:{[W]:"Search for a propertyâ¦",id:"database.viewSettings.propertySelect.inputPlaceholder"},none:{[W]:"None",id:"database.viewSettings.propertySelect.noneMessage"},remove:{[W]:"Remove",id:"database.viewSettings.propertySelect.removeMessage"}});class z extends u.Z{constructor(){super(...arguments),this.storeTypes={[L]:p.default[R](""),[K]:f.Z,showAllProperties:p.default[R](!1)}}renderComponent(){const{currentProperty:e,showNoneOption:t,showRemoveOption:o,getProperties:n,onAccept:r,intl:l,[E]:u,defaultShowPropertyCount:p,schema:f,format:P}=this.props,{device:R}=this.environment,{[L]:z,[K]:Q}=this[O],G=z.state,U=(0,m.getNormalizedFormat)(P,f,void 0,m.FormatContext.Page)[D]||[],N=!p||this[O].showAllProperties.state,q=l[I](H.none),Y=t?{key:"none",render:t=>d[V](k.Z,a()({},t,{checkState:!e,title:q})),action:()=>{r(void 0)}}:void 0,j=o?{key:"remove",render:e=>d[V](k.Z,a()({},e,{icon:h.Z.trash({width:16,fill:this.theme[_],[B]:4,[F]:2}),title:l[I](H.remove)})),action:()=>{r(void 0)}}:void 0,J=n();let X=c.sortBy(J,(e=>U.findIndex((t=>t.property===e))));if(G){const e=new Map;let t=X.map((t=>{const o=f[t],n=o?`${o.name} ${v.SO[o.type]}`:"";return e.set(t,n),n}));t=s().filter(G,t).map((e=>{let{original:t}=e;return t})),X=X.filter((o=>t.includes(e.get(o)||"")))}else!N&&p&&(X=X.slice(0,p));const $=c.compact([!G||s().test(G,q)?Y:void 0,...X.map((e=>this.renderPropertyMenuItem(e)))]);if(!N&&J[A]>X[A]&&!G){const e={key:"show_more",render:e=>d[V](k.Z,a()({},e,{icon:h.Z.dots({width:16,fill:this.theme[_],[B]:4,[F]:2}),style:{color:this.theme[_]},title:i()(g.FormattedMessage,{[W]:"{moreCount} more",id:"database.viewSettings.propertySelect.showMoreTitle",values:{moreCount:J[A]-X[A]}})})),action:()=>{this[O].showAllProperties[Z](!0)}};$.push(e)}const ee=[];return(!j||$[A]>0)&&ee.push({key:"input",comp:i()(C.Z,{},void 0,i()(b.ZP,{focusInitial:!R[M]||void 0,focus:!R[M]||void 0,value:G,onChange:e=>{z[Z](e.target.value),Q[Z]({...Q.state,focus:{section:0,[x]:0,[T]:0}}),this[O].showAllProperties[Z](!1)},placeholder:u||y.default[I](H[E])}))}),($[A]>0||j)&&ee.push({key:"properties",comp:i()(w.Z,{type:w.i.Vertical,initialFocus:0,sections:[...$[A]>0?[{key:"results",render:e=>d[V](C.Z,e),items:$}]:[],...j?[{key:"remove",render:e=>d[V](C.Z,a()({topBorder:$[A]>0},e)),items:[j]}]:[]],store:Q})}),0!==$[A]||j||ee.push({key:"noResults",comp:i()(S.Z,{caption:i()(g.FormattedMessage,{[W]:"No results",id:"database.viewSettings.propertySelect.noResultsTitle"})})}),d[V](d.Fragment,null,ee.map((e=>{let{key:t,comp:o}=e;return i()(d.Fragment,{},t,o)})))}renderPropertyMenuItem(e){const{schema:t,currentProperty:o,onAccept:n,renderProperty:i}=this.props,r=t[e];if(!r)return;return{key:e,render:t=>{const n=e===o;return i?i(t,e,n,r):d[V](P.Z,a()({},t,{propertySchema:r,format:P.Z.DisplayFormat.Name,checkState:n}))},action:()=>{n(e)}}}}z.displayName="CollectionSettingsPropertySelectMenu";const Q=(0,g.injectIntl)(z)},71846:(e,t,o)=>{o.d(t,{S:()=>ae,Z:()=>ce});var n=o(97464),i=o.n(n),r=o(77094),a=o.n(r),l=o(67294),s=o(83355),c=o(49085),d=o(3909),u=o(6287),p=o(5366),m=o(77162),h=o(31299),g=o(33929),v=o(29798),y=o(39098),f=o(73657),S=o(52275),k=o(68894),b=o(32163),w=o(11470),C=o(77137),P=o(72495),T=o(58032),x=o(78948);const M=o(85).qC0,Z=o(85).kgm,A=o(85).xgV,F=o(85).tBn,B=o(85).j7K,_=o(85).y79,V=o(85).ELX,I=o(85).Hco,D=o(85).wuN,O=o(85).D7I,K=o(85).oWD,R=o(85).rpY,L=o(85).TLr,W=o(85).G_Z,E=o(85).kdC,H=o(85).cZW,z=o(85).Yzm,Q=o(85).VFs,G=o(85).iB2,U=o(85).nm$,N=o(85).Wp_,q=o(85).dLQ,Y=o(85).TtP,j=o(85).Ttb,J=o(85).wgE,X=o(85).uzK,$=o(85).v2u,ee=o(85).fBu,te=o(85).P24,oe=o(85).P0G,ne=o(85).wfR,ie=o(85).K0Z,re=o(85).nx5;let ae;!function(e){e[e.Source=0]="Source",e[e.Relation=1]="Relation",e[e.Automation=2]="Automation"}(ae||(ae={}));const le=(0,p.defineMessages)({linkedInputPlaceholder:{[re]:"Link to a databaseâ¦",id:"database.viewSettings.searchCollections.linkedInputPlaceholder"},linkedOrSourceInputPlaceholder:{[re]:"Link or create a databaseâ¦",id:"database.viewSettings.searchCollections.linkedOrSourceInputPlaceholder"},automationInputPlaceholder:{id:"automations.databasePicker.automationInputPlaceholder",[re]:"Select a databaseâ¦"}});class se extends s.Z{constructor(){super(...arguments),this.storeTypes={[ie]:c.default[ne](""),limitStore:c.default[ne](5),[oe]:v.Z},this.performSearchCollections=async e=>{const{query:t,limit:o}=e,{[te]:n,[ee]:i,[$]:r}=this.props,a=null==n?void 0:n[X](),l=await h.searchCollectionsWithRecents({[J]:this[J],[X]:a,[ee]:i,query:t,limit:o,[$]:r});return{[j]:l[j],showMore:Math.max(0,l.total-l[j][Y])}}}renderComponent(){const{[te]:e,selectedCollectionStore:t,context:o,[ee]:n}=this.props,{device:r}=this[J],{limitStore:s,[ie]:c,[oe]:m}=this.stores,v=c.state,T="linked"===(null==e?void 0:e.getCollectionViewBlockSourceState())||o===ae.Relation?le.linkedInputPlaceholder:o===ae.Source?le.linkedOrSourceInputPlaceholder:le.automationInputPlaceholder;return l[O](l[F],null,a()(P.Z,{},void 0,a()(k.ZP,{focusInitial:!r[q]||void 0,value:v,onChange:e=>{c[N](e[U].value),s[N](e[U].value?20:5),m[N]({focus:{section:0,[G]:0,[Q]:0}})},[H]:g.default[z](T),[E]:!0})),a()(C.Z,{request:{query:v,limit:s.state},[A]:this.performSearchCollections,debounce:h[W],[R]:(r,c,h)=>{if(!c)return a()(P.Z,{},void 0,a()(x.Z,{}));const{[j]:g,showMore:v}=c,k=g.map((r=>{const a=y.NW[L](n,{table:u.v,id:r});return{key:r,[R]:n=>{var s;return l[O](w.Z,i()({},n,{checkState:t&&t.id===r,store:a,right:o===ae.Relation&&(null==e||null===(s=e[K]())||void 0===s?void 0:s.id)===r&&this.renderSelfDatabaseIconTooltip()}))},action:e=>{const{index:t}=e;this.handleAcceptExistingCollection({[K]:a,totalResults:g[Y],clickedIndex:t})}}}));if(v>0){const e={key:"showMore",[R]:e=>l[O](S.Z,i()({},e,{[V]:{color:this.theme[D],fill:this.theme[I]},icon:d.Z.dots({width:16,height:16}),title:a()(p.FormattedMessage,{[re]:"Show {showMore} more",id:"database.viewSettings.searchCollections.showMore.title",values:{showMore:Math.min(v,20)}})})),action:()=>{s[N](s.state+20)}};k.push(e)}return l[O](l[F],null,g[Y]>0&&a()(b.Z,{type:b.i[_],[B]:0,sections:[{key:"results",[R]:e=>l[O](P.Z,e),items:k}],store:m}),0===g[Y]&&a()(f.Z,{caption:a()(p.FormattedMessage,{[re]:"No results",id:"database.viewSettings.searchCollections.noResultsTitle"})}))}}))}renderSelfDatabaseIconTooltip(){return a()(T.Z,{renderTooltip:()=>a()(p.FormattedMessage,{[re]:"This database",id:"database.viewSettigs.searchCollections.thisDatabase.tooltip"}),[R]:e=>l[O]("div",e,d.Z.info({width:14,height:14}))})}handleAcceptExistingCollection(e){const{[K]:t,totalResults:o,clickedIndex:n}=e,{[te]:i,searchSessionId:r,context:a}=this.props,{[ie]:l}=this.stores;i&&m.trackConfigureView({[J]:this[J],[te]:i,action:"select_existing_collection"});const{onAccept:s}=this.props;s(t),m[Z]({[J]:this[J],eventName:M,totalResults:o,clickedIndex:n,sessionId:r,source:a,queryLength:l.state[Y]})}}se.displayName="CollectionSettingsSearchCollections";const ce=(0,p.injectIntl)(se)},98421:(e,t,o)=>{o.d(t,{Z:()=>To,v:()=>Po});var n=o(97464),i=o.n(n),r=o(77094),a=o.n(r),l=o(96486),s=o(67294),c=o(83355),d=o(49085),u=o(15145),p=o(6906),m=o(99036),h=o(39068),g=o(53877),v=o(6695),y=o(4615),f=o(82990),S=o(5366),k=o(50906),b=o(77162),w=o(5149),C=o(64434),P=o(96802),T=o(5978),x=o(80402),M=o(12359),Z=o(28020),A=o(40863),F=o(33929);const B=o(85).Yzm,_=o(85).Ph7,V=o(85).nx5,I=(0,S.defineMessages)({none:{[V]:"None",id:"database.viewPropertiesMenu.coverFormat.none"},[_]:{[V]:"Page content",id:"database.viewPropertiesMenu.coverFormat.pageContent"},page_cover:{[V]:"Page cover",id:"database.viewPropertiesMenu.coverFormat.pageCover"}}),D=(0,S.defineMessages)({small:{[V]:"Small",id:"database.viewPropertiesMenu.coverSize.small"},medium:{[V]:"Medium",id:"database.viewPropertiesMenu.coverSize.medium"},large:{[V]:"Large",id:"database.viewPropertiesMenu.coverSize.large"}}),O=function(e){return e?"page_content"===e.type?F.default[B](I[_]):"page_cover"===e.type?F.default[B](I.page_cover):void 0:F.default[B](I.none)},K=e=>{switch(e){case"small":return F.default[B](D.small);case"medium":return F.default[B](D.medium);case"large":return F.default[B](D.large)}};var R=o(90833),L=o(52821),W=o(48543),E=o(65742),H=o(78316),z=o(84210),Q=o(87279),G=o(33665),U=o(79315),N=o(61766),q=o(36857),Y=o(88923),j=o(21269),J=o(42917),X=o(13709),$=o(61053),ee=o(75544),te=o(42922),oe=o(64921),ne=o(31945),ie=o(74194),re=o(78140),ae=o(44532),le=o(72495),se=o(86825);const ce=o(85).EB9,de=o(85).f2X,ue=o(85).$KA,pe=o(85).VwS,me=o(85).v1$,he=o(85).hd7,ge=o(85).lDm,ve=o(85).nUE,ye=o(85).QQK,fe=o(85).P3e,Se=o(85).ccq,ke=o(85).BCA,be=o(85).tb8,we=o(85).urI,Ce=o(85).Kiu,Pe=o(85).mYq,Te=o(85).N1Z,xe=o(85).qLW,Me=o(85).UBi,Ze=o(85).Ie8,Ae=o(85).ceT,Fe=o(85).Uie,Be=o(85).pHx,_e=o(85).E6w,Ve=o(85).oWD,Ie=o(85).kdC,De=o(85).Ql2,Oe=o(85).auS,Ke=o(85).ffk,Re=o(85).Vml,Le=o(85).Dd5,We=o(85).KOz,Ee=o(85).gWL,He=o(85).vK9,ze=o(85).woI,Qe=o(85).tBn,Ge=o(85).D7I,Ue=o(85).P3s,Ne=o(85).Zij,qe=o(85).AEP,Ye=o(85).nx5,je=o(85).TEz,Je=o(85).UPJ,Xe=o(85).Mm1,$e=o(85)._V5,et=o(85).GmX,tt=o(85).Scd,ot=o(85).XCs,nt=o(85).YDv,it=o(85).dLQ,rt=o(85).zkl,at=o(85).DCw,lt=o(85).uzK,st=o(85).eiN,ct=o(85).MAy,dt=o(85).qq3,ut=o(85).MWD,pt=o(85).Xl2,mt=o(85).HxR,ht=o(85).LIR,gt=o(85).XqV,vt=o(85).nm$,yt=o(85).tDk,ft=o(85).owv,St=o(85).iQh,kt=o(85).KCN,bt=o(85).Cj7,wt=o(85).wks,Ct=o(85).ZzJ,Pt=o(85).YaF,Tt=o(85).Mnk,xt=o(85).g9q,Mt=o(85).$ZS,Zt=o(85).f4X,At=o(85).lG,Ft=o(85).U9S,Bt=o(85).C2,_t=o(85).Uww,Vt=o(85).e7B,It=o(85).nXm,Dt=o(85).qU4,Ot=o(85).PG2,Kt=o(85).pkR,Rt=o(85).BQ6,Lt=o(85).nLZ,Wt=o(85).g7N,Et=o(85).Gnd,Ht=o(85).Wp_,zt=o(85).ddU,Qt=o(85).X5t,Gt=o(85).jQT,Ut=o(85).LCr,Nt=o(85).nxU,qt=o(85).wgE,Yt=o(85).Drs,jt=o(85).JJj,Jt=o(85).ChN,Xt=o(85).OP1,$t=o(85).wuN,eo=o(85).Au,to=o(85).dMt,oo=o(85).IY7,no=o(85).LlE,io=o(85).NF1,ro=o(85).Exd,ao=o(85).AIq,lo=o(85).Jkr,so=o(85).jkI,co=o(85).H1U,uo=o(85).rps,po=o(85).$bT,mo=o(85).EMU,ho=o(85).sM5,go=o(85).mSd,vo=o(85).rQ1,yo=o(85).QmD,fo=o(85).J2Z,So=o(85).P0R,ko=o(85).P24,bo=o(85).wfR;class wo extends c.Z{constructor(){super(...arguments),this.storeTypes={hoveredType:d.default[bo](void 0),timelineByButtonPopupStore:N.Z,timelineByEndButtonPopupStore:N.Z,calendarByButtonPopupStore:N.Z},this.renderViewTypeButton=e=>{const{intl:t,[ko]:o}=this[So],n=this[fo](),i=o[vo][yo],r=n===e,l=r||!i[go];return a()(oe.Z,{[Rt]:{[ho]:mo,[po]:uo,[co]:so,[lo]:"calc(33% - 12px)",flexGrow:0,[ao]:0,[ro]:11,[io]:3,margin:6,[no]:6,[oo]:`0 0 0 1px ${this[eo][to]}`,color:this[eo][$t],fill:this[eo][$t],...r&&{[oo]:`0 0 0 2px ${this[eo][Xt]}`,color:this[eo][Xt],fill:this[eo][Xt],[Jt]:500}},[Kt]:l,[Ot]:()=>{M[jt]({[Yt]:"CollectionSettingsViewLayoutMenu.renderViewTypeButton",[qt]:this[qt],[Nt]:n=>{C.updateCollectionViewType({[qt]:this[qt],[ko]:o,newViewType:e,[Ut]:n,intl:t})}}),b[Gt]({[qt]:this[qt],[ko]:o,[Qt]:"change_type",[zt]:n})},onMouseMove:()=>{this[Et].hoveredType[Ht](e)}},void 0,L.aW[e]({[lo]:void 0,height:20,[Wt]:4,[Lt]:4}),a()("div",{},void 0,L.Bh[e]))},this.handleCoverFormatChange=e=>{const{[ko]:t}=this[So],o=this.getCoverFormatKey(),n=t[Dt]();o&&n&&(M[jt]({[Yt]:"CollectionSettingsViewLayoutMenu.handleCoverFormatChange",[qt]:this[qt],[Nt]:t=>{P[It]({[Et]:[n],[Vt]:{[o]:e},[Ut]:t})}}),b[Gt]({[qt]:this[qt],[ko]:t,[Qt]:"update_cover_format"}))},this.handleCoverSizeFormatChange=e=>{const{[ko]:t}=this[So],o=this.getCoverSizeFormatKey(),n=t[Dt]();o&&n&&(M[jt]({[Yt]:"CollectionSettingsViewLayoutMenu.handleCoverSizeFormatChange",[qt]:this[qt],[Nt]:t=>{P[It]({[Et]:[n],[Vt]:{[o]:e},[Ut]:t})}}),b[Gt]({[qt]:this[qt],[ko]:t,[Qt]:"toggle_cover_size_format"}))},this.handleCoverAspectFormatToggle=()=>{const{[ko]:e}=this[So],t=this.getCoverAspectFormatKey(),o=e[Dt](),n=e[_t][yo];t&&o&&(M[jt]({[Yt]:"CollectionSettingsViewLayoutMenu.handleCoverAspectFormatToggle",[qt]:this[qt],[Nt]:e=>{P[It]({[Et]:[o],[Vt]:{[t]:"contain"===n[t]?"cover":Bt},[Ut]:e})}}),b[Gt]({[qt]:this[qt],[ko]:e,[Qt]:"toggle_cover_aspect_format"}))},this.handleShowCollectionTitleClick=()=>{const{[ko]:e}=this[So],t=e[Dt]();if(!t)return;const o=!e.shouldShowSource[yo];M[jt]({[Yt]:"CollectionSettingsViewLayoutMenu.handleShowCollectionTitleClick",[qt]:this[qt],[Nt]:e=>{P[It]({[Et]:[t],[Vt]:{[Ft]:!o},[Ut]:e})}}),b[Gt]({[qt]:this[qt],[ko]:e,[Qt]:"toggle_show_collection_title"})},this.handleTableWrapCellsToggle=()=>{const{[ko]:e}=this[So],t=e[Dt]();if(!t)return;const o=Boolean(e[_t][yo][At]);x.toggleTableWrapCells({[qt]:this[qt],[Dt]:t,[Zt]:o}),k[Gt](this[qt],{view_type:this[fo](),[Qt]:"set_first_load_limit"}),b[Gt]({[qt]:this[qt],[ko]:e,[Qt]:"toggle_table_wrap_cells"})},this.handleTableVerticalLinesToggle=()=>{const{[ko]:e}=this[So],t=e[Dt]();if(!t)return;const o=Boolean(e[_t][yo][Mt]);x.toggleTableVerticalLines({[qt]:this[qt],[Dt]:t,[Zt]:o}),b[Gt]({[qt]:this[qt],[ko]:e,[Qt]:"toggle_table_vertical_lines"})},this.handleTableSubitemToggleOnTitleToggle=()=>{const{[ko]:e}=this[So],t=e[Dt]();t&&(x.toggleTableSubitemToggleOnTitle({[qt]:this[qt],[Dt]:t,[Zt]:e[_t][yo][xt]}),b[Gt]({[qt]:this[qt],[ko]:e,[Qt]:Tt}))},this.handleTimelineSeparateDatesClick=()=>{const{[ko]:e}=this[So],t=e[Pt][yo],o=e[Dt](),n=null==t?void 0:t[Ct],i=null==t?void 0:t[wt];if(!n||!o)return;const r=i?void 0:n;M[jt]({[Yt]:"CollectionSettingsViewLayoutMenu.handleTimelineSeparateDatesClick",[qt]:this[qt],[Nt]:e=>{C[bt]({[Dt]:o,[Vt]:{[wt]:r??null},[Ut]:e})}}),b[Gt]({[qt]:this[qt],[ko]:e,[Qt]:"toggle_timeline_separate_dates"})},this.handleOpenPeekModePicker=()=>{b.trackOpenPeekModePicker({[qt]:this[qt],[ko]:this[So][ko],from:kt})},this.handleCalendarViewRangeOptionClick=e=>{const{[ko]:t}=this[So],o=t[Dt]();if(!o)return;const{serverCommitResult:n}=M[jt]({[Yt]:"CollectionSettingsViewLayoutMenu.handleViewRangeOptionClick",[qt]:this[qt],[Nt]:t=>{P[It]({[Et]:[o],[Vt]:{calendar_view_range:e},[Ut]:t})}}),i=Z.userSettingsStartOfWeekStore[yo],r=t[St][yo],a=t.dateRangeEnd[yo],{newDateRangeStart:l,newDateRangeEnd:s}=this.getNewDateRange({oldCalendarEnd:a,newViewRange:e,startOfWeekSetting:i});C.setDateRange({[St]:l,dateRangeEnd:s,[ko]:t}),n.then((()=>{b[Gt]({[qt]:this[qt],[ko]:t,[Qt]:"update_calendar_view_range"})})).catch((()=>{C.setDateRange({[St]:r,dateRangeEnd:a,[ko]:t})}))},this.handlePeekModeFormatClick=e=>{const{[ko]:t}=this[So],o=t[Dt]();if(o&&e&&(M[jt]({[Yt]:"CollectionSettingsViewLayoutMenu.handlePeekModeFormatClick",[qt]:this[qt],[Nt]:t=>{P[It]({[Et]:[o],[Vt]:{[ft]:e},[Ut]:t})}}),b.trackUpdatePeekModeFormat({[qt]:this[qt],[ko]:t,peek_mode:e,from:kt}),Y.default[yo].open&&Y.default[yo][ko]===t)){const{[yt]:t}=U.default[yo],o="full_page"===e?(0,z.ZP)({store:Y.default[yo][vt],[gt]:!1,[ht]:u.tY.Expand}):(0,H.getPeekModeHref)({store:Y.default[yo][vt],[yt]:t,[ko]:Y.default[yo][ko],[gt]:!1,overridePeekMode:(0,Y.getPeekModeFromCollectionPeekModeFormat)(e)});o&&T.navigate({[qt]:this[qt],url:o})}},this.handleViewTypeAreaMouseLeave=()=>{this[Et].hoveredType[Ht](void 0)},this.handleDoneClick=()=>{const{[mt]:e,[ko]:t}=this[So];w[pt]({[mt]:e,item:{[ut]:"main"}}),b[Gt]({[qt]:this[qt],[ko]:t,[Qt]:"click_create_view_done"})}}renderComponent(){const{[ko]:e,showDoneButton:t}=this[So],{hoveredType:o}=this[Et],{device:n}=this[qt],i=e[Pt][yo],r=e[dt][yo],l=e[_t][yo],c=e[ct][yo],d=e.isRootChild[yo],u=this[fo](),p=Boolean(this.getCoverFormatKey()),h="table"===u,g="table"===u,v=Object.keys(r)[st]((e=>{const t=r[e];return t&&(0,m.isDateType)(t)})),y="timeline"===u&&v.length>0,f="timeline"===u&&v.length>1,k="timeline"===u&&Boolean(null==i?void 0:i[wt]),b="calendar"===u&&v.length>0,w="calendar"===u,C="board"===u,P=(0,E.d$)({[qt]:this[qt],[ct]:c,isRootChild:d}),T="timeline"===u&&Boolean(l.timeline_show_table)&&P,x="timeline"===u&&P,M=e[lt]();if(!M)return;const Z=M[at](),A=!("collectionTypedView"===e.contextType||Z&&c),F=e[vo][yo],B="page"===u,_=[rt,"board","timeline","calendar","list","gallery"];return s[Ge](s[Qe],null,a()(le.Z,{topBorder:!1,shouldShowBottomDivider:n[it]},void 0,a()("div",{[Rt]:{...!n[it]&&{[lo]:"100%",[nt]:8,[ot]:8},...n[it]&&{[tt]:this[eo][et],[lo]:"100%",[$e]:12,[Xe]:12}},onMouseLeave:this.handleViewTypeAreaMouseLeave},void 0,a()("div",{[Rt]:{[ho]:mo,flexFlow:"wrap",[Je]:so}},void 0,_.map(this.renderViewTypeButton)),a()("div",{[Rt]:{color:this[eo][je],[ro]:12,margin:"6px 8px 0px 8px"}},void 0,L.sN[o[yo]||u]))),a()(le.Z,{},void 0,A&&a()(se.Z,{[Ne]:a()(S.FormattedMessage,{[Ye]:"Show database title",id:"database.viewSettings.layoutTab.showDatabaseTitle.title"}),focused:!1,on:e.shouldShowSource[yo],[Ot]:this.handleShowCollectionTitleClick,[Kt]:!F[go],textWrapperStyle:{[qe]:1}}),p&&this.renderCardSettings(),g&&this.renderTableVerticalLinesSetting(),h&&this.renderTableWrapCellsSetting(),B&&this.renderPageViewSetting(),y&&this.renderTimelineBySetting(),k&&this.renderTimelineEndSetting(),f&&this.renderTimelineSeparateDatesSetting(),b&&this.renderCalendarBySetting(),w&&this.renderCalendarViewRangeSetting(),x&&a()(ee.N,{[ko]:e}),T&&this.renderTimelineTableProperties(),C&&this.renderBoardGroupByShortcuts(),this.renderPeekModeSetting()),t&&a()(le.Z,{disableMobileBorders:!0},void 0,a()(te.Z,{[Rt]:{[ho]:"flex",margin:"0 14px"},[Ot]:this.handleDoneClick},void 0,a()(S.FormattedMessage,{[Ye]:"Done",id:"database.viewSettings.createViewTab.doneButton.title"}))),a()(le.Z,{topBorder:!1},void 0,a()(j.Z,{href:(0,G.getLocalizedUrl)("guides.databaseView"),[Ne]:a()(S.FormattedMessage,{[Ye]:"Learn about views",id:"database.viewSettings.layoutTab.learnMoreButton.title"}),[Ue]:"view_settings_layout"})))}renderCardSettings(){const{device:e}=this[qt],{[ko]:t}=this[So],o=this.getCoverFormat(),n=this[ze](),i=!e[it]||"board"===this[fo](),r=t[vo][yo];return s[Ge](s[Qe],null,a()(X.Z,{[Ne]:a()(S.FormattedMessage,{[Ye]:"Card preview",id:"database.viewSettings.layoutTab.cardPreviewButtonTitle"}),[Ee]:o,popupStyle:{[He]:190},[We]:this.getCoverFormatOptions(),[Le]:this.handleCoverFormatChange,[Kt]:!r[go]}),i&&a()(X.Z,{[Ne]:a()(S.FormattedMessage,{[Ye]:"Card size",id:"databdatabase.viewSettings.layoutTab.cardSizeButtonTitle"}),[Ee]:n,popupStyle:{[He]:190},[We]:this.getCoverSizeFormatOptions(),[Le]:this.handleCoverSizeFormatChange,[Kt]:!r[go]}),o&&a()(se.Z,{[Ne]:a()(S.FormattedMessage,{[Ye]:"Fit image",id:"databdatabase.viewSettings.layoutTab.fitImageButtonTitle"}),on:"contain"===this[Re](),focused:!1,[Ot]:this.handleCoverAspectFormatToggle,[Kt]:!r[go],textWrapperStyle:{[qe]:1}}))}getCoverFormatOptions(){const{[ko]:e}=this[So],t=e[dt][yo];let o=Object.keys(t);o=l.sortBy(o,(e=>{const o=t[e];return o?o.name:""}));const{[eo]:n}=this,i=l.compact(o.map((e=>{const o=t[e];if(o&&"file"===o[ut]){return{key:{[ut]:Ke,[Ke]:e},[Ne]:o.name,icon:a()(h.ZP,{[ut]:o[ut],icon:o.icon,size:this[qt].device[it]?16:14,[eo]:n,[Rt]:{fill:n[Oe]}})}}})));return[...[void 0,{[ut]:"page_cover"},{[ut]:"page_content"}].map((e=>({key:e,[Ne]:O(e)}))),...i]}getCoverSizeFormatOptions(){return["small","medium","large"].map((e=>({key:e,[Ne]:K(e)})))}renderTableVerticalLinesSetting(){const{[ko]:e}=this[So],t=e[vo][yo];return a()(se.Z,{[Ne]:a()(S.FormattedMessage,{[Ye]:"Show vertical lines",id:"database.viewSettings.layoutTab.tableShowVerticalLines"}),on:!Boolean(e[_t][yo][Mt]),focused:!1,[Ot]:this.handleTableVerticalLinesToggle,[Kt]:!t[go],textWrapperStyle:{[qe]:1}})}renderTableWrapCellsSetting(){const{[ko]:e}=this[So],t=e[_t][yo],o=e[vo][yo];return a()(se.Z,{[Ne]:a()(S.FormattedMessage,{[Ye]:"Wrap all columns",id:"database.viewSettings.layoutTab.tableWrapAllColumns"}),on:Boolean(t[At]),focused:!1,[Ot]:this.handleTableWrapCellsToggle,[Kt]:!o[go],textWrapperStyle:{[qe]:1}})}renderPageViewSetting(){const e=this[So][ko][Dt]();if(e)return a()("div",{[Rt]:{[no]:5}},void 0,a()(ie.Z,{[Ie]:!0,placeholder:"Enter page ID",focusInitial:!0,[Le]:e=>{q.Z[Ht]({pageId:e[vt].value})},onSubmit:t=>{const o=q.Z[yo].pageId;o&&M[jt]({[Yt]:"CollectionSettingsViewLayoutMenu.renderPageViewSettings",[qt]:this[qt],[Nt]:t=>{P[It]({[Et]:[e],[Vt]:{page_pointer:{id:(0,y.getUUIDWithDashes)(o),[De]:t[De],[rt]:"block"}},[Ut]:t})}})}}))}renderTimelineBySetting(){var e,t;const{device:o}=this[qt],{[ko]:n}=this[So],r=null===(e=n[Pt][yo])||void 0===e?void 0:e[Ct],l=null===(t=n[Pt][yo])||void 0===t?void 0:t[wt],c=n[dt][yo],d=n[Dt](),u=n[vo][yo],p=n[Ve]();if(!r||!d||!p)return;const h=c[r];return h?a()(ne.ZP,{popupType:o[_e]?ae.kQ[Be]:ae.kQ.Popup,alignmentToOrigin:ne.vR.End,[Se]:ne.pO.Bottom,originGap:0,renderOrigin:e=>s[Ge](J.Z,i()({[Ne]:a()(S.FormattedMessage,l?{[Ye]:"Start date",id:"database.viewSettings.layoutTab.timelineStartDate.title"}:{[Ye]:"Show timeline by",id:"database.viewSettings.layoutTab.showTimelineByProperty.title"}),[Kt]:!u[go],showChevron:!0,right:a()("div",{[Rt]:f.Z[Fe]},void 0,h.name),rightStyle:{[ao]:1},textWrapperStyle:{[ao]:0}},e)),render:e=>{let t;return t=o[_e]?{[Ae]:Q.og[Ze]}:{[Ae]:Q.og.Popup,[lo]:300},s[Ge](re.Z,t,a()($.Z,{[Ce]:p[Me](),[we]:p[xe](),currentProperty:r,[be]:()=>Object.keys(c)[st]((e=>{const t=c[e];return t&&(0,m.isDateType)(t)})),[ke]:t=>{t&&(M[jt]({[Yt]:"CollectionSettingsViewLayoutMenu.renderTimelineBySetting",[qt]:this[qt],[Nt]:e=>{C[bt]({[Dt]:d,[Vt]:{[Ct]:t},[Ut]:e})}}),e[Te](),b[Gt]({[qt]:this[qt],[ko]:n,[Qt]:"update_timeline_by",[zt]:void 0,[Pe]:h[t][ut]}))}}))}}):void 0}renderTimelineEndSetting(){var e;const{device:t}=this[qt],{[ko]:o}=this[So],n=null===(e=o[Pt][yo])||void 0===e?void 0:e[wt],r=o[dt][yo],l=o[vo][yo],c=o[Dt](),d=o[Ve]();if(!n||!c||!d)return;const u=r[n];return u?a()(ne.ZP,{popupType:t[_e]?ae.kQ[Be]:ae.kQ.Popup,alignmentToOrigin:ne.vR.End,[Se]:ne.pO.Bottom,originGap:0,renderOrigin:e=>s[Ge](J.Z,i()({[Ne]:a()(S.FormattedMessage,{[Ye]:"End date",id:"database.viewSettings.layoutTab.timelineEndDate.title"}),showChevron:!0,right:u.name,[Kt]:!l[go]},e)),render:e=>{let i;return i=t[_e]?{[Ae]:Q.og[Ze]}:{[Ae]:Q.og.Popup,[lo]:300},s[Ge](re.Z,i,a()($.Z,{[Ce]:d[Me](),[we]:d[xe](),currentProperty:n,[be]:()=>Object.keys(r)[st]((e=>{const t=r[e];return t&&(0,m.isDateType)(t)})),[ke]:t=>{t&&(M[jt]({[Yt]:"CollectionSettingsViewLayoutMenu.renderTimelineEndSetting",[qt]:this[qt],[Nt]:e=>{C[bt]({[Dt]:c,[Vt]:{[wt]:t},[Ut]:e})}}),e[Te](),b[Gt]({[qt]:this[qt],[ko]:o,[Qt]:"update_timeline_by_end",[zt]:void 0,[Pe]:u[t][ut]}))}}))}}):void 0}renderTimelineSeparateDatesSetting(){const{[ko]:e}=this[So],t=e[Pt][yo],o=null==t?void 0:t[wt],n=e[vo][yo];return a()(se.Z,{[Ne]:a()(S.FormattedMessage,{[Ye]:"Separate start and end dates",id:"database.viewSettings.layoutTab.timelineUseSeparateDates.title"}),focused:!1,on:Boolean(o),[Ot]:this.handleTimelineSeparateDatesClick,[Kt]:!n[go],textWrapperStyle:{[qe]:1}})}renderCalendarViewRangeSetting(){const{[ko]:e}=this[So],t=e[vo][yo],o=this[fe]();return a()(X.Z,{[Ne]:a()(S.FormattedMessage,{[Ye]:"Show calendar as",id:"database.viewSettings.layoutTab.showCalendarAs.title"}),[ko]:e,openButtonPopup:"peekModeFormat"===e[ye][yo].openButtonPopup,[Ee]:o,popupStyle:{[He]:190},[We]:Co(),[Le]:this.handleCalendarViewRangeOptionClick,[Kt]:!t[go]})}renderCalendarBySetting(){var e;const{device:t}=this[qt],{[ko]:o}=this[So],n=null===(e=o[Pt][yo])||void 0===e?void 0:e[ve],r=o[vo][yo],l=o[dt][yo],c=o[Dt](),d=o[Ve]();if(!n||!c||!d)return;const u=l[n];return u?a()(ne.ZP,{popupType:t[_e]?ae.kQ[Be]:ae.kQ.Popup,alignmentToOrigin:ne.vR.End,[Se]:ne.pO.Bottom,originGap:0,renderOrigin:e=>s[Ge](J.Z,i()({[Ne]:a()(S.FormattedMessage,{[Ye]:"Show calendar by",id:"database.viewSettings.layoutTab.showCalendarByProperty.title"}),[Kt]:!r[go],showChevron:!0,right:a()("div",{[Rt]:f.Z[Fe]},void 0,u.name),rightStyle:{[ao]:1},textWrapperStyle:{[ao]:0}},e)),render:e=>{let i;return i=t[_e]?{[Ae]:Q.og[Ze]}:{[Ae]:Q.og.Popup,[lo]:300},s[Ge](re.Z,i,a()($.Z,{[Ce]:d[Me](),[we]:d[xe](),currentProperty:n,[be]:()=>Object.keys(l)[st]((e=>{const t=l[e];return t&&(0,m.isDateType)(t)})),[ke]:t=>{t&&(M[jt]({[Yt]:"CollectionSettingsViewLayoutMenu.renderCalendarBySetting",[qt]:this[qt],[Nt]:e=>{C[bt]({[Dt]:c,[Vt]:{[ve]:t},[Ut]:e})}}),e[Te](),b[Gt]({[qt]:this[qt],[ko]:o,[Qt]:"update_calendar_by",[zt]:void 0,[Pe]:u[t][ut]}))}}))}}):void 0}renderTimelineTableProperties(){const{[ko]:e,[mt]:t}=this[So],o=(e[_t][yo][ge]||[])[st]((e=>Boolean(e.visible))).length,n=e[vo][yo];return a()(J.Z,{[Ne]:a()(S.FormattedMessage,{[Ye]:"Table properties",id:"database.viewSettings.layoutTab.tablePropertiesButton.title"}),showChevron:!0,right:a()(S.FormattedMessage,{[Ye]:"{propertiesShown} shown",id:"database.viewSettings.layoutTab.propertiesButton.propertiesShown.title",values:{propertiesShown:o}}),[Ot]:()=>{w[he]({[mt]:t,item:{[ut]:me,timelineViewTab:rt}}),b[Gt]({[qt]:this[qt],[ko]:e,[Qt]:"click_timeline_table_properties"})},[Kt]:!n[go]})}renderBoardGroupByShortcuts(){const{[ko]:e,[mt]:t}=this[So],o=e[_t][yo][pe],n=e[dt][yo];if(!o)return;const i=e[vo][yo],r=n[o[Ke]];return r?s[Ge](s[Qe],null,a()(J.Z,{[Ne]:a()(S.FormattedMessage,{[Ye]:"Group by",id:"database.viewSettings.layoutTab.boardGroupByButton.title"}),showChevron:!0,right:r.name,[Ot]:()=>{w[he]({[mt]:t,item:{[ut]:"group",groupByKey:pe,[ue]:de}}),b[Gt]({[qt]:this[qt],[ko]:e,[Qt]:"click_board_group_by",[zt]:void 0,[Pe]:r[ut]})},[Kt]:!i[go]}),a()(se.Z,{[Ne]:a()(S.FormattedMessage,{[Ye]:"Color columns",id:"database.viewSettings.groupTab.colorColumns"}),on:!(0,R.h6)(this[qt],e),focused:!1,[Ot]:()=>{w.handleBoardGroupColorColumnsClick({[qt]:this[qt],[ko]:e})},[Kt]:!i[go],textWrapperStyle:{[qe]:1}})):void 0}renderPeekModeSetting(){const{[ko]:e}=this[So],t=e[vo][yo],o=this.getPeekModeFormat();return a()(X.Z,{[Ne]:a()(S.FormattedMessage,{[Ye]:"Open pages in",id:"database.viewSettings.layoutTab.peekModeTitle"}),[ko]:e,openButtonPopup:"peekModeFormat"===e[ye][yo].openButtonPopup,[Ee]:o,popupStyle:{[He]:190},[We]:Po({currentViewType:this[fo](),[eo]:this[eo]}),menuItemOptionsStyle:{[$e]:8,[Xe]:8},[Ot]:this.handleOpenPeekModePicker,[Le]:this.handlePeekModeFormatClick,[Kt]:!t[go]})}getNewDateRange(e){const{newViewRange:t,oldCalendarEnd:o,startOfWeekSetting:n}=e;if("month"===t){const e=(0,g.getStartOfWeek)((0,g.getStartOfMonth)(o),n);return{newDateRangeStart:e,newDateRangeEnd:(0,g.getEndOfWeek)((0,g.addMonthsToDate)({date:e,monthsToAdd:1}),n)}}{const e=(0,g.getStartOfWeek)(o,n);return{newDateRangeStart:e,newDateRangeEnd:(0,g.getEndOfWeek)(e,n)}}}[fo](){var e;const{[ko]:t}=this[So],o=null===(e=t[Dt]())||void 0===e?void 0:e.getType();if(!o)throw new Error(ce);return o}getCoverFormatKey(){return L.DL[this[fo]()]}getCoverFormat(){const{[ko]:e}=this[So],t=e[_t][yo],o=this.getCoverFormatKey();if(o&&t)return t[o]}getCoverSizeFormatKey(){return L.oy[this[fo]()]}[ze](){const{[ko]:e}=this[So],t=e[_t][yo],o=this.getCoverSizeFormatKey();if(o&&t){const e=t[o];if(e)return e}return v.defaultCoverSizeFormat}getPeekModeFormat(){const{[ko]:e}=this[So],t=e[_t][yo],o=this[fo]();return(null==t?void 0:t.collection_peek_mode)||W.Ls[o]}[fe](){const{[ko]:e}=this[So],t=e[_t][yo];return(null==t?void 0:t.calendar_view_range)||"month"}getCoverAspectFormatKey(){return L._Y[this[fo]()]}[Re](){const{[ko]:e}=this[So],t=e[_t][yo],o=this.getCoverAspectFormatKey();if(o&&t)return t[o]}}function Co(){return["month","week"].map((e=>({key:e,[Ne]:F.default.formatMessage(A.Lh[e])})))}function Po(e){const{currentViewType:t,[eo]:o}=e,n=t?W.Ls[t]:void 0;return["side_peek","center_peek","full_page"].map((e=>({key:e,[Ne]:(0,W.LQ)(e),body:s[Ge](s[Qe],null,(0,W.RI)(e),n&&t&&e===n&&a()("div",{[Rt]:{[Lt]:2,[Jt]:500,color:o[Xt]}},void 0,a()(S.FormattedMessage,{[Ye]:"Default for {view}",id:"database.viewPropertiesMenu.peekMode.defaultForView",values:{view:(0,p.Z)(t)}}))),icon:(0,W.RO)(e)({[lo]:16,fill:o[$t]})})))}wo.displayName="CollectionSettingsViewLayoutMenu";const To=(0,S.injectIntl)(wo)},75544:(e,t,o)=>{o.d(t,{N:()=>Yt,Z:()=>jt});var n=o(97464),i=o.n(n),r=o(77094),a=o.n(r),l=o(43261),s=o.n(l),c=o(96486),d=o(67294),u=o(83355),p=o(480),m=o(81954),h=o(49085),g=o(99036),v=o(80951),y=o(39068),f=o(6695),S=o(3909),k=o(97880),b=o(82990),w=o(5366),C=o(77162),P=o(5149),T=o(87085),x=o(64434),M=o(96802),Z=o(80402),A=o(12359),F=o(52821),B=o(68641),_=o(65742),V=o(33929),I=o(33665),D=o(10161),O=o(29798),K=o(73657),R=o(21269),L=o(13005),W=o(42917),E=o(54119),H=o(52275),z=o(79131),Q=o(5145),G=o(73063),U=o(68894),N=o(32163),q=o(89728),Y=o(72495),j=o(86825),J=o(66957);const X=o(85).lDm,$=o(85).Hik,ee=o(85).ug4,te=o(85).TEz,oe=o(85).Q9F,ne=o(85).pkR,ie=o(85).bey,re=o(85).Uie,ae=o(85).XNW,le=o(85).auS,se=o(85).PXg,ce=o(85).jkI,de=o(85).H1U,ue=o(85).EMU,pe=o(85).sM5,me=o(85).DwI,he=o(85).P3s,ge=o(85).Uk6,ve=o(85).Ud6,ye=o(85).oyC,fe=o(85).rGB,Se=o(85).BQ6,ke=o(85).Mm1,be=o(85)._V5,we=o(85).Exd,Ce=o(85).mSd,Pe=o(85).X_m,Te=o(85).rpY,xe=o(85).TtP,Me=o(85).qq3,Ze=o(85).rQ1,Ae=o(85).tBn,Fe=o(85).PG2,Be=o(85).PTG,_e=o(85).cTq,Ve=o(85).D7I,Ie=o(85).cZW,De=o(85).Dd5,Oe=o(85).kdC,Ke=o(85).Yzm,Re=o(85).VFs,Le=o(85).iB2,We=o(85).Wp_,Ee=o(85).dLQ,He=o(85).MAy,ze=o(85).unR,Qe=o(85).EIp,Ge=o(85).vnp,Ue=o(85).zkl,Ne=o(85).phM,qe=o(85).v1$,Ye=o(85).N_Z,je=o(85).BQW,Je=o(85)._tz,Xe=o(85).k9$,$e=o(85).pzN,et=o(85).QQK,tt=o(85).Xl2,ot=o(85).mFu,nt=o(85).h$M,it=o(85).hd7,rt=o(85).oWD,at=o(85).HxR,lt=o(85).UBi,st=o(85).kk0,ct=o(85).mYq,dt=o(85).MyD,ut=o(85).E3P,pt=o(85).A1P,mt=o(85).x3V,ht=o(85).s3u,gt=o(85).QSf,vt=o(85).ddU,yt=o(85).LCr,ft=o(85).e7B,St=o(85).Gnd,kt=o(85).nXm,bt=o(85).nxU,wt=o(85).Drs,Ct=o(85).JJj,Pt=o(85).e9w,Tt=o(85).fbO,xt=o(85).ij9,Mt=o(85).ffk,Zt=o(85).Qt1,At=o(85).eiN,Ft=o(85).uM3,Bt=o(85).pOQ,_t=o(85).Uww,Vt=o(85).QmD,It=o(85).qU4,Dt=o(85).NJt,Ot=o(85).etS,Kt=o(85).X5t,Rt=o(85).wgE,Lt=o(85).jQT,Wt=o(85).P0R,Et=o(85).P24,Ht=o(85).P0G,zt=o(85).wfR,Qt=o(85).K0Z,Gt=o(85).nx5,Ut=o(85).zwB,Nt=(0,w.defineMessages)({[Ut]:{[Gt]:"Search for a propertyâ¦",id:"database.viewSettings.propertiesTab.inputPlaceholder"},toggleFrozenColumnsAriaLabel:{[Gt]:"Toggle frozen columns",id:"database.viewSettings.propertiesTab.toggleFrozenColumnsAriaLabel"},togglePropertyVisibilityAriaLabel:{[Gt]:"Toggle property visibility",id:"database.viewSettings.propertiesTab.togglePropertyVisibilityAriaLabel"}});class qt extends u.Z{constructor(){super(...arguments),this.storeTypes={[Qt]:h.default[zt](""),[Ht]:O.Z},this.handleHideAllClick=e=>{const{[Et]:t}=this[Wt];C[Lt]({[Rt]:this[Rt],[Et]:t,[Kt]:"click_hide_all_properties"}),this[Ot]({formatKey:e,[Dt]:!1})},this.handleShowAllClick=e=>{const{[Et]:t}=this[Wt];C[Lt]({[Rt]:this[Rt],[Et]:t,[Kt]:"click_show_all_properties"}),this[Ot]({formatKey:e,[Dt]:!0})},this.handlePropertyReorder=e=>{const{formatKey:t,newPropertyKeys:o,onDropArgs:n}=e,{[Et]:i}=this[Wt],r=i[It]();if(!r)return;const a=i[_t][Vt][t]||[],l=o.indexOf(Bt),s=[...c[Ft](o[At]((e=>!e[Zt]("group-header-"))).map(((e,t)=>{const o=a.find((t=>t[Mt]===e));if(o)return l>=0?{...o,[xt]:Boolean(t<l)}:o}))),...a[At]((e=>!o[Tt](e[Mt])))],d=r[Pt]();let u=d;void 0!==d&&n.startPosition>d&&n.endPosition<=d?u=d+1:void 0!==d&&n.startPosition<d&&n.endPosition>=d&&(u=d-1),A[Ct]({[wt]:"CollectionSettingsViewProperties.handlePropertyReorder",[Rt]:this[Rt],[bt]:e=>{M[kt]({[St]:[r],[ft]:{[t]:s,table_frozen_column_index:u},[yt]:e})}}),C[Lt]({[Rt]:this[Rt],[Et]:i,[Kt]:"reorder_properties",[vt]:r[gt]()}),this[St][Ht].reset()},this[ht]=e=>{const{[Et]:t}=this[Wt];A[Ct]({[wt]:"CollectionSettingsViewProperties.handleFreezeColumns",[Rt]:this[Rt],[bt]:o=>{Z[mt]({[Rt]:this[Rt],[Et]:t,currentIndex:e,[yt]:o,entrypoint:pt})}})},this.handleTogglePropertyVisibility=e=>{var t,o;const{formatKey:n,propertyFormat:i,index:r}=e,{[Et]:a}=this[Wt],l=a[It]();if(!l)return;const s=a[_t][Vt],c=(s[n]||[])[At]((e=>e[Mt]!==i[Mt])),d=c[At]((e=>e[xt])),u=c[At]((e=>!e[xt])),p={...i,[xt]:!i[xt]},m=[...d,p,...u],h={...s,[n]:m};A[Ct]({[wt]:"CollectionSettingsViewProperties.handleTogglePropertyVisibility",[Rt]:this[Rt],[bt]:e=>{x[ut]({[It]:l,[ft]:{format:h},[yt]:e}),Z[mt]({[Rt]:this[Rt],[Et]:a,currentIndex:r,entrypoint:pt,[yt]:e,propertyAction:i[xt]?"hide":"show"})}}),C[Lt]({[Rt]:this[Rt],[Et]:a,[Kt]:dt,[vt]:l[gt](),[ct]:null===(t=l[st]())||void 0===t||null===(o=t[lt]()[p[Mt]])||void 0===o?void 0:o.type}),this.clearInput()},this.handlePropertyClick=e=>{var t,o;const{[at]:n,[Et]:i}=this[Wt],r=i[rt]();if(!r)return;const{formatKey:a,propertyFormat:l}=e;C[Lt]({[Rt]:this[Rt],[Et]:i,[Kt]:"click_property",[vt]:null==i||null===(t=i[It]())||void 0===t?void 0:t[gt](),[ct]:null===(o=r[lt]()[l[Mt]])||void 0===o?void 0:o.type}),P[it]({[at]:n,item:{type:Mt,formatKey:a,[Mt]:l[Mt],[nt]:r[ot]}})},this.handleViewDeletedPropertiesClick=()=>{const{[at]:e,[Et]:t,timelineViewTab:o}=this[Wt],n=t[rt]();n&&(C[Lt]({[Rt]:this[Rt],[Et]:t,[Kt]:"click_deleted_properties"}),P[it]({[at]:e,item:{type:"deletedProperties",timelineViewTab:o,[nt]:n[ot]}}))},this.handleNewPropertyClick=()=>{const{[Et]:e}=this[Wt],t=e[rt]();t&&(C[Lt]({[Rt]:this[Rt],[Et]:e,[Kt]:"click_new_property"}),P[tt]({[at]:e[et],item:{type:$e,propertyTypes:(0,F.TP)({[Xe]:t[Xe](),[Et]:e,[Rt]:this[Rt]}),onAccept:(t,o)=>{T.PW({[Rt]:this[Rt],[$e]:t,[Je]:o,[Et]:e,from:je})}}}))},this[Ye]=e=>{const{[at]:t,[Et]:o}=this[Wt];C[Lt]({[Rt]:this[Rt],[Et]:o,[Kt]:0===e?"click_properties_tab_timeline":"click_properties_tab_table"}),P.replaceCurrentItem({[at]:t,item:{type:qe,timelineViewTab:0===e?Ne:Ue}}),this.clearInput()},this.handleShowTableClick=()=>{this.clearInput()},this[Ge]=this[Qe]((()=>D.default[ze]("freeze_columns")))}renderComponent(){const{[Et]:e,timelineViewTab:t}=this[Wt],{device:o}=this[Rt],{[Qt]:n,[Ht]:r}=this[St],l=n[Vt],s=(0,B.WY)({[Et]:e}),c=(0,B.jI)({timelineViewTab:t,[Et]:e}),u=(0,_.d$)({[Rt]:this[Rt],[He]:e[He][Vt],isRootChild:e.isRootChild[Vt]});return d[Ve](L.ZP,i()({},this[Wt],{title:a()(w.FormattedMessage,{[Gt]:"Properties",id:"database.viewSettings.propertiesTab.title"}),header:a()(Y.Z,{},void 0,a()(U.ZP,{focusInitial:!o[Ee],value:l,[Oe]:!0,[De]:e=>{n[We](e.target.value),r[We]({...r[Vt],focus:{section:0,[Le]:0,[Re]:0}})},[Ie]:V.default[Ke](Nt[Ut])})),footer:this.renderFooter()}),"timeline"===s&&u&&this.renderTimelineControls(),c&&this.renderPropertyFormatList(c),a()(Y.Z,{},void 0,this.renderDeletedProperties()))}renderTimelineControls(){const{timelineViewTab:e,[Et]:t}=this[Wt],o="timeline"===e?0:1;return d[Ve](d[Ae],null,a()(J.Z,{tabs:[a()(w.FormattedMessage,{[Gt]:"Timeline",id:_e},_e),a()(w.FormattedMessage,{[Gt]:"Table",id:Be},Be)],selectedIndex:o,[De]:this[Ye]}),"table"===e&&a()(Y.Z,{},void 0,a()(Yt,{[Et]:t,[Fe]:this.handleShowTableClick})))}renderPropertyFormatList(e){const{[Et]:t}=this[Wt],o=t[Ze][Vt],n=t[_t][Vt],r=t[Me][Vt],{[Qt]:l}=this[St],u=l[Vt];let p=n[e]||[];if(u){let e=p.map((e=>{const t=(0,v.getNormalizedPropertySchema)({schema:r,[Mt]:e[Mt]});return null==t?void 0:t.name}));e=s()[At](u,e).map((e=>{let{original:t}=e;return t})),p=p[At]((t=>{const o=r[t[Mt]];return o&&o.name&&e[Tt](o.name)}))}const m=p[At]((e=>Boolean(e[xt]))),h=p[At]((e=>!Boolean(e[xt]))),g="timeline_table_properties"===e?Ue:(0,B.WY)({[Et]:t});return d[Ve](d[Ae],null,0===p[xe]&&a()(Y.Z,{},void 0,a()(K.Z,{caption:a()(w.FormattedMessage,{[Gt]:"No results",id:"database.viewSettings.propertiesTab.noResults"})})),p[xe]>0&&a()(N.Z,{type:N.i.Vertical,store:this[St][Ht],initialFocus:void 0,sections:c[Ft]([m[xe]>0&&{key:"visible_and_hidden_properties",[Te]:t=>d[Ve](Y.Z,i()({},t,{noTextOverflow:!0,isTitleUppercase:!1,title:this.renderShownInViewMessage(g),desktopTitleStyle:{[Pe]:19},right:!u&&o[Ce]&&a()(q.Z,{isSmall:!0,shouldShrink:!0,isBlue:!0,[Se]:{[we]:12,[Pe]:void 0,[be]:2,[ke]:2},[Fe]:()=>this.handleHideAllClick(e)},void 0,a()(w.FormattedMessage,{id:"database.viewSettings.propertiesTab.hideAllProperties",[Gt]:"Hide all"})),[fe]:this.renderPropertySortList({formatKey:e,visibleProperties:m,hiddenProperties:h,[fe]:t[fe]})})),items:c[Ft]([...this[ye]({formatKey:e,[qe]:m,renderPinnedProperties:!0}),h[xe]>0&&{key:"group-header-hidden-property",[Te]:t=>this[ve]({[Wt]:t,formatKey:e,[fe]:d[Ve](d[Ae],null)}),[Kt]:()=>{}},...this[ye]({formatKey:e,[qe]:h,renderPinnedProperties:!1})])},0===m[xe]&&h[xe]>0&&{key:"hidden_properties",[Te]:t=>this[ve]({[Wt]:t,formatKey:e,[fe]:this.renderPropertySortList({formatKey:e,visibleProperties:m,hiddenProperties:h,[fe]:t[fe]})}),items:this[ye]({formatKey:e,[qe]:h,renderPinnedProperties:!1})}])}))}[ve](e){const{[Wt]:t,formatKey:o,[fe]:n}=e,{[Et]:r}=this[Wt],l=r[Ze][Vt],{[Qt]:s}=this[St],c=s[Vt],u="timeline_table_properties"===o?Ue:(0,B.WY)({[Et]:r});return d[Ve](Y.Z,i()({},t,{noTextOverflow:!0,isTitleUppercase:!1,title:this.renderHiddenInViewMessage(u),desktopTitleStyle:{[Pe]:19},right:!c&&l[Ce]&&a()(q.Z,{isSmall:!0,shouldShrink:!0,isBlue:!0,[Se]:{[we]:12,[Pe]:void 0,[be]:2,[ke]:2},[Fe]:()=>this.handleShowAllClick(o)},void 0,a()(w.FormattedMessage,{id:"database.viewSettings.propertiesTab.showAllProperties",[Gt]:"Show all"})),[Se]:{width:"100%",[ke]:0},[fe]:n}))}renderFooter(){const{[Et]:e,timelineViewTab:t}=this[Wt],o=e[Ze][Vt],n="timeline"===(0,B.WY)({[Et]:e})&&"table"===t&&!(0,B.vw)({[Et]:e}),i=o[ge]&&!n;return a()(Y.Z,{topBorder:!0},void 0,i&&a()(W.Z,{icon:S.Z.plus,title:a()(w.FormattedMessage,{id:"database.viewSettings.propertiesTab.newProperty",[Gt]:"New property"}),isGray:!0,[Fe]:this.handleNewPropertyClick}),a()(R.Z,{href:(0,I.getLocalizedUrl)("guides.databaseProperties"),title:a()(w.FormattedMessage,{[Gt]:"Learn about properties",id:"database.viewSettings.propertiesTab.learnMoreButton.title"}),[he]:"view_settings_properties"}))}renderPropertySortList(e){const{formatKey:t,visibleProperties:o,hiddenProperties:n,[fe]:i}=e,r=c[Ft]([...o.map((e=>e[Mt])),o[xe]>0&&n[xe]>0&&{key:"group-header-hidden-property",draggable:!1},...n.map((e=>e[Mt]))]);return this.canReorder()?a()(z.ZP,{direction:"vertical",keys:r,renderKey:(e,t)=>i[t],onDrop:(e,o)=>{this.handlePropertyReorder({formatKey:t,newPropertyKeys:e,onDropArgs:o})}}):i}[ye](e){const{formatKey:t,[qe]:o,renderPinnedProperties:n}=e;return c[Ft](o.map(((e,o)=>this[me]({formatKey:t,propertyFormat:e,index:o,renderPinnedProperties:n}))))}[me](e){var t;const{formatKey:o,propertyFormat:n,index:r,renderPinnedProperties:l}=e,{[Et]:s}=this[Wt],c=null===(t=s[rt]())||void 0===t?void 0:t[Xe](),u=s[Ze][Vt],p=!n[xt],m=s[Me][Vt],h=(0,v.getNormalizedPropertySchema)({schema:m,[Mt]:n[Mt]}),f="title"!==n[Mt]||this.primaryPropertyFormatAllowsHidingTitle(o),k=!u[ge]||c&&((0,v.isExternalPropertyId)(n[Mt])||(0,g.isInternalTitlePropertyId)(n[Mt]));if(!h)return;const{theme:w}=this,C=s[It](),P=null==C?void 0:C[Pt](),T=Boolean(l&&void 0!==P&&r<=P&&"table"===(null==C?void 0:C[gt]()));return{key:n[Mt],[Te]:e=>d[Ve](H.Z,i()({},e,{title:a()("div",{[Se]:{[pe]:ue,[de]:ce}},void 0,this.canReorder()&&a()(Q.ZP,{iconSize:12,[Se]:{[se]:8}}),a()(y.ZP,{type:h.type,icon:h.icon,size:16,theme:w,[Se]:{fill:w[le]}}),a()("span",{[Se]:{[ae]:8,...b.Z[re]}},void 0,h.name),(0,g.getAiInferenceFromPropertySchema)(h)&&a()(E.Z,{})),right:a()("div",{[Se]:{[pe]:ue,[de]:ce}},void 0,"table"!==(null==C?void 0:C[gt]())||this[Rt].device[Ee]||!this[Ge][Vt]?null:a()(G.Z,{icon:T?S.Z.pinFilled:S.Z.pin,[ie]:{width:16,[Pe]:16},isDarkIconColor:!0,ariaLabel:this[Wt].intl[Ke](Nt.toggleFrozenColumnsAriaLabel),[Fe]:()=>{this[ht](r)},[ne]:p||!u[Ce]}),a()(G.Z,{icon:p?S.Z.eyeHide:S.Z.eye,[ie]:{width:16,[Pe]:16},isDarkIconColor:!p,[Fe]:()=>{this.handleTogglePropertyVisibility({formatKey:o,propertyFormat:n,index:r})},ariaLabel:this[Wt].intl[Ke](Nt.togglePropertyVisibilityAriaLabel),[ne]:!f||!u[Ce]}),!k&&S.Z[oe]({width:12,fill:w[te],[ae]:5}))})),[Kt]:()=>{k||this.handlePropertyClick({formatKey:o,propertyFormat:n})}}}renderShownInViewMessage(e){return"table"===e?a()(w.FormattedMessage,{[Gt]:"Shown in table",id:"database.viewSettings.propertiesTab.shownInTableTitle"}):"timeline"===e?a()(w.FormattedMessage,{[Gt]:"Shown in timeline",id:"database.viewSettings.propertiesTab.shownInTimelineTitle"}):"board"===e?a()(w.FormattedMessage,{[Gt]:"Shown in board",id:"database.viewSettings.propertiesTab.shownInBoardTitle"}):"list"===e?a()(w.FormattedMessage,{[Gt]:"Shown in list",id:"database.viewSettings.propertiesTab.shownInListTitle"}):"gallery"===e?a()(w.FormattedMessage,{[Gt]:"Shown in gallery",id:"database.viewSettings.propertiesTab.shownInGalleryTitle"}):"calendar"===e?a()(w.FormattedMessage,{[Gt]:"Shown in calendar",id:"database.viewSettings.propertiesTab.shownInCalendarTitle"}):"page"===e?null:void(0,k.unreachable)(e)}renderHiddenInViewMessage(e){return"table"===e?a()(w.FormattedMessage,{[Gt]:"Hidden in table",id:"database.viewSettings.propertiesTab.hiddenInTableTitle"}):"timeline"===e?a()(w.FormattedMessage,{[Gt]:"Hidden in timeline",id:"database.viewSettings.propertiesTab.hiddenInTimelineTitle"}):"board"===e?a()(w.FormattedMessage,{[Gt]:"Hidden in board",id:"database.viewSettings.propertiesTab.hiddenInBoardTitle"}):"list"===e?a()(w.FormattedMessage,{[Gt]:"Hidden in list",id:"database.viewSettings.propertiesTab.hiddenInListTitle"}):"gallery"===e?a()(w.FormattedMessage,{[Gt]:"Hidden in gallery",id:"database.viewSettings.propertiesTab.hiddenInGalleryTitle"}):"calendar"===e?a()(w.FormattedMessage,{[Gt]:"Hidden in calendar",id:"database.viewSettings.propertiesTab.hiddenInCalendarTitle"}):"page"===e?null:void(0,k.unreachable)(e)}renderDeletedProperties(){const{[Et]:e}=this[Wt],t=e[ee][Vt],o=Object.keys(t)[xe];if(e[Ze][Vt][ge]&&o>0)return a()(W.Z,{icon:S.Z.trash,title:a()(w.FormattedMessage,{id:"database.viewSettings.propertiesTab.deletedProperties",[Gt]:"Deleted properties"}),isGray:!0,[Fe]:this.handleViewDeletedPropertiesClick,right:o,showChevron:!0})}canReorder(){const{[Qt]:e}=this[St],t=e[Vt],{[Et]:o}=this[Wt],n=o[Ze][Vt];return!this[Rt].device[Ee]&&n[Ce]&&!t}[Ot](e){const{formatKey:t,[Dt]:o}=e,{[Et]:n}=this[Wt],i=n[It]();if(!i)return;const r=n[_t][Vt][t]||[],a=r[At]((e=>Boolean(e[xt]))),l=r[At]((e=>!Boolean(e[xt]))),s=[...a.map((e=>({...e,[xt]:o}))),...l.map((e=>({...e,[xt]:o})))];A[Ct]({[wt]:"CollectionSettingsViewProperties.setAllPropertiesVisibility",[Rt]:this[Rt],[bt]:e=>{M[kt]({[St]:[i],[ft]:{[t]:s},[yt]:e})}})}primaryPropertyFormatAllowsHidingTitle(e){const{[Et]:t}=this[Wt],o=t[_t][Vt],n=(0,B.WY)({[Et]:t});return"board"===n?(0,f.boardOrGalleryAllowsHidingTitle)(o.board_cover):"gallery"===n?(0,f.boardOrGalleryAllowsHidingTitle)(o.gallery_cover):"timeline"===n&&("timeline_table_properties"===e||(0,f.timelinePropertiesAllowsHidingTitle)(Boolean(o[$]),o[X]||[]))}clearInput(){this[St][Qt].reset()}}function Yt(e){window.__c={n:"TimelineShowTableSwitcher"};const{[Et]:t,[Fe]:o}=e,n=(0,p.O7)(),i=(0,m.Kw)(t[_t]),r=Boolean(i[$]),l=(0,m.Kw)(t[Ze]);return a()(j.Z,{title:a()(w.FormattedMessage,{[Gt]:"Show table",id:"database.viewSettings.propertiesTab.showTable"}),on:r,focused:!1,[Fe]:()=>{const e=t[It]();e&&(A[Ct]({[wt]:"CollectionSettingsViewProperties.TimelineShowTableSwitcher",[Rt]:n,[bt]:t=>{M[kt]({[St]:[e],[ft]:{[$]:!r,[X]:[{[Mt]:"name",[xt]:!0}]},[yt]:t})}}),null==o||o(),C[Lt]({[Rt]:n,[Et]:t,[Kt]:"timeline_toggle_show_table"}))},[ne]:!l[Ce],textWrapperStyle:{opacity:1}})}qt.displayName=pt;const jt=(0,w.injectIntl)(qt)},41418:(e,t,o)=>{o.d(t,{Z:()=>Ae});var n=o(97464),i=o.n(n),r=o(77094),a=o.n(r),l=o(96486),s=o(67294),c=o(83355),d=o(8848),u=o(3909),p=o(5366),m=o(50906),h=o(12534),g=o(33929),v=o(87279),y=o(31339),f=o(42917),S=o(61053),k=o(60246),b=o(52275),w=o(31945),C=o(14871),P=o(77498),T=o(62045),x=o(50542);const M=o(85).nx5,Z=o(85).Yzm,A=o(85).GCx,F=o(85).OBh,B=o(85).D7I,_=o(85).pkR,V=o(85).Qm2,I=o(85).wgE,D=o(85).jQT,O=o(85).Dd5,K=o(85).ffk,R=o(85).P0R,L=o(85).YDe;class W extends c.Z{constructor(){super(...arguments),this.handleAccept=e=>{const{sort:t,[L]:o}=this[R],n={...t,[K]:e};this[R][O](this[R].index,n),o&&m[D](this[I],{[V]:o,action:"set_sort_property"})}}renderComponent(){const{schema:e,sort:t}=this[R],o=e[t[K]];if(o)return a()(s.Fragment,{},void 0,this.renderPropertyDropdown(o),this.renderSortDirection())}renderPropertyDropdown(e){const{device:t}=this[I],{[_]:o}=this[R];return a()(w.ZP,{popupType:t.isMobile?w.Z4.SlideUp:w.Z4.Popup,renderOrigin:t=>s[B](x.Z,i()({},t,{[F]:e,[_]:o,textWrapperStyle:{opacity:1}})),render:e=>a()(P.Z,{isRelationProperty:!1,schema:this[R].schema,onAccept:this.handleAccept,onClose:e.close}),[_]:o})}renderSortDirection(){const{sort:e,index:t,[O]:o,[L]:n,intl:r,[_]:a}=this[R],l=e[A],c={menuTitle:r[Z]({id:"collectionSortMenuRow.sortDirectionSelectMenu.title",[M]:"Sort"}),items:[...k.C6],getKey:e=>e,selectedItem:l,[_]:a,onSelect:i=>{const r={...e,[A]:i};o(t,r),n&&m[D](this[I],{[V]:n,action:"set_sort_direction"})},renderItem:e=>s[B](b.Z,i()({title:W.sortDirectionMessage[e.value]},e)),renderOrigin:e=>s[B](T.Z,i()({},e,{placeholder:r[Z]({id:"collectionSortMenuRow.sortDirectionSelectMenu.placeholder",[M]:"Empty"}),title:l&&W.sortDirectionMessage[l],[_]:a,desktopStyle:{opacity:1}}))};return s[B](C.Z,i()({key:A},c,{mobileActionSheet:!0}))}}W.displayName="CollectionSortMenuRow",W.sortDirectionMessage={ascending:a()(p.FormattedMessage,{[M]:"Ascending",id:"collectionSortMenuRow.sortDirectionSelectMenu.ascending"}),descending:a()(p.FormattedMessage,{[M]:"Descending",id:"collectionSortMenuRow.sortDirectionSelectMenu.descending"})};const E=(0,p.injectIntl)(W);var H=o(79131),z=o(73063),Q=o(78140),G=o(28992),U=o(44532),N=o(72495),q=o(58032);const Y=o(85).PXg,j=o(85).F7y,J=o(85).NLk,X=o(85).jkI,$=o(85).H1U,ee=o(85).YDe,te=o(85).fBu,oe=o(85).PG2,ne=o(85).BCA,ie=o(85).tb8,re=o(85).Yzm,ae=o(85).Ie8,le=o(85).ceT,se=o(85).D7I,ce=o(85).dLQ,de=o(85).mYq,ue=o(85).a67,pe=o(85).GCx,me=o(85).ffk,he=o(85).Kiu,ge=o(85).AbC,ve=o(85).eiN,ye=o(85).Qm2,fe=o(85).X5t,Se=o(85).wgE,ke=o(85).jQT,be=o(85).J2Z,we=o(85).P0R,Ce=o(85).Dd5,Pe=o(85).TpH,Te=o(85).nx5,xe=o(85).zwB,Me=(0,p.defineMessages)({[xe]:{[Te]:"Search for a propertyâ¦",id:"database.viewSettings.collectionSortMenu.inputPlaceholder"}});class Ze extends c.Z{constructor(){super(...arguments),this[Pe]=e=>{const{[Ce]:t}=this[we],{sorts:o}=this[we];t(l.compact(e.map((e=>o[parseInt(e)]))));const n=this[be]();n&&m[ke](this[Se],{[fe]:"reorder_sorts",[ye]:n})},this.handleChangeSort=(e,t)=>{const{[Ce]:o}=this[we],{sorts:n}=this[we];o(n.map(((o,n)=>n===e?t:o)));const i=this[be]();i&&m[ke](this[Se],{[fe]:"update_sort",[ye]:i})},this.handleDeleteSort=e=>{const{[Ce]:t}=this[we],{sorts:o}=this[we];t(o[ve](((t,o)=>o!==e)));const n=this[be]();n&&m[ke](this[Se],{[fe]:"delete_sort",[ye]:n})},this[ge]=()=>{const{[Ce]:e,onDeleteAll:t}=this[we];e([]),null==t||t();const o=this[be]();o&&m[ke](this[Se],{[fe]:"delete_all_sorts",[ye]:o})},this.handleNewPropertyAccept=e=>{var t;if(!e)return;const{[he]:o,sorts:n,[Ce]:i}=this[we],r=null===(t=o[e])||void 0===t?void 0:t.type;i([...n,{[me]:e,[pe]:ue}]);const a=this[be]();a&&m[ke](this[Se],{[fe]:"create_sort_accept",[ye]:a,[de]:r})}}renderComponent(){const{device:e}=this[Se],{[he]:t,format:o,sorts:n,showDeleteAll:r}=this[we],l=!!Object.keys(t).some((e=>!n.find((t=>t[me]===e)))),c=r&&n.length>0;return s[se](s.Fragment,null,this.renderSorts(),(l||c)&&a()(N.Z,{},void 0,l&&a()(w.ZP,{popupType:e[ce]?U.kQ.SlideUp:U.kQ.Popup,renderOrigin:e=>s[se](f.Z,i()({icon:u.Z.plus,isGray:!0,title:a()(p.FormattedMessage,{id:"database.viewSettings.sortTab.newSort",[Te]:"Add sort"})},e)),render:i=>{let r;return r=e[ce]?{[le]:v.og[ae]}:{[le]:v.og.Popup,width:280,height:287},s[se](Q.Z,r,a()(S.Z,{[he]:t,format:o,[ie]:()=>Object.keys(t)[ve]((e=>!n.find((t=>t[me]===e)))),[ne]:e=>{this.handleNewPropertyAccept(e),i.close()},[xe]:g.default[re](Me[xe])}))}}),c&&a()(f.Z,{icon:u.Z.trash,isRed:!0,isGray:!0,title:a()(p.FormattedMessage,{id:"database.viewSettings.sortTab.deleteAllSorts",[Te]:"Delete sort"}),[oe]:this[ge]})))}renderSorts(){const{device:e}=this[Se],{sorts:t}=this[we];if(e[ce])return t.map(((e,t)=>this.renderSort(e,t)));{const e=t.map(((e,t)=>t.toString()));return e.length>0&&a()("div",{style:{marginBottom:2}},void 0,a()(H.ZP,{[pe]:"vertical",keys:e,renderKey:e=>this.renderSort(t[parseInt(e)],parseInt(e)),onDrop:this[Pe]}))}}renderSort(e,t){const{device:o}=this[Se],{[he]:n,disabled:i,[te]:r}=this[we];return o[ce]?a()(N.Z,{},t,a()(E,{index:t,sort:e,[he]:n,[te]:r,[ee]:this[be](),[Ce]:this.handleChangeSort}),!i&&this.renderMobileDeleteButtonMenuItem(t)):a()(N.Z,{extraTopPadding:!0,desktopStyle:{padding:"8px 0 0 8px",width:"100%"}},t,a()(G.Z,{showDragHandle:!o[ce]&&!i,title:a()("div",{style:{display:"flex",[$]:X,flexGrow:1,[J]:j},onMouseDown:h.$0},void 0,a()(E,{index:t,sort:e,[he]:n,[te]:r,[ee]:this[be](),[Ce]:this.handleChangeSort})),right:!i&&this.renderDesktopDeleteButton(t)}))}renderMobileDeleteButtonMenuItem(e){return a()(b.Z,{title:a()("div",{style:{color:d.ZP.red}},void 0,a()(p.FormattedMessage,{[Te]:"Delete",id:"database.viewSettings.sortTab.mobileDeleteButtonTitle"})),icon:a()(y.Z,{icon:u.Z.trash,styles:{color:d.ZP.red}}),[oe]:()=>this.handleDeleteSort(e),focused:!1})}renderDesktopDeleteButton(e){return a()(q.Z,{render:t=>s[se](z.Z,i()({icon:u.Z.collectionDeleteRule,[oe]:()=>this.handleDeleteSort(e),style:{[Y]:-6}},t)),renderTooltip:()=>a()(p.FormattedMessage,{[Te]:"Remove sort rule",id:"database.sortMenu.deleteButtonTooltip"})})}[be](){const{collectionViewStore:e}=this[we];return null==e?void 0:e.getType()}}Ze.displayName="CollectionSortMenu";const Ae=(0,p.injectIntl)(Ze)},87494:(e,t,o)=>{o.d(t,{v:()=>ct,Q:()=>lt});var n=o(97464),i=o.n(n),r=o(77094),a=o.n(r),l=o(96486),s=o(67294),c=o(480),d=o(81954),u=o(24405),p=o(3865),m=o(48777),h=o(23290),g=o(76218),v=o(5366),y=o(6287),f=o(97880),S=o(9953),k=o(12359),b=o(30950),w=o(24457),C=o(29502),P=o(28267),T=o(52275),x=o(31945),M=o(78140),Z=o(32163),A=o(72495),F=o(61766),B=o(38752),_=o(44532),V=o(72865),I=o(3909),D=o(68626),O=o(87279),K=o(77907),R=o(40721),L=o(89728),W=o(28405),E=o(30387);const H=o(85).di,z=o(85).voC,Q=o(85).Flw,G=o(85).nSw,U=o(85).$Qz,N=o(85).Gm5,q=o(85).Hnr,Y=o(85).D7I,j=(0,K.withDependency)(K.deps.formulas,((e,t)=>s[Y](J,i()({},t,{formulas:e}))));function J(e){window.__c={n:"FormulaInputMenu"};const{value:t,onChange:o,disabled:n,contextStore:i,formulas:r}=e,l=(0,c.Fy)(),u=(0,s.useCallback)((e=>{o({type:"formula",value:e})}),[o]),p=(0,s.useCallback)((()=>{o({type:"simple",value:null==t?void 0:t.value})}),[o,t]),m=(0,d.VK)((()=>i[N][q].getSpaceId()),[i[N][q]]),h=(0,d.Kw)(i[U]),g=(0,s.useMemo)((()=>r.createFormulaDataRequestHandler(i[N][q][G],i[N][q][Q])),[i[N][q][G],i[N][q][Q],r]),y=(0,d.VK)((()=>{if(D.x.isFail(h))return;return{valueTypes:h.value.valueTypes,handleDataRequest:g}}),[h,g],{useDeepEqual:!0});let f;return f=l.isMobile?{menuType:O.og.Modal,right:a()(R.DoneMenuText,{}),onClickRight:parent.close}:{menuType:O.og.Popup,maxHeight:"50vh",width:600,height:320,disableHeaderBorder:!0},m&&y?s[Y](M.Z,f,a()(W.Z,{formulas:r,value:null==t?void 0:t.value,typecheckContext:y,onChange:u,[H]:m,disabled:n,inputHeader:a()(L.Z,{isGray:!0,isSmall:!0,icon:I.Z.arrowLeft,onClick:p},void 0,s[Y](v.FormattedMessage,E.s.back)),focus:!0,evaluationErrors:[],[z]:i[N][q][z]})):null}var X=o(70203),$=o(17809),ee=o(65187);const te=o(85).MHP,oe=o(85).lp0,ne=o(85).$Lq,ie=o(85).sUt,re=o(85).XuB,ae=o(85).EHj;function le(e){window.__c={n:"NumberInput"};const{value:t,disabled:o,buttonPopupStore:n,onChange:i}=e,r=(0,u.yK)((e=>({wrap:{flexGrow:1,flexShrink:1,boxShadow:e.inputBoxShadow,borderRadius:3,padding:4}})),[]),l=(0,s.useCallback)((e=>{"="===(0,X.getText)(e)&&(0,$.formulaButtonsEnabled)()?(i({type:"formula",value:void 0}),n.setState({open:!0})):i({type:"simple",value:e})}),[i,n]),{store:c}=(0,$.useMockTextStore)({initialValue:null==t?void 0:t.value,onChange:l});return a()("div",{style:r.wrap},void 0,a()(ee.Z,{disabled:o,store:c,pasteBehavior:"inline",[ae]:!0,[re]:!0,[ie]:!0,[ne]:!0,[oe]:!0,disableEmbedMenu:!0,disableMobileActionBar:!0,disableComment:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,[te]:!0,disableEquationInteraction:!0}))}var se=o(55950),ce=o(18466),de=o(13991),ue=o(82990),pe=o(14976),me=o(17731),he=o(75311);const ge=o(85).t8X,ve=o(85).MHP,ye=o(85).$Qz,fe=o(85).Hnr,Se=o(85).Oc6,ke=o(85).pkR,be=o(85).D7I,we=o(85).Gm5;function Ce(e){window.__c={n:"ValuePickerValue"};const{value:t,type:o,currentSimpleFormulaValueTokens:n,contextStore:i,[we]:r}=e,{collectionStore:l,property:c}=r,p=(0,u.yK)((()=>({tokenWrap:{display:"flex",alignItems:"center",flexGrow:1,overflow:"hidden",marginTop:6}})),[]),m=(0,he.M)(l,c),h=(0,d.VK)((()=>(0,$.formulaButtonsEnabled)()),[]);if("formula"===(null==t?void 0:t.type)&&t.value&&h)return s[be](Te,e);if("text"===o.type||"number"===o.type)return null;if("date"===o.type||"select"===o.type||"checkbox"===o.type){const e=n[0];return void 0===e?a()(Pe,{}):a()("div",{style:p.tokenWrap},void 0,a()(se.K,{token:e,contextStore:i,[ke]:!0,currentSimpleFormulaValueTokens:n,[we]:r}))}if("person_array"===o.type||"block_array"===o.type||"select_array"===o.type)return 0===n.length?a()(Pe,{}):a()("div",{style:p.tokenWrap},void 0,m(n,"first").map(((e,t)=>a()(se.K,{token:e,contextStore:i,[ke]:!0,currentSimpleFormulaValueTokens:n,[we]:r},t))));(0,f.unreachable)(o)}function Pe(){window.__c={n:"ValueEmptyPlaceholder"};const e=(0,u.yK)((e=>({placeholderText:{color:e.lightTextColor}})),[]);return a()("div",{style:e.placeholderText},void 0,s[be](v.FormattedMessage,E.s.personSelect))}function Te(e){window.__c={n:"MinimalFormulaText"};const{value:t,contextStore:o}=e,n=(0,c.O7)(),i=(0,u.Fg)(),r=(0,u.yK)((e=>({wrap:{display:"flex",alignItems:"center",pointerEvents:"none",fontFamily:ue.Z[Se](de.SP).githubMono,fontSize:12,flexGrow:1,...ue.Z.textOverflowStyle},icon:{width:14,fill:e.mediumIconColor,marginRight:6}})),[]),l=(0,me.kw)(),p=(0,d.VK)((()=>n.KatexStore.getKatex()),[n]),m=(0,d.VK)((()=>o[we][fe].getSpaceId()),[o[we][fe]]),h=(0,d.Kw)(o[ye]),g=D.x.isSuccess(h)?h.value.valueTypes:void 0,v=(0,s.useMemo)((()=>ce.Z.withListenerIgnored((()=>(0,pe.renderText)({environment:n,textValue:null!=t&&t.value&&m?{value:t.value,spaceId:m}:void 0,parentStore:o[we][fe],disableHover:!1,[ve]:!1,[ge]:!1,[ke]:!0,theme:i,emojiType:l,katex:p,parentBlockId:void 0,renderedPageBlockId:void 0,formulaValueTypes:g||[]})))),[t,m,n,o[we][fe],l,p,i,g]);return a()("div",{style:r.wrap},void 0,I.Z.typesFormula(r.icon),v)}const xe=o(85).LtW,Me=o(85).D7I;function Ze(e){window.__c={n:"SimpleFormulaValuePicker"};const{type:t,value:o,disabled:n}=e,r=(0,c.Fy)(),l=!o||"simple"===o.type,p=(0,d.VK)((()=>(0,g.A6)(null==o?void 0:o.value)),[o]),m=(0,u.yK)((e=>({button:{flexGrow:1,flexShrink:1,boxShadow:e.inputBoxShadow}})),[]),h=(0,d.qz)(void 0,F.Z);return"number"===t.type&&l?s[Me](le,i()({},e,{[xe]:h})):"text"===t.type?s[Me](V.D,e):a()(x.ZP,{popupType:r.isMobile?_.kQ.SlideUp:_.kQ.Popup,alignmentToOrigin:x.vR.End,placementToOrigin:x.pO.Bottom,originGap:0,[xe]:h,disabled:n,renderOrigin:t=>s[Me](B.S,i()({disabled:n,variant:"gray"},t,{style:m.button}),s[Me](Ce,i()({},e,{currentSimpleFormulaValueTokens:p}))),render:t=>l?s[Me](se.a,i()({},e,{onClose:t.close,currentSimpleFormulaValueTokens:p})):s[Me](j,e)})}var Ae=o(39068),Fe=o(61053);const Be=o(85).tb8,_e=o(85).nx5,Ve=o(85).D7I,Ie=o(85).Uie,De=o(85).ChN;function Oe(e){window.__c={n:"AutomationPropertyPicker"};const{availablePropertyIds:t,currentValue:o,collectionStore:n,onChange:r,onRemove:l,disabled:p,alreadyHaveProperties:m}=e,h=(0,c.O7)(),g=(0,u.Fg)(),{device:y}=h,f=(0,d.VK)((()=>n.getSchema()??{}),[n]),S=(0,d.VK)((()=>n.getFormat()??{}),[n]),k=(0,d.VK)((()=>o?n.getSchema()[o]:void 0),[o,n]),b=(0,u.yK)((e=>({propertyIcon:{fill:e.lightTextColor,height:"auto",marginRight:4,width:16}})),[]),P=(0,s.useCallback)((()=>t),[t]),T=(0,C.d)();return a()(x.ZP,{popupType:T,alignmentToOrigin:x.vR.End,placementToOrigin:x.pO.Bottom,originGap:0,disabled:p,renderOrigin:e=>s[Ve](B.S,i()({},e,{disabled:p,icon:k?e=>a()(Ae.ZP,{icon:void 0,type:k.type,size:16,theme:g,style:{...e,...b.propertyIcon}}):void 0,variant:m||k?k?"default":"gray":"blue"}),k?s[Ve](s.Fragment,null,a()("div",{style:{[De]:ue.Z[De].medium,...ue.Z[Ie]}},void 0,k.name)):a()(v.FormattedMessage,m?{id:"automations.propertyPicker.buttonPlaceholderAlreadyHaveProperties",[_e]:"Edit another property"}:{id:"automations.propertyPicker.buttonPlaceholder",[_e]:"Edit a property"})),render:e=>{const t=(0,w.U)({device:y,width:280,paddingTop:4});return s[Ve](M.Z,t,a()(Fe.Z,{schema:f,format:S,showRemoveOption:Boolean(l),currentProperty:o,[Be]:P,onAccept:t=>{t&&t!==o?r(t):void 0===t&&(null==l||l(o)),e.close()}}))}})}const Ke=o(85).DTX,Re=o(85).cZW,Le=o(85).X5t,We=o(85).Gm5,Ee=o(85).Hnr,He=o(85)._tz,ze=o(85).Io9,Qe=o(85).D7I,Ge=o(85).Dd5,Ue=o(85).f4X,Ne=o(85).TtP,qe=o(85).UBi,Ye=o(85).BJA,je=o(85).LCr,Je=o(85).BP7,Xe=o(85).wgE,$e=o(85).Drs,et=o(85).JJj,tt=o(85).v1$,ot=o(85).Gpy,nt=o(85).pkR,it=o(85).oWD,rt=o(85).nx5,at=(0,v.defineMessages)({replaceActionLabel:{id:"automations.AutomationActionSetPropertiesSection.replaceAction.label",[rt]:"Replace with"},appendActionLabel:{id:"automations.AutomationActionSetPropertiesSection.appendAction.label",[rt]:"Add"},removeActionLabel:{id:"automations.AutomationActionSetPropertiesSection.removeAction.label",[rt]:"Remove"},titlePlaceholder:{id:"automations.AutomationActionSetPropertiesSection.titlePlaceholder",[rt]:"Untitled"}});function lt(e){window.__c={n:"ButtonAutomationActionSetPropertiesSection"};const{contextStore:t,actionStore:o,[it]:n,[nt]:i,showSetPropertyActions:r}=e,l=(0,c.O7)(),u=(0,d.VK)((()=>o.id),[o.id]),p=(0,d.VK)((()=>{var e;return(null===(e=o.getConfig())||void 0===e?void 0:e[ot])??{}}),[o]),m=(0,d.VK)((()=>{var e;return(null===(e=o.getConfig())||void 0===e?void 0:e[tt])??[]}),[o]),h=(0,s.useMemo)((()=>({[tt]:m,[ot]:p})),[m,p]),g=(0,s.useCallback)((e=>{const t=m.concat([e]),n={...p,[e]:void 0};k[et]({[$e]:"AutomationActionSetPropertiesSection.propertiesChange",[Xe]:l,perform:e=>{st({configStore:o[Je](),[tt]:t,[je]:e,[ot]:n})}})}),[l,m,p,o]),v=(0,s.useCallback)(((e,t)=>{const n=m.indexOf(e);if(-1===n)return;const i=m.slice(0);i[n]=t;const r={...p,[t]:void 0};k[et]({[$e]:"AutomationActionSetPropertiesSection.setProperties",[Xe]:l,perform:e=>{st({configStore:o[Je](),[tt]:i,[je]:e,[ot]:r})}})}),[l,m,p,o]),y=(0,s.useCallback)((e=>{const t=m.filter((t=>t!==e)),n={...p,[e]:void 0};k[et]({[$e]:"AutomationActionSetPropertiesSection.removeProperty",[Xe]:l,perform:e=>{st({configStore:o[Je](),[tt]:t,[je]:e,[ot]:n})}})}),[l,m,p,o]),f=(0,s.useCallback)(((e,t)=>{const n={...p,[e]:t};k[et]({[$e]:"AutomationActionSetPropertiesSection.handleValueChange",[Xe]:l,perform:e=>{st({configStore:o[Je](),[tt]:m,[je]:e,[ot]:n})}})}),[l,m,p,o]);return a()(ct,{contextStore:t,[Ye]:u,config:h,onPropertyAdd:g,onPropertyChange:v,onPropertyRemove:y,onPropertyValueChange:f,[it]:n,showSetPropertyActions:r,[nt]:i})}function st(e){const{configStore:t,[tt]:o,[je]:n,[ot]:i}=e;S.updateValue({store:t,data:{[tt]:o,[ot]:i},[je]:n})}function ct(e){window.__c={n:"AutomationActionSetPropertiesSection"};const{contextStore:t,[Ye]:o,config:n,[it]:i,onPropertyAdd:r,onPropertyChange:l,onPropertyRemove:c,onPropertyValueChange:m,[nt]:h,showSetPropertyActions:g}=e,v=(0,u.yK)((e=>({addPropertyValuePlaceholder:{color:e.mediumTextColor,flexGrow:1,textAlign:"right"},addPropertyRow:{display:"flex",alignItems:"center"}})),[]),y=(0,d.VK)((()=>(0,p.cO)({collectionFormat:i.getFormat(),collectionSchema:i[qe](),sort:!1,sourcePropertyIds:n[tt]})),[i,n[tt]]),f=(0,d.VK)((()=>(0,p.cO)({collectionFormat:i.getFormat(),collectionSchema:i[qe](),filter:e=>{let[t]=e;return!y.includes(t)}})),[i,y]),S=0===f[Ne];return s[Qe](s.Fragment,null,y[Ne]>0&&a()(dt,{availablePropertyIds:f,contextStore:t,[Ye]:o,config:{[tt]:y,[ot]:n[ot]},[it]:i,onPropertyChange:l,onPropertyRemove:c,onPropertyValueChange:m,showSetPropertyActions:g,[nt]:h}),!h&&!S&&a()("div",{style:v.addPropertyRow},void 0,a()(Oe,{availablePropertyIds:f,[Ue]:void 0,[it]:i,contextStore:t,[Ge]:r,[nt]:h,alreadyHaveProperties:y[Ne]>0})))}function dt(e){window.__c={n:"PropertySectionList"};const{availablePropertyIds:t,contextStore:o,[Ye]:n,config:i,[it]:r,onPropertyChange:l,onPropertyRemove:c,onPropertyValueChange:d,showSetPropertyActions:p,[nt]:m}=e,h=(0,s.useRef)(null),g=(0,P.X)(h),v=(0,b.a)(g),y=(0,u.yK)((()=>({wrap:{alignItems:"center",columnGap:4,display:"grid",gridTemplateColumns:v?"100%":"140px 1fr",rowGap:v?4:8},[ze]:{...v?{fontSize:14,marginBlockEnd:16}:{}},lastPropertyValue:{...v?{fontSize:14,marginBlockEnd:0}:{}}})),[v]);return s[Qe]("div",{style:y.wrap,ref:h},i[tt].map(((e,s)=>{const u=s===i[tt][Ne]-1;return a()(ut,{[Ye]:n,availablePropertyIds:t,[it]:r,contextStore:o,[nt]:m,onPropertyChange:l,onPropertyRemove:c,onPropertyValueChange:d,property:e,showSetPropertyActions:p,value:i[ot][e],valueStyle:u?y.lastPropertyValue:y[ze]},e)})))}function ut(e){window.__c={n:"PropertySection"};const{[Ye]:t,availablePropertyIds:o,[it]:n,contextStore:r,[nt]:l,onPropertyChange:c,onPropertyRemove:p,onPropertyValueChange:f,property:S,showSetPropertyActions:k,value:b,valueStyle:w}=e,C={type:"collection",[it]:n,property:S},P=(0,v.useIntl)(),T=(0,u.yK)((e=>({[He]:{},[ze]:{display:"flex",gap:4,minWidth:50,...w}})),[w]),x=(0,s.useMemo)((()=>{if("title"===S)return P.formatMessage(at.titlePlaceholder)}),[P,S]),M=(0,d.VK)((()=>{const e=n[qe]()[S];if(e)return e}),[n,S]),Z=(0,d.VK)((()=>{if(M)return(0,g.qW)({table:y.v,id:n.id,spaceId:n.getSpaceId()},S,M)}),[n,M,S]),A=(0,d.VK)((()=>null==M?void 0:M.type),[M]),F=null==b?void 0:b.value,B=(0,d.VK)((()=>(0,h.o9)(b)),[b]),_=(0,d.VK)((()=>r[We][Ee].getSpaceId()),[r[We][Ee]]),V=(0,d.VK)((()=>r.getContextValuesForAction(t)),[r,t]),I=(0,s.useCallback)((e=>{c(S,e)}),[c,S]),D=(0,s.useCallback)((()=>p(S)),[p,S]),O=(0,s.useCallback)((e=>{f(S,e)}),[f,S]),K=(0,s.useCallback)((e=>{O({[Le]:e,value:F})}),[F,O]),R=(0,s.useCallback)((e=>{O({[Le]:B,value:e})}),[B,O]);if(!Z||!_)return null;const L=function(e){if("email"===e||"phone_number"===e||"url"===e)return{disableEmojiCommands:!0,disableFormattingAndMentions:!0};return{}}(A);return s[Qe](s.Fragment,null,a()("div",{style:T[He]},void 0,a()(Oe,{availablePropertyIds:o,[Ue]:S,contextStore:r,[it]:n,[Ge]:I,[nt]:l,onRemove:D})),a()("div",{style:T[ze]},void 0,k&&M&&m.Y[M.type]&&a()(pt,{[nt]:l,[Ge]:K,value:B}),s[Qe](Ze,i()({},L,{type:Z,value:null==b?void 0:b.value,[Ge]:R,[nt]:l,contextStore:r,[We]:C,[Re]:x,disableMobileActionBar:!0,formulaTypecheckContextValues:V,[Ke]:!0}))))}function pt(e){window.__c={n:"SetPropertyListActionDropdownButton"};const{[nt]:t,[Ge]:o,value:n}=e,r=(0,C.d)();return a()(x.ZP,{popupType:r,alignmentToOrigin:x.vR.End,placementToOrigin:x.pO.Bottom,originGap:0,[nt]:t,renderOrigin:e=>s[Qe](B.S,i()({[nt]:t,variant:"gray"},e),a()(ht,{[Le]:n})),render:e=>a()(mt,{[Ge]:o,parent:e,value:n})})}function mt(e){window.__c={n:"SetPropertyListActionDropdownMenu"};const{value:t,[Ge]:o,parent:n}=e,r=(0,w.F)({width:250}),c=l.compact(h.E2.map(((e,r)=>({key:r,render:o=>s[Qe](T.Z,i()({},o,{[nt]:!1,title:a()(ht,{[Le]:e}),checkState:t===e})),[Le]:()=>{e!==t&&o(e),n.close()}}))));return s[Qe](M.Z,r,a()(Z.Z,{type:Z.i.Vertical,sections:[{key:0,render:e=>s[Qe](A.Z,i()({enableActionSheetTitle:!0},e)),items:c}],initialFocus:0}))}function ht(e){const{[Le]:t}=e;return"replace"===t?s[Qe](v.FormattedMessage,at.replaceActionLabel):"append"===t?s[Qe](v.FormattedMessage,at.appendActionLabel):"remove"===t?s[Qe](v.FormattedMessage,at.removeActionLabel):void(0,f.unreachable)(t)}},68214:(e,t,o)=>{o.d(t,{a:()=>w});var n=o(97464),i=o.n(n),r=o(77094),a=o.n(r),l=o(67294),s=o(81954),c=o(5366),d=o(29502),u=o(61766),p=o(39098),m=o(31945),h=o(76798),g=o(38752),v=o(29758);const y=o(85).D7I,f=o(85).nx5,S=o(85).uKy,k=o(85).FH8,b=o(85).Hnr;function w(e){window.__c={n:"AutomationCollectionPicker"};const{actionStore:t,currentValue:o,contextStore:n,onChange:r,disabled:w,errorMessage:C}=e,P=(0,s.qz)(void 0,u.Z),T=(0,s.VK)((()=>o?p.NW.createChildStore(n.context[b],o):void 0),[o,n.context[b]]),x=(0,s.VK)((()=>{if(T)return{[k]:T[S](),type:k}}),[T]),M=(0,l.useCallback)((e=>{"collection"===e.type&&(r(e[k]),P.reset())}),[r,P]),Z=(0,l.useCallback)((()=>P.reset()),[P]),A=(0,d.d)(),F=(0,g.d)({errorMessage:C,hasValue:Boolean(T)});return a()(m.ZP,{buttonPopupStore:P,popupType:A,alignmentToOrigin:m.vR.End,placementToOrigin:m.pO.Bottom,originGap:0,disabled:w,renderOrigin:e=>l[y](g.S,i()({},F,e,{disabled:w}),T?a()(h.Z,{store:T}):a()(c.FormattedMessage,{id:"automations.databasePicker.buttonPlaceholder",[f]:"Select database"})),render:e=>a()(v.L,{actionId:null==t?void 0:t.id,automationContextStore:n,onChange:M,onClose:Z,selectedTarget:x,skipPages:!0})})}},80117:(e,t,o)=>{o.d(t,{W:()=>I});var n=o(97464),i=o.n(n),r=o(77094),a=o.n(r),l=o(67294),s=o(81954),c=o(76205),d=o(5366),u=o(24457),p=o(29502),m=o(77985),h=o(42917),g=o(31945),v=o(8982),y=o(78140),f=o(72495),S=o(38752);const k=o(85).fBu,b=o(85).QLQ,w=o(85).YDe,C=o(85).ltl,P=o(85).Hnr,T=o(85).zkl,x=o(85).D7I,M=o(85).nx5,Z=o(85).aES,A=o(85).PG2,F=o(85).zVT,B=o(85).pkR,_=o(85).oWD,V=o(85).Dd5;function I(e){var t;window.__c={n:"AutomationCombinatorFilterPopup"};const{contextStore:o,filter:n,[V]:r,noFiltersMessage:s,[_]:u,[B]:m}=e,h=(0,p.d)({[F]:"slideUp"}),v=(null==n||null===(t=n.filters)||void 0===t?void 0:t.length)||0;return a()(g.ZP,{popupType:h,alignmentToOrigin:g.vR.End,placementToOrigin:g.pO.Bottom,originGap:0,[B]:m,renderOrigin:e=>l[x](S.S,i()({[B]:m,variant:"gray"},e,{[A]:t=>{e[A](t),0===v&&r(c.TI)}}),v>0?a()(d.FormattedMessage,{[M]:Z,id:"automations.QueryCollectionAction.filterRuleCount.label",values:{ruleCount:v}}):s),render:e=>a()(D,{contextStore:o,filter:n,[B]:m,[V]:r,onClose:()=>e.close(),[_]:u})})}function D(e){window.__c={n:"AutomationCombinatorFilterMenu"};const{contextStore:t,filter:o,[V]:n,onClose:i,[_]:r}=e,p=(0,s.VK)((()=>r.getSchema()),[r]),g=(0,u.F)({minWidth:300,[F]:"actionSheet"}),S=(0,l.useCallback)(((e,t)=>{n(t)}),[n]),Z=(0,l.useCallback)((()=>{n(void 0),i()}),[n,i]);return l[x](y.Z,g,a()(v.D,{},void 0,a()(m.Pq,{index:0,level:0,[C]:o||c.hh,schema:p,[V]:S,[w]:T,[b]:"test",[k]:t.context[P]})),a()(f.Z,{topBorder:!0},void 0,a()(h.Z,{title:a()(d.FormattedMessage,{[M]:"Delete filter",id:"automations.AutomationCombinatorFilterPopup.deleteFilter.label"}),[A]:Z})))}},38752:(e,t,o)=>{o.d(t,{S:()=>k,d:()=>b});var n=o(97464),i=o.n(n),r=o(77094),a=o.n(r),l=o(67294),s=o(480),c=o(24405),d=o(3909),u=o(82990),p=o(24677),m=o(98104),h=o(89728),g=o(58032);const v=o(85).D7I,y=o(85).Uie,f=o(85).MQM,S=o(85).XNW,k=l.forwardRef(((e,t)=>{window.__c={n:"AutomationDropdownButton"};const{variant:o,onClick:n,style:r,icon:k,children:b,disabled:w}=e,C=(0,s.O7)(),P=(0,c.yK)((e=>{const t={width:12,height:12,[S]:-6};return{button:{..."gray"===o&&{color:e.mediumTextColor},..."blue"===o&&{color:e.blueColor,fontWeight:500},..."error"===o&&{color:e.errorText},maxWidth:"calc(100% + 2px)",[S]:1,padding:"0 8px 0 5px",...r},warningIcon:{...t,[S]:6,fill:e.errorText,color:e.errorText},chevronIcon:{width:10,height:10,[S]:4,marginTop:2,fill:e.lightIconColor},spacer:{flexGrow:1}}}),[o,r]),T=(0,l.useCallback)((e=>{m.clear(C),p.clear(C),null==n||n(e)}),[n,C]);return a()(g.Z,{renderTooltip:()=>"error"===o?e[f]:null,placement:g.Z.Placement.Bottom,disableTooltip:"error"!==o,delayThreshold:0,render:e=>l[v](h.Z,i()({},e,{style:P.button,icon:k,onClick:T,ref:t,shouldShrink:!0,disabled:w,disabledFeedback:w}),a()("div",{style:{...u.Z[y]}},void 0,b),a()("div",{style:P.spacer}),"error"===o&&d.Z.warning(P.warningIcon),d.Z.chevronDown(P.chevronIcon))})}));function b(e){const{[f]:t,hasValue:o}=e;return(0,l.useMemo)((()=>t?{variant:"error",[f]:t}:o?{variant:"gray"}:{variant:"blue"}),[t,o])}},10052:(e,t,o)=>{o.d(t,{b:()=>S,Y:()=>k});var n=o(77094),i=o.n(n),r=o(97464),a=o.n(r),l=o(67294),s=o(480),c=o(81954),d=o(9953),u=o(98104),p=o(12359),m=o(21199),h=o(1743),g=o(74194);const v=o(85).D7I,y=o(85).PpY,f=o(85).Dd5;function S(e){window.__c={n:"AutomationPlainTextInput"};const{value:t,[f]:o,wrapStyle:n,...r}=e,[s,c]=(0,l.useState)(!1);return i()(h.Z,{capture:s},void 0,i()(m.Z,{capture:!0,render:e=>l[v]("div",a()({},e,{style:n}),l[v](g.Z,a()({value:t,[f]:e=>o(e[y].value),onBlur:()=>{c(!1)},onFocus:()=>{u.clearStores(),c(!0)}},r)))}))}function k(e){window.__c={n:"ConnectedAutomationPlainTextInput"};const{store:t,...o}=e,n=(0,s.O7)(),i=(0,c.VK)((()=>t.getValue()??""),[t]),r=(0,l.useCallback)((e=>{p.createAndCommit({userAction:"AutomationPlainTextInput.setValue",environment:n,perform:o=>{d.setValue({store:t,transaction:o,value:e})}})}),[n,t]);return l[v](S,a()({value:i,[f]:r},o))}},29758:(e,t,o)=>{o.d(t,{L:()=>Pe,H:()=>Te});var n=o(77094),i=o.n(n),r=o(97464),a=o.n(r),l=o(96486),s=o.n(l),c=o(67294),d=o(480),u=o(81954),p=o(24405),m=o(84619),h=o(23790),g=o(84116),v=o(58573),y=o(59054),f=o(3909),S=o(5366),k=o(4615),b=o(21202),w=o(6287),C=o(97880),P=o(77162),T=o(31299),x=o(87279),M=o(98742),Z=o(24457),A=o(29798),F=o(39098),B=o(73657),_=o(71846),V=o(52275),I=o(68894),D=o(78140),O=o(32163),K=o(11470),R=o(72495),L=o(58032),W=o(21396),E=o(78948);const H=o(85).uKy,z=o(85).TLr,Q=o(85).VBm,G=o(85).rpY,U=o(85).d73,N=o(85).BKo,q=o(85).d6L,Y=o(85).G_Z,j=o(85).v2u,J=o(85).Ttb,X=o(85).kdC,$=o(85).Yzm,ee=o(85).xYh,te=o(85).FH8,oe=o(85).tZJ,ne=o(85).eFW,ie=o(85).TtP,re=o(85).qC0,ae=o(85).fBu,le=o(85).hzi,se=o(85).d_k,ce=o(85).jmq,de=o(85).Bew,ue=o(85).OWm,pe=o(85).p7T,me=o(85).Hnr,he=o(85).P24,ge=o(85).uzK,ve=o(85).Dd5,ye=o(85).jKg,fe=o(85).D7I,Se=o(85).wgE,ke=o(85).kgm,be=o(85).nx5,we=o(85).A4A,Ce=(0,S.defineMessages)({[we]:{[be]:"Select blocks to editâ¦",id:"automations.AutomationTargetPickerMenu.search.placeholder"}});function Pe(e){window.__c={n:"AutomationTargetPickerMenu"};const t=(0,d.O7)(),o=(0,Z.F)({maxWidth:360,paddingTop:12,width:280}),n=(0,c.useMemo)((()=>(0,k.default)()),[]),i=(0,c.useCallback)((()=>{P[ke]({[Se]:t,eventName:"abandoned_search",sessionId:n,source:_.S.Automation})}),[t,n]);return o.menuType===x.og.Popup&&(o.onClickOutside=i),c[fe](D.Z,o,c[fe](Te,a()({},e,{[ye]:n})))}function Te(e){window.__c={n:"AutomationTargetPickerMenuChildren"};const{actionId:t,automationContextStore:o,[ve]:n,onClose:r,selectedTarget:l,skipCollections:p,skipPages:f,skipVariables:k,[ye]:x}=e,Z=(0,d.O7)(),I=(0,u.qz)(void 0,A.Z),D=(0,u.VK)((()=>{const{context:e}=o;if("button_property"===e.type)return e[he][ge]()}),[o]),X=(0,u.VK)((()=>{if(k||!t)return[];const e=o.getContextValuesForAction(t);if(e){return Object.values(e).filter((e=>(0,h.uy)(e.type,{type:"block"})))}return[]}),[k,o,t],{useDeepEqual:!0}),$=(0,c.useMemo)((()=>o.context[me]),[o.context]),we=(0,u.VK)((()=>$.getSpaceId()),[$]),[Ce,Pe]=(0,c.useReducer)(Ze,{[pe]:[],[ue]:5,[de]:5,[ce]:""});(0,c.useEffect)((()=>{if(Ce[ce]){const e=(0,v.ZP)(Ce[ce],X,(e=>e.kind===g.yp[le]?e.name:""));Pe({type:se,variables:e})}else Pe({type:se,variables:X})}),[Ce[ce],X]);const Te=function(e){const{[ge]:t,limit:o,[ae]:n,[ce]:i,skip:r}=e,a=(0,d.O7)(),[l,s]=(0,c.useReducer)(Ae,{error:void 0,[ee]:Boolean(r),[J]:void 0,total:void 0}),[u]=(0,y.r5)((async()=>{if(r)return;const e=await T.searchCollectionsWithRecents({[ge]:t,[Se]:a,limit:o,[ae]:n,query:i,[j]:!0});return{[J]:e[J],total:e.total}}),[t,a,o,n,i,r],{debounce:T[Y]});return(0,c.useEffect)((()=>{if("pending"===u[q]||"idle"===u[q])s({type:N});else if("resolved"===u[q]){var e,t;s({[J]:null===(e=u.value)||void 0===e?void 0:e[J],total:null===(t=u.value)||void 0===t?void 0:t.total,type:"query_finish"})}else"rejected"===u[q]?s({error:u.error,type:"query_error"}):(0,C.unreachable)(u)}),[u]),l}({[ge]:D,limit:Ce[ue],[ae]:$,[ce]:Ce[ce],skip:p}),Fe=function(e){const{limit:t,[ce]:o,skip:n,spaceId:i}=e,r=(0,d.O7)(),[a,l]=(0,c.useReducer)(Ae,{error:void 0,[ee]:Boolean(n),[J]:void 0,total:void 0}),[s]=(0,y.r5)((async()=>{if(n||!i)return;const e=await T.searchPagesInSpace({[U]:!0,[Se]:r,excludeTemplates:!0,limit:t,query:o,[j]:!1,source:"automation_page_picker",spaceId:i});return{[J]:e[J].map((e=>e.id)),total:e.total}}),[r,t,o,n,i],{debounce:T[Y]});return(0,c.useEffect)((()=>{if("pending"===s[q]||"idle"===s[q])l({type:N});else if("resolved"===s[q]){var e,t;l({[J]:null===(e=s.value)||void 0===e?void 0:e[J],total:null===(t=s.value)||void 0===t?void 0:t.total,type:"query_finish"})}else"rejected"===s[q]?l({error:s.error,type:"query_error"}):(0,C.unreachable)(s)}),[s]),a}({limit:Ce[de],[ce]:Ce[ce],skip:f,spaceId:we}),Be=(0,c.useCallback)((e=>{"collection"===e.type&&P[ke]({[Se]:Z,eventName:re,queryLength:Ce[ce][ie],sessionId:x,source:_.S.Automation,totalResults:Te.total}),l&&!s().isEqual(l,e)?n(e):l?r():n(e)}),[Z,x,Ce[ce],Te.total,l,n,r]),_e=(0,c.useCallback)((e=>{const t=e.target.value;Pe({[ce]:t,type:"set_search_term"}),I.setState({focus:{section:0,indexLocal:0,indexGlobal:0}})}),[I]),Ve=(0,c.useCallback)((()=>{Pe({queryLimit:Ce[ue]+20,type:ne})}),[Ce[ue]]),Ie=(0,c.useCallback)((()=>{Pe({queryLimit:Ce[de]+20,type:oe})}),[Ce[de]]),De="variable"===(null==l?void 0:l.type)?l.id:void 0,Oe="collection"===(null==l?void 0:l.type)?l[te].id:void 0,Ke="page"===(null==l?void 0:l.type)?l.page.id:void 0,Re=[],Le=function(e){const{[pe]:t,onClick:o,selectedVariableId:n}=e,r=t.map((e=>{if(e.kind!==g.yp[le])throw new Error("Not implemented yet.");return{action:()=>o({id:e.id,type:"variable"}),key:e.id,[G]:t=>i()(L.Z,{placement:L.Z.Placement.Right,[G]:o=>c[fe](V.Z,a()({},(0,M.Z)(o,t),{checkState:e.id===n,title:i()("div",{style:{display:"flex"}},void 0,i()(W.F,{value:e,format:m.l.Medium,isSingle:!0,shouldShrink:!0}))})),renderTooltip:()=>e.name,textWrap:!0})}}));if(0===r[ie])return;return{key:"variable_results",items:r,[G]:e=>c[fe](R.Z,a()({},e,{title:i()(S.FormattedMessage,{[be]:"From this automation",id:"automations.AutomationTargetPickerMenu.variablesSection.title"})}))}}({[pe]:Ce[pe],onClick:Be,selectedVariableId:De});Le&&Re.push(Le);const We=function(e){const{collectionQueryResult:t,onCollectionMenuItemClick:o,onShowMoreItemClick:n,[me]:r,selectedCollectionId:l}=e;if(t[ee])return;let s=[];if(t.error)s.push({action:n,key:Q,[G]:e=>c[fe](B.Z,a()({},e,{caption:i()(S.FormattedMessage,{[be]:"Sorry, something went wrong while searching for databases.",id:"automations.AutomationTargetPickerMenu.errorCollections.label"}),shouldWrapCaption:!0}))});else{const e=t[J]??[],i=e[ie];s=e.map((e=>{const t=F.NW[z](r,{table:w.v,id:e});return{action:()=>o({[te]:t[H](),type:te}),key:e,[G]:o=>c[fe](K.Z,a()({},o,{checkState:e===l,store:t}))}}));const d=t.total??0,u=Math.max(0,d-i);u>0&&s.push({action:n,key:Q,[G]:e=>c[fe](Me,a()({},e,{showMoreCount:u}))})}if(0===s[ie])return;return{key:"collection_results",items:s,[G]:e=>c[fe](R.Z,a()({},e,{title:i()(S.FormattedMessage,{[be]:"Databases",id:"automations.AutomationTargetPickerMenu.collectionsSection.title"})}))}}({collectionQueryResult:Te,onCollectionMenuItemClick:Be,onShowMoreItemClick:Ve,[me]:$,selectedCollectionId:Oe});We&&Re.push(We);const Ee=function(e){const{pageQueryResult:t,onPageMenuItemClick:o,onShowMoreItemClick:n,[me]:r,selectedPageId:l}=e;if(t[ee])return;let s=[];if(t.error)s.push({action:n,key:Q,[G]:e=>c[fe](B.Z,a()({},e,{caption:i()(S.FormattedMessage,{[be]:"Sorry, something went wrong while searching for pages.",id:"automations.AutomationTargetPickerMenu.errorPages.label"}),shouldWrapCaption:!0}))});else{const e=t[J]??[],i=e[ie];s=e.map((e=>{const t=F.G[z](r,{table:b.iU,id:e});return{key:e,[G]:o=>c[fe](K.Z,a()({},o,{checkState:e===l,store:t})),action:()=>o({page:t[H](),type:"page"})}}));const d=t.total??0,u=Math.max(0,d-i);u>0&&s.push({action:n,key:"show_more_page_results",[G]:e=>c[fe](Me,a()({},e,{showMoreCount:u}))})}if(0===s[ie])return;return{key:"page_results",items:s,[G]:e=>c[fe](R.Z,a()({},e,{title:i()(S.FormattedMessage,{[be]:"Pages",id:"automations.AutomationTargetPickerMenu.pagesSection.title"})}))}}({onPageMenuItemClick:Be,onShowMoreItemClick:Ie,pageQueryResult:Fe,[me]:$,selectedPageId:Ke});Ee&&Re.push(Ee);const He=Te[ee]||Fe[ee];return c[fe](c.Fragment,null,i()(xe,{[ve]:_e,value:Ce[ce]}),He?i()(R.Z,{},void 0,i()(E.Z,{})):!He&&Re[ie]>0?i()(O.Z,{initialFocus:0,sections:Re,store:I,type:O.i.Vertical}):i()(B.Z,{caption:i()(S.FormattedMessage,{[be]:"No results",id:"automations.AutomationTargetPickerMenu.noResults.label"})}))}function xe(e){window.__c={n:"SearchInputSection"};const{[ve]:t,value:o}=e,{isMobile:n}=(0,d.Fy)(),r=(0,S.useIntl)(),a=(0,p.yK)((()=>({section:{paddingBlockStart:0}})),[]);return i()(R.Z,{style:a.section},void 0,i()(I.ZP,{focusInitial:!n||void 0,[ve]:t,placeholder:r[$](Ce[we]),[X]:!0,value:o??""}))}const Me=(0,c.forwardRef)((function(e,t){window.__c={n:"ShowMoreButtonMenuItem"};const{showMoreCount:o}=e,n=(0,p.yK)((e=>({showMoreButton:{color:e.mediumTextColor,fill:e.mediumIconColor}})),[]);return c[fe](V.Z,a()({},e,{icon:f.Z.dots({width:16,height:16}),ref:t,style:n.showMoreButton,title:i()(S.FormattedMessage,{[be]:"Show {showMore} more",id:"automations.AutomationTargetPickerMenu.showMore.label",values:{showMore:Math.min(o,20)}})}))}));function Ze(e,t){if("set_variables"===t.type)return{...e,[pe]:t.variables.slice(0)};if("set_search_term"===t.type){const o=t[ce]?20:5;return{...e,[ue]:o,[de]:o,[ce]:t[ce]}}if("set_collection_query_limit"===t.type){if(e[ue]!==t.queryLimit)return{...e,[ue]:t.queryLimit}}else if("set_page_query_limit"===t.type){if(e[de]!==t.queryLimit)return{...e,[de]:t.queryLimit}}else(0,C.unreachable)(t);return e}function Ae(e,t){if("query_loadstart"===t.type){if(!e[ee])return{...e,[ee]:!0}}else{if("query_finish"===t.type)return{...e,error:void 0,[ee]:!1,[J]:t[J],total:t.total};if("query_error"===t.type)return{...e,error:t.error,[ee]:!1,[J]:void 0,total:void 0};(0,C.unreachable)(t)}return e}},54119:(e,t,o)=>{o.d(t,{Z:()=>S});var n=o(77094),i=o.n(n),r=(o(67294),o(480)),a=o(81954),l=o(24405),s=o(5366),c=o(99417),d=o(79315),u=o(96026),p=o(90403);const m=o(85).nx5,h=o(85).ewQ,g=o(85).Wmz,v=o(85).$bT,y=o(85).rOg,f=o(85).tDk;function S(e){window.__c={n:"AiBadge"};const t=(0,l.Fg)(),o=(0,r.O7)();return(0,a.VK)((()=>{const e=d.default.state[f],t=e&&u.Z.getMode(o,e);return(0,c.GD)(o,t)}),[o])?i()(p.Z,{style:{fontSize:11,fontWeight:500,padding:"1px 4px",borderRadius:4,display:y,[v]:"row",alignItems:"center",gap:4,background:"light"===t.mode?t[h][g][50]:t[h][g][200],color:"light"===t.mode?t[h][g][500]:t[h][g][700],...e.style},content:i()(s.FormattedMessage,{id:"aiBadgeComponent.label",[m]:"AI"})}):null}},72865:(e,t,o)=>{var n;o.d(t,{D:()=>M});var i=o(77094),r=o.n(i),a=o(97464),l=o.n(a),s=o(67294),c=o(480),d=o(24405),u=o(993),p=o(12359),m=o(43250),h=o(17809),g=o(24666),v=o(65187);const y=o(85).D7I,f=o(85).MHP,S=o(85).EHj,k=o(85).lp0,b=o(85).$Lq,w=o(85).sUt,C=o(85).XQm,P=o(85).DTX,T=o(85).XuB,x=o(85).cZW;function M(e){window.__c={n:"SimpleFormulaValueTextInput"};const{value:t,disabled:i,onChange:a,multiline:M,[x]:Z,disableFormattingAndMentions:A,disableMobileActionBar:F,[T]:B,[P]:_}=e,V=(0,c.O7)(),I=(0,d.yK)((e=>({wrap:{flexGrow:1,flexShrink:1,boxShadow:e.inputBoxShadow,borderRadius:4,padding:M?"6px 10px":"4px 8px",overflow:"hidden",..."dark"===e.mode?{backgroundColor:e.inputBackground}:{}},text:M?{minHeight:60}:{whiteSpace:"pre"},[x]:M?{minHeight:60}:{}})),[M]),D=(0,s.useCallback)((e=>{a({type:"simple",value:e})}),[a]),{store:O}=(0,h.useMockTextStore)({initialValue:null==t?void 0:t.value,onChange:D}),K=(0,s.useMemo)((()=>M?()=>{const e=g.default.state;"editing"===e.mode&&p.createAndCommit({userAction:"SimpleFormulaValueTextInput.handleEnter",environment:V,perform:t=>{u.insertString({environment:V,string:"\n",[C]:e[C],[w]:!0,[b]:!0,[k]:!0,[S]:!0,[T]:!0,transaction:t})}})}:void 0),[V,M]);return r()("div",{style:I.wrap,className:m.focusableWithin},void 0,(n||(n=o.t(s,2)))[y](v.Z,l()({[x]:Z,disabled:i,store:O,style:I.text,placeholderStyle:I[x],pasteBehavior:"inline",[S]:!0,disableEmbedMenu:!0,[T]:B,disableComment:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,onEnter:K,disableMobileActionBar:F,[P]:_},A?{[b]:!0,[k]:!0,[w]:!0,[f]:!0}:{})))}},55950:(e,t,o)=>{o.d(t,{a:()=>Et,K:()=>D});var n=o(77094),i=o.n(n),r=o(97464),a=o.n(r),l=o(67294),s=o.t(l,2),c=o(480),d=o(81954),u=o(66897),p=o(99036),m=o(80951),h=o(84619),g=o(78106),v=o(76218),y=o(68626),f=o(19889),S=o(70203),k=o(97880),b=o(12508),w=o(92864),C=o(89845),P=o(69265),T=o(22084),x=o(21396),M=o(75311);const Z=o(85).g7N,A=o(85).D7I,F=o(85).dLQ,B=o(85).Hnr,_=o(85).nSw,V=o(85).$Qz,I=o(85).Gm5;function D(e){window.__c={n:"ValuePickerMenuToken"};const{token:t,contextStore:o,disabled:n,setCurrentTokens:r,currentSimpleFormulaValueTokens:s,[I]:D}=e,O=(0,c.Fy)(),K=(0,d.Kw)(o[V]),R=(0,d.VK)((()=>{if((0,v.S3)(t)&&(0,S.isUserAnnotation)(t)){const e=(0,S.getUserAnnotationData)(t);if(e)return(0,u.Hl)({pointer:{table:f.KJ,id:e},[_]:o[I][B][_]})}}),[o[I][B],t]),L=(0,d.VK)((()=>(0,M._)(D)),[D]),W=(0,d.VK)((()=>D.collectionStore.getSchema()[D.property]),[D]);if("string"==typeof t){if(!W||!(0,p.isOptionsPropertySchema)(W))return null;const e=(0,m.matchSelectOption)((null==W?void 0:W.options)??[],t);if(!e)return null;const o={value:e.value,color:e.color,isSingle:!1,showRemoveButton:!n,format:O[F]?h.l.Medium:h.l.Small,onClickRemove:()=>{null==r||r((0,v.Ck)(s,t))}};if((0,p.isStatusPropertySchema)(W)){var E,H;const t=null===(E=W.groups)||void 0===E||null===(H=E.find((t=>{var o;return null===(o=t.optionIds)||void 0===o?void 0:o.includes(e.id)})))||void 0===H?void 0:H.color;return l[A](T.F,a()({},o,{groupColor:t}))}return l[A](T.a,o)}if("boolean"==typeof t)return i()(b.Z,{checked:t,disabled:!0,size:16,checkSize:12,style:{[Z]:6}},t.toString());if((0,S.isUserAnnotation)(t))return null!=R&&R.asActor?i()(w.ZP,{actor:R,format:O[F]?w.ZP.Format.Medium:w.ZP.Format.Small,showRemoveButton:!n,onClickRemove:()=>{null==r||r((0,v.Ck)(s,t))},shouldShrink:!0,isSingle:!1},R.id):null;if((0,S.isFormulaContextValueMentionAnnotation)(t)){const e=(0,S.getFormulaContextValueAnnotationData)(t).id,o=y.x.isSuccess(K)?(0,g.vx)(K.value.valueTypes,e):void 0;return o?i()(x.F,{value:o,format:h.l.Small,isSingle:!1,shouldShrink:!0,showRemoveButton:!n,onClickRemove:()=>{null==r||r((0,v.Ck)(s,t))}}):null}if((0,S.isDateAnnotation)(t)){const e=s[0],t=e&&(0,v.S3)(e)&&(0,S.isDateAnnotation)(e)?(0,S.getDateAnnotationData)(e):void 0;return t?i()(C.Z,{value:t,dateFormat:L.dateFormat,timeFormat:L.timeFormat,style:{[Z]:6}}):null}if((0,S.isPageAnnotation)(t)){const e=(0,S.getPageAnnotationData)(t);return e?i()(P.Z,{format:O[F]?h.l.Medium:h.l.Small,blockId:e,shouldWrap:!1,shouldShrink:!0,isSingle:!1,parentStore:o[I][B],showRemoveButton:!n,onClickRemove:()=>{null==r||r((0,v.Ck)(s,t))}},e):null}(0,k.unreachable)(t)}var O=o(96486),K=o.n(O),R=o(23790),L=o(84116),W=o(58573),E=o(59054),H=o(5366),z=o(31299),Q=o(17809),G=o(87279),U=o(29798),N=o(78140),q=o(32163),Y=o(43765),j=o(40721),J=o(72495),X=o(78948),$=o(47082),ee=o(30387),te=o(3909),oe=o(24405),ne=o(52275);const ie=o(85).Q9F,re=o(85).Hco;function ae(e){window.__c={n:"IconMenuItem"};const t=(0,oe.yK)((e=>({icon:{width:14,fill:e[re]},[ie]:{width:12,fill:e[re]}})),[]);return i()(ne.Z,{icon:e.icon(t.icon),title:e.title,focused:!1,right:te.Z[ie](t[ie]),onClick:e.onClick})}const le=o(85).D7I;function se(e){window.__c={n:"CustomFormulaItem"};const{value:t,onChange:o}=e,n=(0,l.useCallback)((()=>{o({type:"formula",value:null==t?void 0:t.value})}),[t,o]);return i()(ae,{icon:te.Z.typesFormula,title:l[le](H.FormattedMessage,ee.s.customFormula),onClick:n})}var ce=o(21202),de=o(39098),ue=o(11470),pe=o(58032);const me=o(85).Joh,he=o(85).ESK,ge=o(85).D7I,ve=o(85).$wW,ye=o(85).urI,fe=o(85).UA5,Se=o(85).dLQ,ke=o(85).$Qz,be=o(85).nSw,we=o(85).Hnr,Ce=o(85).Gm5;function Pe(e){window.__c={n:"ValuePickerMenuItem"};const{token:t,contextStore:o,args:n,checkState:r,checkType:l,[Ce]:C,onCheckboxClick:P}=e,M=(0,c.Fy)(),Z=(0,d.VK)((()=>o[Ce][we].getSpaceId()),[o[Ce][we]]),A=(0,d.VK)((()=>{if((0,v.S3)(t)&&(0,S.isUserAnnotation)(t)){const e=(0,S.getUserAnnotationData)(t);if(e)return(0,u.Hl)({pointer:{table:f.KJ,id:e},[be]:o[Ce][we][be]})}}),[o[Ce][we],t]),F=(0,d.VK)((()=>C.collectionStore.getSchema()[C.property]),[C]),B=(0,d.VK)((()=>F&&(0,p.isOptionsPropertySchema)(F)?F.options??[]:[]),[F]),_=(0,d.VK)((()=>F&&(0,p.isStatusPropertySchema)(F)?F.groups??[]:[]),[F]),V=(0,d.Kw)(o[ke]),I=Boolean(F&&(0,p.isStatusPropertySchema)(F)),D="single"===l?{checkState:r}:{icon:i()(b.Z,{checked:r,size:14,onClick:P})};if("string"==typeof t){if(I){const e=(0,m.matchSelectOption)(B,t),o=_.find((t=>{var o;return e&&(null===(o=t.optionIds)||void 0===o?void 0:o.includes(e.id))}));return e?s[ge](ne.Z,a()({},n,D,{title:i()(T.F,{[ye]:M[Se]?h.l.Large:h.l.Small,[ve]:!0,value:e.value,[fe]:e[fe],groupColor:null==o?void 0:o[fe],shouldShrink:!0,showRemoveButton:!1},t),isTokenTitle:!0},n)):null}{const e=(0,m.matchSelectOption)(B,t);return e?s[ge](ne.Z,a()({},n,D,{title:i()(T.a,{value:e.value,[fe]:e[fe],showRemoveButton:!1,[ve]:!0,shouldShrink:!0,[ye]:M[Se]?h.l.Large:h.l.Small}),isTokenTitle:!0},n)):null}}if("boolean"==typeof t)return null;if((0,S.isUserAnnotation)(t))return null!=A&&A.asActor&&A.table===f.KJ?s[ge](ne.Z,a()({},n,D,{title:i()(w.vw,{[ve]:!0,shouldShrink:!0,[ye]:M[Se]?w.vw.Format.Large:w.vw.Format.Medium,userValue:A.asActor}),isTokenTitle:!0})):null;if((0,S.isFormulaContextValueMentionAnnotation)(t)){const e=(0,S.getFormulaContextValueAnnotationData)(t).id,o=y.x.isSuccess(V)?(0,g.vx)(V.value.valueTypes,e):void 0;return o?s[ge](ne.Z,a()({},D,{title:i()(pe.Z,{[me]:()=>(0,x.e)(o),placement:pe.Z[he].Right,render:e=>s[ge]("div",a()({style:{display:"flex"}},e),i()(x.F,{value:o,[ye]:h.l.Medium,[ve]:!0,shouldShrink:!0}))})},n)):null}if((0,S.isDateAnnotation)(t))return null;if((0,S.isPageAnnotation)(t)){const e=(0,S.getPageAnnotationData)(t);if(!e)return null;if(!Z)return null;const i=de.G.createChildStore(o[Ce][we],{table:ce.iU,id:e,spaceId:Z});return s[ge](ue.Z,a()({store:i,checkState:r,hidePath:!0},n))}(0,k.unreachable)(t)}function Te(e){const{currentSimpleFormulaValueTokens:t,value:o,contextStore:n,setCurrentTokens:r,action:a,context:l,checkType:s,onCheckboxClick:c}=e;if(o.kind!==L.yp.ContextValue)throw new Error("Not implemented yet.");const d=Boolean(t.find((e=>(0,v.S3)(e)&&(0,S.isFormulaContextValueMentionAnnotation)(e)&&(0,S.getFormulaContextValueAnnotationData)(e).id===o.id))),u=(0,S.createFormulaContextValueMentionAnnotation)({id:o.id}),p=()=>{r("append"===a?d?(0,v.Ck)(t,u):[...t,u]:[u]),null==c||c()};return{key:o.id,render:e=>i()(Pe,{token:u,contextStore:n,args:e,checkState:d,checkType:s,context:l,onCheckboxClick:p}),action:p}}const xe=o(85).JoB,Me=o(85).D7I,Ze=o(85)._V5,Ae=o(85).Mm1,Fe=o(85).TtP,Be=o(85).Yzm,_e=o(85).dLQ,Ve=o(85).G_Z,Ie=o(85).d73,De=o(85).uJ5,Oe=o(85).EpK,Ke=o(85).FH8,Re=o(85).kdC;function Le(e){var t,o;window.__c={n:"ValuePickerMenuBlockArray"};const{currentSimpleFormulaValueTokens:n,menuProps:r,onClose:s,onChange:u,contextStore:m,formulaTypecheckContextValues:h,context:g,[Re]:y,showInputMenuItem:f,type:k}=e,b=(0,c.Fy)(),w=(0,H.useIntl)(),C=(0,c.O7)(),[P,T]=(0,l.useState)(""),x=(0,d.qz)(void 0,U.Z),{collectionStore:Z,property:A}=g,F=(0,M.M)(Z,A),B=F(n,"first"),_=(0,d.VK)((()=>Z.getSchema()[g.property]),[Z,g.property]),V=(0,d.VK)((()=>!(!_||!(0,p.isPropertySchemaWithLimit)(_))&&1===_.limit),[_]),I=(0,l.useMemo)((()=>{const e="relation"===(null==_?void 0:_.type)?(0,p.getRelationPropertyCollectionPointer)(_):void 0;return h.filter((t=>(0,R.uy)(t.type,{type:"block",[Ke]:e},!0)))}),[h,_]),[O]=(0,E.r5)((async()=>{const e=P?(0,W.ZP)(P,I,(e=>e.kind===L.yp.ContextValue?e.name:"")):I,{results:t}=await z.searchPagesInCollection({environment:C,query:P,collectionId:k[Ke].id,limit:20,spaceId:k[Ke].spaceId,excludeTemplates:!0,source:Oe,[De]:!1,[Ie]:!1});return{valueResults:e,pageResults:t}}),[C,P,I,k],{debounce:z[Ve]}),te=(0,l.useCallback)((()=>{T(""),x.setState({...x.state,focus:{section:0,indexLocal:0,indexGlobal:0}})}),[x]),oe=(0,l.useCallback)((e=>{const t=F(e,"last");u({type:"simple",value:(0,v.iC)(t)}),te()}),[u,te,F]),ne=(0,d.VK)((()=>(0,Q.formulaButtonsEnabled)()),[]),ie=K().compact(B.map(((e,t)=>i()(D,{token:e,contextStore:m,disabled:!1,currentSimpleFormulaValueTokens:B,setCurrentTokens:oe,context:g},t)))),re=i()($.Z,{focus:!b[_e]||void 0,focusAfterAnimation:!0,format:$.Z.Format.FilterValue,tokens:ie,placeholder:w[Be](ee.s.pageSearchPlaceholder),onRemoveLastToken:()=>{oe(B.slice(0,B[Fe]-1))},onClearButtonClick:()=>{oe([])},value:P,onChange:e=>{T(e.target.value)},dontShowBorderBottom:b.isAndroid,[Re]:y}),ae=void 0!==(null==r?void 0:r.header)?r.header:i()(J.Z,{style:{[Ae]:0},title:w[Be](ee.s.genericMenuHeader)});let le;le=b[_e]?{menuType:G.og.Modal,right:i()(j.DoneMenuText,{}),onClickRight:s}:{menuType:G.og.Popup,maxHeight:"50vh",width:260,[Ze]:0,footer:ne&&i()(J.Z,{topBorder:!0},void 0,l[Me](se,e)),disableHeaderBorder:!0};const ce={...le,...r,header:b[_e]?null:ae},de=V?"single":"multi",ue=[],pe=[...K().compact(((null===(t=O.value)||void 0===t?void 0:t.valueResults)||[]).map((e=>Te({currentSimpleFormulaValueTokens:B,value:e,setCurrentTokens:oe,contextStore:m,action:"append",context:g,checkType:de})))),...K().compact(((null===(o=O.value)||void 0===o?void 0:o.pageResults)||[]).map((e=>{const t=Boolean(B.find((t=>(0,v.S3)(t)&&(0,S.isPageAnnotation)(t)&&(0,S.getPageAnnotationData)(t)===e))),o=(0,S.createPageAnnotation)(e,k[Ke].spaceId),n=()=>{oe(t?(0,v.Ck)(B,o):[...B,o])};return{key:e,render:e=>i()(Pe,{token:o,contextStore:m,args:e,checkState:t,checkType:de,context:g,onCheckboxClick:n}),action:n}})))];if(f){const e=Boolean(ae);ue.push({key:"search-input",render:t=>l[Me](J.Z,a()({},t,{style:{...e&&{[Ze]:0}}})),items:[{action:()=>{},key:"input",render:()=>re}]})}if(pe[Fe]>0){const e=Boolean(ae)||f;ue.push({key:"values",render:t=>l[Me](J.Z,a()({topBorder:e},t)),items:pe})}return l[Me](N.Z,ce,O.error&&i()(J.Z,{},void 0,i()(Y.Z,{title:l[Me](H.FormattedMessage,ee.s[xe])})),0===ue[Fe]&&O.value&&i()(J.Z,{},void 0,i()(Y.Z,{title:l[Me](H.FormattedMessage,ee.s.noResults)})),!O.value&&!O.error&&i()(J.Z,{},void 0,i()(X.Z,{})),ue[Fe]>0&&i()(q.Z,{type:q.i.Vertical,initialFocus:0,sections:ue,store:x}))}const We=o(85).Yzm,Ee=o(85).Mm1,He=o(85).D7I,ze=o(85).r2Q;function Qe(e){window.__c={n:"ValuePickerMenuCheckbox"};const{context:t,contextStore:o,currentSimpleFormulaValueTokens:n,formulaTypecheckContextValues:r,menuProps:s,onChange:u,onClose:p}=e,m=(0,H.useIntl)(),h=(0,c.Fy)(),g=r.filter((e=>"checkbox"===e.type.type)),y=(0,l.useCallback)((e=>{u({type:"simple",value:void 0!==e[0]?(0,v.YD)(e[0]):void 0})}),[u]),f=(0,l.useCallback)((e=>{y(e),p()}),[y,p]),S=(0,d.VK)((()=>(0,Q.formulaButtonsEnabled)()),[]),k=K().compact(g.map((e=>Te({currentSimpleFormulaValueTokens:n,value:e,setCurrentTokens:f,contextStore:o,action:"replace",context:t,checkType:"single"})))),b=[],w=n.some((e=>!0===e)),C=[...k,...[{key:0,render:e=>l[He](ne.Z,a()({title:l[He](H.FormattedMessage,ee.s[ze]),checkState:!w},e)),action:()=>{f([!1])}},{key:1,render:e=>l[He](ne.Z,a()({title:l[He](H.FormattedMessage,ee.s.checked),checkState:w},e)),action:()=>{f([!0])}}]],P=void 0!==(null==s?void 0:s.header)?s.header:i()(J.Z,{style:{[Ee]:0},title:m[We](ee.s.genericMenuHeader)}),T=Boolean(P);let x;b.push({key:"checkbox",render:e=>l[He](J.Z,a()({},e,{topBorder:T})),items:C}),x=h.isMobile?{menuType:G.og.Modal,right:i()(j.DoneMenuText,{}),onClickRight:p}:{header:P,menuType:G.og.Popup,maxHeight:"50vh",width:260,footer:S&&i()(J.Z,{topBorder:!0},void 0,l[He](se,e)),disableHeaderBorder:!0};const M={...x,...s,header:h.isMobile?null:P};return l[He](N.Z,M,i()(q.Z,{type:q.i.Vertical,initialFocus:0,sections:b}))}var Ge=o(28020),Ue=o(77907),Ne=o(73063),qe=o(89728);const Ye=o(85).mEV,je=o(85).Uk6,Je=o(85).D7I,Xe=o(85).bey,$e=o(85).PG2,et=o(85).Yzm,tt=o(85).qpZ;function ot(e){window.__c={n:"ValueDatePicker"};const{currentSimpleFormulaValueTokens:t,disabled:o,setInDatePicker:n,onClose:r,setCurrentTokens:a,context:s}=e,c=t[0],u=c&&(0,v.S3)(c)&&(0,S.isDateAnnotation)(c)?(0,S.getDateAnnotationData)(c):void 0,p=(0,H.useIntl)(),m=(0,d.Kw)(Ge.userSettingsStartOfWeekStore),h=(0,l.useCallback)((()=>{n(!1)}),[n]),g=(0,l.useCallback)((e=>{a(e?[(0,S.createDateAnnotation)(e)]:[])}),[a]),y=(0,oe.yK)((e=>({[tt]:{display:"flex",alignItems:"center",fontSize:12,paddingInline:14,color:e.mediumTextColor,marginTop:8,fontWeight:500},iconWrap:{width:18,height:18,marginRight:4},icon:{width:12,height:12},title:{flex:"1 1 auto"}})),[]),f=(0,d.VK)((()=>(0,M._)(s)),[s]);return i()(Ue.DependencyConsumer,{dependency:Ue.deps.menus},void 0,(e=>{let{DatePropertyMenu:t}=e;return i()(t,{firstDayOfWeek:m,value:u,[je]:!1,[Ye]:g,dateFormat:f.dateFormat,timeFormat:f.timeFormat,onDismiss:r,disabled:o,shouldShowReminder:!1,[tt]:i()("div",{style:y[tt]},void 0,i()(Ne.Z,{ariaLabel:p[et](ee.s.back),icon:te.Z.historyBack,[$e]:h,style:y.iconWrap,[Xe]:y.icon}),i()("span",{style:y.title},void 0,l[Je](H.FormattedMessage,ee.s.pickADate)),i()(qe.Z,{[$e]:r,isBlue:!0},void 0,i()(j.DoneMenuText,{})))})}))}const nt=o(85).PG2,it=o(85).Yzm,rt=o(85).Mm1,at=o(85).D7I;function lt(e){window.__c={n:"ValuePickerMenuDate"};const{currentSimpleFormulaValueTokens:t,onClose:o,onChange:n,contextStore:r,formulaTypecheckContextValues:s,context:u,menuProps:p}=e,m=(0,H.useIntl)(),h=(0,c.Fy)(),[g,y]=(0,l.useState)(!1),f=s.filter((e=>"date"===e.type.type)),S=(0,l.useCallback)((e=>{n({type:"simple",value:void 0!==e[0]?(0,v.YD)(e[0]):void 0})}),[n]),k=(0,l.useCallback)((e=>{S(e),o()}),[S,o]),b=(0,l.useCallback)((()=>{y(!0)}),[]),w=(0,l.useCallback)((()=>{S([]),o()}),[S,o]),C=(0,d.VK)((()=>(0,Q.formulaButtonsEnabled)()),[]);if(g)return l[at](ot,a()({},e,{setInDatePicker:y,setCurrentTokens:S,currentSimpleFormulaValueTokens:t}));const P=void 0!==(null==p?void 0:p.header)?p.header:i()(J.Z,{style:{[rt]:0},title:m[it](ee.s.genericMenuHeader)}),T=K().compact(f.map((e=>Te({currentSimpleFormulaValueTokens:t,value:e,setCurrentTokens:k,contextStore:r,action:"replace",context:u,checkType:"single"})))),x=[];if(T.length>0){const e=Boolean(P);x.push({key:"values",render:t=>l[at](J.Z,a()({topBorder:e},t)),items:T})}const M=l[at](l.Fragment,null,i()(J.Z,{topBorder:!0},void 0,i()(ae,{icon:te.Z.typesDate,title:l[at](H.FormattedMessage,ee.s.pickADate),[nt]:b}),C&&l[at](se,e)),t.length>0&&i()(J.Z,{topBorder:!0},void 0,i()(ne.Z,{title:l[at](H.FormattedMessage,ee.s.clear),focused:!1,[nt]:w})));let Z;Z=h.isMobile?{menuType:G.og.Modal,right:i()(j.DoneMenuText,{}),onClickRight:o,footer:M}:{menuType:G.og.Popup,maxHeight:"50vh",width:260,footer:M,disableHeaderBorder:!0};const A={...Z,...p,header:h.isMobile?null:P};return l[at](N.Z,A,i()(q.Z,{type:q.i.Vertical,initialFocus:0,sections:x}))}var st=o(68894);const ct=o(85).Yzm,dt=o(85).Mm1,ut=o(85).D7I;function pt(e){window.__c={n:"ValuePickerMenuNumber"};const{context:t,contextStore:o,currentSimpleFormulaValueTokens:n,formulaTypecheckContextValues:r,menuProps:s,onChange:u,onClose:p,value:m}=e,h=(0,H.useIntl)(),g=(0,c.Fy)(),y=r.filter((e=>"number"===e.type.type)),f=(0,l.useCallback)((e=>{u({type:"simple",value:e})}),[u]),k=(0,l.useCallback)((e=>{f(e),p()}),[f,p]),b=(0,l.useCallback)((e=>{const t=e.target.value;let o;o=""===t?void 0:[[t]],f(o)}),[f]),w=(0,l.useCallback)((e=>{const t=K().get(e,"event.target.value");let o;o="string"==typeof t&&""!==t?[[t]]:void 0,k(o)}),[k]),C=(0,l.useCallback)((e=>{const t=void 0!==e[0]?(0,v.YD)(e[0]):void 0;k(t)}),[k]),P=(0,d.VK)((()=>(0,Q.formulaButtonsEnabled)()),[]),T=[],x=[...[{action:w,key:"input",render:e=>{const t=n[0],o="string"==typeof t?t:(0,S.getText)(null==m?void 0:m.value);return l[ut](st.ZP,a()({},e,{focus:!0,onChange:b,onClick:void 0,value:o}))}}],...K().compact(y.map((e=>Te({currentSimpleFormulaValueTokens:n,value:e,setCurrentTokens:C,contextStore:o,action:"replace",context:t,checkType:"single"}))))],M=void 0!==(null==s?void 0:s.header)?s.header:i()(J.Z,{style:{[dt]:0},title:h[ct](ee.s.genericMenuHeader)});let Z;T.push({key:"textbox",render:e=>l[ut](J.Z,e),items:x}),Z=g.isMobile?{menuType:G.og.Modal,right:i()(j.DoneMenuText,{}),onClickRight:p}:{menuType:G.og.Popup,maxHeight:"50vh",width:260,footer:P&&i()(J.Z,{topBorder:!0},void 0,l[ut](se,e)),disableHeaderBorder:!0};const A={...Z,...s,header:g.isMobile?null:M};return l[ut](N.Z,A,i()(q.Z,{initialFocus:0,sections:T,type:q.i.Vertical}))}var mt=o(1302);const ht=o(85).JoB,gt=o(85).ZG6,vt=o(85).D7I,yt=o(85).Mm1,ft=o(85).TtP,St=o(85).Yzm,kt=o(85).dLQ,bt=o(85).G_Z,wt=o(85).kdC;function Ct(e){var t,o;window.__c={n:"ValuePickerMenuPersonArray"};const{context:n,contextStore:r,currentSimpleFormulaValueTokens:s,formulaTypecheckContextValues:u,menuProps:m,onChange:h,onClose:g,[wt]:y,showInputMenuItem:f}=e,k=(0,c.Fy)(),b=(0,H.useIntl)(),w=(0,c.O7)(),{collectionStore:C,property:P}=n,[T,x]=(0,l.useState)(""),Z=(0,d.qz)(void 0,U.Z),A=(0,M.M)(C,P),F=A(s,"first"),B=(0,d.VK)((()=>{const e=C.getSchema()[n.property];return!(!e||!(0,p.isPropertySchemaWithLimit)(e))&&1===e.limit}),[C,n]),_=u.filter((e=>(0,R.uy)(e.type,{type:"person"}))),[V]=(0,E.r5)((async()=>({valueResults:T?(0,W.ZP)(T,_,(e=>e.kind===L.yp.ContextValue?e.name:"")):_,userResults:(await z.searchVisibleSpaceUsers({environment:w,query:T,membersOnly:!1})).map((e=>e.id)).slice(0,20)})),[w,T,_],{debounce:z[bt]}),I=(0,l.useCallback)((()=>{x(""),Z.setState({...Z.state,focus:{section:0,indexLocal:0,indexGlobal:0}})}),[Z]),O=(0,l.useCallback)((e=>{const t=A(e,"last");h({type:"simple",value:(0,v.iC)(t)}),I()}),[h,I,A]),te=(0,d.VK)((()=>(0,Q.formulaButtonsEnabled)()),[]),oe=K().compact(F.map(((e,t)=>i()(D,{token:e,contextStore:r,disabled:!1,currentSimpleFormulaValueTokens:F,setCurrentTokens:O,context:n},t)))),ne=i()($.Z,{focus:!k[kt]||void 0,focusAfterAnimation:!0,format:$.Z.Format.FilterValue,tokens:oe,placeholder:b[St](ee.s.personSearchPlaceholder),onRemoveLastToken:()=>{O(F.slice(0,F[ft]-1))},onClearButtonClick:()=>{O([])},value:T,onChange:e=>{x(e.target.value)},dontShowBorderBottom:k.isAndroid,[wt]:y}),ie=void 0!==(null==m?void 0:m.header)?m.header:i()(J.Z,{style:{[yt]:0},title:b[St](ee.s.genericMenuHeader)});let re;re=k[kt]?{menuType:G.og.Modal,right:i()(j.DoneMenuText,{}),onClickRight:g}:{menuType:G.og.Popup,maxHeight:"50vh",width:260,footer:te&&i()(J.Z,{topBorder:!0},void 0,l[vt](se,e)),disableHeaderBorder:!0};const ae={...re,...m,header:k[kt]?null:ie},le=B?"single":"multi",ce=[...K().compact(((null===(t=V.value)||void 0===t?void 0:t.valueResults)||[]).map((e=>Te({currentSimpleFormulaValueTokens:F,value:e,setCurrentTokens:O,contextStore:r,action:"append",context:n,checkType:le,onCheckboxClick:()=>{B&&mt.default[gt]((()=>{g()}))}})))),...K().compact(((null===(o=V.value)||void 0===o?void 0:o.userResults)||[]).map((e=>{const t=Boolean(F.find((t=>(0,v.S3)(t)&&(0,S.isUserAnnotation)(t)&&(0,S.getUserAnnotationData)(t)===e))),o=(0,S.createUserAnnotation)(e),a=()=>{O(t?(0,v.Ck)(F,o):[...F,o]),B&&mt.default[gt]((()=>{g()}))};return{key:e,render:e=>i()(Pe,{token:o,contextStore:r,args:e,checkState:t,checkType:le,context:n,onCheckboxClick:a}),action:a}})))],de=[];if(f){const e=Boolean(ie);de.push({key:"search-input",render:t=>l[vt](J.Z,a()({},t,{style:{...e&&{paddingTop:0}}})),items:[{action:()=>{},key:"input",render:()=>ne}]})}if(ce[ft]>0){const e=Boolean(ie)||f;de.push({key:"users",render:t=>l[vt](J.Z,a()({topBorder:e},t)),items:ce})}return l[vt](N.Z,ae,V.error&&i()(J.Z,{},void 0,i()(Y.Z,{title:l[vt](H.FormattedMessage,ee.s[ht])})),0===de[ft]&&V.value&&i()(J.Z,{},void 0,i()(Y.Z,{title:l[vt](H.FormattedMessage,ee.s.noResults)})),!V.value&&!V.error&&i()(J.Z,{},void 0,i()(X.Z,{})),de[ft]>0&&i()(q.Z,{type:q.i.Vertical,initialFocus:0,sections:de,store:Z}))}const Pt=o(85).ZG6,Tt=o(85).D7I,xt=o(85)._V5,Mt=o(85).TtP,Zt=o(85).dLQ,At=o(85).Yzm,Ft=o(85).Mm1,Bt=o(85).FH8,_t=o(85).kdC,Vt=o(85).Gm5;function It(e){window.__c={n:"ValuePickerMenuSelect"};const{[Vt]:t,contextStore:o,currentSimpleFormulaValueTokens:n,formulaTypecheckContextValues:r,isSingle:s,menuProps:u,onChange:m,onClose:h,[_t]:g,showInputMenuItem:y,type:f}=e,S=(0,c.Fy)(),b=(0,H.useIntl)(),[w,C]=(0,l.useState)(""),P=(0,d.qz)(void 0,U.Z),T=de.NW.createChildStore(o[Vt].parentRecordStore,f[Bt]),x=(0,d.VK)((()=>T.getSchema()[f.property]),[T,f]),M=(0,d.VK)((()=>x&&(0,p.isStatusPropertySchema)(x)?x.groups??[]:[]),[x]),Z=(0,d.VK)((()=>x&&(0,p.isOptionsPropertySchema)(x)&&x.options||[]),[x]),A=r.filter((e=>(0,R.uy)(e.type,{type:"select",[Bt]:f[Bt],property:f.property}))),F=(0,d.VK)((()=>({valueResults:w?(0,W.ZP)(w,A,(e=>e.kind===L.yp.ContextValue?e.name:"")):A,selectResults:w?(0,W.ZP)(w,Z,(e=>e.value)):Z})),[w,A,Z]),B=(0,l.useCallback)((()=>{C(""),P.setState({...P.state,focus:{section:0,indexLocal:0,indexGlobal:0}})}),[P]),_=(0,l.useCallback)((e=>{m({type:"simple",value:s?(0,v.YD)(e[0]):(0,v.iC)(e)}),B()}),[m,B,s]),V=(0,d.VK)((()=>(0,Q.formulaButtonsEnabled)()),[]),I=K().compact(n.map(((e,r)=>i()(D,{token:e,contextStore:o,disabled:!1,currentSimpleFormulaValueTokens:n,setCurrentTokens:_,[Vt]:t},r)))),O=void 0!==(null==u?void 0:u.header)?u.header:i()(J.Z,{style:{[Ft]:0},title:b[At](ee.s.genericMenuHeader)}),E=i()($.Z,{focus:!S[Zt]||void 0,focusAfterAnimation:!0,format:$.Z.Format.FilterValue,tokens:I,placeholder:b[At](ee.s.searchPlaceHolder),onRemoveLastToken:()=>{_(n.slice(0,n[Mt]-1))},onClearButtonClick:()=>{_([])},value:w,onChange:e=>{C(e.target.value)},dontShowBorderBottom:S.isAndroid,[_t]:g}),z=[];if(y){const e=Boolean(O);z.push({key:"search-input",render:t=>l[Tt](J.Z,a()({},t,{style:{...e&&{[xt]:0}}})),items:[{action:()=>{},key:"input",render:()=>E}]})}const X=Boolean(x&&(0,p.isStatusPropertySchema)(x)),te={automationContextValues:F.valueResults??[],onClose:h,[Vt]:t,contextStore:o,currentSimpleFormulaValueTokens:n,isSingle:s,groupOptions:M,selectOptions:F.selectResults??[],setCurrentTokens:_},oe=X?function(e){const{automationContextValues:t,onClose:o,[Vt]:n,contextStore:r,currentSimpleFormulaValueTokens:s,isSingle:c,groupOptions:d,selectOptions:u,setCurrentTokens:p}=e,m=[],h=c?"single":"multi",g=K().compact(t.map((e=>Te({currentSimpleFormulaValueTokens:s,value:e,setCurrentTokens:p,contextStore:r,action:c?"replace":"append",[Vt]:n,checkType:h,onCheckboxClick:()=>{c&&mt.default[Pt]((()=>{o()}))}}))));g[Mt]>0&&m.push({key:"automation-variables",render:e=>l[Tt](J.Z,a()({title:l[Tt](H.FormattedMessage,ee.s.valuesFromThisAutomation),topBorder:!0},e)),items:g});const y=new Map(u.map((e=>[e.id,e]))),f=d.map((e=>{const t=(e.optionIds??[]).map((e=>y.get(e))).filter(k.isDefined).map((e=>{const t=Boolean(s.find((t=>"string"==typeof t&&t===e.value))),a=()=>{p(c?t?[]:[e.value]:t?(0,v.Ck)(s,e.value):[...s,e.value]),c&&mt.default[Pt]((()=>{o()}))};return{key:e.id,render:o=>i()(Pe,{token:e.value,contextStore:r,args:o,checkState:t,checkType:h,[Vt]:n,onCheckboxClick:a}),action:a}}));return{key:e.id,items:t,render:t=>l[Tt](J.Z,a()({title:e.name,topBorder:!0},t))}})).filter((e=>e.items[Mt]>0));return m.push(...f),m}(te):function(e){const{automationContextValues:t,onClose:o,[Vt]:n,contextStore:r,currentSimpleFormulaValueTokens:s,isSingle:c,selectOptions:d,setCurrentTokens:u}=e,p=[],m=c?"single":"multi",h=K().compact(t.map((e=>Te({currentSimpleFormulaValueTokens:s,value:e,setCurrentTokens:u,contextStore:r,action:c?"replace":"append",[Vt]:n,checkType:m,onCheckboxClick:()=>{c&&mt.default[Pt]((()=>{o()}))}})))),g=K().compact(d.map((e=>{const t=Boolean(s.find((t=>"string"==typeof t&&t===e.value))),a=()=>{u(c?t?[]:[e.value]:t?(0,v.Ck)(s,e.value):[...s,e.value]),c&&mt.default[Pt]((()=>{o()}))};return{key:e.id,render:o=>i()(Pe,{token:e.value,contextStore:r,args:o,checkState:t,checkType:m,[Vt]:n,onCheckboxClick:a}),action:a}}))),y=[...h,...g];y[Mt]>0&&p.push({key:"options",render:e=>l[Tt](J.Z,a()({topBorder:!0},e)),items:y});return p}(te);let ne;z.push(...oe),ne=S[Zt]?{menuType:G.og.Modal,right:i()(j.DoneMenuText,{}),onClickRight:h}:{menuType:G.og.Popup,maxHeight:"50vh",width:260,[xt]:0,footer:V&&i()(J.Z,{topBorder:!0},void 0,l[Tt](se,e)),disableHeaderBorder:!0};const ie={...ne,...u,header:S[Zt]?null:O};return l[Tt](N.Z,ie,0===z[Mt]&&i()(J.Z,{},void 0,i()(Y.Z,{title:l[Tt](H.FormattedMessage,ee.s.noResults)})),z[Mt]>0&&i()(q.Z,{type:q.i.Vertical,initialFocus:0,sections:z,store:P}))}const Dt=o(85).Yzm,Ot=o(85).Mm1,Kt=o(85).D7I;function Rt(e){window.__c={n:"ValuePickerMenuText"};const{context:t,contextStore:o,currentSimpleFormulaValueTokens:n,formulaTypecheckContextValues:r,menuProps:s,onChange:u,onClose:p,value:m}=e,h=(0,H.useIntl)(),g=(0,c.Fy)(),y=r.filter((e=>"text"===e.type.type)),f=(0,l.useCallback)((e=>{u({type:"simple",value:e})}),[u]),k=(0,l.useCallback)((e=>{f(e),p()}),[f,p]),b=(0,l.useCallback)((e=>{const t=e.target.value;let o;o=""===t?void 0:[[t]],f(o)}),[f]),w=(0,l.useCallback)((e=>{const t=K().get(e,"event.target.value");let o;o="string"==typeof t&&""!==t?[[t]]:void 0,k(o)}),[k]),C=(0,l.useCallback)((e=>{const t=void 0!==e[0]?(0,v.YD)(e[0]):void 0;k(t)}),[k]),P=(0,d.VK)((()=>(0,Q.formulaButtonsEnabled)()),[]),T=[],x=[...K().compact(y.map((e=>Te({currentSimpleFormulaValueTokens:n,value:e,setCurrentTokens:C,contextStore:o,action:"replace",context:t,checkType:"single"})))),...[{action:w,key:"input",render:e=>{const t=n[0],o="string"==typeof t?t:(0,S.getText)(null==m?void 0:m.value);return l[Kt](st.ZP,a()({},e,{focus:!0,onChange:b,onClick:void 0,value:o}))}}]],M=void 0!==(null==s?void 0:s.header)?s.header:i()(J.Z,{style:{[Ot]:0},title:h[Dt](ee.s.genericMenuHeader)});let Z;T.push({key:"textbox",render:e=>l[Kt](J.Z,e),items:x}),Z=g.isMobile?{menuType:G.og.Modal,right:i()(j.DoneMenuText,{}),onClickRight:p}:{menuType:G.og.Popup,maxHeight:"50vh",width:260,footer:P&&i()(J.Z,{topBorder:!0},void 0,l[Kt](se,e)),disableHeaderBorder:!0};const A={...Z,...s,header:g.isMobile?null:M};return l[Kt](N.Z,A,i()(q.Z,{initialFocus:0,sections:T,type:q.i.Vertical}))}const Lt=o(85).D7I,Wt=o(85).kdC;function Et(e){const{[Wt]:t,showInputMenuItem:o,type:n}=e;return"text"===n.type?s[Lt](Rt,a()({},e,{type:n})):"number"===n.type?s[Lt](pt,a()({},e,{type:n})):"checkbox"===n.type?s[Lt](Qe,a()({},e,{type:n})):"date"===n.type?s[Lt](lt,a()({},e,{type:n})):"person_array"===n.type?s[Lt](Ct,a()({},e,{[Wt]:t??!0,showInputMenuItem:o??!0,type:n})):"block_array"===n.type?s[Lt](Le,a()({},e,{[Wt]:t??!0,showInputMenuItem:o??!0,type:n})):"select"===n.type?s[Lt](It,a()({},e,{[Wt]:t??!0,showInputMenuItem:o??!0,type:n,isSingle:!0})):"select_array"===n.type?s[Lt](It,a()({},e,{[Wt]:t??!0,showInputMenuItem:o??!0,type:n,isSingle:!1})):void(0,k.unreachable)(n)}},75311:(e,t,o)=>{o.d(t,{M:()=>s,_:()=>c});var n=o(67294),i=o(81954),r=o(99036),a=o(40506),l=o(97880);function s(e,t){const o=(0,i.VK)((()=>{const o=e.getSchema()[t];let n;return o&&(0,r.isPropertySchemaWithLimit)(o)&&(n=o.limit),n}),[e,t]);return(0,n.useCallback)(((e,t)=>(0,l.isDefined)(o)?"first"===t?e.slice(0,o):"last"===t?e.slice(-o):void(0,l.unreachable)(t):e),[o])}function c(e){var t;const o=null===(t=e.collectionStore.getSchema())||void 0===t?void 0:t[e.property];return o&&"date"===o.type?{dateFormat:o.date_format||a.defaultDateFormat,timeFormat:o.time_format||a.defaultTimeFormat}:{dateFormat:a.defaultDateFormat,timeFormat:a.defaultTimeFormat}}},30387:(e,t,o)=>{o.d(t,{s:()=>a});var n=o(5366);const i=o(85).i_Y,r=o(85).nx5,a=(0,n.defineMessages)({back:{[r]:"Back",id:"formulas.SimpleFormulaValuePicker.back"},valuesFromThisAutomation:{[r]:"From this automation",id:"formulas.SimpleFormulaValuePicker.valuesFromThisAutomation"},pickADate:{[r]:"Pick a date",id:"formulas.SimpleFormulaValuePicker.pickADate"},clear:{[r]:"Clear",id:"formulas.SimpleFormulaValuePicker.clear"},unchecked:{[r]:"Unchecked",id:"formulas.SimpleFormulaValuePicker.checkbox.unchecked"},checked:{[r]:"Checked",id:"formulas.SimpleFormulaValuePicker.checkbox.checked"},checkboxOptions:{[r]:"Checkbox options",id:"formulas.SimpleFormulaValuePicker.checkbox.sectionHeader"},searchPlaceHolder:{[r]:"Select one or more optionsâ¦",id:"formulas.SimpleFormulaValuePicker.select.searchPlaceholder"},selectOptionsSectionHeader:{[r]:"Select an option",id:"formulas.SimpleFormulaValuePicker.select.sectionHeader"},noResults:{[r]:"No results",id:"formulas.simpleValuePicker.noResults"},pageSearchPlaceholder:{[r]:"Search for one or more pagesâ¦",id:"formulas.SimpleFormulaValuePicker.pages.searchPlaceholder"},pages:{[r]:"Pages",id:"formulas.SimpleFormulaValuePicker.pages.sectionHeader"},somethingWentWrong:{[r]:i,id:"formulas.simpleValuePicker.errorMessage"},personSelect:{[r]:"Select...",id:"formulas.SimpleFormulaValuePicker.chooseAValue"},personSearchPlaceholder:{[r]:"Search for one or more peopleâ¦",id:"formulas.SimpleFormulaValuePicker.people.searchPlaceholder"},customFormula:{[r]:"Custom formula",id:"formulas.SimpleFormulaValuePicker.customFormula"},peopleInWorkspace:{[r]:"People",id:"formulas.SimpleFormulaValuePicker.people.sectionHeader"},genericMenuHeader:{[r]:"Set property to",id:"formulas.SimpleFormulaValuePicker.genericMenuHeader"}})},40863:(e,t,o)=>{o.d(t,{Ft:()=>x,YG:()=>M,y$:()=>A,du:()=>F,BO:()=>B,Lh:()=>D});var n=o(96486),i=o.n(n),r=o(17126),a=o(30823),l=o(40506),s=o(53877),c=o(42875),d=o(55384),u=o(5366),p=o(28020);const m=o(85).nx5,h=o(85).CwG,g=o(85).YaF,v=o(85).nSw,y=o(85).C9b,f=o(85).kdI,S=o(85).oki,k=o(85).iQh,b=o(85).nUE,w=o(85).qq3,C=o(85).QmD,P=o(85).qU4,T=o(85).P24;function x(e){const{[T]:t}=e,o=t[P]();if(!o)return;const n=t[w][C],i=o.getQuery(n);if(!i||!i[b])return;const r=t[k][C],a=t.dateRangeEnd[C],l=(0,s.date)(r,(0,c.r)()),d=(0,s.date)(a,(0,c.r)());return Z({calendarBy:i[b],dateRangeStartDate:l,dateRangeEndDate:d})}function M(e){const{[T]:t,startOfDay:o}=e,n=t[P]();if(!n)return;const i=t[w][C],a=n.getQuery(i);if(!a||!a[b])return;const l=r.ou[S](o).endOf("day").valueOf(),d=(0,s.date)(o,(0,c.r)()),u=(0,s.date)(l,(0,c.r)());return Z({calendarBy:a[b],dateRangeStartDate:d,dateRangeEndDate:u})}function Z(e){const{dateRangeStartDate:t,dateRangeEndDate:o,calendarBy:n}=e;return{type:"results",filter:{operator:"and",filters:[{property:n,filter:{operator:f,use_end:!0,value:{type:"exact",value:t}}},{property:n,filter:{operator:y,value:{type:"exact",value:o}}}]},limit:5e3}}function A(e){const{[T]:t,results:o,[v]:n,intl:r}=e,a=t[P](),d=t[g][C],u=t[w][C],m=d?d[b]:void 0,h=t[k][C],y=t.dateRangeEnd[C],f=p.userSettingsStartOfWeekStore[C],S=(0,c.r)(),x=t.getCurrentUserId();if(!(a&&d&&m&&u))return;const M=i().compact(o.map((e=>B({blockStore:e,calendarBy:m,schema:u,[v]:n,userId:x,intl:r})))),Z={};o.forEach(((e,t)=>{Z[e.id]=t}));0===(d.sort||[]).length&&M.sort(((e,t)=>{const o=e.start.valueOf(),n=t.start.valueOf();if(o===n){return Z[e.id]-Z[t.id]}return o-n}));const A=(0,s.getLuxonStartOfWeek)(h,f,S),V=(0,s.getLuxonEndOfWeek)(y,f,S);let I=A;const D=[];do{const e=(0,s.getLuxonEndOfWeek)(I.valueOf(),f,S),t={},o=M.filter((t=>(0,l.rangeIntersects)(I.valueOf(),e.valueOf(),t.start.valueOf(),t.end?t.end.valueOf():void 0))).map((o=>{const{id:n,start:i,end:r,includeTime:a,timeZone:l}=o,{startColumn:s,columnCount:c}=F({startUnixTimestampMS:i.valueOf(),endUnixTimestampMS:r?r.valueOf():void 0,startOfWeekUnixTimestampMS:I.valueOf(),endOfWeekUnixTimestampMS:e.valueOf()}),d=_(s,c,t);return{id:n,start:i.valueOf(),end:r?r.valueOf():void 0,row:d,includeTime:a,timeZone:l}}));D.push({start:I.valueOf(),end:e.valueOf(),items:o}),I=(0,s.getLuxonStartOfWeek)(I.plus({week:1}).plus({hour:25}).valueOf(),f,S)}while(I<V);return D}function F(e){const t=r.ou[S](e.startUnixTimestampMS),o=e.endUnixTimestampMS?r.ou[S](e.endUnixTimestampMS):void 0,n=r.ou[S](e.startOfWeekUnixTimestampMS),i=r.ou[S](e.endOfWeekUnixTimestampMS),a=t.startOf("day"),l=r.ou.max(n,a),s=l.diff(n,"days").get("days");let c=1;if(o){const e=o.endOf("day"),t=r.ou.min(i,e);c=Math.ceil(t.diff(l,"days").get("days"))}return{start:t,end:o,startOfWeek:n,endOfWeek:i,startColumn:s,columnCount:c}}function B(e){const{blockStore:t,calendarBy:o,schema:n,[v]:i,intl:r,userId:l}=e,u=t.getModel();if(!u)return;const p=(0,a.FT)({property:o,schema:n,block:u,getRecordModel:d.om[h](i),userId:l,userTimeZone:(0,c.r)(),depth:0,intl:r,propertyMapping:void 0,visitedProperties:new Set,resultCache:{}}).next().value;if("date"!==p.type)return;const m=p.value,g=m&&(0,s.getLuxonRange)(m,(0,c.r)());if(!m||!g)return;return{id:u.id,start:g.start,end:g.end,includeTime:"datetime"===m.type||"datetimerange"===m.type,timeZone:"datetime"===m.type||"datetimerange"===m.type?m.time_zone:void 0}}function _(e,t,o){let n=0;for(;;){let i=!1;for(let r=0;r<t;r++)V(o,e+r,n)&&(i=!0);if(!i)break;n++}for(let i=0;i<t;i++)I(o,e+i,n);return n}function V(e,t,o){return Boolean(e[o]&&e[o][t])}function I(e,t,o){e[o]||(e[o]={}),e[o][t]=!0}const D=(0,u.defineMessages)({week:{[m]:"Week",id:"calendar.viewRanges.week"},month:{[m]:"Month",id:"calendar.viewRanges.month"}})},30950:(e,t,o)=>{o.d(t,{a:()=>i});var n=o(67294);function i(e){return(0,n.useMemo)((()=>Boolean(e&&e.width<400)),[e])}},24457:(e,t,o)=>{o.d(t,{U:()=>p,F:()=>m});var n=o(480),i=o(81954),r=o(87279);const a=o(85).vK9,l=o(85).Mm1,s=o(85)._V5,c=o(85).fsm,d=o(85).I7L,u=o(85).zVT;function p(e){return e.device.isPhone||"actionSheet"===e[u]&&e.device.isTablet?{menuType:r.og.ActionSheet}:{menuType:r.og.Popup,[d]:e[d],[c]:e[c],[s]:e[s],[l]:e[l],width:e.width,[a]:e[a]}}function m(e){const t=(0,n.Fy)();return(0,i.VK)((()=>p({device:t,[d]:null==e?void 0:e[d],[c]:null==e?void 0:e[c],[s]:null==e?void 0:e[s],[l]:null==e?void 0:e[l],width:null==e?void 0:e.width,[a]:null==e?void 0:e[a],[u]:null==e?void 0:e[u]})),[t,null==e?void 0:e[d],null==e?void 0:e[c],null==e?void 0:e[s],null==e?void 0:e[l],null==e?void 0:e.width,null==e?void 0:e[a],null==e?void 0:e[u]])}},29502:(e,t,o)=>{o.d(t,{d:()=>l});var n=o(480),i=o(81954),r=o(44532);const a=o(85).zVT;function l(e){const t=(0,n.Fy)();return(0,i.VK)((()=>t.isPhone||"slideUp"===(null==e?void 0:e[a])&&t.isTablet?r.kQ.SlideUp:r.kQ.Popup),[t,null==e?void 0:e[a]])}},28267:(e,t,o)=>{o.d(t,{X:()=>r});var n=o(67294),i=o(77794);function r(e){const[t,o]=(0,n.useState)(void 0);return(0,n.useEffect)((()=>{if(!e.current)return;const t=new i.E;return t.observe(e.current),t.rect.addListener((e=>{o(e.state)})),()=>{t.destroy()}}),[e]),t}},68910:(e,t,o)=>{o.d(t,{L:()=>p});var n=o(96486),i=o.n(n),r=o(14577),a=o(78106),l=o(68626),s=o(23223);const c=o(85).Dn1,d=o(85).$Qz,u=o(85).Gm5;class p{constructor(e){this[u]=void 0,this[d]=new r.Z((()=>(0,s.pt)({[u]:this[u]})),{useDeepEqual:!0,debugName:"compilationResultsStore"}),this[u]=e}getAllContextValues(){const e=this[d].state;return l.x.isFail(e)?[]:i().clone(e.value.valueTypes)}getContextValuesForAction(e){const t=this[d].state;return l.x.isFail(t)?[]:t.value.actionInputValueTypes[e]??[]}getValidationErrorsForAction(e){const t=this[d].state;return l.x.isFail(t)?[]:t.value.actionValidationFailures[e]??[]}[c](e,t){const o=this.getContextValuesForAction(e);return(0,a.vx)(o,t)}}},36857:(e,t,o)=>{o.d(t,{Z:()=>r});var n=o(49085);class i extends n.default{getInitialState(){return{pageId:void 0}}}const r=new i},23790:(e,t,o)=>{o.d(t,{qT:()=>l,xK:()=>s,uy:()=>c,Jy:()=>d});var n=o(606);const i=o(85).hqk,r=o(85).FH8,a=o(85).MWD;function l(e,t){return Array.isArray(t)?t.some((t=>l(e,t))):"unknown"===e[a]||"unknown"===t[a]||"expression"===t[a]||e[a]===t[a]&&("block"===e[a]||"select"===e[a]||"function"===e[a]?d(e,t):"array"!==e[a]||"array"!==t[a]||l(e.of,t.of))}function s(e,t){return!!l(e,t)||(l({[a]:"checkbox"},t)?{[a]:"checkbox"}:l({[a]:"text"},t)?{[a]:"text"}:!!l({[a]:"array",of:{[a]:"text"}},t)&&{[a]:"array",of:{[a]:"text"}})}function c(e,t){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=o?d:(e,t)=>e[a]===t[a];return n(e,t)||"array"===e[a]&&n(e.of,t)}function d(e,t){return e[a]===t[a]&&("block"===e[a]&&"block"===t[a]?void 0===e[r]?void 0===t[r]:void 0!==t[r]&&(0,n.qo)(e[r],t[r]):"select"===e[a]&&"select"===t[a]?(0,n.qo)(e[r],t[r])&&e.property===t.property:"array"===e[a]&&"array"===t[a]?d(e.of,t.of):"function"!==e[a]||"function"!==t[a]||e[i]===t[i]&&void 0!==e.boundTargetType==(void 0!==t.boundTargetType))}}}]);