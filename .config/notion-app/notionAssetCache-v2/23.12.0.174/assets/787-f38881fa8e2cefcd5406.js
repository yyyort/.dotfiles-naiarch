"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[787],{52801:(e,i,t)=>{t.r(i),t.d(i,{openHistoryModal:()=>y,loadMoreSnapshots:()=>M,closeHistoryModal:()=>w,selectSnapshot:()=>Z,clearSelectedSnapshot:()=>P,restoreSnapshot:()=>B});var r=t(77094),o=t.n(r),s=(t(67294),t(98459)),n=t(82990),d=t(5366),a=t(10161),l=t(46096),c=t(50906),h=t(54642),u=t(47307),v=t(92625);t(85).Mkg;const m=t(85).ChN,p=t(85).B1C,g=t(85).vwF,f=t(85).L6j,k=t(85).QmD,b=t(85).Wp_,C=t(85).nx5,T=(0,d.defineMessages)({restoringPreviousVersion:{id:"historyModalActions.restoringPreviousVersion.loadingMessage",[C]:"Restoringâ€¦"}});function y(e){const{environment:i,from:t,...r}=e;c.trackOpenVersionHistory(i,t),l.Z[b]({...r,open:!0,size:50})}const M=()=>{const e=l.Z[k];e.open&&l.Z[b]({...e,size:e.size+20})},w=function(){l.Z[b]({open:!1})};function Z(e){const{environment:i,[f]:t,[g]:r}=e;c.trackSelectSnapshot(i,t);const o=l.Z[k];o.open&&l.Z[b]({...o,[f]:t,[g]:r,[p]:void 0})}function P(){const e=l.Z[k];e.open&&l.Z[b]({...e,[f]:void 0,[g]:void 0})}async function B(e){if(!l.Z[k].open)return;if(!l.Z[k][f])return;const i="restore_collection",t=l.Z[k].pageHasCollection,r=a.default.checkGate("snapshot_optional_collection_rollback_enabled")&&t?[{key:i,text:o()(d.FormattedMessage,{[C]:"Also restore databases on this page",id:"historyModal.confirmDialog.selectOption.collection"}),description:o()(d.FormattedMessage,{[C]:"All database pages will be restored to the previous version, which may impact other users or database views.",id:"historyModal.confirmDialog.selectOption.collection.description"})}]:void 0,{accept:p,selectionResult:g}=await u.confirmUserActionV2({message:o()("div",{style:{[m]:n.Z[m].semibold,fontSize:"medium"}},void 0,o()(d.FormattedMessage,{[C]:"Restore to this version?",id:"historyModal.confirmDialog.description"})),acceptLabel:o()(d.FormattedMessage,{[C]:"Restore",id:"historyModal.confirmDialog.restoreButton.label"}),selectionItems:r});if(!p)return;c.trackRestoreSnapshot(e,l.Z[k][f]),v.display({message:T.restoringPreviousVersion});const b=await h.restoreSnapshot(e,{block:{id:l.Z[k].blockStore.id,spaceId:(0,s.CG)(l.Z[k].blockStore.pointer.spaceId)},timestamp:l.Z[k][f].timestamp,shouldRestoreCollection:(null==g?void 0:g.restore_collection)??!1}).next();b.value.error&&u.showErrorMessage(b.value.error.message),v.close(),w()}},65991:(e,i,t)=>{t.d(i,{Z:()=>Zr});var r=t(97464),o=t.n(r),s=t(77094),n=t.n(s),d=t(96486),a=t.n(d),l=t(67294),c=t(83355),h=t(13991),u=t(49085),v=t(40902),m=t(66897),p=t(17215),g=t(41432),f=t(15070),k=t(99036),b=t(80951),C=t(8848),T=t(63144),y=t(83212),M=t(14215),w=t(6695),Z=t(38297),P=t(42875),B=t(3909),x=t(55384),F=t(26825),S=t(27006),E=t(98459),V=t(21202),D=t(77420),_=t(70279),U=t(90468),O=t(29369),A=t(19889),I=t(70203),z=t(97880),H=t(82990),L=t(7928),N=t(5366),R=t(42130),G=t(33929),q=t(17652),W=t(77505),K=t(77907),j=t(30874),J=t(39098),X=t(2456),Y=t(31278);const $=t(85).D7I,Q=t(85).Hco,ee=t(85).LlE,ie=t(85).pkR,te=t(85).mFu,re=t(85).nx5,oe=t(85).PXg,se=t(85).X_m,ne=t(85).g7N,de=t(85).OM8,ae=t(85).Exd,le=t(85).Au,ce=t(85).TEz,he=t(85).jkI,ue=t(85).H1U,ve=t(85).EMU,me=t(85).sM5,pe=t(85).c04,ge=t(85).mfe,fe=t(85).cJA,ke=t(85).sS,be=t(85).OnS,Ce=t(85).urI;class Te extends c.Z{constructor(){super(...arguments),this.renderEdit=()=>{const{edit:e,formatProperty:i}=this.props;if("page_icon"===i){const t=e[fe][ke][be][Ce]&&e[fe][ke][be][Ce][i],r=e[fe][ge][be][Ce]&&e[fe][ge][be][Ce][i];return this[pe](t,r)}"is_placeholder"!==i&&(0,z.unreachable)(i)},this[pe]=(e,i)=>{const{edit:t}=this.props;if(e||i)return l[$](l.Fragment,null,n()("div",{style:{[me]:ve,[ue]:he,color:this[le][ce],[ae]:12,[de]:1,[ne]:8}},void 0,B.Z.random({width:12,[se]:12,[oe]:6}),n()(N.FormattedMessage,{id:"editFormatDiff.pageIcon.label",[re]:"Page Icon"})),n()("div",{style:{[me]:ve,[ue]:he}},void 0,n()(Y.Z,{[ie]:!0,isEmptyPage:!1,size:20,icon:e?{[te]:{table:V.iU,id:t[fe][ke][be].id},icon:e}:void 0}),n()("div",{style:{[ee]:"0px 8px"}},void 0,B.Z.historyForward({width:14,[se]:14,fill:this[le][Q]})),n()(Y.Z,{[ie]:!0,isEmptyPage:!1,size:20,icon:i?{[te]:{table:V.iU,id:t[fe][ge][be].id},icon:i}:void 0})))}}renderComponent(){return this.renderEdit()||null}}Te.displayName="EditFormatDiff";const ye=Te;var Me=t(63867),we=t(75561),Ze=t(47240);const Pe=t(85).kEu,Be=t(85).Kfr,xe=t(85).UC9,Fe=t(85).noB,Se=t(85).kKe,Ee=t(85).Mm1,Ve=t(85).Xml,De=t(85).iKV,_e=t(85).cBH,Ue=t(85).rV3,Oe=t(85).a3u,Ae=t(85).Yzm,Ie=t(85).s4W,ze=t(85).D29,He=t(85).RLV,Le=t(85).yvu,Ne=t(85).zjr,Re=t(85).YkZ,Ge=t(85).sei,qe=t(85).Y9u,We=t(85).rI1,Ke=t(85).xej,je=t(85).CRx,Je=t(85).YE1,Xe=t(85).Ecr,Ye=t(85).noU,$e=t(85).L7r,Qe=t(85).zDZ,ei=t(85).su2,ii=t(85).Hco,ti=t(85).X_m,ri=t(85).Jkr,oi=t(85).LlE,si=t(85).XNW,ni=t(85).H1U,di=t(85).rps,ai=t(85).$bT,li=t(85).EMU,ci=t(85).xLj,hi=t(85).Q1_,ui=t(85).wuN,vi=t(85).fBu,mi=t(85).Uie,pi=t(85).Wp_,gi=t(85).fBv,fi=t(85).paz,ki=t(85).A5y,bi=t(85).EjX,Ci=t(85).YsR,Ti=t(85).I9F,yi=t(85).wsH,Mi=t(85).g7N,wi=t(85).sG$,Zi=t(85).ibH,Pi=t(85).CkH,Bi=t(85).iQi,xi=t(85).Exd,Fi=t(85).Oc6,Si=t(85).aFd,Ei=t(85).Ujb,Vi=t(85).z6V,Di=t(85).OM8,_i=t(85).rOg,Ui=t(85).sM5,Oi=t(85).Nvq,Ai=t(85).YDv,Ii=t(85).D7I,zi=t(85).Oy0,Hi=t(85).ObE,Li=t(85).v6W,Ni=t(85).Iu4,Ri=t(85).Zij,Gi=t(85).AZB,qi=t(85).DxG,Wi=t(85).nLZ,Ki=t(85).PXg,ji=t(85).LCc,Ji=t(85).rYD,Xi=t(85).wOm,Yi=t(85).nx5,$i=t(85).Au,Qi=t(85).OTW,et=t(85).zf8,it=t(85).TtP,tt=t(85).v1$,rt=t(85).zkl,ot=t(85).BQ6,st=t(85).dU4,nt=t(85).UgI,dt=t(85).OYO,at=t(85).Iji,lt=t(85).MaF,ct=t(85).evN,ht=t(85).dow,ut=t(85).ue0,vt=t(85).lqd,mt=t(85).Vp2,pt=t(85).WhU,gt=t(85).uzg,ft=t(85).inc,kt=t(85).zL2,bt=t(85).BaG,Ct=t(85).Hnl,Tt=t(85).y06,yt=t(85).HZV,Mt=t(85).HnX,wt=t(85).AL1,Zt=t(85).BdA,Pt=t(85).AYi,Bt=t(85).Xe9,xt=t(85).DTp,Ft=t(85).h8N,St=t(85).oCw,Et=t(85).OwK,Vt=t(85).eVi,Dt=t(85).oip,_t=t(85).xgF,Ut=t(85).SuZ,Ot=t(85).vEM,At=t(85).toF,It=t(85).PZg,zt=t(85).fVq,Ht=t(85).$hq,Lt=t(85).JeZ,Nt=t(85).M$i,Rt=t(85).lrc,Gt=t(85).T9v,qt=t(85).wyy,Wt=t(85).LGE,Kt=t(85).kBc,jt=t(85).sqd,Jt=t(85).QBx,Xt=t(85).RVJ,Yt=t(85).wk2,$t=t(85).vIB,Qt=t(85).nSw,er=t(85).J3F,ir=t(85).Lfz,tr=t(85).Wkb,rr=t(85).wgE,or=t(85).g65,sr=t(85).voC,nr=t(85).sKc,dr=t(85).ffk,ar=t(85).sS,lr=t(85).ZK1,cr=t(85).yn7,hr=t(85).Ql2,ur=t(85).cJA,vr=t(85).mfe,mr=t(85).OnS,pr=t(85).MWD,gr=t(85).l8v,fr=t(85).Wgn,kr=t(85).YmJ,br=t(85).OBh,Cr=t(85).P0R,Tr=t(85).xa7,yr=t(85).$Jh,Mr=t(85).wfR;class wr extends c.Z{constructor(){super(...arguments),this.storeTypes={isEditHovered:u.default[Mr](!1)},this[yr]=(e,i,t)=>n()(X.KX,{value:e,[br]:i,labeled:t,[Tr]:this[Cr][Tr]}),this[kr]=(e,i,t,r)=>n()(X.Tl,{[fr]:e,prop:i,labeled:t,schema:r,intl:this[Cr].intl,[Tr]:this[Cr][Tr]}),this[gr]=(e,i,t)=>{const r=this.getBlockSchema(e)[i],o="block-changed"===e[pr]?e[ur][vr][mr]:e[ur][mr],s=(0,X.SX)(o,i);if(r)return this[yr]({value:s,[hr]:(0,E.CG)(o[cr])},r,t)},this[lr]=(e,i,t)=>{const r=this.getBlockSchema(e),o=r[i];if(!o)return;const s=(0,X.SX)(e[ur][ar][mr],i),d=b.valueIsEmpty({[dr]:i,schema:r,block:x.kk[nr](e[ur][ar][mr]),[sr]:this[sr],userId:this[rr][or].id,[tr]:(0,P.r)(),intl:this[Cr].intl}),a=(0,X.SX)(e[ur][vr][mr],i),l=o[pr];return d&&"text"!==l&&"title"!==l?this[yr]({value:a,[hr]:(0,E.CG)(e[ur][vr][mr][cr])},o,t):n()(X.Hq,{labeled:t,[ir]:o[ir],[pr]:o[pr],icon:o.icon},void 0,n()(Ze.Z,{[br]:o,beforeValue:{value:s,[hr]:(0,E.CG)(e[ur][ar][mr][cr])},afterValue:{value:a,[hr]:(0,E.CG)(e[ur][vr][mr][cr])},[Tr]:this[Cr][Tr]}))},this[er]=e=>{const{labeled:i,[br]:t,beforeValue:r,afterValue:o,[hr]:s}=e,d=(0,E.CG)(s);return n()(X.Hq,{labeled:i,[ir]:t[ir],[pr]:t[pr],icon:t.icon},void 0,n()(Ze.Z,{[br]:t,beforeValue:{value:r,[hr]:d},afterValue:{value:o,[hr]:d},[Tr]:this[Cr][Tr]}))},this[Qt]=this[Cr][Tr][Qt],this[sr]=this[Cr][Tr][sr]}renderComponent(){return this.renderEdit()||null}renderEdit(){if("comment-edit"===this[Cr][pr]){const{edit:e,[$t]:i,hideAuthorName:t}=this[Cr];switch(e[pr]){case"comment-created":return this[Yt]({edit:e,[$t]:i,hideAuthorName:t});case"comment-changed":return this[Xt](e);case"comment-deleted":return this[Jt](e,i);default:(0,z.unreachable)(e)}}const{edit:e}=this[Cr];switch(e[pr]){case"block-created":return this.renderBlockCreatedEdit(e[ur][mr]);case"block-deleted":return this[jt](e[ur][mr]);case"block-changed":return this.renderBlockChangedEdit(e);case Kt:return this[Wt](e);case qt:return this.renderCollectionPropertyChangedEdit(e);case Gt:return this[Rt](e);case"collection-created":return this[Nt](e);case"mention-created":return this.renderMentionCreated(e);case Lt:return this[Ht](e);case zt:return this[It](e);case At:return this[Ot](e);case Ut:case _t:return this[Dt](e);case Vt:return this[Et](e);case St:return this[Ft](e);case xt:return this[Bt](e);case"reminder-created":return this.renderReminderCreated(e);case Pt:return this.renderPermissionGroupMentionCreated(e);case Zt:case"mention-deleted":return null;default:(0,z.unreachable)(e)}}renderBlockChanged(e){switch(e[ur][vr][mr][pr]){case g.Ti[wt]:return this.renderTextBlockChanged(e);case g.Ti.header:return this[Mt](e);case g.Ti.subHeader:return this[yt](e);case g.Ti.subSubHeader:return this[Tt](e);case g.Ti.toggle:return this[Ct](e);case g.Ti.bulletedList:return this[bt](e);case g.Ti.numberedList:return this[kt](e);case g.Ti.quote:return this[ft](e);case g.Ti.factory:return this[gt](e);case g.Ti.equation:return this[pt](e);case g.Ti.toDo:return this.renderTodoBlockChanged(e);case g.Ti.code:return this.renderCodeBlockChanged(e);case g.Ti.bookmark:return this[mt](e);case g.Ti.page:return this.renderPageBlockChanged(e);case g.Ti.collectionView:case g.Ti.collectionViewPage:return this[vt](e);case g.Ti.image:return this.renderImageBlockChanged(e);case g.Ti.embed:return this[ut](e,"embed");case g.Ti.framer:return this[ut](e,"framer");case g.Ti.tweet:return this[ut](e,"tweet");case g.Ti.gist:return this[ut](e,"gist");case g.Ti.drive:return this[ht](e);case g.Ti.maps:return this[ut](e,"maps");case g.Ti.invision:return this[ut](e,"invision");case g.Ti.video:return this[ut](e,"video");case g.Ti.audio:return this[ut](e,"audio");case g.Ti.file:return this[ut](e,"file");case g.Ti.callout:return this[ct](e);case g.Ti.whimsical:return this[ut](e,"whimsical");case g.Ti.miro:return this[ut](e,"miro");case g.Ti.abstract:return this[ut](e,"abstract");case g.Ti.mixpanel:return this[ut](e,"mixpanel");case g.Ti.sketch:return this[ut](e,"sketch");case g.Ti.replit:return this[ut](e,"replit");case g.Ti[lt]:return this[ut](e,lt);case g.Ti.tableRow:return this[at](e);case g.Ti.hex:return this[ut](e,"hex");case g.Ti.hex:return this[ut](e,"deepnote");case g.Ti[dt]:return this[nt](e)}}renderBlockCreatedEdit(e){const i=n()(X.ZP,{[fr]:e,[Tr]:this[Cr][Tr],created:!0});if(i)switch(e[pr]){case g.Ti.quote:case g.Ti.video:case g.Ti.code:case g.Ti.equation:case g.Ti.file:case g.Ti.bookmark:case g.Ti.factory:return n()("div",{[ot]:R.v[st]},void 0,i);case g.Ti[rt]:return;case g.Ti.tableRow:return e[tt]&&(0,z.objectKeys)(e[tt])[it]>0?n()("div",{[ot]:{...R.v[st],...R.v[et]}},void 0,i):void 0;default:return n()("div",{[ot]:{...R.v[st],...R.v[et]}},void 0,i)}}[jt](e){const i=n()(X.ZP,{[Tr]:this[Cr][Tr],[fr]:e,deleted:!0});if(i)switch(e[pr]){case g.Ti.quote:case g.Ti.video:case g.Ti.code:case g.Ti.equation:case g.Ti.file:case g.Ti.bookmark:case g.Ti.factory:return n()("div",{},void 0,n()("div",{[ot]:R.v[Qi](this[$i])},void 0,n()(N.FormattedMessage,{[Yi]:"Deleted",id:"edit.blockDeletedEditStyles.factoryLabel"})),n()("div",{[ot]:{...R.v[st]}},void 0,i));case g.Ti[rt]:return;case g.Ti.tableRow:return e[tt]&&(0,z.objectKeys)(e[tt])[it]>0?n()("div",{[ot]:{...R.v[st],...R.v[Xi]}},void 0,i):void 0;default:return n()("div",{},void 0,n()("div",{[ot]:R.v[Qi](this[$i])},void 0,n()(N.FormattedMessage,{[Yi]:"Deleted",id:"edit.blockDeletedEditStyles.defaultLabel"})),n()("div",{[ot]:{...R.v[st],...R.v[Xi]}},void 0,i))}}renderBlockChangedEdit(e){const i=this.renderBlockChanged(e);if(i)return n()("div",{[ot]:R.v[st]},void 0,i)}[Wt](e){return n()("div",{},void 0,Object.entries(e[Ji]).map((i=>{let[t,r]=i;const o=e[ji][t],s=r[ar]?r[ar].value:[],d=r[vr]?r[vr].value:[],a=this[er]({labeled:!0,[br]:o,beforeValue:s,afterValue:d,[hr]:e[cr]});if(a)return n()("div",{[ot]:R.v[st]},void 0,a)})))}renderCheckbox(e){return n()("div",{[ot]:{[Ki]:6,[Wi]:3}},void 0,this[kr](e,qi,!1))}[Gi](e){return this[gr](e,Ri,!1)}[Ni](e){return this[lr](e,Ri,!1)}renderTextBlockChanged(e){return this[Ni](e)}[ct](e){return n()(y.Z,{[Ri]:n()(N.FormattedMessage,{[Yi]:"Callout",id:"edit.calloutBlockChanged.label"}),[$i]:this[$i]},void 0,this[Ni](e))}[nt](e){const i=i=>{const t=e[ur][i][mr],r=x.kk[nr](t);return r.isType(Li)?p[Hi](G.default.getIntl(),r,x.om.fromRecordMap(j.Z.getIntegrationsAsRecordMap())):null};return n()(y.Z,{[Ri]:l[Ii](N.FormattedMessage,p[zi].editLabel),[$i]:this[$i]},void 0,n()("div",{[ot]:R.v[Xi]},void 0,i(ar)),n()("div",{},void 0,i(vr)))}[Mt](e){return n()("div",{[ot]:R.v.headerStyle},void 0,this[Ni](e))}[yt](e){return n()("div",{[ot]:R.v.subHeaderStyle},void 0,this[Ni](e))}[Tt](e){return n()("div",{[ot]:R.v.subSubHeaderStyle},void 0,this[Ni](e))}[Ct](e){return n()(X.ZD,{},void 0,this[Ni](e))}[bt](e){return n()("ul",{[ot]:{margin:0,[Ai]:28}},void 0,n()("li",{},void 0,this[Ni](e)))}[kt](e){return n()("ol",{[ot]:{margin:0,[Ai]:28}},void 0,n()("li",{},void 0,this[Ni](e)))}[ft](e){return n()(y.Z,{[Ri]:n()(N.FormattedMessage,{[Yi]:"Quote",id:"edit.quoteBlockChanged.label"}),[$i]:this[$i]},void 0,this[Ni](e))}[gt](e){return n()(y.Z,{[Ri]:n()(N.FormattedMessage,{[Yi]:"Template Button",id:"edit.templateButtonBlockChanged.label"}),[$i]:this[$i]},void 0,this[Ni](e))}[pt](e){return n()(y.Z,{[Ri]:n()(N.FormattedMessage,{[Yi]:"Equation",id:"edit.equationBlockChanged.label"}),[$i]:this[$i]},void 0,this[Ni](e))}renderTodoBlockChanged(e){return v[Oi]({[ar]:e[ur][ar][mr],[vr]:e[ur][vr][mr],[dr]:qi})?n()("div",{[ot]:{[Ui]:_i}},void 0,n()("div",{[ot]:{[Ki]:6,[Wi]:3,[Di]:1}},void 0,this[lr](e,qi,!1)),this[Ni](e)):n()("div",{[ot]:{[Ui]:_i}},void 0,this.renderCheckbox(e[ur][vr][mr]),this[Ni](e))}renderCodeBlockChanged(e){return v[Oi]({[ar]:e[ur][ar][mr],[vr]:e[ur][vr][mr],[dr]:Vi})?n()(y.Z,{[Ri]:this[Ei](e[ur][vr][mr]),[$i]:this[$i]},void 0,n()("span",{[ot]:{[Si]:H.Z[Fi](h.SP).mono,[xi]:12,tabSize:2}},void 0,this[Gi](e)),this[lr](e,Vi,!0)):n()(y.Z,{[Ri]:this[Ei](e[ur][vr][mr]),[$i]:this[$i]},void 0,n()("span",{[ot]:{[Si]:H.Z[Fi](h.SP).mono,[xi]:12,tabSize:2}},void 0,this[Gi](e)))}[Bi](e){return this[Pi](e,"caption")&&this[lr](e,"caption",!1)}[ut](e,i){const{intl:t}=this[Cr],r=this[Pi](e,"source")&&n()(y.Z,{[Ri]:p[Zi](t,i),[$i]:this[$i]},void 0,this[wi](e[ur][vr][mr]),this[lr](e,"source",!1));return n()(l.Fragment,{},void 0,r,n()("div",{[ot]:{[Mi]:r?4:0}},void 0,this[Bi](e)))}renderImageBlockChanged(e){const i=this[yi](e[ur][ar][mr]),t=this[yi](e[ur][vr][mr]),r=i!==t&&n()("div",{[ot]:{[Wi]:4,[Mi]:4}},void 0,n()("div",{[ot]:{...R.v[Qi](this[$i]),[Mi]:4}},void 0,n()(N.FormattedMessage,{[Yi]:"Updated",id:"edit.imageBlockChanged.updatedTitle"})),t&&n()(X.xP,{src:t,[Ti]:{[rt]:V.iU,id:e.block_id}}));return n()(l.Fragment,{},void 0,r,n()("div",{[ot]:{[Mi]:r?4:0}},void 0,this[Bi](e)))}renderComment(e){let{commentValue:i,[$t]:t,showEditedBadge:r,hideAuthorName:o}=e;if(!i[Ci]||!i[bi])return;if("comment-edit"!==this[Cr][pr])return;const s=this[Qt]({[rt]:i[Ci],id:i[bi],[hr]:i[cr]}),d=s&&(0,m.LU)({[rt]:i[Ci],value:s}),a=d?(0,m.$4)(this[Cr].intl,d):n()(N.FormattedMessage,{[Yi]:"Unknown author",id:"edit.unknownAuthor.label"}),l=i[wt]&&n()(Me.Z,{[br]:{[pr]:"text",[ir]:""},value:{[hr]:i[cr],value:this[Cr].highlightCurrentUser?this[ki](i[wt]):i[wt]},[Tr]:this[Cr][Tr]}),c=(0,q.mf)(),h=i[fi]&&i[fi][it]>0&&i[fi].map((e=>{const t=this[Qt]({[rt]:"block",id:e,[hr]:i[cr]});return t&&n()(X.ZP,{[fr]:t,[Tr]:this[Cr][Tr]})})).filter(z.isDefined),u=J.t1.createChildStore(this[Cr][Tr],{[rt]:_.x_,id:i.id,[hr]:(0,E.CG)(this[Cr][Tr].pointer[hr])}),v=u.getUserVisibleReactions()[it]>0,p=!v,g=this.stores.isEditHovered;return n()("div",{[ot]:{...p&&{[gi]:"relative"}},onMouseEnter:()=>g[pi](!0),onMouseLeave:()=>g[pi](!1)},void 0,!o&&n()("div",{[ot]:{...R.v[Qi](this[$i]),[Mi]:2}},void 0,a),n()("span",{[ot]:{...c&&{[Ui]:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:6,...H.Z[mi]}}},void 0,l),h,n()("div",{[ot]:{...p&&{[gi]:"absolute",top:-3,right:3}}},void 0,(g.state||v)&&n()(K.LazyReactionBar,{[vi]:u,[$t]:t,onClick:this[Cr].onReactionClick})),r&&n()("span",{[ot]:{color:this[$i][ui],[Ai]:4}},void 0,n()(N.FormattedMessage,{id:"edit.editedBadge",[Yi]:"(edited)"})))}renderCommentDiff(e){var i,t;const{[ar]:r,[vr]:o}=e;if(!o[Ci]||!o[bi])return;const s=this[Qt]({[rt]:o[Ci],id:o[bi],[hr]:o[cr]}),d=s&&(0,m.LU)({[rt]:o[Ci],value:s}),a=d?(0,m.$4)(this[Cr].intl,d):n()(N.FormattedMessage,{[Yi]:"Unknown author",id:"edit.unknownAuthorCommentDiff.label"}),c=r[wt]&&o[wt]&&n()(Ze.Z,{[br]:{[pr]:"text",[ir]:""},beforeValue:{value:r[wt]||[],[hr]:r[cr]},afterValue:{value:o[wt]||[],[hr]:o[cr]},[Tr]:this[Cr][Tr]}),h=null===(i=o[fi])||void 0===i?void 0:i.filter((e=>{var i;return!(null!==(i=r[fi])&&void 0!==i&&i.includes(e))})),u=null===(t=r[fi])||void 0===t?void 0:t.filter((e=>{var i;return!(null!==(i=o[fi])&&void 0!==i&&i.includes(e))})),v=n()(l.Fragment,{},void 0,null==u?void 0:u.map((e=>{const i=this[Qt]({[rt]:V.iU,id:e,[hr]:o[cr]});return i&&this[jt](i)})),null==h?void 0:h.map((e=>{const i=this[Qt]({[rt]:V.iU,id:e,[hr]:o[cr]});return i&&n()(X.ZP,{[fr]:i,[Tr]:this[Cr][Tr]})})));return n()("div",{},void 0,n()("div",{[ot]:{...R.v[Qi](this[$i]),[Mi]:2}},void 0,a),c,v)}renderCollectionPropertyChangedDiff(e){if(!e||!e[ar]||!e[vr])return;const{[ar]:i,[vr]:t}=e,r=b.getAllModificationsToSelectOptions({[ar]:i,[vr]:t});if(!r)return;const{newOptions:s,modifiedOptions:d,removedOptions:a}=r;if([s,d,a].every((e=>0===e[it])))return;const c=e=>{let{[hi]:i,[ci]:t=!1}=e;const r=(0,C.KR)(this[$i],null==i?void 0:i.color);return l[Ii](we.Z,o()({},r,{[ci]:t}),i.value)};return n()(X.Hq,{labeled:!0,[ir]:t[ir],icon:t.icon,[pr]:t[pr]},void 0,n()("div",{[ot]:{[Ui]:li,[ai]:di,rowGap:4}},void 0,s[it]>0&&n()("div",{[ot]:{[Ui]:"inline-flex",[ni]:"center",columnGap:4}},void 0,n()(N.FormattedMessage,{[Yi]:"Added",id:"Edit.renderCollectionPropertyChangedDiff.addedProperty"}),s.map((e=>n()("span",{},e.id,c({[hi]:e}))))),a[it]>0&&n()("div",{[ot]:{[Ui]:"inline-flex",[ni]:"center",columnGap:4}},void 0,n()(N.FormattedMessage,{[Yi]:"Removed",id:"Edit.renderCollectionPropertyChangedDiff.removedProperty"}),a.map((e=>n()("span",{},e.id,c({[hi]:e,[ci]:!0}))))),d[it]>0&&n()("div",{[ot]:{[Ui]:"flex",[li]:1,[ai]:"row"}},void 0,n()("span",{},void 0,n()(N.FormattedMessage,{[Yi]:"Edited",id:"Edit.renderCollectionPropertyChangedDiff.editedProperty"})),n()("div",{[ot]:{[Ui]:"flex",[ai]:"column"}},void 0,d.map((e=>n()("span",{[ot]:{[Ui]:"inline-flex",[ni]:"center"}},e[ar].id,n()("span",{[ot]:{[si]:4}},void 0,c({[hi]:e[ar],[ci]:!0})),n()("span",{[ot]:{[oi]:"0px 8px"}},void 0,B.Z.historyForward({[ri]:10,[ti]:10,fill:this[$i][ii]})),c({[hi]:e[vr]}))))))))}[ei](e,i){if(!i||!i[ar]&&!i[vr])return;const t=i[ar]&&i[ar][Qe]||[],r=i[vr]&&i[vr][Qe]||[];return n()(X.Hq,{labeled:!0,[ir]:n()(N.FormattedMessage,{[Yi]:$e,id:"edit.descriptionPropertyChanged.label"}),icon:void 0,[pr]:wt},void 0,n()(Ze.Z,{[br]:{[pr]:wt,[ir]:""},beforeValue:{value:t,[hr]:e},afterValue:{value:r,[hr]:e},[Tr]:this[Cr][Tr]}))}[Ye](e){if(e)return n()(X.Hq,{labeled:!0,[ir]:n()(N.FormattedMessage,{[Yi]:$e,id:"edit.descriptionPropertyCreated.label"}),[pr]:wt,icon:void 0},void 0,n()(Ze.Z,{[br]:{[pr]:wt,[ir]:""},beforeValue:{value:[],[hr]:e[hr]},afterValue:e,[Tr]:this[Cr][Tr]}))}[mt](e){const i=(this[Pi](e,"title")||this[Pi](e,"source"))&&n()(y.Z,{[Ri]:n()(N.FormattedMessage,{[Yi]:"Bookmark",id:"edit.bookmarkBlockPropertyChanged.label"}),[$i]:this[$i]},void 0,this[Ni](e),this[lr](e,"link",!0));return n()(l.Fragment,{},void 0,i,this[Pi](e,"caption")&&n()("div",{[ot]:{[Mi]:i?4:0}},void 0,this[Bi](e)))}[ht](e){const i=(0,w.getDriveBlockProperties)(e[ur][ar][mr]),t=e[ur][vr][mr],r=i!==(0,w.getDriveBlockProperties)(t);return n()(l.Fragment,{},void 0,r&&"drive"===t[pr]&&n()(X.ZP,{[fr]:t,[Tr]:this[Cr][Tr]}))}renderPageBlockChanged(e){const i=v.getChangedBlockProperties({[ar]:e[ur][ar][mr],[vr]:e[ur][vr][mr],schema:e[Xe]}),t=v[Je]({[ar]:e[ur][ar][mr],[vr]:e[ur][vr][mr]});return n()("div",{},void 0,i.map(((i,t,r)=>n()("div",{},i,this[lr](e,i,!0)))),t.map(((t,r,o)=>{const s=0===i[it]&&0===r,d=r===o[it]-1;return n()("div",{[ot]:{[Wi]:s?6:10,[Mi]:d?0:6}},t,n()(ye,{formatProperty:t,edit:e}))})))}[vt](e){return null}[at](e){const i=e[ur][ar][mr],t=e[ur][vr][mr],r=v[je]({[ar]:i,[vr]:t});return n()("div",{[ot]:{[Ui]:li,[ni]:"stretch",[ai]:di}},void 0,r.map((e=>{const r=i[tt]&&e in i[tt]?i[tt][e]:void 0,o=t[tt]&&e in t[tt]?t[tt][e]:void 0,s=W.renderCellValueForActivity({[rr]:this[rr],cellValue:r,[hr]:i[cr],[vi]:this[Cr][Tr],[$i]:this[$i]}),d=W.renderCellValueForActivity({[rr]:this[rr],cellValue:o,[hr]:t[cr],[vi]:this[Cr][Tr],[$i]:this[$i]});return n()("div",{[ot]:{[Ui]:li,border:`1px solid ${this[$i][Ke]}`,overflowWrap:"anywhere",[ri]:"max-content",maxWidth:"100%",[We]:"top",[Di]:H.Z[Di][qe].desktop,[oi]:4,[Mi]:4}},void 0,n()("span",{[ot]:{...R.v[Xi],[Mi]:void 0}},void 0,s),r&&o&&B.Z.historyForward({[ri]:12,[ti]:12,fill:this[$i][ii],alignSelf:"center",margin:4}),n()("span",{[ot]:{...R.v[et]}},void 0,d))})))}[wi](e){const i=this[yi](e);return n()("span",{[ot]:{wordBreak:Ge}},void 0,i)}[Ht](e){return n()("div",{[ot]:{...R.v[Re],...R.v[et],[Wi]:3,[Mi]:3}},void 0,n()("div",{},void 0,this[Ne](e)),n()("div",{},void 0,this[Le](e[He])))}[Ot](e){return n()("div",{[ot]:{...R.v[Re],...R.v[Xi]}},void 0,n()("div",{},void 0,this[Ne](e)),n()("div",{},void 0,this[Le](e[He])))}[It](e){return n()("div",{[ot]:R.v[Re]},void 0,n()("div",{},void 0,this[Ne](e)),n()("div",{},void 0,n()("div",{[ot]:R.v.diffWrapStyle},void 0,this[Le](e[He][ar]),n()("div",{[ot]:{[oi]:"0px 8px"}},void 0,B.Z.historyForward({[ri]:14,[ti]:14})),this[Le](e[He][vr]))))}[Dt](e){var i;return((null===(i=e[He])||void 0===i?void 0:i.calculated_changes)||[]).map(((i,t)=>{let[r,o]=i;const s={timestamp:e.timestamp,[cr]:e[cr],[pr]:zt,[He]:{[ar]:r,[vr]:o}};return n()(l.Fragment,{},`inheritance-change-${t}`,this[It](s))}))}[Et](e){const i=e[Ie][ze]||[],t=a().compact(i.map((e=>this[Qt]({[rt]:A.KJ,id:e}))));if(0!==t[it])return n()("div",{},void 0,t.map((e=>n()("div",{[ot]:{...R.v.groupStyle,...R.v[et],[Wi]:3,[Mi]:3}},e.id,(0,L.Nz)(this[Cr].intl,e)))))}[Bt](e){const i=e[Ie][ze]||[],t=a().compact(i.map((e=>this[Qt]({[rt]:A.KJ,id:e}))));if(0!==t[it])return n()("div",{},void 0,t.map((e=>n()("div",{[ot]:{...R.v.groupStyle,...R.v[Xi]}},e.id,(0,L.Nz)(this[Cr].intl,e)))))}[Ft](e){const i=e[Ie][ar][ze]||[],t=e[Ie][vr][ze]||[],r=(0,M.E)(i,t),o=a().compact(r.created.map((e=>this[Qt]({[rt]:A.KJ,id:e})))),s=a().compact(r.deleted.map((e=>this[Qt]({[rt]:A.KJ,id:e}))));if(0!==o[it]||0!==s[it])return n()("div",{},void 0,o.map((e=>n()("div",{[ot]:{...R.v.groupStyle,...R.v[et],[Wi]:3,[Mi]:3}},e.id,(0,L.Nz)(this[Cr].intl,e)))),s.map((e=>n()("div",{[ot]:{...R.v.groupStyle,...R.v[Xi]}},e.id,(0,L.Nz)(this[Cr].intl,e)))))}[Le](e){const i=e.role??"none",t=(0,F.getMessageForPermissionRole)(i,void 0);return t?n()("div",{[ot]:R.v.getRoleStyle()},void 0,this[Cr].intl[Ae](t)):void 0}[Ne](e){const i="permission-changed"===e[pr]?e[He][vr]:e[He];if((0,S.isUserPermission)(i)){const e=this[Qt]({[rt]:A.KJ,id:i.user_id}),t=(0,L.Nz)(this[Cr].intl,e);return n()("div",{[ot]:R.v[Oe]},void 0,n()("div",{[ot]:R.v[Ue](this[$i])},void 0,t))}if((0,S.isSpacePermission)(i)){const i=this[Qt]({[rt]:U.bx,id:e[cr]}),t=i?i[ir]:n()(N.FormattedMessage,{[Yi]:"Unknown",id:"edit.unknownSpacePermissionTarget.label"});return n()("div",{[ot]:R.v[Oe]},void 0,n()("div",{[ot]:R.v[Ue](this[$i])},void 0,t))}if((0,S.isPublicPermission)(i))return n()("div",{[ot]:R.v[Oe]},void 0,n()("div",{[ot]:R.v[Ue](this[$i])},void 0,n()(N.FormattedMessage,{[Yi]:"Published link",id:"edit.publishToWebPermissionTarget.label"})));if((0,S.isGroupPermission)(i)){const t=this[Qt]({[rt]:U.bx,id:e[cr]}),r=(t&&t[_e]||[]).find((e=>e.id===i.group_id)),o=r&&r[ir]||n()(N.FormattedMessage,{[Yi]:"Deleted group",id:"edit.deletedPermissionGroup.label"});return n()("div",{[ot]:R.v[Oe]},void 0,n()("div",{[ot]:R.v[Ue](this[$i])},void 0,o))}if((0,S.isBotPermission)(i)){const t=this[Qt]({[rt]:D.cZ,id:i.bot_id,[hr]:e[cr]}),r=(0,f.Mh)(t);return n()("div",{[ot]:R.v[Oe]},void 0,n()("div",{[ot]:R.v[Ue](this[$i])},void 0,r))}if((0,S.isExplicitBlockTeamPermission)(i)){const t=this[Qt]({[rt]:O.e0,id:i.team_id,[hr]:e[cr]});let r=n()(N.FormattedMessage,{[Yi]:"Members of an unknown teamspace",id:"edit.teamMemberPermissionChanged.unknownTeam"});return null!=t&&t[ir]&&(r=n()(N.FormattedMessage,{[Yi]:"Members of {teamName}",id:"edit.teamMemberPermissionChanged.knownTeam",values:{teamName:t[ir]}})),n()("div",{[ot]:R.v[Oe]},void 0,n()("div",{[ot]:R.v[Ue](this[$i])},void 0,r))}if((0,S.isExplicitBlockTeamOwnerPermission)(i)){const t=this[Qt]({[rt]:O.e0,id:i.team_id,[hr]:e[cr]});let r=n()(N.FormattedMessage,{[Yi]:"Owners of an unknown teamspace",id:"edit.teamOwnerPermissionChanged.unknownTeam"});return null!=t&&t[ir]&&(r=n()(N.FormattedMessage,{[Yi]:"Owners of {teamName}",id:"edit.teamOwnerPermissionChanged.knownTeam",values:{teamName:t[ir]}})),n()("div",{[ot]:R.v[Oe]},void 0,n()("div",{[ot]:R.v[Ue](this[$i])},void 0,r))}}[Yt](e){const{edit:i,[$t]:t,hideAuthorName:r}=e,o=this[Qt]({[rt]:_.x_,id:i.comment_id,[hr]:i[cr]}),s=Boolean(i[De]&&o&&(0,T.P)(x.kk.fromValue(_.x_,i[De]),x.kk.fromValue(_.x_,o)));if(o)return n()("div",{[ot]:R.v[st]},void 0,this.renderComment({commentValue:o,[$t]:t,showEditedBadge:s,hideAuthorName:r}))}[Xt](e){return n()("div",{[ot]:R.v[st]},void 0,this.renderCommentDiff(e[De]))}[Jt](e,i){const t=this[Qt]({[rt]:_.x_,id:e.comment_id,[hr]:e[cr]}),r=e[De]||t;if(r)return n()("div",{[ot]:{...R.v[st],...R.v[Xi]}},void 0,this.renderComment({commentValue:r,[$t]:i,showEditedBadge:!1,hideAuthorName:!1}))}renderCollectionPropertyChangedEdit(e){const i=this.renderCollectionPropertyChangedDiff(e[Ve]);return i?n()("div",{[ot]:{...R.v[st],paddingTop:6,[Ee]:4}},void 0,i):null}[Rt](e){return n()("div",{[ot]:R.v[st]},void 0,this[ei](e[cr],e[Se]))}[Nt](e){var i;const t=null===(i=e[Se])||void 0===i?void 0:i[Qe];return n()("div",{[ot]:R.v[st]},void 0,this[Ye](t&&{value:t,[hr]:e[cr]}))}renderMentionCreated(e){return this[Fe]({blockId:e[xe],[dr]:e[Be]})}renderPermissionGroupMentionCreated(e){return this[Fe]({blockId:e[xe],[dr]:e[Be]})}renderReminderCreated(e){return this[Fe]({blockId:e.reminder_block_id,[dr]:e.reminder_property})}[Fe](e){const i=this[Qt]({[rt]:V.iU,id:e.blockId});if(i){const r=(0,Z.ky)({block:i,[Qt]:this[Qt]});if(r){const t=k.getNormalizedSchema(r),o=this[kr](i,e[dr],!0,t);if(o)return n()("div",{[ot]:{...R.v[st]}},void 0,o)}else{var t;const e=null===(t=i[tt])||void 0===t?void 0:t[Ri],r={...i,[tt]:{...i[tt],[Ri]:this[Cr].highlightCurrentUser&&e?this[ki](e):e}},o=n()(X.ZP,{[fr]:r,[Tr]:this[Cr][Tr]});if(o)return n()("div",{[ot]:R.v[st]},void 0,o)}}}[ki](e){const i=[],t=this[rr][or];return I.getTokens(e).forEach((e=>{if(I.isMentionToken(e)){const r=[];for(const i of I.getMentionTokenAnnotations(e)){const e=I.isUserAnnotation(i)&&i[1]===t.id,o=I.isGroupAnnotation(i)&&this.currentUserIsMemberOfGroup(i[1],i[2]);e||o?(r.push(i),r.push([I.annotationType.Highlight,"yellow_background"])):r.push(i)}i.push([e[0],r])}else i.push(e)})),i}currentUserIsMemberOfGroup(e,i){var t,r;const o=this[rr][or].id;if(!o)return!1;const s=this[Qt]({[rt]:U.bx,id:i});return new Set(null==s||null===(t=s[_e])||void 0===t||null===(r=t.find((i=>i.id===e)))||void 0===r?void 0:r[ze]).has(o)}getBlockSchema(e){return e[Xe]?k.getNormalizedSchemaFromBlockEdit(e):k[Pe](this[Cr].intl)}[Ei](e){const i=e&&e[tt]&&e[tt][Vi];if(!i)return n()(N.FormattedMessage,{[Yi]:"Code",id:"edit.codeBlockChanged.label"});const t=b.toSelectValue(i,k.codeLanguageOptions);return n()(N.FormattedMessage,{[Yi]:"Code - {codeLanguage}",values:{codeLanguage:t},id:"edit.codeBlockWithLanguageChanged.label"})}[yi](e){const i=e&&e[tt]&&e[tt].source;return b.toUrlValue(i)}hasProperty(e,i){return Boolean(e&&e[tt]&&e[tt][i])}[Pi](e,i){return!a().isEqual(e[ur][ar][mr]&&e[ur][ar][mr][tt]&&e[ur][ar][mr][tt][i],e[ur][vr][mr]&&e[ur][vr][mr][tt]&&e[ur][vr][mr][tt][i])}}wr.displayName="Edit";const Zr=(0,N.injectIntl)(wr)},46096:(e,i,t)=>{t.d(i,{Z:()=>s});var r=t(49085);class o extends r.default{getInitialState(){return{open:!1}}}const s=new o}}]);