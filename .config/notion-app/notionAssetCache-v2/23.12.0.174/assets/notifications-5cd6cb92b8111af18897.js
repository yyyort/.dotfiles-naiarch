"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[1909],{74725:(e,t,o)=>{o.d(t,{O:()=>s});var i=o(67294);const n=o(85).p06,a=o(85).Z97,d=o(85).EmK,r=o(85).iDK;function s(e){let{closeHandler:t,ref:o,active:s,excludedSelectors:l,ignoreKeydown:c}=e;const p=(0,i.useRef)(void 0);(0,i.useEffect)((()=>{if(s){const e=e=>{0===e.button&&e.target instanceof Node?p[r]=e.target:p[r]=void 0},i=e=>{const i=o[r],n=e.target,a=p[r];if(p[r]=void 0,i&&n){for(const e of l||[]){const t=document.querySelectorAll(e);for(let e=0;e<t.length;++e){if(t[e].contains(n))return}}a&&(i===a||i.contains(a))||i===n||i.contains(n)||t()}},s=e=>{c||"Esc"!==e.key&&"Escape"!==e.key||t()};return window[d](a,e),window[d]("click",i),window[d]("keydown",s),()=>{window[n](a,e),window[n]("click",i),window[n]("keydown",s)}}}),[t,o,s,l,c])}},13018:(e,t,o)=>{o.d(t,{J:()=>lt});var i=o(97464),n=o.n(i),a=o(77094),d=o.n(a),r=o(96486),s=o(67294),l=o(74725),c=o(480),p=o(81954),u=o(24405),g=o(7057),m=o(42875),v=o(3909),y=o(80503),b=o(82990),f=o(5366),S=o(54564),w=o(96514),h=o(43250),x=o(78089),Z=o(33929),C=o(65598),k=o(77546),_=o(45094),T=o(34859),M=o(79315),P=o(24229),I=o(29798),K=o(7011),F=o(32163),V=o(18647),B=o(74647),O=o(4708),R=o(6128),U=o(81258),D=o(52275),A=o(89728),E=o(44532),L=o(72495),z=o(64921);const N=o(85).nx5,W=o(85).xZ7,H=o(85).AlG,$=o(85).jkI,G=o(85).ChN,q=o(85).oms,Y=o(85).lWm,J=o(85).L_E;function j(){window.__c={n:"UpdateSidebarTabCommentsSegmentedControl"};const e=(0,p.VK)((()=>K.ZP.state.commentsMode),[]),t=(0,u.yK)((e=>({[J]:{background:e[Y],width:"calc(100% - 32px)",height:36,borderRadius:10,display:"flex",margin:"10px 16px 6px 16px",marginTop:20,padding:4,gap:2,pointerEvents:"auto"},[q]:{borderRadius:8,fontSize:13,[G]:b.Z[G].medium,textAlign:$,width:"100%",display:"flex",justifyContent:$,alignItems:$,lineHeight:1.8,color:e.regularTextColor,letterSpacing:-.08},[H]:{[G]:b.Z[G].semibold,background:e.segmentedControlActiveBackground,border:`0.5px solid ${e.outlineButtonBorder}`}})),[]);return d()("div",{style:t[J],className:h.updateSidebarTabCommentsSegmentedControl},void 0,d()(z.Z,{style:{...t[q],...e===K.F7.Unresolved?t[H]:{}},onClick:()=>{B[W](K.F7.Unresolved)}},void 0,d()("span",{},void 0,d()(f.FormattedMessage,{id:"updateSidebarTabCommentsSegmentedControl.option.open",[N]:"Open"}))),d()(z.Z,{style:{...t[q],...e===K.F7.Resolved?t[H]:{}},onClick:()=>{B[W](K.F7.Resolved)}},void 0,d()("span",{},void 0,d()(f.FormattedMessage,{id:"updateSidebarTabCommentsSegmentedControl.option.resolved",[N]:"Resolved"}))))}const Q=o(85).wJk,X=o(85).ccq,ee=o(85).ESK,te=o(85).PG2,oe=o(85)._lc,ie=o(85).LtW,ne=o(85).xZ7,ae=o(85).lGm,de=o(85).BQ6,re=o(85).Yzm,se=o(85).D7I,le=o(85).rpY,ce=o(85).jkI,pe=o(85).UPJ,ue=o(85).EMU,ge=o(85).L_E,me=o(85).tDk,ve=o(85).nx5,ye=[K.F7.Unresolved,K.F7.Resolved],be={[K.F7.Unresolved]:h.updateSidebarTabCommentsDropdownButtonOpen,[K.F7.Resolved]:h.updateSidebarTabCommentsDropdownButtonResolved},fe=(0,f.defineMessages)({[K.F7.Unresolved]:{id:"updateSidebar.comments.mode.unresolvedOption",[ve]:"Open comments"},[K.F7.Resolved]:{id:"updateSidebar.comments.mode.resolvedOption",[ve]:"Resolved comments"}}),Se=(0,f.defineMessages)({[K.F7.Unresolved]:{id:"updateSidebar.comments.filter.button.unresolvedMode",[ve]:"Open"},[K.F7.Resolved]:{id:"updateSidebar.comments.filter.button.resolvedMode",[ve]:"Resolved"}});function we(){window.__c={n:"UpdateSidebarCommentsFilterControl"};return(0,c.O7)().device.isMobile?d()(j,{}):d()(he,{})}function he(){window.__c={n:"DesktopUpdateSidebarCommentsFilterControl"};const[e,t]=(0,s.useState)(!1),{commentsMode:o}=(0,p.Kw)(K.ZP),i=(0,p.VK)((()=>M.default.state[me]),[]),a=(0,p.VK)((()=>(0,O.getNotificationSettingsEntryPointsVariant)()),[]),r=(0,u.yK)((e=>({[ge]:{display:ue,flexDirection:"column"},commentsHeader:{display:ue,[pe]:"space-between",borderBottom:`1px solid ${e.regularDividerColor}`,alignItems:ce,pointerEvents:"auto"},label:{fontSize:14,color:e.regularTextColor,fontWeight:b.Z.fontWeight.medium,display:ue,alignItems:ce,padding:"12px 12px 12px 16px"},toggleButton:{[pe]:ce,display:ue,color:e.mediumTextColor},toggleButtonContainer:{paddingLeft:12,paddingRight:8,display:ue},chevronIcon:{width:10,marginLeft:4,fill:e.lightIconColor},getNotifiedContainer:{paddingRight:6,paddingLeft:6}})),[]),l=(0,s.useCallback)((()=>d()(F.Z,{type:F.i.Vertical,initialFocus:void 0,sections:[{key:"commentFilter",[le]:e=>s[se](L.Z,e),items:ye.map((e=>({key:e,[le]:t=>s[se](D.Z,n()({},t,{[ae]:be[e],title:Z.default[re](fe[e]),right:d()("div",{[de]:{width:14,opacity:o===e?1:0}},void 0,v.Z.check())})),action:()=>{B[ne](e),t(!1)}})))}]})),[o]);return s[se](s.Fragment,null,d()("div",{[de]:r[ge]},void 0,"variant_2"===a&&i&&d()("div",{[de]:r.getNotifiedContainer},void 0,d()(R.n,{navigableBlock:i,from:"comments_tab",[ie]:U.Z})),d()("div",{[de]:r.commentsHeader,[ae]:h.updateSidebarTabCommentsHeader},void 0,d()("div",{[de]:r.label},void 0,d()(f.FormattedMessage,{id:"updateSidebar.header.commentsLabel",[ve]:"Comments"})),d()("div",{[de]:r.toggleButtonContainer,[ae]:h.updateSidebarTabCommentsDropdownControl},void 0,d()(E.ZP,{popupType:E.ZP[oe].Popup,open:e,origin:d()(A.Z,{[de]:r.toggleButton,[te]:()=>{t(!0)}},void 0,Z.default[re](Se[o]),v.Z.chevronDown(r.chevronIcon)),[X]:E.ZP[ee].Bottom,alignmentToOrigin:E.ZP.Alignment.Center,originGap:4,[le]:l,[Q]:()=>{t(!1)}})))))}var xe=o(21202),Ze=o(77907),Ce=o(35973),ke=o(39098),_e=o(28992);const Te=o(85).vIB,Me=o(85).Tay,Pe=o(85).Mor,Ie=o(85).GGR,Ke=o(85).gdQ,Fe=o(85).XNW,Ve=o(85).GID,Be=o(85).a$o,Oe=s.forwardRef(((e,t)=>{window.__c={n:"UpdateSidebarDiscussionItem"};const{currentBlockStore:o,discussion:i,showAllRepliesAfterTimestamp:n,focused:a,isLast:r,location:l}=e,g=(0,p.VK)((()=>P.Z.state.open&&P.Z.state[Be]||[]),[]),m=(0,c.O7)();(0,s.useEffect)((()=>{var e,t;if(a){Ce.Z.setState({source:"update_sidebar",[Be]:[i.id]});const e=setTimeout((()=>{var e,t;(null===(e=Ce.Z.state)||void 0===e||null===(t=e[Be])||void 0===t?void 0:t[0])===i.id&&w.markDiscussionsOnPageInteractedWith([i.id])}),1500);return()=>{clearTimeout(e)}}(null===(e=Ce.Z.state)||void 0===e||null===(t=e[Be])||void 0===t?void 0:t[0])===i.id&&Ce.Z.setState({[Be]:[]})}),[a,i,m]);const v=(0,p.VK)((()=>{var e;return(null===(e=Ce.Z.state)||void 0===e?void 0:e[Be])||[]}),[]),y=i.id,{parentId:b,[Ve]:f}=(0,p.VK)((()=>({parentId:i.getParentId(),[Ve]:i.getSpaceId()})),[i]),S=b?ke.G.createChildStore(i,{table:xe.iU,id:b}):void 0,Z=g.includes(y),C=v.includes(y),k=(0,u.yK)((e=>({discussionContainer:{paddingTop:m.device.isMobile?4:10,borderBottom:r||m.device.isMobile?void 0:`1px solid ${e.regularDividerColor}`,transition:"background 300ms ease"},replyButton:{color:e.blueColor,[Fe]:23,fontSize:14},[Ke]:{background:"sidebar"===l?e.hoveredDiscussionBackground:void 0},pressedStyle:{background:"sidebar"===l?e.focusDiscussionBackground:void 0}})),[l,r,m]);if(!S||!f)return null;const _=s.createElement("div",{className:`sidebar-discussion-${y} ${h.updateSidebarTabCommentsDiscussionItem}`,onClick:e.onClick,[Ie]:e[Ie],ref:t,style:{...k.discussionContainer,...a||C?k[Ke]:{},...Z?k.pressedStyle:{}}},d()(Ze.LazyDiscussion,{store:i,blockStore:o,format:x.O2.Sidebar,isFirst:!1,isOnly:!1,[Me]:!1,[Te]:Pe,showAllRepliesAfterTimestamp:n}));return d()(_e.Z,{allowTextSelection:!0,title:_,style:{[Fe]:-14,marginRight:-14,width:"calc(100% + 28px)",lineHeight:void 0,cursor:"pointer"}})})),Re=o(85).gdQ,Ue=o(85).a$o;function De(e){window.__c={n:"UpdateSidebarDiscussionSection"};const{firstItemId:t}=e,o=(0,p.VK)((()=>{var e;return null===(e=Ce.Z.state)||void 0===e?void 0:e[Ue].some((e=>e===t))}),[t]),i=(0,p.VK)((()=>P.Z.state.open&&P.Z.state[Ue]&&P.Z.state[Ue].some((e=>e===t))),[t]),a=(0,u.yK)((t=>({[Re]:{background:"sidebar"===e.location?t.hoveredDiscussionBackground:void 0},pressedStyle:{background:"sidebar"===e.location?t.focusDiscussionBackground:void 0},basicDesktopTitleStyle:{paddingLeft:16,paddingTop:16,marginBottom:0,marginTop:0,fontSize:12,transition:"background 300ms ease"},mobileTitleStyle:{fontSize:13,fontWeight:b.Z.fontWeight.medium,paddingBottom:0,textTransform:"unset",marginTop:-12}})),[e.location]);return s.createElement(L.Z,n()({desktopTitleStyle:{...a.basicDesktopTitleStyle,...o?a[Re]:{},...i?a.pressedStyle:{}},mobileTitleStyle:a.mobileTitleStyle,disableDesktopPadding:!0,disableMobileBorders:!0},e))}var Ae=o(70268);const Ee=o(85).nLT,Le=o(85).j7K,ze=o(85).tw8,Ne=o(85).l9D,We=o(85).Omf,He=o(85).y79,$e=o(85).ttt,Ge=o(85).D7I,qe=o(85).nx5,Ye=o(85).ChN,Je=o(85).vj5,je=o(85).tge,Qe=o(85).g7N,Xe=o(85).X_m,et=o(85).jms,tt=o(85).qc1,ot=o(85).GmX,it=o(85).xOW,nt=o(85).$bT,at=o(85).jkI,dt=o(85).Sgw,rt=o(85).tDk,st=new I.Z;function lt(e){window.__c={n:"UpdateSidebarTabComments"};const{timeMounted:t,location:o}=e,i=(0,c.O7)(),[a,I]=(0,s.useState)(!1),B=(0,p.VK)((()=>M.default.state[rt]),[]),O=(0,p.VK)((()=>i.currentUser.id),[i]),R=(0,p.VK)((()=>(0,x.DF)({blockStore:B,ignoreAfterTime:t,[dt]:O})),[B,t,O]),[U]=(0,p.AF)(K.ZP),D=(0,p.VK)((()=>(0,_.isUpdateSidebarInPopOutMode)(i)),[i]),A=(0,p.VK)((()=>P.Z.state.open&&P.Z.state.discussionIds||[]),[]),{resolved:E,unresolved:L}=(0,p.VK)((()=>(0,C.partitionDiscussionStoresByResolvedStatus)(R)),[R]),z=U.commentsMode===K.F7.Unresolved,N=z?L:E,W=N.map((e=>e.id));(0,s.useEffect)((()=>{if("popup"===o&&a)return()=>{w.markDiscussionsOnPageInteractedWith(W)}}),[o,W,a]);const H=(0,u.yK)((e=>({commentsEmptyStyle:{flex:1,display:"flex",alignItems:at,justifyContent:at,[nt]:"column",textAlign:at,color:e.mediumTextColor,fontSize:14,position:it,background:e[ot],marginRight:D?2:0,[tt]:"auto",paddingTop:10},commentsContentStyle:{position:it,[et]:0,display:"flex",[nt]:"column",background:e[ot],marginRight:D?2:0,[tt]:"auto",[Xe]:"100%"},commentsIconStyle:{[Xe]:54,width:54,[Qe]:12,fill:e.mediumIconColor}})),[D]),$=(0,s.useRef)(null),G=(0,p.VK)((()=>(0,_.updateSidebarIsExpanded)(i)),[i]);(0,l.O)({active:G,closeHandler:S[je],ref:$});const q=(0,p.VK)((()=>{const e=r.groupBy(N,(e=>{const t=(0,x.Qg)({recordStore:e,[dt]:O});return t?(0,g.$6)(t.getCreatedTime()):""}));return delete e[""],e}),[N,O]),Y=(0,p.VK)((()=>(0,x.W5)(N)),[N]);if((0,s.useEffect)((()=>{a||Y||I(!0)}),[a,Y]),!B||!q||!a)return d()(Ae.B,{areaHeight:window[Je]});if(0===N.length)return d()("div",{style:H.commentsContentStyle},void 0,d()(we,{}),d()("div",{style:H.commentsEmptyStyle},void 0,v.Z.commentSidebarZero(H.commentsIconStyle),d()("div",{style:{[Ye]:b.Z[Ye].semibold,[Qe]:4}},void 0,d()(f.FormattedMessage,z?{id:"updateSidebar.commentContainer.emptyTitleUnresolved",[qe]:"No open comments yet"}:{id:"updateSidebar.commentContainer.emptyTitleResolved",[qe]:"No resolved comments yet"})),d()("div",{style:{width:200,alignSelf:at}},void 0,d()(f.FormattedMessage,z?{id:"updateSidebar.commentContainer.emptyUnresolved",[qe]:"Open comments on this page will appear here"}:{id:"updateSidebar.commentContainer.emptyResolved",[qe]:"Resolved comments on this page will appear here"}))));const J=Object.keys(q).sort().reverse(),j=J.map(((e,a)=>{const d=(0,g.ZV)({value:{type:"date",start_date:e},date_format:it,userTimeZone:(0,m.r)(),intl:Z.default.getIntl(),allowRelativeDates:!0}),r=q[e];return{key:e,render:e=>s[Ge](De,n()({title:d,firstItemId:r[0].id,location:o},e)),items:r.map(((e,d)=>({key:e.id,render:i=>s[Ge](Oe,n()({},i,{[$e]:B,discussion:e,isFirstInSection:0===d,location:o,isLast:d===r.length-1&&a===J.length-1,showAllRepliesAfterTimestamp:t})),action:()=>{w.openDiscussionId({discussionId:e.id,[$e]:B,environment:i,analyticsFrom:"updates_sidebar",currentEl:$.current})}})))}})),Q=j.flatMap((e=>e.items)).findIndex((e=>A.includes(e.key.toString())));return s[Ge]("div",{style:H.commentsContentStyle,ref:$},d()(we,{}),d()(V.Z,{type:T.Z.Y,style:{flexGrow:1,[et]:0,transform:"translateZ(0px)",zIndex:1,overflow:"hidden auto",[Qe]:0},className:h.updateSidebarTabCommentsCommentsScroller},void 0,d()(F.Z,{disableKeyboard:!0,store:st,type:F.i[He],[Le]:Q>=0?Q:void 0,[Ee]:e=>{if(e instanceof Element){const t=e[We](),o=y.R6(i.device[Ne]),n=window[Je],a=o+50,d=n-a;if(t[Xe]>=d)return;const r=t.top>=a&&t.top<=n,s=r&&t[ze]>=n,l=t[ze]>=a&&t[ze]<=n,c=l&&t.top-a<0,p=r||l,u=.4*t[Xe];s&&Math.abs(t.top-n)<u?(0,k.Wr)(e,{edgeDist:n-t[Xe]-a,animate:!0}):c&&Math.abs(t[ze]-a)<u?(0,k.Wr)(e,{edgeDist:0,animate:!0}):p||(0,k.Wr)(e,{edgeDist:0,animate:!0})}},sections:j})))}},6128:(e,t,o)=>{o.d(t,{n:()=>N});var i=o(77094),n=o.n(i),a=o(67294),d=o(81954),r=o(24405),s=o(82990),l=o(5366),c=o(4708),p=o(97464),u=o.n(p),g=o(480),m=o(3909),v=o(62967),y=o(19719),b=o(48019),f=o(31945),S=o(78140),w=o(89728),h=o(72495),x=o(87279),Z=o(98742),C=o(10161),k=o(9919),_=o(57538);const T=o(85).j7K,M=o(85).D7I,P=o(85).PlO,I=o(85).Ixx,K=o(85).EJF,F=o(85).eu,V=o(85).wgE,B=o(85).WAx,O=o(85).LtW,R=o(85).hDW;function U(e){var t;window.__c={n:"GetNotifiedDropdown"};const{[R]:o,from:i,[O]:l}=e,p=e.moreProminentStyling??!1,U=(0,g.O7)(),D=(0,d.VK)((()=>o.isPageBlock()),[o]),A=(0,d.VK)((()=>o.getFollowSettingsKey()),[o]),E=(0,d.VK)((()=>(0,c.isGetNotifiedMenuCopyChangesEnabled)()),[]),L=(0,a.useCallback)((()=>y[B]({[V]:U,pageId:o.pointer.id,isCurrentlyFollowing:(0,_.Z)(A).following,from:"page_updates"===i?"page_updates":void 0})),[o.pointer.id,U,A,i]),z=(0,d.VK)((()=>C.default.checkGate(F)?k.CA({followSettingsKey:A,[V]:U,[R]:o,from:i,useCopyChanges:E}):k.Zk({followSettingsKey:A,[V]:U,[R]:o,from:i})),[A,U,o,i,E]),N=(0,r.yK)((e=>({[K]:{display:"flex",alignItems:"center",color:e.mediumTextColor,padding:p?"4px 10px":4,borderRadius:3,marginRight:p?0:4,fontSize:s.Z.fontSize.UIRegular.desktop},bellIcon:{width:14,height:14,marginRight:4},chevronIcon:{marginLeft:4,width:10,height:10},spacer:{flexGrow:1},footerLabel:{padding:12,backgroundColor:e[I],boxShadow:`0 -1px 0 ${e.regularDividerColor}`,marginTop:1}})),[p]),W=null===(t=z.find((e=>k.t0({key:e.action.analyticsName,userSelectedKey:A}))))||void 0===t?void 0:t.title;return D?n()(f.ZP,{popupType:f.Z4.Popup,alignmentToOrigin:f.vR.End,placementToOrigin:f.pO.Bottom,sameWidthAsOrigin:p,[O]:l,render:e=>n()(S.Z,{menuType:x.og.Popup,minWidth:290,maxHeight:"50vh"},void 0,n()(b.Z,{context:{blocks:[],[V]:U,[P]:void 0},sections:[(0,v.$J)({key:"in-app-notifications-section",render:e=>a[M](h.Z,e),actions:z.map((e=>e.action))})],[T]:void 0,onAccept:()=>e.close()})),renderOrigin:e=>a[M](w.Z,u()({},(0,Z.Z)(e,{onClick:L}),{style:N[K]}),m.Z.bell(N.bellIcon),W,p&&n()("div",{style:N.spacer}),m.Z.chevronDown(N.chevronIcon))}):null}const D=o(85).hDW,A=o(85).nx5,E=(o(85).iYq,o(85).GVv),L=o(85).L_E,z=o(85).LtW;function N(e){window.__c={n:"GetNotifiedFor"};const{navigableBlock:t,from:o,[z]:i}=e,a=(0,d.VK)((()=>(0,c.isGetNotifiedMenuCopyChangesEnabled)()),[]),p=(0,d.VK)((()=>t.isPageBlock()),[t]),u=(0,r.yK)((e=>({label:{fontSize:s.Z.fontSize.UIRegular.desktop,color:e.regularTextColor,fontWeight:s.Z.fontWeight.medium},[L]:{padding:"12px 8px 8px 10px"},border:{border:`1px solid ${e.outlineButtonBorder}`,borderRadius:3,marginTop:8}})),[]);return p?n()("div",{style:u[L]},void 0,n()("div",{style:u.label},void 0,n()(l.FormattedMessage,a?{id:E,[A]:"Page notification settings"}:{id:"UpdateSidebarTabUpdatesHeader.getNotifiedButton.label",[A]:"Get notified for"})),n()("div",{style:u.border},void 0,n()(U,{[D]:t,moreProminentStyling:!0,from:o,[z]:i}))):null}},72412:(e,t,o)=>{o.r(t),o.d(t,{GetNotifiedFor:()=>i.n,TopbarUpdatesMenu:()=>R,UpdateSidebar:()=>Mo});var i=o(6128),n=o(97464),a=o.n(n),d=o(77094),r=o.n(d),s=o(67294),l=o(81954),c=o(24405),p=o(5366),u=o(24809),g=o(78140),m=o(480),v=o(80503),y=o(82990),b=o(43250),f=o(81258);const S=new(o(61766).Z);var w=o(7011),h=o(66957);const x=o(85).Jg7,Z=o(85).LtW,C=o(85).LlE,k=o(85).nx5;function _(){return r()(p.FormattedMessage,{id:"updateSidebar.header.updatesLabel",[k]:"Updates"})}function T(e){window.__c={n:"UpdateSidebarTabUpdatesHeader"};const t=(0,m.O7)(),{enablePageAnalytics:o,popOutMode:n,navigableBlock:a,inPeekView:d}=e,s=(0,c.yK)((e=>({updatesHeaderStyle:{position:"relative",pointerEvents:"auto",marginTop:n?0:v.R6(t.device.isElectronMac),paddingTop:4,width:n&&!d?"calc(100% - 2px)":"100%",background:d?e.popoverBackground:e.contentBackground,[C]:"12px 12px 12px 16px",borderBottom:`1px solid ${e.regularDividerColor}`},label:{fontSize:14,color:e.regularTextColor,fontWeight:y.Z.fontWeight.medium}})),[n,t,d]),u=(0,l.VK)((()=>w.ZP.state.currentSubTab),[]),g=d?S:f.Z;return r()("div",{style:{...s.updatesHeaderStyle,...o?{[C]:"0 6px"}:{}},className:b.updateSidebarTabUpdatesHeader},void 0,r()(i.n,{navigableBlock:a,from:"page_updates",[Z]:g}),o?r()(h.Z,{tabs:[r()(_,{},"updates"),r()(p.FormattedMessage,{id:"updateSidebar.header.analyticsLabel",[k]:"Analytics"},x)],selectedIndex:u,onChange:e.onTabChange,style:{...s.label,[C]:0,boxShadow:"none"},tabStyle:{[C]:"12px 0"}}):r()("div",{style:s.label},void 0,r()(_,{})))}var M=o(87279);const P=o(85).Gqc,I=o(85).nx5,K=o(85).L_E,F=o(85).D7I,V=o(85).Mor,B=o(85).Wqi,O=o(85).hDW;function R(e){window.__c={n:"TopbarUpdatesMenu"};const{[O]:t,[B]:o}=e,i=function(e){const{[B]:t,[O]:o}=e,i=(0,l.VK)((()=>{var e,t;return(null==o||null===(e=o.getModel())||void 0===e?void 0:e.isCollectionView())?null===(t=o[P]())||void 0===t?void 0:t.id:void 0}),[o]);if(!t)return;const n=o.id,a=t.id;return{navigableBlockId:n,collectionId:i,spaceId:a}}({[O]:t,[B]:o});return i?r()(g.Z,{menuType:M.og.Popup,className:b.topbarUpdatesMenu,header:r()(T,{navigableBlock:t,enablePageAnalytics:!1,popOutMode:!0,inPeekView:!0})},void 0,s[F](u.Z,a()({key:t.id,empty:()=>r()(U,{}),source:V,navigableBlock:t},i))):null}function U(){window.__c={n:"EmptyState"};const e=(0,c.yK)((e=>({[K]:{marginTop:64,textAlign:"center",paddingLeft:18,paddingRight:18,marginBottom:64},content:{fontSize:14,color:e.mediumTextColor,marginTop:4}})),[]);return r()("div",{style:e[K]},void 0,r()("div",{style:e.content},void 0,r()("span",{},void 0,r()(p.FormattedMessage,{[I]:"No edits in this page yet.",id:"topbar.updatesButton.emptyState"}))))}var D=o(74725),A=o(97880),E=o(51454),L=o(50906),z=o(74647),N=o(81598),W=o(23063),H=o(37064),$=o(55064),G=o(70268),q=o(13018),Y=o(17126),J=o(45010),j=o(45094),Q=o(34859),X=o(79315),ee=o(18647),te=o(96486),oe=o.n(te),ie=o(16444),ne=o(13991),ae=o(7057),de=o(53877),re=o(3909),se=o(32056),le=o(54368),ce=o(77420),pe=o(19889),ue=o(62965),ge=o(16287),me=o(54642),ve=o(25320),ye=o(83420),be=o(20095),fe=o(65598),Se=o(33665),we=o(21115),he=o(35314),xe=o(77907),Ze=o(44904),Ce=o(39098),ke=o(31945),_e=o(73420),Te=o(68785),Me=o(63296),Pe=o(70301),Ie=o(64369),Ke=o(45653),Fe=o(67579),Ve=o(64536);const Be=o(85).ij9,Oe=o(85).NLk,Re=o(85).F7X,Ue=o(85).MLn,De=o(85).Scd,Ae=o(85).YGn,Ee=o(85).T9w,Le=o(85).nqn,ze=o(85).J1r,Ne=o(85).K4Y,We=o(85).ChN,He=o(85).D7I,$e=o(85).jYm,Ge=o(85).g7N,qe=o(85).TtP,Ye=o(85).dLQ,Je=o(85).Bn$,je=o(85).PG2,Qe=o(85).LlE,Xe=o(85).dMt,et=o(85).h8z,tt=o(85).mFu,ot=o(85).LZJ,it=o(85).z$9,nt=o(85).tvI,at=o(85)._Fe,dt=o(85).rps,rt=o(85).$bT,st=o(85).zDZ,lt=o(85).nx5,ct=o(85).BQ6,pt=o(85).Jkr,ut=o(85).X_m,gt=o(85).UPJ,mt=o(85).jkI,vt=o(85).H1U,yt=o(85).EMU,bt=o(85).sM5,ft=o(85).Gpy,St=o(85).MBf,wt=o(85).qJ8,ht=o(85).zwx,xt=o(85).xre,Zt=o(85).Ql2,Ct=o(85).XtO,kt=Date.now();function _t(e){let{[Ct]:t,[Zt]:o,isDisabledForWorkspace:i}=e;window.__c={n:"PageAnalytics"};const[n,a]=(0,s.useState)(xt),[d,u]=(0,s.useState)({state:i?ht:"loading"}),v=(0,m.O7)(),y=(0,c.Fg)(),b=(0,l.VK)((()=>{const{[wt]:e}=X.default.state;return null==e?void 0:e.getName()}),[]),f=(0,l.VK)((()=>{switch(n){case"last_7_days":return 7;case xt:return 28;case"last_90_days":return 90;case"all_time":return}}),[n]);(0,s.useEffect)((()=>{i||async function(){const e=await me.getPageAnalytics(v,{pageId:t.id,[Zt]:o,days:f});if("failed"===e.type)return void u({state:"empty"});const i=e[St].map((e=>{let{ds:t,total_views:o,unique_views:i}=e;return{ds:t,[ft]:{total_views:o,unique_views:i}}}));i.filter((e=>{let{ds:t}=e;return de.convert.isoToUnixMs(t,"UTC")??kt<=kt})).every((e=>{let{[ft]:t}=e;return 0===t.total_views}))?u({state:"empty"}):u({state:"loaded",[St]:i})}()}),[v,t.id,i,o,f]);const S=(0,c.yK)((e=>({fullHeight:{[bt]:yt,[vt]:mt,[gt]:mt,[ut]:"100%"},spinner:{[pt]:32,[ut]:32}})),[]);return"loading"===d.state?r()("div",{[ct]:S.fullHeight},void 0,r()(Te.Z,{[ct]:S.spinner})):"empty"===d.state?r()("div",{[ct]:S.fullHeight},void 0,r()(Rt,{heading:r()(p.FormattedMessage,{id:"page_analytics.empty.heading",[lt]:"No page analytics yet"}),[st]:r()(p.FormattedMessage,{id:"page_analytics.empty.description",[lt]:"It may take some time for page view information to appear."})})):"disabled-for-workspace"===d.state?r()("div",{[ct]:S.fullHeight},void 0,r()(Rt,{heading:r()(p.FormattedMessage,{id:"page_analytics.disabled.heading",[lt]:"Page viewership tracking is disabled"}),[st]:r()("div",{[ct]:{[bt]:yt,[rt]:dt,[vt]:mt,gap:16}},void 0,r()(p.FormattedMessage,b?{id:"page_analytics.disabled.description",[lt]:"Page viewership and analytics is turned off for all pages in {name}",[ft]:{name:b}}:{id:"page_analytics.disabled.description.unnamed",[lt]:"Page viewership and analytics is turned off for all pages in your space"}),r()("a",{href:(0,Se.getLocalizedUrl)("guides.pageAnalytics"),target:"_blank",[ct]:{[bt]:yt,gap:4,color:y[at],[vt]:mt,[nt]:it,[ot]:tt}},void 0,re.Z.help({[pt]:14,[ut]:14}),r()(Ie.Z,{isSmall:!0},void 0,r()(p.FormattedMessage,{id:"page_analytics.disabled.learnMore",[lt]:"Learn more"}))))})):r()("div",{[ct]:{[bt]:yt,[rt]:dt,[gt]:et,[ut]:"100%"}},void 0,r()(_e.sg,{grow:1,gap:16},void 0,r()(Mt,{[Ct]:t,[St]:d[St],currentFilter:n,onChangeFilter:a}),r()(It,{[Ct]:t}),r()(Ot,{[Zt]:o,[Ct]:t})),r()("div",{[ct]:{borderTop:`1px solid ${y[Xe]}`,[Qe]:"12px 16px",[bt]:yt,[gt]:et,[vt]:mt}},void 0,r()(ke.ZP,{renderOrigin:e=>{let{[je]:t}=e;return r()(Me.Z,{[je]:t,icon:re.Z[Je]},void 0,r()(p.FormattedMessage,{id:"page_analytics.timeseries.settings",[lt]:"Settings"}))},popupType:v.device[Ye]?ke.Z4.SlideUp:ke.Z4.Popup,render:()=>r()(g.Z,{menuType:M.og.Popup,[pt]:460},void 0,r()("div",{[ct]:Tt},void 0,r()(Ve.PageAnalyticsPageOptOut,{[Ct]:t})))}),r()("a",{href:(0,Se.getLocalizedUrl)("guides.pageAnalytics"),target:"_blank",[ct]:{[bt]:yt,gap:4,color:y[at],[vt]:mt,[nt]:it,[ot]:tt}},void 0,re.Z.help({[pt]:14,[ut]:14}),r()(Ie.Z,{isSmall:!0},void 0,r()(p.FormattedMessage,{id:"page_analytics.timeseries.learnMore",[lt]:"Learn more"})))))}const Tt={margin:"8px 16px",pointerEvents:"auto",[ot]:"default"};function Mt(e){window.__c={n:"PageAnalyticsGraph"};const[t,o]=(0,he.e)(),{blueLayer:i,yellowLayer:n}=(0,ie.useTimeSeriesPalette)(),a=(0,s.useMemo)((()=>{if(0===e[St][qe])return kt;const t=de.convert.isoToUnixMs(e[St][0].ds,"UTC")??kt;return Math.min(t,kt)}),[e[St]]);return r()("div",{},void 0,r()(Pt,{[Ct]:e[Ct],[St]:e[St],currentFilter:e.currentFilter,onChangeFilter:e.onChangeFilter}),s[He]("div",{ref:t,[ct]:{...Tt,[Ge]:0}},r()(xe.LazyTimeSeries,{startDate:(0,ae.$6)(a,!0),endDate:(0,ae.$6)(kt,!0),[pt]:o,[ut]:175,[St]:e[St],layers:[{key:"total_views",...i,renderLabel:e=>r()(p.FormattedMessage,{id:"page_analytics.timeseries.total_views",[lt]:"{views, plural, one {1 total view} other {{views} total views}}",[ft]:{views:e}})},{key:"unique_views",...n,renderLabel:e=>r()(p.FormattedMessage,{id:"page_analytics.timeseries.unique_views",[lt]:"{uniqueViews, plural, one {1 unique view} other {{uniqueViews} unique views}}",[ft]:{[$e]:e}})}]})))}function Pt(e){window.__c={n:"PageAnalyticsHeader"};const t=(0,p.useIntl)(),o=(0,s.useMemo)((()=>e[St].reduce(((e,t)=>{let{[ft]:o}=t;return e+o.total_views}),0)),[e[St]]);return r()("div",{[ct]:{margin:"14px 16px",[bt]:yt,[gt]:et,[vt]:mt}},void 0,r()(_e.X2,{[gt]:et,[vt]:mt,grow:1},void 0,r()(_e.X2,{gap:4},void 0,r()(Ie.Z,{[ct]:{[We]:500}},void 0,r()(p.FormattedMessage,{id:"page_analytics.timeseries.title",[lt]:"Views"})),r()(Ie.Z,{isSecondaryColor:!0},void 0,r()(p.FormattedMessage,{id:"page_analytics.timeseries.totalViews",[lt]:"({totalViews} total)",[ft]:{totalViews:(0,se.uf)(o,Ne,t)}}))),r()(Fe.f,{currentFilter:e.currentFilter,onChangeFilter:e.onChangeFilter})))}function It(e){window.__c={n:"PageAnalyticsViewers"};const{[Ct]:t}=e,{[ze]:o,presenceStore:i}=(0,l.Kw)(X.default),n=(0,m.O7)();(0,s.useEffect)((()=>{ve.Ri(n,{block:t,[ze]:o,incremental:!1,limit:ve.s4})}),[n,t,o]);const a=(0,l.VK)((()=>(0,be.AQ)(o,i)),[o,i]);if(0===a[qe])return null;const d=a.map((e=>{let{userId:o,[Le]:i}=e;return{actorStore:Ce.U6.createChildStore(t,{id:o,table:pe.KJ}),[Ee]:i}}));return r()("div",{[ct]:{...Tt,[bt]:yt,[rt]:dt,gap:12}},void 0,r()(Ie.Z,{[ct]:{[We]:500}},void 0,r()(p.FormattedMessage,{id:"page_analytics.viewers.title",[lt]:"Viewers"})),r()("div",{[ct]:{[bt]:yt,[rt]:dt,gap:10}},void 0,r()(Kt,{[Ct]:t,actorStores:d,collapsedLabel:r()(p.FormattedMessage,{id:"page_analytics.viewers.expand",[lt]:"Show more viewers"}),expandedLabel:r()(p.FormattedMessage,{id:"page_analytics.viewers.collapse",[lt]:"Show less viewers"})})))}function Kt(e){window.__c={n:"PageAnalyticsActorList"};const{[Ct]:t,actorStores:o,collapsedLabel:i,expandedLabel:n}=e,[a,d]=(0,s.useState)(!0),l=a?o.slice(0,5):o;return r()("div",{[ct]:{[bt]:yt,[rt]:dt,gap:10}},void 0,l.map((e=>{let{actorStore:o,[Ee]:i}=e;return r()(Ft,{[Ct]:t,actorStore:o,[Ee]:i},o.id)})),o[qe]>5&&r()("button",{[je]:e=>{e[Ae](),d(!a)},[ct]:{[De]:"none",border:"none",[Ue]:"left",[Qe]:0,marginTop:4}},"toggle",r()(Ie.Z,{isSecondaryColor:!0,isSmall:!0,[ct]:{[bt]:"flex",gap:3,[vt]:"center"}},void 0,a?i:n,a?re.Z.chevronDownRounded({[pt]:12}):re.Z.chevronUpRounded({[pt]:12}))))}function Ft(e){window.__c={n:"PageAnalyticsActor"};const{actorStore:t,[Ee]:o}=e,i=(0,p.useIntl)(),n=(0,s.useMemo)((()=>{const e=Date.now();return(0,ae.tv)(Math.min(o??e,e),ne.SP)}),[o]),a=(0,l.VK)((()=>t.getDisplayName(i)),[t,i]);return r()(_e.X2,{[vt]:mt,[gt]:et},void 0,r()(_e.X2,{gap:4},void 0,r()(Vt,{actorStore:t}),r()(Ie.Z,{[ct]:{[We]:500}},void 0,a)),r()(Ie.Z,{isSecondaryColor:!0},void 0,o?r()("span",{title:(0,ae.Yx)(o,"medium_with_time",ne.SP)},void 0,n):n))}function Vt(e){const{actorStore:t}=e;return t.table===ce.cZ?r()(Pe.Z,{botStore:t,size:18}):t.table===pe.KJ?r()(Ke.Z,{userStore:t,size:18}):t.table===le.y?r()(Ke.Z,{userStore:void 0,size:18}):void(0,A.unreachable)(t)}function Bt(e){const{environment:t,[Ct]:o,[Zt]:i,hasAccessToEditors:n}=e,[,,a]=(0,l.AF)(void 0,Ze.o),[d,r]=(0,s.useState)([]);(0,s.useEffect)((()=>{n&&ge.h(t,{[Ct]:a,activityIds:d,[Zt]:i,filterActivityTypes:[],filterDateRange:{starting:void 0,ending:void 0},navigableBlockId:o.id})}),[d,a,i,o.id,t,n]);return(0,l.VK)((()=>{if(!n)return[];const e=a.state.activityIds;(0,ue.Z)(d,e)||r(e);const{[wt]:t}=X.default.state;if(!t)return[];const i=d.map((e=>(0,fe.getActivityStore)(t,e,t.id))).flatMap((e=>{const t=e.getValue();return t?"top-level-block-created"!==t.type&&"top-level-block-deleted"!==t.type&&"block-edited"!==t.type?[]:function(e,t){var o;return oe().compact(null===(o=e.edits)||void 0===o?void 0:o.flatMap((e=>{var o;return null===(o=e.authors)||void 0===o?void 0:o.map((o=>({actorStore:(0,ye.nc)({parentStore:t,[tt]:o}),[Ee]:e[Ee]})))})))}(t,o):[]})),s=oe().sortBy(i,Ee).reverse();return oe().uniqBy(s,"userId")}),[d,a,n,o])}function Ot(e){window.__c={n:"PageAnalyticsEditors"};const{[Zt]:t,[Ct]:o}=e,i=(0,m.O7)(),n=(0,l.VK)((()=>(0,we.userIsOnTier)(i,"business")||(0,we.userIsOnTier)(i,"enterprise")),[i]),a=Bt({environment:i,hasAccessToEditors:n,[Zt]:t,[Ct]:o}),d=(0,l.VK)((()=>{const e=o.getCreatedByPointer(),t=o.getCreatedTime();if(e&&t)return{actorStore:(0,ye.nc)({parentStore:o,[tt]:e}),[Re]:t}}),[o]);return r()("div",{[ct]:{...Tt,[bt]:yt,[rt]:dt,gap:12}},void 0,r()(Ie.Z,{[ct]:{[We]:500}},void 0,r()(p.FormattedMessage,{id:"page_analytics.editors.title",[lt]:"Editors"})),d&&r()("div",{[ct]:{[bt]:"flex",[rt]:"column",gap:10,[Ge]:6}},void 0,r()(Ie.Z,{isSmall:!0,isSecondaryColor:!0,[ct]:{[We]:500}},void 0,r()(p.FormattedMessage,{id:"page_analytics.editors.createdBy",[lt]:"Created by"})),r()(Ft,{[Ct]:o,actorStore:d.actorStore,[Ee]:d[Re]})),n&&a[qe]>0&&r()("div",{[ct]:{[bt]:"flex",[rt]:"column",gap:10}},void 0,r()(Ie.Z,{isSmall:!0,isSecondaryColor:!0,[ct]:{[We]:500}},void 0,r()(p.FormattedMessage,{id:"page_analytics.editors.editedBy",[lt]:"Recently edited by"})),r()(Kt,{actorStores:a,[Ct]:o,collapsedLabel:r()(p.FormattedMessage,{id:"page_analytics.editors.expand",[lt]:"Show more editors"}),expandedLabel:r()(p.FormattedMessage,{id:"page_analytics.editors.collapse",[lt]:"Show less editors"})})))}function Rt(e){window.__c={n:"PageAnalyticsEmptyState"};const t=(0,c.yK)((e=>({[dt]:{[bt]:yt,[rt]:dt},row:{[bt]:yt},centered:{[Ue]:mt,[vt]:mt,[pt]:250},analyticsIcon:{position:"relative",top:-8,left:-4},secondaryIcon:{fill:e.mediumTextColor},settingsButton:{[Qe]:"7.5px 10px",alignSelf:mt},link:{[ot]:tt,[gt]:mt,[vt]:mt,[Qe]:8,alignSelf:mt}})),[]);return r()("div",{[ct]:{...t[dt],gap:24}},void 0,r()("div",{[ct]:{...t[dt],...t.centered,gap:4}},void 0,re.Z.analyticsSearch({...t.secondaryIcon,...t.analyticsIcon,[pt]:62,[ut]:62}),r()(Ie.Z,{isSecondaryColor:!0,[ct]:{fontSize:16,[We]:500}},void 0,e.heading),r()(Ie.Z,{isSecondaryColor:!0,[ct]:{[Oe]:"normal",overflow:Be}},void 0,e[st])))}const Ut=o(85).N20,Dt=o(85).D7I,At=o(85).Mor,Et=o(85).Ql2,Lt=o(85).BQ6,zt=o(85).nx5,Nt=o(85).qc1,Wt=o(85).GmX,Ht=o(85).$bT,$t=o(85).jkI,Gt=o(85).sM5,qt=o(85).eg4,Yt=o(85).Gqc,Jt=o(85).tDk;function jt(e){let{enablePageAnalytics:t}=e;window.__c={n:"UpdateSidebarTabUpdates"};const o=(0,l.VK)((()=>X.default.state[Jt]),[]),i=(0,l.VK)((()=>{const e=Y.ou.now().minus({years:1}).valueOf();return!!o&&o.getCreatedTime()<e}),[o]),n=(0,l.VK)((()=>X.default.state.currentSpaceStore),[]),a=(0,l.VK)((()=>!(null!=o&&o.canRead())),[o]),d=(0,m.O7)(),g=(0,l.VK)((()=>(0,j.isUpdateSidebarInPopOutMode)(d)),[d]),v=(0,l.VK)((()=>{var e;const t=null==o?void 0:o.getModel();return o&&null!=t&&t.isCollectionView()?null===(e=o[Yt]())||void 0===e?void 0:e.id:void 0}),[o]),y=(0,l.VK)((()=>Boolean(null==n?void 0:n.getSettings()[qt])),[n]),b=(0,c.yK)((e=>({updatesEmptyStyle:{flex:1,[Gt]:"flex",justifyContent:$t,[Ht]:"column",textAlign:$t,color:e.mediumTextColor,fontSize:14,background:e[Wt],marginRight:g?2:0,[Nt]:"auto",height:"100%"},updatesNotEmptyStyle:{[Gt]:"flex",[Ht]:"column",flex:"1 1 0%",background:e[Wt],marginRight:g?2:0,[Nt]:"auto",marginTop:1,height:"100%"}})),[g]),f=(0,l.VK)((()=>w.ZP.state.currentSubTab),[]);if(a)return r()(ee.Z,{type:Q.Z.Y,[Lt]:b.updatesEmptyStyle},void 0,r()("div",{[Lt]:{width:200,alignSelf:$t}},void 0,r()(p.FormattedMessage,{id:"updateSidebar.commentContainer.restricted",[zt]:"You don't have permission to view the updates of this restricted page."})));if(n&&o)return s[Dt](ee.Z,{type:Q.Z.Y,ref:e=>{J.Z.UpdateSidebarScroller=e},[Lt]:b.updatesNotEmptyStyle},t&&r()("div",{[Lt]:{[Gt]:f===w.uF.Analytics?"block":"none",height:"100%"}},void 0,r()(_t,{[Et]:n.id,store:o,isDisabledForWorkspace:y})),r()("div",{[Lt]:{[Gt]:f===w.uF.Updates?"block":"none"}},void 0,r()(u.Z,{[Ut]:v,navigableBlock:o,[Et]:n.id,source:At,empty:e=>s[Dt](ee.Z,{type:Q.Z.Y,[Lt]:b.updatesEmptyStyle,ref:e=>{J.Z.UpdateSidebarScroller=e}},r()("div",{[Lt]:{width:200,alignSelf:$t}},void 0,e.hasFiltersOn?r()(p.FormattedMessage,{id:"updateSidebar.updatesContainer.emptyAfterSearch",[zt]:"No updates match the requested filters."}):r()(p.FormattedMessage,i?{id:"updateSidebar.updatesContainer.emptyMaybePurged",[zt]:"There are no recent updates on this page. Page updates are retained for one year."}:{id:"updateSidebar.updatesContainer.empty",[zt]:"No updates on this page yet."})))},o.id)));throw new Error("Loaded sidebar without AppStore initialized.")}var Qt=o(38755),Xt=o(33784),eo=o(38302),to=o(88923);const oo=o(85).Er,io=o(85).ttt,no=o(85).xOW,ao=o(85).D7I,ro=o(85).W1o,so=o(85).Wp_,lo=o(85).$bT,co=o(85).paz,po=o(85).qc1,uo=o(85).tLG,go=o(85).fBv,mo=o(85).dMt,vo=o(85).L_E,yo=o(85).l9D,bo=o(85).iKt,fo=o(85).f$V,So=o(85).Jkr,wo=o(85).qJ8,ho=o(85).QmD,xo=o(85).tDk,Zo=o(85).Vy4;function Co(e){window.__c={n:"UpdateSidebarContent"};const{[Zo]:t}=e,o=(0,l.VK)((()=>X.default[ho][xo]),[]),i=(0,l.VK)((()=>X.default[ho][wo]),[]),n=(0,l.VK)((()=>X.default[ho].renderPhase),[]),[a,d]=(0,s.useState)(!1),c=(0,s.useMemo)((()=>(new Date).getTime()),[]);if((0,s.useEffect)((()=>{a||"rendered"!==n||d(!0)}),[null==o?void 0:o.id,a,n]),!o||!i||!a)return r()(G.B,{areaHeight:window.innerHeight});switch(t){case w.gY.Comments:return r()(q.J,{timeMounted:c,location:"sidebar"});case w.gY.Updates:return r()(jt,{enablePageAnalytics:e.enablePageAnalytics});case w.gY.Assistant:return r()(N.QP,{});default:(0,A.unreachable)(t)}}function ko(e){window.__c={n:"UpdateSidebar"};const t=(0,l.VK)((()=>({[So]:w.ZP[ho][So],[fo]:w.ZP[ho][fo]})),[]),o=(0,m.O7)(),{shouldLoadSidebarComponents:i,[bo]:n,popOutMode:a,closeSidebar:d}=e,p=(0,l.VK)((()=>n&&a&&!eo.Z[ho].isOpen&&!Xt.Z[ho].open),[n,a]),u=(0,s.useRef)(null),g=(0,s.useMemo)((()=>[`.${b.updateSidebar}`,`.${b.discussionInputEditExistingComment}`,`.${b.commentOverflowMenu}`,`.${b.topbarUpdatesButton}`,`.${b.topbarCommentsButton}`,`.${b.overlayContainer}`]),[]);(0,D.O)({active:p,closeHandler:d,ref:u,excludedSelectors:g});const y=v.R6(o.device[yo]),f=(0,c.yK)((e=>({[vo]:{flexGrow:0,flexShrink:0,zIndex:E.updateSidebarContainer,borderLeft:(a?"unset":!n&&"1px solid rgba(0,0,0,0)")||`1px solid ${e[mo]}`,alignSelf:"flex-end",[go]:uo,right:0,top:0,height:"100vh",[po]:"none"},popOutContainer:{boxShadow:e.mediumBoxShadow,background:e.popoverBackground,borderRadius:3,border:n?`1px solid ${e[mo]}`:void 0,height:`calc(100% - 20px - ${y}px)`,marginTop:y+10,marginRight:n?10:0},wrap:{height:"100%"},[co]:{[go]:uo,top:0,bottom:0,display:n?"flex":"none",[lo]:"column",overflow:"visible",zIndex:E.updateSidebarContainer,[So]:t[So]}})),[t[So],y,a,n]);return i?s[ao]("aside",{"aria-hidden":!n||void 0,ref:u,style:{...f[vo],...a?f.popOutContainer:{}},onMouseMove:()=>{t[fo]||w.ZP[so]({...w.ZP[ho],[ro]:!0})},onMouseLeave:()=>{t[fo]||w.ZP[so]({...w.ZP[ho],[ro]:!1})}},r()("div",{style:f.wrap},void 0,r()("div",{style:f[co]},void 0,s[ao](To,e)))):null}function _o(e){let{enablePageAnalytics:t,navigableBlock:o,onTabChange:i}=e;window.__c={n:"SidebarHeader"};const n=(0,m.O7)(),{popOutMode:a}=(0,l.VK)((()=>({popOutMode:(0,j.isUpdateSidebarInPopOutMode)(n)})),[n]),d=(0,l.VK)((()=>w.ZP[ho][Zo]),[]),s=(0,c.yK)((()=>({commentsHeaderStyle:{[go]:no,[po]:"auto",marginTop:a?0:v.R6(n.device[yo])}})),[n,a]);switch(d){case w.gY.Comments:return r()("div",{style:s.commentsHeaderStyle});case w.gY.Updates:return r()(T,{popOutMode:a,navigableBlock:o,enablePageAnalytics:t,onTabChange:i});case w.gY.Assistant:return r()("div",{style:s.commentsHeaderStyle})}}function To(e){window.__c={n:"SidebarActivityFeed"};const{isResizerHovered:t,isResizing:o,[Zo]:i,expanded:n}=(0,l.VK)((()=>{const{isResizerHovered:e,isResizing:t,[Zo]:o,expanded:i}=w.ZP[ho];return{isResizerHovered:e,isResizing:t,[Zo]:o,expanded:i}}),[]),{[io]:a}=e,d=(0,m.O7)(),{currentTabToRender:p,popOutMode:u}=(0,l.VK)((()=>({currentTabToRender:a.isCollectionView()&&!a[oo]()&&i!==w.gY.Assistant?w.gY.Updates:i,popOutMode:(0,j.isUpdateSidebarInPopOutMode)(d)})),[a,i,d]),g=(0,l.VK)((()=>{const{[wo]:e}=X.default[ho];return!(0,Qt.Cx)(e)}),[]),y=s.useCallback((e=>{L.trackUpdatesSidebarTabClick(d,{tab:e===w.uF.Updates?"updates":"analytics",origin:to.default[ho].open?"peek_view":"page"}),w.ZP[so]({...w.ZP[ho],currentSubTab:e})}),[d]),f=(0,c.yK)((e=>({pane:{display:"flex",[lo]:"column",height:"100%",[go]:no,[po]:"none",maxHeight:"100%",backgroundColor:i===w.gY.Comments?void 0:"inherit"},resizerStyle:{[go]:uo,top:0,left:-3,bottom:0,right:0,height:"100vh",[So]:3,zIndex:-1,display:"block",transition:"box-shadow 300ms ease-in",...(t||o)&&n?{boxShadow:e.sidebarResizerBoxShadow}:{}},controlsHeaderStyle:{[go]:no,[po]:"auto",marginTop:u?0:v.R6(d.device[yo]),paddingTop:4,[So]:u?"calc(100% - 2px)":"100%",background:e.contentBackground,borderRadius:3,paddingBottom:1}})),[i,t,o,d,n,u]);return r()("div",{style:f.pane,className:b.updateSidebar},void 0,r()("div",{style:f.resizerStyle}),r()(_o,{enablePageAnalytics:g,navigableBlock:a,onTabChange:y}),r()(Co,{[Zo]:p,enablePageAnalytics:g}),n&&r()($.Z,{type:"update"}))}function Mo(e){window.__c={n:"UpdateSidebarAnimatedWrapper"};const{[yo]:t,[io]:o}=e,i=(0,l.VK)((()=>({[So]:w.ZP[ho][So],[fo]:w.ZP[ho][fo],canRender:w.ZP[ho].canRender})),[]),n=(0,s.useMemo)((()=>o.clone()),[o]),a=(0,m.O7)(),d=(0,l.VK)((()=>a.currentUser.isLoggedIn()&&(0,j.updateSidebarIsExpanded)(a)),[a]),{[bo]:c,popOutMode:p,closeSidebar:u}=(0,l.VK)((()=>({[bo]:(0,j.updateSidebarIsExpanded)(a),popOutMode:(0,j.isUpdateSidebarInPopOutMode)(a),closeSidebar:()=>z.setUpdateExpand({environment:a,[bo]:!1,from:"close_for_space"})})),[a]),[g,v]=(0,s.useState)(!1),[y,b]=(0,s.useState)(void 0);return(0,s.useEffect)((()=>{(void 0===y||y===o.id)&&c&&(v(!0),b(o.id))}),[y,o,c]),i.canRender?r()(W.Z,{isVisible:!0,useCompositeLayer:!0,animationStyle:{[So]:d?i[So]:0},render:()=>r()(H.Z,{store:n,droppable:!0,render:()=>r()(ko,{[yo]:t,isFullyExpanded:!i[fo],[io]:o,[bo]:c,popOutMode:p,closeSidebar:u,shouldLoadSidebarComponents:g})},n.id),onAnimationStart:()=>{w.ZP[so]({...w.ZP[ho],[fo]:!0})},onAnimationEnd:()=>{w.ZP[so]({...w.ZP[ho],[fo]:!1})}}):null}}}]);