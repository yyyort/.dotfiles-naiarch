"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[9849],{77985:(e,t,i)=>{i.d(t,{Pq:()=>Ht,oe:()=>zt,bU:()=>Kt});var o=i(97464),r=i.n(o),n=i(77094),s=i.n(n),l=i(96486),a=i.n(l),d=i(67294),u=i(83355),c=i(76205),h=i(3909),p=i(97880),v=i(5366),m=i(50906),g=i(97004),f=i(17335),y=i(87279),Z=i(61766),S=i(13401),M=i(80951),k=i(43690),b=i(480),w=i(33929),F=i(98742),x=i(52275),T=i(14871),P=i(58032),C=i(64369),I=i(62045);const R=i(85).D7I,O=i(85).nx5,A=i(85).Yzm;function D(e){window.__c={n:"CollectionFilterMenuDateFilterMode"};const{filter:t}=e,{isMobile:i}=(0,b.Fy)(),o=w.default.getIntl(),n={width:190,menuTitle:o[A]({[O]:"Date Options",id:"database.filterMenu.mobileDateFilterModeMenu.title"}),items:c.T,selectedItem:(0,c.TX)(t),getKey:e=>e,onSelect:i=>{const o={...t,use_end:(0,c.UG)(i)};e.onChange(o)},renderItem:e=>s()(P.Z,{renderTooltip:()=>(0,f._T)(e.value),render:t=>d[R](x.Z,r()({title:(0,f.IF)(e.value)},(0,F.Z)(e,t))),placement:P.Z.Placement.Right,textWrap:!0,style:{width:"260px"}}),renderOrigin:e=>d[R](I.Z,r()({},e,{placeholder:o[A]({[O]:"Date Options",id:"database.filterMenu.dateFilterModeMenu.label"}),title:s()(C.Z,{isMobile:i},void 0,(0,f.IF)((0,c.TX)(t))),disableMargins:!0,desktopStyle:{width:"100px"}}))};return d[R](T.Z,r()({key:"date-filter-mode"},n,{mobileActionSheet:!0}))}var _=i(34299);const B=i(85).dLQ,V=i(85).D7I,E=i(85).wgE,G=i(85).mUE,N=i(85).nx5,L=i(85).Yzm;class W extends u.Z{renderComponent(){const{filterValueType:e,filter:t,intl:i}=this.props,o=(0,c.xm)(e),n={width:190,menuTitle:i[L]({[N]:"Comparator",id:"database.filterMenu.mobileComparatorValueMenu.title"}),items:o,selectedItem:t[G],getKey:e=>e,onSelect:i=>{const o=(0,f.li)(e,t,i,"combinator");this.props.onChange(o),m.trackConfigureView(this[E],{view_type:this.props.collectionViewType,action:"set_filter_comparator"})},renderItem:e=>d[V](x.Z,r()({title:(0,f.WC)(e.value)},e)),renderOrigin:e=>d[V](I.Z,r()({},e,{placeholder:i[L]({[N]:"Comparator",id:"database.filterMenu.comparatorMenuDropdownButton.label"}),title:s()(C.Z,{[B]:this[E].device[B]},void 0,(0,f.WC)(t[G])),disableMargins:!0}))};return d[V](T.Z,r()({key:"comparator"},n,{mobileActionSheet:!0}))}}W.displayName="CollectionFilterMenuFilterOperator";const Q=(0,v.injectIntl)(W);var U=i(28463),K=i(26909);const z=i(85).$Vf,H=i(85).Yzm,Y=i(85).Tk1,j=i(85).rps,$=i(85).wgE,q=i(85).D7I,X=i(85).mUE,J=i(85).QLQ,ee=i(85).Dd5,te=i(85).YDe,ie=i(85).fBu,oe=i(85).nSw,re=i(85).ffk,ne=i(85).Kiu,se=i(85).P0R,le=i(85).eiN,ae=i(85).nx5,de=(0,v.defineMessages)({setFilter:{[ae]:"Set filter",id:"database.filterMenu.rollupPropertyValue.mobileMenu.title"}});class ue extends u.Z{renderComponent(){const{[le]:e}=this[se];if((0,c.a_)(e))return this.renderArrayFilter(e);const t=(0,c.fI)({[ne]:this[se][ne],[re]:this[se][re],[oe]:this[se][ie][oe]});if(!(0,c.ZB)(t,e)){const e=(0,f.rn)(t);return s()(d.Fragment,{},void 0,s()(Q,{filterValueType:t,[le]:e,[te]:this[se][te],[ee]:this[se][ee]}),s()(U.Z,{filterValueType:t,[le]:e,[ne]:this[se][ne],[re]:this[se][re],[ie]:this[se][ie],[te]:this[se][te],[J]:this[se][J],[ee]:this[se][ee]}))}const i=d[q](v.FormattedMessage,r()({},f.xe[t],{values:{[re]:s()(v.FormattedMessage,{id:"collectionFilterMenuFilter.property.name",[ae]:"Property"}),[X]:s()(Q,{filterValueType:t,[le]:e,[te]:this[se][te],[ee]:this[se][ee]}),operatorValue:s()(U.Z,{filterValueType:t,[le]:e,[ne]:this[se][ne],[re]:this[se][re],[ie]:this[se][ie],[te]:this[se][te],[J]:this[se][J],[ee]:this[se][ee]})}}));return this[$].device.isMobile?i:s()("div",{style:{alignItems:"center",display:"grid",gridAutoFlow:j,gridAutoColumns:"1fr",gridColumnEnd:this[se].isArrayFilter?void 0:"span 2",gridColumnGap:`${K.l0}px`,gridTemplateRows:`${K.fg}px`,[Y]:"[value-start] max-content auto [value-end operator-start] auto"}},void 0,i)}renderArrayFilter(e){const{intl:t}=this[se],i={menuTitle:t[H](de.setFilter),items:c.Rf,getKey:e=>e,selectedItem:e[X],onSelect:t=>{const i={...e,[X]:t};this[se][ee](i),m.trackConfigureView(this[$],{view_type:this[se][te],action:"set_rollup_set_filter"})},renderItem:e=>d[q](x.Z,r()({title:(0,f.SW)(e.value,t)},e)),renderOrigin:i=>d[q](I.Z,r()({},i,{placeholder:t[H](de.setFilter),title:(0,f.SW)(e[X],t),disableMargins:!0,desktopStyle:{minWidth:70}}))},o=(0,_.gT)({[re]:this[se][re],[ne]:this[se][ne],[oe]:this[se][ie][oe]});if(!o)return s()("div",{style:{gridColumnEnd:"span 2"}});const n=s()(d.Fragment,{},void 0,d[q](T.Z,r()({key:"set_filter"},i,{mobileActionSheet:!0})),s()(ce,{[J]:this[se][J],[le]:e[z],[ne]:o.targetCollectionSchema,[re]:o.targetProperty,[ie]:this[se][ie],[te]:this[se][te],[ee]:t=>{const i={...e,[z]:t};this[se][ee](i)},isArrayFilter:!0}));return this[$].device.isMobile?n:s()("div",{style:{display:"grid",gridAutoFlow:j,gridAutoColumns:"1fr",gridColumnEnd:"span 2",gridColumnGap:`${K.l0}px`,[Y]:"max-content",gridTemplateRows:`${K.fg}px`}},void 0,n)}}ue.displayName="LocalizableCollectionFilterMenuFilter";const ce=(0,v.injectIntl)(ue),he=ce;var pe=i(31945),ve=i(77498),me=i(50542);const ge=i(85).QLQ,fe=i(85).nx5,ye=i(85).OBh,Ze=i(85).D7I,Se=i(85).dLQ,Me=i(85).YDe,ke=i(85).wgE,be=i(85).jQT,we=i(85).dEG,Fe=i(85).Dd5,xe=i(85).fBu,Te=i(85).nSw,Pe=i(85).MWD,Ce=i(85).eiN,Ie=i(85).ffk,Re=i(85).P0R,Oe=i(85).Kiu;class Ae extends u.Z{constructor(){super(...arguments),this.handleChangeProperty=e=>{var t,i;const{[Oe]:o}=this[Re],{[Ie]:r,[Ce]:n}=this[Re].propertyFilter,s=o[r],l=o[e],a={[Ie]:e,[Ce]:n},d=l&&(0,c.J5)(l,n),u=l&&"relation"===l[Pe]&&r!==e,h=s&&("created_by"===s[Pe]||"last_edited_by"===s[Pe])&&l&&"person"===l[Pe],p=(0,c.Gb)(n)&&!(0,c.mv)(n)&&(0,c.R8)(n).some((e=>"exact"===e[Pe]&&e.value&&"bot"===e.value.table));(!d||u||h&&p||!(0,k.getNormalizedPropertyFilter)(a,o))&&(a[Ce]=(0,f.zZ)({[Oe]:o,[Ie]:e,[Te]:this[Re][xe][Te]})),null===(t=(i=this[Re])[Fe])||void 0===t||t.call(i,this[Re][we],a),m[be](this[ke],{view_type:this[Re][Me],action:"set_filter_property"})}}renderComponent(){const{device:e}=this[ke],{[Oe]:t,propertyFilter:i}=this[Re],o=(0,M.getNormalizedPropertySchema)({[Oe]:t,[Ie]:i[Ie]});if(!o)return;if(!(0,c.J5)(o,i[Ce]))return;const n=(0,c.gE)(i[Ce])&&(0,c.vR)(i[Ce])&&"date"===o[Pe]?{width:"120px",marginRight:"4px"}:{},l=s()(d.Fragment,{},void 0,s()(pe.ZP,{popupType:e[Se]?pe.Z4.SlideUp:pe.Z4.Popup,renderOrigin:e=>d[Ze](me.Z,r()({},e,{[ye]:o,disableMargins:!0,textWrapperStyle:{width:"100%",...n}})),render:e=>s()(ve.Z,{isRelationProperty:!1,[Oe]:this[Re][Oe],onAccept:this.handleChangeProperty,onClose:e.close})}),(0,c.gE)(i[Ce])&&(0,c.vR)(i[Ce])&&"date"===o[Pe]&&s()(D,{[Ce]:i[Ce],[Fe]:e=>{var t,o;const r={...i,[Ce]:e};null===(t=(o=this[Re])[Fe])||void 0===t||t.call(o,this[Re][we],r)}}));return s()(d.Fragment,{},void 0,this[Re].filterOperator,e[Se]?l:s()("div",{style:{display:"flex"}},void 0,l),s()(v.FormattedMessage,{id:"collectionFilterMenuRow.propertyConjunction.label",[fe]:" "}),s()(he,{[Ce]:i[Ce],[Oe]:t,[Ie]:i[Ie],[xe]:this[Re][xe],[ge]:this[Re][ge],[Me]:this[Re][Me],[Fe]:e=>{var t,o;const r={...i,[Ce]:e};null===(t=(o=this[Re])[Fe])||void 0===t||t.call(o,this[Re][we],r)},isArrayFilter:!1}))}}Ae.displayName="CollectionFilterMenuRow";const De=Ae,_e=i(85).nx5;function Be(){return s()(v.FormattedMessage,{[_e]:"Add filter rule",id:"database.filterMenu.addFilterRuleButtonTitle"})}const Ve=i(85).D7I,Ee=i(85).Yzm,Ge=i(85).nx5,Ne=(0,v.defineMessages)({operatorPlaceholder:{[Ge]:"Operator",id:"database.filterMenu.operatorPlaceholder"}});class Le extends u.Z{renderComponent(){const{intl:e,filterOperator:t,onChange:i,disableMargins:o}=this.props,n={width:"auto",menuTitle:e[Ee]({[Ge]:"Operator",id:"database.filterMenu.filterOperatorMenu.title"}),items:c.Uz,getKey:e=>e,selectedItem:t,onSelect:i,renderItem:t=>d[Ve](x.Z,r()({title:(0,f.KV)(t.value,e),caption:(0,f.Qz)(t.value,e)},t)),renderOrigin:i=>d[Ve](I.Z,r()({},i,{title:t&&(0,f.KV)(t,e),placeholder:e[Ee](Ne.operatorPlaceholder),disableMargins:o}))};return d[Ve](T.Z,r()({key:"operator"},n,{mobileActionSheet:!0}))}}Le.displayName="CollectionFilterOperatorSelect";const We=(0,v.injectIntl)(Le);var Qe=i(31339),Ue=i(8982),Ke=i(73063),ze=i(78140),He=i(32163),Ye=i(40721),je=i(44532),$e=i(72495);const qe=i(85).zaB,Xe=i(85).LtW,Je=i(85).IMl,et=i(85).LOE,tt=i(85).Lps,it=i(85).QLQ,ot=i(85).fBu,rt=i(85).o_b,nt=i(85).tBn,st=i(85).dEG,lt=i(85).Dd5,at=i(85).ltl,dt=i(85).Lyb,ut=i(85).mUE,ct=i(85).YDe,ht=i(85).Qm2,pt=i(85).jQT,vt=i(85).P0R,mt=i(85).Kiu,gt=i(85).$o2,ft=i(85).pro,yt=i(85).Zyq,Zt=i(85).nQ3,St=i(85).j7K,Mt=i(85).N1Z,kt=i(85).Lhq,bt=i(85).y79,wt=i(85).jtM,Ft=i(85).sM5,xt=i(85).XNW,Tt=i(85)._lc,Pt=i(85).rpY,Ct=i(85).X5t,It=i(85).BQ6,Rt=i(85).wzE,Ot=i(85).sRs,At=i(85).NqB,Dt=i(85).PG2,_t=i(85).JAN,Bt=i(85).nx5,Vt=i(85).SO_,Et=i(85).Zij,Gt=i(85).D7I,Nt=i(85).sAj,Lt=i(85).wgE,Wt=i(85).E0z,Qt=i(85).dLQ,Ut=i(85).aL6,Kt=170,zt=400;class Ht extends u.Z{constructor(){super(...arguments),this[Ut]=[],this.renderChildFilter=(e,t)=>{const i=this[Lt][Wt][Qt];return(0,c.vA)(e)?i?this.renderMobileCombinatorFilter(e,t):this.renderDesktopCombinatorFilter(e,t):(0,c.aN)(e)?i?this.renderMobilePropertyFilter(e,t):this.renderDesktopPropertyFilter(e,t):void 0},this.renderAddFilterMenuItem=e=>{const t=this[Nt](h.Z.plus);return d[Gt](x.Z,r()({focused:!1},e,{icon:t,[Et]:s()(Be,{})}))},this[Vt]=e=>{const t=this[Nt](h.Z.addFilterGroup);return d[Gt](x.Z,r()({focused:!1},e,{icon:t,[Et]:s()(v.FormattedMessage,{[Bt]:"Add filter group",id:"database.filterMenu.addFilterGroup2ButtonTitle"}),caption:s()(v.FormattedMessage,{[Bt]:"A group to nest more filters",id:"database.filterMenu.addFilterGroupButtonCaption"})}))},this.renderCombinatorActions=()=>{const{[Wt]:e}=this[Lt];if(e[Qt])return s()($e.Z,{topBorder:this[_t]()},void 0,this.renderAddFilterMenuItem({[Dt]:this[At]}),this[Ot]()&&this[Vt]({[Dt]:this[Rt]}));const t={height:32},i={padding:`${K.cn}px 0`};return this[Ot]()?s()($e.Z,{topBorder:this[_t](),desktopStyle:i},void 0,s()(pe.ZP,{alignmentToOrigin:je.ZP.Alignment.Start,popupType:je.ZP[Tt].Popup,renderOrigin:e=>s()(Ue.i,{[Ct]:()=>e[Dt](),[Pt]:i=>{const{focused:o,...n}=i;return d[Gt](S.Z,r()({},e,n,{focused:o,isBlue:!1,[It]:t,[Et]:s()("div",{},void 0,s()(Be,{}),h.Z.chevronDown({width:10,[xt]:6,[Ft]:wt}))}))}}),[Pt]:e=>s()(He.Z,{type:He.i[bt],[St]:0,[Zt]:[{key:kt,[Pt]:e=>d[Gt]($e.Z,e),items:[{key:"add_filter",[Pt]:this.renderAddFilterMenuItem,[Ct]:t=>{e[Mt](),this[At]()}},{key:"add_filter_group",[Pt]:this[Vt],[Ct]:t=>{e[Mt](),this[Rt]()}}]}]})})):s()($e.Z,{topBorder:this[_t](),desktopStyle:i},void 0,s()(Ue.i,{[Ct]:this[At],[Pt]:e=>{const{focused:i,...o}=e;return d[Gt](S.Z,r()({},o,{focused:e.focused,isBlue:!1,[It]:t,[Dt]:this[At],[Et]:s()(Be,{})}))}}))},this[yt]=(e,t)=>{this[ft]((i=>i.splice(e,1,t)))},this[At]=()=>{const e=this[gt](this[vt][mt]);this[ft]((t=>t.push(e))),m[pt](this[Lt],{[ht]:this[vt][ct],[Ct]:"add_filter"})},this[Rt]=()=>{const e=this[gt](this[vt][mt]),t={[ut]:this.getOppositeOperator(),[dt]:[e]},i=this[ft]((e=>e.push(t)));this.openIndex(i-1),m[pt](this[Lt],{[ht]:this[vt][ct],[Ct]:"add_filter_group"})},this.handleChangeFilterOperator=e=>{const t={...this[vt][at],[ut]:e};this[vt][lt](this[vt][st],t),m[pt](this[Lt],{[ht]:this[vt][ct],[Ct]:"set_filter_operator"})}}willUnmount(){this[Ut]=[]}renderComponent(){const{[at]:e}=this[vt],{[Wt]:t}=this[Lt],i=(e[dt]??[]).flatMap((e=>(0,c.Mm)(e)?[]:[e]));return s()(d[nt],{},void 0,this[_t]()?void 0:s()("div",{[It]:t[Qt]?void 0:this.getGridStyles()},void 0,i.map(this.renderChildFilter)),this.renderCombinatorActions())}renderDesktopPropertyFilter(e,t){return s()(d[nt],{},t,s()(De,{[st]:t,propertyFilter:e,[mt]:this[vt][mt],filterOperator:this[rt](t),[ot]:this[vt][ot],[lt]:this[yt],[ct]:this[vt][ct],[it]:this[vt][it]},t),this[tt](e,t))}renderMobilePropertyFilter(e,t){return s()(d[nt],{},t,this[rt](t),s()($e.Z,{[Et]:s()(v.FormattedMessage,{[Bt]:"Filter {index}",id:"database.filterMenu.filterIndex",values:{[st]:t+1}})},void 0,s()(De,{[st]:t,propertyFilter:e,[mt]:this[vt][mt],filterOperator:null,[ot]:this[vt][ot],[lt]:this[yt],[ct]:this[vt][ct],[it]:this[vt][it]},t),this[tt](e,t)))}renderDesktopCombinatorFilter(e,t){const i={gridColumn:"property-start / value-end",...this.getSubgridWrapperStyles()};return s()(d[nt],{},t,this[rt](t),s()("div",{[It]:i},void 0,s()(Ht,{[st]:t,[et]:this[vt][et]+1,[at]:e,[lt]:this[yt],[ot]:this[vt][ot],[mt]:this[vt][mt],[ct]:this[vt][ct],[it]:this[vt][it]})),this[tt](e,t))}renderMobileCombinatorFilter(e,t){const i=(e[dt]||[]).length,o=s()(v.FormattedMessage,{[Bt]:"Filter Group {index}",id:"database.filterMenu.filterGroupIndex",values:{[st]:t+1}});return s()(d[nt],{},t,this[rt](t),s()($e.Z,{[Et]:o},void 0,s()(pe.ZP,{[Xe]:this[Je](t),popupType:pe.Z4.SlideUp,renderOrigin:t=>d[Gt](x.Z,r()({focused:!1},t,{showExtensionArrow:!0,right:i.toString(),[Et]:(0,f.qh)({filter:e,[mt]:this[vt][mt]})})),[Pt]:i=>s()(ze.Z,{menuType:y.og.Modal,[Et]:o,left:s()(Ye.BackMenuText,{}),onClickLeft:i[Mt]},void 0,s()(Ht,{[st]:t,[et]:this[vt][et]+1,[at]:e,[lt]:this[yt],[ot]:this[vt][ot],[mt]:this[vt][mt],[ct]:this[vt][ct],[it]:this[vt][it]}))}),this[tt](e,t)))}[rt](e){const t=this[vt][at][ut],{[Wt]:i}=this[Lt],o={justifySelf:"end"},r={...o,lineHeight:"32px",paddingRight:4};if(0===e){if(i[Qt])return;return s()(C.Z,{[It]:r},void 0,s()(v.FormattedMessage,{[Bt]:"Where",id:"database.filterMenu.where"}))}if(1===e){const e=s()(We,{disableMargins:!0,filterOperator:t,[lt]:this.handleChangeFilterOperator});return this[Lt][Wt][Qt]?s()($e.Z,{},void 0,e):s()("div",{[It]:o},void 0,e)}if(!i[Qt])return s()(C.Z,{[It]:r},void 0,s()(jt,{[ut]:t}))}[tt](e,t){return this[Lt][Wt][Qt]?this.renderRowActionMenuItems(e,t,void 0):s()(pe.ZP,{popupType:je.ZP[Tt].Popup,renderOrigin:e=>s()(Ue.i,{[Ct]:()=>e[Dt](),[Pt]:e=>d[Gt](Ke.Z,r()({},e,{hovered:e.focused,[It]:{width:"100%",height:32},icon:h.Z.dots}))}),[Pt]:i=>this.renderRowActionMenuItems(e,t,i)})}[Nt](e,t){return s()(Qe.Z,{icon:e,styles:t})}renderRowActionMenuItems(e,t,i){const o=(0,c.vA)(e),n=s()(v.FormattedMessage,o?{[Bt]:"Remove",id:"database.filterMenu.removeFilterGroupMenuTitle"}:{[Bt]:"Remove",id:"database.filterMenu.removeFilterMenuTitle"}),l=s()(v.FormattedMessage,o?{[Bt]:"Duplicate",id:"database.filterMenu.duplicateFilterGroupMenuTitle"}:{[Bt]:"Duplicate",id:"database.filterMenu.duplicateFilterMenuTitle"}),a=[{key:"delete",[Ct]:()=>{i&&i[Mt](),this.handleDeleteFilter(t)},[Pt]:e=>d[Gt](x.Z,r()({},e,{icon:this[Nt](h.Z.trash),[Et]:n}))},{key:qe,[Ct]:()=>{i&&i[Mt](),this.handleDuplicateFilter(t)},[Pt]:e=>d[Gt](x.Z,r()({},e,{icon:this[Nt](h.Z[qe]),[Et]:l}))}];if((0,c.aN)(e)&&this[Ot]()&&a.push({key:"turn_into_group",[Ct]:()=>{i&&i[Mt](),this.handleTurnIntoGroup(t,e)},[Pt]:e=>d[Gt](x.Z,r()({},e,{icon:this[Nt](h.Z.loop),[Et]:s()(v.FormattedMessage,{[Bt]:"Turn into group",id:"database.filterMenu.turnIntoGroupMenuTitle"})}))}),(0,c.vA)(e)&&e[dt]&&1===e[dt].length){const o=(0,c.vA)(e[dt][0])?s()(v.FormattedMessage,{[Bt]:"Unwrap group",id:"database.filterMenu.unwrapGroupMenuTitle"}):s()(v.FormattedMessage,{[Bt]:"Turn into filter",id:"database.filterMenu.turnIntoFilterMenuTitle"});a.push({key:"turn_into_filter",[Ct]:()=>{i&&i[Mt](),this.handleTurnIntoFilter(t,e)},[Pt]:e=>d[Gt](x.Z,r()({},e,{icon:this[Nt](h.Z.loop),[Et]:o}))})}const u=Yt(e);return(0,c.vA)(e)&&this[vt][et]+u+1<3&&a.push({key:"wrap_in_group",[Ct]:()=>{i&&i[Mt](),this.handleTurnIntoGroup(t,e)},[Pt]:e=>d[Gt](x.Z,r()({},e,{icon:this[Nt](h.Z.loop),[Et]:s()(v.FormattedMessage,{[Bt]:"Wrap in group",id:"database.filterMenu.wrapInGroupMenuTitle"}),caption:s()(v.FormattedMessage,{[Bt]:"Create a filter group around this",id:"database.filterMenu.wrapInGroupMenuCaption"})}))}),s()(He.Z,{[St]:this[Lt][Wt][Qt]?void 0:0,type:He.i[bt],[Zt]:[{key:kt,[Pt]:this[Lt][Wt][Qt]?e=>d[Gt]("div",e):e=>d[Gt]($e.Z,e),items:a}]})}handleDuplicateFilter(e){this[ft]((t=>{const i=t[e];if(i){const o={...i};t.splice(e,0,o)}})),m[pt](this[Lt],{[ht]:this[vt][ct],[Ct]:"duplicate_filter"})}handleTurnIntoGroup(e,t){const i={[ut]:this.getOppositeOperator(),[dt]:[t]};this[yt](e,i),this.openIndex(e),m[pt](this[Lt],{[ht]:this[vt][ct],[Ct]:"turn_into_filter_group"})}handleTurnIntoFilter(e,t){const i=a().first(t[dt]||[]);i&&!(0,c.Mm)(i)&&this[yt](e,i),m[pt](this[Lt],{[ht]:this[vt][ct],[Ct]:"turn_into_filter"})}handleDeleteFilter(e){this[ft]((t=>t.splice(e,1))),this[Je](e).reset(),this[Ut].splice(e,1)}openIndex(e){this[Je](e).setState({open:!0})}[Je](e){for(;this[Ut].length<e+1;){const e=new Z.Z;this[Ut].push(e)}return this[Ut][e]}getOppositeOperator(){return"or"===this[vt][at][ut]?"and":"or"}[Ot](){return this[vt][et]<2}[gt](e){const t=(this[vt][at][dt]||[]).filter(c.aN),i=t[t.length-1];return i?a().cloneDeep(i):(0,g.Me)(e)}[ft](e){const t=[...this[vt][at][dt]||[]],i=e(t),o={...this[vt][at],[dt]:t};return this[vt][lt](this[vt][st],o),i}[_t](){return(0,c.$1)(this[vt][at])&&0===this[vt][et]}getEmptyTextWrapStyle(){return{color:this.theme.lightTextColor,lineHeight:1.5,whiteSpace:"nowrap"}}getSubgridWrapperStyles(){return{background:this.theme.filterGroupBackground,borderRadius:3,boxShadow:`0 0 0 1px ${this.theme.filterGroupBorder}`,margin:1,alignSelf:"stretch"}}getGridStyles(){return Ht[It]}}function Yt(e){if((0,c.vA)(e)){const t=(e[dt]||[]).filter(c.vA);return 1+(a().max(t.map(Yt))||0)}return 0}function jt(e){const{[ut]:t,lowercase:i}=e;return"or"===t?s()(v.FormattedMessage,i?{id:"collectionFilterCombinatorGrid.filterOperator.or.lowercase",[Bt]:"or"}:{id:"collectionFilterCombinatorGrid.filterOperator.or",[Bt]:"Or"}):"and"===t?s()(v.FormattedMessage,i?{id:"collectionFilterCombinatorGrid.filterOperator.and.lowercase",[Bt]:"and"}:{id:"collectionFilterCombinatorGrid.filterOperator.and",[Bt]:"And"}):(0,p.unreachable)(t)}Ht.displayName="CollectionFilterCombinatorGrid",Ht[It]={[Ft]:"grid",gridTemplateColumns:`\n             [boolean-start] 60px\n             [boolean-end property-start] minmax(min-content, 120px)\n             [property-end operator-start] 110px\n             [operator-end value-start] auto\n             [value-end menu-start] ${K.fg}px\n             [menu-end]\n        `,gridAutoRows:`minmax(${K.fg}px, auto)`,gridColumnGap:K.l0,gridRowGap:K.cn,padding:`${K.cn}px ${K.l0}px 0 ${K.l0}px`,justifyItems:"stretch",alignItems:"start"}},28463:(e,t,i)=>{i.d(t,{Z:()=>lt,$:()=>st});var o=i(97464),r=i.n(o),n=i(77094),s=i.n(n),l=i(67294),a=i(83355),d=i(66897),u=i(76205),c=i(99036),h=i(80951),p=i(84619),v=i(40506),m=i(76725),g=i(32056),f=i(23014),y=i(97880),Z=i(82990),S=i(5366),M=i(50906),k=i(17335),b=i(29376),w=i(39098),F=i(77985),x=i(19777),T=i(68834),P=i(49085),C=i(8982),I=i(36488),R=i(74194),O=i(68894);const A=i(85).D7I,D=i(85).GDw,_=i(85).KS0,B=i(85).lWm,V=i(85).Scd,E=i(85).GGR,G=i(85).cZW,N=i(85).Yzm,L=i(85).Dd5,W=i(85).C$B,Q=i(85).K3k,U=i(85).Gnd,K=i(85).Wp_,z=i(85).b8T,H=i(85).mPA,Y=i(85).wfR,j=i(85).QvG,$=i(85).nx5,q=(0,S.defineMessages)({value:{[$]:"Value",id:"database.filterAndSort.propertyValueInput.placeholder"}});class X extends a.Z{constructor(){super(...arguments),this.storeTypes={[j]:P.default[Y](!1)},this[H]=null,this[z]=()=>{this[U][j][K](!0)},this[Q]=()=>{this[U][j][K](!1)},this.handleInputCancel=()=>{this[H]&&(this[H].handleBlur(),this[Q]())},this[W]=e=>{const t=e.target.value;this.props[L](t)}}renderComponent(){return s()("div",{style:{display:"flex",...this.getDivStyle()},onClick:this[z]},void 0,this.renderInput())}renderInput(){const{device:e}=this.environment,t=this[U][j].state,i=this.props.value||"",{intl:o}=this.props;return e.isMobile?s()(O.ZP,{value:i,[L]:this[W],[G]:o[N](q.value),onBlur:this[Q],rightMobileEditLabel:s()(S.FormattedMessage,{[$]:"Edit",id:"database.filterAndSort.mobileEditButton.label"})}):s()(C.i,{action:()=>this[U][j][K](!0),render:e=>l[A]("div",{ref:e.ref,[E]:e[E],style:{[V]:e.focused&&!t?this.theme[B]:_,...this.getDivStyle()}},s()(I.Z,{capture:t,render:e=>l[A]("div",r()({},e,{style:this.getDivStyle()}),l[A](R.Z,{focus:t,ref:e=>this[H]=e,value:i,[L]:this[W],[G]:o[N](q.value),onBlur:this[Q],onCancel:this.handleInputCancel,style:this[D]()}))}))})}getDivStyle(){return X.disableMarginStyles}[D](){return{...X.inputStyle,...X.disableMarginStyles,minWidth:F.bU}}}X.displayName="CollectionOperatorValueInput",X.inputStyle={marginRight:8,paddingLeft:6,paddingRight:0,width:80,height:30},X.disableMarginStyles={margin:0,width:"100%",height:"100%",transition:"background 120ms ease-in"};const J=(0,S.injectIntl)(X);var ee=i(26909),te=i(52275),ie=i(31945),oe=i(12508),re=i(14871),ne=i(92864),se=i(89845),le=i(62045),ae=i(69265),de=i(14390),ue=i(22084);const ce=i(85).NLk,he=i(85).Uie,pe=i(85).Tk1,ve=i(85).UPJ,me=i(85).eHP,ge=i(85).XgV,fe=i(85).u4F,ye=i(85).YDe,Ze=i(85).Qm2,Se=i(85).jQT,Me=i(85).Yzm,ke=i(85).oWD,be=i(85).TLr,we=i(85).OtN,Fe=i(85).sI1,xe=i(85).TtP,Te=i(85).rIj,Pe=i(85).n9C,Ce=i(85).cZW,Ie=i(85).D7I,Re=i(85).rpY,Oe=i(85).Gm5,Ae=i(85).iIv,De=i(85).kcY,_e=i(85).N1Z,Be=i(85).pHx,Ve=i(85).Dd5,Ee=i(85).F8H,Ge=i(85).QLQ,Ne=i(85).eiN,Le=i(85).$wW,We=i(85).dLQ,Qe=i(85).nSw,Ue=i(85).xOW,Ke=i(85).g7N,ze=i(85).PXg,He=i(85).nLZ,Ye=i(85).wgE,je=i(85).E0z,$e=i(85).P0R,qe=i(85).fBu,Xe=i(85).ffk,Je=i(85).Kiu,et=i(85).EIp,tt=i(85).WDI,it=i(85).opx,ot=i(85).nx5,rt=(0,S.defineMessages)({dateTitle:{[ot]:"Date",id:"database.filterMenu.mobileDateSelectMenu.title"},[it]:{[ot]:"Empty",id:"database.filterMenu.dateSelectMenu.emptyPlaceholder"}});class nt extends a.Z{constructor(){super(...arguments),this[tt]=this[et]((()=>{const{[Je]:e,[Xe]:t,[qe]:i}=this[$e],o=e[t];if(o&&(0,c.isRelationPropertySchema)(o))return(0,b.getRelatedCollectionAppConfigUri)(o,i)})),this.renderPersonInner=e=>{var t;const{[je]:i}=this[Ye];if(!e.value)return;if("relative"===e.type&&"me"===e.value)return s()("span",{style:{[He]:1,[ze]:10,[Ke]:6}},void 0,s()(S.FormattedMessage,{[ot]:"Me",id:"database.filterAndSort.firstPersonPropertyValue.title"},Ue));const o=(0,d.Hl)({pointer:e.value,[Qe]:this[$e][qe][Qe]});return s()(ne.ZP,{actor:o,[Le]:!1,shouldShrink:!1,format:i[We]?ne.vw.Format.Large:ne.vw.Format.Medium,showRemoveButton:!1},null===(t=o.asActor)||void 0===t?void 0:t.id)}}renderComponent(){const{[Ne]:e,[Xe]:t,[Ge]:i,[Je]:o,[qe]:r}=this[$e],n=this[$e].filterValueType,l=s()("span",{});if("date"===n)return(0,u.gE)(e)?(0,u.mv)(e)?l:(0,u.TQ)(e)?this.renderDateRangeFilterOperatorValue(e):this.renderDateFilterOperatorValue(e):l;if("text"===n){if(!(0,u.Ly)(e))return l;const t=e;if((0,u.mv)(t))return l;if("string_has_no_alphabet_prefix"===t.operator)return;const i=t.value;return s()(J,{value:i.value,[Ve]:e=>{const i={type:Ee,value:e},o={...t,value:i};this[$e][Ve](o)}})}if("number"===n){if(!(0,u.h6)(e))return l;const t=e;if((0,u.mv)(t))return l;const i=t.value;return s()(J,{value:void 0===i.value?"":i.value.toString(),[Ve]:e=>{const i=(0,g.p3)(e),o={type:Ee,value:i},r={...t,value:o};this[$e][Ve](r)}})}if("checkbox"===n){if(!(0,u.XA)(e)||!i)return l;const n=e,a=n.value;return s()(ie.ZP,{popupType:this[Ye][je][We]?ie.Z4[Be]:ie.Z4.Popup,renderOrigin:e=>this.renderCheckboxOrigin(a,e),[Re]:e=>s()(x.ZP,{[Ge]:i,propertyFilter:{[Xe]:t,[Ne]:n},[Je]:o,[Ve]:e=>{this[$e][Ve](e)},[Ae]:e[_e],[qe]:r,[Oe]:x.Qv[De],allowRelativePersonFilter:!0})})}if("select"===n||"multi_select"===n||"status"===n){if(!((0,u.dx)(e)||(0,u.NU)(e)||(0,u.r2)(e))||!i)return l;const n=e;if((0,u.mv)(n))return l;const a=this[$e][Je][this[$e][Xe]];if(!a)return l;const d=(0,u.dx)(n)?(0,u.mg)(n):(0,u.NU)(n)?(0,u.qC)(n):(0,u.Js)(a,(0,u.wB)(n));return s()(ie.ZP,{popupType:this[Ye][je][We]?ie.Z4[Be]:ie.Z4.Popup,renderOrigin:e=>this.renderSelectOrigin(d,e),[Re]:e=>s()(x.ZP,{[Ge]:i,propertyFilter:{[Xe]:t,[Ne]:n},[Je]:o,[Ve]:e=>{this[$e][Ve](e)},[Ae]:e[_e],[qe]:r,[Oe]:x.Qv[De],allowRelativePersonFilter:!0})})}if("location"===n){if(!(0,u.Mp)(e))return l;const n=e,a=(0,u.u0)(n);return s()(ie.ZP,{popupType:this[Ye][je][We]?ie.Z4[Be]:ie.Z4.Popup,renderOrigin:e=>this.renderLocationOrigin(a,e),[Re]:e=>s()(x.ZP,{[Ge]:i,propertyFilter:{[Xe]:t,[Ne]:n},[Je]:o,[Ve]:e=>{this[$e][Ve](e)},[Ae]:e[_e],[qe]:r,[Oe]:x.Qv[De],allowRelativePersonFilter:!0})})}if("relation"===n){if(!(0,u.e)(e)||!i)return l;const n=e;if((0,u.mv)(n))return l;const a=(0,u.YO)(n);return s()(ie.ZP,{popupType:this[Ye][je][We]?ie.Z4[Be]:ie.Z4.Popup,renderOrigin:e=>this.renderRelationOrigin(a,e),[Re]:e=>s()(x.ZP,{[Ge]:i,propertyFilter:{[Xe]:t,[Ne]:n},[Je]:o,[Ve]:e=>{this[$e][Ve](e)},[Ae]:e[_e],[qe]:r,[Oe]:x.Qv[De],allowRelativePersonFilter:!0})})}if("person"===n){if(!(0,u.Gb)(e)||!i)return l;const n=e;if((0,u.mv)(n))return l;const a=(0,u.R8)(n);return s()(ie.ZP,{popupType:this[Ye][je][We]?ie.Z4[Be]:ie.Z4.Popup,renderOrigin:e=>this.renderPersonOrigin(a,e),[Re]:e=>s()(x.ZP,{[Ge]:i,propertyFilter:{[Xe]:t,[Ne]:n},[Je]:o,[Ve]:e=>{this[$e][Ve](e)},[Ae]:e[_e],[qe]:r,[Oe]:x.Qv[De],allowRelativePersonFilter:!0})})}if("file"===n){if(!(0,u.W6)(e))return l;const t=e;if((0,u.mv)(t))return l;(0,y.unreachable)(t)}if("verification"===n)return(0,u.Jw)(e)?s()(ie.ZP,{popupType:this[Ye][je][We]?ie.Z4[Be]:ie.Z4.Popup,renderOrigin:t=>this.renderVerificationOrigin((0,u.fl)(e),t),[Re]:n=>s()(x.ZP,{[Ge]:i,propertyFilter:{[Xe]:t,[Ne]:e},[Je]:o,[Ve]:e=>{this[$e][Ve](e)},[Ae]:n[_e],[qe]:r,[Oe]:x.Qv[De],allowRelativePersonFilter:!1})}):l;(0,y.unreachable)(n)}renderCheckboxOrigin(e,t){const i=null==e?void 0:e.value;return l[Ie](le.Z,r()({},t,{disableMargins:!0,[Ce]:s()(S.FormattedMessage,{[ot]:"Select a value",id:"database.filterOperatorValue.checkboxPlaceholder.title"}),title:"boolean"==typeof i&&s()(oe.Z,{checked:i,size:16,disabled:!0})}))}renderSelectOrigin(e,t){const{[je]:i}=this[Ye],o=this[$e][Je][this[$e][Xe]],n=o&&((0,c.isSelectOrMultiSelectPropertySchema)(o)||"status"===o.type)&&o.options||[];return l[Ie](le.Z,r()({},t,{disableMargins:!0,desktopStyle:this[Pe](),[Fe]:this[Te](e[xe]>0),[Ce]:s()(S.FormattedMessage,{[ot]:"Select an option",id:"collections.operatorValueSelect.placeholder"}),title:e[xe]>0&&l[Ie](l.Fragment,null,e.map((e=>{if(void 0===e.value)return null;const t=(0,h.matchSelectOption)(n,e.value);return t?s()(ue.a,{format:i[We]?p.l.Large:p.l.Medium,[Le]:!1,value:t.value,color:t.color,showRemoveButton:!1},e.value):null})))}))}renderRelationOrigin(e,t){const{[je]:i}=this[Ye];return l[Ie](le.Z,r()({},t,{disableMargins:!0,desktopStyle:this[Pe](),[Fe]:this[Te](e[xe]>0),[Ce]:s()(S.FormattedMessage,{[ot]:"Select a page",id:"databaseRelationOperators.selectPlaceholder"}),title:e[xe]>0&&e.map((e=>{if(!e.value)return;const t=e.type,o={[Le]:!1,shouldShrink:!1,format:i[We]?p.l.Large:p.l.Medium};if("exact"===t)return l[Ie](ae.Z,r()({key:e.value,blockId:e.value,[qe]:this[$e][qe]},o));if("relative"===t){const t=this[tt].state;if(!t)return;return l[Ie](p.Z,r()({value:f.qB[t][e.value.variable].formattedMessage,[we]:"transparent",theme:this.theme},o))}(0,y.unreachable)(t)}))}))}renderLocationOrigin(e,t){const{[qe]:i}=this[$e];return l[Ie](le.Z,r()({},t,{disableMargins:!0,desktopStyle:this[Pe](),[Fe]:this[Te](e[xe]>0),[Ce]:s()(S.FormattedMessage,{[ot]:"Select a location",id:"databaseLocationOperators.selectPlaceholder"}),title:e[xe]>0&&e.map((e=>e.value&&s()("div",{style:{margin:"0 10px 6px 0"}},void 0,s()(T.Z,{[ke]:w.NW[be](i,{table:"collection",id:e.value})},e.value))))}))}renderPersonOrigin(e,t){return l[Ie](le.Z,r()({},t,{[Ce]:st(void 0),disableMargins:!0,desktopStyle:this[Pe](),[Fe]:this[Te](e[xe]>0),title:e[xe]>0&&e.map(this.renderPersonInner)}))}renderDateFilterOperatorValue(e){const{intl:t,[Ge]:i,[Xe]:o,[Je]:n,[qe]:a}=this[$e];if(!i)return;const d={menuTitle:t[Me](rt.dateTitle),items:u.tO,getKey:e=>"relative"===e.type?e.value:e.type,selectedItem:e.value,onSelect:t=>{const i={...e,value:t};this[$e][Ve](i),M[Se](this[Ye],{[Ze]:this[$e][ye],action:fe})},renderItem:e=>l[Ie](te.Z,r()({title:(0,k.x)(e.value)},e)),renderOrigin:i=>l[Ie](le.Z,r()({},i,{disableMargins:!0,[Ce]:t[Me](rt[it]),title:(0,k.x)(e.value)}))},c=e.value;if("exact"===c.type){const t=s()(l.Fragment,{},void 0,s()(S.FormattedMessage,{id:"collectionFilterMenuFilterOperatorValue.date.exact.order",[ot]:"{exact}{dateValue}",values:{[Ee]:l[Ie](re.Z,r()({key:ge},d,{mobileActionSheet:!0})),[me]:s()(ie.ZP,{popupType:this[Ye][je][We]?ie.Z4[Be]:ie.Z4.Popup,renderOrigin:e=>this.renderExactDateOrigin(c,e,!1),[Re]:t=>s()(x.ZP,{[Ge]:i,propertyFilter:{[Xe]:o,[Ne]:e},[Je]:n,[Ve]:e=>{this[$e][Ve](e)},[Ae]:t[_e],[qe]:a,[Oe]:x.Qv[De],allowRelativePersonFilter:!0})})}})),u=this[Ye][je].isDesktop?{display:"grid",[ve]:"stretch",[pe]:"1fr 1fr",gridColumnGap:ee.l0,width:"100%"}:void 0;return s()("div",{style:u},void 0,t)}return l[Ie](re.Z,r()({key:ge},d,{mobileActionSheet:!0}))}renderExactDateOrigin(e,t,i){const o=this[$e][Je][this[$e][Xe]],n=o&&"date"===o.type?o.date_format:void 0;let a;if("exact"===e.type&&e.value)if((0,v.isDate)(e.value))a=e.value;else if((0,v.isPartialDateRange)(e.value)){const t=(0,v.getFilledDataFromPartialDateRange)(e.value);t&&(a=t.value)}return l[Ie](le.Z,r()({},t,{[Ce]:s()(S.FormattedMessage,i?{[ot]:"Select a range",id:"database.filterAndSort.dateRangePropertyValue.placeholder"}:{[ot]:"Select a date",id:"database.filterAndSort.datePropertyValue.placeholder"}),desktopStyle:{minWidth:165},title:a&&s()("span",{style:{...Z.Z[he]}},void 0,s()(se.Z,{value:a,dateFormat:n||v.defaultDateFormat})),disableMargins:!0}))}renderDateRangeFilterOperatorValue(e){const{intl:t,[qe]:i,[Je]:o,[Ge]:n,[Xe]:a}=this[$e];if(!n)return;const d={menuTitle:t[Me](rt.dateTitle),items:(0,u.bS)(),getKey:e=>(0,u.eX)(e),selectedItem:e.value,onSelect:t=>{const i={...e,value:t};this[$e][Ve](i),M[Se](this[Ye],{[Ze]:this[$e][ye],action:fe})},renderItem:e=>l[Ie](te.Z,r()({title:(0,k.ip)(e.value)},e)),renderOrigin:i=>l[Ie](le.Z,r()({},i,{disableMargins:!0,[Ce]:t[Me](rt[it]),title:(0,k.ip)(e.value)}))},c=e.value;if("exact"===c.type){const t=s()(l.Fragment,{},void 0,s()(S.FormattedMessage,{id:"collectionFilterMenuFilterOperatorValue.dateRange.exact.order",[ot]:"{dateValue}",values:{[Ee]:l[Ie](re.Z,r()({key:ge},d,{mobileActionSheet:!0})),[me]:s()(ie.ZP,{popupType:this[Ye][je][We]?ie.Z4[Be]:ie.Z4.Popup,renderOrigin:e=>this.renderExactDateOrigin(c,e,!0),[Re]:t=>s()(x.ZP,{[Ge]:n,propertyFilter:{[Xe]:a,[Ne]:e},[Je]:o,[Ve]:e=>{this[$e][Ve](e)},[Ae]:t[_e],[qe]:i,[Oe]:x.Qv[De],allowRelativePersonFilter:!0})})}})),u=this[Ye][je].isDesktop?{display:"grid",[ve]:"stretch",[pe]:"1fr 1fr",gridColumnGap:ee.l0,width:"100%"}:void 0;return s()("div",{style:u},void 0,t)}return"relative"!==c.type||"custom"!==c.value&&"surrounding"!==c.value?l[Ie](re.Z,r()({key:ge},d,{mobileActionSheet:!0})):s()(de.b,{renderAsQueryDropdown:this[Ye][je][We],[Ne]:c,onUpdate:t=>{const i={...e,value:t};this[$e][Ve](i),M[Se](this[Ye],{[Ze]:this[$e][ye],action:fe})}})}renderVerificationOrigin(e,t){const i=e[Ne]((e=>{let{value:t}=e;return Boolean(t)})).map(k.cq);return l[Ie](le.Z,r()({},t,{disableMargins:!0,[Ce]:s()(S.FormattedMessage,{[ot]:"Select an option",id:"CollectionFilterMenuFilterOperatorValue.verificationFilterSelect.placeholder"}),title:i[xe]&&s()("span",{},void 0,(0,m.Z)(i,(e=>s()("span",{style:{[ce]:"pre"}},e,s()(S.FormattedMessage,{[ot]:", ",id:"CollectionFilterMenuFilterOperatorValue.verificationFilterSelect.commaSeparator"})))))}))}[Pe](){return{maxWidth:F.oe}}[Te](e){return{paddingTop:e?6:void 0,overflow:"hidden"}}}function st(e){return s()(S.FormattedMessage,e?{[ot]:"Select one person",id:"database.personPropertyValue.selectPerson.searchPlaceholderWithLimit"}:{[ot]:"Select one or more people",id:"database.personPropertyValue.selectPerson.searchPlaceholder"})}nt.displayName="CollectionFilterMenuFilterOperatorValue";const lt=(0,S.injectIntl)(nt)},19777:(e,t,i)=>{i.d(t,{Qv:()=>Xi,ZP:()=>ro,I4:()=>so,Sm:()=>no});var o=i(97464),r=i.n(o),n=i(77094),s=i.n(n),l=i(96486),a=i.n(l),d=i(67294),u=i(83355),c=i(480),h=i(81954),p=i(49085),v=i(66897),m=i(76205),g=i(99036),f=i(80951),y=i(84619),Z=i(23482),S=i(40506),M=i(53877),k=i(58573),b=i(42875),w=i(3909),F=i(32056),x=i(23014),T=i(21202),P=i(77420),C=i(13493),I=i(29369),R=i(19889),O=i(70203),A=i(97880),D=i(82990),_=i(4308),B=i(5366),V=i(31299),E=i(28020),G=i(97004),N=i(17335),L=i(26991),W=i(33929),Q=i(87279),U=i(98742),K=i(98165),z=i(29376),H=i(59054),Y=i(54814);var j=i(79315),$=i(61766),q=i(29798),X=i(39098),J=i(68834),ee=i(28398),te=i(97180),ie=i(64921),oe=i(52275),re=i(31945),ne=i(12508),se=i(73063),le=i(68894),ae=i(3386),de=i(68785),ue=i(78140),ce=i(32163),he=i(43765),pe=i(40721),ve=i(44532),me=i(11470),ge=i(77137),fe=i(72495),ye=i(14871),Ze=i(58032),Se=i(92864),Me=i(64369),ke=i(66653),be=i(41209),we=i(93289),Fe=i(83264),xe=i(78948),Te=i(69265),Pe=i(22084),Ce=i(85567),Ie=i(47082);const Re=i(85).kcY,Oe=i(85).sww,Ae=i(85).UPJ,De=i(85).oWD,_e=i(85).XPl,Be=i(85).g5Y,Ve=i(85).TLr,Ee=i(85).ChN,Ge=i(85).a3v,Ne=i(85).wuN,Le=i(85).jkI,We=i(85).H1U,Qe=i(85).NF1,Ue=i(85).XCs,Ke=i(85).YDv,ze=i(85).HAy,He=i(85).NeY,Ye=i(85).KMV,je=i(85).BDY,$e=i(85).Uie,qe=i(85).AIq,Xe=i(85).EMU,Je=i(85).sM5,et=i(85).uOK,tt=i(85).nxm,it=i(85).TEz,ot=i(85).nLZ,rt=i(85).Fk5,nt=i(85).LlE,st=i(85).LtW,lt=i(85).MH8,at=i(85).Wp_,dt=i(85).Hco,ut=i(85).Lnw,ct=i(85).mUE,ht=i(85).y4s,pt=i(85).Neb,vt=i(85).qJ8,mt=i(85).DxG,gt=i(85).r2Q,ft=i(85).qir,yt=i(85).aoh,Zt=i(85).jM,St=i(85).Gm5,Mt=i(85).Exd,kt=i(85).fbO,bt=i(85).f57,wt=i(85).OtN,Ft=i(85).KS0,xt=i(85).xgV,Tt=i(85).PG2,Pt=i(85)._V5,Ct=i(85).tBn,It=i(85).BCA,Rt=i(85).XtO,Ot=i(85).ymD,At=i(85).Mm1,Dt=i(85).wDG,_t=i(85)._aV,Bt=i(85).UA5,Vt=i(85).qc1,Et=i(85).Au,Gt=i(85).auS,Nt=i(85).OBh,Lt=i(85).Gnd,Wt=i(85).QmD,Qt=i(85).$Vf,Ut=i(85).nSw,Kt=i(85).ffk,zt=i(85).TtP,Ht=i(85).d73,Yt=i(85).uJ5,jt=i(85).gaz,$t=i(85).N20,qt=i(85).Ql2,Xt=i(85).OdC,Jt=i(85).rSD,ei=i(85).j7K,ti=i(85).nQ3,ii=i(85).Lhq,oi=i(85).y79,ri=i(85).Joh,ni=i(85).BQ6,si=i(85).NLk,li=i(85).fsm,ai=i(85).ESK,di=i(85).rG,ui=i(85).uM3,ci=i(85).Ie8,hi=i(85).Kiu,pi=i(85).fBu,vi=i(85).iwd,mi=i(85).EIp,gi=i(85).zuB,fi=i(85).zkl,yi=i(85).eiN,Zi=i(85).X5t,Si=i(85).urI,Mi=i(85).$wW,ki=i(85).rpY,bi=i(85).D7I,wi=i(85).Jkr,Fi=i(85).I7L,xi=i(85).qpZ,Ti=i(85).iIv,Pi=i(85).iVN,Ci=i(85).cYK,Ii=i(85).eG0,Ri=i(85).Zij,Oi=i(85).ceT,Ai=i(85).Zes,Di=i(85).dLQ,_i=i(85).kdC,Bi=i(85).cZW,Vi=i(85).Dd5,Ei=i(85).PXg,Gi=i(85).XNW,Ni=i(85).Yzm,Li=i(85).F8H,Wi=i(85).MWD,Qi=i(85).vwy,Ui=i(85).nm$,Ki=i(85).wgE,zi=i(85).E0z,Hi=i(85).P0R,Yi=i(85).P0G,ji=i(85).wfR,$i=i(85).VMs,qi=i(85).nx5;let Xi;!function(e){e[e[Re]=0]=Re,e[e[yt]=1]=yt}(Xi||(Xi={}));const Ji=(0,B.defineMessages)({startingMessage:{[qi]:"Select or type a date...",id:"search.dateMenu.dateMessage"}}),eo="50vh";class to extends u.Z{constructor(){super(...arguments),this.storeTypes={[$i]:p.default[ji](""),[Yi]:q.Z,dateFilterPopupStore:$.Z,dateRangeFilterPopupStore:$.Z},this.renderTextMenu=e=>{const{intl:t}=this[Hi],{[zi]:i}=this[Ki],o=s()(fe.Z,{isInput:!0,disableDesktopPadding:!0},void 0,s()(le.ZP,{focus:!0,focusInitial:!0,focusAfterAnimation:!0,value:(0,m.vR)(e)&&e.value.value?e.value.value:"",[Vi]:e=>{const t=e[Ui].value;this[Qi]({[Wi]:Li,value:t})},onClearButtonClick:()=>{this[Qi]({[Wi]:Li,value:void 0})},[Bi]:t[Ni]({[qi]:"Type a value…",id:"database.filterValue.textType.searchPlaceholder"}),[_i]:!0,textWrapperStyle:{[Gi]:8,[Ei]:8}})),r=s()(fe.Z,{disableMobileBorders:!0,disableMobilePadding:!0},void 0,!i[Di]&&this[Ai](),(0,m.vR)(e)&&o);let n;return n=i[Di]?{[Oi]:Q.og.Modal,[Ri]:this[Ii](),left:this[Ci](),right:s()(pe.DoneMenuText,{}),[Pi]:this[Hi][Ti],[xi]:r}:{[Oi]:Q.og.Popup,[Fi]:eo,[wi]:220,[xi]:r},d[bi](ue.Z,n)},this.renderNumberMenu=e=>{const{intl:t}=this[Hi],{[zi]:i}=this[Ki],o=s()(fe.Z,{isInput:!0,disableDesktopPadding:!0},void 0,s()(le.ZP,{focus:!0,focusInitial:!0,focusAfterAnimation:!0,value:(0,m.vR)(e)&&"number"==typeof e.value.value?e.value.value.toString():"",inputLeft:this.renderNumberOperator(e),[Vi]:e=>{const t=(0,F.p3)(e[Ui].value);this[Qi]({[Wi]:Li,value:t})},onClearButtonClick:()=>{this[Qi]({[Wi]:Li,value:void 0})},[Bi]:t[Ni]({[qi]:"Type a value…",id:"database.filterValue.numberType.searchPlaceholder"}),[_i]:!0,textWrapperStyle:{[Gi]:8,[Ei]:8}})),r=s()(fe.Z,{disableMobileBorders:!0,disableMobilePadding:!0},void 0,!i[Di]&&this[Ai](),(0,m.vR)(e)&&o);let n;return n=i[Di]?{[Oi]:Q.og.Modal,[Ri]:this[Ii](),left:this[Ci](),right:s()(pe.DoneMenuText,{}),[Pi]:this[Hi][Ti],[xi]:r}:{[Oi]:Q.og.Popup,[Fi]:eo,[wi]:220,[xi]:r},d[bi](ue.Z,n)},this.renderUserMenuItem=(e,t)=>{const{[zi]:i}=this[Ki],o=Boolean(t.find((t=>{var i;return"exact"===t[Wi]&&(null===(i=t.value)||void 0===i?void 0:i.id)===e.id})));return{key:e.id,[ki]:t=>d[bi](oe.Z,r()({},t,{[Ri]:s()(Se.vw,{[Mi]:!0,shouldShrink:!0,[Si]:i[Di]?Se.vw.Format.Large:Se.vw.Format.Medium,userValue:e,showRemoveButton:!1}),isTokenTitle:!0,checkState:o})),[Zi]:()=>{const i=o?t[yi]((t=>{var i;return!("exact"===t[Wi]&&(null===(i=t.value)||void 0===i?void 0:i.id)===e.id)})):[...t,{[Wi]:Li,value:{[fi]:R.KJ,id:e.id}}];this[Qi](i)}}},this.renderBotMenuItem=(e,t)=>{const{[zi]:i}=this[Ki],o=Boolean(t.find((t=>{var i;return"exact"===t[Wi]&&(null===(i=t.value)||void 0===i?void 0:i.id)===e.id})));return{key:e.id,[ki]:t=>d[bi](oe.Z,r()({},t,{[Ri]:s()(Se.Jn,{[Mi]:!0,shouldShrink:!0,[Si]:i[Di]?Se.Jn.Format.Large:Se.Jn.Format.Medium,botValue:e,showRemoveButton:!1}),isTokenTitle:!0,checkState:o})),[Zi]:()=>{const i=o?t[yi]((t=>{var i;return!("exact"===t[Wi]&&(null===(i=t.value)||void 0===i?void 0:i.id)===e.id)})):[...t,{[Wi]:Li,value:{[fi]:P.cZ,id:e.id}}];this[Qi](i)}}},this[gi]=this[mi]((()=>{const e=this[vi]();return e&&(0,g.isRelationPropertySchema)(e)?{appConfigUri:(0,z.getRelatedCollectionAppConfigUri)(e,this[Hi][pi]),[hi]:(0,z.getRelatedCollectionSchema)(e,this[Hi][pi])}:{}})),this.renderMoreActionsPopup=e=>{const{allowAddingToCombinatorFilter:t}=this[Hi],{[zi]:i}=this[Ki];let o;o=i[Di]?{[Oi]:Q.og[ci]}:{[Oi]:Q.og.Popup,[Fi]:eo};const n=a()[ui]([{key:di,[ki]:e=>d[bi](oe.Z,r()({},e,{[Ri]:s()(B.FormattedMessage,{id:"database.filterValue.deleteFilter.title",[qi]:"Delete filter"}),icon:w.Z.trash({[wi]:14})})),[Zi]:()=>{var t,i;e.close(),null===(t=(i=this[Hi]).onDelete)||void 0===t||t.call(i)}},t&&{key:"merge",[ki]:e=>s()(Ze.Z,{placement:Ze.Z[ai].Right,[ni]:{[li]:240,[si]:void 0},[ri]:()=>s()("div",{},void 0,s()(ee.ep,{})),[ki]:t=>d[bi](oe.Z,r()({},(0,U.Z)(e,t),{[Ri]:s()(B.FormattedMessage,{id:"database.filterValue.mergeIntoAdvancedFilter.title",[qi]:"Add to advanced filter"}),icon:w.Z[yi]({[wi]:14})}))}),[Zi]:()=>{var t,i;e.close(),null===(t=(i=this[Hi]).onAddToCombinatorFilter)||void 0===t||t.call(i)}}]);return d[bi](ue.Z,o,s()(ce.Z,{[Wi]:ce.i[oi],[ti]:[{key:ii,[ki]:e=>d[bi](fe.Z,r()({disableMobilePadding:!0},e)),items:n}],[ei]:void 0}))},this[Jt]=e=>{var t,i;null===(t=(i=this[Hi])[Ti])||void 0===t||t.call(i)},this.getPersonAutocompleteResults=async e=>{let{users:t,bots:i}=await V.searchSpaceActors({[Ki]:this[Ki],[$i]:e,membersOnly:!1});return t=t[Xt](0,20),i=i[Xt](0,20),await Promise.all([...t.map((async e=>{let{id:t}=e;const i=(0,X.Kv)(this[Hi][pi],{[fi]:R.KJ,id:t});await i.load()})),...i.map((async e=>{const t=(0,X.Kv)(this[Hi][pi],{[fi]:P.cZ,id:e.id,[qt]:e.space_id});await t.load()}))]),{users:t,bots:i}},this.getRelationAutocompleteResults=async e=>{const{[$i]:t,[qt]:i,[$t]:o}=e;if(!i||!o)return[];const{results:r}=await V.searchPagesInCollection({[Ki]:this[Ki],[$i]:t,[$t]:o,limit:20,[qt]:i,[jt]:!0,source:"relation_menu",[Yt]:!1,[Ht]:!1});return 0===r[zt]?[]:(await Promise.all(r.map((async e=>{const t=(0,X.Kv)(this[Hi][pi],{[fi]:T.iU,id:e});await t.load()}))),r)}}renderComponent(){return s()(ae.Z,{capture:!0,onEsc:this[Jt]},void 0,this.renderMenu())}renderMenu(){const{propertyFilter:e,[hi]:t,[pi]:i}=this[Hi],{[Kt]:o,[yi]:r}=e,n=(0,m.fI)({[hi]:t,[Kt]:o,[Ut]:i[Ut]}),l=(0,m.a_)(r)?r[Qt]:r;if("text"===n)return(0,m.Ly)(l)&&this.renderTextMenu(l);if("relation"===n)return(0,m.e)(l)&&this.renderRelationRequest(l);if("checkbox"===n)return(0,m.XA)(l)&&this.renderCheckboxMenu(l);if("select"===n||"multi_select"===n)return((0,m.dx)(l)||(0,m.NU)(l))&&this.renderSelectMenu(l);if("status"===n)return(0,m.r2)(l)&&this.renderStatusMenu(l);if("person"===n)return(0,m.Gb)(l)&&this.renderPersonRequest(l);if("number"===n)return(0,m.h6)(l)&&this.renderNumberMenu(l);if("date"===n)return(0,m.gE)(l)&&this.renderDateMenu(l);if("file"===n);else{if("location"===n)return(0,m.Mp)(l)?s()(oo,{[yi]:l,[pi]:i,[Qi]:e=>this[Qi](e),[Ti]:this[Hi][Ti],desktopTopActions:this[Ai](),mobileMenuTitle:this[Ii](),mobileMoreActions:this[Ci]()}):null;if("verification"===n)return(0,m.Jw)(l)&&this.renderVerificationMenu(l);(0,A.unreachable)(n)}}renderSelectMenu(e){const{intl:t}=this[Hi],{[zi]:i}=this[Ki],o=this[Lt][$i][Wt],r=this[vi]();if(!r||!(0,g.isSelectOrMultiSelectPropertySchema)(r))return;const n=r.options||[],l=(0,m.vR)(e)?(0,m.dx)(e)?(0,m.mg)(e):(0,m.qC)(e):[],u=so({[$i]:o,[Nt]:r,selectedValues:l,[Qi]:e=>{this[Qi](e)},[Di]:i[Di],styles:{checkboxIcon:{fill:this[Et][Gt],[Vt]:"none"}}}),c=l.map((e=>{if(void 0===e.value)return;const t=(0,f.matchSelectOption)(n,e.value);return t?s()(Pe.a,{[Si]:i[Di]?y.l.Large:y.l.Small,[Mi]:!1,value:t.value,[Bt]:t[Bt],showRemoveButton:!0,onClickRemove:()=>{const t=a().without(l,e);this[Qi](t)}},t.id):void 0})),h=s()(Ie.Z,{focus:!i[Di]||void 0,focusAfterAnimation:!0,[Si]:Ie.Z.Format.FilterValue,tokens:c,[Bi]:t[Ni]({[qi]:"Select one or more options…",id:"database.filterValue.selectType.searchPlaceholder"}),onRemoveLastToken:()=>{const e=l[Xt](0,l[zt]-1);this[Qi](e)},onClearButtonClick:()=>{var e,t;this[Qi]([]),null===(e=(t=this[Hi])[Ti])||void 0===e||e.call(t)},value:this[Lt][$i][Wt],[Vi]:e=>{this[_t](e[Ui].value)},dontShowBorderBottom:i[Dt],[_i]:!0}),p=s()(fe.Z,{desktopStyle:{[At]:0}},void 0,!i[Di]&&this[Ai](),(0,m.vR)(e)&&h);let v;return v=i[Di]?{[Oi]:Q.og.Modal,[Ri]:this[Ii](),left:this[Ci](),right:s()(pe.DoneMenuText,{}),[Pi]:this[Hi][Ti],[xi]:p}:{[Oi]:Q.og.Popup,[Fi]:eo,[wi]:260,[xi]:p,[Ot]:!0,tokenInputHeader:!0},d[bi](ue.Z,v,(0,m.vR)(e)&&d[bi](d[Ct],null,0===u[zt]&&s()(fe.Z,{},void 0,s()(he.Z,{[Ri]:s()(B.FormattedMessage,{[qi]:"No results",id:"database.filterValue.selectType.noResults.message"})})),u[zt]>0&&s()(ce.Z,{[Wi]:ce.i[oi],[ei]:0,[ti]:[{key:"select",[ki]:e=>d[bi](fe.Z,e),items:u}],[Rt]:this[Lt][Yi],[It]:()=>{this[_t]("")}})))}renderStatusMenu(e){const{[zi]:t}=this[Ki],i=this[vi]();if(!i||"status"!==i[Wi])return;const o=s()(fe.Z,{desktopStyle:{[At]:0}},void 0,!t[Di]&&this[Ai]());let n;n=t[Di]?{[Oi]:Q.og.Modal,[Ri]:this[Ii](),left:this[Ci](),right:s()(pe.DoneMenuText,{}),[Pi]:this[Hi][Ti],[xi]:o}:{[Oi]:Q.og.Popup,[Fi]:eo,[wi]:260,[xi]:o,[Ot]:!0,tokenInputHeader:!0};const l=(0,m.vR)(e)?(0,m.wB)(e):[],a=no({[Nt]:i,statusFilterValues:l,[Qi]:e=>{this[Qi](e)},[Di]:t[Di],styles:{checkboxIcon:{fill:this[Et][Gt]}}}),u=s()(ce.Z,{[Wi]:ce.i[oi],[ei]:0,[ti]:[{key:"groups",items:a,[ki]:e=>d[bi](fe.Z,r()({},e,{[Ri]:"",[ni]:{[Pt]:0}}))}]}),c=s()(fe.Z,{topBorder:!0},void 0,s()(oe.Z,{[Ri]:s()(B.FormattedMessage,{[qi]:"Clear selection",id:"database.filterValue.selectType.clearSelection.message"}),focused:!1,[Tt]:()=>{this[Qi]([])}}));return d[bi](ue.Z,n,(0,m.vR)(e)&&d[bi](d[Ct],null,u,c))}renderPersonRequest(e){const t=this[Lt][$i][Wt];return s()(ge.Z,{request:t,[xt]:this.getPersonAutocompleteResults,[ki]:(t,i)=>this.renderPersonMenu(e,t,i)})}renderPersonMenu(e,t,i){const{intl:o}=this[Hi],{[zi]:n}=this[Ki],l=this[Lt][$i][Wt],u=this[vi]();if(!u)return;const c=(0,m.vR)(e)?(0,m.R8)(e):[],h=a()[ui](c.map((e=>{if("exact"===e[Wi]&&e.value){const t=(0,v.Hl)({pointer:e.value,[Ut]:this[Hi][pi][Ut]});return s()(Se.ZP,{actor:t,[Si]:n[Di]?Se.ZP.Format.Large:Se.ZP.Format.Small,showRemoveButton:!0,onClickRemove:()=>{const t=a().without(c,e);this[Qi](t)},shouldShrink:!0,[Mi]:!1},e.value.id)}if("relative"===e[Wi]&&"me"===e.value&&this[Hi].allowRelativePersonFilter)return s()(Ce.Z,{[Si]:n[Di]?y.l.Large:y.l.Small,value:this.renderMeMessage(),onClickRemove:()=>{const t=a().without(c,e);this[Qi](t)},showRemoveButton:!0,[Mi]:!1,shouldShrink:!0,[wt]:Ft,showFullValueTooltip:!0})}))),p=s()(Ie.Z,{focus:!n[Di]||void 0,focusAfterAnimation:!0,[Si]:Ie.Z.Format.FilterValue,tokens:h,[Bi]:o[Ni]({[qi]:"Search for one or more people…",id:"database.filterValue.personType.searchPlaceholder"}),onRemoveLastToken:()=>{const e=c[Xt](0,c[zt]-1);this[Qi](e)},onClearButtonClick:()=>{var e,t;this[Qi]([]),null===(e=(t=this[Hi])[Ti])||void 0===e||e.call(t)},value:this[Lt][$i][Wt],[Vi]:e=>{this[_t](e[Ui].value)},dontShowBorderBottom:n[Dt],[_i]:!0,[ni]:{[Fi]:"20vh",overflowY:bt}}),g=s()(fe.Z,{desktopStyle:{[At]:0}},void 0,!n[Di]&&this[Ai](),(0,m.vR)(e)&&p);let f;f=n[Di]?{[Oi]:Q.og.Modal,[Ri]:this[Ii](),left:this[Ci](),right:s()(pe.DoneMenuText,{}),[Pi]:this[Hi][Ti],[xi]:g}:{[Oi]:Q.og.Popup,[Fi]:eo,[wi]:260,[xi]:g,[Ot]:!0};const Z=a()[ui]((i&&i.users||[]).map((e=>this.renderUserMenuItem(e,c)))),S=["created_by","last_edited_by"][kt](u[Wi])?a()[ui]((i&&i.bots||[]).map((e=>this.renderBotMenuItem(e,c)))):[];if(this[Hi].allowRelativePersonFilter&&i&&(!l||"me"[kt](l))){const e=Boolean(c.find((e=>"relative"===e[Wi]&&"me"===e.value)));Z.unshift({key:"me",[ki]:t=>d[bi](oe.Z,r()({},t,{[Ri]:this.renderMeMessage(),checkState:e,[ni]:n[Di]?void 0:{[Mt]:14}})),[Zi]:()=>{const t=e?c[yi]((e=>{let{value:t}=e;return"me"!==t})):[...c,{[Wi]:"relative",value:"me"}];this[Qi](t)}})}const M=[];return Z[zt]>0&&M.push({key:"user property",[ki]:e=>d[bi](fe.Z,r()({desktopStyle:{[Pt]:0}},e)),items:Z}),S[zt]>0&&M.push({key:"bot property",[ki]:e=>d[bi](fe.Z,r()({},e,{[Ri]:"Pick a bot"})),items:S}),d[bi](ue.Z,f,(0,m.vR)(e)&&d[bi](d[Ct],null,t&&s()(fe.Z,{},void 0,s()(he.Z,{[Ri]:s()(B.FormattedMessage,{[qi]:"Something went wrong.",id:"database.filterValue.personType.searchPersonPropertyMenuItem.errorMessage"})})),0===M[zt]&&i&&!t&&s()(fe.Z,{},void 0,s()(he.Z,{[Ri]:s()(B.FormattedMessage,{[qi]:"No results",id:"database.filterValue.personType.noResults.message"})})),!i&&!t&&s()(fe.Z,{},void 0,s()(xe.Z,{})),M[zt]>0&&s()(ce.Z,{[Wi]:ce.i[oi],[ei]:0,[ti]:M,[Rt]:this[Lt][Yi],[It]:()=>{this[_t]("")}})))}renderCheckboxMenu(e){var t;const{[zi]:i}=this[Ki],{[St]:o}=this[Hi];let n;n=i[Di]?{[Oi]:Q.og.Modal,[Ri]:this[Ii](),left:this[Ci](),right:s()(pe.DoneMenuText,{}),[Pi]:this[Hi][Ti]}:{[Oi]:Q.og.Popup,[Fi]:eo,[wi]:220,footer:this[Zt](e)};const l=null===(t=e.value)||void 0===t?void 0:t.value;return d[bi](ue.Z,n,o===Xi[yt]&&s()(fe.Z,{},void 0,!i[Di]&&this[Ai]()),s()(ce.Z,{[Wi]:ce.i[oi],[ei]:0,[ti]:[{key:ft,[ki]:e=>d[bi](fe.Z,r()({[ni]:o===Xi[yt]?{[Pt]:0}:void 0},e)),items:[{key:gt,[ki]:e=>d[bi](oe.Z,r()({},e,{[Ri]:s()(B.FormattedMessage,{[qi]:"Unchecked",id:"database.filterValue.checkboxType.unchecked.title"}),isTokenTitle:!0,checkState:!1===l})),[Zi]:()=>{this[Qi]({[Wi]:Li,value:!1})}},{key:mt,[ki]:e=>d[bi](oe.Z,r()({},e,{[Ri]:s()(B.FormattedMessage,{[qi]:"Checked",id:"database.filterValue.checkboxType.checked.title"}),isTokenTitle:!0,checkState:!0===l})),[Zi]:()=>{this[Qi]({[Wi]:Li,value:!0})}}]}],[Rt]:this[Lt][Yi],[It]:this[Hi][Ti]}),i[Di]&&this[Zt](e))}renderRelationRequest(e){const t=this[Lt][$i][Wt],{[vt]:i}=j.default[Wt],o=this[vi]();if(!o||!(0,g.isRelationPropertySchema)(o)||!i)return;const r=i.id,n=(0,g.getRelationPropertyCollectionId)(o);return n?s()(ge.Z,{request:{[$i]:t,[qt]:r,[$t]:n},[xt]:this.getRelationAutocompleteResults,[ki]:(t,i)=>this.renderRelationMenu(e,t,i)}):void 0}renderRelationMenu(e,t,i){const{intl:o}=this[Hi],{[zi]:n}=this[Ki],l=this[Lt][$i][Wt],u=this[vi]();if(!u||!(0,g.isRelationPropertySchema)(u))return;const c=(0,g.getRelationPropertyCollectionId)(u);if(!c)return;const h=(0,m.vR)(e)?(0,m.YO)(e):[],p=a()[ui](h.map((e=>{if(!e.value)return;const t={[Si]:n[Di]?y.l.Large:y.l.Small,shouldWrap:!1,showRemoveButton:!0,[Mi]:!1,shouldShrink:!0,onClickRemove:()=>{const t=a().without(h,e);this[Qi](t)}},i=e[Wi];if("exact"===i)return d[bi](Te.Z,r()({key:e.value,blockId:e.value,[pi]:this[Hi][pi]},t));if("relative"===i){var o,s;const{appConfigUri:i}=this[gi][Wt];if(!i)return;return d[bi](Ce.Z,r()({value:null===(o=x.qB[i])||void 0===o||null===(s=o[e.value.variable])||void 0===s?void 0:s.formattedMessage,[wt]:Ft,showFullValueTooltip:!0},t))}(0,A.unreachable)(i)}))),v=s()(Ie.Z,{focus:!n[Di]||void 0,focusAfterAnimation:!0,[Si]:Ie.Z.Format.FilterValue,tokens:p,[Bi]:o[Ni]({[qi]:"Search for one or more pages…",id:"database.filterValue.relationType.searchPlaceholder"}),onRemoveLastToken:()=>{const e=h[Xt](0,h[zt]-1);this[Qi](e)},onClearButtonClick:()=>{var e,t;this[Qi]([]),null===(e=(t=this[Hi])[Ti])||void 0===e||e.call(t)},value:this[Lt][$i][Wt],[Vi]:e=>{this[_t](e[Ui].value)},dontShowBorderBottom:n[Dt],[ni]:{[Fi]:"20vh",overflowY:bt},[_i]:!0}),f=s()(fe.Z,{desktopStyle:{[At]:0}},void 0,!n[Di]&&this[Ai](),(0,m.vR)(e)&&v);let Z;Z=n[Di]?{[Oi]:Q.og.Modal,[Ri]:this[Ii](),left:this[Ci](),right:s()(pe.DoneMenuText,{}),[Pi]:this[Hi][Ti],[xi]:f}:{[Oi]:Q.og.Popup,[Fi]:eo,[wi]:260,[xi]:f,[Ot]:!0};const S=this.getTemplatePageStore();i&&!l&&S&&c&&S.getParentCollectionId()===c&&(i=a().uniq([S.id,...i]));let M=[];if(i){const e=this.getExactRelationMenuItems(i,h);M=((0,m.a_)(this[Hi].propertyFilter[yi])?[]:this.getRelativeRelationMenuItems(l,h)).concat(e)}return d[bi](ue.Z,Z,(0,m.vR)(e)&&d[bi](d[Ct],null,t&&s()(fe.Z,{},void 0,s()(he.Z,{[Ri]:s()(B.FormattedMessage,{[qi]:"Something went wrong.",id:"database.filterValue.relationType.searchRelationPropertyMenuItem.errorMessage"})})),0===M[zt]&&i&&!t&&s()(fe.Z,{},void 0,s()(he.Z,{[Ri]:s()(B.FormattedMessage,{[qi]:"No results",id:"database.filterValue.relationType.noResults.message"})})),!i&&!t&&s()(fe.Z,{},void 0,s()(xe.Z,{})),M[zt]>0&&s()(ce.Z,{[Wi]:ce.i[oi],[ei]:0,[ti]:[{key:"results",[ki]:e=>d[bi](fe.Z,e),items:M}],[Rt]:this[Lt][Yi],[It]:()=>{this[_t]("")}})))}renderDateMenu(e){const{[St]:t}=this[Hi],{[zi]:i}=this[Ki];let o;return o=i[Di]?{[Oi]:Q.og.Modal,[Ri]:this[Ii](),left:this[Ci](),right:s()(pe.DoneMenuText,{}),[Pi]:this[Hi][Ti]}:{[Oi]:Q.og.Popup,[Fi]:eo},d[bi](ue.Z,o,t===Xi[yt]&&!i[Di]&&s()(fe.Z,{desktopStyle:{[At]:0}},void 0,this[Ai]()),(0,m.vR)(e)?(0,m.TQ)(e)?this.renderDateRangePicker(e):this.renderDatePicker(e):void 0)}renderDateRangePicker(e){const t=this[vi]();if(!t)return;let i;if((0,m.TQ)(e)&&"exact"===e.value[Wi]&&e.value.value){const t=e.value.value;i={starting:t[pt]?{[Wi]:ht,[pt]:t[pt]}:void 0,ending:t.end_date?{[Wi]:ht,[pt]:t.end_date}:void 0}}else i=(0,m.TQ)(e)&&"relative"===e.value[Wi]?e.value:{starting:void 0,ending:void 0};const o={disableMenuWrap:!0,[Ri]:t.name,value:i,onUpdate:e=>{var t,o;if(e.error)return;const r={...i,...e.value},n=null===(t=r.starting)||void 0===t?void 0:t[pt],s=null===(o=r.ending)||void 0===o?void 0:o[pt],l={[ct]:"date_is_within",value:{[Wi]:Li,value:n||s?{[Wi]:"daterange",[pt]:n,end_date:s}:void 0}};this[ut](l)},allowRelativeRangeFilter:this[Hi].allowRelativeDateFilter,relativeRangePopupStore:this[Lt].dateRangeFilterPopupStore,onUpdateRelativeFilter:t=>{const i={...e,value:t};this[ut](i)}};return d[bi](d[Ct],null,s()(fe.Z,{},void 0,d[bi](Fe.Z,o)))}renderDateInput(e,t){return d[bi](ke.Z,r()({},t,{[Bi]:W.default[Ni](Ji.startingMessage),focused:"exact"===e.value[Wi],value:e.value,onUpdate:t=>{var i;if(t.error)return;const o=null===(i=t.value)||void 0===i?void 0:i[pt],r={...e,value:{[Wi]:Li,value:o?{[Wi]:ht,[pt]:o}:void 0}};this[ut](r)},inputRight:this[Hi].allowRelativeDateFilter&&s()(se.Z,{icon:w.Z.chevronDown,iconStyle:{[wi]:12},[ni]:{...!this[Ki][zi][Di]&&{height:20,[wi]:20},[Bt]:this[Et][dt]},[Tt]:()=>{this[Lt].dateFilterPopupStore[at]({open:!0})}}),hideClearButton:"relative"===e.value[Wi]||void 0,isRightLastElementOfInput:!0}))}renderDatePicker(e){if(!(0,m.vR)(e))return;const t="exact"===e.value[Wi]?e.value.value:(0,M.getDateFromDateFilter)(e.value);return!t||(0,S.isDate)(t)?d[bi](d[Ct],null,s()(fe.Z,{},void 0,s()(be.Z,{[Wi]:ht,[lt]:e.value,onUpdate:t=>{const i={...e,value:t};this[ut](i)},renderOrigin:t=>this.renderDateInput(e,t),disabled:"exact"===e.value[Wi]&&this[Hi].allowRelativeDateFilter,[st]:this[Lt].dateFilterPopupStore})),s()(fe.Z,{[ni]:{[nt]:"0px 14px 14px 14px"}},void 0,s()(we.Z,{firstDayOfWeek:E.userSettingsStartOfWeekStore[Wt],value:t?M.convert[rt](t).toMillis():Date.now(),[Vi]:e=>{const t=(0,M.date)(e,(0,b.r)());this[Qi]({[Wi]:Li,value:t})}}),"relative"===e.value[Wi]&&s()(Me.Z,{isSmall:!0,[ni]:{[Gi]:4,[ot]:4}},void 0,s()(B.FormattedMessage,{id:"collectionFilterMenu.dateFilter.relativeDateFilter.description",[qi]:"Filter will update with the current date"})))):void 0}renderVerificationMenu(e){const{[zi]:t}=this[Ki],{[St]:i}=this[Hi],o=(0,m.vR)(e)?(0,m.fl)(e):[],n=o.map((e=>{let{value:t}=e;return t})),l=_.zz.map((e=>{const t=n[kt](e);return{key:e,[ki]:i=>d[bi](oe.Z,r()({icon:s()(ne.Z,{[mt]:t,size:14,[ni]:{fill:this[Et][Gt],[Vt]:"none"}}),[Ri]:(0,N.cq)({[Wi]:Li,value:e})},i)),[Zi]:()=>{if(t)this[Qi](o[yi]((t=>{let{value:i}=t;return i!==e})));else{const t={[Wi]:Li,value:e};this[Qi]([...o,t])}}}}));let a;return a=t[Di]?{[Oi]:Q.og.Modal,[Ri]:this[Ii](),left:this[Ci](),right:s()(pe.DoneMenuText,{}),[Pi]:this[Hi][Ti]}:{[Oi]:Q.og.Popup,[Fi]:eo,[wi]:220,footer:this[Zt](e)},d[bi](ue.Z,a,i===Xi[yt]&&s()(fe.Z,{},void 0,!t[Di]&&this[Ai]()),s()(ce.Z,{[Wi]:ce.i[oi],[ei]:0,[ti]:[{key:ft,[ki]:e=>d[bi](fe.Z,e),items:l}],[Rt]:this[Lt][Yi]}))}renderNumberOperator(e){return s()("span",{[ni]:{[Bt]:this[Et][it]}},void 0,(0,N.WC)(e[ct])[tt]())}renderMeMessage(){return s()(B.FormattedMessage,{[qi]:"Me",id:et})}[Zt](e){if(!(0,m.yI)(e.value))return s()(fe.Z,{topBorder:!0},void 0,s()(oe.Z,{focused:!1,[Ri]:s()(B.FormattedMessage,{[qi]:"Clear",id:"database.filterValue.clear.message"}),[Tt]:()=>{var e,t;this[Qi]({[Wi]:Li,value:void 0}),null===(e=(t=this[Hi])[Ti])||void 0===e||e.call(t)}}))}[Ai](){const e=this[Hi],{propertyFilter:t,[hi]:i,[St]:o}=e;if(o!==Xi[yt])return;const{[Kt]:r}=t,n=i[r];return n?s()("div",{[ni]:{[Je]:Xe,[Bt]:this[Et][it],[Mt]:12,marginBottom:6}},void 0,s()("span",{[ni]:{[qe]:1,[Gi]:8,...D.Z[$e]}},void 0,this[je](n)),(0,m.a_)(t[yi])&&this[Ye](),this[He](),s()("div",{[ni]:{flexGrow:1}}),this.renderMoreActions()):void 0}[je](e){return"date"===e[Wi]?this.renderDateFilterModeSelect(e):e.name}renderDateFilterModeSelect(e){const{propertyFilter:t}=this[Hi],{[zi]:i}=this[Ki],o=t[yi];if(!(0,m.vR)(o)||!(0,m.gE)(o))return e.name;const n={[wi]:190,items:m.T,[ze]:(0,m.TX)(o),getKey:e=>e,onSelect:e=>{const t={...o,use_end:(0,m.UG)(e)};this[ut](t)},renderItem:e=>s()(Ze.Z,{[ri]:()=>(0,N._T)(e.value),[ki]:t=>d[bi](oe.Z,r()({[Ri]:(0,N.IF)(e.value)},(0,U.Z)(e,t))),placement:Ze.Z[ai].Right,textWrap:!0,[ni]:{[wi]:"260px"}}),renderOrigin:e=>d[bi](ie.Z,r()({},e,{[ni]:{[Ei]:4,[Gi]:2,[Ke]:2,[Ue]:2,[Qe]:3,[qe]:0}}),s()("div",{[ni]:{[Je]:Xe,[We]:Le,...!i[Di]&&{[Bt]:this[Et][Ne],fill:this[Et][Ge],[Ee]:500,[Mt]:12}}},void 0,s()("span",{[ni]:{[Ei]:4}},void 0,(0,N.IF)((0,m.TX)(o))),s()(io,{})))};return d[bi](ye.Z,r()({},n,{mobileActionSheet:!0}))}[Ii](){const{propertyFilter:e,[hi]:t,[St]:i}=this[Hi],{[Kt]:o}=e,r=t[o];if(r)return i===Xi[yt]?s()("div",{[ni]:{[Je]:Xe}},void 0,s()("span",{[ni]:{[Ee]:D.Z[Ee].medium,[qe]:1,[Gi]:8,[li]:150,...D.Z[$e]}},void 0,this[je](r)),(0,m.a_)(e[yi])&&this[Ye](),this[He]()):r.name}[Ci](){const{[St]:e}=this[Hi];if(e===Xi[yt])return this.renderMoreActions()}[Ye](){const{propertyFilter:e,intl:t,[Vi]:i}=this[Hi],{[yi]:o}=e,{[zi]:n}=this[Ki];if(!(0,m.a_)(o))return;const l={[wi]:190,items:m.Rf,getKey:e=>e,[ze]:o[ct],onSelect:e=>{null==i||i({...o,[ct]:e})},renderItem:e=>d[bi](oe.Z,r()({[Ri]:(0,N.SW)(e.value,t)},e)),renderOrigin:e=>d[bi](ie.Z,r()({},e,{[ni]:{[Ei]:4,[Gi]:2,[Ke]:2,[Ue]:2,[Qe]:3,[qe]:0}}),s()("div",{[ni]:{[Je]:Xe,[We]:Le,...!n[Di]&&{[Bt]:this[Et][it],[Mt]:12}}},void 0,s()("span",{[ni]:{[Ei]:4}},void 0,(0,N.SW)(o[ct],t)[tt]()),s()(io,{})))};return d[bi](ye.Z,r()({},l,{mobileActionSheet:!0}))}[He](){const{propertyFilter:e,[hi]:t,[pi]:i}=this[Hi],{[Kt]:o}=e,{[zi]:n}=this[Ki],l=(0,m.a_)(e[yi])?e[yi][Qt]:e[yi];if((0,m.a_)(l))return;const a=(0,m.fI)({[hi]:t,[Kt]:o,[Ut]:i[Ut]});let u=(0,m.xm)(a);"status"===a&&(u=u[yi]((e=>!(0,m._N)(e))));const c={[wi]:190,items:u,[ze]:l[ct],getKey:e=>e,onSelect:e=>{const t=(0,N.li)(a,l,e,"propertyFilter");this[ut](t)},renderItem:e=>d[bi](oe.Z,r()({[Ri]:(0,N.WC)(e.value)},e)),renderOrigin:e=>d[bi](ie.Z,r()({},e,{[ni]:{[Ei]:4,[Gi]:2,[Ke]:2,[Ue]:2,[Qe]:3,[qe]:0}}),s()("div",{[ni]:{[Je]:Xe,[We]:Le,...!n[Di]&&{[Bt]:this[Et][Ne],fill:this[Et][Ge],[Ee]:500,[Mt]:12}}},void 0,s()("span",{[ni]:{[Ei]:4}},void 0,(0,N.WC)(l[ct])[tt]()),s()(io,{})))};return d[bi](ye.Z,r()({},c,{mobileActionSheet:!0}))}renderMoreActions(){const{[zi]:e}=this[Ki];return s()(re.ZP,{popupType:this[Ki][zi][Di]?ve.kQ.SlideUp:ve.kQ.Popup,[ki]:this.renderMoreActionsPopup,renderOrigin:t=>d[bi](se.Z,r()({icon:w.Z.dots,[ni]:{...!e[Di]&&{height:20,[wi]:20,[Ei]:8,[ot]:-2}}},t)),[ni]:{[wi]:240},originGap:2,placementToOrigin:re.pO.Right,alignmentToOrigin:re.vR.Start})}renderRemoveMenuItem(e){return s()(oe.Z,{focused:!1,[Ri]:s()(B.FormattedMessage,{[qi]:"Remove filter",id:"database.filterValue.removeFilter.message"}),[Tt]:()=>{e()}})}getTemplatePageStore(){const{collectionViewId:e}=this[Hi];if(!e)return;const t=X.Xr[Ve](this[Hi][pi],{[fi]:C.n,id:e}).getParentBlockStore();if(!t)return;const i=(0,K.getNavigableAncestor)(t,1);return i&&i.isTemplate()?i:void 0}getExactRelationMenuItems(e,t){return e.map((e=>{const i={[Wi]:Li,value:e},o=this.getCheckedState(t,i),n=X.G[Ve](this[Hi][pi],{[fi]:T.iU,id:e});return{key:e,[Zi]:this.getMenuListItemAction(o,t,i),[ki]:e=>d[bi](me.Z,r()({[Rt]:n,checkState:o,hidePath:!0},e))}}))}getRelativeRelationMenuItems(e,t){const{appConfigUri:i,[hi]:o}=this[gi][Wt];if(!i||!(0,L.Sh)(o,i))return[];const n=x.qB[i],s=Object.keys(n);return a()[ui](s.map((i=>{if(!e||i[kt](e)){const e={[Wi]:"relative",value:{[Wi]:"builtin",variable:i}},o=this.getCheckedState(t,e);return{key:i,[ki]:e=>d[bi](oe.Z,r()({},e,{[Ri]:n[i].formattedMessage,checkState:o})),[Zi]:this.getMenuListItemAction(o,t,e)}}})))}[Qi](e){const{[Vi]:t,propertyFilter:i}=this[Hi],{[yi]:o}=i;(0,m.a_)(o)?null==t||t({...o,[Qt]:{...o[Qt],value:this.normalizeValue(e)}}):null==t||t({...o,value:this.normalizeValue(e)})}[ut](e){const{[Vi]:t,propertyFilter:i}=this[Hi],{[yi]:o}=i;(0,m.a_)(o)?null==t||t({...o,[Qt]:e}):null==t||t(e)}[vi](){const{[hi]:e,propertyFilter:t,[pi]:i}=this[Hi],{[Kt]:o}=t,r=e[o];if(!(r&&"rollup"===r[Wi]&&r[Be]&&r[_e]))return r;{const t=e[r[Be]];if(t&&(0,g.isRelationPropertySchema)(t)){const e=(0,g.getRelationPropertyCollectionPointer)(t);if(e){const t=i.getRecordModel(e);if(!t)return;const o=t.getNormalizedSchema();if(o){const e=o[r[_e]];if(e&&"rollup"!==e[Wi])return e}}}}}normalizeValue(e){return a().isArray(e)?0===e[zt]?{[Wi]:Li,value:void 0}:1===e[zt]?e[0]:e:e}[_t](e){this[Lt][$i][at](e),this[Lt][Yi][at]({focus:{section:0,indexLocal:0,indexGlobal:0}})}getCheckedState(e,t){return Boolean(e.find((e=>a().isEqual(e,t))))}getMenuListItemAction(e,t,i){return()=>{const o=e?t[yi]((e=>!a().isEqual(e,i))):[...t,i];this[Qi](o)}}}function io(){window.__c={n:"OperatorChevron"};const{[zi]:e}=(0,c.O7)();return w.Z.chevronDown({[wi]:10,height:10,...e[Di]&&{[ot]:2}})}function oo(e){window.__c={n:"LocationFilterValueMenu"};const{[yi]:t,[pi]:i,[Qi]:o,[Ti]:n,desktopTopActions:l,mobileMenuTitle:u,mobileMoreActions:p}=e,v=(0,c.O7)(),g=(0,d.useMemo)((()=>(0,m.vR)(t)?(0,m.u0)(t):[]),[t]),f=(0,c.Fy)(),S=(0,h.VK)((()=>a()[ui](g.map((e=>{if(!e.value)return;const t=X.NW[Ve](i,{[fi]:"collection",id:e.value});return s()(Ce.Z,{[Si]:f[Di]?y.l.Large:y.l.Small,value:s()(J.Z,{[De]:t}),onClickRemove:()=>{const t=a().without(g,e);o(t)},showRemoveButton:!0,[Mi]:!1,shouldShrink:!0,[wt]:Ft,showFullValueTooltip:!0},e.value)})))),[g,f[Di],i,o]),[M,b]=(0,d.useState)(""),w=(0,B.useIntl)(),F=(0,h.VK)((()=>{var e;return null===(e=j.default[Wt][vt])||void 0===e?void 0:e.id}),[]),{status:x,typedCollections:T}=function(e){const{spaceId:t,environment:i,parentStore:o,databaseType:r}=e,[{value:n,status:s}]=(0,H.r5)((async()=>Y.rG({environment:i,spaceId:t,databaseType:r,parentStore:o})),[t,r,i,o]);return{status:s,typedCollections:n}}({[qt]:F,[Ki]:v,databaseType:Z.iS,[pi]:i}),P=(0,h.qz)(void 0,q.Z),C=(0,d.useCallback)(((e,t)=>{const i=Boolean(t.find((t=>"exact"===t[Wi]&&t.value===e.id)));return{key:e.id,[ki]:t=>d[bi](oe.Z,r()({},t,{[Ri]:s()(J.Z,{[De]:e}),isTokenTitle:!0,checkState:i})),[Zi]:()=>{const i=a().xorBy(t,[{[Wi]:Li,value:e.id}],(e=>e.value));o(i)}}}),[o]),R=(0,h.VK)((()=>{const e=[],t=(0,k.ZP)(M,T||[],(e=>O.getText(e.getName()??[]))),o={},n=[];for(const i of t){const e=K.getTeam(i);e?o[e.id]=[...o[e.id]??[],i]:n.push(i)}for(const[s,l]of Object.entries(o)){const t=X.zX[Ve](i,{[fi]:I.e0,id:s});e.push({key:s,items:l.map((e=>C(e,g))),[ki]:e=>d[bi](fe.Z,r()({topBorder:!0},e,{[Ri]:d[bi](d[Ct],null,t.getName()??"")}))})}return e.push({key:"private",items:n.map((e=>C(e,g))),[ki]:e=>d[bi](fe.Z,r()({topBorder:!0},e,{[Ri]:s()(B.FormattedMessage,{id:"collectionFilterValueMenu.privateLocationSection",[qi]:"Private"})}))}),e}),[g,i,M,C,T]),A=s()(Ie.Z,{focus:!f[Di]||void 0,focusAfterAnimation:!0,[Si]:Ie.Z.Format.FilterValue,tokens:S,[Bi]:w[Ni]({[qi]:"Search for one or more locations",id:"database.filterValue.locationType.searchPlaceholder"}),onRemoveLastToken:()=>{const e=g[Xt](0,g[zt]-1);o(e)},onClearButtonClick:()=>{o([]),null==n||n()},value:M,[Vi]:e=>{b(e[Ui].value)},dontShowBorderBottom:f[Dt],[_i]:!0,[ni]:{[Fi]:"20vh",overflowY:bt}}),D=s()(fe.Z,{desktopStyle:{[At]:0}},void 0,!f[Di]&&l,A);let _;return _=f[Di]?{[Oi]:Q.og.Modal,[Ri]:u,left:p,right:s()(pe.DoneMenuText,{}),[Pi]:n,[xi]:D}:{[Oi]:Q.og.Popup,[Fi]:eo,[wi]:260,[xi]:D,[Ot]:!0},d[bi](ue.Z,_,(0,m.vR)(t)&&d[bi](d[Ct],null,("pending"===x||"idle"===x)&&s()(fe.Z,{[ni]:{[Je]:"flex",[We]:"center",[Ae]:"center",[nt]:"8px 0px"}},void 0,s()(de.Z,{})),"rejected"===x&&s()(fe.Z,{},void 0,s()(he.Z,{[Ri]:s()(B.FormattedMessage,{[qi]:"Something went wrong.",id:"database.filterValue.personType.searchPersonPropertyMenuItem.errorMessage"})})),"resolved"===x&&d[bi](d[Ct],null,0===(null==T?void 0:T[zt])&&s()(fe.Z,{},void 0,s()(he.Z,{[Ri]:s()(B.FormattedMessage,{[qi]:"No results",id:"database.filterValue.selectType.noResults.message"})})),T&&T[zt]>0&&s()(ce.Z,{[Wi]:ce.i[oi],[ei]:0,[ti]:R,[Rt]:P,[It]:()=>{b("")}}))))}to.displayName="CollectionFilterValueMenu";const ro=(0,B.injectIntl)(to);function no(e){const{[Nt]:t,statusFilterValues:i,[Qi]:o,[Di]:n,styles:l}=e,a=t.groups??[],u=t.options??[],c=[];for(const h of a){const e=()=>{const e=(0,G.CN)(a,u,i,{[Wi]:"is_group",value:h.name});e&&o(e)},t=i.some((e=>"is_group"===e[Wi]&&e.value===h.name)),p=u[yi]((e=>{var t;return null===(t=h.optionIds)||void 0===t?void 0:t[kt](e.id)}));let v=!1,m=!0;const g=[];for(const c of p){const e=()=>{const e=(0,G.CN)(a,u,i,{[Wi]:"is_option",value:c.value});e&&o(e)},p=i.some((e=>"is_option"===e[Wi]&&e.value===c.value));v||=p,m&&=p,g.push({key:`option-${c.id}`,[Zi]:e,[ki]:i=>d[bi](oe.Z,r()({},i,{icon:s()(ne.Z,{[mt]:t||p,size:14,[Tt]:e,[ni]:l.checkboxIcon}),[Ri]:s()(Pe.F,{[Si]:n?y.l.Large:y.l.Medium,[Mi]:!0,value:c.value,[Bt]:c[Bt],showRemoveButton:!1,groupColor:h[Bt]}),[ni]:{[Ke]:12}}))})}c.push({key:`group-${h.id}`,[Zi]:e,[ki]:i=>d[bi](oe.Z,r()({},i,{icon:s()(ne.Z,{[mt]:!(!t&&!m)||!!v&&Oe,size:14,[Tt]:e,[ni]:l.checkboxIcon}),[Ri]:s()(te.r_,{group:h})}))},...g)}return c}function so(e){const{[$i]:t,[Nt]:i,selectedValues:o,[Qi]:n,[Di]:l,styles:a}=e,u=i.options||[];return(t?(0,k.ZP)(t,u,(e=>e.value)):u).map((e=>{const t=Boolean(o.find((t=>t.value===e.value)));return{key:e.value,[ki]:i=>d[bi](oe.Z,r()({icon:s()(ne.Z,{[Tt]:i[Tt],[mt]:t,size:14,[ni]:a.checkboxIcon}),[Ri]:s()(Pe.a,{[Si]:l?y.l.Large:y.l.Medium,[Mi]:!0,value:e.value,[Bt]:e[Bt],showRemoveButton:!1}),isTokenTitle:!0},i)),[Zi]:()=>{const i=t?o[yi]((t=>{let{value:i}=t;return i!==e.value})):[...o,{[Wi]:Li,value:e.value}];n(i)}}}))}},68834:(e,t,i)=>{i.d(t,{Z:()=>a});var o=i(77094),r=i.n(o),n=(i(67294),i(81954)),s=i(31278),l=i(76798);const a=function(e){window.__c={n:"CollectionLocationToken"};const{collectionStore:t}=e,i=(0,n.VK)((()=>t.getIcon()),[t]);return r()("div",{style:{display:"flex",columnGap:4,alignItems:"center"}},void 0,r()(s.Z,{disabled:!0,icon:i,isEmptyPage:!1,size:20}),r()(l.Z,{store:t,style:{maxWidth:180}}))}},42917:(e,t,i)=>{i.d(t,{Z:()=>f});var o=i(67294),r=i(480),n=i(24405),s=i(8848),l=i(3909),a=i(25130),d=i(52275);const u=i(85).D7I,c=i(85).Q9F,h=i(85).AIq,p=i(85).a3v,v=i(85).auS,m=i(85)._Fe,g=i(85).ewQ;const f=function(e){window.__c={n:"CollectionSettingsMenuItem"};const{icon:t,iconStyle:i,title:f,caption:y,right:Z,rightStyle:S,isRed:M,isGray:k,isOrange:b,isPadded:w,onClick:F,onMouseDown:x,onMouseEnter:T,onMouseLeave:P,disabled:C,showChevron:I,chevronStyle:R,rotateChevron:O,showDragHandle:A,focused:D,textWrapperStyle:_,shouldWrapCaption:B,desktopIconStyle:V}=e,E=(0,r.O7)(),{isMobile:G}=E.device,N=(0,n.yK)((e=>({style:{color:k?e.mediumTextColor:b?"dark"===e.mode?e[g].orange[500]:e[g].orange[400]:e[m],fill:k?e.mediumIconColor:b?"dark"===e.mode?e[g].orange[500]:e[g].orange[400]:e[v],opacity:C?.4:void 0},redHoveredStyle:{color:s.ZP.red,fill:s.ZP.red},leftIconStyle:{width:24,height:w?24:G?18:16,marginRight:-2,...t===l.Z.dots&&{height:3},...i},rightStyle:{display:"flex",alignItems:"center",color:C?e[m]:e.lightTextColor,fill:C?e[v]:e[p],[h]:0,...S},rightIconStyle:{width:12,fill:e[p],marginLeft:6,transition:"transform 200ms ease-in-out",...R},rightIconRotatedStyle:{transform:"rotate(90deg)"}})),[k,b,C,i,w,G,t,R,S]),[L,W]=(0,a.o$)(),Q=(0,a.nq)(W);return o[u](d.Z,{ref:L,icon:null==t?void 0:t(N.leftIconStyle),focused:D||!1,disabled:C,title:f,caption:y,shouldWrapCaption:B,desktopTitleStyle:{flexGrow:1,[h]:1},showDragHandle:A,buttonStyle:N.style,rightStyle:N.rightStyle,hoveredStyle:M?N.redHoveredStyle:void 0,ignoreLocalHoverState:!!C||void 0,right:o[u](o.Fragment,null,Z,!C&&I&&l.Z[c]({...N.rightIconStyle,...O&&N.rightIconRotatedStyle})),onClick:F,onMouseDown:x,onMouseEnter:T,onMouseLeave:P,textWrapperStyle:_,desktopIconStyle:V,disallowTabbing:!Q})}},13709:(e,t,i)=>{i.d(t,{Z:()=>O});var o=i(77094),r=i.n(o),n=i(97464),s=i.n(n),l=i(96486),a=i.n(l),d=i(67294),u=i(480),c=i(81954),h=i(65917),p=i(2911),v=i(87279),m=i(61766),g=i(42917),f=i(52275),y=i(31945),Z=i(78140),S=i(32163),M=i(44532),k=i(72495);const b=i(85).j7K,w=i(85).y79,F=i(85).g4H,x=i(85).D7I,T=i(85).dLQ,P=i(85).QQK,C=i(85).P24,I=i(85).pkR,R=i(85).Zij;const O=function(e){let{icon:t,[R]:i,selectedKey:o,options:n,onChange:l,onClick:O,popupStyle:A,menuItemOptionsStyle:D,[I]:_,[C]:B,openButtonPopup:V}=e;window.__c={n:"CollectionSettingsPickListMenuItem"};const E=(0,u.Fy)(),G=n.find((e=>a().isEqual(e.key,o))),N=(0,c.qz)(void 0,m.Z),L=(0,c.Kw)(N);return(0,d.useEffect)((()=>{B&&V&&(N.setState({...N.state,open:V}),B[P].setState({...B[P].state,openButtonPopup:void 0})),G||h.log({level:"error",from:"CollectionSettingsPickListMenuItem",type:"InvalidSelectedItem",error:(0,p.Ui)("Selected key is invalid.")})})),r()(y.ZP,{popupType:E[T]?M.kQ.SlideUp:M.kQ.Popup,alignmentToOrigin:y.vR.End,placementToOrigin:y.pO.Bottom,style:A,originGap:0,buttonPopupStore:N,[I]:_,onClick:O,renderOrigin:e=>d[x](g.Z,s()({[R]:i,showChevron:!0,right:null==G?void 0:G[R],rotateChevron:L.open,[I]:_,icon:t},e)),render:e=>{let t;t=E[T]?{menuType:v.og.ActionSheet}:{menuType:v.og.Popup,width:250};const i=a().compact(n.map(((t,i)=>({key:i,render:e=>d[x](f.Z,s()({},e,{[I]:!1,[R]:t[R],icon:t.icon,[F]:t[F],body:t.body,style:D,checkState:a().isEqual(t.key,o)})),action:()=>{l(t.key),e.close()}}))));return d[x](Z.Z,t,r()(S.Z,{type:S.i[w],sections:[{key:0,render:e=>d[x](k.Z,s()({enableActionSheetTitle:!0},e)),items:i}],[b]:0}))}})}},28398:(e,t,i)=>{i.d(t,{R1:()=>ut,ep:()=>ht,ZP:()=>pt});var o=i(77094),r=i.n(o),n=i(97464),s=i.n(n),l=i(96486),a=i(67294),d=i(83355),u=i(49085),c=i(76205),h=i(3909),p=i(97880),v=i(82990),m=i(5366),g=i(77162),f=i(90985),y=i(5149),Z=i(12359),S=i(93959),M=i(97004),k=i(87279),b=i(98742),w=i(61766),F=i(42917),x=i(23063),T=i(52275),P=i(31945),C=i(73063),I=i(78140),R=i(28992),O=i(32163),A=i(89728),D=i(44532),_=i(72495),B=i(58032),V=i(23564);const E=i(85).nx5,G=i(85).Mm1,N=i(85)._V5,L=i(85).XCs,W=i(85).YDv,Q=i(85).TIz,U=i(85).wuN,K=i(85).XNW,z=i(85).Exd,H=i(85).OM8,Y=i(85).H1U,j=i(85).AEP,$=i(85).MAy,q=i(85).LtW,X=i(85).pHx,J=i(85).tBn,ee=i(85).PG2,te=i(85).v8Q,ie=i(85).ChN,oe=i(85).PXg,re=i(85).X_m,ne=i(85).jkI,se=i(85).UPJ,le=i(85).mSd,ae=i(85).TN,de=i(85).Lyb,ue=i(85).TtP,ce=i(85).T5E,he=i(85).EIp,pe=i(85).xZg,ve=i(85).Gnd,me=i(85).YO,ge=i(85).HxR,fe=i(85).Xl2,ye=i(85).BrJ,Ze=i(85).oBh,Se=i(85).ltl,Me=i(85).vHy,ke=i(85).xQb,be=i(85).eiN,we=i(85).EiQ,Fe=i(85).QmD,xe=i(85).N1Z,Te=i(85).Rs8,Pe=i(85).LCr,Ce=i(85).Ieo,Ie=i(85).nxU,Re=i(85).Drs,Oe=i(85).JJj,Ae=i(85).jQT,De=i(85).qU4,_e=i(85).P0R,Be=i(85).Gm5,Ve=i(85).P24,Ee=i(85).SMQ,Ge=i(85).j7K,Ne=i(85).y79,Le=i(85).LO1,We=i(85).Joh,Qe=i(85).BQ6,Ue=i(85).M5o,Ke=i(85).NLk,ze=i(85).fsm,He=i(85).ESK,Ye=i(85).uk2,je=i(85).EHK,$e=i(85).Z_D,qe=i(85).X5t,Xe=i(85).Zij,Je=i(85).pkR,et=i(85).D7I,tt=i(85).zlj,it=i(85).rpY,ot=i(85).Ie8,rt=i(85).ceT,nt=i(85).dLQ,st=i(85).wgE,lt=i(85).E0z,at=i(85).S2v,dt=i(85).wfR;let ut;!function(e){e[e.FilterBar=0]="FilterBar",e[e[Ce]=1]=Ce,e[e.SettingsSort=2]="SettingsSort"}(ut||(ut={}));class ct extends d.Z{constructor(){super(...arguments),this.storeTypes={showMore:u.default[dt](!1),[at]:w.Z},this.renderSaveActionsPopup=e=>{const{[lt]:t}=this[st];let i;i=t[nt]?{[rt]:k.og[ot]}:{[rt]:k.og.Popup,width:250};const o=l.compact([t.isPhone&&{key:"reset",[it]:e=>a[et](T.Z,s()({},e,{[Je]:!1,[Xe]:this[tt]()})),[qe]:()=>{this[$e](e)}},{key:"newView",[it]:e=>a[et](T.Z,s()({},e,{[Je]:!1,[Xe]:this[je]()})),[qe]:()=>{this.handleSaveAsNewViewClick(e)}},this[Ye]()&&{key:"merge",[it]:e=>r()(B.Z,{placement:B.Z[He].Left,[Qe]:{[ze]:240,[Ke]:void 0},[We]:()=>r()("div",{},void 0,r()(ht,{})),[it]:t=>a[et](T.Z,s()({},(0,b.Z)(e,t),{[Je]:!1,[Xe]:this[Ue]()}))}),[qe]:()=>{this[Le](e)}}]);return a[et](I.Z,i,r()(O.Z,{type:O.i[Ne],sections:[{key:0,[it]:e=>a[et](_.Z,s()({enableActionSheetTitle:!0},e)),items:o}],[Ge]:0}))},this[Ee]=()=>{const{[Ve]:e,[Be]:t}=this[_e],i=e[De]();i&&(g[Ae]({[st]:this[st],[Ve]:e,[qe]:"click_save_control_save_in_current_view"}),Z[Oe]({[Re]:"CollectionSettingsSaveControl.handleSaveInCurrentViewClick",[st]:this[st],[Ie]:o=>{f.applyTemporaryState({[st]:this[st],type:t===ut.FilterBar?f.ApplyTemporaryStateType.All:t===ut[Ce]?f.ApplyTemporaryStateType.Filters:f.ApplyTemporaryStateType.Sorts,[Ve]:e,targetCollectionView:i,[Pe]:o})}}),f[Te]({[st]:this[st],seen:!0}))},this.handleSaveAsNewViewClick=e=>{const{[Ve]:t,intl:i}=this[_e];g[Ae]({[st]:this[st],[Ve]:t,[qe]:"click_save_control_save_as_new_view"}),Z[Oe]({[Re]:"CollectionSettingsSaveControl.handleSaveAsNewViewClick",[st]:this[st],[Ie]:e=>{f.handleSaveFilterChangesInNewView({[st]:this[st],[Ve]:t,[Pe]:e,intl:i})}}),null==e||e[xe]()},this[Le]=e=>{const{[Ve]:t,[Be]:i}=this[_e],o=(0,M.Pi)(t),r=t[we][Fe][be]((e=>(0,S.EE)(e.id)));f[ke]({[st]:this[st],[Ve]:t,[Me]:{...t[Me][Fe],propertyFilters:{value:r},[Se]:{value:o}}});const n=i===ut.FilterBar?t[Ze]:t[ye];y[fe]({[ge]:n,item:{type:be}}),g[Ae]({[st]:this[st],[Ve]:t,[qe]:me}),null==e||e[xe]()},this[$e]=e=>{const{[Ve]:t,[Be]:i}=this[_e];g[Ae]({[st]:this[st],[Ve]:t,[qe]:"click_save_control_reset"});const o=t[Me][Fe],r=i===ut[Ce]?{...o,propertyFilters:void 0,[Se]:void 0}:i===ut.SettingsSort?{...o,sorts:void 0}:void 0;f.setTemporaryState({[st]:this[st],[Ve]:t,[Me]:r}),f[Te]({[st]:this[st],seen:!0}),null==e||e[xe]()},this.handleMoreOptionsClick=()=>{const{[Ve]:e}=this[_e];g[Ae]({[st]:this[st],[Ve]:e,[qe]:"click_save_control_more_options_button"}),this[ve].showMore.setState(!0)},this[pe]=()=>{const{[Ve]:e}=this[_e];g[Ae]({[st]:this[st],[Ve]:e,[qe]:"click_save_control_more_options_popup"}),f[Te]({[st]:this[st],seen:!0})},this.changeCount=this[he]((()=>{const{[Ve]:e,[Be]:t}=this[_e],i=e[ce][Fe];return t===ut[Ce]?(i[de].moved[ue]>0?1:0)+i[de].added[ue]+i[de].removed[ue]+i[de].updated[ue]:0}))}renderComponent(){const{[Be]:e,[Ve]:t,[ae]:i}=this[_e],{showMore:o}=this[ve],{[lt]:n}=this[st],l=t.permissionScopes[Fe];if(e===ut.FilterBar)return n.isPhone?l[le]?a[et](a[J],null,r()(A.Z,{isOrange:!0,[te]:!0,[Qe]:{flexGrow:1,[se]:ne,[re]:32,[oe]:8,[ie]:v.Z[ie].semibold},[ee]:this[Ee]},void 0,this.renderSaveMessage()),r()(P.ZP,{popupType:this[st][lt][nt]?D.kQ[X]:D.kQ.Popup,[it]:this.renderSaveActionsPopup,originGap:4,[ee]:this[pe],[q]:this[ve][at],renderOrigin:e=>a[et](C.Z,s()({[Qe]:{width:32,[re]:32},iconStyle:{width:16},[te]:!0,icon:h.Z.dots},e))})):a[et](a[J],null,r()(A.Z,{[Qe]:{flexGrow:1,[se]:ne,[re]:32,[oe]:8,[ie]:v.Z[ie].semibold},[te]:!0,isGray:!0,[ee]:()=>this[$e]()},void 0,this[tt]())):r()(x.Z,{isVisible:t[$][Fe]||!i||i[Fe],animationStyle:{[j]:1},enterAnimationStyle:{[j]:0},exitAnimationStyle:{[j]:0},[it]:()=>r()("div",{[Qe]:{display:"flex",[Y]:ne}},void 0,r()(A.Z,{isGray:!0,[ee]:()=>this[$e](),[Qe]:{[H]:1.1,[z]:n[nt]?16:14}},void 0,this[tt]()),l[le]&&r()(P.ZP,{popupType:this[st][lt][nt]?D.kQ[X]:D.kQ.Popup,[it]:this.renderSaveActionsPopup,originGap:4,[ee]:this[pe],[q]:this[ve][at],renderOrigin:e=>r()(V.Z,{[Xe]:this.renderSaveMessage(),color:"orange",[ee]:this[Ee],dropdownEvents:e,[Qe]:{[K]:6,[oe]:n[nt]?8:void 0,[z]:n[nt]?16:14,...n[nt]?{[re]:30}:null}})}))});if(e===ut[Ce]||e===ut.SettingsSort){const t=e===ut[Ce];return a[et](a[J],null,o[Fe]&&l[le]&&(n[nt]?r()(R.Z,{[Qe]:{[z]:12,color:this.theme[U]},[Xe]:this[Q]()}):r()("div",{[Qe]:{[z]:12,color:this.theme[U],[W]:14,[L]:14,[N]:8,[G]:8,[ze]:220}},void 0,this[Q]())),l[le]&&r()(F.Z,{icon:h.Z.save,isOrange:!0,[Xe]:this.renderSaveMessage(),[ee]:this[Ee]}),r()(F.Z,{icon:h.Z.undo,isGray:!0,[Xe]:r()(m.FormattedMessage,t?{[E]:"Reset filters",id:"database.viewSettings.filterAndSortSaveControl.resetFilters"}:{[E]:"Reset sorts",id:"database.viewSettings.filterAndSortSaveControl.resetSorts"}),[ee]:()=>this[$e]()}),l[le]&&!o[Fe]&&r()(F.Z,{icon:h.Z.dots,isGray:!0,[Xe]:r()(m.FormattedMessage,{[E]:"More options",id:"database.viewSettings.filterAndSortSaveControl.more"}),[ee]:this.handleMoreOptionsClick}),l[le]&&o[Fe]&&a[et](a[J],null,r()(F.Z,{icon:h.Z.copyPadded,isPadded:!0,isGray:!0,[Xe]:this[je](),[ee]:()=>{this.handleSaveAsNewViewClick()}}),this[Ye]()&&r()(B.Z,{placement:B.Z[He].Left,[Qe]:{[ze]:240,[Ke]:void 0},[We]:()=>r()("div",{},void 0,r()(ht,{})),[it]:e=>a[et](F.Z,s()({icon:h.Z[be],isGray:!0,[Xe]:this[Ue](),[ee]:()=>{this[Le]()}},e))})))}(0,p.unreachable)(e)}[Q](){const{[Be]:e}=this[_e],t=e===ut[Ce];return r()(m.FormattedMessage,t?{[E]:"{count, plural, one {{count} filter changed from what other people see} other {{count} filters changed from what other people see}}",id:"database.viewSettings.filterAndSortSaveControl.filter.caption",values:{count:this.changeCount[Fe]}}:{[E]:"Sort has been changed from what other people see",id:"database.viewSettings.filterAndSortSaveControl.sort.caption"})}[je](){return r()(m.FormattedMessage,{[E]:"Save as new view",id:"database.filterBar.changesControl.saveAsNewView.title"})}[Ue](){return r()(m.FormattedMessage,{[E]:"Merge into advanced filter",id:"database.filterBar.changesControl.mergeIntoAdvancedFilter.title"})}[tt](){return r()(m.FormattedMessage,{[E]:"Reset",id:"database.filterBar.changesControl.reset.title"})}renderSaveMessage(){return r()(m.FormattedMessage,{[E]:"Save for everyone",id:"database.filterBar.changesControl.saveForEveryone.title"})}[Ye](){const{[Ve]:e,[Be]:t}=this[_e],i=e[we][Fe];return(t===ut.FilterBar||t===ut[Ce])&&Boolean(i.find((e=>(0,c.aN)(e[be]))))}}function ht(){return r()(m.FormattedMessage,{id:"database.filterValue.mergeIntoAdvancedFilter.tooltip",[E]:"Use an advanced filter to group filter rules and use AND/OR conditions."})}ct.displayName="CollectionSettingsSaveControl";const pt=(0,m.injectIntl)(ct)},97180:(e,t,i)=>{i.d(t,{ZA:()=>S,r_:()=>k});var o=i(77094),r=i.n(o),n=i(67294),s=i(24405),l=i(42613),a=i(3909),d=i(5366),u=i(16173),c=i(32662),h=i(58032);const p=i(85).Joh,v=i(85).ESK,m=i(85).YDv,g=i(85).Hco,f=i(85).ewQ,y=i(85).rOg,Z=i(85).D7I,S={[l.G1]:n[Z](d.FormattedMessage,l.ct.statusGroupNameTodo),[l.Ho]:n[Z](d.FormattedMessage,l.ct.statusGroupNameInProgress),[l.RW]:n[Z](d.FormattedMessage,l.ct.statusGroupNameComplete),[l.Ap]:n[Z](d.FormattedMessage,u.sY.current),[l.JV]:n[Z](d.FormattedMessage,u.sY.future)},M={[l.G1]:a.Z.statusTodoGroup,[l.Ho]:a.Z.statusInProgressGroup,[l.RW]:a.Z.statusCompleteGroup};function k(e){window.__c={n:"CollectionStatusGroupName"};const{group:t,disableGroup:i,style:o,showIcon:l,showColor:d}=e,u=(0,s.Fg)(),k=M[t.name]??a.Z.statusTodoGroup,b=t.color??"gray";return r()("div",{style:{...o,display:y,alignItems:"center"}},void 0,l&&k({display:"inline-block",width:16,height:16,fill:d?u[f][b][400]:u[g]}),r()("span",{style:{[m]:l?6:void 0,color:d?u[f][b][500]:void 0}},void 0,S[t.name]??t.name),i?n[Z](n.Fragment,null,r()(c.Z,{size:4}),r()(h.Z,{placement:h.Z[v].Bottom,render:e=>n[Z]("div",e,a.Z.lockedFilled({width:12})),[p]:e=>n[Z]("div",e,i.tooltipCaption),disableTooltip:void 0===i.tooltipCaption})):null)}},26909:(e,t,i)=>{i.d(t,{cn:()=>g,l0:()=>f,fg:()=>y,ZP:()=>S});var o=i(97464),r=i.n(o),n=i(77094),s=i.n(n),l=i(67294),a=i(83355),d=i(87279),u=i(36488),c=i(78140),h=i(28992),p=i(40721);const v=i(85).D7I,m=i(85).P0R,g=8,f=8,y=32;class Z extends a.Z{renderComponent(){const{device:e}=this.environment;return s()(u.Z,{capture:!0,allowEsc:!0,allowUndo:!0,render:t=>{let i;return i=e.isMobile?{menuType:d.og.Modal,title:this[m].title,right:s()(p.DoneMenuText,{}),onClickRight:this[m].onCancel,...t}:{menuType:d.og.Popup,...this[m].desktopMinWidth&&{minWidth:this[m].desktopMinWidth},...this[m].desktopMaxWidth&&{maxWidth:this[m].desktopMaxWidth},...this[m].desktopWidth&&{width:this[m].desktopWidth},...t},l[v](c.Z,r()({},i,{header:this.renderHeading()}),this[m].children)}})}renderHeading(){if(!this.environment.device.isMobile)return s()(h.Z,{style:Z.headingStyle,title:this[m].title,right:this[m].helpButton})}}Z.displayName="CollectionViewMenu",Z.headingStyle={height:y+g-2,paddingTop:g-2};const S=Z},93289:(e,t,i)=>{i.d(t,{Z:()=>a});var o=i(77094),r=i.n(o),n=i(67294),s=i(13991),l=i(77907);const a=function(e){let{firstDayOfWeek:t,value:i,selectValue:o=!0,onChange:a,disabledDays:d}=e;window.__c={n:"DatePicker"};const u=(0,n.useMemo)((()=>new Date(i)),[i]),[c,h]=(0,n.useState)(u),p=(0,n.useRef)(i);(0,n.useLayoutEffect)((()=>{p.current!==i&&(h(new Date(i)),p.current=i)}),[i]);const v=(0,n.useCallback)(((e,t,i)=>{a(e.getTime())}),[a]);return r()(l.LazyDayPicker,{locale:s.SP,className:"notion-calendar-picker",numberOfMonths:1,weekStartsOn:t,modifiers:o?{value:u}:{},showOutsideDays:!0,fixedWeeks:!0,onDayClick:v,onMonthSelected:h,disabled:d,month:c})}},78948:(e,t,i)=>{i.d(t,{Z:()=>d});var o=i(77094),r=i.n(o),n=(i(67294),i(83355)),s=i(68785),l=i(28992);class a extends n.Z{renderComponent(){return r()(l.Z,{title:r()(s.Z,{})})}}a.displayName="LoadingMenuItem";const d=a},77498:(e,t,i)=>{i.d(t,{Z:()=>A});var o=i(77094),r=i.n(o),n=i(97464),s=i.n(n),l=i(43261),a=i.n(l),d=i(96486),u=i.n(d),c=i(67294),h=i(83355),p=i(99036),v=i(80951),m=i(5366),g=i(87279),f=i(33846),y=i(68894),Z=i(78140),S=i(32163),M=i(43765),k=i(40721),b=i(72495),w=i(69872);const F=i(85).nx5,x=i(85).Yzm,T=i(85).dLQ,P=i(85).D7I,C=i(85).loK,I=i(85).ffk,R=i(85).K0Z;class O extends h.Z{constructor(){super(...arguments),this.storeTypes={[R]:f.Z}}renderComponent(){const{onAccept:e,schema:t,onClose:i,allowProperty:o,intl:n,isRelationProperty:l}=this.props,{[R]:d}=this.stores;let h=Object.keys(t);const f=h.some(v.isExternalPropertyId);h=u().sortBy(h,(e=>{const i=(0,v.getNormalizedPropertySchema)({schema:t,[I]:e});return i?i.name:""}));const O=f?`${v.externalAttributePropertyIdPrefix}${p.TITLE_PROPERTY_ID}`:p.TITLE_PROPERTY_ID;h=u().without(h,O),h.unshift(O);const A=d.state[C];if(o&&(h=h.filter((e=>{const i=(0,v.getNormalizedPropertySchema)({schema:t,[I]:e});return i&&o(i)}))),A){let e=h.map((e=>{const i=(0,v.getNormalizedPropertySchema)({schema:t,[I]:e});return i&&i.name}));e=a().filter(A,e).map((e=>{let{original:t}=e;return t})),h=h.filter((i=>{const o=(0,v.getNormalizedPropertySchema)({schema:t,[I]:i});return o&&o.name&&e.includes(o.name)}))}const D=u().compact(h.map((i=>{const o=(0,v.getNormalizedPropertySchema)({schema:t,[I]:i});if(!o)return;return{key:i,render:e=>c[P](w.Z,s()({},e,{propertySchema:o,format:w.Z.DisplayFormat.Name})),action:()=>e(i)}}))),_=[{key:0,render:e=>c[P](b.Z,e),items:D}],{device:B}=this.environment,V=r()(b.Z,{isInput:!0},void 0,r()(y.ZP,{focus:!B[T]||void 0,focusAfterAnimation:!0,value:A,onChange:e=>this.stores[R].setState({focus:!0,[C]:e.target.value}),placeholder:l?n[x]({[F]:"Search for a relation property…",id:"propertySelectMenu.searchForProperty.relation.placeholder"}):n[x]({[F]:"Search for a property…",id:"propertySelectMenu.searchForProperty.default.placeholder"})}));let E;return E=B[T]?{menuType:g.og.Modal,title:l?n[x]({[F]:"Relation property",id:"propertySelectMenu.mobileMenu.relationProperty.header"}):n[x]({[F]:"Property",id:"propertySelectMenu.mobileMenu.property.header"}),right:r()(k.CancelMenuText,{}),onClickRight:i,header:V}:{menuType:g.og.Popup,width:300,header:V},c[P](Z.Z,E,0===D.length?r()(b.Z,{},void 0,r()(M.Z,{title:r()(m.FormattedMessage,{[F]:"No results",id:"propertySelectMenu.search.noResults.title"})})):r()(S.Z,{type:S.i.Vertical,sections:_,onAccept:i,initialFocus:A.length>0?0:void 0}))}}O.displayName="PropertySelectMenu";const A=(0,m.injectIntl)(O)},50542:(e,t,i)=>{i.d(t,{Z:()=>f});var o=i(77094),r=i.n(o),n=(i(67294),i(83355)),s=i(5366),l=i(52275),a=i(19387),d=i(69872),u=i(62045);const c=i(85).nx5,h=i(85).pkR,p=i(85).PG2,v=i(85).P0R,m=i(85).OBh;class g extends n.Z{renderComponent(){const{device:e}=this.environment;if(e.isMobile)return this[v][m]?r()(d.Z,{[m]:this[v][m],[p]:this[v][p],focused:!1,format:d.Z.DisplayFormat.Name,showExtensionArrow:!this[v][h]}):r()(l.Z,{focused:!1,title:r()(s.FormattedMessage,{[c]:"Property",id:"database.mobileFilterAndSortMenu.property.buttonMenuItem.label"})});{const e=this[v][m]&&r()(a.Z,{[m]:this[v][m],showIcon:!0,style:{lineHeight:1.4}}),t=r()(s.FormattedMessage,{[c]:"Property",id:"database.filterAndSortMenu.propertyButton.label"});return r()(u.Z,{title:e,placeholder:t,[p]:this[v][p],[h]:this[v][h],disableMargins:this[v].disableMargins,desktopStyle:this[v].textWrapperStyle})}}}g.displayName="QueryMenuPropertyItem";const f=g},23564:(e,t,i)=>{i.d(t,{Z:()=>F});var o=i(97464),r=i.n(o),n=i(77094),s=i.n(n),l=i(67294),a=i(24405),d=i(8848),u=i(3909),c=i(82990),h=i(64921);const p=i(85).D7I,v=i(85).gdQ,m=i(85).XT4,g=i(85).u7O,f=i(85).IY7,y=i(85).S9$,Z=i(85).ewQ,S=i(85).G$8,M=i(85).Scd,k=i(85).jFW,b=i(85).UPJ,w=i(85).jkI;const F=function(e){window.__c={n:"SegmentedDropdownButton"};const{style:t,color:i,title:o,onClick:n,icon:F,dropdownEvents:x,className:T}=e,P=(0,a.yK)((e=>({wrap:{position:"relative",display:"inline-flex",flexShrink:0,borderRadius:3,overflow:"hidden",height:28},mainButton:{display:"flex",alignItems:w,[b]:w,whiteSpace:"nowrap",borderTopLeftRadius:3,[k]:3,lineHeight:1.1,paddingLeft:8,paddingRight:8,fontWeight:c.Z.fontWeight.medium,..."blue"===i&&{[M]:d.ZP.blue,color:d.ZP.white},..."orange"===i&&{[M]:"dark"===e.mode?e[Z][S][100]:e[Z][S][50],color:"dark"===e.mode?e[Z][S][600]:e[Z][S][400]}},dropdownButton:{display:"flex",alignItems:w,[b]:w,width:24,alignSelf:"stretch",borderTopRightRadius:3,[y]:3,..."blue"===i&&{[M]:d.ZP.blue,color:d.ZP.white,[f]:`inset 1px 0 0 ${e.darkDividerColor}`},..."orange"===i&&{[M]:"dark"===e.mode?e[Z][S][100]:e[Z][S][50],color:e[Z][S][400],[f]:"dark"===e.mode?`${e[Z][S][300]} 1px 0 0 inset`:`${e[Z][S][200]} 1px 0 0 inset`}},dropdownButtonIcon:{width:10,marginTop:2,..."blue"===i&&{fill:d.ZP.white},..."orange"===i&&{fill:"dark"===e.mode?e[Z][S][500]:e[Z][S][400]}},[g]:{..."blue"===i&&{[M]:e.blueButtonHoveredBackground},..."orange"===i&&{[M]:"dark"===e.mode?e[Z][S][200]:e[Z][S][100]}},[m]:{..."blue"===i&&{[M]:e.blueButtonPressedBackground},..."orange"===i&&{[M]:"dark"===e.mode?e[Z][S][300]:e[Z][S][200]}},icon:{width:12,marginRight:6,..."blue"===i&&{fill:d.ZP.white},..."orange"===i&&{fill:e[Z][S][400]}},border:{position:"absolute",pointerEvents:"none",borderRadius:3,top:0,left:0,right:0,bottom:0,..."blue"===i&&{[f]:"rgba(15, 15, 15, 0.1) 0px 0px 0px 1px inset, rgba(15, 15, 15, 0.1) 0px 1px 2px"},..."orange"===i&&{[f]:"dark"===e.mode?`${e[Z][S][300]} 0px 0px 0px 1px inset`:`${e[Z][S][200]} 0px 0px 0px 1px inset`}}})),[i]);return s()("div",{style:{...P.wrap,...t},className:T},void 0,s()(h.Z,{style:P.mainButton,onClick:n,disabledFeedback:!0,[v]:P[g],pressedStyle:P[m]},void 0,F&&F(P.icon),o),l[p](h.Z,r()({disabledFeedback:!0,style:P.dropdownButton,[v]:P[g],pressedStyle:P[m]},x),u.Z.chevronDown(P.dropdownButtonIcon)),s()("div",{style:P.border}))}},22084:(e,t,i)=>{i.d(t,{a:()=>g,F:()=>f});var o=i(97464),r=i.n(o),n=i(77094),s=i.n(n),l=i(67294),a=i(24405),d=i(8848),u=i(82990),c=i(62896),h=i(85567);const p=i(85).D7I,v=i(85).OtN,m=i(85).Uie;function g(e){window.__c={n:"SelectToken"};const{value:t,color:i,format:o,showEllipsis:n,onClickRemove:g,showRemoveButton:f,isSingle:y,shouldShrink:Z,...S}=e,M=(0,a.Fg)(),k=(0,a.yK)((()=>({token:{...n&&u.Z[m]}})),[n]),{textColor:b,[v]:w}=(0,d.KR)(M,i);return t?l[p](h.Z,r()({format:o,value:s()(c.Z,{},void 0,t),onClickRemove:g,showRemoveButton:f,isSingle:y,color:b,[v]:w,shouldShrink:Z,showFullValueTooltip:!0,style:k.token},S)):null}function f(e){window.__c={n:"StatusSelectToken"};const{value:t,color:i,format:o,showEllipsis:n,onClickRemove:g,showRemoveButton:f,isSingle:y,shouldShrink:Z,groupColor:S,...M}=e,k=(0,a.Fg)(),b=(0,a.yK)((()=>({token:{...n&&u.Z[m]}})),[n]);if(!t)return null;const{textColor:w,[v]:F}=(0,d.KR)(k,i??S??"gray"),x=i&&"default"!==i?i:S??"gray";return l[p](h.Z,r()({format:o,value:s()(c.Z,{},void 0,t),onClickRemove:g,showRemoveButton:f,isSingle:y,color:w,[v]:F,shouldShrink:Z,showFullValueTooltip:!0,style:b.token,isRound:!0,showColoredDot:x},M))}},91839:(e,t,i)=>{i.d(t,{Z:()=>d});var o=i(77094),r=i.n(o),n=(i(67294),i(5366));const s=i(85).lGm,l=i(85).nx5,a=i(85).Yzm;const d=function(e){let{style:t}=e;window.__c={n:"LoadingDots"};const i=(0,n.useIntl)();return r()("div",{"aria-valuetext":i[a]({id:"loadingDots.label",[l]:"Loading..."}),role:"progressbar",[s]:"loading-dots"},void 0,r()("div",{[s]:"loading-dot",style:{...t}}),r()("div",{[s]:"loading-dot",style:{...t}}),r()("div",{[s]:"loading-dot",style:{...t}}))}},28405:(e,t,i)=>{i.d(t,{Z:()=>eo});var o=i(77094),r=i.n(o),n=i(67294),s=i(480),l=i(81954),a=i(24405),d=i(39068),u=i(84116),c=i(5998),h=i(78106),p=i(3909),v=i(68626),m=i(70203),g=i(97880),f=i(82990),y=i(5366),Z=i(98104),S=i(14976),M=i(52821),k=i(17731),b=i(17809),w=i(33929),F=i(68056),x=i(33665),T=i(79315),P=i(24666),C=i(16354),I=i(97464),R=i.n(I),O=i(96486),A=i.n(O),D=i(84619),_=i(87279),B=i(29798),V=i(73657),E=i(52275),G=i(78140),N=i(32163),L=i(72495),W=i(21396);const Q=i(85).NTi,U=i(85).Q0u,K=i(85).SkZ,z=i(85).wtr,H=i(85).hqk,Y=i(85).hzi,j=i(85).AL1,$=i(85).FH8,q=i(85).ffk,X=i(85).IsR,J=i(85).X1X,ee=i(85).Hco,te=i(85).MWD,ie=i(85).nx5,oe=i(85).Gpy,re=i(85).TtP,ne=i(85).iB2,se=i(85).n$l,le=i(85).D7I,ae=i(85).voC;function de(e){window.__c={n:"FormulaAutocompleteMenu"};const{selection:t,cursorEditorInfo:i,context:o,value:d,onChange:c,[ae]:p,setHelperCompletion:v}=e,f=(0,s.Fy)(),Z=(0,l.qz)(void 0,B.Z),S=(0,n.useMemo)((()=>((null==i?void 0:i.completions)??[]).map(((e,r)=>({key:`${e.kind}-${r}`,render:t=>n[le](ue,R()({[se]:e,context:o,[ae]:p},t)),action:()=>{i&&function(e){const{[se]:t,value:i,selection:o,onChange:r,cursorEditorInfo:n}=e,s=(null==o?void 0:o[z])||0;if(t.kind===u.WY.Token){if(t[J][te]===u.Oy.Checkbox)return;if(t[J][te]===u.Oy[X]){var l;const e=s-((null===(l=n[K])||void 0===l?void 0:l.prefix)||"")[re],o=(0,m.deleteCharRange)(i,e,s),a=t[J][$]?(0,h.SR)(t[J][q]):t[J][q],d=(0,m.createMentionToken)((0,m.createFormulaPagePropertyMentionAnnotation)({[$]:t[J][$],[q]:a,name:t.name})),u=(0,m.insertTokensAtCharIndex)(o,[d],e);return void r({[Q]:u,newSelection:{[U]:e+1,[z]:e+1}})}if(t[J][te]===u.Oy[Y]){var a;const e=s-((null===(a=n[K])||void 0===a?void 0:a.prefix)||"")[re],o=(0,m.deleteCharRange)(i,e,s),l=(0,h.Kv)(t[J].valueId),d=(0,m.createMentionToken)((0,m.createFormulaContextValueMentionAnnotation)({id:l})),u=(0,m.insertTokensAtCharIndex)(o,[d],e);r({[Q]:u,newSelection:{[U]:e+1,[z]:e+1}})}else{if(t[J][te]===u.Oy.Date)return;if(t[J][te]===u.Oy.Block)return;if(t[J][te]===u.Oy.Person)return;if(t[J][te]===u.Oy.UserProperty){var d;const e=s-((null===(d=n[K])||void 0===d?void 0:d.prefix)||"")[re],o=(0,m.deleteCharRange)(i,e,s),l=(0,m.createMentionToken)((0,m.createFormulaUserPropertyMentionAnnotation)(t[J].userProperty)),a=(0,m.insertTokensAtCharIndex)(o,[l],e);r({[Q]:a,newSelection:{[U]:e+1,[z]:e+1}})}else(0,g.unreachable)(t[J])}}else if(t.kind===u.WY.LibraryFunction){var c;const e=s-((null===(c=n[K])||void 0===c?void 0:c.prefix)||"")[re],o=(0,m.deleteCharRange)(i,e,s),l=(0,m.createToken)(`${t[H].name}()`,[]),a=(0,m.insertTokensAtCharIndex)(o,[l],e),d=e+t[H].name[re]+1;r({[Q]:a,newSelection:{[U]:d,[z]:d}})}else if(t.kind===u.WY.Binding){var p;const e=s-((null===(p=n[K])||void 0===p?void 0:p.prefix)||"")[re],o=(0,m.deleteCharRange)(i,e,s),l=(0,m.createToken)(t[j],[]),a=(0,m.insertTokensAtCharIndex)(o,[l],e),d=e+t[j][re];r({[Q]:a,newSelection:{[U]:d,[z]:d}})}else(0,g.unreachable)(t)}({[se]:e,value:d,selection:t,onChange:c,cursorEditorInfo:i})}})))),[o,i,p,c,t,d]);(0,n.useEffect)((()=>{const e=e=>{if(void 0!==e.state.focus[ne]){var t;const o=null==i||null===(t=i.completions)||void 0===t?void 0:t[e.state.focus[ne]];return v(void 0===o?void 0:o)}};return Z.addListener(e),()=>Z.removeListener(e)}),[null==i?void 0:i.completions,Z,v]),(0,n.useEffect)((()=>{S[re]>0?Z.update((e=>({focus:{...e,section:0,[ne]:0,indexGlobal:0}}))):v(void 0)}),[S[re],Z,v]);const M=(0,a.yK)((e=>({menu:{borderLeft:`1px solid ${e.outlineButtonBorder}`}})),[]);let k;return k=f.isPhone?{menuType:_.og.ActionSheet,disableBottomPadding:!0}:{menuType:_.og.Popup,width:f.isPhone?180:240,minWidth:f.isPhone?180:240},n[le](G.Z,R()({},k,{scrollerStyle:M.menu}),r()(N.Z,{[te]:N.i.Vertical,initialFocus:0,priority:1,store:Z,sections:O.compact([{key:oe,render:e=>n[le](L.Z,R()({},e,{title:r()(y.FormattedMessage,{[ie]:"Insert a value",id:"formulaAutocompleteMenu.insertAValue.message"})})),items:S},0===S[re]&&{key:"no-results",render:e=>n[le](L.Z,R()({disableDesktopPadding:!0},e),r()(pe,{})),items:[]}])}))}const ue=n.forwardRef(((e,t)=>{window.__c={n:"CompletionMenuItem"};const{[se]:i,context:o,[ae]:s,...c}=e,p=(0,a.yK)((e=>({icon:{width:14,fill:e[ee]}})),[]),v=(0,l.VK)((()=>{var e,t;if(i.kind!==u.WY.Token||i[J][te]!==u.Oy[X]||!s)return;if(u.WG.includes(i[J][q]))return i[J][q];if(!i[J][$])return;const o=(0,h.SR)(i[J][q]),r=s(i[J][$]);return null==r||null===(e=r.getNormalizedSchema())||void 0===e||null===(t=e[o])||void 0===t?void 0:t[te]}),[i,s]);if(i.kind===u.WY.Token){if(i[J][te]===u.Oy.Checkbox)return null;if(i[J][te]===u.Oy[X]){if(!v)return n[le](E.Z,R()({icon:r()(ce,{valueType:{[te]:j}}),title:i.name??i[J][q]},c,{ref:t}));const e=d.wG[v](p.icon);return n[le](E.Z,R()({icon:e,title:i.name??i[J][q]},c,{ref:t}))}if(i[J][te]===u.Oy[Y]){const e=(0,h.vx)(o.valueTypes,(0,h.Kv)(i[J].valueId));return e?n[le](E.Z,R()({icon:r()(ce,{valueType:e[te]}),title:r()("div",{style:{display:"flex"}},void 0,r()(W.F,{value:e,format:D.l.Medium,isSingle:!0,shouldShrink:!0}))},c,{ref:t})):null}if(i[J][te]===u.Oy.Date)return null;if(i[J][te]===u.Oy.Block)return null;if(i[J][te]===u.Oy.Person)return null;if(i[J][te]===u.Oy.UserProperty)return n[le](E.Z,R()({icon:r()(ce,{valueType:u.VJ[i[J].userProperty]}),title:i[J].userProperty},c,{ref:t}));(0,g.unreachable)(i[J])}else{if(i.kind===u.WY.LibraryFunction)return n[le](E.Z,R()({icon:r()(ce,{valueType:i[H].iconType}),title:i[H].name},c,{ref:t}));if(i.kind===u.WY.Binding)return n[le](E.Z,R()({title:i[j]},c,{ref:t}));(0,g.unreachable)(i)}}));function ce(e){var t;window.__c={n:"FormulaValueTypeIcon"};const{valueType:i,style:o}=e,r=(0,a.yK)((e=>({icon:{width:14,fill:e[ee],...o}})),[o]);return(null===(t=he(i))||void 0===t?void 0:t(r.icon))??null}function he(e){return"text"===e[te]?d.wG[j]:"number"===e[te]?d.wG.number:"checkbox"===e[te]?d.wG.checkbox:"date"===e[te]?d.wG.date:"block"===e[te]?d.wG.relation:"person"===e[te]?d.wG.person:"select"===e[te]?d.wG.select:"array"===e[te]?d.wG.multi_select:"function"===e[te]?d.wG.formula:void("unknown"!==e[te]&&(0,g.unreachable)(e))}function pe(){return r()(V.Z,{caption:r()(y.FormattedMessage,{[ie]:"No results",id:"FormulaAutocompleteMenu.noResults.message"})})}var ve=i(97762),me=i(83355),ge=i(1302),fe=i(13991),ye=i(14577),Ze=i(15095),Se=i(42875),Me=i(62193),ke=i(44805),be=i(43132),we=i(993),Fe=i(98724),xe=i(56971),Te=i(12359),Pe=i(95477),Ce=i(62619),Ie=i(55227),Re=i(70219),Oe=i(89086),Ae=i(77907),De=i(30874),_e=i(29595),Be=i(1743),Ve=i(93262);const Ee=i(85).Oc6,Ge=i(85).Kq5,Ne=i(85).tb2,Le=i(85).Rbl,We=i(85).TtP,Qe=i(85).Q0u,Ue=i(85)._S$,Ke=i(85).EIp,ze=i(85).QvG,He=i(85).VNU,Ye=i(85).R5o,je=i(85).NOC,$e=i(85).uM3,qe=i(85).lL0,Xe=i(85).nNG,Je=i(85).qpz,et=i(85).k4A,tt=i(85).GCx,it=i(85).Wd3,ot=i(85).NMs,rt=i(85).rVs,nt=i(85).FcT,st=i(85).dbt,lt=i(85).YGn,at=i(85).Ano,dt=i(85).lZM,ut=i(85).XQm,ct=i(85).UD6,ht=i(85).LCr,pt=i(85).lp0,vt=i(85).XuB,mt=i(85).EHj,gt=i(85).$Lq,ft=i(85).sUt,yt=i(85).nxU,Zt=i(85).Drs,St=i(85).JJj,Mt=i(85).NTi,kt=i(85).Aw$,bt=i(85).qTm,wt=i(85).lw5,Ft=i(85).b8T,xt=i(85).tBn,Tt=i(85).lGm,Pt=i(85).OuZ,Ct=i(85).Ddq,It=i(85).IM3,Rt=i(85).xm3,Ot=i(85).Vtp,At=i(85).uvH,Dt=i(85).g65,_t=i(85).Sgw,Bt=i(85).W_R,Vt=i(85).j_T,Et=i(85).uPK,Gt=i(85).FfC,Nt=i(85).D6J,Lt=i(85).wDG,Wt=i(85).pkR,Qt=i(85).Wkb,Ut=i(85).t8X,Kt=i(85).MHP,zt=i(85).j4K,Ht=i(85).G0x,Yt=i(85).di,jt=i(85).Ql2,$t=i(85).XtO,qt=i(85).voC,Xt=i(85).Au,Jt=i(85).gl5,ei=i(85).wgE,ti=i(85).E0z,ii=i(85).cZW,oi=i(85).Fli,ri=i(85).iV$,ni=i(85).BQ6,si=i(85).D7I,li=i(85).UIj,ai=i(85).jx6,di=i(85).FV1,ui=i(85).P0R,ci=i(85).KV8,hi=i(85).QmD,pi=i(85).Ubc,vi=i(85).JFl,mi=i(85).Nm4,gi=i(85).OSs;class fi extends me.Z{constructor(){super(...arguments),this[gi]=null,this.mergeEditorRefs=(0,Me.sH)(),this[mi]=(e,t)=>{let{leafRef:i,wrapperRef:o,...r}=e;return n[si]("div",R()({ref:o},r,{[ni]:{flexGrow:1}}),n[si](_e.Z,{ref:this.mergeEditorRefs(this.editorRef,i),[ni]:this[vi](),[ri]:this[pi],getHtml:()=>this.getHtml(this[ci][hi],this[ui].errorRanges),[oi]:this[di],onMutation:this[ai],spellCheck:!1,autoCorrect:"off",autoCapitalize:"off",onSelect:t,onMouseOver:this[li],onMouseOut:this.handleMouseOut,suppressNewlineEvents:!1,[ii]:" "}))},this.renderSyntaxTokens=(e,t)=>{const i=Ie.kF(t,e),{[ti]:o}=this[ei],s=t.map(m[Jt]).map(((e,t)=>ke.getAnnotationStyles({annotations:e,[Xt]:this[Xt],[qt]:this[ui][$t][qt],[jt]:this[ui][Yt]})));return i.map(((e,i)=>{const l=t[e.textTokenIndex],a=s[e.textTokenIndex];return m.isMentionToken(l)?(0,ke.renderTextNodeHelper)({args:{[Ht]:{value:t,[jt]:this[ui][Yt]},[qt]:this[ui][$t][qt],[zt]:this[ui][$t][zt],disableHover:!1,[Kt]:!1,[Ut]:!1,disableLinks:!1,[Qt]:(0,Se.r)(),[Wt]:!1,[Lt]:o[Lt],[Nt]:o.isSafari||o.isIOS,[Gt]:o[Gt],showEmojiInline:o[Gt],emojiType:"raw",highlightDiscussionId:void 0,[Xt]:this[Xt],intl:w.default.getIntl(),renderedPageBlockId:void 0,[Et]:void 0,katex:void 0,isClient:!0,baseUrl:Pe.default[Vt],[Bt]:Pe.default[Bt],[_t]:this[ei][Dt].id,[At]:(0,Re.b)(this[ei]),[Ot]:De.Z[Rt][hi],[It]:this[ui][Ct]},[ni]:a[ni],classNames:a.classNames,index:i,token:l,tokenValue:m[Pt](l),tokenAnnotations:m[Jt](l)}):n[si](n[xt],null,r()("span",{[Tt]:[e.classNames||"",...a.classNames].join(" "),[ni]:a[ni],"data-token-index":e.textTokenIndex},i,e.value))}))},this[Ft]=e=>{S.handleEditableClick({[ei]:this[ei],[wt]:e,[Ht]:this[ci][hi],editorNode:this[bt](),[$t]:this[ui][$t],[kt]:!this[pi]()})},this[ai]=e=>{let{[Mt]:t}=e;Te[St]({[Zt]:"FormulaInputText.handleMutation",[ei]:this[ei],[yt]:e=>{we.applyTextUpdate({[ei]:this[ei],[$t]:this[ui][$t],[Mt]:t,[ft]:!0,[gt]:!0,[mt]:!0,[vt]:!0,[pt]:!0,disableFilters:!0,[ht]:e}),e.postEnqueueActions.push((()=>{Te[St]({[Zt]:"FormulaInputText.normalizeTextValue",[ei]:this[ei],[yt]:e=>{we.normalizeFormulaTextValue({[$t]:this[ui][$t],[ht]:e})}})}))}})},this[ct]=e=>{if(this[pi]())return;const t=P.default[hi];"editing"===t.mode&&t[ut].start[$t]===this[ui][$t]&&Te[St]({[Zt]:"FormulaInputText.handleDelete",[ei]:this[ei],[yt]:i=>{xe.as({[ei]:this[ei],[ut]:t[ut],deleteForwards:!0,[ht]:i,[wt]:e})}})},this[dt]=e=>{if(this[pi]())return;const t=P.default[hi];if("editing"===t.mode&&t[ut].start[$t]===this[ui][$t]){if(xe.YV({[ti]:this[ei][ti],[wt]:e,[ut]:t[ut]}))return;Te[St]({[Zt]:"FormulaInputText.handleBackspace",[ei]:this[ei],[yt]:i=>{xe.as({[ei]:this[ei],[ut]:t[ut],deleteForwards:!1,[ht]:i,[wt]:e})}})}},this[at]=e=>{var t;if(this[pi]())return;if(null===(t=e[lt])||void 0===t||t.call(e),this[gi]&&this[gi][st])return;const i=P.default[hi],o="editing"===i.mode&&(0,F.QY)(i[ut]);o&&Te[St]({[Zt]:"FormulaInputText.handleShiftEnter",[ei]:this[ei],[yt]:e=>{we.insertString({[ei]:this[ei],[$t]:this[ui][$t],string:"\n",[nt]:o[nt],[ft]:!0,[gt]:!0,[mt]:!0,[vt]:!0,[ht]:e})}})},this.handleTab=e=>{if(this[pi]())return;e[lt]();const t=P.default[hi],i="editing"===t.mode&&(0,F.QY)(t[ut]);i&&Te[St]({[Zt]:"FormulaInputText.handleTab",[ei]:this[ei],[yt]:e=>{we.indentSelection({[ei]:this[ei],[$t]:this[ui][$t],[nt]:i[nt],[ht]:e,shouldStripTokens:!1})}})},this.handleUntab=e=>{if(this[pi]())return;e[lt]();const t=P.default[hi],i="editing"===t.mode&&(0,F.QY)(t[ut]);i&&Te[St]({[Zt]:"FormulaInputText.handleUntab",[ei]:this[ei],[yt]:e=>{we.unindentSelection({[ei]:this[ei],[$t]:this[ui][$t],[nt]:i[nt],[ht]:e,shouldStripTokens:!1})}})},this[rt]=(e,t)=>{this[pi]()||(t[lt](),Fe.aS({[ei]:this[ei],[ot]:e}),this[it]())},this.handleCopy=e=>{be.copy({[ei]:this[ei],[wt]:e})},this.handleCut=e=>{this[pi]()?e[lt]():be.cutWithMaybeConfirmation({[ei]:this[ei],[wt]:e})},this.handlePaste=e=>{this[pi]()?e[lt]():Te[St]({[Zt]:"FormulaInputText.handlePaste",[ei]:this[ei],[yt]:t=>{be.paste({[ei]:this[ei],[wt]:e,disableEmbedMenu:!0,[ht]:t,onPasteFiles:be.pasteFilesForBlocks})}})},this.handleMoveUp=e=>{Te[St]({[Zt]:"FormulaInputText.handleMoveUp",[ei]:this[ei],[yt]:e=>{we.moveUpDown({[ei]:this[ei],[ht]:e,[tt]:"up"})}})},this.handleMoveDown=e=>{Te[St]({[Zt]:"FormulaInputText.handleMoveDown",[ei]:this[ei],[yt]:e=>{we.moveUpDown({[ei]:this[ei],[ht]:e,[tt]:"down"})}})},this[li]=e=>{S.handleEditableMouseOver({[ei]:this[ei],[wt]:e,[Ht]:this[ci][hi],editorNode:this[bt](),[$t]:this[ui][$t],[kt]:!this[pi]()})},this.handleMouseOut=e=>{S.handleEditableMouseOut({[ei]:this[ei],[wt]:e,[Ht]:this[ci][hi],editorNode:this[bt](),[$t]:this[ui][$t],[kt]:!this[pi]()})},this[pi]=()=>this[ui][Wt],this.createSyntaxToken=e=>Ce.isText(e)?[e.data]:Ce[et](e)?[e[Je]||"",e[Tt]]:void 0,this.getHtml=(e,t)=>{const{Prism:i}=this[ui],o=m.getText(e),s="rust",l=i.languages.rust,a=document[si]("div"),d=i[Xe](o,l,s);a[qe]=Ie.g7(d);const u=A()[$e](Array.from(a[je]).map(this.createSyntaxToken));for(const r of t)e=m.annotateSelection({[Ht]:e,[nt]:r,[ot]:[m[Ye].FormulaError]});const c=this.renderSyntaxTokens(A()[$e](u),e||[]),h=r()(n[xt],{},void 0,c,r()("span",{},void 0,"\n"));return ve.renderToStaticMarkup(h)},this[He]=()=>{var e;null===(e=this[bt]())||void 0===e||e.blur()},this[ci]=new ye.Z((()=>this[ui][$t].getValue()||[]),{debugName:"FormulaInputText.textValueStore"}),this[ze]=this[Ke]((()=>{var e;const t=P.default[hi];return"editing"===t.mode&&(null===(e=(0,F.QY)(t[ut]))||void 0===e?void 0:e[$t])===this[ui][$t]})),this[di]=()=>{if(this[ze][hi])return(0,Oe.HE)(this[ui][$t])},this.getEndSelection=()=>{const e=Ze[Ue](m.getText(this[ci][hi]));return{[Qe]:e[We],endIndex:e[We]}},this.editorRef=e=>{this[gi]=e}}willMount(e){e.focus&&Z.setSelectionAtEnd({[$t]:e[$t]})}renderComponent(){const{[$t]:e,[Wt]:t,handleSaveOnEsc:i}=this[ui];return r()(Be.Z,{capture:!0,allowUpDownFn:e=>e.shiftKey||"metaKey"in e&&e.metaKey||"ctrlKey"in e&&e.ctrlKey,allowEnter:!0,allowTabUntab:!0,allowUndo:!0,allowEsc:void 0!==i,allowCopyPaste:!0},void 0,r()(Ve.Z,{[$t]:e,[Wt]:t,disableAnnotation:!0,[He]:this[He],getEndSelection:this.getEndSelection,onClick:this[Ft],onDelete:this[ct],onBackspace:this[dt],onShiftEnter:this[at],onCommandEnter:A()[Le],onCommandShiftEnter:A()[Le],onTab:this.handleTab,onUntab:this.handleUntab,onToggleBold:e=>this[rt](["b"],e),onToggleItalics:e=>this[rt](["i"],e),onToggleUnderline:e=>this[rt](["_"],e),onToggleStrike:e=>this[rt](["s"],e),onToggleCode:A()[Le],onCopy:this.handleCopy,onCut:this.handleCut,onPaste:this.handlePaste,onMoveUp:this.handleMoveUp,onMoveDown:this.handleMoveDown,onEsc:i,render:this[mi],[ft]:!0,[mt]:!0,[Ne]:!0,canInsertText:!0,canSelectionDrag:!0,disableMobileActionBar:!0,[Ge]:40,pasteBehavior:"inline"}))}[bt](){var e;return(null===(e=this[gi])||void 0===e?void 0:e.getNode())||void 0}[it](){ge.default.flush()}[vi](){return{flexGrow:1,flexShrink:1,textAlign:"left",fontFamily:f.Z[Ee](fe.SP).githubMono,fontSize:14,tabSize:2,whiteSpace:"pre",borderRadius:3,minHeight:"1em",padding:"6px 12px",height:"100%",wordBreak:"break-all",textWrap:"wrap"}}}fi.displayName="FormulaInputText";const yi=(0,Ae.withDependency)(Ae.deps.prismjs,((e,t)=>n[si](fi,R()({},t,{Prism:e})))),Zi=i(85).nx5,Si=i(85).jwP,Mi=i(85).ffk,ki=i(85).bey,bi=i(85).wuN,wi=i(85).IM3,Fi=i(85).t8X,xi=i(85).MHP,Ti=i(85).zDZ,Pi=i(85).Yzm,Ci=i(85).hqk,Ii=i(85).PXg,Ri=i(85).c5o,Oi=i(85).OtN,Ai=i(85).ewQ,Di=i(85).Exd,_i=i(85).jkI,Bi=i(85).H1U,Vi=i(85).MQM,Ei=i(85).fBu,Gi=i(85).n$l,Ni=i(85).voC,Li=i(85).BQ6,Wi=i(85).Ddq,Qi=i(85).mPA,Ui=i(85).$bT,Ki=i(85).gGi,zi=i(85).EMU,Hi=i(85).sM5,Yi=i(85).L_E,ji=i(85).XQm,$i=i(85).wtr,qi=i(85).Q0u,Xi=i(85).pkR,Ji=i(85).di;function eo(e){window.__c={n:"FormulaInput"};const{evaluationErrors:t,value:i,[Ji]:o,inputHeader:d,onChange:u,[Xi]:h,typecheckContext:p,formulas:g,handleTypeChange:f,handleSaveOnEsc:S,parentCollection:M}=e,k=(0,s.Fy)(),w=(0,y.useIntl)(),{store:x,setValue:T}=(0,b.useMockTextStore)({initialValue:i,onChange:u,source:"formula",parentCollection:M}),C=(0,n.useCallback)((e=>{if(T(e.newValue),e.newSelection){const t={start:{store:x,index:e.newSelection[qi]},end:{store:x,index:e.newSelection[$i]}};Z.setMultiSelection({[ji]:t})}}),[T,x]),I=(0,l.VK)((()=>{var e;const t=P.default.state;if("editing"===t.mode&&(null===(e=(0,F.QY)(t[ji]))||void 0===e?void 0:e.store)===x)return{[qi]:t[ji].start.index,[$i]:t[ji].end.index}}),[x]),R=(0,l.VK)((()=>x.getValue()),[x]),[O,A]=(0,l.VK)((()=>R?g.processFormulaInput(R):[void 0,void 0]),[R,g]),D=(0,l.VK)((()=>{if(O)return g.parseFormulaInput(O,A)}),[O,g,A]),_=(0,l.VK)((()=>{if(D)return g.convertFormulaCSTToAST(D[0])}),[g,D]),[B,V]=(0,n.useState)(void 0);(0,n.useEffect)((()=>{!async function(){if(_&&p&&v.x.isSuccess(_)){const e=await g.addTypesToFormulaASTAsync(_.value,p,A);V(e),null==f||f(e.node.type)}else V(void 0)}()}),[_,p,A,D,g,f]);const E=(0,l.VK)((()=>({parseErrors:(null==D?void 0:D[1])??[],typeErrors:(null==B?void 0:B.errors)??[],evaluationErrors:t})),[null==B?void 0:B.errors,t,D]),G=(0,l.VK)((()=>function(e,t){const{parseErrors:i,typeErrors:o,evaluationErrors:r}=e;let n=[];o&&o.length>0?n=o.map((e=>{const i=(0,c.FR)((0,c.ic)(e));return t[Pi](...i)})):r&&r.length>0&&(n=r.map((e=>{const i=(0,c.FR)((0,c.OY)(e));return t[Pi](...i)})));if(i){const e=i.map((e=>{const i=(0,c.FR)((0,c.sG)(e));return t[Pi](...i)}));n.push(...e)}if(0===n.length)return;return t.formatList([...new Set(n)],{type:"unit",[Li]:"long"})}(E,w)),[E,w]),N=(0,l.VK)((()=>{if(!R)return[];const e=(0,m.getText)(R).length;return function(e,t,i){const o=[];if(e.parseErrors)for(const r of e.parseErrors){const e="eof"===r.offset?{[qi]:t-1,[$i]:t}:{[qi]:r.offset,[$i]:r.offset+1};o.push(e)}if(e.typeErrors)for(const r of e.typeErrors){const e={[qi]:r.node.startOffset,[$i]:r.node.endOffset+1};o.push(e)}if(e.evaluationErrors)for(const r of e.evaluationErrors)if(i.isUniqueFormulaEvaluatorError(r)){const e={[qi]:r.node.startOffset,[$i]:r.node.endOffset+1};o.push(e)}return o}(E,e,g)}),[E,g,R]),[L,W]=(0,n.useState)(void 0),[Q,U]=(0,n.useState)(void 0),K=(0,n.useRef)(1);(0,n.useEffect)((()=>{K.current++;const e=K.current;!async function(){if(g){const t=await g.getFormulaEditorInfoAtPosition({formula:R??[],inputPosition:I&&I[qi]===I[$i]?I[qi]:0,context:p,hideDeprecatedCompletions:!0});v.x.isSuccess(t)&&K.current===e&&W(t.value)}}()}),[i,I,g,p,R]);const z=(0,a.yK)((e=>({[Yi]:{[Hi]:zi,height:Ki,paddingBottom:30},leftColumn:{width:k.isMobile?"50vw":void 0,flexGrow:1,height:Ki,[Hi]:zi,[Ui]:"column",minWidth:0},inputText:{[Hi]:zi,flexGrow:1,flexShrink:1,overflow:"auto"}})),[k.isMobile]);return r()("div",{[Li]:z[Yi]},void 0,r()("div",{[Li]:z.leftColumn},void 0,d,r()("div",{[Li]:z.inputText},void 0,r()(yi,{value:R,focus:!0,store:x,[Xi]:h,[Ji]:o,[Wi]:p[Wi],errorRanges:N,handleSaveOnEsc:S},Qi)),r()(io,{[Gi]:Q,[Ei]:x,[Ni]:e[Ni]}),r()(to,{[Vi]:G})),r()(de,{value:R,context:p,selection:I,cursorEditorInfo:L,onChange:C,[Ni]:e[Ni],setHelperCompletion:U}),r()(so,{}))}function to(e){let{[Vi]:t}=e;window.__c={n:"FormulaErrors"};const i=(0,a.yK)((e=>({errors:{[Hi]:zi,[Bi]:_i,zIndex:1,[Di]:f.Z[Di].UISmall.desktop,padding:"10px 12px",height:"auto",width:Ki,color:"light"===e.mode?e[Ai].red[500]:e[Ai].red[800],[Oi]:"light"===e.mode?e[Ai].red[30]:e[Ai].red[200],borderTop:`1px solid ${e[Ri]}`,position:"sticky",bottom:0,left:0},errorsText:{[Hi]:"-webkit-box",textWrap:"wrap",wordBreak:"break-word",overflow:"hidden",lineClamp:3,WebkitLineClamp:3,WebkitBoxOrient:"vertical"},icon:{width:12,height:12,fill:"light"===e.mode?e[Ai].red[400]:e[Ai].red[700],[Hi]:"inline",[Ii]:4}})),[]);return null!=t&&t.length?r()("div",{[Li]:i.errors},void 0,p.Z.warning(i.icon),r()("div",{[Li]:i.errorsText},void 0,t)):null}const io=n.memo((e=>{let{[Gi]:t,[Ni]:i,[Ei]:o}=e;if(void 0===(null==t?void 0:t.kind))return null;switch(t.kind){case u.WY.Token:return r()(no,{[Gi]:t,[Ni]:i});case u.WY.LibraryFunction:var n;return r()(ro,{icon:he(t[Ci].iconType),name:(null===(n=t[Ci].syntax)||void 0===n?void 0:n[0])??t[Ci].name,[Ti]:w.default[Pi](t[Ci][Ti]),code:t[Ci].examples.map(((e,t)=>r()(oo,{example:e,[Ei]:o},t)))});case u.WY.Binding:return null;default:return(0,g.unreachable)(t)}}));function oo(e){let{example:t,[Ei]:i}=e;window.__c={n:"CodeExample"};const o=(0,k.kw)(),d=(0,s.O7)(),u=(0,l.VK)((()=>{var e;return null===(e=T.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),c=(0,a.Fg)(),h=(0,l.VK)((()=>Array.isArray(t[Qi])?(0,S.renderText)({environment:d,textValue:t[Qi]&&{value:t[Qi],spaceId:u},[Ei]:i,disableHover:!1,[xi]:!1,disableLinks:!0,[Fi]:!1,[Xi]:!0,theme:c,emojiType:o,katex:void 0,[wi]:[]}):t[Qi]),[o,d,t[Qi],i,u,c]),p=(0,l.VK)((()=>Array.isArray(t.output)?(0,S.renderText)({environment:d,textValue:t.output&&{value:t.output,spaceId:u},[Ei]:i,disableHover:!1,[xi]:!1,disableLinks:!0,[Fi]:!1,[Xi]:!0,theme:c,emojiType:o,katex:void 0,[wi]:[]}):t.output),[o,d,t.output,i,u,c]);return r()(n.Fragment,{},void 0,h," ","＝"," ",p,"\r\n")}function ro(e){let{name:t,icon:i,[Ti]:o,code:n}=e;window.__c={n:"FormulaHelperBody"};const s=(0,a.yK)((e=>({helper:{[Hi]:zi,[Ui]:"column",zIndex:1,[Di]:f.Z[Di].UISmall.desktop,padding:"12px 14px",height:"auto",width:Ki,borderTop:`1px solid ${e[Ri]}`,position:"sticky",bottom:0,left:0,gap:"6px"},name:{fontWeight:600,[Hi]:zi,[Bi]:_i},[Ti]:{color:e[bi]},code:{fontFamily:"monospace",whiteSpaceCollapse:"preserve",[Di]:11,borderRadius:5,[Oi]:e.codeBlockBackground,margin:"0 -4px",padding:"6px"},[ki]:{height:14,width:14,fill:e.mediumIconColor,[Hi]:"inline",[Ii]:6}})),[]);return r()("div",{[Li]:s.helper},void 0,r()("span",{[Li]:s.name},void 0,void 0!==i&&i(s[ki]),t),void 0!==o&&r()("span",{[Li]:s[Ti]},void 0,o),void 0!==n&&r()("code",{[Li]:s.code},void 0,n))}function no(e){let{[Gi]:t,[Ni]:i}=e;window.__c={n:"FormulaTokenCompletionHelper"};const{name:o,[Ti]:n,icon:s}=(0,l.VK)((()=>{var e;if(t.token.type!==u.Oy.BlockProperty||!i)return{};if(u.WG.includes(t.token[Mi])){var o;const e=null===(o=u.dy[t.token[Mi]])||void 0===o?void 0:o.type,i=e?M.SO[e]:void 0,r=e?d.wG[e]:void 0;return{name:t.name??t.token[Mi],icon:r,[Ti]:e?w.default.getIntl()[Pi]({id:Si,[Zi]:"{type} property."},{type:i}):void 0}}if(!t.token.collection)return{};const r=(0,h.SR)(t.token[Mi]),n=i(t.token.collection),{type:s,name:l}=(null==n||null===(e=n.getNormalizedSchema())||void 0===e?void 0:e[r])??{},a=s?d.wG[s]:void 0,c=s?M.SO[s]:void 0;return{name:l,icon:a,[Ti]:s?w.default.getIntl()[Pi]({id:Si,[Zi]:"{type} property."},{type:c}):void 0}}),[t,i]);return void 0===o?null:r()(ro,{name:o,icon:s,[Ti]:n})}const so=n.memo((()=>{window.__c={n:"FormulaUpdateFooter"};const e=(0,a.yK)((e=>({updateBanner:{zIndex:1,position:"absolute",alignSelf:"flex-end",justifySelf:"flex-end",bottom:0,[Hi]:zi,[zi]:"none",[Bi]:_i,[Di]:f.Z[Di].UISmall.desktop,paddingLeft:8,paddingRight:8,minHeight:30,height:"auto",width:Ki,color:e[bi],borderTop:`1px solid ${e[Ri]}`},messageText:{[Di]:f.Z[Di].UISmall.desktop},icon:{width:14,height:14,[Ii]:2,color:e.blueColor}})),[]);return r()("div",{[Li]:e.updateBanner},void 0,p.Z.mobileNewFeatures(e.icon),r()(C.Z,{href:(0,x.getLocalizedUrl)("guides.formulas"),external:!0},void 0,r()(y.FormattedMessage,{[Zi]:"We've recently updated our formula language! Learn more.",id:"formula2Input.learnMore.button.label"})))}))},21396:(e,t,i)=>{i.d(t,{e:()=>h,F:()=>p});var o=i(97464),r=i.n(o),n=i(67294),s=i(24405),l=i(84116),a=i(3909),d=i(97880),u=i(93044);const c=i(85).J9j;function h(e){if(e.kind===l.yp.ContextValue)return e.name;if(e.kind===l.yp.Binding||e.kind===l.yp.ThisRow)throw new Error("Not implemented yet.");(0,d.unreachable)(e)}function p(e){window.__c={n:"FormulaValueToken"};const{value:t}=e,i=(0,s.Fg)(),o=h(t);let l,d;if("date"===t.type.type?l=a.Z.typesDate:"person"===t.type.type?l=a.Z.typesPerson:("block"===t.type.type||"array"===t.type.type&&"block"===t.type.of.type)&&(l=a.Z.collectionSearch),l){const e=l;d=()=>e({width:12,height:12,marginRight:4})}return n.createElement(u.ZP,r()({},e,{title:o,renderAvatar:d,shouldShrink:!0,style:{background:i[c],color:i.blueColor,padding:"0 4px"}}))}},5971:(e,t,i)=>{i.d(t,{E:()=>n});var o=i(81954),r=i(10161);function n(e){return(0,o.VK)((()=>r.default.checkGate(e)),[e])}}}]);