"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[5403],{63123:(t,e,i)=>{i.d(e,{V:()=>r});var n=i(67294);const o=i(85).iDK;function r(t){const{value:e,validateLoaded:i}=t,r=t.waitTimeInMs||500,[s,a]=(0,n.useState)(!0),l=(0,n.useRef)(),d=void 0!==e&&(!i||s&&i(e));return(0,n.useEffect)((()=>(l[o]=window.setTimeout((()=>{a(!1),l[o]=void 0}),r),()=>{l[o]&&(clearTimeout(l[o]),l[o]=void 0)})),[r]),(0,n.useEffect)((()=>{d&&l[o]&&(a(!1),clearTimeout(l[o]),l[o]=void 0)}),[d]),void 0!==e&&d?{status:"resolved",value:e}:s?{status:"pending",value:void 0}:{status:"rejected",value:void 0,error:new Error("Reached end of timeout before value became defined.")}}},68500:(t,e,i)=>{i.d(e,{Z:()=>Lt});var n=i(97464),o=i.n(n),r=i(77094),s=i.n(r),a=i(96486),l=i.n(a),d=i(67294),u=i(83355),c=i(66897),p=i(14714),h=i(99036),m=i(3909),v=i(4615),g=i(23014),f=i(21202),y=i(6287),S=i(97880),b=i(5366),w=i(47307),C=i(31299),P=i(66890),I=i(87279),x=i(63725),k=i(33846),Z=i(29798),_=i(39098),T=i(42922),M=i(52275),F=i(36488),A=i(74194),R=i(68894),D=i(78140),B=i(32163),O=i(43765),N=i(11470),V=i(77137),E=i(72495),G=i(86765),L=i(97680);const K=i(85).zG9,U=i(85).MsU,q=i(85).UGA,W=i(85).UDE,z=i(85).xgV,H=i(85).tBn,Q=i(85).j7K,$=i(85).y79,j=i(85).d1d,Y=i(85).irb,J=i(85).LTP,X=i(85).G_Z,tt=i(85).I2,et=i(85).XNW,it=i(85).PP_,nt=i(85).raT,ot=i(85).Dd5,rt=i(85).cZW,st=i(85).kdC,at=i(85).Yzm,lt=i(85).rpY,dt=i(85).D7I,ut=i(85).nx5,ct=i(85).MWD,pt=i(85).xd5,ht=i(85).iIv,mt=i(85).o0W,vt=i(85).VFs,gt=i(85).iB2,ft=i(85).lsp,yt=i(85).nm$,St=i(85).loK,bt=i(85).QmD,wt=i(85).Wp_,Ct=i(85).Gnd,Pt=i(85).d73,It=i(85).uJ5,xt=i(85).gaz,kt=i(85).Ql2,Zt=i(85).N20,_t=i(85).wgE,Tt=i(85).JmH,Mt=i(85).G3i,Ft=i(85).TLr,At=i(85).zd9,Rt=i(85).ffk,Dt=i(85).P0R,Bt=i(85).fBu,Ot=i(85).Leq,Nt=i(85).P24,Vt=i(85).P0G,Et=i(85).K0Z;class Gt extends u.Z{constructor(){super(...arguments),this.storeTypes={[Et]:k.Z,[Vt]:Z.Z,[Nt]:x.Z},this.performRelationSearchRequest=async t=>{const{[Ot]:e,schema:i,[Bt]:n}=this[Dt],o=i[e[Rt]];if(!o||!(0,h.isRelationPropertySchema)(o))return;const r=o[At];if(!r)return;const s=_.NW[Ft](n,{table:y.v,id:r.id});if(await s.load(),!s[Mt]())return;const a=s[Tt]();return(await C.searchPagesInCollection({[_t]:this[_t],query:t,[Zt]:r.id,[kt]:a,[xt]:!0,source:"collection_group_value",limit:20,[It]:!1,[Pt]:!1})).results.map((t=>({table:f.iU,id:t,[kt]:a})))},this.handleTextInputChange=t=>{const{[Et]:e,[Vt]:i}=this[Ct];e[wt]({...e[bt],[St]:t[yt].value}),i[wt]({...i[bt],focus:{[ft]:0,[gt]:0,[vt]:0}})},this.handleTextInputKeydown=t=>{if(13===t.keyCode)this[mt]();else if(27===t.keyCode){var e,i;null===(e=(i=this[Dt])[ht])||void 0===e||e.call(i)}},this.handleMenuClickRight=()=>{this[mt]()},this.handleClickSubmitButton=()=>{this[mt]()},this.performUserSearchRequest=async t=>(await C.searchVisibleSpaceUsers({[_t]:this[_t],query:t,membersOnly:!1})).slice(0,20)}willMount(t){var e;super.willMount(t);const{[Et]:i}=this[Ct],{[pt]:n}=this[Dt];n&&("select"===n.value[ct]||"multi_select"===n.value[ct])&&n.value.value?i[wt]({...i[bt],[St]:n.value.value}):n&&(0,p.R7)(n.value)&&"exact"===(null===(e=n.value.value)||void 0===e?void 0:e[ct])&&i[wt]({...i[bt],[St]:n.value.value.value})}renderComponent(){const{[pt]:t,[ht]:e}=this[Dt];let i;return i=this[_t].device.isPhone?{menuType:I.og.Modal,title:s()(b.FormattedMessage,t?{[ut]:"Rename group",id:"codeBlock.databaseEditGroupMenu.renameGroupTitle"}:{[ut]:"Add a group",id:"codeBlock.databaseEditGroupMenu.addGroupTitle"}),left:s()(b.FormattedMessage,{[ut]:"Cancel",id:"codeBlock.databaseEditGroupMenu.cancelButton.label"}),right:s()(b.FormattedMessage,{[ut]:"Done",id:"codeBlock.databaseEditGroupMenu.doneButton.label"}),onClickRight:this.handleMenuClickRight,onClickLeft:e}:{menuType:I.og.Popup,width:this.isTextInputType()?300:240,maxHeight:"50vh"},s()(F.Z,{capture:!0,[lt]:t=>d[dt](D.Z,o()({},i,t),this.renderMenuInner())})}renderMenuInner(){const{[Ot]:t,schema:e}=this[Dt];if(e[t[Rt]])return"select"===t[ct]||"multi_select"===t[ct]?this.renderTextInput():"person"===t[ct]?this.renderPersonValue():"relation"===t[ct]?this.renderRelationValue():(0,p.HB)(t[ct])?this.renderTextInput():void("number"!==t[ct]&&"status"!==t[ct]&&"date"!==t[ct]&&"formula"!==t[ct]&&"checkbox"!==t[ct]&&"created_time"!==t[ct]&&"last_edited_time"!==t[ct]&&"created_by"!==t[ct]&&"last_edited_by"!==t[ct]&&"last_visited_time"!==t[ct]&&"location"!==t[ct]&&(0,S.unreachable)(t[ct]))}renderTextInput(){const{intl:t,[pt]:e}=this[Dt],{[St]:i}=this[Ct][Et][bt],n=e?t[at]({id:"database.collectionEditGroupMenu.renameGroupLabel.placeholder",[ut]:"Rename group"}):t[at]({id:"database.collectionEditGroupMenu.newGroupLabel.placeholder",[ut]:"New group"});return this[_t].device.isPhone?s()(E.Z,{},void 0,s()(R.ZP,{value:i,focus:!0,selectAll:!0,[st]:!1,focusInitial:!0,[rt]:n,[ot]:this.handleTextInputChange,onKeyDown:this.handleTextInputKeydown})):s()("div",{style:{display:"flex",alignItems:"center",padding:"8px 10px",width:"100%",background:this.theme.inputBackground}},void 0,s()(A.Z,{value:i,focus:!0,selectAll:!0,focusInitial:!0,[rt]:n,[ot]:this.handleTextInputChange,onKeyDown:this.handleTextInputKeydown,format:A.B[nt]}),s()(T.Z,{onClick:this.handleClickSubmitButton},void 0,s()(b.FormattedMessage,{[ut]:"Done",id:"database.collectionEditGroupMenu.submitButton.label"}),m.Z.enter({height:14,width:14,fill:it,[et]:6,marginTop:2})))}renderPersonValue(){const{[tt]:t,intl:e}=this[Dt],{[St]:i}=this[Ct][Et][bt];return s()(V.Z,{request:i,[z]:this.performUserSearchRequest,debounce:C[X],[lt]:(n,r,a)=>{r||(r=[]);const u=l().compact(r.map((e=>({key:e.id,[lt]:t=>d[dt](L.Z,o()({actor:(0,c.dp)(e)},t)),action:()=>{const{[ot]:i,[pt]:n}=this[Dt],o={[ct]:"person",value:{table:J,id:e.id}};var r,s;n&&l().isEqual(o,n.value)?null===(r=(s=this[Dt])[ht])||void 0===r||r.call(s):t.some((t=>(0,p.we)(o,t.value)))?w[Y](this[j]()):i({newGroupValue:o})}}))));let h;return h=a&&r&&0===u.length?s()(E.Z,{},void 0,s()(O.Z,{title:s()(b.FormattedMessage,{[ut]:"No results",id:"database.noPersonSearchResults.message"})})):s()(B.Z,{[ct]:B.i[$],[Q]:0,sections:[{key:0,[lt]:t=>d[dt](E.Z,t),items:u}],store:this[Ct][Vt]}),d[dt](d[H],null,s()(E.Z,{},void 0,s()(R.ZP,{value:i,focus:!0,[rt]:e[at]({[ut]:"Search for a person…",id:"database.searchPerson.placeholder"}),[ot]:t=>{this[Ct][Et][wt]({...this[Ct][Et][bt],[St]:t[yt].value}),this[Ct][Vt][wt]({...this[Ct][Vt][bt],focus:{[ft]:0,[gt]:0,[vt]:0}})}})),h)}})}getCreateNewPageMenuListItem(){const{[Bt]:t,schema:e,[Ot]:i}=this[Dt],{[St]:n}=this[Ct][Et][bt],r=e[i[Rt]];if(!r||"relation"!==r[ct])return null;const a=h[W](r);if(!a)return null;const l=_.NW[Ft](t,a);return l[Mt]()&&n.length>0?{key:"new-page",[lt]:t=>d[dt](M.Z,o()({title:s()(G.Z,{[q]:l,title:n})},t)),action:()=>{const{[ot]:t}=this[Dt],e={table:f.iU,id:(0,v.default)(),[kt]:l[Tt]()};t({newGroupValue:{[ct]:U,value:e},newPage:{id:e.id,[kt]:e[kt],name:n}})}}:null}getMenuListItemsForRelatedRecords(t,e){var i;const{[tt]:n,[Bt]:r}=this[Dt],s=null===(i=this.context[Nt])||void 0===i?void 0:i[K][bt],a=s&&s[e.id],u=t=>{const i=_.NW[Ft](r,e);if(!i[Mt]())return;const n=i.getFormat().app_config_uri;return n&&t?g.qB[n][t].formattedMessage:void 0};return t.map((t=>{const e=_.G[Ft](r,t);if(e.isTemplate())return;const i=a?(0,g.P8)(e.id,a):void 0;return{key:e.id,[lt]:t=>d[dt](N.Z,o()({store:e,titlePrefix:u(i)},t)),action:()=>{const{[ot]:e,[pt]:o}=this[Dt];let r={[ct]:U,value:t};var s,a;(i&&(r={[ct]:U,value:{[ct]:"relative",value:{[ct]:"builtin",variable:i}}}),o&&l().isEqual(r,o.value))?null===(s=(a=this[Dt])[ht])||void 0===s||s.call(a):n.some((t=>(0,p.we)(r,t.value)))?w[Y](this[j]()):e({newGroupValue:r})}}}))}renderRelationValue(){const{intl:t,[Bt]:e,schema:i,[Ot]:n}=this[Dt],{[St]:o}=this[Ct][Et][bt],r=i[n[Rt]];if(!r||"relation"!==r[ct])return;const a=h[W](r);if(!a)return;return _.NW[Ft](e,a)[Mt]()?s()(V.Z,{request:o,[z]:this.performRelationSearchRequest,debounce:C[X],[lt]:(e,i,n)=>{i||(i=[]);const r=l().compact([...this.getMenuListItemsForRelatedRecords(i,a),this.getCreateNewPageMenuListItem()]);let u;return u=n&&i&&0===r.length?s()(E.Z,{},void 0,s()(O.Z,{title:s()(b.FormattedMessage,{[ut]:"No results",id:"database.noRelationSearchResults.message"})})):s()(B.Z,{[ct]:B.i[$],[Q]:0,sections:[{key:0,[lt]:t=>d[dt](E.Z,t),items:r}],store:this[Ct][Vt]}),d[dt](d[H],null,s()(E.Z,{},void 0,s()(R.ZP,{value:o,focus:!0,[rt]:t[at]({[ut]:"Type to search...",id:"database.searchRelation.placeholder"}),[ot]:t=>{this[Ct][Et][wt]({...this[Ct][Et][bt],[St]:t[yt].value}),this[Ct][Vt][wt]({...this[Ct][Vt][bt],focus:{[ft]:0,[gt]:0,[vt]:0}})}})),u)}}):void 0}[j](){return s()(b.FormattedMessage,{[ut]:"Group already exists.",id:"database.groupExistsAlreadyError.message"})}[mt](){const{[ot]:t,[tt]:e,[Ot]:i,[pt]:n}=this[Dt],{[Et]:o}=this[Ct],r=o[bt][St].trim().replace(/,/g,"");let s;var a,d,u,c,h,m;("select"===i[ct]||"multi_select"===i[ct]?s={[ct]:i[ct],value:r}:(0,p.aB)(i)&&(s={[ct]:i[ct],value:{[ct]:"exact",value:r}}),s)?r?n&&l().isEqual(s,n.value)?null===(a=(d=this[Dt])[ht])||void 0===a||a.call(d):e.some((t=>s&&(0,p.we)(s,t.value)))?w[Y](this[j]()):t({newGroupValue:s}):null===(u=(c=this[Dt])[ht])||void 0===u||u.call(c):null===(h=(m=this[Dt])[ht])||void 0===h||h.call(m)}isTextInputType(){const{[Ot]:t}=this[Dt];return"select"===t[ct]||"multi_select"===t[ct]||(0,p.HB)(t[ct])}}Gt.displayName="CollectionEditGroupMenu",Gt.contextTypes={...u.w,...P.xm};const Lt=(0,b.injectIntl)(Gt)},87052:(t,e,i)=>{i.d(e,{Z:()=>Ht});var n=i(97464),o=i.n(n),r=i(77094),s=i.n(r),a=i(67294),l=i(83355),d=i(66897),u=i(15145),c=i(14714),p=i(99036),h=i(80951),m=i(84619),v=i(7057),g=i(53877),f=i(42875),y=i(3909),S=i(32056),b=i(23014),w=i(97880),C=i(82990),P=i(5366),I=i(29637),x=i(26991),k=i(23482),Z=i(10161),_=i(29376);const T=i(85).zkt;var M=i(78316),F=i(84210),A=i(33929),R=i(79315),D=i(61766),B=i(39098),O=i(68500),N=i(97180),V=i(64921),E=i(31945),G=i(12508),L=i(84076),K=i(31278),U=i(76798),q=i(58032),W=i(92864),z=i(69265),H=i(22084);const Q=i(85).nAm,$=i(85).XCs,j=i(85).YDv,Y=i(85).Uie,J=i(85).sI1,X=i(85).XNW,tt=i(85).g7N,et=i(85).LIR,it=i(85).tDk,nt=i(85).Yzm,ot=i(85).UDE,rt=i(85).PXg,st=i(85).TLr,at=i(85).nSw,lt=i(85).OM8,dt=i(85).ChN,ut=i(85).D7I,ct=i(85).$wW,pt=i(85).urI,ht=i(85).UA5,mt=i(85).eRF,vt=i(85).pHx,gt=i(85).wgE,ft=i(85).E0z,yt=i(85).dLQ,St=i(85).pkR,bt=i(85).aW,wt=i(85).Gpy,Ct=i(85).nx5,Pt=i(85).BQ6,It=i(85).G3i,xt=i(85).oWD,kt=i(85).MWD,Zt=i(85).ffk,_t=i(85).WDI,Tt=i(85).i2K,Mt=i(85).BpM,Ft=i(85).KNN,At=i(85).P24,Rt=i(85).EIp,Dt=i(85).fBu,Bt=i(85).iIv,Ot=i(85).Dd5,Nt=i(85).Gnd,Vt=i(85).SoS,Et=i(85).QmD,Gt=i(85).P0R,Lt=i(85).xd5,Kt=i(85).Leq,Ut=i(85).I2,qt=i(85).Kiu,Wt=i(85).LtW;class zt extends l.Z{constructor(){super(...arguments),this.storeTypes={[Wt]:D.Z},this.renderEditPopup=()=>{const{[qt]:t,[Ut]:e,[Kt]:i,[Lt]:n}=this[Gt],o=this[Vt][Et];if(o)return s()(O.Z,{[Lt]:n,[Kt]:i,[Ut]:e,[qt]:t,[Ot]:t=>{var e,i;this[Nt][Wt].reset(),null===(e=(i=this[Gt])[Ot])||void 0===e||e.call(i,t)},[Bt]:()=>{var t,e;this[Nt][Wt].reset(),null===(t=(e=this[Gt])[Bt])||void 0===t||t.call(e)},[Dt]:o})},this[Vt]=this[Rt]((()=>{const{[At]:t,[Lt]:e}=this[Gt],i=t[Mt][Ft](e);return null==i?void 0:i[Tt]})),this[_t]=this[Rt]((()=>{const{[qt]:t,[Lt]:e}=this[Gt],i=this[Vt][Et],n=t[e[Zt]];if(n&&(0,p.isRelationPropertySchema)(n)&&i)return(0,_.getRelatedCollectionAppConfigUri)(n,i)}))}renderGroupType(t,e){return"select"===t[kt]||"multi_select"===t[kt]?this.renderSelectValue():"status"===t[kt]?this.renderStatusValue():(0,c.pd)(t[kt])?this.renderPersonValue(t):"relation"===t[kt]?this.renderRelationValue(t):"location"===t[kt]?this.renderLocationValue(t):(0,c.A1)(t[kt])?this.renderDateValue(t):(0,c.HB)(t[kt])?this.renderTextValue(t):"number"===t[kt]?this.renderNumberValue(t,"number"===e[kt]?e:void 0):"checkbox"===t[kt]?this.renderCheckboxValue(t):void(0,w.unreachable)(t[kt])}renderComponent(){const{[Lt]:t,[qt]:e}=this[Gt],i=t.value,n=void 0===i.value,o=e[t[Zt]];if(o){if(n)return this.renderEmptyGroupLabel();if("formula"===i[kt]){if("formula"!==i[kt])return;const t=i.value;if(!t)return;return this.renderGroupType(t,o)}return this.renderGroupType(i,o)}}renderEmptyGroupLabel(){const{[Lt]:t,[qt]:e,isHiddenGroup:i,[At]:n}=this[Gt],o=e[t[Zt]],r=n[xt](),a=this[Vt][Et];if(!o)return;const{name:l}=o;let d=!1;return null!=r&&r[It]()&&(0,p.isRelationPropertySchema)(o)&&a&&(d=function(t){const{collectionStore:e,property:i,propertySchema:n,parentStore:o}=t;let r=!1;if(null!=e&&e.isDefined()){const t=e.getPropertyMapping();r=(null==t?void 0:t[k.Es[T]])===i}const s=(0,_.getRelatedCollectionAppConfigUri)(n,o)===k.p$;return Z.default.checkGate("proj_management_sprints")&&(s||r)}({[xt]:r,[Zt]:t[Zt],propertySchema:o,[Dt]:a})),s()(Qt,d?{[Pt]:this[Gt][Pt],uncategorizedIconStyle:this[Gt].uncategorizedIconStyle,isHiddenGroup:i,formattedLabelMessage:s()(P.FormattedMessage,{[Ct]:"Backlog (No {name})",[wt]:{name:l},id:"database.sprintDatabaseView.uncategorizedGroupLabel"})}:{[Pt]:this[Gt][Pt],uncategorizedIconStyle:this[Gt].uncategorizedIconStyle,isHiddenGroup:i,formattedLabelMessage:s()(P.FormattedMessage,{[Ct]:"No {name}",[wt]:{name:l},id:"database.boardView.uncategorizedColumnTitle"})})}renderSelectValue(){var t;const{[Lt]:e,[qt]:i}=this[Gt],n=i[e[Zt]];if(!n||!p[bt](n))return;const r=e.value;if(null===(t=n.options)||void 0===t||!t.length||void 0===r.value||r[kt]!==n[kt])return;const l=(0,h.matchSelectOption)(n.options,r.value);return l?s()(E.ZP,{render:this.renderEditPopup,[St]:this[Gt][St],[Wt]:this[Nt][Wt],popupType:this[gt][ft][yt]?E.Z4[vt]:E.Z4.Popup,originGap:4,renderOrigin:t=>a[ut](V.Z,o()({[Pt]:{...zt[mt],...this[Gt][Pt]},[St]:this[Gt][St]},t),s()(H.a,{[pt]:m.l.Medium,[ct]:!0,value:l.value,[ht]:l[ht],showRemoveButton:!1}))}):void 0}renderStatusValue(){const{[Lt]:t,[qt]:e}=this[Gt],i=e[t[Zt]];if(!i||"status"!==i[kt])return;const n=t.value;if(n[kt]!==i[kt])return;const{value:o}=n;if(!o)return;const r=i.options??[],a=i.groups??[];if("by_group"===o[kt]){const t=a.find((t=>t.name===o.group));return t&&s()(N.r_,{group:t,[Pt]:{[dt]:500},showIcon:!0,showColor:!0})}if("by_option"===o[kt]){const t=(0,h.matchSelectOption)(r,o.option),e=t&&a.find((e=>{var i;return null===(i=e.optionIds)||void 0===i?void 0:i.includes(t.id)}));return t&&s()("span",{[Pt]:{[dt]:500,[lt]:"normal"}},void 0,s()(H.F,{[pt]:m.l.Medium,[ct]:!0,value:t.value,[ht]:t[ht],showRemoveButton:!1,groupColor:null==e?void 0:e[ht]}))}(0,w.unreachable)(o)}renderPersonValue(t){if(!(0,c.q6)(t))return;const{value:e}=t;if(!e)return;const i=this[Vt][Et];if(!i)return;const n=(0,d.Hl)({pointer:e,[at]:i[at]});return n.asActor?s()(E.ZP,{render:this.renderEditPopup,[St]:this[Gt][St],[Wt]:this[Nt][Wt],popupType:this[gt][ft][yt]?E.Z4[vt]:E.Z4.Popup,originGap:4,renderOrigin:t=>a[ut](V.Z,o()({[Pt]:{...zt[mt],...this[Gt][Pt]},[St]:this[Gt][St]},t),s()(W.ZP,{[pt]:W.ZP.Format.Medium,actor:n,showRemoveButton:!1,[ct]:!0,disableAvatarTooltip:this[Gt].isHiddenGroup,shouldShrink:!0}))}):void 0}renderLocationValue(t){const e=this[Vt][Et];if("location"!==t[kt])return;if(!t.value)return;if(!e)return;const i=B.NW[st](e,t.value);return a[ut](a.Fragment,null,s()(K.Z,{[St]:!0,icon:i.getIcon(),size:20,isEmptyPage:!1,[Pt]:{marginTop:2,[rt]:6}}),s()(U.Z,{store:i,underline:!0,[Pt]:{[dt]:C.Z[dt].medium}}))}renderRelationValue(t){const{[qt]:e,[Lt]:i,[At]:n}=this[Gt],o=this[Vt][Et];if(!o)return;if("relation"!==t[kt])return;const r=e[i[Zt]];if(!r||"relation"!==r[kt])return;const l=p[ot](r);if(!l)return;const d=B.NW[st](o,l);if(d[It]()&&t.value){if((0,c.t2)(t.value)){var h;const e=this[_t][Et];if(!e)return;const i=A.default[nt](I.sY.tasksCurrentSprintV2ViewNamePrefix),r=A.default[nt](I.sY.tasksNextSprintV2ViewNamePrefix),c=t.value.value.variable,p=null===(h=b.qB[e])||void 0===h?void 0:h[c];if(null!=d&&d[It]()){const t=(0,x.As)(n,c,l,d);if(!t)return s()("div",{[Pt]:{[dt]:C.Z[dt].medium}},void 0,null==p?void 0:p.formattedMessage);const{[it]:e}=R.default[Et],h=M.getPeekModeHref({store:t,[it]:e,[At]:n})??(0,F.ZP)({store:t,[et]:u.tY.LinkInPage});if(t)return a[ut](a.Fragment,null,s()("div",{[Pt]:{[dt]:C.Z[dt].medium,[tt]:.25}},void 0,"current"===c?i:r,":"),s()(L.Z,{[Pt]:{...this[Gt][Pt],[X]:1},[J]:{...zt[mt]},href:h},void 0,s()(z.Z,{[pt]:W.ZP.Format.Medium,blockId:t.id,[ct]:!0,shouldShrink:!0,[Dt]:o})))}return s()("div",{[Pt]:{[dt]:C.Z[dt].medium,[tt]:.25}},void 0,null==p?void 0:p.formattedMessage)}if((0,c.RA)(t.value)){const e=B.G[st](o,t.value),{[it]:i}=R.default[Et],r=M.getPeekModeHref({store:e,[it]:i,[At]:n})??(0,F.ZP)({store:e,[et]:u.tY.LinkInPage});return s()(L.Z,{[Pt]:this[Gt][Pt],[J]:{...zt[mt]},href:r},void 0,s()(z.Z,{[pt]:W.ZP.Format.Medium,blockId:t.value.id,[ct]:!0,shouldShrink:!0,[Dt]:o}))}}}renderDateValue(t){if((0,c.Mc)(t)&&t.value)return s()("div",{[Pt]:{...zt[mt],...C.Z[Y],...this[Gt][Pt]}},void 0,this.renderDateGroupValue(t.value))}renderDateGroupValue(t){if("today"===t[kt])return s()(P.FormattedMessage,{[Ct]:"Today",id:"database.collectionGroupValue.dateGroup.today"});if("yesterday"===t[kt])return s()(P.FormattedMessage,{[Ct]:"Yesterday",id:"database.collectionGroupValue.dateGroup.yesterday"});if("last_7_days"===t[kt])return s()(P.FormattedMessage,{[Ct]:"Last 7 days",id:"database.collectionGroupValue.dateGroup.last7Days"});if("last_30_days"===t[kt])return s()(P.FormattedMessage,{[Ct]:"Last 30 days",id:"database.collectionGroupValue.dateGroup.last_30Days"});if("tomorrow"===t[kt])return s()(P.FormattedMessage,{[Ct]:"Tomorrow",id:"database.collectionGroupValue.dateGroup.tomorrow"});if("next_7_days"===t[kt])return s()(P.FormattedMessage,{[Ct]:"Next 7 days",id:"database.collectionGroupValue.dateGroup.next7Days"});if("next_30_days"===t[kt])return s()(P.FormattedMessage,{[Ct]:"Next 30 days",id:"database.collectionGroupValue.dateGroup.next30Days"});if("day"===t[kt]){const e=(0,g.getLuxonRange)(t.range,(0,f.r)(),this[Gt].intl.locale);return(0,v.ZW)(e.start,"medium")}if("week"===t[kt]){const e=(0,g.getLuxonRange)(t.range,(0,f.r)(),this[Gt].intl.locale),i=(0,v.ZW)(e.start,"month_short"),n=(0,v.ZW)(e.start,"day"),o=e.start.year,r=(0,v.ZW)(e.end,"month_short"),a=(0,v.ZW)(e.end,"day"),l=e.end.year;return s()(P.FormattedMessage,o!==l?{[Ct]:"Week of {startMonth} {startDay} {startYear} - {endMonth} {endDay} {endYear}",id:"database.collectionGroupValue.dateGroup.week.differingStartAndEndYear",[wt]:{startMonth:i,startDay:n,endMonth:r,endDay:a,startYear:o,endYear:l}}:i!==r?{[Ct]:"Week of {startMonth} {startDay} - {endMonth} {endDay} {startYear}",id:"database.collectionGroupValue.dateGroup.week.differingStartAndEndMonth",[wt]:{startMonth:i,startDay:n,endMonth:r,endDay:a,startYear:o}}:{[Ct]:"Week of {startMonth} {startDay}-{endDay} {startYear}",id:"database.collectionGroupValue.dateGroup.week.sameStartAndEndMonth",[wt]:{startMonth:i,startDay:n,endDay:a,startYear:o}})}if("month"===t[kt]){const e=(0,g.getLuxonRange)(t.range,(0,f.r)(),this[Gt].intl.locale);return(0,v.ZW)(e.start,"month_year_short")}if("year"===t[kt]){return(0,g.getLuxonRange)(t.range,(0,f.r)(),this[Gt].intl.locale).start.year.toString()}(0,w.unreachable)(t)}renderTextValue(t){if((0,c.R7)(t)&&void 0!==t.value){const e=this.renderTextGroupValue(t.value);return"exact"===t.value[kt]?s()(E.ZP,{render:this.renderEditPopup,[St]:this[Gt][St],[Wt]:this[Nt][Wt],popupType:this[gt][ft][yt]?E.Z4[vt]:E.Z4.Popup,originGap:4,renderOrigin:t=>a[ut](V.Z,o()({[Pt]:{...zt.selectStyle,...C.Z[Y],...this[Gt][Pt]},[St]:this[Gt][St]},t),e)}):s()("div",{[Pt]:zt.selectStyle},void 0,e)}}renderTextGroupValue(t){return"other"===t[kt]?s()(P.FormattedMessage,{[Ct]:"Other",id:"database.collectionGroupValue.textGroup.other"}):"alphabet_prefix"===t[kt]||"exact"===t[kt]?t.value:void(0,w.unreachable)(t)}renderNumberValue(t,e){if("number"!==t[kt]||!t.value)return;const i=(null==e?void 0:e.number_format)||S.dk;return s()("div",{[Pt]:{...zt[mt],...this[Gt][Pt]}},void 0,this.renderNumberGroupValue(t.value,i))}renderNumberGroupValue(t,e){if("out_of_range"===t[kt])return s()(P.FormattedMessage,{[Ct]:"Out of range",id:"database.collectionGroupValue.numberGroup.outOfRange"});if("range"===t[kt]){const i=S.uf(t.start,e,this[Gt].intl),n=S.uf(t.end,e,this[Gt].intl);return s()(P.FormattedMessage,{[Ct]:"{start} to {end}",id:"database.collectionGroupValue.numberGroup.range",[wt]:{start:i,end:n}})}(0,w.unreachable)(t)}renderCheckboxValue(t){if("checkbox"===t[kt])return s()("div",{[Pt]:{...zt.checkboxStyle,...this[Gt][Pt]}},void 0,s()(G.Z,{checked:t.value,size:14,[St]:!0}))}}zt.displayName="CollectionGroupValue",zt.selectStyle={overflow:Q,padding:3,borderRadius:3,[dt]:C.Z[dt].medium},zt[mt]={overflow:Q,padding:3,[$]:6,borderRadius:3,[dt]:C.Z[dt].medium},zt.checkboxStyle={padding:3,[$]:6};const Ht=(0,P.injectIntl)(zt);function Qt(t){const{isHiddenGroup:e}=t;return e?a[ut]($t,o()({},t,{tooltipEvents:void 0})):s()(q.Z,{renderTooltip:()=>s()(P.FormattedMessage,{[Ct]:"Any items with an empty <b>{name}</b> property will go here. This group cannot be removed.",[wt]:{name,b:t=>s()("span",{[Pt]:{[dt]:C.Z[dt].semibold}},void 0,t)},id:"database.boardView.uncategorizedColumnTooltip"}),[Pt]:{width:240},textWrap:!0,render:e=>a[ut]($t,o()({},t,{tooltipEvents:e}))})}function $t(t){const e={display:"flex",alignItems:"center",fontSize:14,[lt]:1.2,[j]:2,[$]:4,whiteSpace:"nowrap",overflow:Q,[dt]:C.Z[dt].medium},{[Pt]:i,uncategorizedIconStyle:n,tooltipEvents:r,formattedLabelMessage:l}=t;return a[ut]("div",o()({[Pt]:{...e,[j]:0,...i}},r),y.Z.collectionInbox({width:14,[X]:6,[rt]:6,...n}),s()("span",{[Pt]:{...C.Z[Y]}},void 0,l))}},75498:(t,e,i)=>{i.d(e,{Z:()=>_});var n=i(96486),o=i.n(n),r=i(83355),s=i(1302),a=i(49085),l=i(71644),d=i(97880),u=i(64434);const c=i(85).ykC,p=i(85).PR5,h=i(85).Mcf,m=i(85).sP9,v=i(85).Y6E,g=i(85).DbH,f=i(85).P24,y=i(85).QmD,S=i(85).HFP,b=i(85).ILR,w=i(85).ZG6,C=i(85).SIu,P=i(85).wfR,I=i(85).p6m,x=i(85).uei,k=i(85).BVT;class Z extends r.Z{constructor(){super(...arguments),this[k]=this.props.id,this.instanceId=(0,l.ZP)(),this[x]=!1,this.storeTypes={[I]:a.default[P](void 0)},this[C]=()=>{this[x]||(this[x]=!0,s.default[w](this.dequeueLocalResultStoreChange))},this.dequeueLocalResultStoreChange=()=>{const{[I]:t}=this.stores;if(this[x]=!1,!this[b])return;const e=this[S]();o().isEqual(e,t[y])||t.setState(e)}}willMount(t){const{[f]:e}=t;e[g].addListener(this[C]),e[v].addListener(this[C]),this.updateReducer(t),this[C]()}willUpdate(t){this.updateReducer(t)}willUnmount(){super.willUnmount();const{[f]:t,[m]:e}=this.props;u.updateCollectionReducer({[k]:this[k],instanceId:this.instanceId,[h]:void 0,[f]:t,[m]:e}),t[g][p](this[C]),t[v][p](this[C])}renderComponent(){const{render:t}=this.props;if(t)return t(this.stores[I])}updateReducer(t){const{[h]:e,[f]:i,[m]:n}=t;u.updateCollectionReducer({[k]:this[k],instanceId:this.instanceId,[h]:e,[f]:i,[m]:n})}[S](){const{[f]:t}=this.props,e=t[v][y],i=t[g][y],n=e&&"reducer"===e.type?e[c][this[k]]:void 0,o=i&&"reducer"===i.type?i[c][this[k]]:void 0;return this.getResultFromLocalAndRemote(n,o)}getResultFromLocalAndRemote(t,e){const{[f]:i,[h]:n}=this.props,r=i.reducers[y],s=i[g][y],a=i.isClientModeEnabled[y];if("aggregation"===n.type||"groups"===n.type){if(a)return t;if(null!=s&&s[c][this[k]])return s[c][this[k]];return Boolean(s&&"reducer"===s.type&&o().find(s[c],((t,e)=>{const i=r[e];return Boolean(i&&"results"===i[h].type&&!i[h].searchQuery&&"results"===t.type&&t.hasMore&&o().isEqual(n.filter,i[h].filter))})))?t:e}if("results"===n.type){const n=i.wasCreatedThisSession[y];if((Boolean(s&&"reducer"===s.type&&s[c][this[k]])||n||a)&&t&&"results"===t.type){return{...t,hasMore:e&&"results"===e.type?e.hasMore:t.hasMore}}return e}throw(0,d.unreachable)(n)}}Z.displayName="CollectionReducerRequest";const _=Z},49670:(t,e,i)=>{i.d(e,{V:()=>at,Z:()=>lt});var n=i(97464),o=i.n(n),r=i(77094),s=i.n(r),a=i(67294),l=i(83355),d=i(49085),u=i(34296),c=i(3909),p=i(4615),h=i(82990),m=i(5366),v=i(77162),g=i(5149),f=i(64434),y=i(94419),S=i(12359),b=i(93959),w=i(89014),C=i(83319),P=i(13005),I=i(42917),x=i(71846),k=i(72495);const Z=i(85).hd7,_=i(85).u$q,T=i(85).pek,M=i(85).rI1,F=i(85).sM5,A=i(85).fsm,R=i(85).ChN,D=i(85).Uie,B=i(85).kgm,O=i(85).nx5,N=i(85).UUC,V=i(85).NKH,E=i(85).G3i,G=i(85).vCp,L=i(85).LCr,K=i(85).oWD,U=i(85).Drs,q=i(85).JJj,W=i(85).U7y,z=i(85).iTb,H=i(85).O_,Q=i(85).FAY,$=i(85).uzK,j=i(85).qU4,Y=i(85).rMr,J=i(85).wgE,X=i(85).jQT,tt=i(85).P0R,et=i(85).HxR,it=i(85).P24,nt=i(85).jKg,ot=i(85).wfR,rt=i(85).K0Z;class st extends l.Z{constructor(){super(...arguments),this.storeTypes={[rt]:d.default[ot]("")},this[nt]="",this.handleNewCollectionClick=()=>{const{[it]:t,[et]:e}=this[tt];v[X]({[J]:this[J],[it]:t,action:"select_new_collection"});const i=this.stores[rt].state;g[Y]({[et]:e});const n=t[j](),o=t[$]();n&&o&&g.handleCreateCollection({[J]:this[J],selectedDBType:Q,[H]:i,[it]:t,[$]:o,[j]:n,[z]:!1,baseViewType:"table"})},this[W]=t=>{const{[it]:e,[et]:i}=this[tt];S[q]({[U]:"CollectionSettingsCreateViewSource.handleSourcePickerAccept",[J]:this[J],perform:i=>{f.updateCollectionViewSource({[J]:this[J],[it]:e,[K]:t,[L]:i});const n=e[j](),o=e[$](),r=t[G]();n&&r&&null!=o&&o[E]()&&(0,b.h7)(o)&&y[V]({parent:r[N](),insert:n,[L]:i})}}),at({[K]:t,[it]:e,[et]:i})}}renderComponent(){const{[it]:t,[et]:e}=this[tt],{[rt]:i}=this.stores,n=t[$](),r=t[K]();if(!n)return;const l=t.getCollectionViewBlockSourceState(),d=i.state;return a.createElement(P.ZP,o()({},this[tt],{title:s()(m.FormattedMessage,{[O]:"Select data source",id:"database.viewSettings.createViewSourceTab.title"}),handleClose:()=>{v[B]({[J]:this[J],eventName:"abandoned_search",queryLength:d.length,sessionId:this[nt],source:u.S.Source}),g[Y]({[et]:e})},footer:"uninitialized"===l&&s()(k.Z,{topBorder:!0},void 0,s()(I.Z,{icon:c.Z.plus,isGray:!0,title:s()(m.FormattedMessage,d?{[O]:"New database “{filterText}”",id:"database.viewSettings.createViewSourceTab.newCollectionWithNameButton.title",values:{filterText:s()("span",{style:{...h.Z[D],[R]:h.Z[R].medium,[A]:160,[F]:"inline-block",[M]:"bottom"}},void 0,d)}}:{[O]:"New database",id:"database.viewSettings.createViewSourceTab.newCollectionButton.title"}),onClick:this.handleNewCollectionClick}))}),s()(x.Z,{[it]:t,selectedCollectionStore:r,parentStore:n,onAccept:this[W],context:u.S.Source,[rt]:i,[nt]:this[nt]}))}willMount(){this[nt]=(0,p.default)()}}async function at(t){const{[K]:e,[it]:i,[et]:n}=t,o=i[$](),r=i[j](),s=e[G]();if(!o||!s||!r)return;await Promise.all([...s[T]().map((t=>t.load())),...o[T]().map((t=>t.load()))]);(0,C.g)({[K]:e,sourceCollectionViewBlockStore:s,currentCollectionViewBlockStore:o,[_]:r,constraints:(0,w.x)(r.id)}).length>0?g[Z]({[et]:n,item:{type:"duplicateExistingView"}}):g[Z]({[et]:n,item:{type:"createView"}})}st.displayName="CollectionSettingsCreateViewSource";const lt=(0,m.injectIntl)(st)},83319:(t,e,i)=>{i.d(e,{g:()=>It,Z:()=>xt});var n=i(97464),o=i.n(n),r=i(77094),s=i.n(r),a=i(96486),l=i(67294),d=i(83355),u=i(26263),c=i(49085),p=i(3909),h=i(5366),m=i(77162),v=i(5149),g=i(64434),f=i(9953),y=i(12359),S=i(78316),b=i(33929),w=i(89014),C=i(29798),P=i(39098),I=i(73657),x=i(13005),k=i(42917),Z=i(1136),_=i(45669),T=i(52275),M=i(68894),F=i(32163),A=i(72495);const R=i(85).pek,D=i(85).u$q,B=i(85).uzK,O=i(85).kdC,N=i(85).cZW,V=i(85).Yzm,E=i(85).iB2,G=i(85).Wp_,L=i(85).wuN,K=i(85).D7I,U=i(85).kwI,q=i(85).PXg,W=i(85).YDe,z=i(85).lzz,H=i(85).QSf,Q=i(85).qU4,$=i(85).oWD,j=i(85).hd7,Y=i(85).rMr,J=i(85).Xl2,X=i(85).jQT,tt=i(85).Rdx,et=i(85).J$i,it=i(85).BYF,nt=i(85).P0R,ot=i(85).P24,rt=i(85).HxR,st=i(85).HFP,at=i(85).dLQ,lt=i(85).VFs,dt=i(85).wgE,ut=i(85).Gnd,ct=i(85).azD,pt=i(85)._FC,ht=i(85).P0G,mt=i(85).wfR,vt=i(85).K0Z,gt=i(85).UiT,ft=i(85).Jz8,yt=i(85).DCL,St=i(85).isE,bt=i(85).nx5,wt=i(85).zwB,Ct=(0,h.defineMessages)({[wt]:{[bt]:"Search for a view…",id:"database.viewSettings.duplicateExistingViewTab.inputPlaceholder"}});class Pt extends d.Z{constructor(){super(...arguments),this[St]=new u.Z({name:yt}),this[ft]=void 0,this[gt]=void 0,this.didAccept=!1,this.preselectedViewPointer=void 0,this.storeTypes={[vt]:c.default[mt](""),[ht]:C.Z,limitStore:c.default[mt](!0)},this.handlePreviewCollectionView=t=>{this[pt](t,!0)},this.handlePreviewCollectionViewDebounced=a.debounce(this.handlePreviewCollectionView,500),this[ct]=()=>{const t=this[ut][ht].state,{device:e}=this[dt];if(void 0===t.focus[lt]||e[at])return;const i=this[st]().viewStores[t.focus[lt]];i&&this.handlePreviewCollectionViewDebounced(i)},this.handleDuplicateViewAccept=t=>{const{[rt]:e,[ot]:i}=this[nt];this[dt][tt][et][it](this[St]),m[X]({[dt]:this[dt],[ot]:i,action:"click_duplicate_view"}),this[pt](t,!1),v[J]({[rt]:e,item:{type:"main",selectViewNameInitial:!0}}),this.didAccept=!0},this.handleNewEmptyViewClick=()=>{const{[rt]:t,[ot]:e}=this[nt];m[X]({[dt]:this[dt],[ot]:e,action:"click_new_empty_view"}),v[Y]({[rt]:t}),v[j]({[rt]:t,item:{type:"createView"}}),this.didAccept=!0}}willMount(t){const{[ot]:e}=t,{device:i}=this[dt],n=e[$](),o=e[Q]();if(!o)return;const r=(0,w.x)(o.id);this.preselectedViewPointer=null==r?void 0:r.viewPointer,this[gt]=null==n?void 0:n.pointer,this[dt][tt][et].addCacheOverride(this[St]),this[ut][ht].addListener(this[ct]);const{viewStores:s}=this[st](),[a]=s;!i[at]&&a&&this[pt](a,!0)}willUnmount(){if(this[dt][tt][et][it](this[St]),this[ut][ht].removeListener(this[ct]),!this.didAccept){const{viewStores:t}=this[st](),e=this[ft]?t.find((t=>t.id===this[ft])):t[0];if(!e)return;this[pt](e,!1)}}renderComponent(){const{[vt]:t,[ht]:e,limitStore:i}=this[ut],{device:n}=this[dt],r=t.state,{viewStores:d,showMore:u}=this[st](),c=a.compact(d.map((t=>{const e=t[H](),i=t.getFormat()[z];if(!e||"page"===e)return;const n=t.getName(),r=t.id;return{key:r,render:t=>{var a;return l[K](T.Z,o()({},t,{title:s()(_.Z,{[W]:e,collectionViewName:n}),icon:s()(Z.F,{color:"regular",viewIcon:i,[U]:e,style:{[q]:6}}),checkState:(null===(a=this.preselectedViewPointer)||void 0===a?void 0:a.id)===r}))},action:()=>{this.handleDuplicateViewAccept(t)}}})));if(u>0){const t={key:"showMore",render:t=>l[K](T.Z,o()({},t,{icon:p.Z.dots({width:16,height:16,color:this.theme[L]}),style:{color:this.theme[L]},title:s()(h.FormattedMessage,{[bt]:"Show {showMore} more",id:"database.viewSettings.duplicateExistingViewTab.showMore.title",values:{showMore:u}})})),action:()=>{i[G](!1)}};c.push(t)}return l[K](x.ZP,o()({},this[nt],{title:s()(h.FormattedMessage,{[bt]:"Copy an existing view",id:"database.viewSettings.duplicateExistingViewTab.title"}),footer:s()(A.Z,{topBorder:!0},void 0,s()(k.Z,{icon:p.Z.plus,isGray:!0,title:s()(h.FormattedMessage,{[bt]:"New empty view",id:"database.viewSettings.duplicateExistingViewTab.newEmptyViewButton.title"}),onClick:this.handleNewEmptyViewClick}))}),(u>0||r)&&s()(A.Z,{},void 0,s()(M.ZP,{focusInitial:!n[at]||void 0,value:r,onChange:n=>{t[G](n.target.value),e[G]({focus:{section:0,[E]:0,[lt]:0}}),i[G](!0)},[N]:b.default[V](Ct[wt]),[O]:!0})),c.length>0&&s()(F.Z,{type:F.i.Vertical,initialFocus:0,sections:[{key:"results",render:t=>l[K](A.Z,t),items:c}],store:e}),0===c.length&&s()(I.Z,{caption:s()(h.FormattedMessage,{[bt]:"No results",id:"database.viewSettings.duplicateExistingViewTab.noResultsTitle"})}))}[st](){const{[ot]:t}=this[nt],e=t[B](),i=t[$](),n=t[Q]();if(!e||!i||!n)return{viewStores:[],showMore:0};const{[vt]:o,limitStore:r}=this[ut],s=o.state,a=i.getParentBlockStore();if(!e||!a)return{viewStores:[],showMore:0};let l=It({[$]:i,sourceCollectionViewBlockStore:a,currentCollectionViewBlockStore:e,[D]:n,constraints:(0,w.x)(n.id)}),d=0;return s?l=l.filter((t=>(0,S.filterCollectionView)(t,s))):r.state&&(d=l.length-7,l=l.slice(0,7)),{viewStores:l,showMore:d}}[pt](t,e){if(t.id===this[ft]&&e)return;this[ft]=t.id;const{[ot]:i}=this[nt],n=i[Q](),o=t[H]();if(!n||!o)return;const r=t.getName(),s=t.getPageSort(),a=t.getFormat(),l=t.getKeyStore("query2").getValue();let d=n;e&&(d=n.clone(this[St])),y.createAndCommit({userAction:"CollectionSettingsDuplicateExistingView.duplicateViewSettings",[dt]:this[dt],perform:t=>{f.updateValue({store:d,data:{name:r,type:o,page_sort:s,format:{...a,collection_pointer:this[gt]},query2:l},transaction:t})}}),g.resetLeftScrollAfterFlush({[ot]:i})}}function It(t){const{[$]:e,sourceCollectionViewBlockStore:i,currentCollectionViewBlockStore:n,[D]:o,constraints:r}=t;let s=a.uniqBy([...n[R](),...i[R]()],(t=>t.id)).filter((t=>{var i;return(null===(i=t.getCollectionStore())||void 0===i?void 0:i.id)===e.id&&t.id!==o.id&&"page"!==t[H]()}));if(null!=r&&r[U]&&(s=[...s.filter((t=>t[H]()===r[U])),...s.filter((t=>t[H]()!==r[U]))]),null!=r&&r.viewPointer){const{id:t}=r.viewPointer,e=s.find((e=>e.pointer.id===t))||P.Xr.createChildStore(i,r.viewPointer);s=[e,...s.filter((e=>e.pointer.id!==t))]}return s}Pt.displayName=yt;const xt=(0,h.injectIntl)(Pt)},80072:(t,e,i)=>{i.d(e,{Z:()=>xt});var n=i(77094),o=i.n(n),r=i(96486),s=i.n(r),a=i(67294),l=i(480),d=i(81954),u=i(24405),c=i(3909),p=i(27006),h=i(5366),m=i(77162),v=i(12534),g=i(29376),f=i(25464),y=i(86825),S=i(58032);const b=i(85).Joh,w=i(85).D7I,C=i(85).nx5,P=i(85).UGA,I=i(85).P24;function x(t){window.__c={n:"CollectionSettingsAutoRelateSwitch"};const{temporaryAutoRelateState:e,handleAutoRelateToggle:i,[I]:n,[P]:r,autoRelate:s,hasInverseRelation:l}=t,p=(0,d.VK)((()=>n.collectionStore()),[n]),m=(0,d.VK)((()=>Boolean(null==p?void 0:p.isSyncedCollection())),[p]),v=(0,d.VK)((()=>(null==p?void 0:p.getFormat().bot_id)||r.getFormat().bot_id),[p,r]),g=(0,d.VK)((()=>!!v&&(m||!m&&l)),[v,m,l]),x=(0,u.yK)((t=>({errorLabel:{margin:"0px 14px",color:t.errorText},helpIcon:{width:16,fill:t.lightIconColor,marginLeft:6}})),[]),k=o()("div",{style:{display:"flex",alignItems:"center",whiteSpace:"pre"}},void 0,o()(h.FormattedMessage,{[C]:"Automatically Relate",id:"database.viewSettings.setupRelationTab.autoRelate.title"}),o()(S.Z,{render:t=>a[w]("div",t,c.Z.help(x.helpIcon)),style:{width:200},placement:f.u.Bottom,textWrap:!0,[b]:()=>o()(h.FormattedMessage,{[C]:"Relations will automatically populate based on links found in page properties.",id:"database.viewSettings.setupRelationTab.autoRelateTooltip"})}));return g?o()(y.Z,{title:k,on:e?e.enabled:!!s&&(null==s?void 0:s.enabled),focused:!1,onClick:()=>i(v),textWrapperStyle:{opacity:1}}):null}var k=i(82990),Z=i(31278),_=i(76798),T=i(72495),M=i(64369);const F=i(85).auS,A=i(85).Hco,R=i(85).wuN,D=i(85).Uie,B=i(85).sei,O=i(85).tBn,N=i(85).D7I,V=i(85).BQ6,E=i(85).nx5,G=i(85).jkI,L=i(85).UPJ,K=i(85).$bT,U=i(85).sRA,q=i(85).oWD,W=i(85).jI3,z=i(85)._tz,H=i(85).UGA,Q=i(85).P24;function $(t){window.__c={n:"CollectionSettingsRelationVisualizer"};const{[Q]:e,[H]:i,propertySchema:n,[z]:r,temporaryInverseState:s,[W]:l,inverseRelationName:c,isInitialPropertyName:p}=t,m=(0,h.useIntl)(),v=(0,d.VK)((()=>e[q]()),[e]),f=s?s[W]:l,y=(0,d.VK)((()=>Boolean(v&&i.id===v.id)),[v,i]),S=(0,d.VK)((()=>{const t=s?s.inverseName:c;return t||(null!=v&&v.isDefined()?g[U](m,{sourceCollection:v.getModel(),isSelfRelation:y,[H]:i,createUnique:!0}):"")}),[v,m,c,y,s,i]),b=(0,d.VK)((()=>null!=v&&v.isDefined()?S===g[U](m,{sourceCollection:v.getModel(),isSelfRelation:y,[H]:i,createUnique:!1}):void 0),[v,m,S,y,i]),w=Boolean(!y&&p&&(!f||f&&b)),C=(0,u.yK)((t=>({preview:{background:t.inputBackground,marginLeft:14,marginRight:14,padding:w?"42px 12px":12,boxShadow:t.inputBoxShadow,borderRadius:3,display:"flex",[K]:"column",[L]:G},condensedView:{height:22,display:"flex",[L]:G,alignItems:G},condensedProperties:{width:33,height:f?20:10,margin:"0px 12px",display:"flex",[K]:"column",[L]:G},databasesRow:{height:22}})),[w,f]);return v?o()(T.Z,{title:o()(M.Z,{isSmall:!0,isSecondaryColor:!0},void 0,o()(h.FormattedMessage,{[E]:"Preview",id:"database.viewSettings.setupRelationTab.relationVisualizer.title"})),disableMobileBorders:!0},void 0,o()("div",{[V]:C.preview},void 0,w?o()("div",{[V]:C.condensedView},void 0,o()(Y,{[q]:v,condensedView:!0}),o()("div",{[V]:C.condensedProperties},void 0,o()(j,{[z]:r||(null==n?void 0:n.name),condensedView:!0}),f&&o()(j,{[z]:S,condensedView:!0,isInverse:!0})),o()(Y,{[q]:i,condensedView:!0,isTarget:!0})):a[N](a[O],null,o()(j,{[z]:r||(null==n?void 0:n.name),bidirectional:y&&!f}),o()("div",{[V]:C.databasesRow},void 0,o()(Y,{[q]:v}),o()(Y,{[q]:i,isTarget:!0})),f&&o()(j,{[z]:S,isInverse:!0})))):null}function j(t){window.__c={n:"RelationVisualizerProperty"};const{[z]:e,bidirectional:i,isInverse:n,condensedView:r}=t,s=(0,u.yK)((t=>({propertyLabel:{fontSize:12,wordBreak:B,...k.Z[D],maxWidth:200,alignSelf:G,color:t[R],fill:t[A]},arrow:{width:136,height:25,alignSelf:G,transform:n?"rotate(180deg)":void 0,margin:n?"6px 12px 0px 6px":"0px 6px 6px 6px",opacity:.3,fill:t[F]},smallArrow:{height:8,paddingLeft:1,marginTop:n?2:void 0,display:"inherit",transform:n?"rotate(180deg)":void 0,opacity:.3,fill:t[F]}})),[n]),l=o()("div",{[V]:s.propertyLabel},void 0,e||"");return a[N](a[O],null,!n&&!r&&l,r?c.Z.collectionRelationSmallArrowRight(s.smallArrow):i?c.Z.collectionSelfRelationArrow(s.arrow):c.Z.collectionRelationArrow(s.arrow),n&&!r&&l)}function Y(t){window.__c={n:"RelationVisualizerDatabase"};const{[q]:e,condensedView:i,isTarget:n}=t,r=(0,d.VK)((()=>e.getIcon()),[e]),s=(0,u.yK)((t=>({wrapper:{display:"flex",alignItems:G,padding:2,color:t[R],fill:t[A],position:i?void 0:"absolute",left:i?void 0:n?"72%":"28%",transform:i?void 0:"translate(-50%, 0)",width:"fit-content"},icon:{marginRight:4,width:12,height:12},title:{fontSize:12,wordBreak:B,...k.Z[D],maxWidth:100}})),[i,n]);return o()("div",{[V]:s.wrapper},void 0,r?o()(Z.Z,{icon:r,isEmptyPage:!1,size:12,disabled:!0,[V]:s.icon}):c.Z.collectionTable(s.icon),o()(_.Z,{store:e,[V]:s.title}))}var J=i(42922),X=i(68894);const tt=i(85).Rbl,et=i(85).sRA,it=i(85).OBh,nt=i(85).Dd5,ot=i(85).pkR,rt=i(85).Joh,st=i(85).D7I,at=i(85).BQ6,lt=i(85).jtM,dt=i(85).apZ,ut=i(85).nx5,ct=i(85).sM5,pt=i(85)._vc,ht=i(85).BQW,mt=i(85).vhv,vt=i(85).Mt_,gt=i(85).Yb8,ft=i(85).N4Y,yt=i(85).zIe,St=i(85).jI3,bt=i(85).oWD,wt=i(85).UGA,Ct=i(85)._tz,Pt=i(85).ffk,It=i(85).P24;function xt(t){window.__c={n:"CollectionSettingsInverseRelationConfig"};const{[It]:e,[Pt]:i,[Ct]:n,[wt]:r,onSubmit:s,buttonContents:b,isInitialPropertyName:w,temporaryInverseState:C,setTemporaryInverseState:P,from:I}=t,k=(0,l.O7)(),Z=(0,d.VK)((()=>i?g.getPropertySchema(e,i):void 0),[e,i]),M=(0,d.VK)((()=>e[bt]()),[e]),F=(0,d.VK)((()=>Boolean(M&&M.id===r.id)),[M,r]),A=(0,d.VK)((()=>Boolean(i?g[St](e,i,r):void 0)),[e,i,r]),R=(0,d.VK)((()=>{if("relation"!==(null==Z?void 0:Z.type))return"";const t=Z[Pt];if(!t||t===i)return"";const e=r.getRole();if(!e||!p.canRead(e))return"";const n=r.getSchema()[t];return(null==n?void 0:n.name)||""}),[r,i,Z]),D=(0,d.VK)((()=>"relation"===(null==Z?void 0:Z.type)&&Z[yt]?Z[yt]:{[ft]:!1}),[Z]),B=(0,d.VK)((()=>Boolean(g.canConfigureTargetCollection(r))),[r]),O=(0,d.VK)((()=>Boolean((null==M?void 0:M.getDatabaseType())&&i&&(null==M?void 0:M.isTypedProperty(i)))),[M,i]),N=(0,d.VK)((()=>e.contextType),[e]),V=(0,u.yK)((t=>({errorLabel:{margin:"0px 14px",color:t.errorText},helpIcon:{width:16,fill:t.lightIconColor,marginLeft:6}})),[]),E=(0,a.useMemo)((()=>C?C[St]:A),[C,A]),G=(0,a.useMemo)((()=>C?C[gt]:R),[C,R]),L=(0,a.useMemo)((()=>C?C[yt]:D),[C,D]),K=(0,a.useCallback)((()=>{const t=null!=M&&M.isSyncedCollection()?L:E?{[ft]:!1}:L;P({[St]:!E,[gt]:E?void 0:G,[yt]:t}),i&&m[vt]({environment:k,[It]:e,[Pt]:i,from:"collectionPage"===N?mt:ht,action:E?"relation_toggle_inverse_off":"relation_toggle_inverse_on",is_self_relation:F})}),[P,E,G,L,e,M,i,N,F,k]),U=(0,a.useCallback)((t=>{P({[St]:!0,[gt]:t.target.value,[yt]:L})}),[P,L]),q=(0,a.useCallback)((t=>{const n=null!=L&&L[ft]?{[ft]:!1}:{[ft]:!0,bot_id:t};P({[St]:E,[gt]:G,[yt]:n}),i&&m[vt]({environment:k,[It]:e,[Pt]:i,from:"collectionPage"===N?mt:ht,action:n[ft]?"auto_relation_toggle_on":"auto_relation_toggle_off"})}),[i,P,e,N,G,E,L,k]),W=(0,a.useCallback)((t=>{(0,v.ZP)({event:t,context:v.Af[pt],callback:s})}),[s]),z=o()("div",{[at]:{[ct]:"flex",alignItems:"center",whiteSpace:"pre"}},void 0,o()(h.FormattedMessage,F?{id:"database.viewSettings.setupRelationTab.selfRelation.reverse",[ut]:"Separate directions"}:{id:"database.viewSettings.setupRelationTab.relation.reverse",[ut]:"Show on {databaseName}",values:{[dt]:o()(_.Z,{[at]:{[ct]:lt},store:r})}}),o()(S.Z,{render:t=>a[st]("div",t,c.Z.help(V.helpIcon)),[at]:{width:200},placement:f.u.Bottom,textWrap:!0,[rt]:()=>o()(h.FormattedMessage,!B||O?{[ut]:"Cannot edit target database.",id:"database.viewSettings.setupRelationTab.inverseDisabledWarning.title"}:F?{[ut]:"Create separate properties for each direction of a two-way relation. Useful for modeling Parent task/Sub-tasks, Blocked by/Blocking, and more.",id:"database.viewSettings.setupRelationTab.inverseRelationTooltip.selfRelation"}:{[ut]:"Create a property on {databaseName} showing backlinks to the current database",id:"database.viewSettings.setupRelationTab.inverseRelationTooltip",values:{[dt]:o()(_.Z,{[at]:{[ct]:lt},store:r})}})}));return a[st](a.Fragment,null,!(F&&A)&&!I&&o()(y.Z,{title:z,on:E,focused:!1,onClick:K,[ot]:!B||F&&A||O,textWrapperStyle:{opacity:1}}),o()(kt,{[It]:e,[wt]:r,isSelfRelation:F,temporaryInverseState:C,[St]:A,inverseRelationName:R,[ot]:!B||O,[nt]:U,from:I}),o()(x,{handleAutoRelateToggle:q,temporaryAutoRelateState:null==C?void 0:C[yt],[It]:e,[yt]:D,[wt]:r,[St]:E}),(()=>{if("relation"!==(null==Z?void 0:Z.type))return!0;if(C){if(C[St]!==A)return!0;if(C[gt]&&C[gt]!==R)return!0;if(C[yt]&&C[yt][ft]!==D[ft])return!0}return!1})()&&o()(T.Z,{},void 0,o()(J.Z,{[at]:{[ct]:"flex",margin:"6px 12px 0px 12px"},onClick:W},void 0,b)),"subitem"!==I&&"timeline_arrows_by"!==I&&o()($,{[it]:Z,[Ct]:n,[It]:e,[wt]:r,temporaryInverseState:C,[St]:A,inverseRelationName:R,isInitialPropertyName:w}))}function kt(t){window.__c={n:"CollectionSettingsInverseRelationName"};const{[It]:e,[wt]:i,isSelfRelation:n,temporaryInverseState:r,[St]:a,inverseRelationName:l,[ot]:u,[nt]:c,from:p}=t,m=(0,h.useIntl)(),v=(0,d.VK)((()=>{const t=e[bt]();return null!=t&&t.isDefined()?g[et](m,{sourceCollection:t.getModel(),isSelfRelation:n,[wt]:i,createUnique:!0,from:p}):m.formatMessage({id:"database.viewSettings.setupRelationTab.inverseRelationName.placeholder",[ut]:"Related to target"})}),[e,m,n,i,p]);return(r?r[St]:a)?o()(T.Z,{title:!p&&o()(M.Z,{isSmall:!0,isSecondaryColor:!0},void 0,o()(h.FormattedMessage,{[ut]:"Related property on {databaseName}",id:"database.viewSettings.setupRelationTab.inverseRelationNameInput.title",values:{[dt]:o()(_.Z,{[at]:{[ct]:"inline"},store:i})}}))},void 0,o()(X.ZP,{value:"subitem"!==p&&"timeline_arrows_by"!==p?(null==r?void 0:r[gt])||l:v,placeholder:v,[nt]:c,onBlur:s()[tt],onSubmit:s()[tt],focusInitial:!1,selectAll:!1,[ot]:u})):null}},71554:(t,e,i)=>{i.d(e,{C:()=>k,U:()=>Z});var n=i(77094),o=i.n(n),r=i(67294),s=i(480),a=i(99036),l=i(5366),d=i(77162),u=i(64434),c=i(12359),p=i(52821);const h=i(85).nx5;function m(t,e,i){return"1"===t?o()(l.FormattedMessage,"relation"===e?i&&!0===i?{[h]:"1 item",id:"database.viewSettings.collectionPropertyLimitHelpers.limitOne.connectedRelation"}:{[h]:"1 page",id:"database.viewSettings.collectionPropertyLimitHelpers.limitOne.relation"}:{[h]:"1 {type}",id:"database.viewSettings.collectionPropertyLimitHelpers.limitOne",values:{type:p.SO[e]}}):"no_limit"===t?o()(l.FormattedMessage,{[h]:"No limit",id:"database.viewSettings.collectionPropertyLimitHelpers.noLimit"}):void 0}function v(t,e,i){return{key:t,title:m(t,e,i)}}var g=i(13709);const f=i(85).nx5,y=i(85).gWL,S=i(85).pzN,b=i(85).NN6,w=i(85).Mt_,C=i(85).veG,P=i(85).wgE,I=i(85).oWD,x=i(85).P24;function k(t){window.__c={n:"CollectionSettingsLimitOptions"};const{property:e,propertySchema:i,[x]:n}=t,l=(0,s.O7)(),p=(0,r.useCallback)((t=>{const o=n[I]();if(!o||!(0,a.isPropertySchemaWithLimit)(i))return;const r={...i,limit:Number(t)?1:void 0};c.createAndCommit({userAction:"CollectionSettingsLimitOptions.handleLimitChange",[P]:l,perform:t=>{u[C]({[P]:l,[I]:o,update:{[e]:r},transaction:t})}});const s=Number(t)?`${i.type}_toggle_limit_on`:`${i.type}_toggle_limit_off`;d[w]({[P]:l,[x]:n,property:e,from:"view_settings",action:s})}),[n,l,e,i]);return(0,a.isPropertySchemaWithLimit)(i)?"relation"===i.type&&i[b]?o()(Z,{[S]:i.type,[b]:!0,[y]:i.limit?"1":"no_limit",onChange:p}):o()(Z,{[S]:i.type,[y]:i.limit?"1":"no_limit",onChange:p}):null}function Z(t){const{[S]:e,[y]:i,[b]:n,onChange:r}=t;return o()(g.Z,{title:o()(l.FormattedMessage,{[f]:"Limit",id:"database.viewSettings.collectionPropertyLimitHelpers.limit"}),[y]:i,popupStyle:{minWidth:190},options:[v("1",e,n),v("no_limit",e)],onChange:r})}},26122:(t,e,i)=>{i.d(e,{Z:()=>_});var n=i(77094),o=i.n(n),r=(i(67294),i(83355)),s=i(49085),a=i(27153),l=i(33929),d=i(68894),u=i(23321);const c=i(85).bey,p=i(85).Wdr,h=i(85).Dd5,m=i(85).lUP,v=i(85).Vy4,g=i(85).nx5,f=i(85).Yzm,y=i(85).Omf,S=i(85).YOX,b=i(85).wgE,w=i(85).vpH,C=i(85).l6S,P=i(85).Gnd,I=i(85).P0R,x=i(85).wfR,k=i(85).K0Z;class Z extends r.Z{constructor(){super(...arguments),this.storeTypes={[k]:s.default[x]("")},this.handleBlur=()=>{this[I].onBlur(this[P][k].state)},this[C]=()=>{this[I].onSubmit(this[P][k].state)},this[w]=t=>{if(!this[I].iconButton)return;const e=l.default.getIntl(),{onSubmit:i,enforceIconColor:n,includeEmojiTab:o}=this[I].iconButton;a.show(this[b],{[S]:t.target[y](),originGap:3,popupHeight:u.ZP.desktopIconPickerOnlyPopupHeight,popupWidth:u.ZP.desktopIconPickerOnlyPopupWidth,showArrow:!0,title:e[f]({[g]:"Icon",id:"mediaPicker.tabs.icon"}),[v]:m,tabs:o?[{type:"emoji",[h]:(t,e)=>{i(t),e&&e.keepVisible||a[p]()}},{type:m,enforceIconColor:n,[h]:(t,e)=>{i(t),e&&e.keepVisible||a[p]()}}]:[{type:m,enforceIconColor:n,[h]:(t,e)=>{i(t),e&&e.keepVisible||a[p]()}}],onDelete:()=>{i(),a[p]()}})}}willMount(t){super.willMount(t),this[P][k].setState(t.initialValue)}willUnmount(){const{initialValue:t,onBlur:e}=this[I],i=this[P][k].state;t!==i&&e(i)}renderComponent(){const{placeholder:t,focusInitial:e,selectAll:i,disabled:n,inputOuterStyle:r,iconButton:s}=this[I],{[k]:a}=this[P],l=a.state;return o()(d.ZP,{focusInitial:e,selectAll:i,value:l,[h]:t=>{a.setState(t.target.value)},onBlur:this.handleBlur,onSubmit:this[C],placeholder:t,disabled:n,textWrapperStyle:{opacity:n?.7:void 0},inputOuterStyle:r,left:s&&o()(d.DO,{[m]:s[m],[c]:s[c],onClick:this[w],disabled:n})})}}Z.displayName="CollectionSettingsNameInput";const _=Z},41837:(t,e,i)=>{i.d(e,{mJ:()=>Ea,ZP:()=>Ga,sY:()=>Na});var n=i(97464),o=i.n(n),r=i(77094),s=i.n(r),a=i(67294),l=i(73935),d=i(83355),u=i(1302),c=i(49085),p=i(99036),h=i(80951),m=i(8848),v=i(39068),g=i(79362),f=i(3909),y=i(97880),S=i(82990),b=i(5366),w=i(77162),C=i(16956),P=i(5149),I=i(87085),x=i(64434),k=i(96802),Z=i(80402),_=i(12359),T=i(93959),M=i(52821),F=i(78316),A=i(99417),R=i(75081),D=i(33929),B=i(33665),O=i(77546),N=i(85644),V=i(67695),E=i(61766),G=i(10161),L=i(33846),K=i(39098),U=i(13162),q=i(27788),W=i(480),z=i(81954),H=i(98963),Q=i(9953),$=i(66580),j=i(68910),Y=i(68894),J=i(72495);const X=i(85).cZW,tt=i(85).pkR,et=i(85).zwB,it=i(85).Yzm,nt=i(85).Uk6,ot=i(85).nx5,rt=i(85).wbK,st=i(85).OBh,at=i(85).P24;function lt(t){window.__c={n:"CollectionSettingsButtonOptions"};const{[at]:e,[st]:i,propertyId:n}=t,o=(0,W.O7)(),r=o.currentUser.id,l=(0,z.Kw)(e.permissionScopes),d=(0,z.VK)((()=>e.collectionStore()),[e]),u=(0,z.VK)((()=>i[rt]&&d?K.Mz.createChildStore(d,{table:H.cv,id:i[rt],spaceId:d.getSpaceId()}):void 0),[d,i]),c=(0,z.VK)((()=>null==u?void 0:u.getTrigger()),[u]),p=(0,a.useMemo)((()=>{if(u)return new j.L({type:"button_property",persisted:!0,automationStore:u,[at]:e,propertyId:n,[st]:i,intl:D.default.getIntl(),parentRecordStore:u,currentUserId:r})}),[n,i,u,e,r]),h=(0,z.VK)((()=>(null==u?void 0:u.getNameStore().getValue())??""),[u]),m=(0,a.useCallback)((t=>{if(!u)return;const e=t.currentTarget.value;_.createAndCommit({userAction:"CollectionSettingsButtonOptions.setName",environment:o,perform:t=>{Q.setValue({store:u.getNameStore(),transaction:t,value:e})}})}),[u,o]);return d&&u&&c&&"button"===c.type&&p?a.createElement(a.Fragment,null,s()(J.Z,{topBorder:!0,title:s()(b.FormattedMessage,{id:"database.buttonProperty.label",[ot]:"Label"})},void 0,s()(Y.ZP,{[tt]:!l[nt],[X]:D.default[it](dt[et]),value:h,onChange:m})),s()(J.Z,{title:s()(b.FormattedMessage,{id:"database.buttonProperty.actions",[ot]:"Actions"})},void 0,s()($.AutomationButtonActionList,{contextStore:p,[tt]:!l[nt],suppressErrors:!0,onActionAdded:()=>{}}),s()("div",{}))):null}const dt=(0,b.defineMessages)({[et]:{[ot]:"Type a name for this button...",id:"database.buttonProperty.label.inputPlaceholder"}});var ut=i(13991),ct=i(40506),pt=i(11843),ht=i(13709);const mt=i(85).qq3,vt=i(85).gWL,gt=i(85).Yzm,ft=i(85).vK9,yt=i(85).nx5,St=i(85).N6$,bt=i(85).DWU,wt=i(85).BQW,Ct=i(85).Mt_,Pt=i(85).LCr,It=i(85).veG,xt=i(85).nxU,kt=i(85).wgE,Zt=i(85).Drs,_t=i(85).JJj,Tt=i(85).dIU,Mt=i(85).vYD,Ft=i(85).oWD,At=i(85).ffk,Rt=i(85).P24;class Dt extends d.Z{constructor(){super(...arguments),this.handleDateFormatChange=t=>{const{[Rt]:e,[At]:i}=this.props,n=e[Ft](),o=this[Mt]();if(!n||!o)return;const r={...o,[Tt]:t};_[_t]({[Zt]:"CollectionSettingsDateOptions.handleDateFormatChange",[kt]:this[kt],[xt]:t=>{x[It]({[kt]:this[kt],[Ft]:n,update:{[i]:r},[Pt]:t})}}),w[Ct]({[kt]:this[kt],[Rt]:e,[At]:i,from:wt,action:"date_change_format"})},this.handleClockFormatChange=t=>{const{[Rt]:e,[At]:i}=this.props,n=e[Ft](),o=this[Mt]();if(!n||!o)return;const r=this[bt]()[t],s={...o,[St]:r};_[_t]({[Zt]:"CollectionSettingsDateOptions.handleClockFormatChange",[kt]:this[kt],[xt]:t=>{x[It]({[kt]:this[kt],[Ft]:n,update:{[i]:s},[Pt]:t})}}),w[Ct]({[kt]:this[kt],[Rt]:e,[At]:i,from:wt,action:"date_change_time_format"})},this[bt]=()=>(0,pt.E)(ut.SP).time}renderComponent(){const{intl:t}=this.props,e=this[Mt]();if(!e)return;const i=e[Tt]||ct.defaultDateFormat,n=e[St]||ct.defaultTimeFormat,o=this.getClockFormatFromTimeFormat(n);return a.createElement(a.Fragment,null,s()(ht.Z,{title:s()(b.FormattedMessage,{[yt]:"Date format",id:"database.viewSettings.dateOptions.dateFormat"}),[vt]:i,popupStyle:{[ft]:190},options:ct.dateFormatOptions.map((e=>({key:e,title:t[gt](ct.dateFormatDisplayNameMap[e])}))),onChange:this.handleDateFormatChange}),s()(ht.Z,{title:s()(b.FormattedMessage,{[yt]:"Time format",id:"database.viewSettings.dateOptions.timeFormat"}),[vt]:o,popupStyle:{[ft]:190},options:ct.clockFormats.map((e=>({key:e,title:t[gt](ct.clockFormatDisplayNameMap[e])}))),onChange:this.handleClockFormatChange}))}[Mt](){const{[Rt]:t,[At]:e}=this.props,i=t[mt].state[e];if(i)return"date"===i.type||"created_time"===i.type||"last_edited_time"===i.type||"last_visited_time"===i.type?i:void 0}getClockFormatFromTimeFormat(t){const e=this[bt]();for(const i in e)if(e[i]===t)return i;return"12h"}}Dt.displayName="CollectionSettingsDateOptions";const Bt=(0,b.injectIntl)(Dt),Ot=i(85).nx5,Nt=i(85).veG,Vt=i(85).wgE,Et=i(85).v2F,Gt=i(85).oWD,Lt=i(85).uUT,Kt=i(85).P24;function Ut(t){window.__c={n:"CollectionSettingsDefaultPersonPicker"};const{[Kt]:e,property:i,propertySchema:n}=t,o=(0,W.O7)(),r=(0,a.useCallback)((t=>{const r={...n,default:"created_by"===t?Lt:void 0},s=e[Gt]();if(!s)return;const a=[],l={pointer:s.pointer,command:"update",path:["schema",i],args:{default:t}};a.push(l),x[Et]({[Vt]:o,[Gt]:s,performTransaction:t=>{for(const e of a)_.applyOperation({store:(0,K.Kv)(s,e.pointer),operation:e,transaction:t})}}),_.createAndCommit({userAction:"CollectionSettingsDefaultPersonPicker.handleChange",[Vt]:o,perform:t=>{x[Nt]({[Vt]:o,[Gt]:s,update:{[i]:r},transaction:t})}})}),[e,o,i,n]);return s()(ht.Z,{title:s()(b.FormattedMessage,{[Ot]:"Default",id:"CollectionSettingsDefaultPersonPicker.default.title"}),selectedKey:n.default?Lt:"no_default",popupStyle:{minWidth:190},options:[{key:"no_default",title:s()(b.FormattedMessage,{[Ot]:"No default",id:"CollectionSettingsDefaultPersonPicker.options.noDefault"})},{key:Lt,title:s()(b.FormattedMessage,{[Ot]:"Created by",id:"CollectionSettingsDefaultPersonPicker.options.creator"}),icon:f.Z.person({width:16})}],onChange:r})}var qt=i(21202),Wt=i(17809),zt=i(77907),Ht=i(42917),Qt=i(31945),$t=i(44532),jt=i(73240),Yt=i(72589);const Jt=i(85).D7I,Xt=i(85).nx5,te=i(85).Mt_,ee=i(85).LCr,ie=i(85).veG,ne=i(85).nxU,oe=i(85).wgE,re=i(85).NzY,se=i(85).Drs,ae=i(85).JJj,le=i(85).bF2,de=i(85).JZr,ue=i(85).qUc,ce=i(85).P3s,pe=i(85).sbn,he=i(85).BQW,me=i(85).QQh,ve=i(85).pkR,ge=i(85).OBh,fe=i(85).zsX,ye=i(85).nSw,Se=i(85).N1Z,be=i(85).Nq1,we=i(85).TLr,Ce=i(85).Mwm,Pe=i(85).Ql2,Ie=i(85).qq3,xe=i(85).QmD,ke=i(85).oWD,Ze=i(85).ffk,_e=i(85).P24,Te=i(85).LtW;class Me extends d.Z{constructor(){super(...arguments),this.storeTypes={[Te]:E.Z},this.renderPopup=t=>{const{[_e]:e,[Ze]:i}=this.props,n=e[ke]();if(!n)return;const o=e[Ie][xe],r=o[i];if("formula"!==(null==r?void 0:r.type))return;const a=n.pointer[Pe],l=Array.from(e[Ce][xe].blockIds.values())[0],d=l?K.G[we](n,{table:qt.iU,id:l,[Pe]:a}):void 0,u=Boolean(n[be]()&&n.isTypedProperty(i));return(0,Wt.formulasPrototypeEnabled)()?s()(zt.DependencyConsumer,{[me]:zt.deps.formulas},void 0,(e=>s()(Yt.Z,{onClickClose:t[Se],[Ze]:i,[ye]:n[ye],[ge]:r,[ke]:n,handleCodeChange:this[fe],formulas:e,[ve]:u}))):s()(jt.default,{[Ze]:i,schema:o,[ce]:he,exampleBlock:null==d?void 0:d[pe](),[ve]:u,onChange:this.handleFormulaChange,onClickCancel:t[Se]})},this[fe]=t=>{const{newValue:e,newType:i,[ge]:n,[Ze]:o,[ke]:r}=t,s=e?{...n,[ue]:{code:e,[le]:i},[de]:"v2"}:{...n,[ue]:void 0,[de]:"v2"};_[ae]({[se]:re,[oe]:this[oe],[ne]:t=>{x[ie]({[oe]:this[oe],[ke]:r,update:{[o]:s},[ee]:t})}})},this.handleFormulaChange=t=>{let{[ge]:e,[Se]:i}=t;const{[_e]:n,[Ze]:o}=this.props,r=n[ke]();r&&(_[ae]({[se]:re,[oe]:this[oe],[ne]:t=>{x[ie]({[oe]:this[oe],[ke]:r,update:{[o]:e},[ee]:t})}}),i&&this.stores[Te].reset(),w[te]({[oe]:this[oe],[_e]:n,[Ze]:o,from:he,action:"formula_edit"}))}}renderComponent(){const{device:t}=this[oe],{[Te]:e}=this.stores;return s()(Qt.ZP,{popupType:t.isMobile?$t.kQ.SlideUp:$t.kQ.Popup,alignmentToOrigin:Qt.vR.End,renderOrigin:t=>a[Jt](Ht.Z,o()({title:s()(b.FormattedMessage,{[Xt]:"Formula",id:"database.viewSettings.formulaOptions.title"}),right:s()(b.FormattedMessage,{[Xt]:"Edit",id:"database.viewSettings.formulaOptions.edit"}),showChevron:!0,rotateChevron:e[xe].open},t)),render:this.renderPopup,[Te]:e})}}Me.displayName="CollectionSettingsFormulaOptions";const Fe=(0,b.injectIntl)(Me);var Ae=i(21269),Re=i(71554),De=i(13005),Be=i(26122),Oe=i(24405),Ne=i(35011),Ve=i(34299),Ee=i(78106),Ge=i(32056),Le=i(66890),Ke=i(16187),Ue=i(64921),qe=i(74194),We=i(85248),ze=i(78942),He=i(24006),Qe=i(58573),$e=i(15157),je=i(87279),Ye=i(29798),Je=i(52275),Xe=i(78140),ti=i(32163);const ei=i(85).D7I,ii=i(85).nx5,ni=i(85).Nbg,oi=i(85).Yzm,ri=i(85).LCr,si=i(85).veG,ai=i(85).Drs,li=i(85).JJj,di=i(85).GWV,ui=i(85).wgE,ci=i(85).g65,pi=i(85)._9S,hi=i(85).oWD,mi=i(85).VFs,vi=i(85).iB2,gi=i(85).Gnd,fi=i(85).Wp_,yi=i(85).P0G,Si=i(85).wfR,bi=i(85).SRz;class wi extends d.Z{constructor(){super(...arguments),this.storeTypes={[bi]:c.default[Si](""),[yi]:Ye.Z},this.handleNumberFormatFilterChange=t=>{this[gi][bi][fi](t.target.value),this[gi][yi][fi]({...this[gi][yi].state,focus:{section:0,[vi]:0,[mi]:0}})},this.handleNumberFormatChange=t=>{const{[hi]:e,property:i,schema:n,onClose:o}=this.props,r=n[i];if(!r)return;if("number"!==r.type&&"formula"!==r.type)return;const s={...r,[pi]:t,..."percent"===t&&void 0!==(null==r?void 0:r.show_as)?{show_as:{...null==r?void 0:r.show_as,maxValue:1}}:{}};"number"===r.type&&(0,Ge.b3)(t)&&$e.Z.set({userId:this[ui][ci].id,key:wi[di],value:t}),_[li]({[ai]:"NumberFormatMenu.handleNumberFormatChange",[ui]:this[ui],perform:t=>{x[si]({[ui]:this[ui],[hi]:e,update:{[i]:s},[ri]:t})}}),null==o||o()}}renderComponent(){const{device:t}=this[ui];let e;e=t.isMobile?{menuType:je.og.ActionSheet}:{menuType:je.og.Popup};const i=!t.isMobile&&s()(J.Z,{isInput:!0},void 0,s()(Y.ZP,{value:this[gi][bi].state,onChange:this.handleNumberFormatFilterChange,focus:!0,focusAfterAnimation:!0,placeholder:D.default[ni]()[oi]({[ii]:"Filter formats…",id:"blockPropertyValue.filterForNumberFormats.placeholder"}),preventCaptureDeleteWhenEmpty:!0}));return a[ei](Xe.Z,o()({},e,{header:i}),s()(ti.Z,{type:ti.i.Vertical,initialFocus:0,sections:[{key:0,render:t=>a[ei](J.Z,t),items:this.getMenuItems()}],store:this[gi][yi]}))}getMenuItems(){const t=$e.Z.get({userId:this[ui][ci].id,key:wi[di]});return(0,Qe.ZP)(this[gi][bi].state,(0,Ge.jD)(t),(t=>t)).map((t=>({key:t,render:e=>this.renderMenuItem(t,e),action:()=>this.handleNumberFormatChange(t)})))}renderMenuItem(t,e){return a[ei](Je.Z,o()({},e,{title:(0,Ge.Bo)(D.default[ni](),t)}))}}wi.displayName="NumberFormatMenu",wi[di]="LastUsedCurrency";const Ci=wi;var Pi=i(9050);const Ii=i(85).OtN,xi=i(85).MLn,ki=i(85).vK9,Zi=i(85).ELX,_i=i(85).jms,Ti=i(85).TEz,Mi=i(85).f57,Fi=i(85).PG2,Ai=i(85).ewQ,Ri=i(85).ChN,Di=i(85).Mt_,Bi=i(85).veG,Oi=i(85).wgE,Ni=i(85).nLZ,Vi=i(85).PXg,Ei=i(85).XNW,Gi=i(85).Exd,Li=i(85).gGi,Ki=i(85).Jkr,Ui=i(85).OP1,qi=i(85).Mm1,Wi=i(85)._V5,zi=i(85).H1U,Hi=i(85).jkI,Qi=i(85).UPJ,$i=i(85).rps,ji=i(85).$bT,Yi=i(85).sM5,Ji=i(85).NF1,Xi=i(85).dMt,tn=i(85).EMU,en=i(85).X_m,nn=i(85).iDK,on=i(85).HDB,rn=i(85).OgJ,sn=i(85).UA5,an=i(85).BQ6,ln=i(85).Uie,dn=i(85).nx5,un=i(85).pHx,cn=i(85).E0z,pn=i(85).dLQ,hn=i(85).D7I,mn=i(85).rUZ,vn=i(85).nSw,gn=i(85).NlJ,fn=i(85)._9S,yn=i(85).MWD,Sn=i(85).qq3,bn=i(85).oWD,wn=i(85).YGD,Cn=i(85).OBh,Pn=i(85).ffk,In=i(85).P24;function xn(t){let{[In]:e,[Pn]:i}=t;window.__c={n:"CollectionSettingsNumberOptions"};const{[Cn]:n,[wn]:o}=(0,z.VK)((()=>{const t=e[bn](),n=e[Sn].state[i];if(!n||!t)return{};if("number"===n[yn])return{[Cn]:n,[wn]:n[fn]??Ge.dk};if("formula"===n[yn])return"number"===(0,Ne.mm)(n)?{[Cn]:n,[wn]:n[fn]??Ge.dk}:n.formula2&&(0,Wt.formulasPrototypeEnabled)()&&"number"===(0,Ee.aL)(n.formula2.result_type)[yn]?{[Cn]:n,[wn]:n[fn]??Ge.dk}:{};if("rollup"===n[yn]){var o;if(n[gn]&&"show_unique"!==n[gn]){var r;const o=null===(r=(0,Ve.gT)({[Pn]:i,schema:e[Sn].state,[vn]:t[vn]}))||void 0===r?void 0:r[mn];if(void 0===(null==o?void 0:o[yn]))return{};const s=(0,Ke.SD)(n[gn],(0,Ke.SD)(n[gn],"number_format"in o?o[fn]:void 0));return s?{[Cn]:n,[wn]:s}:{}}const s=null===(o=(0,Ve.gT)({[Pn]:i,schema:e[Sn].state,[vn]:t[vn]}))||void 0===o?void 0:o[mn];if("number"===(null==s?void 0:s[yn])||"formula"===(null==s?void 0:s[yn])&&"number"===(0,Ne.r9)(s))return{[Cn]:n,[wn]:s[fn]??Ge.dk}}return{}}),[e,i]);if(!n)return null;const r="rollup"!==n[yn];return a[hn](a.Fragment,null,r?s()(kn,{[wn]:o,[Pn]:i}):null,s()(Zn,{[Pn]:i,[Cn]:n,[wn]:o}))}function kn(t){let{[wn]:e,[Pn]:i}=t;window.__c={n:"NumberFormatSection"};const n=(0,Le.Y$)(),r=(0,z.qz)(void 0,E.Z),l=(0,b.useIntl)(),d=(0,W.O7)();return s()(Qt.ZP,{popupType:d[cn][pn]?$t.kQ[un]:$t.kQ.Popup,alignmentToOrigin:Qt.vR.End,renderOrigin:t=>a[hn](Ht.Z,o()({title:s()(b.FormattedMessage,{[dn]:"Number format",id:"database.viewSettings.numberOptions.numberFormat"}),right:s()("span",{[an]:{...S.Z[ln]}},void 0,(0,Ge.Bo)(l,Ge.dX.find((t=>t===e))??Ge.dk)),showChevron:!0,rotateChevron:r.state.open},t)),render:t=>{const e=n[bn](),o=n[Sn].state;if(e)return s()(Ci,{[bn]:e,[Pn]:i,schema:o,onClose:t.close})},buttonPopupStore:r})}function Zn(t){let{[Pn]:e,[Cn]:i,[wn]:n}=t;window.__c={n:"NumberShowAsSection"};const{show_as:r}=i,l=(0,Le.Y$)(),d=(0,W.O7)(),u=(0,Oe.Fg)(),c=a.useRef({[sn]:(null==r?void 0:r[sn])??"green",[rn]:(null==r?void 0:r[rn])??100,[on]:(null==r?void 0:r[on])??!0}),p={[yn]:(null==r?void 0:r[yn])??"number",[sn]:(null==r?void 0:r[sn])??c[nn][sn],[rn]:(null==r?void 0:r[rn])??c[nn][rn],[on]:(null==r?void 0:r[on])??c[nn][on]},h=(0,Oe.yK)((t=>({card:{boxSizing:"content-box",[en]:36,[tn]:1,margin:1,boxShadow:`0 0 0 1px ${t[Xi]}`,[sn]:t.mediumTextColor,[Ji]:3,[Yi]:tn,[ji]:$i,[Qi]:Hi,[zi]:Hi,paddingLeft:12,paddingRight:12,[Wi]:6,[qi]:6,cursor:"pointer"},selectedCard:{boxShadow:`0 0 0 2px ${t[Ui]}`,[sn]:t[Ui]},cardVisual:{[en]:20,marginBottom:4,[Ki]:Li,[Yi]:tn,[Qi]:Hi,[zi]:Hi},cardText:{lineHeight:1,[Gi]:12},progressBar:{[Ki]:Li},showAsTypeOption:{[Yi]:tn,[ji]:"row",[Qi]:"space-between",[zi]:Hi,[Ei]:16,[Vi]:16,[Ni]:6,gap:12},extraOptionStyle:{[Yi]:tn,[ji]:"row",[zi]:Hi,paddingLeft:16,paddingRight:16,gap:16,[en]:28,[Ki]:Li}})),[]),v=(0,a.useCallback)((t=>{const n=l[bn]();i&&n&&(_.createAndCommit({userAction:"CollectionSettingsProperty.handleNumberShowAsChange",[Oi]:d,perform:o=>{x[Bi]({[Oi]:d,[bn]:n,update:{[e]:{...i,show_as:t}},transaction:o})}}),w[Di]({[Oi]:d,[In]:l,[Pn]:e,from:"view_settings",action:"number_change_show_as",number_show_as:(null==t?void 0:t[yn])??"number"}))}),[l,d,e,i]),g=[{key:"number",visual:s()("div",{[an]:{[Gi]:16,[Ri]:S.Z[Ri].medium}},void 0,"42"),text:s()(b.FormattedMessage,{[dn]:"Number",id:"database.viewSettings.numberOptions.showAsNumber"})},{key:"bar",visual:s()(We.k,{percentage:50,filledColor:"bar"===p[yn]?u[Ui]:u[Xi],unfilledColor:"bar"===p[yn]?u[Ai].blue[50]:u[Xi],[an]:{[Ki]:Li}}),text:s()(b.FormattedMessage,{[dn]:"Bar",id:"database.viewSettings.numberOptions.showAsBar"})},{key:"ring",visual:s()(ze.e,{size:20,percentage:40,filledColor:"ring"===p[yn]?u[Ui]:u[Xi],unfilledColor:"ring"===p[yn]?u[Ai].blue[50]:u[Ai].gray[100],[an]:{[Ki]:Li}}),text:s()(b.FormattedMessage,{[dn]:"Ring",id:"database.viewSettings.numberOptions.showAsRing"})}],y=s()("div",{[an]:h.showAsTypeOption},void 0,g.map((t=>{const e=p[yn]===t.key;return s()(Ue.Z,{[Fi]:()=>{const e="number"===t.key?void 0:{[yn]:t.key,[sn]:p[sn],[rn]:"percent"===n?1:p[rn],[on]:p[on]};void 0!==e&&(c[nn]=e),v(e)},[an]:{...h.card,...e?h.selectedCard:{}}},t.key,s()("div",{[an]:h.cardVisual},void 0,t.visual),s()("div",{[an]:h.cardText},void 0,t.text))}))),C=t=>{const e="number"!==p[yn]?{...p,[yn]:p[yn],...t}:void 0;void 0!==e&&(c[nn]=e),v(e)},P="number"!==p[yn]?s()("div",{[an]:h.extraOptionStyle},void 0,s()("div",{[an]:{[tn]:6,[Gi]:14}},void 0,s()(b.FormattedMessage,{[dn]:"Color",id:"database.viewSettings.numberOptions.color"})),s()("div",{[an]:{[Yi]:tn,flexWrap:"wrap",[tn]:6,gap:7}},void 0,s()(Qt.ZP,{popupType:d[cn][pn]?Qt.Z4[un]:Qt.Z4.Popup,renderOrigin:t=>a[hn]("div",o()({[an]:{[Ki]:Li,[Yi]:tn,[Qi]:"end"}},t),s()(Pi.Z,{[sn]:p[sn],focused:!1,[Zi]:{[Ki]:Mi,[Ei]:0,[Vi]:0,[Ji]:3,[sn]:u[Ti]},[an]:{[_i]:36},right:f.Z.chevronDown({[Ki]:12,[en]:12})})),render:t=>{const e=m.AP.map((e=>s()(Pi.Z,{[sn]:e,checkState:e===p[sn],focused:!1,[an]:{[Ki]:Li},[Fi]:()=>{C({[sn]:e}),t.close()}},e)));return s()("div",{[an]:{[ki]:150,[Wi]:8,[qi]:8}},void 0,e)}}))):null,I="number"!==p[yn]?"percent"!==n&&s()("div",{[an]:h.extraOptionStyle},void 0,s()("div",{[an]:{[tn]:6,[Gi]:14}},void 0,s()(b.FormattedMessage,{[dn]:"Divide by",id:"database.viewSettings.numberOptions.divideBy"})),s()("div",{[an]:{[tn]:6}},void 0,s()(qe.Z,{value:p[rn].toString(),onChange:t=>{const e=t.target.value.replace(/[^0-9]/g,""),i=parseFloat(e);!isNaN(i)&&i>0&&C({[rn]:i})},inputStyle:{[xi]:"right"}}))):null,k="number"!==p[yn]?s()("div",{[an]:h.extraOptionStyle},void 0,s()("div",{[an]:{[tn]:6,[Gi]:14}},void 0,s()(b.FormattedMessage,{[dn]:"Show number",id:"database.viewSettings.numberOptions.showValue"})),s()("div",{[an]:{[tn]:6,[Yi]:tn,[Qi]:"flex-end"}},void 0,s()(He.Z,{on:p[on],[Fi]:()=>{C({[on]:!p[on]})},disabled:!1}))):null,Z=Boolean(P||I||k),T=s()("div",{[an]:{[Ii]:u[Ai].gray[30],[Ji]:5,[Ni]:Z?12:0,[Ei]:Z?14:0,[Vi]:Z?14:0,[Wi]:Z?12:0,[qi]:Z?12:0,maxHeight:Z?1e3:0,transition:"max-height 0.5s ease-in-out",overflow:"hidden",[Yi]:tn,[ji]:$i,[zi]:Hi,gap:8}},void 0,P,I,k);return s()(J.Z,{title:s()(b.FormattedMessage,{[dn]:"Show as",id:"database.viewSettings.numberPercentOptions.showAs"}),topBorder:!0,disableMobileBorders:!0},void 0,y,T,s()("div",{[an]:{[Ni]:12,[Ei]:18,[Vi]:18,[Gi]:12,[sn]:u[Ti]}},void 0,s()(b.FormattedMessage,{id:"database.CollectionSettings.NumberOptions.applyAllViews",[dn]:"Changes apply to all views showing this property."})))}var _n=i(31869),Tn=i(29376),Mn=i(80072),Fn=i(79892);const An=i(85).nx5,Rn=i(85).OBh,Dn=i(85).Mt_,Bn=i(85).wgE,On=i(85).jI3,Nn=i(85).UGA,Vn=i(85).uzK,En=i(85).qq3,Gn=i(85).oWD,Ln=i(85).ffk,Kn=i(85).P24;function Un(t){window.__c={n:"CollectionSettingsRelationOptions"};const{[Kn]:e,[Ln]:i}=t,n=(0,W.O7)(),o=(0,b.useIntl)(),[r,l]=(0,a.useState)(void 0),d=(0,z.VK)((()=>e[Gn]()),[e]),u=(0,z.VK)((()=>e[En].state),[e]),c=(0,z.VK)((()=>Tn.getPropertySchema(e,i)),[e,i]),m=c&&(0,p.isConnectedRelationPropertySchema)(c)?c.connectedRelation:void 0,v=(0,z.VK)((()=>qn(e[Vn](),c)),[e,c]),g=Boolean(v&&(null==d?void 0:d.id)===v.id),f=(0,z.VK)((()=>Boolean(v&&(null==c?void 0:c.name)===Tn.getSuggestedRelationName(o,{[Nn]:v,isSelfRelation:g,sourceSchema:u,createUnique:!1}))),[c,o,v,g,u]),y=(0,z.VK)((()=>e.contextType),[e]),S=(0,a.useCallback)((()=>{if(!r)return;const{[On]:t,inverseName:s,autoRelate:a}=r;_.createAndCommit({userAction:"CollectionSettingsRelationOptions.handleEditRelation",[Bn]:n,perform:r=>{_n.gy({[Bn]:n,[Kn]:e,[Ln]:i,[On]:t,inverseName:s,autoRelate:a,intl:o,transaction:r})}}),w[Dn]({[Bn]:n,[Kn]:e,[Ln]:i,from:"collectionPage"===y?"page_properties":"view_settings",action:"relation_edit",is_self_relation:g,has_inverse:t,auto_relate:null==a?void 0:a.enabled}),l(void 0)}),[r,n,e,i,y,g,o]);if(!v)return null;const C=c&&!(0,h.isGoogleDriveRelationProperty)(c)&&!(0,h.isFigmaRelationProperty)(c);return a.createElement(a.Fragment,null,C&&s()(Fn.Z,{isSelfRelation:g,[Gn]:v,showAs:"link",disabled:!0}),C&&s()(Re.C,{[Kn]:e,[Rn]:c,[Ln]:i}),!Boolean(m)&&s()(Mn.Z,{[Kn]:e,[Nn]:v,[Ln]:i,buttonContents:s()(b.FormattedMessage,{[An]:"Update relation",id:"database.viewSettings.editRelation.updateButton.title"}),temporaryInverseState:r,setTemporaryInverseState:l,isInitialPropertyName:f,onSubmit:S}))}function qn(t,e){if("relation"!==(null==e?void 0:e.type))return;const i=null==e?void 0:e.collection_pointer;return i&&t?K.NW.createChildStore(t,i):void 0}var Wn=i(71644),zn=i(47307),Hn=i(84619),Qn=i(25464),$n=i(73456),jn=i(22084);const Yn=i(85).BQW,Jn=i(85).nx5,Xn=i(85).$wW,to=i(85).UA5,eo=i(85).v2F,io=i(85).oWD,no=i(85).OBh;function oo(t){window.__c={n:"CollectionSettingsSelectOptionRow"};const e=(0,W.O7)(),{isMobile:i}=(0,W.Fy)(),{property:n,option:o,statusGroup:r,[no]:l,isDefault:d,disabled:u}=t,c=(0,Le.Y$)(),p=(0,z.VK)((()=>{var t;return null===(t=c[io]())||void 0===t?void 0:t.id}),[c]),h=(0,z.qz)(void 0,E.Z),m=(0,z.VK)((()=>h.state.open),[h]),v=(0,a.useCallback)((()=>{h.setState({open:!0})}),[h]),g=(0,a.useCallback)((()=>{h.setState({open:!1})}),[h]),f=(0,a.useCallback)((t=>{const i=c[io]();i&&x[eo]({environment:e,[io]:i,performTransaction:e=>{for(const n of t)_.applyOperation({store:(0,K.Kv)(i,n.pointer),operation:n,transaction:e})}})}),[c,e]),y=(0,Oe.yK)((()=>({defaultText:{fontSize:12,fontWeight:500,textTransform:"uppercase"}})),[]);return p?s()($n.Z,{open:m,origin:s()(Ht.Z,{showDragHandle:!0,showChevron:!0,disabled:u,rotateChevron:m,title:"status"===l.type?s()(jn.F,{format:i?Hn.l.Large:Hn.l.Medium,value:o.value,[to]:o[to],showRemoveButton:!1,[Xn]:!0,groupColor:null==r?void 0:r[to]}):s()(jn.a,{format:i?Hn.l.Large:Hn.l.Medium,value:o.value,[to]:o[to],showRemoveButton:!1,[Xn]:!0}),right:d?s()("span",{style:y.defaultText},void 0,s()(b.FormattedMessage,{id:"database.statusProperty.default",[Jn]:"Default"})):void 0,onClick:v}),option:o,property:n,[no]:l,statusGroup:r,collectionId:p,analyticsFrom:Yn,alignmentToOrigin:Qn.v.End,onChange:f,onClose:g}):null}var ro=i(97180),so=i(79131),ao=i(73063),lo=i(3386);const uo=i(85).g7N,co=i(85).Yzm,po=i(85).Mm1,ho=i(85).C_E,mo=i(85).D7I,vo=i(85).aI7,go=i(85).DfW,fo=i(85).Akw,yo=i(85).Xpr,So=i(85).nx5,bo=i(85).pkR,wo=i(85).OSu,Co=i(85).TtP,Po=i(85).Qt1,Io=i(85).MUY,xo=i(85).AM1,ko=i(85).GwU,Zo=i(85).CqE,_o=i(85).unR,To=i(85).irb,Mo=i(85).ONo,Fo=i(85).KOz,Ao=i(85).t85,Ro=i(85).K3k,Do=i(85).C$B,Bo=i(85).loK,Oo=i(85).Gnd,No=i(85).Wp_,Vo=i(85).ty1,Eo=i(85).X5t,Go=i(85).BQW,Lo=i(85).Mt_,Ko=i(85).LCr,Uo=i(85).EzW,qo=i(85).BvK,Wo=i(85).wgE,zo=i(85).v2F,Ho=i(85).OBh,Qo=i(85).N20,$o=i(85).C0P,jo=i(85).Kiu,Yo=i(85).e7B,Jo=i(85).Cpo,Xo=i(85).mFu,tr=i(85).vYD,er=i(85).qq3,ir=i(85).QmD,nr=i(85).oWD,or=i(85).P0R,rr=i(85).ffk,sr=i(85).P24,ar=i(85).wfR,lr=i(85).Odf,dr=i(85).K0Z;class ur extends d.Z{constructor(){super(...arguments),this.storeTypes={[dr]:L.Z,[lr]:c.default[ar](void 0)},this.handleAutoSortChange=t=>{const{[sr]:e,[rr]:i}=this[or],n=e[nr](),o=e[er][ir],r=this[tr]();if(!n||!r)return;if(!(0,p.isSelectOrMultiSelectPropertySchema)(r))return;const s=[{[Xo]:n[Xo],[Jo]:Yo,path:[jo,i],args:{[$o]:t}}];"alphabetical"!==t&&"reverse_alphabetical"!==t||s.push(...(0,F.getSortSelectOptionsOperations)({[Qo]:n.id,[rr]:i,[Ho]:r,[jo]:o,isAscending:"alphabetical"===t})||[]),x[zo]({[Wo]:this[Wo],[nr]:n,performTransaction:t=>{for(const e of s)_[qo]({store:(0,K.Kv)(n,e[Xo]),[Uo]:e,[Ko]:t})}}),w[Lo]({[Wo]:this[Wo],[sr]:e,[rr]:i,from:Go,[Eo]:"select_change_auto_sort_options"})},this[Vo]=t=>{this[Oo][dr][No]({focus:!0,[Bo]:""}),void 0!==t&&this[Oo][lr][No](t)},this[Do]=t=>{const e=t.target.value.replace(/,/g,"");this[Oo][dr][No]({focus:!0,[Bo]:e})},this[Ro]=()=>{this[Oo][dr][No]({focus:!1,[Bo]:""})},this[Ao]=()=>{const{[sr]:t,[rr]:e}=this[or],i=t[nr](),n=this[tr]();if(!n||!i)return;const o=n[Fo]||[],r=this[Oo][dr][ir][Bo];if(r){let t=(0,p.getRandomSelectColor)(o);if("status"===n.type){var s;const e=null===(s=this[Oo][lr])||void 0===s?void 0:s[ir];if(void 0!==e){var a,l;const i=null===(a=n[Mo])||void 0===a||null===(l=a[e])||void 0===l?void 0:l.color;i&&(t=i)}}if(o.find((t=>t.value===r)))return zn[To](this.renderOptionAlreadyExistsMessage()),void this[Ro]();const u={id:(0,Wn.ZP)(),value:r,color:t};let c,h;if(c=(0,p.isSelectOrMultiSelectPropertySchema)(n)&&("alphabetical"===n[$o]||"reverse_alphabetical"===n[$o])&&G.default[_o]("collection_properties_select_auto_sort_options")?(0,F.getAutoSortInsertOperation)({[Qo]:i.id,[rr]:e,[Ho]:n,newOption:u,isAscending:"alphabetical"===n[$o]}):{[Xo]:i[Xo],[Jo]:Zo,path:[jo,e,Fo],args:{value:u}},"status"===n.type){var d;const t=null===(d=this[Oo][lr])||void 0===d?void 0:d[ir];void 0!==t&&(h={[Xo]:i[Xo],[Jo]:ko,path:[jo,e,Mo,t,xo],args:{id:u.id}})}x[zo]({[Wo]:this[Wo],[nr]:i,performTransaction:t=>{_[qo]({store:(0,K.Kv)(i,c[Xo]),[Uo]:c,[Ko]:t}),h&&_[qo]({store:(0,K.Kv)(i,h[Xo]),[Uo]:h,[Ko]:t})}})}this[Oo][dr][No]({focus:!0,[Bo]:""}),w[Lo]({[Wo]:this[Wo],[sr]:t,[rr]:e,from:Go,[Eo]:"select_add_option"})},this[Io]=t=>{const{[rr]:e,[sr]:i}=this[or],n=i[er][ir],o=i[nr]();if(!o)return;const r=n[e];let s;if("status"===(null==r?void 0:r.type)){s=[[]];for(const e of t)e[Po]("group-header-")?s.push([]):s[s[Co]-1].push(e)}else s=t;const a=(0,F.getReorderSelectOptionsOperations)({newOptions:s,[Qo]:o.id,[rr]:e,[jo]:n});if(a){if(r&&(0,p.isSelectOrMultiSelectPropertySchema)(r)){"manual"!==(r[$o]||"manual")&&a.push({[Xo]:o[Xo],[Jo]:Yo,path:[jo,e],args:{[$o]:wo}})}x[zo]({[Wo]:this[Wo],[nr]:o,performTransaction:t=>{for(const e of a)_[qo]({store:(0,K.Kv)(o,e[Xo]),[Uo]:e,[Ko]:t})}})}w[Lo]({[Wo]:this[Wo],[sr]:i,[rr]:e,from:Go,[Eo]:"select_options_reorder"})}}renderComponent(){var t,e;const{[sr]:i,[rr]:n,[bo]:o}=this[or],r=null===(t=i[nr]())||void 0===t?void 0:t.getSchema(),l=null===(e=i[nr]())||void 0===e?void 0:e.getFormat().app_config_uri,d=this[tr]();if(!r||!d)return;const{[dr]:u,[lr]:c}=this[Oo],p=u[ir],h=c[ir];if("status"===d.type){const t=d[Mo]??[];if(0===t[Co])return;const e=d[Fo]??[],i=t.map((t=>{const i=e.filter((e=>{var i;return null===(i=t[xo])||void 0===i?void 0:i.includes(e.id)}));return{group:t,groupOptions:i}})),u=d.defaultOption,c=[...i[0].groupOptions.map((t=>t.value))];for(const{group:n,groupOptions:o}of i.slice(1))c.push({key:`group-header-${n.name}`,draggable:!1}),c.push(...o.map((t=>t.value)));const m=(0,T.Hw)(l,r,n)?{tooltipCaption:s()(b.FormattedMessage,{[So]:"These options are core to the property and cannot be changed.",id:"database.viewSettings.selectOptions.disabledGroupMessage"})}:void 0,v=(r,l)=>{if(r[Po]("group-header-")){const t=r.substring("group-header-"[Co]),e=i.findIndex((e=>{let{group:i}=e;return i.name===t})),{group:n,groupOptions:l}=i[e];return this[yo](s()(ro.r_,{disableGroup:m,group:n,showIcon:!1}),!p.focus&&this[fo]((()=>this[Vo](e))),a[mo](a.Fragment,null,h===e&&this[go](),!p.focus&&0===l[Co]&&this[vo](e)),o)}{const i=e.find((t=>t.value===r));if(!i)return;const a=t.find((t=>{var e;return null===(e=t[xo])||void 0===e?void 0:e.includes(i.id)}));return s()(oo,{option:i,statusGroup:a,[Ho]:d,[rr]:n,isDefault:i.value===u,[bo]:o},i.value)}};return[this[yo](s()(ro.r_,{disableGroup:m,group:i[0].group}),!p.focus&&this[fo]((()=>this[Vo](0))),a[mo](a.Fragment,null,0===h&&this[go](),!p.focus&&0===i[0].groupOptions[Co]&&this[vo](0)),o),s()(so.ZP,{direction:"vertical",keys:c,renderKey:v,onDrop:this[Io],[bo]:o})]}{const t=d[Fo]??[],e=t.map((t=>t.value)),i=d[$o]||"manual";return[G.default[_o](ho)&&s()(ht.Z,{title:s()(b.FormattedMessage,{[So]:"Sort",id:"database.viewSettings.selectOptions.autoSort"}),selectedKey:i,[Fo]:[{key:"manual",title:s()(b.FormattedMessage,{[So]:"Manual",id:"database.viewSettings.selectOptions.autoSort.none"})},{key:"alphabetical",title:s()(b.FormattedMessage,{[So]:"Alphabetical",id:"database.viewSettings.selectOptions.autoSort.alphabetical"})},{key:"reverse_alphabetical",title:s()(b.FormattedMessage,{[So]:"Reverse alphabetical",id:"database.viewSettings.selectOptions.autoSort.reverseAlphabetical"})}],onChange:this.handleAutoSortChange,popupStyle:{minWidth:190}},"autoSortMenuItem"),this[yo](s()(b.FormattedMessage,{[So]:"Options",id:"database.viewSettings.selectOptions.title"}),!p.focus&&e[Co]>0&&this[fo]((()=>this[Vo]())),this[go](),o),e[Co]>0&&s()(so.ZP,{direction:"vertical",keys:e,renderKey:e=>{const i=t.find((t=>t.value===e));if(i)return s()(oo,{option:i,[rr]:n,[Ho]:d,isDefault:!1,statusGroup:void 0,[bo]:o},i.value)},onDrop:this[Io]}),!p.focus&&0===e[Co]&&this[vo]()]}}[yo](t,e,i,n){return s()(J.Z,{topBorder:!0,title:t,desktopTitleStyle:{height:20},right:!n&&e,style:{width:"100%",[po]:0}},void 0,!n&&i)}[go](){const{[dr]:t}=this[Oo],e=t[ir];if(e.focus)return s()(lo.Z,{capture:!0,onEsc:this[Ro]},void 0,s()(Y.ZP,{value:e[Bo],focus:!0,placeholder:this[or].intl[co]({[So]:"Type a new option…",id:"database.viewSettings.selectOptions.newSelectOption.inputPlaceholder"}),style:{marginTop:2,[uo]:8},onChange:this[Do],onBlur:this[Ro],onSubmit:this[Ao]}))}[vo](t){return s()(Je.Z,{icon:f.Z.plus({width:14}),focused:!1,title:s()(b.FormattedMessage,{[So]:"Add an option",id:"database.viewSettings.selectOptions.noOptions"}),style:{width:"100%"},onClick:()=>this[Vo](t)})}[fo](t){if(this[tr]())return s()(ao.Z,{icon:f.Z.plus,onClick:t,style:{width:20,height:20}})}renderOptionAlreadyExistsMessage(){return s()(b.FormattedMessage,{[So]:"Option already exists.",id:"database.optionExistsAlreadyError.message"})}[tr](){const{[sr]:t,[rr]:e}=this[or],i=t[er][ir][e];if(i&&((0,p.isSelectOrMultiSelectPropertySchema)(i)||"status"===i.type))return i}}ur.displayName="CollectionSettingsSelectOptions";const cr=(0,b.injectIntl)(ur),pr=i(85).qq3,hr=i(85).Yzm,mr=i(85).vYD,vr=i(85).Hco,gr=i(85).bey,fr=i(85).BQW,yr=i(85).Mt_,Sr=i(85).LCr,br=i(85).wgE,wr=i(85).Drs,Cr=i(85).JJj,Pr=i(85).FZz,Ir=i(85).ffk,xr=i(85).P24,kr=i(85).nx5,Zr=(0,b.defineMessages)({statusShowAsLabel:{id:"database.viewSettings.statusOptions.showAs",[kr]:"Show as"},statusCheckboxLabel:{id:"database.viewSettings.statusOptions.showAs.checkbox",[kr]:"Checkbox"},statusSelectLabel:{id:"database.viewSettings.statusOptions.showAs.select",[kr]:"Select"}});class _r extends d.Z{constructor(){super(...arguments),this.handleShowAsChange=t=>{const{[xr]:e,[Ir]:i}=this.props,n=e.formatStore();if(!n)return;const o=e[Pr]();o&&(_[Cr]({[wr]:"CollectionSettingsStatusOptions.handleShowAsChange",[br]:this[br],perform:e=>{C.er({formatStore:n,formatKey:o,[Ir]:i,update:{statusShowAs:t,visible:!0},[Sr]:e})}}),w[yr]({[br]:this[br],[xr]:e,[Ir]:i,from:fr,action:"status_change_format"}))},this[gr]={width:16,height:16,fill:this.theme[vr]}}renderComponent(){var t;const{[xr]:e,[Ir]:i,disabled:n}=this.props;if(!this[mr]())return;const o=[{key:"checkbox",title:D.default[hr](Zr.statusCheckboxLabel),icon:f.Z.typesCheckbox(this[gr])},{key:"select",title:D.default[hr](Zr.statusSelectLabel),icon:f.Z.typesSelect(this[gr])}],r=(null===(t=e.getPropertyFormat(i))||void 0===t?void 0:t.statusShowAs)??"select";return s()(ht.Z,{title:D.default[hr](Zr.statusShowAsLabel),selectedKey:r,popupStyle:{minWidth:190},options:o,onChange:t=>this.handleShowAsChange(t),disabled:n})}[mr](){const{[xr]:t,[Ir]:e}=this.props,i=t[pr].state[e];if(i&&"status"===i.type)return i}}_r.displayName="CollectionSettingsStatusOptions";const Tr=(0,b.injectIntl)(_r);var Mr=i(74420),Fr=i(31278),Ar=i(76798),Rr=i(32662),Dr=i(58032),Br=i(64369),Or=i(18145);const Nr=i(85).Omf,Vr=i(85).EB9,Er=i(85).PXg,Gr=i(85).XNW,Lr=i(85).rOg,Kr=i(85).sOA,Ur=i(85).$bT,qr=i(85).S3,Wr=i(85).Joh,zr=i(85).tBn,Hr=i(85).Uie,Qr=i(85).sei,$r=i(85).jtM,jr=i(85).pkR,Yr=i(85).jkI,Jr=i(85).H1U,Xr=i(85).EMU,ts=i(85).sM5,es=i(85).Wsu,is=i(85).auS,ns=(i(85).g8G,i(85).ESK),os=i(85).uzK,rs=i(85).D7I,ss=i(85).PG2,as=i(85)._tz,ls=i(85).cZW,ds=i(85).kUY,us=i(85).bey,cs=i(85).BQ6,ps=i(85).GmX,hs=i(85).Scd,ms=i(85).Yzm,vs=i(85).Nq1,gs=i(85).Uk6,fs=i(85).dLQ,ys=i(85).e9w,Ss=i(85).J2Z,bs=i(85).ZG6,ws=i(85).unR,Cs=i(85).EIp,Ps=i(85).vnp,Is=i(85).ejZ,xs=i(85).J4z,ks=i(85).rG,Zs=i(85).ZYq,_s=i(85).Au,Ts=i(85).iEt,Ms=i(85).NZz,Fs=i(85).Gnd,As=i(85).nXm,Rs=i(85).swS,Ds=i(85).zaB,Bs=i(85).veG,Os=i(85).fBu,Ns=i(85).v1$,Vs=i(85).JmH,Es=i(85).h$M,Gs=i(85).s3u,Ls=i(85).mYq,Ks=i(85).QSf,Us=i(85).ddU,qs=i(85).MyD,Ws=i(85).jQT,zs=i(85).XnD,Hs=i(85).x3V,Qs=i(85).nmO,$s=i(85).e7B,js=i(85).E3P,Ys=i(85).ij9,Js=i(85).D9J,Xs=i(85).Uww,ta=i(85).qU4,ea=i(85).TuS,ia=i(85).C15,na=i(85).C3o,oa=i(85).X5t,ra=i(85).BQW,sa=i(85).Mt_,aa=i(85).LCr,la=i(85).nxU,da=i(85).Drs,ua=i(85).JJj,ca=i(85).UBi,pa=i(85).kk0,ha=i(85).rUR,ma=i(85).Dkz,va=i(85).wgE,ga=i(85).k9$,fa=i(85).OBh,ya=i(85).pzN,Sa=i(85).MWD,ba=i(85).hd7,wa=i(85).oWD,Ca=i(85).vYD,Pa=i(85).HxR,Ia=i(85).zwt,xa=i(85).vuT,ka=i(85).P3s,Za=i(85).Zij,_a=i(85).qq3,Ta=i(85).QmD,Ma=i(85).P0R,Fa=i(85).ffk,Aa=i(85).P24,Ra=i(85).wfR,Da=i(85).K0Z,Ba=i(85).nx5,Oa=i(85).zwB,Na=(0,b.defineMessages)({[Oa]:{[Ba]:"Property name",id:"database.viewSettings.propertyTab.propertyName"},autofillOffLabel:{[Ba]:"Off",id:"database.viewSettings.propertyTab.autofillOffLabel"},keptUpToDateWithNotionAITooltip:{[Ba]:"Auto-updated by AI",id:"database.tableHeaderCell.tooltipAiAutofillDescription"}});class Va extends d.Z{constructor(){super(...arguments),this.storeTypes={[Da]:c.default[Ra](""),propertyTypeButtonPopupStore:E.Z,newSelectOptionInputStore:L.Z},this.renderLearnAboutRelationsMenuItem=()=>{const{[Aa]:t,[Fa]:e}=this[Ma],i=t[_a][Ta][e];let n;return n=(0,h.isGithubPrRelationProperty)(i)?s()(Ae.Z,{href:(0,B.getLocalizedUrl)("guides.githubRelation"),[Za]:s()(b.FormattedMessage,{[Ba]:"Learn about GitHub Pull Requests",id:"database.viewSettings.propertyTab.githubPrRelation.learnMoreButton.title"}),[ka]:"view_settings_property_github_pr_relation"}):s()(Ae.Z,{href:(0,B.getLocalizedUrl)("guides.relations"),[Za]:s()(b.FormattedMessage,{[Ba]:"Learn about relations",id:xa}),[ka]:Ia}),s()(J.Z,{topBorder:!0},void 0,n)},this.handlePropertyTypeClick=()=>{const{[Pa]:t,[Aa]:e}=this[Ma],i=this[Ca](),n=e[wa]();n&&P[ba]({[Pa]:t,item:{[Sa]:ya,[fa]:i,propertyTypes:(0,M.TP)({[ga]:n[ga](),[Aa]:e,[va]:this[va]}),onAccept:this.handlePropertyTypeAccept}})},this.handleAiAutofillClick=()=>{const{[Pa]:t,[Aa]:e,[Fa]:i}=this[Ma],n=this[Ca]();e[wa]()&&n&&P[ba]({[Pa]:t,item:{[Sa]:"propertyAiAutofill",[fa]:n,[Fa]:i}})},this[ma]=t=>{if(this[ha]())return;const{[Fa]:e,[Aa]:i}=this[Ma],n=this[pa]();if(!n)return;const o=n[ca]()[e];o&&o.name!==t&&(_[ua]({[da]:"CollectionSettingsProperty.handlePropertyNameSubmit",[va]:this[va],[la]:i=>{C.Bv({[wa]:n,[Fa]:e,name:t,[aa]:i})}}),w[sa]({[va]:this[va],[Aa]:i,[Fa]:e,from:ra,[oa]:"rename"}))},this[na]=t=>{const{[Fa]:e,[Aa]:i}=this[Ma],n=this[pa]();n&&(_[ua]({[da]:"CollectionSettingsProperty.handlePropertyIconSubmit",[va]:this[va],[la]:i=>{C.OK({[wa]:n,[Fa]:e,icon:t,[aa]:i})}}),w[sa]({[va]:this[va],[Aa]:i,[Fa]:e,icon:t,from:ra,[oa]:"change_icon"}))},this[ia]=()=>{const{[Aa]:t,formatKey:e}=this[Ma],i=this[ea](),n=t[ta](),o=t[Xs][Ta],r=this[Ca]();if(!r)return;if(!(i&&n&&e&&r))return;const s={...o,[e]:this[Js]().map((t=>t[Fa]===i[Fa]?{...i,[Ys]:!i[Ys]}:t))};_[ua]({[da]:"CollectionSettingsProperty.handleToggleVisibilityClick",[va]:this[va],[la]:e=>{x[js]({[ta]:n,[$s]:{format:s},[aa]:e});const o=this[Qs]();Z[Hs]({[va]:this[va],[Aa]:t,currentIndex:o,entrypoint:zs,[aa]:e,propertyAction:i[Ys]?"hide":"show"})}}),w[Ws]({[va]:this[va],[Aa]:t,[oa]:qs,[Us]:n[Ks](),[Ls]:r[Sa]})},this[Gs]=()=>{const{[Aa]:t}=this[Ma],e=this[Qs]();_[ua]({[da]:"CollectionSettingsProperty.handleFreezeColumns",[va]:this[va],[la]:i=>{e>=0&&Z[Hs]({[va]:this[va],[Aa]:t,currentIndex:e,[aa]:i,entrypoint:zs})}})},this.handleDuplicateClick=async()=>{const{[Fa]:t,[Aa]:e,[Pa]:i,formatKey:n,[Es]:o}=this[Ma],r=this[Js](),s=this[ca](),a=this[pa](),l=e[ta](),d=null==a?void 0:a[Vs]();if(!a||!l||!d)return;const u=this[Ca]();if(!u)return;const c=await(0,F.getDuplicatePropertyUpdate)({[va]:this[va],schema:s,[Fa]:t,[Ns]:r,[Os]:a,spaceId:d});c&&(_[ua]({[da]:"CollectionSettingsProperty.handleDuplicateClick",[va]:this[va],[la]:t=>{x[Bs]({[va]:this[va],[wa]:a,[$s]:{[c.newProperty]:c.newPropertySchema},[aa]:t});const i=this[Qs]();Z[Hs]({[va]:this[va],[Aa]:e,currentIndex:i,entrypoint:zs,[aa]:t,propertyAction:Ds}),c.automationUpdate&&x[Rs]({[va]:this[va],[wa]:a,[$s]:c.automationUpdate,[aa]:t}),n&&k[As]({[Fs]:[l],[$s]:{[n]:c.newProperties},[aa]:t})}}),P.replaceCurrentItem({[Pa]:i,item:{[Sa]:Fa,[Fa]:c.newProperty,formatKey:n,[Es]:o}}),w[Ws]({[va]:this[va],[Aa]:e,[oa]:"duplicate_property",[Us]:null==l?void 0:l[Ks](),[Ls]:u[Sa]}))},this[Ms]=async()=>{const{[Aa]:t,[Fa]:e}=this[Ma];await C.TI({[va]:this[va],[Aa]:t,[Fa]:e,[Ts]:this[Ts],[_s]:this[_s]})},this[Ts]=()=>{const{[Fa]:t,[Aa]:e,[Pa]:i}=this[Ma],n=this[Ca](),o=this[ca](),r=this[pa]();e[ta]()&&n&&(r&&_[Zs]({[va]:this[va],[da]:"CollectionSettingsProperty.handleDeleteAccept",waitForServerCommit:!1,[la]:async i=>{await C.yV({[va]:this[va],[wa]:r,schema:o,[Fa]:t,[aa]:i});const n=this[Qs]();Z[Hs]({[va]:this[va],[Aa]:e,currentIndex:n,entrypoint:zs,[aa]:i,propertyAction:ks})}}),P[xs]({[Pa]:i}),w[Ws]({[va]:this[va],[Aa]:e,[oa]:"delete_property",[Ls]:null==n?void 0:n[Sa]}),w.trackDeleteProperty({[va]:this[va],[Aa]:e,[Ls]:n[Sa],from:ra,[Fa]:t}))},this.handleRollupPropertyMenuChange=t=>{const{[Fa]:e}=this[Ma],i=this[pa]();i&&_[ua]({[da]:"CollectionSettingsProperty.handleRollupPropertyMenuChange",[va]:this[va],[la]:n=>{x[Bs]({[va]:this[va],[wa]:i,[$s]:{[e]:t[fa]},[aa]:n})}})},this.handlePropertyTypeAccept=t=>{const{[Fa]:e,[Aa]:i,[Pa]:n,formatKey:o,[Es]:r}=this[Ma],s=this[pa]();s&&(w[sa]({[va]:this[va],[Aa]:i,[Fa]:e,new_property_type:(0,p.getOriginalPropertyTypeFromPropertyTypeOrDerivedPropertyType)(t),from:ra,[oa]:"change_type"}),"relation"===t?P[ba]({[Pa]:n,item:{[Sa]:"selectRelationSource",[Fa]:e,formatKey:o,[Es]:r}}):(_[ua]({[da]:"CollectionSettingsProperty.handlePropertyTypeAccept",[va]:this[va],[la]:i=>{C.LC({[va]:this[va],[wa]:s,[Fa]:e,[Sa]:t,[aa]:i})}}),P[xs]({[Pa]:n}),(0,p.isDerivedPropertyType)(t)&&I.K7({[ya]:t,[Is]:e,[Aa]:i})),this[Fs].propertyTypeButtonPopupStore.reset())},this[Ps]=this[Cs]((()=>G.default[ws]("freeze_columns")))}didMount(){u.default[bs]((()=>{u.default[bs]((()=>{this.scrollTableCellIntoView()}))}))}renderComponent(){const{[_s]:t}=this,{[Fa]:e,[Aa]:i,selectNameInitial:n,formatKey:r}=this[Ma],l=this[Ca](),d=this[ea](),u=i.permissionScopes[Ta],c=i[ta]();if(!l)return;const m=i[wa]();if(!m)return;const y=r&&("title"!==e||(0,F.propertyFormatAllowsHidingTitle)({viewType:this[Ss](),format:i[Xs][Ta]})),S=this[Qs]()===(null==c?void 0:c[ys]()),w=!this[va].device[fs]&&u[gs]&&"table"===this[Ss]()&&this[Ps][Ta]&&(null==d?void 0:d[Ys]),C=m[vs](),P=Boolean(C&&m.isTypedProperty(e)),I=this[Cs]((()=>Boolean(C&&T.cR(C,e,m)))),x=!(0,h.isGithubPrRelationProperty)(l),k=(0,h.shouldDisablePropertyTypeChange)({[fa]:l,isTypedProperty:P}),Z=M.Tr.includes(l[Sa])&&!(0,p.isNonDuplicatablePropertySchema)(l),_=M.Tr.includes(l[Sa]),R=y||w||Z||_,O="collectionViewBlock"===i.contextType;return a[rs](De.ZP,o()({},this[Ma],{[Za]:s()(b.FormattedMessage,{[Ba]:"Edit property",id:"database.viewSettings.propertyTab.title"}),unconstrainedWidth:O}),s()(J.Z,{},void 0,s()(Be.Z,{initialValue:l.name||"",[ls]:D.default[ms](Na[Oa]),onBlur:this[ma],onSubmit:this[ma],focusInitial:n,selectAll:n,[Da]:this[Fs][Da],inputOuterStyle:O?{[hs]:t[ps]}:void 0,iconButton:{icon:e=>s()(v.ZP,{[Sa]:l[Sa],icon:l.icon,size:16,[_s]:t,[cs]:e}),[us]:{fill:g.IconColorVariationsMap[t.mode][ds]},enforceIconColor:ds,onSubmit:this[na]}}),this[ha]()&&s()(Ea,{[as]:this[Fs][Da][Ta]})),s()(J.Z,{},void 0,x&&this.renderPropertyTypeMenuItem(k,P,C),(0,A.Zt)(this[va])&&this.renderAiAutofillMenuItem(),(0,p.isSelectOrMultiSelectPropertySchema)(l)&&this.renderSelectOptions(l),"status"===l[Sa]&&this.renderStatusOptions(l),"formula"===l[Sa]&&this.renderFormulaOptions(),"rollup"===l[Sa]&&this.renderRollupOptions(),("date"===l[Sa]||"created_time"===l[Sa]||"last_edited_time"===l[Sa])&&this.renderDateOptions(),"relation"===l[Sa]&&this.renderRelationOptions(),"person"===l[Sa]&&this.renderPersonOptions(),this.renderNumberOptions(),"auto_increment_id"===l[Sa]&&this.renderAutoIncrementId()),"button"===l[Sa]&&this.renderButtonOptions(),R&&s()(J.Z,{topBorder:!0},void 0,y&&d&&(null!=d&&d[Ys]?s()(Ht.Z,{icon:f.Z.eyeHidePadded,isPadded:!0,[Za]:s()(b.FormattedMessage,{[Ba]:"Hide in view",id:"database.viewSettings.propertyTab.hideInViewButton.title"}),[ss]:this[ia]}):s()(Ht.Z,{icon:f.Z.eyePadded,isPadded:!0,[Za]:s()(b.FormattedMessage,{[Ba]:"Show in view",id:"database.viewSettings.propertyTab.showInViewButton.title"}),[ss]:this[ia]})),w&&s()(Ht.Z,{icon:S?f.Z.pinStrikethrough:f.Z.pin,[us]:{width:18,height:18,margin:"0px 2px"},[Za]:s()(b.FormattedMessage,S?{[Ba]:"Unfreeze columns",id:"database.viewSettings.propertyTab.unfreezeColumns.title"}:{[Ba]:"Freeze up to column",id:"database.viewSettings.propertyTab.freezeUpToColumn.title"}),[ss]:this[Gs]}),Z&&s()(Ht.Z,{icon:f.Z[Ds],[Za]:s()(b.FormattedMessage,{[Ba]:"Duplicate property",id:"database.viewSettings.propertyTab.duplicateButton.title"}),[ss]:this.handleDuplicateClick}),_&&this.renderDeletePropertyMenuItem(I[Ta],C)),"formula"===l[Sa]&&s()(J.Z,{topBorder:!0},void 0,s()(Ae.Z,{href:(0,B.getLocalizedUrl)("guides.formulas"),[Za]:s()(b.FormattedMessage,{[Ba]:"Learn about formulas",id:"database.viewSettings.propertyTab.formulas.learnMoreButton.title"}),[ka]:"view_settings_property_formula"})),"relation"===l[Sa]&&this.renderLearnAboutRelationsMenuItem(),"rollup"===l[Sa]&&s()(J.Z,{topBorder:!0},void 0,s()(Ae.Z,{href:(0,B.getLocalizedUrl)("guides.relations"),[Za]:s()(b.FormattedMessage,{[Ba]:"Learn about rollups",id:"database.viewSettings.propertyTab.rollups.learnMoreButton.title"}),[ka]:"view_settings_property_relation"})))}renderPropertyTypeMenuItem(t,e,i){const{propertyTypeButtonPopupStore:n}=this[Fs],r=this[Ma][Aa][os](),l=this[Ca](),d=qn(r,l);if(!l)return;const u=null==d?void 0:d.getIcon(),{[_s]:c}=this,p=(0,h.isGoogleDriveRelationProperty)(l)||(0,h.isFigmaRelationProperty)(l);return s()(Dr.Z,{placement:Dr.Z[ns].Left,disableTooltip:!t,[Wr]:t=>e?a[rs](b.FormattedMessage,o()({},t,{[Ba]:"{type} type is required for this property in {databaseType}.",id:"database.viewSettings.propertyTab.restrictedProperty",values:{[Sa]:M.SO[l[Sa]],databaseType:(0,R.r1)(i)}})):a[rs](b.FormattedMessage,o()({},t,{[Ba]:"{type}'s type cannot be changed.",id:"database.viewSettings.propertyTab.untypedRestrictedProperty",values:{[Sa]:M.SO[l[Sa]]}})),render:e=>a[rs](Ht.Z,o()({},e,{[jr]:t,rotateChevron:n[Ta].open,[Za]:s()(b.FormattedMessage,{[Ba]:"Type",id:"database.viewSettings.propertyTab.propertyType"}),showChevron:!0,right:a[rs](a[zr],null,t?a[rs]("div",e,f.Z.lockedFilled({width:14,fill:c[is]})):s()(v.ZP,{[Sa]:l[Sa],icon:void 0,size:16,[_s]:c}),s()(Rr.Z,{size:4}),p?s()("div",{[cs]:{color:t?c[es]:void 0,[ts]:Xr,[Jr]:Yr}},void 0,s()(Fr.Z,{icon:u,isEmptyPage:!1,size:20,[jr]:!0}),s()(Ar.Z,{store:d,[cs]:{[ts]:$r,wordBreak:Qr,...S.Z[Hr]}})):s()("span",{[cs]:{color:t?c[es]:void 0}},void 0,M.SO[l[Sa]])),[ss]:this.handlePropertyTypeClick}))})}renderAiAutofillMenuItem(){var t,e,i,n,o;const r=this[Ca]();if(!r||!(0,p.isAiAutofillablePropertySchema)(r)||"translate"===(null===(t=r[qr])||void 0===t?void 0:t[Sa])&&!(0,A.hu)())return;let a;return"summarize"===(null===(e=r[qr])||void 0===e?void 0:e[Sa])?a=A.Dr.autofillSummary:"extract"===(null===(i=r[qr])||void 0===i?void 0:i[Sa])?a=A.Dr.autofillExtract:"custom"===(null===(n=r[qr])||void 0===n?void 0:n[Sa])?a=A.Dr.autofillCustom:"translate"===(null===(o=r[qr])||void 0===o?void 0:o[Sa])?a=A.Dr.autofillTranslate:void 0===r[qr]?a=Na.autofillOffLabel:(0,y.unreachable)(r[qr]),s()(Ht.Z,{[Za]:s()("div",{[cs]:{[ts]:Xr,[Ur]:"row",[Jr]:Yr}},void 0,s()(b.FormattedMessage,{[Ba]:"AI autofill",id:"database.viewSettings.propertyTab.aiAutofill.open"}),s()(Mr.Z,{[cs]:{[ts]:Kr}})),showChevron:!0,right:D.default[ms](a),[ss]:this.handleAiAutofillClick})}renderSelectOptions(t){const{[Aa]:e,[Fa]:i}=this[Ma];return s()(cr,{[Aa]:e,[Fa]:i,[jr]:!1})}renderStatusOptions(t){var e;const{[Aa]:i,[Fa]:n}=this[Ma],o=T.Hw(null===(e=i[wa]())||void 0===e?void 0:e[vs](),i[_a][Ta],n);return a[rs](a[zr],null,o?null:s()(Tr,{[Aa]:i,[Fa]:n,[jr]:o}),s()(cr,{[Aa]:i,[Fa]:n,[jr]:o}))}renderRollupOptions(){const{[Fa]:t}=this[Ma],e=this[pa](),i=this[ca]();if(!e)return;const n=Boolean(e[vs]()&&e.isTypedProperty(t));return s()(Or.Z,{[jr]:n,context:Or.t.ViewSettings,[Fa]:t,schema:i,[ka]:ra,[Os]:e,onChange:this.handleRollupPropertyMenuChange})}renderFormulaOptions(){const{[Aa]:t,[Fa]:e}=this[Ma];return s()(Fe,{[Aa]:t,[Fa]:e})}renderDateOptions(){const{[Aa]:t,[Fa]:e}=this[Ma];return s()(Bt,{[Aa]:t,[Fa]:e})}renderNumberOptions(){const{[Aa]:t,[Fa]:e}=this[Ma],i=this[Ca]();if(i)return"number"===i[Sa]||"formula"===i[Sa]||"rollup"===i[Sa]?s()(xn,{[Aa]:t,[Fa]:e}):void 0}renderRelationOptions(){const{[Aa]:t,[Fa]:e}=this[Ma],i=t[_a][Ta][e];return(0,h.isGithubPrRelationProperty)(i)?s()(q.Z,{[Aa]:t,[Fa]:e}):s()(Un,{[Aa]:t,[Fa]:e})}renderPersonOptions(){const t=this.renderLimitOptions(),e=(G.default[ws]("default_person_property")||(0,N.iL)())&&this.renderDefaultPersonPicker();return a[rs](a[zr],null,t,e)}renderDefaultPersonPicker(){const{[Aa]:t,[Fa]:e}=this[Ma],i=this[Ca]();if(i&&"person"===i[Sa])return s()(Ut,{[Aa]:t,[fa]:i,[Fa]:e})}renderButtonOptions(){const{[Aa]:t,[Fa]:e}=this[Ma],i=this[Ca]();if(i&&"button"===i[Sa])return s()(lt,{[Aa]:t,[fa]:i,[Is]:e})}renderLimitOptions(){const{[Aa]:t,[Fa]:e}=this[Ma],i=this[Ca]();if(i)return s()(Re.C,{[Aa]:t,[fa]:i,[Fa]:e})}renderAutoIncrementId(){const{[Aa]:t,[Fa]:e}=this[Ma],i=this[Ca]();if(i&&"auto_increment_id"===i[Sa]){var n;const o=null===(n=t[wa]())||void 0===n?void 0:n.getRecordKeyStore(),r=null==o?void 0:o.getRecordKey();return s()(U.Z,{uniqueIdProperty:{[Is]:e,[fa]:i},prefixValue:r,[Aa]:t})}}renderDeletePropertyMenuItem(t,e){return s()(Dr.Z,{disableTooltip:!t,placement:Dr.Z[ns].Left,[Wr]:t=>(0,R.A7)(e,t),render:i=>a[rs](Ht.Z,o()({},i,{isRed:!0,[jr]:t,[ss]:this[Ms],icon:()=>t?a[rs]("div",o()({},i,{[cs]:{[ts]:Lr}}),f.Z.lockedFilled({width:14,[Gr]:4,[Er]:4})):f.Z.trash({width:14,[Gr]:4,[Er]:4}),[Za]:s()(b.FormattedMessage,{[Ba]:"Delete property",id:"database.viewSettings.propertyTab.deleteButton.title"}),caption:this[va].device[fs]&&t?(0,R.A7)(e):null}))})}[pa](){const{[Aa]:t,[Es]:e}=this[Ma],i=t[os]();if(i)return K.NW.createChildStore(i,e)}[ca](){var t;return(null===(t=this[pa]())||void 0===t?void 0:t[ca]())||{}}[Ca](t){const e=t||this[Ma],{[Fa]:i}=e;return this[ca]()[i]}[ea](){const{[Fa]:t}=this[Ma],e=this[Js]();return null==e?void 0:e.find((e=>e[Fa]===t))}[Js](){const{formatKey:t,[Aa]:e}=this[Ma];if(!t)return[];return e[Xs][Ta][t]||[]}[Qs](){const{[Fa]:t}=this[Ma],e=this[Js]();if(0===e.length)return-1;return e.filter((t=>t[Ys])).findIndex((e=>e[Fa]===t))}[ha](){const{[Fa]:t}=this[Ma],{[Da]:e}=this[Fs],i=this[ca](),n=e[Ta],o=Object.keys(i).find((e=>{var o;return e!==t&&(null===(o=i[e])||void 0===o?void 0:o.name)===n}));return Boolean(o)}[Ss](){const{[Aa]:t}=this[Ma],e=t.getViewType();if(!e)throw new Error(Vr);return e}scrollTableCellIntoView(){const{[Fa]:t,[Aa]:e}=this[Ma],i=e[ta]();if(!i||"table"!==i[Ks]())return;const n=V.Z.findTableHeaderCell(e,t);if(!n)return;const o=l.findDOMNode(n),r=l.findDOMNode(this);if(!o||!r)return;const s=(0,O.xH)(o);if(!s)return;const a=r[Nr](),d=o[Nr]().right+20-a.left;s.scrollLeft=s.scrollLeft+d}}function Ea(t){return s()(Br.Z,{isMultiline:!0,[cs]:{paddingTop:8,[Gr]:16,[Er]:16,color:m.ZP.red,...t.styles}},void 0,s()(b.FormattedMessage,{id:"database.viewSettings.propertyTab.duplicatePropertyNameError",[Ba]:"A property named {propertyName} already exists in this database.",values:{[as]:t[as]}}))}Va.displayName=zs;const Ga=(0,b.injectIntl)(Va)},79892:(t,e,i)=>{i.d(e,{Z:()=>C});var n=i(77094),o=i.n(n),r=i(67294),s=i(480),a=i(81954),l=i(24405),d=i(15145),u=i(82990),c=i(5366),p=i(84210),h=i(42917),m=i(84076),v=i(31278),g=i(76798);const f=i(85).AIq,y=i(85).D7I,S=i(85).nx5,b=i(85).Uie,w=i(85).sei;function C(t){window.__c={n:"CollectionSettingsRelationTarget"};const{isSelfRelation:e,collectionStore:i,showAs:n,disabled:C,onClick:P}=t,I=(0,a.VK)((()=>Boolean(i)),[i]),x=(0,a.VK)((()=>null==i?void 0:i.getIcon()),[i]),k=(0,a.VK)((()=>{if(e)return;const t=null==i?void 0:i.getParentBlockStore();return t&&(0,p.ZP)({store:t,pageVisitSource:d.tY.LinkInPage})}),[i,e]),Z=(0,s.Fy)(),_=(0,l.yK)((t=>({linkBox:{display:"flex",alignItems:"center"},linkTitle:{color:t.regularTextColor,fontWeight:u.Z.fontWeight.semibold,fontSize:14,marginLeft:4*(Z.isRetina?.5:1),wordBreak:w,...u.Z[b]},chevronTitle:{display:"inline",wordBreak:w,...u.Z[b]}})),[Z]),T=o()(v.Z,{icon:x,isEmptyPage:!1,size:20,disabled:!0});return o()(h.Z,{title:o()(c.FormattedMessage,{[S]:"Related to",id:"database.viewSettings.editRelation.targetLink.title"}),showChevron:"chevron"===n,onClick:P,disabled:C,right:e?o()(c.FormattedMessage,{[S]:"This database",id:"database.viewSettings.editRelation.selfRelationTarget.title"}):"link"===n&&k?o()(m.Z,{href:k,innerStyle:_.linkBox},void 0,T,o()(g.Z,{store:i,underline:!0,style:_.linkTitle,maxLength:15})):I?r[y](r.Fragment,null,T,o()(g.Z,{store:i,style:_.chevronTitle})):o()(c.FormattedMessage,{[S]:"No target",id:"database.viewSettings.editRelation.noTarget.title"}),rightStyle:{[f]:1},textWrapperStyle:{[f]:0}})}},37709:(t,e,i)=>{i.d(e,{P:()=>_e,Z:()=>Me});var n=i(97464),o=i.n(n),r=i(77094),s=i.n(r),a=i(96486),l=i(67294),d=i(83355),u=i(49085),c=i(3909),p=i(51454),h=i(5366),m=i(77162),v=i(90985),g=i(5149),f=i(64434),y=i(24677),S=i(98104),b=i(97004),w=i(68641),C=i(13273),P=i(34859),I=i(61766),x=i(54634),k=i(28398),Z=i(58814),_=i(97774),T=i(82990),M=i(33338),F=i(44532);const A=i(85).nx5,R=i(85).Uie,D=i(85).mSd,B=i(85).OP1,O=i(85).PXg,N=i(85).TtP,V=i(85).qq3,E=i(85)._lc,G=i(85).rMr,L=i(85).Kol,K=i(85).Xl2,U=i(85).wgE,q=i(85).jQT,W=i(85).b8T,z=i(85).Gnd,H=i(85).P24,Q=i(85).wfR,$=i(85).HxR;class j extends d.Z{constructor(){super(...arguments),this.storeTypes={[$]:u.default[Q]({open:!1,stack:[]})},this.renderPopup=()=>{const{[H]:t}=this.props,{[$]:e}=this[z];return s()(x.P,{context:w.HV.FilterBar,[H]:t,[$]:e,hideDesktopHeader:!0})},this[W]=()=>{const{[H]:t}=this.props,{[$]:e}=this[z];m[q]({[U]:this[U],[H]:t,action:"click_sort"}),g[K]({[$]:e,item:{type:"sort"}})},this[L]=t=>{if(t&&(0,C.yT)(t.target))return;const{[$]:e}=this[z];g[G]({[$]:e})}}willUnmount(){g[G]({[$]:this[z][$]})}renderComponent(){const{device:t}=this[U],{[$]:e}=this[z];return s()(F.ZP,{popupType:t.isMobile?F.ZP[E].SlideUp:F.ZP[E].Popup,open:e.state.open,origin:this.renderOrigin(),onDismiss:this[L],disableMouseCapture:!0,enableOutsideClickDismiss:!0,originGap:4,render:this.renderPopup})}renderOrigin(){const{[H]:t}=this.props,e=t.currentSortsStore.state,i=t.localStateDiffStore.state,n=e[0],o=t.permissionScopes.state,r=t[V].state,a=n?r[n.property]:void 0;let l;return l=1===e[N]?n&&"descending"===n.direction?c.Z.arrowDownThick({width:12,[O]:4,fill:this.theme[B]}):c.Z.arrowUpThick({width:12,[O]:4,fill:this.theme[B]}):c.Z.arrowsUpDown({width:16,[O]:4,fill:this.theme[B]}),s()(M.Z,{on:!0,hasDiff:Boolean(o[D]&&i.sorts),icon:l,title:s()("span",{style:{marginTop:-1,maxWidth:220,...T.Z[R]}},void 0,1===e[N]&&a?a.name:s()(h.FormattedMessage,{[A]:"{sortCount} sorts",id:"database.filterBar.sorts.label",values:{sortCount:e[N]}})),onClick:this[W]})}}j.displayName="CollectionViewFilterBarSort";const Y=(0,h.injectIntl)(j);var J=i(68689),X=i(23063),tt=i(37601),et=i(79131),it=i(21199),nt=i(1743),ot=i(74194),rt=i(89728),st=i(18647);const at=i(85).Ieo,lt=i(85).wuN,dt=i(85).sI1,ut=i(85).dU4,ct=i(85).kdC,pt=i(85).Dd5,ht=i(85).cZW,mt=i(85).Yzm,vt=i(85).raT,gt=i(85).Hco,ft=i(85).JLj,yt=i(85).lf7,St=i(85).nx5,bt=i(85).dLQ,wt=i(85).PXg,Ct=i(85).X_m,Pt=i(85).Au,It=i(85).dMt,xt=i(85).oBh,kt=i(85).u9,Zt=i(85).XGW,_t=i(85).S2v,Tt=i(85).TN,Mt=i(85).g7N,Ft=i(85).JTA,At=i(85).BQM,Rt=i(85).XNW,Dt=i(85).BQ6,Bt=i(85).tBn,Ot=i(85).D7I,Nt=i(85).k1W,Vt=i(85).J7Q,Et=i(85).$XE,Gt=i(85).Mm1,Lt=i(85)._V5,Kt=i(85).jkI,Ut=i(85).H1U,qt=i(85).EMU,Wt=i(85).sM5,zt=i(85).gGi,Ht=i(85).Jkr,Qt=i(85).vwl,$t=i(85).mSd,jt=i(85).rQ1,Yt=i(85).GwZ,Jt=i(85).E6w,Xt=i(85).E0z,te=i(85).EIp,ee=i(85).oh7,ie=i(85).b8T,ne=i(85).vHy,oe=i(85).xQb,re=i(85).EiQ,se=i(85).uzK,ae=i(85).ogH,le=i(85).QmD,de=i(85).Vkz,ue=i(85).piL,ce=i(85).Wp_,pe=i(85).Zj$,he=i(85).rMr,me=i(85).nm$,ve=i(85).Kol,ge=i(85).Xl2,fe=i(85).X5t,ye=i(85).wgE,Se=i(85).jQT,be=i(85).Gnd,we=i(85).HxR,Ce=i(85).Gm5,Pe=i(85).P0R,Ie=i(85).P24,xe=i(85).tuI,ke=i(85).uKQ,Ze=i(85).wfR;let _e;!function(t){t[t.FilterBar=0]="FilterBar",t[t[at]=1]=at}(_e||(_e={}));class Te extends d.Z{constructor(){super(...arguments),this.storeTypes={createFilterSettingsStore:u.default[Ze]({open:!1,stack:[]}),[ke]:I.Z},this[xe]=t=>{const{[Ie]:e}=this[Pe];return s()(_.Z,{id:t.id,[Ce]:_e.FilterBar,[Ie]:e,[we]:e.getFilterBarItemSettingsStore(t)},t.id)},this.renderViewSettingsPopup=()=>{const{[Ie]:t}=this[Pe],{createFilterSettingsStore:e}=this[be];return s()(x.P,{[Ce]:w.HV.FilterBar,[Ie]:t,[we]:e,hideDesktopHeader:!0})},this.handleNewFilterPopupClick=()=>{const{[Ie]:t}=this[Pe],{createFilterSettingsStore:e}=this[be];m[Se]({[ye]:this[ye],[Ie]:t,[fe]:"click_new_filter"}),g[ge]({[we]:e,item:{type:"createFilter"}})},this[ve]=t=>{const{createFilterSettingsStore:e}=this[be];t&&(0,C.yT)(t[me])||g[he]({[we]:e})},this.handleSearchClick=()=>{const{[Ie]:t}=this[Pe];S.clear(this[ye]),y.clear(this[ye]),f[pe](),t.searchOpen[ce](!0),t[ue][ce](""),m[Se]({[ye]:this[ye],[Ie]:t,[fe]:"click_mobile_search"})},this[de]=t=>{const{[Ie]:e}=this[Pe];e[ue][ce](t[me].value)},this.handleSearchBlur=()=>{const{[Ie]:t}=this[Pe];t[ue][le]||this[ae]()},this[ae]=()=>{const{[Ie]:t}=this[Pe];t.searchOpen[ce](!1),t[ue][ce]("")},this.handleFiltersDrop=t=>{const{[Ie]:e}=this[Pe];if(!e[se]())return;const i=e[re][le],n=a.compact(t.map((t=>i.find((e=>e.id===t)))));v[oe]({[ye]:this[ye],[Ie]:e,[ne]:{...e[ne][le],propertyFilters:{value:n}}}),m[Se]({[ye]:this[ye],[Ie]:e,[fe]:"reorder_filters"})},this[ie]=t=>{const{[Ie]:e}=this[Pe];e.filtersBarOpen[ce](!0)},this[ee]=this[te]((()=>{const{[Ie]:t}=this[Pe];return(0,b.Nq)(t)}))}renderComponent(){const{[Ie]:t}=this[Pe],{[Xt]:e}=this[Ce][ye],{[Jt]:i}=e,n=i&&t.searchOpen[le],o=t[re][le],r=t.currentSortsStore[le],a=this[ee][le],d=this[Pe][Ie].shouldShowSource[le]?8:12,u=t[Yt][le].open,c=r.length>0||u,h=t[jt][le][$t]?t[Qt][le]:void 0;return s()("div",{[Dt]:{[Ht]:zt,zIndex:p.collectionFilterBar},onClick:this[ie]},void 0,s()("div",{[Dt]:{[Wt]:qt,[Ut]:Kt}},void 0,n&&this.renderMobileSearchInput(),!n&&s()("div",{[Dt]:{position:"relative",flexGrow:0,overflow:"hidden"}},void 0,s()(st.Z,{type:P.Z.X,[Dt]:{[Wt]:"flex",[Ut]:"center",[Lt]:d,[Gt]:e[Jt]?12:8},showLeftRightOverlay:!e[Jt]},void 0,i?l[Ot](l[Bt],null,this.renderMobileSearchButton(),c&&this.renderSort(),c&&!e[Jt]&&this[Et](),h&&this[Vt](),this.renderPropertyFilters(o),this[Nt]()):l[Ot](l[Bt],null,c&&this.renderSort(),c&&!e[Jt]&&this[Et](),h&&this[Vt](),this.renderPropertyFilters(o),this[Nt]()))),s()("div",{[Dt]:{[Wt]:qt,[Ut]:Kt,[Lt]:4,[Rt]:"auto"}},void 0,!i&&a&&this[At](),!i&&this[Ft]())),i&&!n&&s()("div",{[Dt]:{[Wt]:"flex",[Ut]:"center",[Mt]:4}},void 0,a&&this[At](),this[Ft]()))}[At](){const{[Ie]:t,[Tt]:e}=this[Pe];return s()(k.ZP,{[Ce]:k.R1.FilterBar,[Ie]:t,[Tt]:e,[_t]:this[be][ke]})}renderPropertyFilters(t){const{[Ie]:e}=this[Pe];if(e[jt][le][$t]){const e=t.map((t=>t.id));return s()(et.ZP,{direction:Zt,keys:e,disableVerticalEdgeScroll:!0,[kt]:!0,renderKey:e=>{const i=t.find((t=>t.id===e));if(i)return this[xe](i)},[Dt]:{[Wt]:qt,flexShrink:0},onDrop:this.handleFiltersDrop})}return t.map(this[xe])}[Vt](){const{[Ie]:t}=this[Pe];return s()(Z.Z,{[Ce]:_e.FilterBar,[we]:t[xt],[Ie]:t})}renderSort(){const{[Ie]:t}=this[Pe];return s()(Y,{[Ie]:t,[we]:t[Yt]},"sort")}[Et](){return s()("div",{[Dt]:{borderRight:`1px solid ${this[Pt][It]}`,[Ct]:24,[wt]:12,[Rt]:8}})}[Nt](){const{[Tt]:t}=this[Pe],e=this[be].createFilterSettingsStore[le].open,i=t[le]||e;return s()(F.ZP,{open:e,popupType:this[ye][Xt][bt]?F.kQ.SlideUp:F.kQ.Popup,origin:s()(X.Z,{isVisible:!0,animationStyle:{opacity:i?1:0},render:()=>s()(rt.Z,{icon:c.Z.plus,isSmall:!0,isLightGray:!0,hovered:e,onClick:this.handleNewFilterPopupClick,[Dt]:{fontSize:14}},void 0,s()(h.FormattedMessage,{[St]:"Add filter",id:"database.filterBar.addButton.title"}))}),render:this.renderViewSettingsPopup,disableMouseCapture:!0,enableOutsideClickDismiss:!0,originGap:4,onDismiss:this[ve]})}[Ft](){const{[Ie]:t}=this[Pe],e=t[yt][le];if(e)return s()(J.v,{[Ie]:t,completeSprintAutomationContext:e})}renderMobileSearchInput(){const{[Ie]:t,intl:e}=this[Pe],i=t[ue][le];return s()(nt.Z,{capture:!0},void 0,s()(it.Z,{capture:!0,render:t=>l[Ot]("div",o()({},t,{[Dt]:{[Ht]:zt,[Lt]:this[ye][Xt][bt]?8:12,[Gt]:6}}),s()(M.Z,{[ut]:{[Ht]:zt},[dt]:{[Ht]:zt},icon:c.Z[ft]({[Ht]:14,fill:this[Pt][gt],[wt]:6}),hideChevron:!0,title:l[Ot](l[Bt],null,s()(ot.Z,{format:ot.B[vt],value:i,[ht]:e[mt]({[St]:"Type to search…",id:"database.filterBar.mobileSearch.placeholder"}),[pt]:this[de],autoComplete:"on",autoCorrect:"on",onBlur:this.handleSearchBlur,onClearButtonClick:this[ae],[ct]:!0,focus:!this[ye][Xt].isIOS||void 0,focusInitial:!0,inputStyle:{[Ct]:zt}}),s()(tt.Z,{show:!0}))}))}))}renderMobileSearchButton(){return s()(M.Z,{[ut]:{[Wt]:qt,[Ut]:Kt},icon:c.Z[ft]({[Ht]:14,fill:this[Pt][gt],[wt]:6}),hideChevron:!0,title:s()("span",{[Dt]:{marginTop:-1,color:this[Pt][lt]}},void 0,s()(h.FormattedMessage,{[St]:"Search",id:"database.filterBar.search.title"})),onClick:this.handleSearchClick},"search")}}Te.displayName="CollectionViewFilterBar";const Me=(0,h.injectIntl)(Te)},58814:(t,e,i)=>{i.d(e,{Z:()=>z});var n=i(77094),o=i.n(n),r=(i(67294),i(83355)),s=i(49085),a=i(3909),l=i(82990),d=i(5366),u=i(77162),c=i(90985),p=i(5149),h=i(68641),m=i(13273),v=i(54634),g=i(33338),f=i(44532);const y=i(85).vwl,S=i(85).nx5,b=i(85).B84,w=i(85).yKA,C=i(85)._lc,P=i(85).dLQ,I=i(85).T5E,x=i(85).EIp,k=i(85).ltl,Z=i(85).QmD,_=i(85).vHy,T=i(85).xQb,M=i(85).TtP,F=i(85).Lyb,A=i(85).rMr,R=i(85).Kol,D=i(85).wgE,B=i(85).jQT,O=i(85).eiN,N=i(85).Xl2,V=i(85).TSg,E=i(85).b8T,G=i(85).Gnd,L=i(85).P0R,K=i(85).P24,U=i(85).wfR,q=i(85).HxR;class W extends r.Z{constructor(){super(...arguments),this.storeTypes={[q]:s.default[U]({open:!1,stack:[]})},this.renderPopup=()=>{const{[K]:t}=this[L],{[q]:e}=this[G];return o()(v.P,{context:h.HV.FilterBar,[K]:t,[q]:e,hideDesktopHeader:!0})},this[E]=()=>{const{[K]:t}=this[L],{[q]:e}=this[G];this[V]()&&(p[N]({[q]:e,item:{type:O}}),u[B]({[D]:this[D],[K]:t,action:"click_combinator_filter"}))},this[R]=t=>{var e;if(t&&(0,m.yT)(t.target))return;const{[K]:i}=this[L],{[q]:n}=this[G];p[A]({[q]:n});const o=this[V]();o&&0===(null===(e=o[F])||void 0===e?void 0:e[M])&&c[T]({[D]:this[D],[K]:i,[_]:{...i[_][Z],[k]:{value:void 0}}})},this.hasFilterDiff=this[x]((()=>{const{[K]:t}=this[L],e=t[I][Z];return Boolean(e[k])}))}willUnmount(){p[A]({[q]:this[G][q]})}renderComponent(){const{device:t}=this[D],{[q]:e}=this[G];return o()(f.ZP,{popupType:t[P]?f.ZP[C].SlideUp:f.ZP[C].Popup,open:e[Z].open,origin:this.renderOrigin(),onDismiss:this[R],disableMouseCapture:!0,enableOutsideClickDismiss:!0,originGap:4,render:this.renderPopup})}renderOrigin(){var t;const{[D]:e}=this,i=this[V]();if(i)return o()(g.Z,{icon:a.Z[O]({width:void 0,height:e.device[P]?14:12,fill:this.theme.blueColor,marginRight:6}),title:o()("span",{style:this[w]()},void 0,o()(d.FormattedMessage,{[S]:b,id:"database.filterBar.advancedFilterRulesCount.title",values:{ruleCount:(null===(t=i[F])||void 0===t?void 0:t[M])||0}})),on:!0,hasDiff:this.hasFilterDiff[Z],onClick:this[E]},"combinator")}[V](){return this[L][K][y][Z]}[w](){return{maxWidth:180,...l.Z.textOverflowStyle}}}W.displayName="CollectionViewFilterBarCombinatorFilter";const z=(0,d.injectIntl)(W)},97774:(t,e,i)=>{i.d(e,{Z:()=>de});var n=i(97464),o=i.n(n),r=i(77094),s=i.n(r),a=i(67294),l=i(83355),d=i(49085),u=i(76205),c=i(39068),p=i(82990),h=i(5366),m=i(77162),v=i(90985),g=i(5149),f=i(93959),y=i(97004),S=i(75079),b=i(13273),w=i(29987),C=i(19777),P=i(37709),I=i(33338),x=i(96486),k=i.n(x),Z=i(15070),_=i(99036),T=i(40506),M=i(76725),F=i(23014),A=i(21202),R=i(77420),D=i(6287),B=i(19889),O=i(97880),N=i(7928),V=i(17335),E=i(29376),G=i(39098),L=i(76798),K=i(89845);const U=i(85).QhS,q=i(85).uOK,W=i(85).jtM,z=i(85).sM5,H=i(85).TLr,Q=i(85).uM3,$=i(85).uye,j=i(85).mUE,Y=i(85).ChN,J=i(85).Io9,X=i(85).BDY,tt=i(85)._tz,et=i(85).$Vf,it=i(85).ffk,nt=i(85).fBu,ot=i(85).EIp,rt=i(85).WDI,st=i(85).nx5,at=i(85).NLk,lt=i(85).vCJ;class dt extends l.Z{constructor(){super(...arguments),this[lt]=t=>s()("span",{style:{[at]:"pre"}},t,s()(h.FormattedMessage,{[st]:", ",id:"database.filterValue.commaSeparator"})),this[rt]=this[ot]((()=>{const{schema:t,propertyFilter:e,[nt]:i}=this.props,n=t[e[it]];if(n&&(0,_.isRelationPropertySchema)(n))return(0,E.getRelatedCollectionAppConfigUri)(n,i)}))}renderComponent(){const{valueOnly:t,propertyFilter:e,style:i}=this.props,{filter:n}=e,o=(0,u.a_)(n)?n[et]:n,r=(0,u.h6)(o)&&!(0,u.mv)(n),a={...i,maxWidth:void 0};return s()("span",{style:(0,u.gE)(o)?a:i},void 0,s()(h.FormattedMessage,{[st]:"{propertyName}{colonSeparator} {filterOperator} {propertyValue}",id:"database.filterBarFilterValue.title",values:{[tt]:t?void 0:this[X](),colonSeparator:t||r?void 0:":",filterOperator:this.renderFilterOperator(),[J]:this.renderValue()}}))}[X](){const{propertyFilter:t,schema:e}=this.props,i=e[t[it]];if(i)return s()("span",{style:{[Y]:p.Z[Y].medium}},void 0,i.name)}renderFilterOperator(){const{propertyFilter:t}=this.props,{filter:e}=t,i=(0,u.a_)(e)?e[et]:e;if((0,u.Ly)(i))return"string_contains"===i[j]||"string_is"===i[j]?void 0:"string_does_not_contain"===i[j]||"string_is_not"===i[j]?this[$]():(0,V.WC)(i[j]);if((0,u.h6)(i))return(0,V.WC)(i[j]);if((0,u.XA)(i)){if("checkbox_is_not"===i[j])return this[$]()}else{if((0,u.dx)(i))return"enum_is"===i[j]?void 0:"enum_is_not"===i[j]?this[$]():(0,V.WC)(i[j]);if((0,u.NU)(i))return"enum_contains"===i[j]?void 0:"enum_does_not_contain"===i[j]?this[$]():(0,V.WC)(i[j]);if((0,u.r2)(i))return"status_is"===i[j]?void 0:"status_is_not"===i[j]?this[$]():(0,V.WC)(i[j]);if((0,u.e)(i))return"relation_contains"===i[j]?void 0:"relation_does_not_contain"===i[j]?this[$]():(0,V.WC)(i[j]);if((0,u.Gb)(i))return"person_contains"===i[j]?void 0:"person_does_not_contain"===i[j]?this[$]():(0,V.WC)(i[j]);if((0,u.Mp)(i)){if("location_is"===i[j])return;if("location_is_not"===i[j])return this[$]()}else if((0,u.gE)(i)){if("date_is"===i[j])return;if("date_is_after"===i[j])return s()(h.FormattedMessage,{[st]:"After",id:"database.filterValue.dateType.dateIsAfter.title"});if("date_is_before"===i[j])return s()(h.FormattedMessage,{[st]:"Before",id:"database.filterValue.dateType.dateIsBefore.title"});if("date_is_on_or_after"===i[j])return s()(h.FormattedMessage,{[st]:"On or after",id:"database.filterValue.dateType.dateIsOnOrAfter.title"});if("date_is_on_or_before"===i[j])return s()(h.FormattedMessage,{[st]:"On or before",id:"database.filterValue.dateType.dateIsOnOrBefore.title"});if(!(0,u.TQ)(i))return(0,V.WC)(i[j]);{const t=i.value;if(!t.value||"exact"!==t.type||!(0,T.isPartialDateRange)(t.value))return(0,V.ip)(t);if(t.value.start_date&&t.value.end_date)return;if(t.value.start_date)return s()(h.FormattedMessage,{[st]:"Starting",id:"database.filterValue.dateType.starting.title"});if(t.value.end_date)return s()(h.FormattedMessage,{[st]:"Ending",id:"database.filterValue.dateType.ending.title"})}}else{if((0,u.Jw)(i))return"verification_is"===i[j]?void 0:"verification_is_not"===i[j]?this[$]():(0,V.WC)(i[j]);(0,O.unreachable)(i)}}}[$](){return s()(h.FormattedMessage,{[st]:"Not",id:"database.filterBarFilterValue.notOperator"})}renderValue(){const{propertyFilter:t,schema:e,intl:i,[nt]:n}=this.props,{filter:o}=t,r=(0,u.a_)(o)?o[et]:o;if((0,u.vR)(r))if((0,u.Ly)(r)||(0,u.h6)(r)){const t=r.value.value;if(void 0!==t)return s()("span",{},void 0,t)}else if((0,u.XA)(r)){const t=r.value.value;if(!0===t)return s()("span",{},void 0,s()(h.FormattedMessage,{[st]:"Checked",id:"database.filterValue.checkboxType.checked.title"}));if(!1===t)return s()("span",{},void 0,s()(h.FormattedMessage,{[st]:"Unchecked",id:"database.filterValue.checkboxType.unchecked.title"}))}else{if((0,u.dx)(r)||(0,u.NU)(r)){const t=(0,u.dx)(r)?(0,u.mg)(r):(0,u.qC)(r),e=k()[Q](t.map((t=>{let{value:e}=t;return e})));if(0===e.length)return;return s()("span",{},void 0,(0,M.Z)(e,this[lt]))}if((0,u.r2)(r)){const t=(0,u.wB)(r),e=k()[Q](t.map((t=>{let{value:e}=t;return e})));if(0===e.length)return;return s()("span",{},void 0,(0,M.Z)(e,this[lt]))}if((0,u.e)(r)){const t=(0,u.YO)(r),e=k()[Q](t.map((t=>{if(!t.value)return;const e=t.type;if("exact"===e){const e=G.G[H](n,{table:A.iU,id:t.value});return s()(L.Z,{style:{[z]:W},store:e})}if("relative"===e){var i,o;const e=this[rt].state;if(!e)return;return s()("span",{},void 0,null===(i=F.qB[e])||void 0===i||null===(o=i[t.value.variable])||void 0===o?void 0:o.formattedMessage)}(0,O.unreachable)(e)})));return(0,M.Z)(e,this[lt])}if((0,u.Gb)(r)){const t=(0,u.R8)(r),e=k()[Q](t.map((t=>{if("relative"===t.type)return s()("span",{},void 0,s()(h.FormattedMessage,{[st]:"Me",id:q}));if(t.value){const e=t.value;if(e.table===B.KJ){const t=G.t1[H](n,{table:e.table,id:e.id});return s()("span",{},void 0,(0,N.Nz)(i,t[U]()))}if(e.table===R.cZ){const t=G.t1[H](n,{table:e.table,id:e.id});return s()("span",{},void 0,(0,Z.Mh)(t[U]()))}}})));return(0,M.Z)(e,this[lt])}if((0,u.Mp)(r)){const t=(0,u.u0)(r),e=k()[Q](t.map((t=>{if(t.value){const e=t.value,i=G.t1[H](n,{table:D.v,id:e});return s()(L.Z,{style:{[z]:W},store:i})}})));return(0,M.Z)(e,this[lt])}if((0,u.gE)(r)){const i=e[t[it]],n=(i&&"date"===i.type?i.date_format:void 0)||T.defaultDateFormat;let o;if("exact"===r.value.type){const t=r.value;if(t.value)if((0,T.isDate)(t.value))o=t.value;else if((0,T.isPartialDateRange)(t.value)){const e=(0,T.getFilledDataFromPartialDateRange)(t.value);e&&(o=e.value)}}else if(!(0,u.TQ)(r))return(0,V.x)(r.value);if(o)return s()(K.Z,{style:{[z]:W},value:o,dateFormat:n,shortenDateAndRange:!0})}else{if((0,u.Jw)(r)){const t=(0,u.fl)(r).filter((t=>{let{value:e}=t;return Boolean(e)})).map(V.cq);if(0===t.length)return;return s()("span",{},void 0,(0,M.Z)(t,this[lt]))}(0,O.unreachable)(r)}}}}dt.displayName="CollectionViewFilterValue";const ut=(0,h.injectIntl)(dt);var ct=i(44532),pt=i(58032);const ht=i(85).yKA,mt=i(85).PXg,vt=i(85).Hco,gt=i(85).OP1,ft=i(85).nx5,yt=i(85)._lc,St=i(85).dLQ,bt=i(85).Lyb,wt=i(85).fbO,Ct=i(85).T5E,Pt=i(85).EIp,It=i(85).YO,xt=i(85).BrJ,kt=i(85).oBh,Zt=i(85).ltl,_t=i(85).rMr,Tt=i(85).Kol,Mt=i(85).vHy,Ft=i(85).xQb,At=i(85).EiQ,Rt=i(85).Q_9,Dt=i(85).dpF,Bt=i(85).DbH,Ot=i(85).mYq,Nt=i(85).ddU,Vt=i(85).X5t,Et=i(85).wgE,Gt=i(85).jQT,Lt=i(85).Xl2,Kt=i(85).Gnd,Ut=i(85).b8T,qt=i(85).Gm5,Wt=i(85).fBu,zt=i(85).QLQ,Ht=i(85).mSd,Qt=i(85).aoh,$t=i(85).ffk,jt=i(85).UBi,Yt=i(85).oWD,Jt=i(85).rQ1,Xt=i(85).qU4,te=i(85).qq3,ee=i(85).QmD,ie=i(85).eiN,ne=i(85).TSg,oe=i(85).P0R,re=i(85).P24,se=i(85).wfR,ae=i(85).HxR;class le extends l.Z{constructor(){super(...arguments),this.storeTypes={[ae]:d.default[se]({open:!1,stack:[]})},this.renderPopup=()=>{var t,e;const{[re]:i}=this[oe],n=this[ne]();if(!n)return;const o=n[ie],r=i[te][ee],a=i[Xt](),l=i[Jt][ee];if(!a)return;const d=null==i||null===(t=i[Yt]())||void 0===t||null===(e=t[jt]()[n[ie][$t]])||void 0===e?void 0:e.type;return s()(C.ZP,{[zt]:a.id,propertyFilter:o,schema:r,[Wt]:a,onChange:t=>this.handleValueChange(t,d),onClose:this.handleFilterValueMenuClose,onDelete:this.handleDeleteFilter,onAddToCombinatorFilter:this.handleAddToCombinatorFilter,[qt]:C.Qv[Qt],allowAddingToCombinatorFilter:l[Ht],allowRelativeDateFilter:!0,allowRelativePersonFilter:!0})},this[Ut]=()=>{var t,e;const{[re]:i}=this[oe],{[ae]:n}=this[Kt],o=this[ne]();o&&(g[Lt]({[ae]:n,item:{type:ie}}),m[Gt]({[Et]:this[Et],[re]:i,[Vt]:"click_property_filter",[Nt]:void 0,[Ot]:null==i||null===(t=i[Yt]())||void 0===t||null===(e=t[jt]()[o[ie][$t]])||void 0===e?void 0:e.type}))},this.handleValueChange=(t,e)=>{var i;const{[re]:n}=this[oe],o=this[ne]();if(!o)return;const r=null===(i=n[Bt][ee])||void 0===i?void 0:i.sizeHint,s=w.default.mark(Dt);w.default[Rt](s,{[Et]:this[Et],getData:()=>S.getUpdateFilterLagData({from:"property_filter",[Ot]:e,[re]:n,sizeHintAtStart:r})});const a=o[ie],l=n[At][ee].map((e=>{if(e.id===o.id){return{...o,[ie]:{...a,[ie]:t}}}return e}));v[Ft]({[Et]:this[Et],[re]:n,[Mt]:{...n[Mt][ee],propertyFilters:{value:l}}}),m[Gt]({[Et]:this[Et],[re]:n,[Vt]:"update_property_filter",[Nt]:void 0,[Ot]:e})},this[Tt]=t=>{if(t&&(0,b.yT)(t.target))return;const{[ae]:e}=this[Kt];g[_t]({[ae]:e})},this.handleFilterValueMenuClose=()=>{const{[ae]:t}=this[Kt];g[_t]({[ae]:t})},this.handleDeleteFilter=()=>{var t,e;const{[re]:i}=this[oe],n=this[ne]();if(!n)return;const o=i[At][ee][ie]((t=>t.id!==n.id));v[Ft]({[Et]:this[Et],[re]:i,[Mt]:{...i[Mt][ee],propertyFilters:{value:o}}}),m[Gt]({[Et]:this[Et],[re]:i,[Vt]:"delete_property_filter",[Nt]:void 0,[Ot]:null==i||null===(t=i[Yt]())||void 0===t||null===(e=t[jt]()[n[ie][$t]])||void 0===e?void 0:e.type})},this.handleAddToCombinatorFilter=()=>{var t,e;const{[re]:i,[qt]:n}=this[oe],o=this[ne]();if(!o)return;const{[Zt]:r,propertyFilters:s}=(0,y.Gz)(i,o);v[Ft]({[Et]:this[Et],[re]:i,[Mt]:{...i[Mt][ee],propertyFilters:{value:s},[Zt]:{value:r}}});const a=n===P.P.FilterBar?i[kt]:i[xt];g[Lt]({[ae]:a,item:{type:ie}}),m[Gt]({[Et]:this[Et],[re]:i,[Vt]:It,[Ot]:null==i||null===(t=i[Yt]())||void 0===t||null===(e=t[jt]()[o[ie][$t]])||void 0===e?void 0:e.type})},this.hasFilterDiff=this[Pt]((()=>{const{id:t,[re]:e}=this[oe],i=e[Ct][ee];return i[bt].updated[wt](t)||i[bt].added[wt](t)}))}willUnmount(){g[_t]({[ae]:this[Kt][ae]})}renderComponent(){const{device:t}=this[Et],{[ae]:e}=this[Kt],i=this[ne](),n=Boolean(i&&(0,f.EE)(i.id));return s()(ct.ZP,{popupType:t[St]?ct.ZP[yt].SlideUp:ct.ZP[yt].Popup,open:e[ee].open,origin:n?this.renderReadOnlyOrigin():this.renderOrigin(void 0,!1),onDismiss:this[Tt],disableMouseCapture:!0,enableOutsideClickDismiss:!0,originGap:4,render:this.renderPopup})}renderReadOnlyOrigin(){return s()(pt.Z,{placement:pt.Z.Placement.Left,render:t=>this.renderOrigin(t,!0),renderTooltip:()=>s()(h.FormattedMessage,{id:"database.filterBarPropertyFilter.cannotConfigure",[ft]:"This filter can’t be deleted on this view."})})}renderOrigin(t,e){const{[re]:i}=this[oe],{device:n}=this[Et],r=this[ne](),l=i[te][ee],d=i[Xt]();if(!d||!r)return;const p=r[ie],h=!(0,u.Oo)(p),m=l[p[$t]],{theme:v}=this;return a.createElement(I.Z,o()({icon:m&&s()(c.ZP,{type:m.type,icon:m.icon,size:n[St]?18:16,theme:v,style:{fill:h?v[gt]:v[vt],[mt]:6}}),title:h?s()(ut,{propertyFilter:p,schema:l,style:this[ht](),[Wt]:d}):s()("span",{style:this[ht]()},void 0,null==m?void 0:m.name),key:r.id,on:h,hasDiff:this.hasFilterDiff[ee],onClick:this[Ut],disabled:e,hideChevron:e},t))}[ne](){const{id:t,[re]:e}=this[oe];return e[At][ee].find((e=>e.id===t))}[ht](){return{maxWidth:180,...p.Z.textOverflowStyle}}}le.displayName="CollectionViewFilterBarPropertyFilter";const de=(0,h.injectIntl)(le)},68689:(t,e,i)=>{i.d(e,{v:()=>Tn});var n=i(77094),o=i.n(n),r=i(67294),s=i(480),a=i(81954),l=i(24405),d=i(5366),u=i(82990),c=i(50906),p=i(27370),h=i(97004),m=i(75079),v=i(64856),g=i(79315),f=i(10161),y=i(64203),S=i(97464),b=i.n(S),w=i(53150),C=i(63123),P=i(49085),I=i(15145),x=i(99036),k=i(23482),Z=i(21202),_=i(77420),T=i(19889),M=i(70203),F=i(97880);const A=i(85).Neb,R=i(85).xDR,D=i(85).UFH,B=i(85).IK4,O=i(85).R5o,N=i(85).nNG,V=i(85).G4H;class E{}E.text=t=>new K(t),E.mentionDate=t=>new q(t),E.mentionUser=t=>new W(t),E.mentionGroup=(t,e)=>new $(t,e),E.mentionBot=t=>new W(t),E.mentionPage=t=>new W(t),E.mentionTemplateVariable=t=>new z(t),E.mentionFormulaContextVariable=t=>new H(t),E.mentionFormulaPagePropertyVariable=t=>new Q(t),E.equation=t=>new U(t),E.concat=t=>new G(t);class G{constructor(t){this.build=()=>{const t=[];for(const e of this.tokens){const i=e.build();t.push(i[0])}return t},this.tokens=t}}class L{constructor(t){this[V]={},this[N]=void 0,this.bold=()=>(this[V][M[O].Bold]=!0,this),this.italic=()=>(this[V][M[O].Italic]=!0,this),this.strike=()=>(this[V][M[O].Strike]=!0,this),this.code=()=>(this[V][M[O].Code]=!0,this),this.underline=()=>(this[V][M[O].Underline]=!0,this),this.color=t=>(this[N]=t,this),this.build=()=>{const t=[];for(const e of(0,F.objectKeys)(this[V]))t.push([e]);return this[N]&&t.push([M[O].Highlight,this[N]]),this.onBuild(t)},this.onBuild=t}}class K extends L{constructor(t){super((e=>{if(this.url&&e.unshift(M.createLinkAnnotation(this.url)),e.length>0){return[[t,e]]}return[[t]]})),this.url=void 0,this.link=t=>(this.url=t,this)}}class U extends L{constructor(t){super((e=>[M.createEquationToken(t,e)]))}}class q extends L{constructor(t){super((e=>{let i;"date"in t?i=this[B](t.date):"time"in t?i=this.getTimeAnnotationData(t.time):(0,F.unreachable)(t);const n=M.createDateAnnotation(i);return[M[D](n,e)]})),this[R]=t=>t.toISOString().split("T")[0],this.getTimeString=t=>t.toISOString().split("T")[1].slice(0,5)}[B](t){if(Array.isArray(t)){const[e,i]=t;return{type:"daterange",[A]:this[R](e),end_date:this[R](i)}}return{type:"date",[A]:this[R](t)}}getTimeAnnotationData(t){if(Array.isArray(t)){const[e,i]=t;return{type:"datetimerange",[A]:this[R](e),start_time:this.getTimeString(e),end_date:this[R](i),end_time:this.getTimeString(i),time_zone:"Etc/GMT"}}return{type:"datetime",[A]:this[R](t),start_time:this.getTimeString(t),time_zone:"Etc/GMT"}}}class W extends L{constructor(t){super((e=>{let i;return t.table===T.KJ?i=M.createUserAnnotation(t.id):t.table===_.cZ?i=M.createBotAnnotation(t.id):t.table===Z.iU?i=M.createPageAnnotation(t.id,t.spaceId):(0,F.unreachable)(t),[M[D](i,e)]}))}}class z extends L{constructor(t){super((e=>{const i=M.createTemplateVariableAnnotation({type:t});return[M[D](i,e)]}))}}class H extends L{constructor(t){super((e=>{const i=M.createFormulaContextValueMentionAnnotation(t);return[M[D](i,e)]}))}}class Q extends L{constructor(t){super((e=>{const i=M.createFormulaPagePropertyMentionAnnotation(t);return[M[D](i,e)]}))}}class $ extends L{constructor(t,e){super((i=>{const n=M.createGroupAnnotation(t,e);return[M[D](n,i)]}))}}var j=i(78106),Y=i(4615),J=i(23014),X=i(6287);const tt=i(85).NPd,et=i(85).elp,it=i(85).Rle,nt=i(85).r8t,ot=i(85).axF,rt=i(85).mUE,st=i(85).ffk,at=i(85).eiN,lt=i(85).jWK,dt=i(85).iDK,ut=i(85).FH8,ct=i(85).v1$,pt=i(85).OU_,ht=i(85).fHe,mt=i(85).X5t,vt=i(85).jes,gt=i(85).U$G,ft=i(85).zkt,yt=i(85).ilE,St=i(85).SPm,bt=i(85).rvt,wt=i(85).XlZ,Ct=i(85).urI,Pt=i(85).Ql2,It=i(85).yn7,xt=(0,d.defineMessages)({nextSprintName:{id:"structuredAutomations.createNextSprint.nextSprintName",defaultMessage:"Sprint"}});function kt(t){const{createNextSprintActionId:e,sprintCollectionPointer:i,sprintStatusNextOptionName:n,intl:o,[Pt]:r,getCurrentSprintActionId:s,sprintStatusPropertyId:a,sprintUniqueIdPropertyId:l}=t;return{id:e,type:gt,[vt]:{values:{title:{value:{type:"formula",value:Bt({actionId:s,sprintCollectionPointer:i,sprintUniqueIdPropertyId:l,incrementBy:1,intl:o})},[mt]:ht},[a]:{value:{type:pt,value:[[`"${n}"`]]},[mt]:ht}},[ct]:["title",a],[ut]:i},[It]:r}}function Zt(t){const{getCurrentSprintActionId:e,sprintCollectionPointer:i,sprintCollectionSchema:n,[Pt]:o}=t,r=J.qB[k.p$][dt].reducer.getCombinatorFilter(n);return{id:e,type:lt,[vt]:{[at]:r,[ut]:i},[It]:o}}function _t(t){const{getLargestUniqueIdSprintActionId:e,sprintCollectionPointer:i,sprintUniqueIdPropertyId:n,[Pt]:o}=t;return{id:e,type:lt,[vt]:{[at]:void 0,[ut]:i,sort:[{[st]:n,direction:"descending"}],limit:1},[It]:o}}function Tt(t){const{createFutureSprintActionId:e,sprintCollectionPointer:i,sprintStatusFutureOptionName:n,intl:o,[Pt]:r,getLargestUniqueIdSprintActionId:s,sprintStatusPropertyId:a,sprintUniqueIdPropertyId:l,incrementBy:d}=t;return{id:e,type:gt,[vt]:{values:{title:{value:{type:"formula",value:Bt({actionId:s,sprintCollectionPointer:i,sprintUniqueIdPropertyId:l,intl:o,incrementBy:d})},[mt]:ht},[a]:{value:{type:pt,value:[[`"${n}"`]]},[mt]:ht}},[ct]:["title",a],[ut]:i},[It]:r}}function Mt(t){const{updateFutureSprintToNextActionId:e,sprintCollectionPointer:i,sprintStatusNextOptionName:n,sprintStatusFutureOptionName:o,[Pt]:r,sprintStatusPropertyId:s,sprintUniqueIdPropertyId:a}=t;return{id:e,type:ot,[vt]:{target:{type:ut,[ut]:i,[at]:{[rt]:"and",filters:[{[st]:s,[at]:{[rt]:"status_is",value:{type:"is_option",value:o}}}]},sort:[{[st]:a,direction:"ascending"}],limit:1},values:{[s]:{value:{type:pt,value:[[`"${n}"`]]},[mt]:ht}},[ct]:[s]},[It]:r}}function Ft(t){const{moveIncompleteTasksActionId:e,createNextSprintActionId:i,taskCollectionPointer:n,taskStatusCompleteGroupName:o,[Pt]:r,nextSprintInput:s,taskStatusPropertyId:a,taskSprintRelationPropertyId:l}=t;return{id:e,type:ot,[vt]:{target:{type:ut,[ut]:n,[at]:{[rt]:"and",filters:[{[st]:a,[at]:{[rt]:nt,value:{type:"is_group",value:o}}},{[at]:{[rt]:it,value:{type:"relative",value:{type:"builtin",[et]:dt}}},[st]:l}]}},[ct]:[l],values:{[l]:{value:{type:pt,value:"pointer"===s.type?E.mentionPage(s.pointer).build():E.mentionFormulaContextVariable({id:(0,j.Kd)({source:mt,action_id:i,[tt]:"page"})}).build()},[mt]:ht}}},[It]:r}}function At(t){const{moveIncompleteTasksToBacklogActionId:e,taskCollectionPointer:i,taskStatusCompleteGroupName:n,[Pt]:o,taskStatusPropertyId:r,taskSprintRelationPropertyId:s}=t;return{id:e,type:ot,[vt]:{target:{type:ut,[ut]:i,[at]:{[rt]:"and",filters:[{[st]:r,[at]:{[rt]:nt,value:{type:"is_group",value:n}}},{[at]:{[rt]:it,value:{type:"relative",value:{type:"builtin",[et]:dt}}},[st]:s}]}},[ct]:[s],values:{[s]:{value:void 0,[mt]:"remove"}}},[It]:o}}function Rt(t){const{updateCurrentSprintToPastActionId:e,getCurrentSprintActionId:i,sprintStatusPastOptionName:n,[Pt]:o,sprintStatusPropertyId:r}=t;return{id:e,type:ot,[vt]:{target:{id:(0,j.Kd)({source:mt,action_id:i,[tt]:"pages"}),type:et},values:{[r]:{value:{type:pt,value:[[`"${n}"`]]},[mt]:ht}},[ct]:[r]},[It]:o}}function Dt(t){const{updateNextSprintToCurrentActionId:e,createNextSprintActionId:i,sprintStatusCurrentOptionName:n,[Pt]:o,nextSprintInput:r,nextSprintDateRange:s,sprintStatusPropertyId:a,sprintDatePropertyId:l}=t,d="pointer"===r.type?{type:"page",page:r.pointer}:{id:(0,j.Kd)({source:mt,action_id:i,[tt]:"page"}),type:et};return{id:e,type:ot,[vt]:{target:d,values:{[a]:{value:{type:pt,value:[[`"${n}"`]]},[mt]:ht},[l]:{value:{type:pt,value:[(0,M.createMentionToken)(["d",s])]},[mt]:ht}},[ct]:[a,l]},[It]:o}}function Bt(t){const{actionId:e,sprintCollectionPointer:i,sprintUniqueIdPropertyId:n,incrementBy:o,intl:r}=t;return E.concat([E.text(`joinText(" ", "${r.formatMessage(xt.nextSprintName)}", _toPlainText(`),E.mentionFormulaContextVariable({id:(0,j.Kd)({source:mt,action_id:e,[tt]:"pages"})}),E.text(".first()."),E.mentionFormulaPagePropertyVariable({[ut]:i,[st]:n}),E.text(`+${o}))`)]).build()}var Ot=i(8848),Nt=i(84619),Vt=i(40506),Et=i(7057),Gt=i(3909),Lt=i(29477),Kt=i(606),Ut=i(68626),qt=i(63143),Wt=i(98114),zt=i(64434),Ht=i(5978),Qt=i(87279),$t=i(37034),jt=i(29376),Yt=i(58484),Jt=i(39098),Xt=i(9118),te=i(78030),ee=i(42922),ie=i(52275),ne=i(31945),oe=i(36596),re=i(78140),se=i(32163),ae=i(40721),le=i(89728),de=i(31278),ue=i(76798),ce=i(72495),pe=i(83264),he=i(53953),me=i(44532);function ve(t){window.__c={n:"DefaultPopupOrModalFunctional"};const{isOpen:e,onDismiss:i,render:n,origin:r,style:a,innerStyle:l,ariaLabel:d,ariaLabelledBy:u}=t,{isMobile:c}=(0,s.Fy)();return c?o()(me.ZP,{ariaLabel:d,ariaLabelledBy:u,open:e,popupType:me.ZP.PopupType.SlideUp,origin:r,onDismiss:i,render:n,style:a}):o()(he.Z,{ariaLabel:d,ariaLabelledBy:u,open:e,preventHideChildrenWhileOpening:!0,render:n,onDismiss:i,style:a,innerStyle:l})}var ge=i(85567);const fe=i(85).Btx,ye=i(85).Jyz,Se=i(85).TeW,be=i(85).Neb,we=i(85).$pZ,Ce=i(85).hSJ,Pe=i(85).pXY,Ie=i(85).zkt,xe=i(85).ffk,ke=i(85).oWD,Ze=i(85).j7K,_e=i(85).y79,Te=i(85).I7L,Me=i(85).ceT,Fe=i(85).ccq,Ae=i(85).pHx,Re=i(85).Cb3,De=i(85).m3w,Be=i(85).D4W,Oe=i(85).a3v,Ne=i(85).OtN,Ve=i(85).TEz,Ee=i(85).UPJ,Ge=i(85).$bT,Le=i(85).Exd,Ke=i(85).g7N,Ue=i(85).jkI,qe=i(85).H1U,We=i(85).EMU,ze=i(85).sM5,He=i(85).NF1,Qe=i(85).X_m,$e=i(85).nLZ,je=i(85).LIR,Ye=i(85).jDA,Je=i(85).PG2,Xe=i(85).pkR,ti=(i(85).VEX,i(85).FOQ),ei=i(85).BQ6,ii=i(85).Gpy,ni=i(85).qpZ,oi=i(85).xYh,ri=i(85).uKy,si=i(85).hDW,ai=i(85).HGk,li=i(85).mFu,di=i(85).f6n,ui=i(85).wgE,ci=i(85).Yzm,pi=i(85).TLr,hi=i(85).JmH,mi=i(85).dLQ,vi=i(85).dnw,gi=i(85).rpY,fi=i(85).D7I,yi=i(85).wJk,Si=i(85).Gbv,bi=i(85).MQR,wi=i(85).HKV,Ci=i(85).nx5,Pi=(0,d.defineMessages)({completedPercentSummary:{id:"completeAutomationSprintModal.sprintSummary.completedPercentSummary",[Ci]:"{completedTaskCount} / {totalTaskCount} total tasks"},selectNextSprintLabel:{id:"completeAutomationSprintModal.sprintSummary.selectNextSprintLabel",[Ci]:"Next sprint"},[wi]:{id:"completeAutomationSprintModal.sprintSummary.selectDatesForNextSprintLabel",[Ci]:"Start and end dates"},nextSprintDatesLabel:{id:"completeAutomationSprintModal.sprintSummary.nextSprintDatesLabel",[Ci]:"Next sprint dates"},[bi]:{id:"completeAutomationSprintModal.sprintSummary.cancel",[Ci]:"Cancel"},[Si]:{id:"completeAutomationSprintModal.sprintName.placeholder",[Ci]:"Sprint"}});function Ii(t){let{[yi]:e,...i}=t;window.__c={n:"CompleteSprintAutomationModal"};const{isOpen:n}=i,a=(0,s.O7)(),l=(0,w.C)(),d=t=>{e();let n=!1;(0,F.isObject)(t)&&(0,F.isDefined)(t.clickedCancel)&&(n=!0===t.clickedCancel),c.trackCompleteSprintAction(a,{...(0,m.getCollectionAnalyticsContext)(i.taskCollectionContextStore),action:n?"cancel_modal":"dismiss_modal"})};return o()(ve,{ariaLabelledBy:l,isOpen:n,[yi]:()=>d(),[gi]:()=>r[fi](xi,b()({},i,{[yi]:d,titleAriaId:l}))})}function xi(t){window.__c={n:"SprintSummaryModal"};const{completeSprintAutomationContext:e,setIsLoading:i,taskCollectionContextStore:n,[yi]:l,completeSprintAutomationState:u,onAutomationComplete:p,titleAriaId:h}=t,{sprintCollectionStore:v}=e,{currentSprintId:g,querySprintsResult:f,[vi]:y}=u,S=(0,d.useIntl)(),b=(0,s.O7)(),{[mi]:w}=(0,s.Fy)(),I=(0,a.VK)((()=>v[hi]()),[v]),_=(0,a.VK)((()=>{if(g)return Jt.G[pi](v,{id:g,table:Z.iU,spaceId:v[hi]()})}),[g,v]),T=(0,a.VK)((()=>_?(0,$t.vU)({intl:S,[ui]:b,store:_,untitledFallback:Pi[Si]}):S[ci](Pi[Si])),[_,S,b]),M=(0,a.VK)((()=>Fi({sprintDateRange:Mi({sprintBlockStore:_,sprintCollectionStore:v}),intl:S})),[_,v,S]),[A,R]=r.useState(),D=(0,a.VK)((()=>P.default.createValue(di)),[]),B=(0,a.VK)((()=>{if("pointer"!==(null==A?void 0:A.type))return;return Mi({sprintBlockStore:Jt.G[pi](v,A[li]),sprintCollectionStore:v})}),[A,v]),[O,N]=r.useState(void 0),V=r.useMemo((()=>{if(O&&(0,Vt.isDateRange)(O))return O}),[O]),E=r.useMemo((()=>{if(!f)return;const{nextSprintIds:t,futureSprintIds:e}=f;return t.length>0?t:e}),[f]),G=(0,a.VK)((()=>{if(void 0===E)return;const t=E[0];return t?{type:li,[li]:{id:t,table:Z.iU,spaceId:I}}:{type:"actionId"}}),[E,I]);r.useEffect((()=>{G&&R(G)}),[G,R]),r.useEffect((()=>{N(B)}),[B,N]);const L=r.useCallback((async()=>{if(l(),!A||!V)return;i(!0);const t=0===(null==y?void 0:y.incompleteTaskCount)?ai:D.state,o=function(t){var e,i,n,o,r,s,a,l,d,u,c,p,h,m;const{sprintCollectionValue:v,nextSprintInput:g,intl:f,nextSprintDateRange:y}=t,S=v[It],b={id:v.id,table:X.v,[Pt]:S},w=(0,Y.default)(),C=(0,Y.default)(),P=(0,Y.default)(),I=(0,Y.default)(),Z=(0,Y.default)(),_=(0,Y.default)(),T=(0,Y.default)(),M=(0,x.getNormalizedSchema)(v),A=null===(e=v[Ct])||void 0===e||null===(i=e[wt])||void 0===i?void 0:i[k.b0[bt]];if(!A)return{error:{[St]:`${k.b0[bt]} not found.`}};const R=null===(n=v[Ct])||void 0===n||null===(o=n[wt])||void 0===o?void 0:o[k.b0.UniqueId];if(!R)return{error:{[St]:`${k.b0.UniqueId} not found.`}};const D=null===(r=v[Ct])||void 0===r||null===(s=r[wt])||void 0===s?void 0:s[k.b0.Dates];if(!D)return{error:{[St]:`${k.b0.Dates} not found.`}};const B=M[A];if(!B||"status"!==B.type)return{error:{[St]:`${k.b0[bt]} not found.`}};const O=null===(a=B.options)||void 0===a||null===(l=a.find((t=>t.id===k.J1)))||void 0===l?void 0:l.value,N=null===(d=B.options)||void 0===d||null===(u=d.find((t=>t.id===k.SF)))||void 0===u?void 0:u.value,V=null===(c=B.options)||void 0===c||null===(p=c.find((t=>t.id===k.YE)))||void 0===p?void 0:p.value,E=null===(h=B.options)||void 0===h||null===(m=h.find((t=>t.id===k.eH)))||void 0===m?void 0:m.value;if(!(O&&N&&V&&E))return{error:{[St]:`Could not find required options for ${k.b0[bt]}.`}};const G="pointer"===g.type?1:2;if("complete_sprint"===t.type)return{value:[_t({getLargestUniqueIdSprintActionId:_,sprintCollectionPointer:b,sprintUniqueIdPropertyId:R,[Pt]:S}),Zt({getCurrentSprintActionId:w,sprintCollectionPointer:b,sprintCollectionSchema:M,[Pt]:S}),..."pointer"===g.type?[]:[kt({createNextSprintActionId:T,getCurrentSprintActionId:w,sprintCollectionPointer:b,sprintStatusNextOptionName:V,intl:f,[Pt]:S,sprintStatusPropertyId:A,sprintUniqueIdPropertyId:R})],Rt({updateCurrentSprintToPastActionId:C,getCurrentSprintActionId:w,sprintStatusPastOptionName:O,sprintStatusPropertyId:A,[Pt]:S}),Dt({updateNextSprintToCurrentActionId:P,createNextSprintActionId:T,nextSprintInput:g,sprintStatusCurrentOptionName:N,sprintStatusPropertyId:A,[Pt]:S,nextSprintDateRange:y,sprintDatePropertyId:D}),Tt({createFutureSprintActionId:Z,sprintCollectionPointer:b,sprintStatusFutureOptionName:E,getLargestUniqueIdSprintActionId:_,intl:f,[Pt]:S,sprintStatusPropertyId:A,sprintUniqueIdPropertyId:R,incrementBy:G}),Mt({updateFutureSprintToNextActionId:I,sprintCollectionPointer:b,sprintStatusNextOptionName:V,sprintStatusFutureOptionName:E,[Pt]:S,sprintStatusPropertyId:A,sprintUniqueIdPropertyId:R})]};if("complete_sprint_and_move_incomplete_tasks_to_next_sprint"===t.type){var L,K,U,q,W,z;const{taskCollectionValue:e}=t,i={id:e.id,table:X.v,[Pt]:e[It]},n=(0,Y.default)(),o=null===(L=e[Ct])||void 0===L||null===(K=L[wt])||void 0===K?void 0:K[k.Es[yt]];if(!o)return{error:{[St]:`${k.Es[yt]} not found.`}};const r=null===(U=e[Ct])||void 0===U||null===(q=U[wt])||void 0===q?void 0:q[k.Es[ft]];if(!r)return{error:{[St]:`${k.Es[ft]} not found.`}};const s=(0,x.getNormalizedSchema)(e)[o];if(!s||"status"!==s.type)return{error:{[St]:`${k.Es[yt]} not found.`}};const a=null===(W=s.groups)||void 0===W||null===(z=W.find((t=>t.id===k.uS)))||void 0===z?void 0:z.name;return a?{value:[_t({getLargestUniqueIdSprintActionId:_,sprintCollectionPointer:b,sprintUniqueIdPropertyId:R,[Pt]:S}),Zt({getCurrentSprintActionId:w,sprintCollectionPointer:b,sprintCollectionSchema:M,[Pt]:S}),..."pointer"===g.type?[]:[kt({createNextSprintActionId:T,getCurrentSprintActionId:w,sprintCollectionPointer:b,sprintStatusNextOptionName:V,intl:f,[Pt]:S,sprintStatusPropertyId:A,sprintUniqueIdPropertyId:R})],Ft({moveIncompleteTasksActionId:n,createNextSprintActionId:T,nextSprintInput:g,taskCollectionPointer:i,taskStatusCompleteGroupName:a,[Pt]:S,taskStatusPropertyId:o,taskSprintRelationPropertyId:r}),Rt({updateCurrentSprintToPastActionId:C,getCurrentSprintActionId:w,sprintStatusPastOptionName:O,[Pt]:S,sprintStatusPropertyId:A}),Dt({updateNextSprintToCurrentActionId:P,createNextSprintActionId:T,nextSprintInput:g,sprintStatusCurrentOptionName:N,[Pt]:S,sprintStatusPropertyId:A,nextSprintDateRange:y,sprintDatePropertyId:D}),Tt({createFutureSprintActionId:Z,sprintCollectionPointer:b,sprintStatusFutureOptionName:E,getLargestUniqueIdSprintActionId:_,intl:f,[Pt]:S,sprintStatusPropertyId:A,sprintUniqueIdPropertyId:R,incrementBy:G}),Mt({updateFutureSprintToNextActionId:I,sprintCollectionPointer:b,sprintStatusNextOptionName:V,sprintStatusFutureOptionName:E,[Pt]:S,sprintStatusPropertyId:A,sprintUniqueIdPropertyId:R})]}:{error:{[St]:`Could not find required group for ${k.Es[yt]}.`}}}if("complete_sprint_and_move_incomplete_tasks_to_backlog"===t.type){var H,Q,$,j,J,tt;const{taskCollectionValue:e}=t,i={id:e.id,table:X.v,[Pt]:e[It]},n=(0,Y.default)(),o=null===(H=e[Ct])||void 0===H||null===(Q=H[wt])||void 0===Q?void 0:Q[k.Es[yt]];if(!o)return{error:{[St]:`${k.Es[yt]} not found.`}};const r=null===($=e[Ct])||void 0===$||null===(j=$[wt])||void 0===j?void 0:j[k.Es[ft]];if(!r)return{error:{[St]:`${k.Es[ft]} not found.`}};const s=(0,x.getNormalizedSchema)(e)[o];if(!s||"status"!==s.type)return{error:{[St]:`${k.Es[yt]} not found.`}};const a=null===(J=s.groups)||void 0===J||null===(tt=J.find((t=>t.id===k.uS)))||void 0===tt?void 0:tt.name;return a?{value:[_t({getLargestUniqueIdSprintActionId:_,sprintCollectionPointer:b,sprintUniqueIdPropertyId:R,[Pt]:S}),Zt({getCurrentSprintActionId:w,sprintCollectionPointer:b,sprintCollectionSchema:M,[Pt]:S}),..."pointer"===g.type?[]:[kt({createNextSprintActionId:T,getCurrentSprintActionId:w,sprintCollectionPointer:b,sprintStatusNextOptionName:V,intl:f,[Pt]:S,sprintStatusPropertyId:A,sprintUniqueIdPropertyId:R})],At({moveIncompleteTasksToBacklogActionId:n,taskCollectionPointer:i,taskStatusCompleteGroupName:a,[Pt]:S,taskStatusPropertyId:o,taskSprintRelationPropertyId:r}),Rt({updateCurrentSprintToPastActionId:C,getCurrentSprintActionId:w,sprintStatusPastOptionName:O,[Pt]:S,sprintStatusPropertyId:A}),Dt({updateNextSprintToCurrentActionId:P,createNextSprintActionId:T,nextSprintInput:g,sprintStatusCurrentOptionName:N,[Pt]:S,sprintStatusPropertyId:A,nextSprintDateRange:y,sprintDatePropertyId:D}),Tt({createFutureSprintActionId:Z,sprintCollectionPointer:b,sprintStatusFutureOptionName:E,getLargestUniqueIdSprintActionId:_,intl:f,[Pt]:S,sprintStatusPropertyId:A,sprintUniqueIdPropertyId:R,incrementBy:G}),Mt({updateFutureSprintToNextActionId:I,sprintCollectionPointer:b,sprintStatusNextOptionName:V,sprintStatusFutureOptionName:E,[Pt]:S,sprintStatusPropertyId:A,sprintUniqueIdPropertyId:R})]}:{error:{[St]:`Could not find required group for ${k.Es[yt]}.`}}}return(0,F.unreachable)(t.type)}({type:t,sprintCollectionValue:e.sprintCollectionValue,taskCollectionValue:e.taskCollectionValue,nextSprintInput:A,nextSprintDateRange:V,intl:S});if(c.trackCompleteSprintAction(b,{...(0,m.getCollectionAnalyticsContext)(n),action:ai,[vi]:u[vi],completeSprintActionType:t,nextSprintDateRange:V,nextSprintInput:A}),Ut.x.isFail(o))throw new Error(o.error.message);await Wt.oS({[ui]:b,store:e[si],clientContext:{type:"structured_automation",persisted:!1,intl:S,parentRecordStore:e[si],actions:o.value,parentPointer:e[si][ri]()}}),p(),await Promise.all([zt.fetchRemoteResult(b,n,{src:"complete_sprint_automation",queuedTimestamp:Date.now()}),(0,Lt.timeout)(1e3)]),i(!1)}),[e,n,b,S,i,l,A,D,V,null==y?void 0:y.incompleteTaskCount,p,u[vi]]),K=_i({[mi]:w}),{status:U}=(0,C.V)({value:u,validateLoaded:t=>!1===t[oi],waitTimeInMs:1*qt.MinuteMs});if("pending"!==U&&u[oi])return o()(ki,{titleAriaId:h,[yi]:l,sprintCollectionStore:v});if(u[oi])return o()(Zi,{titleAriaId:h,[yi]:l});const{incompleteTaskCount:q}=u[vi],W=Boolean(A)&&Boolean(V),z=void 0!==E&&E.length>0;return o()("div",{"data-testid":"complete-automation-sprint-modal",[ei]:K.modalContainer},void 0,o()("div",{[ei]:K[ni],id:h},void 0,o()(d.FormattedMessage,{id:"completeAutomationSprintModal.sprintSummary.title",[Ci]:"{sprintName} summary",[ii]:{sprintName:T}})),o()(Ti,{currentSprintFormattedDateRange:M,[vi]:y}),z&&o()("div",{"data-testid":"next-sprint-row",[ei]:K.flexRow},void 0,S[ci](Pi.selectNextSprintLabel),o()(Oi,{nextSprintInput:A,setNextSprintInput:R,completeSprintAutomationContext:e,sprintPageIds:E})),o()("div",{[ei]:K.flexRow},void 0,z?S[ci](Pi[wi]):S[ci](Pi.nextSprintDatesLabel),o()(Vi,{sprintDateRange:O,setSprintDateRange:N})),q>0&&o()("div",{"data-testid":"incomplete-task-row",[ei]:K.flexRow},void 0,o()(d.FormattedMessage,{id:"completeAutomationSprintModal.sprintSummary.incompleteTasksLabel",[Ci]:"{incompleteTaskCount, plural, one {{incompleteTaskCount} incomplete task} other {{incompleteTaskCount} incomplete tasks}}",[ii]:{incompleteTaskCount:q}}),o()(Ri,{actionTypeStore:D})),o()(ee.Z,{[Xe]:!W,[Je]:()=>{L()},[ei]:K[ti]},void 0,o()(d.FormattedMessage,{id:"completeAutomationSprintModal.sprintSummary.completeSprintButton",[Ci]:"Complete {sprintName}",[ii]:{sprintName:T}})),o()(le.Z,{[Je]:()=>l({clickedCancel:!0}),[ei]:K[ti]},void 0,S[ci](Pi[bi])))}function ki(t){window.__c={n:"MissingCurrentSprintError"};const{[yi]:e,sprintCollectionStore:i,titleAriaId:n}=t,r=(0,s.O7)(),l=(0,d.useIntl)(),{[mi]:u}=(0,s.Fy)(),c=(0,a.VK)((()=>i.getParentBlockStore()),[i]),p=_i({[mi]:u});return o()("div",{[ei]:p.modalContainer},void 0,o()("div",{[ei]:p[ni],id:n},void 0,o()(d.FormattedMessage,{id:"completeAutomationSprintModal.missingCurrentSprint.title",[Ci]:"No current sprint found"})),o()(ee.Z,{[Je]:()=>{c&&Ht[Ye]({[ui]:r,store:c,[je]:I.tY.LinkInPage})},[ei]:{...p[ti],[$e]:24}},void 0,o()(d.FormattedMessage,{id:"completeAutomationSprintModal.missingCurrentSprint.navigateToSprintsDatabase",[Ci]:"Fix in Sprints database"})),o()(le.Z,{[Je]:e,[ei]:p[ti]},void 0,l[ci](Pi[bi])))}function Zi(t){window.__c={n:"LoadingStatePlaceholder"};const{[yi]:e,titleAriaId:i}=t,n=(0,d.useIntl)(),{[mi]:r}=(0,s.Fy)(),a=_i({[mi]:r});return o()("div",{[ei]:a.modalContainer},void 0,o()("div",{[ei]:a[ni],id:i},void 0,o()(d.FormattedMessage,{id:"completeAutomationSprintModal.sprintSummary.titlePlaceholder",[Ci]:"Sprint summary"})),o()("div",{[ei]:a.subheader},void 0,o()(oe.Z,{[ei]:a.subheaderShimmer})),o()("div",{[ei]:a.flexRow},void 0,n[ci](Pi.selectNextSprintLabel),o()(oe.Z,{[ei]:a.flexRowShimmerBox1})),o()("div",{[ei]:a.flexRow},void 0,n[ci](Pi[wi]),o()(oe.Z,{[ei]:a.flexRowShimmerBox2})),o()("div",{[ei]:a.flexRow},void 0,o()(d.FormattedMessage,{id:"completeAutomationSprintModal.sprintSummary.incompleteTasksPlaceholder",[Ci]:"Incomplete tasks"}),o()(oe.Z,{[ei]:a.flexRowShimmerBox3})),o()(ee.Z,{[Xe]:!0,[Je]:()=>{},[ei]:a[ti]},void 0,o()(d.FormattedMessage,{id:"completeAutomationSprintModal.sprintSummary.completeSprintButtonPlaceholder",[Ci]:"Complete sprint"})),o()(le.Z,{[Je]:e,[ei]:a[ti]},void 0,n[ci](Pi[bi])))}function _i(t){let{[mi]:e}=t;return(0,l.yK)((t=>{const i={[Qe]:44,[He]:8,[ze]:We,[qe]:Ue,width:void 0},n={...i,[$e]:12,[Ke]:18};return{modalContainer:{width:400,[ze]:We,[Le]:e?u.Z[Le].UIRegular.mobile:u.Z[Le].UIRegular.desktop,[Ge]:"column",[Ee]:Ue,padding:20},[ni]:{[ze]:We,[qe]:Ue,[Ee]:Ue,[Le]:e?18:16,fontWeight:u.Z.fontWeight.semibold},subheader:{[ze]:We,[qe]:Ue,[Ee]:Ue,color:t[Ve],[Ke]:16,gap:8},separator:{[Qe]:2,width:2,[He]:2,[Ne]:t[Oe]},flexRow:{[ze]:We,...e?{[Ge]:"column",[Le]:14,color:t.mediumTextColor}:{[Ee]:"space-between",[qe]:Ue,[Qe]:24,[Ke]:16}},completedTaskGroup:{[ze]:We,gap:4},[ti]:{[ze]:We,[qe]:Ue,[Ee]:Ue,[$e]:8,...e&&i},subheaderShimmer:{[He]:3,[$e]:6,width:200,[Qe]:16,...e&&{[Qe]:22}},flexRowShimmerBox1:{[He]:3,width:60,[Qe]:16,...e&&n},flexRowShimmerBox2:{[He]:3,width:80,[Qe]:16,...e&&n},flexRowShimmerBox3:{[He]:3,width:140,[Qe]:16,...e&&n},dropdownButton:{[ze]:We,[qe]:Ue,[Ee]:"flex-end",gap:4,...e&&{...n,border:`1px solid ${t.accentColors.gray[50]}`,[Ee]:"space-between"}},[Be]:{color:t[Oe],width:12,[Qe]:"auto"}}}),[e])}function Ti(t){window.__c={n:"SprintSummarySubheader"};const{currentSprintFormattedDateRange:e,[vi]:i}=t,{[mi]:n}=(0,s.Fy)(),a=(0,d.useIntl)(),l=_i({[mi]:n}),u=i?a[ci](Pi.completedPercentSummary,{completedTaskCount:i.completedTaskCount,totalTaskCount:i.totalTaskCount}):void 0,c=e&&i?r[fi](r.Fragment,null,e,o()("div",{[ei]:l.separator}),u):e||u;return void 0===c?null:o()("div",{[ei]:l.subheader},void 0,c)}function Mi(t){const{sprintBlockStore:e,sprintCollectionStore:i}=t;if(!e)return;const n=i.getPropertyMapping(),o=null==n?void 0:n[k.b0.Dates];if(!o)return;const r=e.getPropertyValue(o);if(!r)return;const s=(0,M.getDateMentions)(r)[0];return s?(0,Vt.convertDateAnnotationToDateRange)(s):void 0}function Fi(t){const{sprintDateRange:e,intl:i}=t;if(e&&(0,Vt.isDateRange)(e))return(0,Et.ZV)({value:e,allowRelativeDates:!1,shortenDateAndRange:!0,[De]:!0,intl:i})}const Ai={[di]:o()(d.FormattedMessage,{id:"completeAutomationSprintModal.sprintSummary.moveToNextSprintOption",[Ci]:"Move to next sprint"}),[Re]:o()(d.FormattedMessage,{id:"completeAutomationSprintModal.sprintSummary.moveToBacklogOption",[Ci]:"Move to backlog"}),[ai]:o()(d.FormattedMessage,{id:"completeAutomationSprintModal.sprintSummary.keepInThisSprintOption",[Ci]:"Keep in current sprint"})};function Ri(t){window.__c={n:"SelectIncompleteTaskAutomationPopupButton"};const{actionTypeStore:e}=t,{[mi]:i}=(0,s.Fy)(),n=(0,a.VK)((()=>e.state),[e]),l=_i({[mi]:i});return o()(ne.ZP,{popupType:i?ne.Z4[Ae]:ne.Z4.Popup,alignmentToOrigin:ne.vR.Start,[Fe]:ne.pO.Bottom,[gi]:t=>o()(Bi,{actionTypeStore:e,buttonPopupParent:t}),renderOrigin:t=>r[fi](le.Z,b()({},t,{[ei]:l.dropdownButton}),Ai[n],Gt.Z.chevronDown(l[Be]))})}const Di=[di,Re,ai];function Bi(t){window.__c={n:"AutomationActionOptionsMenu"};const{actionTypeStore:e,buttonPopupParent:i}=t,{[mi]:n}=(0,s.Fy)(),d=(0,l.yK)((t=>({checkIcon:{color:t[Oe],width:12,[Qe]:"auto",marginLeft:4}})),[]),u=(0,a.VK)((()=>Di.map((t=>{const n=t===e.state;return{key:t,action:()=>{e.setState(t),i.close()},[gi]:e=>r[fi](ie.Z,b()({},e,{title:Ai[t],right:n&&Gt.Z.check(d.checkIcon)}))}}))),[e,d.checkIcon,i]);let c;return c=n?{[Me]:Qt.og.ActionSheet}:{[Me]:Qt.og.Popup,[Te]:"50vh",minWidth:230},r[fi](re.Z,c,o()(se.Z,{type:se.i[_e],[Ze]:0,sections:[{key:"sprint_automations",items:u,[gi]:t=>r[fi](ce.Z,t)}]}))}function Oi(t){window.__c={n:"SelectSprintPopupButton"};const{nextSprintInput:e,completeSprintAutomationContext:i,setNextSprintInput:n,sprintPageIds:u}=t,{sprintCollectionStore:c}=i,{[mi]:p}=(0,s.Fy)(),h=(0,s.O7)(),m=(0,d.useIntl)(),v=(0,a.VK)((()=>{if(void 0===e)return o()(d.FormattedMessage,{id:"completeAutomationSprintModal.sprintSelect.empty",[Ci]:"Select sprint"});if("actionId"===e.type)return o()(d.FormattedMessage,{id:"completeAutomationSprintModal.sprintSelect.newSprint",[Ci]:"New sprint"});if("pointer"===e.type){const t=Jt.G[pi](c,e[li]);return(0,$t.vU)({intl:m,[ui]:h,store:t,untitledFallback:Pi[Si]})}(0,F.unreachable)(e)}),[e,m,c,h]),g=_i({[mi]:p}),f=(0,l.yK)((t=>({[ti]:{...void 0===e&&{color:t[Ve]}}})),[e]),y={...g.dropdownButton,...f[ti]};return 0===u.length||1===u.length?o()(le.Z,{[ei]:y,[Xe]:!0},void 0,v):o()(ne.ZP,{popupType:p?ne.Z4[Ae]:ne.Z4.Popup,alignmentToOrigin:ne.vR.Start,[Fe]:ne.pO.Bottom,[gi]:t=>o()(Ni,{buttonPopupParent:t,completeSprintAutomationContext:i,sprintPageIds:u,nextSprintInput:e,setNextSprintInput:n}),renderOrigin:t=>r[fi](le.Z,b()({},t,{[ei]:y}),v,Gt.Z.chevronDown(g[Be]))})}function Ni(t){window.__c={n:"SelectSprintDropdown"};const{sprintPageIds:e,completeSprintAutomationContext:i,buttonPopupParent:n,nextSprintInput:u,setNextSprintInput:c}=t,{sprintCollectionStore:p}=i,{[mi]:h}=(0,s.Fy)(),m=(0,a.VK)((()=>p[hi]()),[p]),v=(0,a.VK)((()=>(0,jt.getRelatedProperties)({[ke]:i.taskCollectionStore,[xe]:k.Es[Ie]}).filter((t=>t.visible&&("title"===t[xe]||i.sprintCollectionSchema[t[xe]])))),[i]),g=(0,a.VK)((()=>new Yt.Z),[]),f=(0,l.yK)((t=>({checkIcon:{color:t[Oe],width:12,[Qe]:"auto",marginLeft:4},plusIcon:{color:t[Oe],width:12,[Qe]:"auto"},createSprintRow:{[ze]:We,gap:4},sprintRow:{[ze]:We,[Te]:22,[qe]:Ue},[Pe]:{...h&&{marginRight:12}}})),[h]),y="purple",S=(0,l.Fg)(),w=(0,Ot.KR)(S,y),C=r.useMemo((()=>{const t="actionId"===(null==u?void 0:u.type);return{key:"new_sprint",action:()=>{c({type:"actionId"}),n.close()},[gi]:e=>r[fi](ie.Z,b()({},e,{icon:Gt.Z.plus(f.plusIcon),title:o()("div",{[ei]:f.createSprintRow},void 0,o()(d.FormattedMessage,{id:"completeAutomationSprintModal.selectSprintDropdown.createNew",[Ci]:"New sprint"}),o()(ge.Z,{isRound:!0,showRemoveButton:!1,value:o()(d.FormattedMessage,{id:"completeAutomationSprintModal.selectSprintDropdown.createNewToken",[Ci]:"Next"}),format:Nt.l.Medium,isSingle:!0,color:w[Ce],[Ne]:w[Ne],showColoredDot:y})),right:t&&Gt.Z.check(f.checkIcon)}))}}),[u,n,c,f,w]),P=(0,a.VK)((()=>e.map((t=>{const e={id:t,table:Z.iU,spaceId:m},i=Jt.G[pi](p,e),s=i.getIcon(),a="pointer"===(null==u?void 0:u.type)&&Kt.dr.isEqual(u[li],e);return{key:t,action:()=>{c({type:li,[li]:e}),n.close()},[gi]:t=>r[fi](ie.Z,b()({},t,{icon:s&&o()(de.Z,{[Xe]:!0,icon:s,isEmptyPage:!1,size:20}),title:o()("div",{[ei]:f.sprintRow},void 0,v.map((t=>"title"===t[xe]?o()(ue.Z,{store:i,[ei]:f[Pe]}):o()(Xt.Z,{store:i,[xe]:t[xe],[Xe]:!1,locked:!1,format:te.C.Relation,tableWrap:!1,[we]:g,[ke]:p},t[xe]))).filter(F.isDefined)),right:a&&Gt.Z.check(f.checkIcon)}))}}))),[p,g,n,u,v,m,c,f,e]),I=[{key:"sprints",items:r.useMemo((()=>P.length>0?P:[C]),[P,C]),[gi]:t=>r[fi](ce.Z,t)}];let x;return x=h?{[Me]:Qt.og.ActionSheet}:{[Me]:Qt.og.Popup,[Te]:"50vh",minWidth:230},r[fi](re.Z,x,o()(se.Z,{type:se.i[_e],[Ze]:0,sections:I}))}function Vi(t){window.__c={n:"SelectNextSprintDate"};const{sprintDateRange:e,setSprintDateRange:i}=t,n=(0,d.useIntl)(),{[mi]:u}=(0,s.Fy)(),c=r.useMemo((()=>Fi({sprintDateRange:e,intl:n})),[e,n]),p=_i({[mi]:u}),h=(0,l.yK)((t=>({[ti]:{...!c&&{color:t[Ve]}}})),[c]),m=(0,a.VK)((()=>c||o()(d.FormattedMessage,{id:"completeAutomationSprintModal.sprintSummary.nextSprintDate.placeholder",[Ci]:"Select dates"})),[c]);return o()(ne.ZP,{popupType:u?ne.Z4[Ae]:ne.Z4.Popup,alignmentToOrigin:ne.vR.Start,[Fe]:ne.pO.Bottom,[gi]:t=>o()(Ei,{sprintDateRange:e,setSprintDateRange:i,[yi]:()=>{t.close()}}),renderOrigin:t=>r[fi](le.Z,b()({},t,{[ei]:{...p.dropdownButton,...h[ti]}}),m,Gt.Z.chevronDown(p[Be]))})}function Ei(t){window.__c={n:"SprintDateRangePicker"};const{sprintDateRange:e,setSprintDateRange:i,[yi]:n}=t,{[mi]:a}=(0,s.Fy)(),l=r.useMemo((()=>{const t=null!=e&&e[be]?{type:"date",[be]:e[be]}:void 0,i=null!=e&&e[Se]?{type:"date",[be]:e[Se]}:void 0;return{[ye]:t,ending:i}}),[e]);let u;return u=a?{[Me]:Qt.og.Modal,right:o()(ae.DoneMenuText,{}),onClickRight:n}:{[Me]:Qt.og.Popup,[Te]:"50vh",paddingTop:6},r[fi](re.Z,u,o()(ce.Z,{},void 0,o()(pe.Z,{title:void 0,disableMenuWrap:!0,allowRelativeRangeFilter:!0,value:l,onUpdate:t=>{var e,n;if(t.error)return;const o={...l,...t.value},r=null===(e=o[ye])||void 0===e?void 0:e[be],s=null===(n=o.ending)||void 0===n?void 0:n[be];i({type:fe,[be]:r,[Se]:s})},[yi]:n})),o()(ce.Z,{topBorder:!0},void 0,o()(ie.Z,{focused:!1,[Je]:()=>{i(void 0)},title:o()(d.FormattedMessage,{id:"completeAutomationSprintModal.sprintSummary.datePicker.clear",[Ci]:"Clear"})})))}var Gi=i(42875),Li=i(59054),Ki=i(54642),Ui=i(29637);const qi=i(85).NlJ,Wi=i(85).zkt,zi=i(85).JPF,Hi=i(85).OiA;function Qi(t){if(!t)return;const e=t[zi](),i=null==e?void 0:e[k.Es[Wi]];if(!i)return;return Ui.Aq.filter.property=i,{...Ui.Aq.filter,property:i}}const $i=i(85).Wp_,ji=i(85).QmD,Yi=i(85).dnw,Ji=i(85).xYh;class Xi extends P.default{getInitialState(){return{[Ji]:!0,currentSprintId:void 0,querySprintsResult:void 0,[Yi]:void 0}}updateCurrentSprint(t){const{querySprintsResult:e,[Yi]:i}=this[ji];void 0!==t&&void 0!==e&&void 0!==i?this[$i]({[Ji]:!1,currentSprintId:t,querySprintsResult:e,[Yi]:i}):t?this[$i]({...this[ji],currentSprintId:t}):this[$i]({...this[ji],[Ji]:!0,currentSprintId:t})}updateNextAndFutureSprints(t){const{currentSprintId:e,[Yi]:i}=this[ji];void 0!==e&&void 0!==t&&void 0!==i?this[$i]({[Ji]:!1,currentSprintId:e,querySprintsResult:t,[Yi]:i}):t?this[$i]({...this[ji],querySprintsResult:t}):this[$i]({...this[ji],[Ji]:!0,querySprintsResult:t})}updateCurrentSprintTaskSummary(t){const{currentSprintId:e,querySprintsResult:i}=this[ji];void 0!==e&&void 0!==i&&void 0!==t?this[$i]({[Ji]:!1,currentSprintId:e,querySprintsResult:i,[Yi]:t}):t?this[$i]({...this[ji],[Yi]:t}):this[$i]({...this[ji],[Ji]:!0,[Yi]:t})}}const tn=Xi,en=i(85).a67,nn=i(85).JPF,on=i(85).ykC,rn=i(85).EqT,sn=i(85).FH8,an=i(85).PR1,ln=i(85).pek,dn=i(85).vCp,un=i(85).Mcf,cn=i(85).wgE,pn=i(85).zG9;function hn(t){window.__c={n:"CompleteSprintAutomationButtonLoader"};const{taskCollectionContextStore:e,completeSprintAutomationContext:i,children:n,isModalOpen:o}=t,{sprintCollectionStore:l}=i,d=l.id,u=(0,s.O7)(),c=(0,a.VK)((()=>new tn),[]),p=(0,a.VK)((()=>c.state),[c]),h=(0,a.VK)((()=>{var t;const i=e[pn].state;return null==i||null===(t=i[d])||void 0===t?void 0:t.current}),[d,e]);r.useEffect((()=>{c.updateCurrentSprint(h)}),[h,c]);const[{value:m}]=(0,Li.r5)((async()=>await async function(t){var e;const{[cn]:i,completeSprintAutomationContext:n}=t,{sprintCollectionStore:o}=n,r=function(t){var e,i,n,o;const{sprintCollectionStore:r,sprintCollectionSchema:s}=t,a=r[nn](),l=null==a?void 0:a[k.b0.StatusV2];if(!l)return;const d=s[l];if(!d||"status"!==d.type)return;const u=null===(e=d.options)||void 0===e||null===(i=e.find((t=>t.id===k.YE)))||void 0===i?void 0:i.value,c=null===(n=d.options)||void 0===n||null===(o=n.find((t=>t.id===k.eH)))||void 0===o?void 0:o.value;if(!u||!c)return;const p=J.qB[k.p$].next[un].getCombinatorFilter(s);if(!p)return;const h={type:"results",filter:p,limit:5},m={type:"results",filter:{operator:"and",filters:[{property:l,filter:{operator:"status_is",value:{type:"is_option",value:c}}}]},limit:5};return{[k.YE]:h,[k.eH]:m}}(n),s=o[nn](),a=null==s?void 0:s[k.b0.Dates],l=null==s?void 0:s[k.b0.UniqueId];if(!r||!a||!l)return;const d={type:un,userId:i.currentUser.id,userTimeZone:(0,Gi.r)(),searchQuery:void 0,sort:[{property:a,direction:en},{property:l,direction:en}],reducers:r},u=null===(e=o[dn]())||void 0===e?void 0:e[ln]()[0],c=o.getSpaceId();if(!u)return;const p=await Ki[an](i,{source:{type:sn,id:o.id,spaceId:c},[rn]:{id:u.id,spaceId:c},loader:d},void 0,{src:"complete_sprint_modal_sprint_picker"});if("success"!==p.type)return;const h=p.data.result[on][k.YE],m=p.data.result[on][k.eH];if("results"!==h.type||"results"!==m.type)return;const v=h.blockIds,g=m.blockIds;return{nextSprintIds:v,futureSprintIds:g}}({[cn]:u,completeSprintAutomationContext:i})),[h,u,i]);r.useEffect((()=>{c.updateNextAndFutureSprints(m)}),[m,c]);const[{value:v}]=(0,Li.r5)((async()=>await async function(t){var e;const{[cn]:i,completeSprintAutomationContext:n}=t,{taskCollectionStore:o}=n,r=function(t){var e,i;if(!t)return;const n=t[zi](),o=Qi(t);if(!o)return;const r=null==n?void 0:n[k.Es.Status];if(!r)return;const s=t.getSchema()[r];if(!s||"status"!==s.type)return;const a=null===(e=s.groups)||void 0===e||null===(i=e.find((t=>(null==t?void 0:t.id)===k.uS)))||void 0===i?void 0:i.name;return a?{type:qi,filter:{operator:"and",filters:[o]},[qi]:{aggregator:{operator:"count_per_group",groupName:a},property:r}}:void 0}(o);if(!r)return;const s=Qi(o);if(!s)return;const a={type:un,filter:{operator:"and",filters:[s]},userId:i.currentUser.id,userTimeZone:(0,Gi.r)(),searchQuery:"",sort:[],reducers:{completed_tasks_in_current_sprint:r}},l=null===(e=o[dn]())||void 0===e?void 0:e[ln]()[0],d=o.getSpaceId();if(!l)return;const u=await Ki[an](i,{source:{type:sn,id:o.id,spaceId:d},[rn]:{id:l.id,spaceId:d},loader:a},void 0,{src:"complete_sprint_modal_sprint_picker"});if("success"!==u.type)return;return function(t){if(!t)return;if("aggregation"!==t.type)return;if("text"!==t[Hi].type)return;const e=t[Hi].value,i=null==e?void 0:e.split("/");if(!i||2!==i.length)return;const n=Number(i[0]),o=Number(i[1]);return{completedTaskCount:n,incompleteTaskCount:o-n,totalTaskCount:o,completedTaskPercent:0===o?0:n/o}}(u.data.result[on].completed_tasks_in_current_sprint)}({[cn]:u,completeSprintAutomationContext:i})),[h,u,i,o]);return r.useEffect((()=>{c.updateCurrentSprintTaskSummary(v)}),[v,c]),r.createElement(r.Fragment,null,n({completeSprintAutomationState:p,onAutomationComplete:()=>{c.reset()}}))}var mn=i(56247);function vn(t){const{percentage:e}=t;return o()(mn.b,{numberValue:e,numberFormat:void 0,numberShowAs:{type:"ring",maxValue:1,color:"blue",showValue:!1},shouldRenderTooltip:!1,progressSize:15})}var gn=i(68785),fn=i(63296);const yn=i(85).nx5,Sn=i(85).uzK,bn=i(85).ChN,wn=i(85).tBn,Cn=i(85).D7I,Pn=i(85).xYh,In=i(85).PG2,xn=i(85).dnw,kn=i(85).fKb,Zn=i(85).Ubh,_n=i(85).P24;function Tn(t){window.__c={n:"CompleteSprintAutomationButton"};const{[_n]:e,completeSprintAutomationContext:i}=t,n=(0,s.O7)(),l=(0,a.VK)((()=>f.default.checkGate("proj_management_sprints")),[]),[d,u]=r.useState(!1),[h,y]=r.useState(!1),S=r.useCallback((()=>{y(!1)}),[y]),b=(0,a.VK)((()=>g.default.state[Zn]),[]);if(!l)return null;const w=()=>{y(!0);"complete-sprint-button-tooltip"===(0,v.wF)(b,kn)&&p.tutorialGoToNextStep(n,kn),c.trackCompleteSprintAction(n,{...(0,m.getCollectionAnalyticsContext)(e),action:"open_modal"})};return o()(hn,{completeSprintAutomationContext:i,taskCollectionContextStore:e,isModalOpen:h},void 0,(t=>{let{completeSprintAutomationState:n,onAutomationComplete:s}=t;return r[Cn](r[wn],null,o()(Ii,{completeSprintAutomationContext:i,isOpen:h,onDismiss:S,setIsLoading:u,taskCollectionContextStore:e,completeSprintAutomationState:n,onAutomationComplete:s}),o()(Mn,{taskCollectionContextStore:e,[In]:w,[Pn]:d,currentSprintTasksInView:n[xn]}))}))}function Mn(t){window.__c={n:"SprintSummaryAndButton"};const{currentSprintTasksInView:e,taskCollectionContextStore:i,[In]:n,[Pn]:c}=t,{isPhone:p}=(0,s.Fy)(),m=r.useRef(null),v=(0,a.VK)((()=>(0,h.Nq)(i)),[i]),f=function(t){const{isPhone:e}=t;return(0,l.yK)((t=>({icon:{fill:t.accentColors.blue[400]},button:{height:26,marginLeft:8,[bn]:u.Z[bn].medium,...e&&{flexGrow:1,borderRadius:8,height:44}},summary:{color:t.lightTextColor,fontSize:e?u.Z.fontSize.UIRegular.mobile:u.Z.fontSize.UIRegular.desktop,[bn]:u.Z[bn].regular,whiteSpace:"nowrap"}})),[e])}({isPhone:p}),S=(0,a.VK)((()=>i[Sn]()),[i]),b=(0,a.VK)((()=>g.default.state.currentSpaceStore),[]);if(!S)return r[Cn](r[wn],null);const w=S.getSpaceId()===(null==b?void 0:b.id);return r[Cn](r[wn],null,!v&&e&&!p&&o()("div",{style:f.summary},void 0,o()(d.FormattedMessage,{id:"completeAutomationSprintAutomation.inlineSummary.completedPercentSummary",[yn]:"{completedTaskCount} / {totalTaskCount} tasks",values:{completedTaskCount:e.completedTaskCount,totalTaskCount:e.totalTaskCount}})),r[Cn](fn.Z,{ref:m,[In]:n,iconStyle:f.icon,icon:Fn({[Pn]:c,taskSummary:e}),style:f.button,disabled:c,disabledFeedback:c},o()(d.FormattedMessage,{[yn]:"Complete sprint",id:"completeSprintAutomationButton.label"})),w&&o()(y.Yy,{origin:m}))}function Fn(t){const{[Pn]:e,taskSummary:i}=t;if(e)return t=>o()("div",{style:t},void 0,o()(gn.Z,{}));const n=i?i.completedTaskPercent:0;return t=>o()("div",{style:t},void 0,o()(vn,{percentage:n}))}},30905:(t,e,i)=>{i.d(e,{qQ:()=>A,Xh:()=>R,ZP:()=>D,Y7:()=>B});var n=i(77094),o=i.n(n),r=i(97464),s=i.n(r),a=i(67294),l=i(81954),d=i(24405),u=i(3909),c=i(32056),p=i(3791),h=i(5366),m=i(4636),v=i(14976),g=i(78291),f=i(91839);const y=i(85).uM3,S=i(85).nx5,b=i(85).plP,w=i(85).jkI,C=i(85).H1U,P=i(85).ewQ,I=i(85).D7I,x=i(85)._tz,k=i(85).O_,Z=i(85).NLk,_=i(85).sei,T=i(85).ChN,M=i(85).OBh,F=i(85).oWD;function A(t){let{[F]:e,[M]:i}=t;window.__c={n:"AiAutofillFillAllPagesTooltip"};const n=(0,l.VK)((()=>(0,v.renderTextAsString)(e.getName(),e)),[e]),r=(0,l.VK)((()=>{var t;const e=(null===(t=g.default.state.data)||void 0===t?void 0:t.addOns)??[];return(0,p.de)(e)}),[]);return o()("div",{},void 0,o()("div",{style:{color:"white",[T]:500,wordWrap:_,[Z]:"pre-wrap"}},void 0,a[I](h.FormattedMessage,s()({},m.fillAllPagesMessages.fillAllPagesTooltip,{values:{hasNames:Boolean(n)&&Boolean(i.name),[k]:n,[x]:i.name}}))),!r&&o()("div",{style:{color:"#ACABA9",[T]:500}},void 0,a[I](h.FormattedMessage,m.fillAllPagesMessages.fillAllPagesAddOnMessage)))}function R(t){let{updateAiInferencesTaskStatus:e,iconStyle:i,progressIconStyle:n}=t;window.__c={n:"AiAutofillFillAllPagesButtonIcon"};const r=(0,d.Fg)();return e.isRunning?o()("div",{style:n},void 0,o()(f.Z,{})):u.Z.magicWand({width:14,color:r[P].purple[400],...i})}function D(t){let{updateAiInferencesTaskStatus:e,style:i}=t;window.__c={n:"AiAutofillFillAllPagesButtonInner"};const n=(0,h.useIntl)();return o()("div",{style:i},void 0,e.isRunning?o()("div",{style:{display:"flex",[C]:w,width:"100%"}},void 0,void 0===e.numPagesFilled||void 0===e[b]?o()(h.FormattedMessage,{[S]:"Updating all pages",id:"aiAutofill.fillallPages.updatingAllPages"}):o()(h.FormattedMessage,{[S]:"{numPagesRequested, plural, one {Updating {numPagesFilled} of {numPagesRequested} page} other {Updating {numPagesFilled} of {numPagesRequested} pages}}",id:"aiAutofill.fillallPages.updatingAllPagesWithProgress",values:{numPagesFilled:(0,c.uf)(e.numPagesFilled,y,n),[b]:(0,c.uf)(e[b],y,n)}})):o()(h.FormattedMessage,{[S]:"Update all pages",id:"aiAutofill.fillAllPages.buttonTitle"}))}function B(t){let{updateAiInferencesTaskStatus:e}=t;window.__c={n:"AiAutofillFillAllPagesButtonCaption"};const{numPagesFilled:i,[b]:n}={numPagesFilled:void 0,[b]:void 0,...e},r=(0,d.yK)((t=>({inner:{background:t[P].purple[400],height:"100%",transition:"width .5s"},outer:{background:t[P].gray[100],height:3,borderRadius:2,minWidth:120,overflow:"hidden",marginTop:8}})),[]);return void 0===i||void 0===n?null:o()("div",{style:r.outer,role:"progressbar"},void 0,o()("div",{style:{...r.inner,width:100*Math.min(i/n,1)+"%"}}))}},82994:(t,e,i)=>{i.d(e,{Z:()=>m});var n=i(77094),o=i.n(n),r=i(67294),s=i(65742);const a=i(85).TtP;const l=i(85).qc1,d=i(85).KS0,u=i(85).D7I,c=i(85).rGB,p=i(85).T4J,h=i(85).i7F;function m(t){const{startPoint:e,endPoint:i,style:n,showArrowHead:a,useRightAngles:l,cornerRadiusOverride:d,[h]:m,[p]:f}=t;return r[u](r.Fragment,null,o()(g,{startPoint:e,startCurvePoint:l?void 0:{x:e.x+s.i2,y:e.y},endPoint:a?{x:i.x-1.5,y:i.y}:i,endCurvePoint:l?void 0:{x:i.x-s.i2,y:i.y},cornerRadiusOverride:d,style:n,[h]:m,[p]:f},void 0,t[c]),a&&o()(v,{endPoint:i,style:n}))}function v(t){const{endPoint:e,style:i}=t;return o()("polyline",{points:`${e.x-5},${e.y-6} ${e.x},${e.y} ${e.x-5},${e.y+6}`,style:i,fill:d})}function g(t){const{startPoint:e,startCurvePoint:i,endPoint:n,endCurvePoint:s,style:m,cornerRadiusOverride:v,[h]:g,[p]:f}=t;let y="";y=i&&s?`M ${e.x} ${e.y} L ${i.x} ${i.y} L ${s.x} ${s.y} L ${n.x} ${n.y}`:`M ${e.x} ${e.y} L ${e.x} ${n.y} L ${n.x} ${n.y}`;const S=function(t,e){function i(t,e,i){const o=e.x-t.x,r=e.y-t.y,s=Math.sqrt(o*o+r*r);return n(t,e,Math.min(1,i/s))}function n(t,e,i){return{x:t.x+(e.x-t.x)*i,y:t.y+(e.y-t.y)*i}}function o(t,e){t[a]>2&&(t[t[a]-2]=e.x.toString(),t[t[a]-1]=e.y.toString())}function r(t){return{x:parseFloat(t[t[a]-2]),y:parseFloat(t[t[a]-1])}}const s=t.split(/[,\s]/).reduce(((t,e)=>{const i=e.match("([a-zA-Z])(.+)");return i?(t.push(i[1]),t.push(i[2])):t.push(e),t}),[]).reduce((function(t,e){return!isNaN(parseFloat(e))&&t[a]?t[t[a]-1].push(e):t.push([e]),t}),[]);let l=[];if(s[a]>1){const t=r(s[0]);let d=null;"Z"===s[s[a]-1][0]&&s[0][a]>2&&(d=["L",t.x.toString(),t.y.toString()],s[s[a]-1]=d),l.push(s[0]);for(let u=1;u<s[a];u++){const t=l[l[a]-1],c=s[u],p=c===d?s[1]:s[u+1];if(p&&t&&t[a]>2&&"L"===c[0]&&p[a]>2&&"L"===p[0]){const s=r(t),a=r(c),d=r(p),u=i(a,s,e),h=i(a,d,e);o(c,u),l.push(c);const m=n(u,a,.5),v=n(a,h,.5),g=["C",m.x.toString(),m.y.toString(),v.x.toString(),v.y.toString(),h.x.toString(),h.y.toString()];l.push(g)}else l.push(c)}if(d){const t=r(l[l[a]-1]);l.push(["Z"]),o(l[0],t)}}else l=s;return l.reduce((function(t,e){return`${t}${e.join(" ")} `}),"")}(y,v||16);return r[u](r.Fragment,null,o()("path",{d:S,style:m,fill:d}),(g||f)&&o()("g",{onMouseMove:g,onMouseLeave:f},void 0,o()("path",{d:S,style:{strokeOpacity:0,strokeWidth:16,[l]:"stroke",cursor:"default"},fill:"transparent"}),t[c]))}},64203:(t,e,i)=>{i.d(e,{Yy:()=>x,FF:()=>P,bZ:()=>I});var n=i(77094),o=i.n(n),r=i(67294),s=i(5366),a=i(97464),l=i.n(a),d=i(480),u=i(81954),c=i(9163),p=i(27370),h=i(64856);const m=new Map;var v=i(79315),g=i(81415);const f=i(85).Ubh;function y(t){let{tutorialId:e,tutorialStepId:i,...n}=t;window.__c={n:"ManagedTutorialTooltip"};const o=(0,d.O7)(),s=function(t){const e=!m.get(t),i=(0,r.useRef)(e);return i.current&&m.set(t,!0),(0,r.useEffect)((()=>()=>{i.current&&m.set(t,!1)})),i.current}(`${e}.${i}`),{currentStep:a,isLoading:y}=(0,u.VK)((()=>{var t;return{isLoading:!(null!==(t=v.default.state[f])&&void 0!==t&&t.getSettings()),currentStep:(0,h.wF)(v.default.state[f],e)}}),[e]);if(y||a!==i||!s)return null;const S=c.eU[e],b=S.steps.findIndex((t=>t.id===i));return r.createElement(g.U,l()({onCloseClick:()=>{p.dismissTutorial(o,e)},onPrimaryButtonClick:()=>{p.tutorialGoToNextStep(o,e)},onBackButtonClick:()=>{p.tutorialGoToPrevStep(o,e)},numSteps:S.steps.length,currStepIndex:b},n))}const S=i(85).ccq,b=i(85).nx5,w=i(85).fKb,C=i(85).tw8;function P(t){let{origin:e}=t;return o()(y,{origin:e,[S]:C,style:{minWidth:240},tutorialId:w,tutorialStepId:"current-sprint-view-tooltip",header:o()(s.FormattedMessage,{id:"SprintsBoardOnboardingTooltip.SprintBoardView.header",[b]:"Manage the current sprint"}),content:o()(s.FormattedMessage,{id:"SprintsBoardOnboardingTooltip.SprintBoardView.content",[b]:"Add tasks and update task status as your team makes progress during the sprint."})})}function I(t){let{origin:e}=t;return o()(y,{origin:e,[S]:C,tutorialId:w,tutorialStepId:"sprint-task-tooltip",header:o()(s.FormattedMessage,{id:"SprintsBoardOnboardingTooltip.SprintBoardItem.header",[b]:"Change tasks status"}),content:o()(s.FormattedMessage,{id:"SprintsBoardOnboardingTooltip.SprintBoardItem.content",[b]:'Drag this task to "In progress".'})})}function x(t){let{origin:e}=t;return o()(y,{origin:e,[S]:C,style:{minWidth:240},tutorialId:w,tutorialStepId:"complete-sprint-button-tooltip",header:o()(s.FormattedMessage,{id:"SprintsBoardOnboardingTooltip.CompleteSprintButton.header",[b]:"Complete this sprint"}),content:o()(s.FormattedMessage,{id:"SprintsBoardOnboardingTooltip.CompleteSprintButton.content",[b]:"Click the button when you're done with this sprint."})})}},13162:(t,e,i)=>{i.d(e,{Z:()=>J});var n=i(77094),o=i.n(n),r=i(67294),s=i(12183),a=i(480),l=i(81954),d=i(24405),u=i(56373),c=i(8848),p=i(59054),h=i(3909),m=i(5366),v=i(6287),g=i(82990),f=i(54642),y=i(77162),S=i(16956),b=i(47307),w=i(12359),C=i(33929),P=i(42922),I=i(68894),x=i(68785),k=i(76798),Z=i(32662),_=i(64369);const T=i(85).Mm1,M=i(85)._V5,F=i(85).nLZ,A=i(85).MQM,R=i(85).PXg,D=i(85).XNW,B=i(85).tBn,O=i(85).D7I,N=i(85).BQ6,V=i(85).ChN,E=i(85).jtM,G=i(85).apZ,L=(i(85).CTD,i(85).kFQ),K=i(85).CNJ,U=i(85).WK8,q=i(85).wgE,W=i(85).Mt_,z=i(85).JmH,H=i(85).Yzm,Q=i(85).oWD,$=i(85).P24,j=i(85).nx5,Y=(0,m.defineMessages)({autoIncrementIdPrefixPlaceholder:{[j]:"Prefix",id:"database.viewSettings.propertyTab.autoIncrementIdPrefixPlaceholder"},duplicatePrefixNameError:{[j]:"{prefixName} isn't available for use.",id:"database.viewSettings.propertyTab.duplicatePrefixNameError"}});function J(t){window.__c={n:"CollectionSettingsAutoIncrementIdProperty"};const{uniqueIdProperty:e,prefixValue:i,[$]:n}=t,c=(0,a.O7)(),x=(0,l.VK)((()=>n[Q]()),[n]),[T,M]=(0,r.useState)(i??""),[J,tt]=(0,r.useState)(!0),[et,it]=(0,r.useState)(),nt=(0,r.useCallback)((()=>{tt(!0),it(void 0)}),[tt,it]),ot=(0,r.useCallback)((t=>{tt(!0),it(C.default[H](Y.duplicatePrefixNameError,{prefixName:`"${t}"`}))}),[]),rt=(0,r.useCallback)(((t,e,i)=>{const n=i[Q]();n&&(tt(!1),f.setRecordKey(c,{spaceId:n[z](),table:n.table,key:t,id:n.id}).then((n=>{tt(!0),200!==n.status?ot(t):y[W]({[q]:c,[$]:i,property:e,from:"view_settings",action:"unique_id_change_collection_key"})})).catch((()=>ot(t))))}),[c,ot]),st=(0,r.useCallback)((async t=>{if(!x)return!1;const e=await f.isRecordKeyAvailable(c,{spaceId:x[z](),table:x.table,key:t.trim()});return"success"===e.type&&e.data.isAvailable}),[x,c]),at=(0,s.v)((t=>{st(t).then((e=>{e||ot(t),tt(!0)})).catch((()=>ot(t)))}),500),[lt]=(0,p.r5)((async()=>{if(x)return f.suggestRecordKey(c,{spaceId:x[z](),table:v.v,id:x.id,shouldSetSuccessfullySuggestedRecord:!1})}),[x,c]);(0,r.useEffect)((()=>{var t;if(!i&&"resolved"===lt.status)return"success"===(null===(t=lt.value)||void 0===t?void 0:t.type)&&lt.value.data?(it(void 0),void M(lt.value.data.key)):void 0}),[i,lt]),(0,r.useEffect)((()=>()=>{at.cancel()}),[at]);const dt=(0,r.useCallback)((t=>{const e=t.target.value.toUpperCase();M(e),nt(),e&&e!==i&&((0,u.k5)(e)||it(C.default[H](u.sY.prefixInvalidError)),tt(!1),at(e))}),[nt,i,at]),ut=(0,r.useCallback)((()=>{at.flush()}),[at]),ct=(0,r.useCallback)((t=>{const o=null==x?void 0:x.getRecordKeyStore();t!==i&&!et&&o&&x&&null!=e&&e.propertySchema?rt(t,null==e?void 0:e.propertyId,n):tt(!0)}),[x,i,et,e,rt,n]),pt=(0,r.useCallback)((()=>{const t=n[Q]();t&&w.createAndCommit({userAction:U,[q]:c,perform:e=>{const i=S.G3({[q]:c,[Q]:t,collectionViewArgs:void 0,propertyType:K,transaction:e});rt(T,i,n)}})}),[n,c,T,rt]),ht=(0,r.useCallback)((t=>{if(!x)return;const e=[{label:o()(m.FormattedMessage,{id:L,[j]:"Update ID Prefix"}),color:"red",onAccept:()=>ct(t)}];b.showDialog({message:o()("span",{},void 0,o()(m.FormattedMessage,{id:"database.viewSettings.propertyTab.changePrefixConfirmationMessage",[j]:"Updating the prefix will stop 3rd party automations that rely on this ID (e.g., GitHub PR status automation).",values:{[G]:o()(k.Z,{[N]:{display:E,[V]:g.Z[V].medium},shouldWrap:!0,store:x})}})),showCancel:!0,keepFocus:!0,items:e})}),[x,ct]),mt=(0,r.useCallback)((t=>{i?ht(t):ct(t)}),[i,ct,ht]),vt=(0,r.useCallback)((()=>e?e&&!i?r[O](r[B],null,h.Z.plus({width:14,height:14}),o()(Z.Z,{size:4}),o()(m.FormattedMessage,{[j]:"Add ID prefix",id:"database.viewSettings.propertyTab.autoIncrementIdCreatePrefix"})):o()(m.FormattedMessage,{[j]:"Update ID Prefix",id:L}):r[O](r[B],null,h.Z.plus({width:14,height:14}),o()(Z.Z,{size:4}),o()(m.FormattedMessage,{[j]:"Add ID property",id:"database.viewSettings.propertyTab.autoIncrementIdCreateProperty"}))),[i,e]),gt=(0,d.yK)((t=>({prefixInputOuterStyle:{color:void 0===i?t.lightTextColor:t.regularTextColor}})),[i]);return r[O](r[B],null,o()(I.ZP,{left:o()(_.Z,{[N]:{[D]:4,[R]:7}},void 0,o()(m.FormattedMessage,{[j]:"Prefix",id:"database.viewSettings.propertyTab.autoIncrementIdPrefix"})),value:T,inputOuterStyle:gt.prefixInputOuterStyle,onChange:dt,onBlur:ut,placeholder:Y.autoIncrementIdPrefixPlaceholder[j],onSubmit:()=>mt(T.trim()),focusInitial:!1,selectAll:!1,disabled:!1}),et||!J?o()(X,{prefixName:T,hasRequestCompleted:J,[A]:et}):r[O](r[B],null,o()(_.Z,{isSmall:!0,isSecondaryColor:!0,[N]:{[F]:16,[D]:16}},void 0,o()(m.FormattedMessage,{[j]:"{prefixWithHyphen}1, {prefixWithHyphen}2, {prefixWithHyphen}3, ...",id:"database.viewSettings.propertyTab.autoIncrementIdPrefixPreview",values:{prefixWithHyphen:T?`${T}-`:""}}))),o()(P.Z,{isLarge:!0,[N]:{margin:"8px 16px",width:"90%"},onClick:()=>{e?mt(T.trim()):pt()},disabled:T===i||Boolean(et)||!J},void 0,vt()))}function X(t){const{[A]:e,hasRequestCompleted:i}=t;return o()(_.Z,{isMultiline:!0,[N]:{[M]:12,[D]:16,[R]:16,...i?{color:c.ZP.red}:{},...t.styles},isSecondaryColor:!i},void 0,i&&e?e:o()("div",{[N]:{[M]:3,[T]:3}},void 0,o()(x.Z,{[N]:{width:14,height:14}})))}},27788:(t,e,i)=>{i.d(e,{Z:()=>Ve});var n=i(77094),o=i.n(n),r=i(67294),s=i(480),a=i(81954),l=i(24405),d=i(23482),u=i(5366),c=i(5500),p=i(97880),h=i(47307),m=i(77719),v=i(29637),g=i(12205),f=i(30874),y=i(89728),S=i(72495),b=i(32662),w=i(13162),C=i(97464),P=i.n(C),I=i(99036),x=i(39068),k=i(84619),Z=i(74487);const _=i(85).kAd,T=i(85)._HD,M=i(85).Qd,F=i(85).T_Q,A={pull_request_review_edited:!0,[F]:!0,[M]:!0,pull_request_review_request_removed:!0,[T]:!0,[_]:!0,pull_request_reopened:!0,installation_deleted:!0,installation_suspend:!0,installation_unsuspend:!0,pull_request_converted_to_draft:!0,pull_request_edited:!0,pull_request_assigned:!0},R={[_]:!0,[M]:!0,[F]:!0,[T]:!0};(0,p.makeTypeGuard)((t=>{const e=(0,p.objectKeys)(A);return(0,p.arrayIncludes)(e,t)?{true:t}:{false:t}}));Z.literals(...(0,p.objectKeys)({pull_request:!0,pull_request_review:!0,installation:!0})),Z.literals(...(0,p.objectKeys)(A));var D=i(3909),B=i(77162),O=i(16956),N=i(64434),V=i(12359),E=i(66890),G=i(33929),L=i(87279),K=i(29376),U=i(42917),q=i(42922),W=i(52275),z=i(31945),H=i(96525),Q=i(61519),$=i(78140),j=i(32163),Y=i(40721),J=i(22084);const X=i(85).a3v,tt=i(85).TEz,et=i(85).Nhc,it=i(85).Ie8,nt=i(85).XNW,ot=i(85).d6L,rt=i(85).DIE,st=i(85).$bT,at=i(85).ccq,lt=i(85).gGi,dt=i(85).F7y,ut=i(85).NLk,ct=i(85).$Vg,pt=i(85).UPJ,ht=i(85).jkI,mt=i(85).H1U,vt=i(85).rOg,gt=i(85).sM5,ft=i(85).BQ6,yt=i(85).BCA,St=i(85).j7K,bt=i(85).nQ3,wt=i(85).y79,Ct=i(85).iVN,Pt=i(85).ceT,It=i(85).pHx,xt=i(85).dLQ,kt=i(85).Jkr,Zt=i(85).N1Z,_t=i(85).D7I,Tt=i(85).$wW,Mt=i(85).UA5,Ft=i(85).rpY,At=i(85).fbO,Rt=i(85).AM1,Dt=i(85).veG,Bt=i(85).JJj,Ot=i(85).P24,Nt=i(85).wgE,Vt=i(85).Mt_,Et=i(85).oWD,Gt=i(85).NN6,Lt=i(85).a3C,Kt=i(85).Kiu,Ut=i(85).qq3,qt=i(85).Yzm,Wt=i(85)._HD,zt=i(85).T_Q,Ht=i(85).Qd,Qt=i(85).kAd,$t=i(85).ps9,jt=i(85).nx5,Yt=(0,u.defineMessages)({autoUpdate:{[jt]:"Auto-update",id:"collectionSettingsGithubAutomationConfig.statusPicker.autoUpdate"},when:{[jt]:"when PR is",id:"collectionSettingsGithubAutomationConfig.statusPicker.when"},[$t]:{[jt]:"Add a status property to set up automations.",id:"collectionSettingsGithubAutomationConfig.addStatusDescription"},addStatusButton:{[jt]:"Add status property",id:"collectionSettingsGithubAutomationConfig.statusPicker.addStatusButton"},newStatusPropertyButton:{[jt]:"New status",id:"collectionSettingsGithubAutomationConfig.statusPicker.newStatusPropertyButton"},[Qt]:{[jt]:"Opened",id:"collectionSettingsGithubAutomationConfig.pullRequestOpened"},[Ht]:{[jt]:"Review requested",id:"collectionSettingsGithubAutomationConfig.pullRequestReviewRequested"},[zt]:{[jt]:"Approved",id:"collectionSettingsGithubAutomationConfig.pullRequestApproved"},[Wt]:{[jt]:"Merged",id:"collectionSettingsGithubAutomationConfig.pullRequestMerged"},noAutomations:{[jt]:"None",id:"collectionSettingsGithubAutomationConfig.noAutomation"},removeStatusOption:{[jt]:"Clear",id:"collectionSettingsGithubAutomationConfig.removeStatusOption"}}),Jt={[Qt]:G.default[qt](Yt[Qt]),[Ht]:G.default[qt](Yt[Ht]),[zt]:G.default[qt](Yt[zt]),[Wt]:G.default[qt](Yt[Wt])},Xt=G.default[qt](Yt.noAutomations),te={[Qt]:null,[Ht]:null,[zt]:null,[Wt]:null};function ee(t){window.__c={n:"CollectionSettingsGithubAutomationConfig"};const{gitHubProperty:e,selectedStatusProperty:i,setSelectedStatusProperty:n,intl:l}=t,d=(0,s.O7)(),u=(0,E.Y$)(),c=(0,s.Fy)(),h=re(),m=(0,a.VK)((()=>{const t=(0,K.getPropertySchema)(u,e);if(t&&(0,I.isConnectedRelationPropertySchema)(t))return t}),[u,e]),v=(0,a.VK)((()=>{const t=u[Ut].state;return(0,p.objectEntries)(t).flatMap((t=>{let[e,i]=t;return i&&(0,I.isStatusPropertySchema)(i)?[{id:e,[Kt]:i}]:[]}))}),[u[Ut]]);(0,r.useEffect)((()=>{if(!i&&v.length>0){if(null!=m&&m[Gt][Lt])for(const e of v)if(m[Gt][Lt][e.id])return void n(e);const t=v[0];n(t)}}),[v,m,i,n]);const[g,f]=(0,r.useState)(te);(0,r.useEffect)((()=>{var t,e;i&&m&&(0,I.isConnectedRelationPropertySchema)(m)&&null!==(t=m[Gt][Lt])&&void 0!==t&&t[i.id]?f(null===(e=m[Gt][Lt])||void 0===e?void 0:e[i.id]):f(te)}),[m,i]);const y=(0,r.useCallback)((t=>{const n=u[Et]();if(!(n&&i&&m&&(0,I.isRelationPropertySchema)(m)))return;const o=m[Gt];if(!o||!i.id)return;o[Lt]={...o[Lt],...t};const r={...m,[Gt]:{...o}};B[Vt]({[Nt]:d,[Ot]:u,property:i.id,from:"github_pull_requests_property",action:"configure_github_pr_automation",githubAutomationConfigured:t}),V[Bt]({userAction:"CollectionSettingsConfigureGithubAutomation",[Nt]:d,perform:t=>{N[Dt]({[Nt]:d,[Et]:n,update:{[e]:r},transaction:t})}})}),[u,i,m,d,e]),w=(0,a.VK)((()=>i&&i[Kt].options?i[Kt].options:[]),[i]),C=(0,a.VK)((()=>{const t={};return w.forEach((e=>{t[e.id]=e})),t}),[w]),x=(0,a.VK)((()=>{var t,e;const n=null==i||null===(t=i[Kt])||void 0===t?void 0:t.groups,o=null==i||null===(e=i[Kt])||void 0===e?void 0:e.options;return n&&o?n.map((t=>{const e=o.filter((e=>{var i;return null===(i=t[Rt])||void 0===i?void 0:i[At](e.id)}));if(0!==e.length)return{group:t,groupOptions:e}})).filter(p.isDefined):[]}),[i]);function Z(t,e){const n=x.map((e=>{let{group:n,groupOptions:s}=e;const a=s.map((e=>({key:e.id,[Ft]:t=>r[_t](W.Z,P()({},t,{focused:t.focused,isTokenTitle:!0,title:o()(J.F,{format:k.l.Small,value:e.value,[Mt]:e[Mt],showRemoveButton:!1,groupColor:n[Mt],[Tt]:!0})})),action:()=>{const n={...g,[t]:e.id};i&&(y({[i.id]:n}),f(n))}}))).filter(p.isDefined);return{key:n.name,[Ft]:t=>r[_t](S.Z,P()({},t,{title:n.name,topBorder:t.index>0})),items:a}}));if(g[t]){function o(){const n={...g,[t]:null};i&&(y({[i.id]:n}),f(n)),e[Zt]()}const s={key:"removeOptionSection",[Ft]:t=>r[_t](S.Z,P()({},t,{topBorder:!0})),items:[{key:"removeOptionButton",[Ft]:t=>r[_t](W.Z,P()({},t,{focused:!1,title:l[qt](Yt.removeStatusOption),left:D.Z.trash({[kt]:12}),onClick:o})),action:t=>{o()}}]};n.push(s)}return n}return i?o()(S.Z,{topBorder:!1,disableDesktopPadding:!0,disableMobilePadding:!0,title:o()(ne,{selectedStatusProperty:i,setSelectedStatusProperty:n,existingStatusProperties:v,intl:l})},void 0,(0,p.objectKeys)(R).map((t=>o()(H.Z,{focused:!1,[at]:z.pO.Top,alignmentToOrigin:z.vR.End,popupType:c[xt]?z.Z4[It]:z.Z4.Popup,[Ft]:e=>{const i=c[xt]?{[Pt]:L.og.Modal,right:o()(Y.DoneMenuText,{}),[Ct]:e[Zt]}:{[Pt]:L.og.Popup,[kt]:150};return r[_t]($.Z,i,o()(j.Z,{type:j.i[wt],[bt]:Z(t,e),[St]:void 0,[yt]:e[Zt]}))},renderOrigin:e=>{const n=g[t];let s=o()("div",{[ft]:h.noneText},void 0,Xt);if(n){const t=C[n];if(t){var a,l,d;const e=null==i||null===(a=i[Kt])||void 0===a||null===(l=a.groups)||void 0===l||null===(d=l.find((t=>{var e;return null===(e=t[Rt])||void 0===e?void 0:e[At](n)})))||void 0===d?void 0:d[Mt];s=o()(J.F,{format:k.l.Small,showRemoveButton:!1,[Tt]:!0,value:t.value,[Mt]:t[Mt],groupColor:e})}}return r[_t](U.Z,P()({},e,{focused:!1,icon:()=>o()("div",{[ft]:{[gt]:vt,[mt]:ht,[pt]:ct,[ut]:dt}},void 0,Jt[t],o()(b.Z,{size:8}),D.Z.arrowRight(h.automationMenuItemArrow)),title:o()("div",{[ft]:{[kt]:lt,[gt]:vt,[pt]:"flex-end"}},void 0,s),showChevron:!0,chevronStyle:{margin:0}}))}},t)))):o()(ie,{setSelectedStatusProperty:n,intl:l})}function ie(t){window.__c={n:"AddStatusProperty"};const{setSelectedStatusProperty:e,intl:i}=t,n=(0,s.O7)(),r=(0,E.Y$)(),a=re();return o()("div",{[ft]:{[gt]:"flex",[st]:"column",[mt]:ht}},void 0,o()(Q.Z,{size:lt,innerStyle:a.addStatusDivider}),o()("div",{[ft]:a[$t]},void 0,i[qt](Yt[$t])),o()(q.Z,{[ft]:a.addStatusButton,onClick:t=>{t[rt](),oe(n,r,e)}},void 0,D.Z.plus({[kt]:14}),o()(b.Z,{size:4}),i[qt](Yt.addStatusButton)),o()(b.Z,{size:4}))}function ne(t){window.__c={n:"GithubStatusPropertyPicker"};const{selectedStatusProperty:e,setSelectedStatusProperty:i,existingStatusProperties:n,intl:a}=t,d=(0,s.O7)(),u=(0,E.Y$)(),c=(0,s.Fy)(),h=re(),m=(0,l.Fg)(),v=n.map((t=>{const{id:e,[Kt]:n}=t;return{key:e,action:()=>{i(t)},[Ft]:e=>r[_t](W.Z,P()({},e,{icon:o()(x.ZP,{size:14,theme:m,icon:t&&t[Kt].icon,type:ot}),title:n.name}))}})).filter(p.isDefined),g={key:"newStatusProperty",action:()=>{oe(d,u,i)},[Ft]:t=>r[_t](W.Z,P()({},t,{icon:D.Z.plus(h.statusPickerIcon),title:a[qt](Yt.newStatusPropertyButton)}))};return o()("div",{[ft]:h.statusPickerWrapper},void 0,o()("div",{[ft]:{[gt]:vt,[mt]:ht}},void 0,a[qt](Yt.autoUpdate),c[xt]&&o()(b.Z,{size:4}),o()(z.ZP,{[at]:z.pO.Bottom,alignmentToOrigin:z.vR.Start,popupType:c[xt]?z.Z4[It]:z.Z4.Popup,renderOrigin:t=>r[_t](W.Z,P()({},t,{title:e[Kt].name,focused:!1,[ft]:h.statusPickerButtonCore,textWrapperStyle:h.statusPickerButtonTextWrapper,left:o()(x.ZP,{size:14,theme:m,icon:e[Kt].icon,type:ot}),leftStyle:{[nt]:2},showExtensionArrow:!0,extensionArrowStyle:h.statusPickerExtensionArrow})),[Ft]:t=>{const e=c[xt]?{[Pt]:L.og[it]}:{[Pt]:L.og.Popup,[kt]:150};return r[_t]($.Z,e,o()(j.Z,{type:j.i[wt],[bt]:[{key:0,[Ft]:t=>r[_t](S.Z,t),items:[...v,g]}],[St]:0,[yt]:t[Zt]}))}})),c[xt]&&o()(b.Z,{size:4}),a[qt](Yt.when))}function oe(t,e,i){const n=e[Et]();n&&V[Bt]({userAction:"CollectionSettingsConfigureGithubAutomationCreateNewStatusProperty",[Nt]:t,perform:o=>{const r=O.G3({[Nt]:t,[Et]:n,collectionViewArgs:void 0,propertyType:ot,transaction:o}),s=(0,K.getPropertySchema)(e,r);s&&(0,I.isStatusPropertySchema)(s)&&i({id:r,[Kt]:s})}})}function re(){const t=(0,s.Fy)()[xt];return(0,l.yK)((e=>({addStatusDivider:{borderColor:e.tableDividerColor},[$t]:{[kt]:et,padding:t?"16px 8px":"14px 0px",fontSize:t?16:12,[Mt]:e[tt]},addStatusButton:{[kt]:et,[gt]:vt,[mt]:ht,[pt]:ht},noneText:{[Mt]:e[tt]},automationMenuItemArrow:{[kt]:12,fill:e[X],stroke:e[X],strokeOpacity:.5,strokeWidth:2},statusPickerWrapper:{[gt]:vt,[mt]:ht,flexWrap:"wrap",rowGap:2,marginBottom:t?10:void 0},statusPickerButtonTextWrapper:{margin:"0px 4px",fontSize:12},statusPickerButtonCore:{minHeight:t?28:20,borderRadius:5,maxWidth:t?150:100},statusPickerIcon:{[kt]:14,height:14},statusPickerExtensionArrow:{transform:"rotate(180deg)",marginRight:2}})),[t])}var se=i(49122);const ae=i(85).TEz,le=i(85).C_1,de=i(85).jkI,ue=i(85).oWD,ce=i(85).OBh,pe=i(85).Nhc,he=i(85).irb,me=i(85).VUQ,ve=i(85).wgE,ge=i(85).YGn,fe=i(85).Scd,ye=i(85).Yzm,Se=i(85).zDZ,be=i(85).QOi,we=i(85).wEV,Ce=i(85).ffk,Pe=i(85).P24,Ie=i(85).FUo,xe=i(85).Jd1,ke=i(85).jRR,Ze=i(85).nx5,_e=(0,u.defineMessages)({tabTitle:{[Ze]:"GitHub Pull Requests",id:"database.viewSettings.githubConfigTab.tabTitle"},connect:{[Ze]:"Connect to GitHub (Workspace)",id:"database.viewSettings.githubConfigTab.connect"},connectDescriptionAdmin:{[Ze]:ke,id:"database.viewSettings.githubConfigTab.connectDescriptionAdmin"},authError:{[Ze]:xe,id:"database.viewSettings.githubConfigTab.authError"},tabDescriptionNoIdPrefix:{[Ze]:"This feature requires a prefixed ID property to link GitHub PRs to Notion {pluralItemName}.",id:"database.viewSettings.githubConfigTab.tabDescriptionNoIdPrefix"},tabDescriptionNoStatus:{[Ze]:"Link PRs by adding the {singleItemName} ID to the PR title.",id:"database.viewSettings.githubConfigTab.tabDescriptionNoStatus"},[Ie]:{[Ze]:"Link PRs by adding the {singleItemName} ID to the PR title. Set up automated status updates in Notion based on PR status changes.",id:"database.viewSettings.githubConfigTab.tabDescription"}});function Te(t){let{[Pe]:e,intl:i}=t;window.__c={n:"UnauthedFallback"};const n=Ne(),{hoveredBackground:r,pressedBackground:l}=Oe(),d=(0,g.J)(),u=(0,s.O7)(),c=Be(),p=function(t){return(0,a.VK)((()=>{var e;return null===(e=t[ue]())||void 0===e?void 0:e.getSpaceId()}),[t])}(e);return o()(S.Z,{disableMobileBorders:!0,mobileStyle:n[we],style:n[we]},void 0,o()("img",{src:be,style:{width:36,height:36}}),o()("p",{style:n.connectDescription},void 0,d?(0,v.GT)()[Se]:i[ye](_e.connectDescriptionAdmin)),o()(y.Z,{style:n.connectButton,hoveredStyle:{[fe]:r},pressedStyle:{[fe]:l},disabled:!d,disabledFeedback:!d,onClick:async t=>{if(t[ge](),p&&c)try{await m.hM({[ve]:u,spaceId:p,[me]:c,from:"connected_relation_property_menu"})}catch(e){const t=i[ye](_e.authError);h[he](t)}}},void 0,i[ye](_e.connect)),o()(b.Z,{size:4}))}function Me(t){let{[Pe]:e}=t;window.__c={n:"UserEducationSection"};const i=Ne(),{isMobile:n}=(0,s.Fy)(),r=De(e);return o()(S.Z,{disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,mobileStyle:i[we],style:i[we]},void 0,o()(b.Z,{size:n?16:8}),o()(se.Z,{width:pe,uniqueIdPrefix:null==r?void 0:r.prefix}))}function Fe(t){let{[Pe]:e,intl:i,selectedStatusProperty:n}=t;window.__c={n:"DescriptionSection"};const r=(0,a.VK)((()=>e.databaseType),[e]),s=De(e),l=Ne(),u=(0,d.hf)(r)[Ze],c=(0,d.u5)(r)[Ze];let p;return p=s&&s.prefix?n?i[ye](_e[Ie],{singleItemName:u}):i[ye](_e.tabDescriptionNoStatus,{singleItemName:u}):i[ye](_e.tabDescriptionNoIdPrefix,{pluralItemName:c}),o()(S.Z,{disableMobileBorders:!0,disableMobilePadding:!0,mobileStyle:l[Ie],style:l[Ie]},void 0,p)}function Ae(t){let{[Pe]:e}=t;window.__c={n:"UniqueIdSection"};const i=De(e);return i&&i.prefix?null:o()(w.Z,{[Pe]:e,uniqueIdProperty:i&&{propertyId:i.id,[ce]:i.schema},prefixValue:null==i?void 0:i.prefix})}function Re(t){let{[Pe]:e,selectedStatusProperty:i,setSelectedStatusProperty:n,[Ce]:r,intl:s}=t;window.__c={n:"AutomationConfigSection"};const a=De(e);return a&&a.prefix?o()(ee,{selectedStatusProperty:i,setSelectedStatusProperty:n,gitHubProperty:r,intl:s}):null}function De(t){return(0,a.VK)((()=>{var e,i,n;const o=null===(e=t[ue]())||void 0===e||null===(i=e.getRecordKeyStore())||void 0===i?void 0:i.getRecordKey(),r=null===(n=t[ue]())||void 0===n?void 0:n.getSchema(),s=r&&(0,p.objectEntries)(r).find((t=>{let[,e]=t;return e&&"auto_increment_id"===e.type}));if(s){const[t,e]=s;if(e&&"auto_increment_id"===e.type)return{id:t,schema:e,prefix:o}}}),[t])}function Be(){return(0,a.VK)((()=>f.Z.integrations.state.find((t=>t.id===c.U9))),[])}function Oe(){const t=Be(),e=(0,l.Fg)();return(0,a.VK)((()=>(0,c.dg)(t,e.mode)),[t,e.mode])}function Ne(){const{isMobile:t}=(0,s.Fy)(),{[fe]:e}=Oe();return(0,l.yK)((i=>({[we]:{display:"flex",flexDirection:"column",alignItems:de,justifyContent:de},connectButton:{fontSize:14,maxWidth:pe,height:void 0,color:i[le],[fe]:e,whiteSpace:"normal",padding:8,textAlign:de},connectDescription:{maxWidth:pe,color:i[ae],fontSize:14,textAlign:de},[Ie]:{padding:t?18:14,fontSize:t?16:12,color:i[ae]}})),[t,e])}const Ve=(0,u.injectIntl)((function(t){window.__c={n:"CollectionSettingsGithubConfig"};const{[Pe]:e,[Ce]:i,intl:n}=t,[s,l]=(0,r.useState)(void 0);return(0,a.VK)((()=>{const t=f.Z.bots.state.find((t=>t.integration_id===c.U9));return Boolean(t)}),[])?r.createElement(r.Fragment,null,o()(Me,{[Pe]:e}),o()(Fe,{[Pe]:e,intl:n,selectedStatusProperty:s}),o()(Ae,{[Pe]:e}),o()(Re,{[Pe]:e,selectedStatusProperty:s,setSelectedStatusProperty:l,[Ce]:i,intl:n})):o()(Te,{[Pe]:e,intl:n})}))},67695:(t,e,i)=>{i.d(e,{Z:()=>s});var n=i(35431);const o=i(85).P24;class r extends n.Z{findTableHeaderCell(t,e){return this.find((i=>i.props[o]===t&&i.props.property===e))}}const s=new r}}]);