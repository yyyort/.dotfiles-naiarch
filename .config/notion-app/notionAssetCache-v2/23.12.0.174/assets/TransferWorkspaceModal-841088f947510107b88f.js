"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[4114],{26862:(e,t,a)=>{a.r(t),a.d(t,{TransferWorkspaceModal:()=>_e});var r=a(77094),i=a.n(r),o=a(67294),n=a(480),s=a(81954),l=a(24405),d=a(15145),c=a(33728),u=a(5366),m=a(97880),p=a(50906),f=a(54642),g=a(47307),h=a(29974),v=a(28020),k=a(79315),w=a(17364),b=a(1743),S=a(53953),C=a(19889),y=a(82990),x=a(39098),I=a(42922),Z=a(61519),M=a(74194),U=a(89728),T=a(64369),V=a(3909),W=a(70043),B=a(33665),_=a(73063),E=a(16354),L=a(45653);const K=a(85).XhL,D=a(85).Ubh,q=a(85).DgF,F=a(85).wDs,N=a(85).wrq,z=a(85).nx5,R=a(85).BQ6,P=a(85).fOf,A=a(85).zDZ,H=a(85).z8h,O=a(85).xoW,Y=a(85).Hco,J=a(85).H1U,G=a(85).jkI,X=a(85).UPJ,j=a(85).nLZ,Q=a(85).nHL,$=a(85).ChN,ee={inputLabel:{[$]:y.Z[$].medium,fontSize:14,[Q]:-.15,textAlign:"left",width:"100%"},input:{width:"100%",[j]:8}};function te(e){window.__c={n:"TransferModalHeader"};const t=(0,l.yK)((e=>({avatarContainer:{display:"flex",[X]:G,[J]:G},avatarContainerBadged:{position:"relative"},avatarBadgeIcon:{position:"absolute",left:26,top:26,height:20,width:20},exclamationMarkIcon:{width:"100%",height:18,fill:e.accentColors.yellow[500],stroke:e.modalBackground,strokeWidth:3,paintOrder:"stroke fill",overflow:"visible"},arrowRightIcon:{width:16,height:16,marginLeft:12,marginRight:12,fill:e[Y]},questionMarkIcon:{width:20,height:20,fill:e[Y]},userIconPlaceholder:{width:40,height:40,borderRadius:"50%",backgroundColor:e.modalBackground,display:"flex",[J]:G,[X]:G,boxShadow:W.v.avatarBoxShadow.light,boxSizing:"content-box",border:`1px solid ${e.lightDividerColor}`},[O]:{textAlign:G},[H]:{display:"flex",[X]:G,[J]:G,[j]:15},title:{fontSize:16,[$]:y.Z[$].medium},[A]:{[j]:5,[$]:y.Z[$].regular,textAlign:G,fontSize:13,lineHeight:"16px",[Q]:-.08}})),[]);return i()("div",{[R]:t[O]},void 0,i()("div",{[R]:t.avatarContainer},void 0,i()("div",{[R]:t.avatarContainerBadged},void 0,i()(L.Z,{size:40,userValue:e.fromUserValue,avatarShouldShowShadow:!0}),i()("div",{[R]:t.avatarBadgeIcon},void 0,V.Z[P](t.exclamationMarkIcon))),V.Z.arrowRight(t.arrowRightIcon),e.targetUserValue?i()(L.Z,{size:40,userValue:e.targetUserValue,avatarShouldShowShadow:!0}):i()("div",{[R]:t.userIconPlaceholder},void 0,V.Z.questionMark(t.questionMarkIcon))),i()("div",{[R]:t[H]},void 0,i()(T.Z,{[R]:t.title},void 0,i()(u.FormattedMessage,{[z]:"Change workspace account",id:"transferWorkspaceModal.changeAccount.title"})),i()(E.Z,{href:(0,B.getLocalizedUrl)(N)},void 0,i()(_.Z,{icon:V.Z.help}))),i()(T.Z,{isSecondaryColor:!0,isMultiline:!0,[R]:t[A]},void 0,e[A]))}function ae(){window.__c={n:"BackToMyWorkspacesButton"};const e=(0,n.O7)(),t=(0,l.yK)((e=>({backIconStyle:{width:12,height:12,marginRight:7,fill:e[Y]},[F]:{[j]:12,[X]:G,[$]:y.Z[$].medium,color:e.lightTextColor,[Q]:"-0.154px"}})),[]),a=(0,s.VK)((()=>k.default.state[q]),[]),r=(0,s.VK)((()=>k.default.state[D]),[]),c=(0,s.VK)((()=>a&&r),[a,r]),m=(0,o.useCallback)((async()=>{a&&r&&await h[K]({environment:e,userRootStore:a,userSettingsStore:r,skipPendingTransferWorkspaces:!0,pageVisitSource:d.tY.BackForward})}),[e,a,r]);return i()(U.Z,{[R]:t[F],onClick:m,disabled:!c},void 0,V.Z.commentReply(t.backIconStyle),i()(u.FormattedMessage,{id:"transferWorkspaceModal.backToMyWorkspacesButton.label",[z]:"Back to my workspaces"}))}const re=a(85).Yzm,ie=a(85).E4p,oe=a(85).BQ6,ne=a(85).nx5,se=a(85).TLr,le=a(85).oAr,de=a(85).mPA,ce=a(85).wDs,ue=a(85).nLZ,me=a(85).gGi;function pe(e){window.__c={n:"ConfirmTransferState"};const{currentSpaceStore:t,currentUserValue:a,targetUserId:r,handleConfirm:n,handleBack:d,intl:c}=e,m=(0,l.yK)((e=>({primaryButton:{width:me,marginBottom:"10px",[ue]:32},[ce]:{color:e.mediumTextColor,fontWeight:y.Z.fontWeight.medium},emailFieldCaption:{textAlign:"center",[ue]:"5px",lineHeight:"15px",fontSize:12,color:e.lightTextColor},inputLabel:ee.inputLabel,verificationCodeInputContainer:{[ue]:13},[de]:ee[de],inputContainer:{[ue]:27,width:me},[le]:{[ue]:29},dividerInner:{borderBottomColor:e.regularDividerColor}})),[]),p=(0,s.VK)((()=>t.getName()),[t]),f=(0,s.VK)((()=>x.U6[se](t,{id:r,table:C.KJ}).getValue()),[t,r]),g=(0,s.VK)((()=>x.U6[se](t,{id:r,table:C.KJ}).getEmail()),[t,r]),[h,v]=(0,o.useState)(""),k=(0,o.useCallback)((e=>{v(e.currentTarget.value)}),[v]),w=(0,o.useCallback)((async()=>{await n(h)}),[h,n]);return o.createElement(o.Fragment,null,i()(te,{fromUserValue:a,targetUserValue:f,description:i()(u.FormattedMessage,{[ne]:"Transfer {currentSpaceName} to the Notion account associated with {targetUserEmail}.",id:"transferWorkspaceModal.confirmTransfer.description",values:{currentSpaceName:p,targetUserEmail:g}})}),i()(Z.Z,{size:me,innerStyle:m.dividerInner,[oe]:m[le]}),i()("div",{[oe]:m.inputContainer},void 0,i()(T.Z,{[oe]:m.inputLabel},void 0,i()(u.FormattedMessage,{id:"transferWorkspaceModal.confirmTransfer.emailLabel",[ne]:ie})),i()(M.Z,{[oe]:m[de],value:g,disabled:!0}),i()(T.Z,{isSecondaryColor:!0,[oe]:m.emailFieldCaption},void 0,i()(u.FormattedMessage,{id:"transferWorkspaceModal.confirmTransfer.emailDescription",[ne]:"We just sent you a temporary verification code.{br}Please check your inbox.",values:{br:i()("br",{})}})),i()("div",{[oe]:m.verificationCodeInputContainer},void 0,i()(T.Z,{[oe]:m.inputLabel},void 0,i()(u.FormattedMessage,{id:"transferWorkspaceModal.confirmTransfer.passcodeLabel",[ne]:"Verification code"})))),i()(M.Z,{[oe]:m[de],value:h,onChange:k,onSubmit:w,placeholder:c[re]({id:"transferWorkspaceModal.confirmTransfer.passcodePlaceholder",[ne]:"Enter verification code..."}),focusInitial:!0}),i()(I.Z,{[oe]:m.primaryButton,onClick:w},void 0,i()(u.FormattedMessage,{[ne]:"Confirm transfer",id:"transferWorkspaceModal.confirmTransfer.confirmButton"})),i()(U.Z,{[oe]:m[ce],onClick:d},void 0,i()(u.FormattedMessage,{[ne]:"Cancel",id:"transferWorkspaceModal.confirmTransfer.cancelButton"})))}var fe=a(90468);const ge=a(85).cZW,he=a(85).Yzm,ve=a(85).E4p,ke=a(85).nx5,we=a(85).xiq,be=a(85).oAr,Se=a(85).gGi;function Ce(e){window.__c={n:"RequestedTransferStage"};const{currentUserValue:t,currentSpaceStore:a,workspaceTransfer:r,intl:n,handleSubmitEmail:d}=e,c=(0,l.yK)((e=>({primaryButton:{width:Se,marginTop:32},emailLabel:ee.inputLabel,emailInput:ee.input,[be]:{marginTop:29},dividerInner:{borderBottomColor:e.regularDividerColor},emphasizedDescriptionText:{fontWeight:y.Z.fontWeight.medium},inputContainer:{marginTop:27,width:Se}})),[]),m=(0,s.VK)((()=>t.email),[t]),p=(0,s.VK)((()=>null==a?void 0:a.getName()),[a]),f=(0,s.VK)((()=>x.H2.createChildStore(a,{table:fe.bx,id:r.requested_from_space_id}).getName()),[a,r]),[g,h]=(0,o.useState)(""),v=(0,o.useCallback)((()=>{d(g)}),[g,d]);return o.createElement(o.Fragment,null,i()(te,{fromUserValue:t,description:i()(u.FormattedMessage,{id:"transferWorkspaceModal.transferRequested.description",[ke]:"{currentWorkspaceName} is associated with {currentUserEmail}. {requestingWorkspaceName} owns {currentUserEmailDomain} and requires that you switch to a personal Notion account to continue using this workspace.{br}{br}Contact {contactEmail} for assistance.",values:{br:i()("br",{}),currentWorkspaceName:p,currentUserEmail:m,currentUserEmailDomain:m.split("@")[1],requestingWorkspaceName:f,[we]:i()("span",{style:c.emphasizedDescriptionText},void 0,r.contact_email)}})}),i()(Z.Z,{size:Se,innerStyle:c.dividerInner,style:c[be]}),i()("div",{style:c.inputContainer},void 0,i()(T.Z,{style:c.emailLabel},void 0,i()(u.FormattedMessage,{id:"transferWorkspaceModal.transferRequested.emailLabel",[ke]:ve})),i()(M.Z,{style:c.emailInput,value:g,onChange:e=>{h(e.currentTarget.value)},onSubmit:v,[ge]:n[he]({id:"transferWorkspaceModal.transferRequested.emailPlaceholder",[ke]:"Personal-use, Notion account email address..."}),focusInitial:!0})),i()(I.Z,{isLarge:!0,style:c.primaryButton,onClick:v},void 0,i()(u.FormattedMessage,{id:"transferWorkspaceModal.transferRequested.continueButton",[ke]:"Continue with email"})),i()(ae,{}))}const ye=a(85).XhL,xe=a(85).LIR,Ie=a(85).Und,Ze=a(85).EXq,Me=a(85).BTL,Ue=a(85).Y3b,Te=a(85).Ubh,Ve=a(85).DgF,We=a(85).qJ8,Be=a(85).PZy;function _e(e){window.__c={n:Be};const{workspaceTransfer:t}=e,a=(0,n.O7)(),r=(0,u.useIntl)(),C=(0,s.VK)((()=>k.default.state[We]),[]),y=(0,s.VK)((()=>k.default.state.currentUserStore),[]),x=(0,s.VK)((()=>k.default.state[Ve]),[]),I=(0,s.VK)((()=>k.default.state[Te]),[]),[Z,M]=(0,o.useState)({type:Ue}),U=(0,s.VK)((()=>{var e;return null===(e=(0,v.getCurrentUserStore)(a))||void 0===e?void 0:e.getValue()}),[a]),T=(0,l.yK)((e=>({[Me]:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center"}})),[]);if(!C||!y||!U)return null;let V;switch(Z.type){case Ue:const e=async e=>{const t=await f.sendVerifyTransferEmail(a,{email:e});"failed"!==t.type?M({type:"confirm",targetUserId:t.data.userId,targetUserEmailDomain:(0,c.Gd)(e)}):g.showError(t)};V=i()(Ce,{currentUserValue:U,[We]:C,workspaceTransfer:t,handleSubmitEmail:e,intl:r});break;case"confirm":const o=async e=>{const r=Z.targetUserId,i=await f.transferWorkspaceToUser(a,{targetUserId:r,spaceId:C.id,transferEmailPasscode:e});if("failed"===i.type)return g.showError(i),void M({type:Ue});p.trackSpaceTransferCompleted(a,{newOwner:r,newEmailDomain:Z.targetUserEmailDomain||"__UNKNOWN_EMAIL_DOMAIN__",requestingSpaceId:t.requested_from_space_id});const o=w.Z.getSpaceViewStores(a,r).find((e=>e.getSpaceId()===C.id));return o?void(await h.navigateToSpace({environment:a,[Ze]:x,[Ie]:I,spaceViewStore:o,[xe]:d.tY.SwitchSpace})):x&&I?(await h[ye]({environment:a,[Ze]:x,[Ie]:I,skipPendingTransferWorkspaces:!0,[xe]:d.tY.SwitchSpace}),void M({type:Ue})):void 0};V=i()(pe,{[We]:C,currentUserValue:U,targetUserId:Z.targetUserId,handleBack:()=>M({type:Ue}),handleConfirm:o,intl:r});break;default:(0,m.unreachable)(Z)}return i()(b.Z,{capture:!0},void 0,i()(S.Z,{open:!0,innerStyle:T[Me],onDismiss:()=>{},render:()=>V}))}}}]);